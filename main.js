/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => ReferencePlugin,
  generateDefaultHighlights: () => generateDefaultHighlights
});
module.exports = __toCommonJS(main_exports);
var import_obsidian6 = require("obsidian");

// src/state.ts
var import_state = require("@codemirror/state");
var that = import_state.StateField.define({
  create() {
    return null;
  },
  update(value, tr) {
    if (tr["annotations"].length == 2 && tr["annotations"][0].value.type == "that") {
      return tr["annotations"][0].value.that.app;
    }
    return value;
  }
});
var hoveredCursor = import_state.StateField.define({
  create() {
    return null;
  },
  update(value, tr) {
    if (tr["annotations"].length == 2 && tr["annotations"][0].value.type == "hoveredCursor") {
      if (value)
        return [
          ...value.filter(
            (cursor) => cursor.user != tr["annotations"][0].value.user
          ),
          {
            cursor: tr["annotations"][0].value.cursor,
            user: tr["annotations"][0].value.user
          }
        ];
      return [
        {
          cursor: tr["annotations"][0].value.cursor,
          user: tr["annotations"][0].value.user
        }
      ];
    } else if (tr["annotations"].length == 2 && tr["annotations"][0].value.type == "removeHoveredCursor") {
      if (value)
        return value.filter(
          (cursor) => cursor.user != tr["annotations"][0].value.user
        );
      return value;
    }
    return value;
  }
});
var backlinks = import_state.StateField.define({
  create() {
    return [];
  },
  update(value, tr) {
    if (tr.effects.length > 0) {
      try {
        let data = JSON.parse(
          tr.effects[0].value
        );
        if (data.type == "backlink") {
          if (data.backlinks.length == 0)
            return value;
          let referencingLocation = data.backlinks[0]["referencingLocation"]["filename"];
          let filteredValues = value.filter(
            (backlink) => backlink.referencingLocation.filename != referencingLocation
          );
          return [...filteredValues, ...data.backlinks];
        }
        return value;
      } catch (e) {
        console.log(e);
        return value;
      }
    }
    return value;
  }
});
var hoverElement = import_state.StateField.define({
  create() {
    return null;
  },
  update(value, tr) {
    if (tr.effects.length > 0) {
      try {
        let data = JSON.parse(tr.effects[0].value);
        if (data.type == "hover-start") {
          return Object.assign({}, data);
        } else if (data.type == "hover") {
          if (value)
            return Object.assign(value, data);
          return data;
        } else if (data.type == "hover-off") {
          return null;
        }
        return value;
      } catch (e) {
        console.log(e);
        return value;
      }
    }
    return value;
  }
});
var backlinkHoverElement = import_state.StateField.define({
  create() {
    return null;
  },
  update(value, tr) {
    if (tr.effects.length > 0) {
      try {
        let data = JSON.parse(tr.effects[0].value);
        if (data.type == "backlink-start") {
          return Object.assign({}, data);
        } else if (data.type == "backlink-update") {
          if (value)
            return Object.assign(value, data);
          return data;
        } else if (data.type == "backlink-off") {
          return null;
        }
        return value;
      } catch (e) {
        console.log(e);
        return value;
      }
    }
    return value;
  }
});
var cursorElement = import_state.StateField.define({
  create() {
    return null;
  },
  update(value, tr) {
    if (tr.effects.length > 0) {
      try {
        let data = JSON.parse(tr.effects[0].value);
        if (data.type == "cursor-start") {
          return {};
        } else if (data.type == "cursor") {
          if (value)
            return Object.assign(value, data);
          return data;
        } else if (data.type == "cursor-off") {
          return null;
        }
        return value;
      } catch (e) {
        console.log(e);
        return value;
      }
    }
    return value;
  }
});
var editorChange = import_state.StateField.define({
  create() {
    return null;
  },
  update(value, tr) {
    if (tr.effects.length > 0) {
      try {
        let data = JSON.parse(tr.effects[0].value);
        if (data.type == "sync") {
          return value;
        }
        return value;
      } catch (e) {
        console.log(e);
        return value;
      }
    }
    return value;
  }
});
var thatAnnotation = import_state.Annotation.define();
var hoveredCursorAnnotation = import_state.Annotation.define();
var hoverEffect = import_state.StateEffect.define();
var backlinkHoverEffect = import_state.StateEffect.define();
var cursorEffect = import_state.StateEffect.define();
var backlinkEffect = import_state.StateEffect.define();
var state = import_state.EditorState.create({
  extensions: [
    that,
    hoveredCursor,
    backlinks,
    hoverElement,
    backlinkHoverElement,
    cursorElement,
    editorChange
  ]
});
function getThat() {
  return state.field(that);
}
function updateThat(that2) {
  state = state.update({
    annotations: thatAnnotation.of({
      type: "that",
      that: that2
    })
  }).state;
}
function getHoveredCursor() {
  return state.field(hoveredCursor);
}
function updateHoveredCursor(cursor, user) {
  state = state.update({
    annotations: hoveredCursorAnnotation.of({
      type: "hoveredCursor",
      cursor,
      user
    })
  }).state;
}
function removeHoveredCursor(user) {
  state = state.update({
    annotations: hoveredCursorAnnotation.of({
      type: "removeHoveredCursor",
      user
    })
  }).state;
}
function getHover() {
  return state.field(hoverElement);
}
function updateHover(value) {
  state = state.update({
    effects: hoverEffect.of(
      JSON.stringify(Object.assign(value, { type: "hover" }))
    )
  }).state;
}
function resetHover() {
  state = state.update({
    effects: hoverEffect.of(
      JSON.stringify({
        type: "hover-off"
      })
    )
  }).state;
}
function getBacklinkHover() {
  return state.field(backlinkHoverElement);
}
function updateBacklinkHover(value) {
  state = state.update({
    effects: backlinkHoverEffect.of(
      JSON.stringify(Object.assign(value, { type: "backlink-update" }))
    )
  }).state;
}
function resetBacklinkHover() {
  state = state.update({
    effects: backlinkHoverEffect.of(
      JSON.stringify({
        type: "backlink-off"
      })
    )
  }).state;
}
function getCursor() {
  return state.field(cursorElement);
}
function updateCursor(value) {
  state = state.update({
    effects: cursorEffect.of(
      JSON.stringify(Object.assign(value, { type: "cursor" }))
    )
  }).state;
}
function resetCursor() {
  state = state.update({
    effects: cursorEffect.of(
      JSON.stringify({
        type: "cursor-off"
      })
    )
  }).state;
}
function updateBacklinks(value) {
  state = state.update({
    effects: backlinkEffect.of(
      JSON.stringify(Object.assign({ backlinks: value }, { type: "backlink" }))
    )
  }).state;
}

// src/widget/highlightWidget.ts
var import_view = require("@codemirror/view");

// src/constants.ts
var REFERENCE_REGEX = /\[\u2197\]\(urn:([^)]*)\)/g;
var ACTION_TYPE = {
  MOUSE: "mouse",
  CURSOR: "cursor",
  BACKLINK: "backlink"
};
var SVG_HOVER_COLOR = "rgb(187, 215, 230)";
var REFERENCE_ICON_HEIGHT = 20;
var PORTAL_TEXT_SLICE_SIZE = 100;

// src/widget/highlightWidget.ts
var HighlighterWidget = class extends import_view.WidgetType {
  constructor(name, view) {
    super();
    this.name = name;
    this.view = view;
  }
  eq(other) {
    return this.name === other.name;
  }
  toDOM() {
    const span = document.createElement("fragment");
    span.textContent = this.name;
    span.style.backgroundColor = SVG_HOVER_COLOR;
    span.style.color = "black";
    return span;
  }
};
var highlighterDecoration = (match, view) => import_view.Decoration.replace({
  widget: new HighlighterWidget(match[1], view)
});
var highlightMatcher = new import_view.MatchDecorator({
  regexp: /\+\+\+(.*?)\+\+\+/g,
  decoration: (match, view, pos) => {
    return highlighterDecoration(match, view);
  }
});
var highlights = import_view.ViewPlugin.fromClass(
  class {
    constructor(view) {
      this.highlights = highlightMatcher.createDeco(view);
    }
    update(update) {
      this.highlights = highlightMatcher.updateDeco(update, this.highlights);
    }
    destroy() {
      this.highlights = import_view.Decoration.none;
    }
  },
  {
    decorations: (instance) => instance.highlights,
    provide: (plugin) => import_view.EditorView.atomicRanges.of((view) => {
      var _a;
      return ((_a = view.plugin(plugin)) == null ? void 0 : _a.highlights) || import_view.Decoration.none;
    })
  }
);

// src/widget/referenceWidget.ts
var import_view4 = require("@codemirror/view");

// src/references.ts
var import_obsidian4 = require("obsidian");

// node_modules/uuid/dist/esm-browser/rng.js
var getRandomValues;
var rnds8 = new Uint8Array(16);
function rng() {
  if (!getRandomValues) {
    getRandomValues = typeof crypto !== "undefined" && crypto.getRandomValues && crypto.getRandomValues.bind(crypto);
    if (!getRandomValues) {
      throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");
    }
  }
  return getRandomValues(rnds8);
}

// node_modules/uuid/dist/esm-browser/regex.js
var regex_default = /^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;

// node_modules/uuid/dist/esm-browser/validate.js
function validate(uuid) {
  return typeof uuid === "string" && regex_default.test(uuid);
}
var validate_default = validate;

// node_modules/uuid/dist/esm-browser/stringify.js
var byteToHex = [];
for (let i = 0; i < 256; ++i) {
  byteToHex.push((i + 256).toString(16).slice(1));
}
function unsafeStringify(arr, offset = 0) {
  return byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + "-" + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + "-" + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + "-" + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + "-" + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]];
}

// node_modules/uuid/dist/esm-browser/parse.js
function parse(uuid) {
  if (!validate_default(uuid)) {
    throw TypeError("Invalid UUID");
  }
  let v;
  const arr = new Uint8Array(16);
  arr[0] = (v = parseInt(uuid.slice(0, 8), 16)) >>> 24;
  arr[1] = v >>> 16 & 255;
  arr[2] = v >>> 8 & 255;
  arr[3] = v & 255;
  arr[4] = (v = parseInt(uuid.slice(9, 13), 16)) >>> 8;
  arr[5] = v & 255;
  arr[6] = (v = parseInt(uuid.slice(14, 18), 16)) >>> 8;
  arr[7] = v & 255;
  arr[8] = (v = parseInt(uuid.slice(19, 23), 16)) >>> 8;
  arr[9] = v & 255;
  arr[10] = (v = parseInt(uuid.slice(24, 36), 16)) / 1099511627776 & 255;
  arr[11] = v / 4294967296 & 255;
  arr[12] = v >>> 24 & 255;
  arr[13] = v >>> 16 & 255;
  arr[14] = v >>> 8 & 255;
  arr[15] = v & 255;
  return arr;
}
var parse_default = parse;

// node_modules/uuid/dist/esm-browser/v35.js
function stringToBytes(str) {
  str = unescape(encodeURIComponent(str));
  const bytes = [];
  for (let i = 0; i < str.length; ++i) {
    bytes.push(str.charCodeAt(i));
  }
  return bytes;
}
var DNS = "6ba7b810-9dad-11d1-80b4-00c04fd430c8";
var URL = "6ba7b811-9dad-11d1-80b4-00c04fd430c8";
function v35(name, version, hashfunc) {
  function generateUUID(value, namespace, buf, offset) {
    var _namespace;
    if (typeof value === "string") {
      value = stringToBytes(value);
    }
    if (typeof namespace === "string") {
      namespace = parse_default(namespace);
    }
    if (((_namespace = namespace) === null || _namespace === void 0 ? void 0 : _namespace.length) !== 16) {
      throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");
    }
    let bytes = new Uint8Array(16 + value.length);
    bytes.set(namespace);
    bytes.set(value, namespace.length);
    bytes = hashfunc(bytes);
    bytes[6] = bytes[6] & 15 | version;
    bytes[8] = bytes[8] & 63 | 128;
    if (buf) {
      offset = offset || 0;
      for (let i = 0; i < 16; ++i) {
        buf[offset + i] = bytes[i];
      }
      return buf;
    }
    return unsafeStringify(bytes);
  }
  try {
    generateUUID.name = name;
  } catch (err) {
  }
  generateUUID.DNS = DNS;
  generateUUID.URL = URL;
  return generateUUID;
}

// node_modules/uuid/dist/esm-browser/native.js
var randomUUID = typeof crypto !== "undefined" && crypto.randomUUID && crypto.randomUUID.bind(crypto);
var native_default = {
  randomUUID
};

// node_modules/uuid/dist/esm-browser/v4.js
function v4(options, buf, offset) {
  if (native_default.randomUUID && !buf && !options) {
    return native_default.randomUUID();
  }
  options = options || {};
  const rnds = options.random || (options.rng || rng)();
  rnds[6] = rnds[6] & 15 | 64;
  rnds[8] = rnds[8] & 63 | 128;
  if (buf) {
    offset = offset || 0;
    for (let i = 0; i < 16; ++i) {
      buf[offset + i] = rnds[i];
    }
    return buf;
  }
  return unsafeStringify(rnds);
}
var v4_default = v4;

// node_modules/uuid/dist/esm-browser/sha1.js
function f(s, x, y, z) {
  switch (s) {
    case 0:
      return x & y ^ ~x & z;
    case 1:
      return x ^ y ^ z;
    case 2:
      return x & y ^ x & z ^ y & z;
    case 3:
      return x ^ y ^ z;
  }
}
function ROTL(x, n) {
  return x << n | x >>> 32 - n;
}
function sha1(bytes) {
  const K = [1518500249, 1859775393, 2400959708, 3395469782];
  const H = [1732584193, 4023233417, 2562383102, 271733878, 3285377520];
  if (typeof bytes === "string") {
    const msg = unescape(encodeURIComponent(bytes));
    bytes = [];
    for (let i = 0; i < msg.length; ++i) {
      bytes.push(msg.charCodeAt(i));
    }
  } else if (!Array.isArray(bytes)) {
    bytes = Array.prototype.slice.call(bytes);
  }
  bytes.push(128);
  const l = bytes.length / 4 + 2;
  const N = Math.ceil(l / 16);
  const M = new Array(N);
  for (let i = 0; i < N; ++i) {
    const arr = new Uint32Array(16);
    for (let j = 0; j < 16; ++j) {
      arr[j] = bytes[i * 64 + j * 4] << 24 | bytes[i * 64 + j * 4 + 1] << 16 | bytes[i * 64 + j * 4 + 2] << 8 | bytes[i * 64 + j * 4 + 3];
    }
    M[i] = arr;
  }
  M[N - 1][14] = (bytes.length - 1) * 8 / Math.pow(2, 32);
  M[N - 1][14] = Math.floor(M[N - 1][14]);
  M[N - 1][15] = (bytes.length - 1) * 8 & 4294967295;
  for (let i = 0; i < N; ++i) {
    const W = new Uint32Array(80);
    for (let t = 0; t < 16; ++t) {
      W[t] = M[i][t];
    }
    for (let t = 16; t < 80; ++t) {
      W[t] = ROTL(W[t - 3] ^ W[t - 8] ^ W[t - 14] ^ W[t - 16], 1);
    }
    let a = H[0];
    let b = H[1];
    let c = H[2];
    let d = H[3];
    let e = H[4];
    for (let t = 0; t < 80; ++t) {
      const s = Math.floor(t / 20);
      const T = ROTL(a, 5) + f(s, b, c, d) + e + K[s] + W[t] >>> 0;
      e = d;
      d = c;
      c = ROTL(b, 30) >>> 0;
      b = a;
      a = T;
    }
    H[0] = H[0] + a >>> 0;
    H[1] = H[1] + b >>> 0;
    H[2] = H[2] + c >>> 0;
    H[3] = H[3] + d >>> 0;
    H[4] = H[4] + e >>> 0;
  }
  return [H[0] >> 24 & 255, H[0] >> 16 & 255, H[0] >> 8 & 255, H[0] & 255, H[1] >> 24 & 255, H[1] >> 16 & 255, H[1] >> 8 & 255, H[1] & 255, H[2] >> 24 & 255, H[2] >> 16 & 255, H[2] >> 8 & 255, H[2] & 255, H[3] >> 24 & 255, H[3] >> 16 & 255, H[3] >> 8 & 255, H[3] & 255, H[4] >> 24 & 255, H[4] >> 16 & 255, H[4] >> 8 & 255, H[4] & 255];
}
var sha1_default = sha1;

// node_modules/uuid/dist/esm-browser/v5.js
var v5 = v35("v5", 80, sha1_default);
var v5_default = v5;

// src/utils.ts
var import_obsidian3 = require("obsidian");

// src/workspace.ts
var import_obsidian = require("obsidian");
function collectLeavesByTab(split, result = []) {
  const type = split.type;
  if (!type)
    throw new Error("Split type not found");
  if (type == "tabs" || type == "split") {
    const children = split.children;
    if (!children)
      throw new Error("Split children not found");
    if (children) {
      for (const child of children) {
        let emptyList = [];
        collectLeavesByTab(child, result);
      }
    }
  } else if (type == "leaf") {
    const parentSplitId = split.parent.id;
    if (!parentSplitId)
      throw new Error("Split parent id not found");
    let idx = result.findIndex((tab) => {
      const tabId = tab[0].parent.id;
      return tabId == parentSplitId;
    });
    if (idx == -1) {
      result.push([split]);
    } else {
      result[idx].push(split);
    }
  }
  return result;
}
function collectLeavesByTabHelper() {
  const { workspace } = getThat();
  const currLeaf = workspace.getLeaf();
  const rootSplit = currLeaf.getRoot();
  return collectLeavesByTab(rootSplit);
}
function getCurrentTabIndex(leavesByTab, span) {
  let workspaceTab = span.closest(".workspace-tabs");
  let currTabIdx = leavesByTab.findIndex((tab) => {
    const leafTab = tab[0].view.containerEl.closest(".workspace-tabs");
    return leafTab == workspaceTab;
  });
  return currTabIdx;
}
function getAdjacentTabs(leavesByTab, currTabIdx, file) {
  let rightAdjacentTab = [];
  let leftAdjacentTab = [];
  let adjacentTabs = [];
  if (leavesByTab[currTabIdx + 1]) {
    rightAdjacentTab = leavesByTab[currTabIdx + 1];
    adjacentTabs = [...adjacentTabs, ...rightAdjacentTab];
  }
  if (leavesByTab[currTabIdx - 1]) {
    leftAdjacentTab = leavesByTab[currTabIdx - 1];
    adjacentTabs = [...adjacentTabs, ...leftAdjacentTab];
  }
  let index = adjacentTabs.findIndex(
    (x) => x.getViewState().state.file == file
  );
  return { adjacentTabs, rightAdjacentTab, leftAdjacentTab, index };
}
async function openFileInAdjacentTab(leavesByTab, currTabIdx, file, type) {
  let { adjacentTabs, rightAdjacentTab, leftAdjacentTab } = getAdjacentTabs(
    leavesByTab,
    currTabIdx,
    file
  );
  let allTabNames = leavesByTab.map(
    (tab) => tab.map((x) => x.getViewState().state.file)
  );
  let rightAdjacentTabNames = rightAdjacentTab.map(
    (x) => x.getViewState().state.file
  );
  let leftAdjacentTabNames = leftAdjacentTab.map(
    (x) => x.getViewState().state.file
  );
  const { workspace } = getThat();
  if (allTabNames.filter((v, i) => i != currTabIdx).flat().includes(file) && !rightAdjacentTabNames.includes(file) && !leftAdjacentTabNames.includes(file)) {
    let currentTabNames = [];
    let currentTab = [];
    allTabNames.forEach((tabNames, i) => {
      if (tabNames != rightAdjacentTabNames && tabNames != leftAdjacentTabNames && currTabIdx != i) {
        if (tabNames.includes(file)) {
          currentTabNames = tabNames;
          currentTab = leavesByTab[i];
        }
      }
    });
    const originalLeaf = currentTab.filter(
      (t) => t.containerEl.style.display != "none"
    )[0];
    let leaf = currentTab[currentTabNames.indexOf(file)];
    workspace.revealLeaf(leaf);
    return { newLeaf: leaf, temp: false, originalLeaf };
  } else if (rightAdjacentTabNames.includes(file)) {
    const originalLeaf = rightAdjacentTab.filter(
      (t) => t.containerEl.style.display != "none"
    )[0];
    let leaf = rightAdjacentTab[rightAdjacentTabNames.indexOf(file)];
    workspace.revealLeaf(leaf);
    return { newLeaf: leaf, temp: false, originalLeaf };
  } else if (leftAdjacentTabNames.includes(file)) {
    const originalLeaf = leftAdjacentTab.filter(
      (t) => t.containerEl.style.display != "none"
    )[0];
    let leaf = leftAdjacentTab[leftAdjacentTabNames.indexOf(file)];
    workspace.revealLeaf(leaf);
    return { newLeaf: leaf, temp: false, originalLeaf };
  } else if (rightAdjacentTab.length > 0) {
    const originalLeaf = rightAdjacentTab.filter(
      (t) => t.containerEl.style.display != "none"
    )[0];
    let currLeaf = workspace.getLeaf();
    workspace.setActiveLeaf(originalLeaf);
    let newLeaf = workspace.getLeaf(true);
    await openFileInLeaf(newLeaf, file);
    workspace.revealLeaf(newLeaf);
    workspace.setActiveLeaf(currLeaf);
    return { newLeaf, temp: true, originalLeaf };
  } else if (leftAdjacentTab.length > 0) {
    const originalLeaf = leftAdjacentTab.filter(
      (t) => t.containerEl.style.display != "none"
    )[0];
    let currLeaf = workspace.getLeaf();
    workspace.setActiveLeaf(originalLeaf);
    let newLeaf = workspace.getLeaf(true);
    await openFileInLeaf(newLeaf, file);
    workspace.revealLeaf(newLeaf);
    workspace.setActiveLeaf(currLeaf);
    return { newLeaf, temp: true, originalLeaf };
  } else {
    const currLeaf = workspace.getLeaf();
    let newLeaf = workspace.createLeafBySplit(currLeaf);
    await openFileInLeaf(newLeaf, file);
    return { newLeaf, temp: true };
  }
}
async function openFileInLeaf(leaf, file) {
  let targetFile = getThat().vault.getAbstractFileByPath(file);
  if (targetFile && targetFile instanceof import_obsidian.TFile)
    await leaf.openFile(targetFile, { active: false });
}

// src/effects.ts
var import_obsidian2 = require("obsidian");

// src/mark.ts
var import_view2 = require("@codemirror/view");
var import_state3 = require("@codemirror/state");
var addHighlight = import_state3.StateEffect.define({
  map: ({ from, to }, change) => ({
    from: change.mapPos(from),
    to: change.mapPos(to)
  })
});
var addDefaultHighlight = import_state3.StateEffect.define({
  map: ({ from, to }, change) => ({
    from: change.mapPos(from),
    to: change.mapPos(to)
  })
});
var resetHighlight = import_state3.StateEffect.define({
  map: ({ from, to }, change) => ({
    from: change.mapPos(from),
    to: change.mapPos(to)
  })
});
var highlightField = import_state3.StateField.define({
  create() {
    return import_view2.Decoration.none;
  },
  update(higlights, tr) {
    higlights = higlights.map(tr.changes);
    for (let e of tr.effects)
      if (e.is(addDefaultHighlight)) {
        higlights = higlights.update({
          add: [defaultHighlightMark.range(e.value.from, e.value.to)]
        });
      } else if (e.is(addHighlight)) {
        higlights = higlights.update({
          add: [highlightMark.range(e.value.from, e.value.to)]
        });
      } else if (e.is(resetHighlight)) {
        higlights = higlights.update({
          filter: (from, to) => {
            return !(from === e.value.from && to === e.value.to);
          }
        });
      }
    return higlights;
  },
  provide: (f2) => import_view2.EditorView.decorations.from(f2)
});
var highlightMark = import_view2.Decoration.mark({ class: "highlight" });
var defaultHighlightMark = import_view2.Decoration.mark({ class: "default-highlight" });
var theme = import_view2.EditorView.baseTheme({});
var highlightTheme = import_view2.EditorView.baseTheme({
  ".highlight": {
    "background-color": "hsl(calc(var(--accent-h) - 3), calc(var(--accent-s) * 1.02), calc(var(--accent-l) * 1.3))",
    color: "black"
  }
});
var defaultHighlightTheme = import_view2.EditorView.baseTheme({
  ".default-highlight": {
    "background-color": "hsl(calc(var(--accent-h) - 3), calc(var(--accent-s) * 1.02), calc(var(--accent-l) * 1.43))",
    color: "black"
  }
});
function highlightSelection(view, from, to) {
  let effects = [addHighlight.of({ from, to })];
  if (!effects.length)
    return false;
  if (!view.state.field(highlightField, false))
    effects.push(import_state3.StateEffect.appendConfig.of([highlightField, theme]));
  view.dispatch({ effects });
  return true;
}
function defaultHighlightSelection(view, from, to) {
  let effects = [addDefaultHighlight.of({ from, to })];
  if (!effects.length)
    return false;
  if (!view.state.field(highlightField, false))
    effects.push(import_state3.StateEffect.appendConfig.of([highlightField, theme]));
  view.dispatch({ effects });
  return true;
}
function removeHighlight(view, from, to) {
  let effects = [resetHighlight.of({ from, to })];
  if (!effects.length)
    return false;
  view.dispatch({ effects });
  return true;
}

// src/effects.ts
var import_view3 = require("@codemirror/view");
function getEditorView(leaf) {
  var _a;
  if (!leaf)
    return null;
  const view = leaf.view;
  const editor = (_a = view.sourceMode) == null ? void 0 : _a.cmEditor;
  if (!editor.CodeMirror && editor.cm instanceof import_view3.EditorView) {
    const editorView = editor.cm;
    return editorView;
  }
  return null;
}
function checkSpanElementExists(span, containerEl) {
  const spanElements = containerEl.getElementsByTagName("span");
  for (let i = 0; i < spanElements.length; i++) {
    if (spanElements[i] === span) {
      return true;
    }
  }
  return false;
}
function parseCSSString(css) {
  const cssPropertiesRegex = /([\w-]+)\s*:\s*([^;]+)\s*;?/g;
  let cssPropertiesObject = {};
  let match;
  while ((match = cssPropertiesRegex.exec(css)) !== null) {
    cssPropertiesObject[match[1]] = match[2];
  }
  return cssPropertiesObject;
}
function delay(milliseconds) {
  return new Promise((resolve) => {
    setTimeout(resolve, milliseconds);
  });
}
function tempDirectionIndicator(leaf, text, prefix, suffix, dataString, isSame, user) {
  if (user === ACTION_TYPE.BACKLINK) {
    const editor2 = getMarkdownView(leaf).editor;
    const backlinkContainer2 = getBacklinkContainer(editor2);
    const windowHeight2 = leaf.view.containerEl.querySelector(".cm-scroller").getBoundingClientRect().height;
    const scrollTop2 = leaf.view.containerEl.querySelector(".cm-scroller").scrollTop;
    const scrollBottom2 = scrollTop2 + windowHeight2;
    let container = editor2.containerEl;
    let content = container.querySelector(".cm-content");
    let references = content.querySelectorAll(".reference-data-span");
    let visibleElements2 = [];
    for (let i = 0; i < references.length; i++) {
      let bbox = references[i].getBoundingClientRect();
      if (bbox.top >= scrollTop2 && bbox.bottom <= scrollBottom2) {
        visibleElements2.push(references[i]);
      }
    }
    let dataStrings = visibleElements2.map(
      (el) => el.getAttribute("data")
    );
    let startTop = leaf.view.editor.getScrollInfo().top;
    if (!dataStrings.includes(dataString)) {
      let positions = findTextPositions(
        leaf.view.data,
        text,
        prefix.slice(0, prefix.length - 1),
        suffix.slice(1, suffix.length)
      );
      if (!positions)
        throw new Error("Positions not found");
      let rangeStart = positions.rangeStart;
      let rangeEnd = positions.rangeEnd;
      leaf.view.editor.scrollIntoView(
        {
          from: Object.assign(rangeStart, { ch: 0 }),
          to: Object.assign(rangeEnd, { ch: 0 })
        },
        true
      );
    }
    setTimeout(() => {
      let endTop = leaf.view.editor.getScrollInfo().top;
      let container2 = leaf.containerEl.querySelector(".view-content");
      container2.classList.remove("no-shadow");
      container2.classList.remove("new-shadow");
      container2.classList.remove("top-shadow");
      container2.classList.remove("bottom-shadow");
      if (startTop === endTop && isSame) {
        container2.classList.add("no-shadow");
      } else if (startTop === endTop && !isSame) {
        container2.classList.add("new-shadow");
      } else if (startTop < endTop) {
        container2.classList.add("top-shadow");
      } else {
        container2.classList.add("bottom-shadow");
      }
    }, 10);
    return;
  }
  const editor = getMarkdownView(leaf).editor;
  const backlinkContainer = getBacklinkContainer(editor);
  const windowHeight = leaf.view.containerEl.querySelector(".cm-scroller").getBoundingClientRect().height;
  const scrollTop = leaf.view.containerEl.querySelector(".cm-scroller").scrollTop;
  const scrollBottom = scrollTop + windowHeight;
  let visibleElements = [];
  for (let i = 0; i < backlinkContainer.children.length; i++) {
    let style = backlinkContainer.children[i].getAttribute("style");
    if (style == null)
      continue;
    let cssProperties = parseCSSString(style);
    let top = parseFloat(cssProperties["top"].replace("px", ""));
    if (top == null)
      continue;
    if (scrollTop <= top && top <= scrollBottom && backlinkContainer.children[i]) {
      let reference = backlinkContainer.children[i].getAttribute("reference");
      if (reference) {
        visibleElements.push(JSON.parse(reference).dataString);
      }
    }
  }
  if (!visibleElements.includes(dataString)) {
    let startTop = leaf.view.editor.getScrollInfo().top;
    let positions = findTextPositions(
      leaf.view.data,
      text,
      prefix.slice(0, prefix.length - 1),
      suffix.slice(1, suffix.length)
    );
    if (!positions)
      throw new Error("Positions not found");
    let rangeStart = positions.rangeStart;
    let rangeEnd = positions.rangeEnd;
    leaf.view.editor.scrollIntoView(
      {
        from: Object.assign(rangeStart, { ch: 0 }),
        to: Object.assign(rangeEnd, { ch: 0 })
      },
      true
    );
    setTimeout(() => {
      let endTop = leaf.view.editor.getScrollInfo().top;
      let container = leaf.containerEl.querySelector(".view-content");
      container.classList.remove("no-shadow");
      container.classList.remove("new-shadow");
      container.classList.remove("top-shadow");
      container.classList.remove("bottom-shadow");
      if (startTop === endTop && isSame) {
        container.classList.add("no-shadow");
      } else if (startTop === endTop && !isSame) {
        container.classList.add("new-shadow");
      } else if (startTop < endTop) {
        container.classList.add("top-shadow");
      } else {
        container.classList.add("bottom-shadow");
      }
    }, 10);
  }
}
function endEffectRemoveHighlights(workspace, leafId, uuid, backlinkUUID) {
  var _a, _b, _c, _d, _e;
  const workspaceContainer = workspace.containerEl;
  const span = workspaceContainer.querySelector("." + uuid);
  (_b = (_a = span == null ? void 0 : span.parentElement) == null ? void 0 : _a.querySelector(".reference-span")) == null ? void 0 : _b.classList.remove("reference-span-selected");
  span == null ? void 0 : span.classList.remove("reference-data-span-selected");
  if (backlinkUUID) {
    const backlinkSpan = workspaceContainer.querySelector("." + backlinkUUID);
    (_d = (_c = backlinkSpan == null ? void 0 : backlinkSpan.parentElement) == null ? void 0 : _c.querySelector(".reference-span")) == null ? void 0 : _d.classList.remove("reference-span-selected");
    backlinkSpan == null ? void 0 : backlinkSpan.classList.remove("reference-data-span-selected");
  }
  let targetLeaf = workspace.getLeafById(leafId);
  if (!targetLeaf) {
    resetCursor();
    throw new Error("Target leaf not found");
  }
  let container = (_e = getContainerElement(targetLeaf)) == null ? void 0 : _e.querySelector(".view-content");
  if (container) {
    container.classList.remove("no-shadow");
    container.classList.remove("new-shadow");
    container.classList.remove("top-shadow");
    container.classList.remove("bottom-shadow");
  }
}
async function startBacklinkEffect(span) {
  var _a, _b, _c, _d;
  let source = getBacklinkHover();
  let destination = getCursor();
  let updateState = updateBacklinkHover;
  if (source != null)
    return;
  updateState({
    type: `${ACTION_TYPE.BACKLINK}-start`
  });
  if (!span)
    return;
  let uuid = Array.from(span.classList).filter((el) => el.includes("uuid"))[0];
  (_b = (_a = span.parentElement) == null ? void 0 : _a.querySelector(".reference-span")) == null ? void 0 : _b.classList.add("reference-span-selected");
  span.classList.add("reference-data-span-selected");
  updateState({
    uuid
  });
  const referenceData = span.getAttribute("reference");
  if (!referenceData)
    throw new Error("Reference data not found");
  const backlink = JSON.parse(referenceData);
  const dataString = backlink.dataString;
  if (destination != null && destination.dataString == dataString) {
    updateState(destination);
    return;
  }
  let [prefix, text, suffix, file, from, to] = processURI(dataString);
  let leavesByTab = collectLeavesByTabHelper();
  let currTabIdx = getCurrentTabIndex(leavesByTab, span);
  let backlinkLeaf = leavesByTab[currTabIdx].filter((leaf) => {
    let containerEl = getContainerElement(leaf);
    const exists = checkSpanElementExists(span, containerEl);
    return exists;
  })[0];
  let backlinkLeafID = backlinkLeaf.id;
  if (!backlinkLeafID)
    throw new Error("Leaf id not found");
  if (backlinkLeaf && backlinkLeaf.view instanceof import_obsidian2.MarkdownView) {
    const editorView = getEditorView(backlinkLeaf);
    if (!editorView)
      throw new Error("Editor view not found");
    const viewport = backlinkLeaf.view.editor.getScrollInfo();
    removeHighlight(editorView, from, to);
    highlightSelection(editorView, from, to);
    updateState({
      dataString,
      originalTop: editorView.documentTop,
      backlinkLeafId: backlinkLeafID
    });
  }
  let referencingFile = backlink.referencingLocation.filename;
  const { newLeaf, temp, originalLeaf } = await openFileInAdjacentTab(
    leavesByTab,
    currTabIdx,
    referencingFile
  );
  let id = newLeaf.id;
  if (!id)
    throw new Error("Leaf id not found");
  updateState({
    leafId: id,
    temp,
    peek: true
  });
  const originalLeafId = originalLeaf.id;
  const matches = [
    ...backlink.referencingLocation.text.matchAll(REFERENCE_REGEX)
  ];
  if (matches.length == 0)
    throw new Error("Matches not found");
  tempDirectionIndicator(
    newLeaf,
    backlink.referencingLocation.text,
    backlink.referencingLocation.prefix + "-",
    "-" + backlink.referencingLocation.suffix,
    matches[0][1],
    id === originalLeafId,
    ACTION_TYPE.BACKLINK
  );
  const cursorViewport = newLeaf.view.editor.getScrollInfo();
  updateState({
    cursorViewport
  });
  let backlinkSpan = newLeaf.containerEl.querySelector(
    `span[data="${backlink.dataString}"]`
  );
  if (backlinkSpan) {
    let backlinkUUID = Array.from(backlinkSpan.classList).filter(
      (el) => el.includes("uuid")
    )[0];
    (_d = (_c = backlinkSpan.parentElement) == null ? void 0 : _c.querySelector(".reference-span")) == null ? void 0 : _d.classList.add("reference-span-selected");
    backlinkSpan.classList.add("reference-data-span-selected");
    updateState({
      backlinkUUID
    });
  }
  if (originalLeafId) {
    updateState({
      originalLeafId
    });
  }
  return;
}
async function startReferenceEffect(span, type) {
  var _a, _b;
  let source = type == ACTION_TYPE.MOUSE ? getHover() : getCursor();
  let destination = type == ACTION_TYPE.MOUSE ? getCursor() : getHover();
  let updateState = type == ACTION_TYPE.MOUSE ? updateHover : updateCursor;
  if (source != null) {
    if (ACTION_TYPE.CURSOR == type) {
      await endReferenceCursorEffect();
    } else {
      return;
    }
  }
  updateState({
    type: `${type}-start`
  });
  if (!span)
    return;
  let uuid = Array.from(span.classList).filter((el) => el.includes("uuid"))[0];
  (_b = (_a = span.parentElement) == null ? void 0 : _a.querySelector(".reference-span")) == null ? void 0 : _b.classList.add("reference-span-selected");
  span.classList.add("reference-data-span-selected");
  updateState({
    uuid
  });
  const dataString = span.getAttribute("data");
  if (!dataString)
    throw new Error("Data string not found");
  if (destination != null && destination.dataString == dataString && ACTION_TYPE.CURSOR != type) {
    updateHover(destination);
    return;
  }
  let [prefix, text, suffix, file, from, to] = processURI(dataString);
  let leavesByTab = collectLeavesByTabHelper();
  let currTabIdx = getCurrentTabIndex(leavesByTab, span);
  let currLeaf = getThat().workspace.getLeaf();
  let currLeafID = currLeaf.id;
  if (!currLeafID)
    throw new Error("currLeafID id not found");
  const { newLeaf, temp, originalLeaf } = await openFileInAdjacentTab(
    leavesByTab,
    currTabIdx,
    file,
    type
  );
  let id = newLeaf.id;
  if (!id)
    throw new Error("Leaf id not found");
  updateState({
    leafId: id,
    temp,
    peek: true
  });
  const originalLeafId = originalLeaf.id;
  if (newLeaf && newLeaf.view instanceof import_obsidian2.MarkdownView) {
    const editorView = getEditorView(newLeaf);
    if (!editorView)
      throw new Error("Editor view not found");
    const viewport = newLeaf.view.editor.getScrollInfo();
    removeHighlight(editorView, from, to);
    highlightSelection(editorView, from, to);
    tempDirectionIndicator(
      newLeaf,
      text,
      prefix,
      suffix,
      dataString,
      id === originalLeafId
    );
    const cursorViewport = newLeaf.view.editor.getScrollInfo();
    updateState({
      dataString,
      originalTop: editorView.documentTop,
      // originalLeafId: currLeafID,
      cursorViewport
    });
  }
  if (originalLeafId) {
    updateState({
      originalLeafId
    });
  }
}
async function endReferenceCursorEffect() {
  var _a, _b;
  if (!getCursor() || Object.keys(getCursor()).length == 0) {
    resetCursor();
    return;
  }
  const {
    dataString,
    leafId,
    originalLeafId,
    temp,
    cursorViewport,
    peek,
    uuid
  } = getCursor();
  resetCursor();
  if (getHover() != null && getHover().dataString == dataString) {
    resetCursor();
    return;
  }
  const { workspace } = getThat();
  let targetLeaf = workspace.getLeafById(leafId);
  endEffectRemoveHighlights(workspace, leafId, uuid);
  const activeLeaf = getThat().workspace.getLeaf();
  const activeLeafId = activeLeaf.id;
  let editorView = getEditorView(targetLeaf);
  let [prefix, text, suffix, file, from, to] = processURI(dataString);
  removeHighlight(editorView, from, to);
  defaultHighlightSelection(editorView, from, to);
  if (activeLeafId === leafId) {
    resetCursor();
    let containerEl = getContainerElement(targetLeaf);
    if (containerEl != null) {
      (_a = containerEl.querySelector(".view-content")) == null ? void 0 : _a.setAttribute("style", "");
    }
    return;
  }
  if (cursorViewport && targetLeaf && targetLeaf.view instanceof import_obsidian2.MarkdownView) {
    const view = targetLeaf.view;
    view.editor.scrollTo(0, cursorViewport.top);
    if (getHover() != null) {
      const { dataString: dataString2, cursorViewport: cursorViewport2, leafId: leafId2, originalLeafId: originalLeafId2 } = getHover();
      let [prefix2, text2, suffix2, file2, from2, to2] = processURI(dataString2);
      const cursorLeaf = workspace.getLeafById(leafId2);
      workspace.revealLeaf(cursorLeaf);
      const editorView2 = getEditorView(cursorLeaf);
      highlightSelection(editorView2, from2, to2);
    } else {
      let containerEl = getContainerElement(targetLeaf);
      if (containerEl != null) {
        (_b = containerEl.querySelector(".view-content")) == null ? void 0 : _b.setAttribute("style", "");
      }
    }
  }
  if (temp && targetLeaf) {
    targetLeaf.detach();
  }
  if (peek) {
    let originalLeaf = workspace.getLeafById(originalLeafId);
    if (!originalLeaf)
      throw new Error("Original leaf not found");
    workspace.revealLeaf(originalLeaf);
  }
  resetCursor();
}
async function endReferenceHoverEffect() {
  if (!getHover() || Object.keys(getHover()).length == 0) {
    resetHover();
    return;
  }
  let { dataString, leafId, originalLeafId, temp, cursorViewport, peek, uuid } = getHover();
  resetHover();
  if (getCursor() != null && getCursor().dataString == dataString) {
    resetHover();
    return;
  }
  const { workspace } = getThat();
  let targetLeaf = workspace.getLeafById(leafId);
  endEffectRemoveHighlights(workspace, leafId, uuid);
  let editorView = getEditorView(targetLeaf);
  let [prefix, text, suffix, file, from, to] = processURI(dataString);
  removeHighlight(editorView, from, to);
  defaultHighlightSelection(editorView, from, to);
  if (cursorViewport && targetLeaf && targetLeaf.view instanceof import_obsidian2.MarkdownView) {
    const view = targetLeaf.view;
    view.editor.scrollTo(0, cursorViewport.top);
    if (getCursor() != null && getCursor().dataString) {
      const { dataString: dataString2, cursorViewport: cursorViewport2, leafId: leafId2, originalLeafId: originalLeafId2 } = getCursor();
      let [prefix2, text2, suffix2, file2, from2, to2, portal, toggle] = processURI(dataString2);
      const cursorLeaf = workspace.getLeafById(leafId2);
      workspace.revealLeaf(cursorLeaf);
      const editorView2 = getEditorView(cursorLeaf);
      if (!editorView2)
        throw new Error("Editor view not found");
      highlightSelection(editorView2, from2, to2);
    } else {
      let containerEl = getContainerElement(targetLeaf);
      if (containerEl != null) {
        setTimeout(() => {
          var _a;
          (_a = containerEl.querySelector(".view-content")) == null ? void 0 : _a.setAttribute("style", "");
        }, 50);
      }
    }
  }
  if (temp && targetLeaf) {
    targetLeaf.detach();
    let originalLeaf = workspace.getLeafById(originalLeafId);
    if (!originalLeaf)
      throw new Error("Original leaf not found");
    workspace.revealLeaf(originalLeaf);
  }
  if (peek) {
    let originalLeaf = workspace.getLeafById(originalLeafId);
    if (!originalLeaf) {
      resetHover();
      throw new Error("Original leaf not found");
    }
    workspace.revealLeaf(originalLeaf);
  }
  resetHover();
}
async function endBacklinkHoverEffect() {
  if (!getBacklinkHover() || Object.keys(getBacklinkHover()).length == 0) {
    resetBacklinkHover();
    return;
  }
  const {
    dataString,
    leafId,
    originalLeafId,
    backlinkLeafId,
    temp,
    cursorViewport,
    peek,
    uuid,
    backlinkUUID
  } = getBacklinkHover();
  resetBacklinkHover();
  if (getCursor() != null && getCursor().dataString == dataString) {
    resetBacklinkHover();
    return;
  }
  const { workspace } = getThat();
  let targetLeaf = workspace.getLeafById(leafId);
  endEffectRemoveHighlights(workspace, leafId, uuid, backlinkUUID);
  if (cursorViewport && targetLeaf && targetLeaf.view instanceof import_obsidian2.MarkdownView) {
    const view = targetLeaf.view;
    view.editor.scrollTo(0, cursorViewport.top);
  }
  let containerEl = getContainerElement(targetLeaf);
  if (containerEl != null) {
    setTimeout(() => {
      var _a;
      (_a = containerEl.querySelector(".view-content")) == null ? void 0 : _a.setAttribute("style", "");
    }, 50);
  }
  let editorView = getEditorView(targetLeaf);
  let [prefix, text, suffix, file, from, to] = processURI(dataString);
  const originalLeaf = workspace.getLeafById(backlinkLeafId);
  if (!originalLeaf) {
    resetBacklinkHover();
    throw new Error("Original leaf not found");
  }
  let originalEditorView = getEditorView(originalLeaf);
  removeHighlight(originalEditorView, from, to);
  defaultHighlightSelection(originalEditorView, from, to);
  if (getCursor() != null && getCursor().dataString) {
    const { dataString: dataString2, cursorViewport: cursorViewport2, leafId: leafId2, originalLeafId: originalLeafId2 } = getCursor();
    let [prefix2, text2, suffix2, file2, from2, to2] = processURI(dataString2);
    const cursorLeaf = workspace.getLeafById(leafId2);
    workspace.revealLeaf(cursorLeaf);
    const editorView2 = getEditorView(cursorLeaf);
    highlightSelection(editorView2, from2, to2);
  }
  if (temp && targetLeaf) {
    targetLeaf.detach();
  }
  if (peek) {
    let originalLeaf2 = workspace.getLeafById(originalLeafId);
    if (!originalLeaf2) {
      resetBacklinkHover();
      throw new Error("Original leaf not found");
    }
    workspace.revealLeaf(originalLeaf2);
  }
  resetBacklinkHover();
}

// src/utils.ts
function encodeURIComponentString(str) {
  return encodeURIComponent(str).replace(/[:()]/g, function(c) {
    return "%" + c.charCodeAt(0).toString(16);
  });
}
function decodeURIComponentString(str) {
  return decodeURIComponent(
    str.replace(/%3A/g, ":").replace(/%28/g, "(").replace(/%29/g, ")")
  );
}
function processURI(dataString) {
  let [prefix, text, suffix, file, from, to, portal, toggle] = dataString.split(":");
  prefix = decodeURIComponentString(prefix);
  text = decodeURIComponentString(text);
  suffix = decodeURIComponentString(suffix);
  file = decodeURIComponentString(file);
  from = decodeURIComponentString(from);
  to = decodeURIComponentString(to);
  if (portal)
    portal = decodeURIComponentString(portal);
  toggle = decodeURIComponentString(toggle);
  return [
    prefix,
    text,
    suffix,
    file,
    parseInt(from),
    parseInt(to),
    portal,
    toggle
  ];
}
function getPrefixAndSuffix(document2, from, to) {
  let prefix = document2.slice(from - 25, from).split("\n").slice(-1)[0];
  let suffix = document2.slice(to, to + 25).split("\n")[0];
  return { prefix, suffix };
}
function findTextPositions(text, searchTerm, prefix = "", suffix = "") {
  let rollingIndex = 0;
  const lines = text.split("\n").map((line, i) => {
    let data = { line, index: rollingIndex, length: line.length + 1, i };
    rollingIndex += data.length;
    return data;
  });
  if (text.includes(prefix + searchTerm + suffix)) {
    let matchIndex = text.indexOf(prefix + searchTerm + suffix);
    let startIndex = lines.findIndex((line) => line.index > matchIndex + prefix.length) - 1;
    let endIndex = lines.findIndex(
      (line) => line.index > matchIndex + prefix.length + searchTerm.length
    ) - 1;
    if (startIndex == -2)
      startIndex = lines.length - 1;
    if (endIndex == -2)
      endIndex = lines.length - 1;
    return {
      rangeStart: {
        line: startIndex,
        ch: matchIndex + prefix.length - lines[startIndex].index
      },
      rangeEnd: {
        line: endIndex,
        ch: matchIndex + prefix.length + searchTerm.length - lines[endIndex].index
      },
      lines
    };
  }
  return null;
}
function checkCursorPositionAtDatastring(evt) {
  const activeView = this.app.workspace.getActiveViewOfType(import_obsidian3.MarkdownView);
  const cursorFrom = activeView == null ? void 0 : activeView.editor.getCursor("from");
  const cursorTo = activeView == null ? void 0 : activeView.editor.getCursor("to");
  let matched = false;
  let matchSpan = void 0;
  if (cursorFrom && cursorTo && cursorFrom.ch == cursorTo.ch && cursorFrom.line == cursorTo.line) {
    const lineText = activeView == null ? void 0 : activeView.editor.getLine(cursorFrom.line);
    if (lineText) {
      const matches = [...lineText.matchAll(REFERENCE_REGEX)];
      matches.forEach((match) => {
        var _a;
        if ((_a = match.index) == null ? void 0 : _a.toString()) {
          const start = match.index;
          const end = start + match[0].length;
          if (end == cursorTo.ch && evt.target) {
            const dataString = match[1];
            let checkContainer = evt.target instanceof Element;
            if (!checkContainer)
              throw new Error("Element not instance of Element");
            let container = evt.target;
            let span = container;
            if (!span.getAttribute("data"))
              span = container.querySelector(
                `span[data="${dataString}"]`
              );
            if (span && span instanceof HTMLSpanElement) {
              matched = true;
              matchSpan = span;
            } else {
            }
          }
        }
      });
    }
  }
  return { matched, span: matchSpan };
}
function handleRemoveHoveredCursor(user) {
  if (getHoveredCursor()) {
    let nonCursors = getHoveredCursor().filter((element) => {
      return element.user !== user;
    }).map((element) => element.cursor.closest("span"));
    getHoveredCursor().filter((element) => element.user === user).forEach((element) => {
      if (!nonCursors.includes(element.cursor.closest("span"))) {
        let svg = element.cursor;
        if (!svg)
          throw new Error("SVG not found");
        if (svg.classList.contains("reference-icon"))
          svg.style.backgroundColor = "white";
        else {
          svg.setAttribute("fill", "white");
          svg.style.backgroundColor = "";
        }
        element.cursor.style.backgroundColor = "white";
      }
    });
    removeHoveredCursor(user);
  }
}
async function checkFocusCursor(evt) {
  let { matched, span } = checkCursorPositionAtDatastring(evt);
  if (matched && span) {
    await endReferenceCursorEffect();
    handleRemoveHoveredCursor(ACTION_TYPE.CURSOR);
    updateHoveredCursorColor(span, ACTION_TYPE.CURSOR);
    await startReferenceEffect(span, ACTION_TYPE.CURSOR);
  } else {
    await endReferenceCursorEffect();
    handleRemoveHoveredCursor(ACTION_TYPE.CURSOR);
  }
}

// src/references.ts
function createReferenceIcon(portalText = null) {
  const span = document.createElement("span");
  span.style.cursor = "pointer";
  span.classList.add("reference-data-span");
  span.classList.add("uuid-" + v4_default());
  const height = REFERENCE_ICON_HEIGHT;
  const width = height * 0.9;
  if (portalText == null) {
    const svg2 = document.createElementNS("http://www.w3.org/2000/svg", "svg");
    return { span, svg: svg2 };
  }
  const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
  if (portalText != "inline reference widget |*|") {
    let portal = document.createElement("div");
    portal.classList.add("portal");
    portalText.split(":").forEach((text, index) => {
      if (index === 0 || index === 2)
        portal.innerHTML += decodeURIComponentString(text);
      else if (index === 1) {
        portal.innerHTML += `<span class="text-accent";>${text}</span>`;
      }
    });
    portal.style.userSelect = "none";
    portal.style.pointerEvents = "none";
    span.appendChild(portal);
  }
  return { span, svg };
}
function updateHoveredCursorColor(span, user) {
  const svg = span.querySelector("svg");
  const portal = span.querySelector(".portal");
  if (span && svg && !portal) {
    handleRemoveHoveredCursor(user);
    if (svg.classList.contains("reference-icon"))
      svg.style.backgroundColor = SVG_HOVER_COLOR;
    else {
      span = span.querySelector("span");
      span.style.backgroundColor = SVG_HOVER_COLOR;
    }
    updateHoveredCursor(svg, user);
  }
}
function getCodeMirrorEditorView(editor) {
  return editor.cm;
}
function getContainerElement(editorOrLeaf) {
  return editorOrLeaf.containerEl;
}
function getBacklinkID(backlink) {
  const jsonString = JSON.stringify(backlink);
  const id = v5_default(jsonString, "fb813ebb-1b53-4306-aa9c-655627447f0b");
  return `backlink-${id}`;
}
function getBacklinkContainer(editor) {
  const containerEl = getContainerElement(editor);
  const referenceMarkContainerID = "referenceMarkContainer";
  const container = containerEl.querySelector(`#${referenceMarkContainerID}`);
  if (container) {
    return container;
  } else {
    const newContainer = document.createElement("div");
    newContainer.id = referenceMarkContainerID;
    containerEl.querySelector(".cm-scroller").appendChild(newContainer);
    return newContainer;
  }
}
function getLeafBBoxElements(leaf) {
  const title = getContainerElement(leaf).querySelector(".inline-title");
  if (!title) {
    throw new Error("Missing title");
  }
  const titleBbox = title.getBoundingClientRect();
  const line = getContainerElement(leaf).querySelector(".cm-line");
  if (!line) {
    throw new Error("Document has no lines");
  }
  const lineBbox = line.getBoundingClientRect();
  return { titleBbox, lineBbox };
}
function updateBacklinkMarkPosition(leaf, backlinksToLeaf, showPortals) {
  const editor = getMarkdownView(leaf).editor;
  const backlinkContainer = getBacklinkContainer(editor);
  let backlinks2 = [];
  for (let i = 0; i < backlinkContainer.children.length; i++) {
    backlinks2.push(backlinkContainer.children.item(i));
  }
  let backlinkIds = backlinksToLeaf.map((x) => getBacklinkID(x));
  backlinks2.map((x) => x.id).forEach((id) => {
    if (!backlinkIds.includes(id)) {
      let element = document.getElementById(id);
      if (element)
        element.remove();
    }
  });
  const { titleBbox, lineBbox } = getLeafBBoxElements(leaf);
  let referenceMarkers = backlinksToLeaf.map((backlink) => {
    const { from } = backlink.referencedLocation;
    const bbox = getCodeMirrorEditorView(editor).coordsAtPos(from);
    if (!bbox)
      return;
    let referenceMarker = backlinkContainer.querySelector(
      `#${getBacklinkID(backlink)}`
    );
    if (referenceMarker === null) {
      referenceMarker = createBacklinkMark(backlink);
      backlinkContainer.appendChild(referenceMarker);
    }
    if (bbox) {
      referenceMarker.style.position = "absolute";
      referenceMarker.setAttribute("top", bbox.top.toString());
      referenceMarker.style.top = bbox.top - titleBbox.top + 32 + "px";
      referenceMarker.style.left = lineBbox.width + 40 + "px";
    }
    return referenceMarker;
  });
  let lastYBottom = -Infinity;
  let margin = 4;
  referenceMarkers.sort(
    (a, b) => parseInt(a.getAttribute("top")) - parseInt(b.getAttribute("top"))
  ).forEach((marker) => {
    if (!marker)
      return;
    const portal = marker.querySelector(".portal");
    if (showPortals) {
      if (portal) {
        portal.style.display = "inline";
        marker.classList.add("backlink-span");
      }
    } else {
      if (portal) {
        portal.style.display = "none";
      }
      marker.classList.remove("backlink-span");
    }
    let top = parseInt(marker.getAttribute("top"));
    top = Math.max(top, lastYBottom + margin);
    lastYBottom = top + marker.getBoundingClientRect().height + margin;
    marker.setAttribute("top", top.toString());
    marker.style.top = top - titleBbox.top + 32 + "px";
    marker.style.left = lineBbox.width + 40 + "px";
  });
}
var debounceTimer;
async function updateBacklinkMarkPositions() {
  clearTimeout(debounceTimer);
  debounceTimer = setTimeout(async () => {
    const leaves = getThat().workspace.getLeavesOfType(
      "markdown"
    );
    setTimeout(async () => {
      const allBacklinks = await recomputeReferencesForPage();
      leaves.map(async (leaf) => {
        const backlinksToLeaf = allBacklinks.filter(
          // @ts-ignore
          (b) => b.referencedLocation.filename == leaf.view.file.path
        );
        const showPortals = getContainerElement(leaf).innerWidth > 900;
        updateBacklinkMarkPosition(leaf, backlinksToLeaf, showPortals);
      });
      await Promise.all(
        leaves.map(async (leaf) => {
          const backlinksToLeaf = allBacklinks.filter(
            // @ts-ignore
            (b) => b.referencedLocation.filename == leaf.view.file.path
          );
          const showPortals = getContainerElement(leaf).innerWidth > 900;
          updateBacklinkMarkPosition(leaf, backlinksToLeaf, showPortals);
        })
      );
    }, 500);
  }, 100);
}
function createBacklinkMark(backlink) {
  let { span, svg } = createReferenceIcon(backlink.portalText);
  span.classList.add("backlink-data-span");
  const portal = span.querySelector(".portal");
  span.style.position = "absolute";
  span.id = getBacklinkID(backlink);
  span.setAttribute("reference", JSON.stringify(backlink));
  const resizeObserver = new ResizeObserver((entries) => {
    if (portal && portal.style.display != "none") {
      span.classList.add("backlink-portal-open");
    } else {
      span.classList.remove("backlink-portal-open");
    }
  });
  resizeObserver.observe(span);
  span.addEventListener("click", openBacklinkReference);
  return span;
}
async function addReferencesToLeaf(leaf) {
  const markdownView = getMarkdownView(leaf);
  let workspaceTabs = markdownView.containerEl.closest(".workspace-tabs");
  if (!workspaceTabs) {
    throw new Error("Missing workspace tabs");
  }
  await updateBacklinkMarkPositions();
  await delay(2e3);
  generateDefaultHighlights(leaf);
  getContainerElement(markdownView.editor).querySelector(".cm-scroller").addEventListener("scroll", async () => {
    await updateBacklinkMarkPositions();
    await delay(2e3);
    generateDefaultHighlights(leaf);
  });
  let resizeObserver = new ResizeObserver(async () => {
    await updateBacklinkMarkPositions();
    await delay(2e3);
    generateDefaultHighlights(leaf);
  });
  resizeObserver.observe(workspaceTabs);
  return leaf;
}
function getMarkdownView(leaf) {
  if (!(leaf.view instanceof import_obsidian4.MarkdownView)) {
    throw new Error("Unexpected non-markdown view");
  }
  return leaf.view;
}
function findMatchPositions(line, regex) {
  let match;
  const positions = [];
  while ((match = regex.exec(line)) !== null) {
    positions.push({
      match: match[0],
      start: match.index,
      end: match.index + match[0].length
    });
  }
  return positions;
}
function createBacklinkData(referencingFileData, referencingFile) {
  let backlinks2 = [];
  let matches = [...referencingFileData.matchAll(REFERENCE_REGEX)];
  matches.forEach((match) => {
    if (match[1].split(":").length != 8)
      return;
    let [prefix, text, suffix, filename, from, to, portal, toggle] = processURI(
      match[1]
    );
    const referencedLocation = {
      prefix,
      text,
      suffix,
      filename,
      from,
      to,
      portal,
      toggle
    };
    let index = referencingFileData.indexOf(match[0]);
    const referencingSurroundingStrings = getPrefixAndSuffix(
      referencingFileData,
      index,
      index + match[0].length
    );
    const referencingLocation = {
      // prefix: referencingFileData.slice(index - 25, index),
      prefix: referencingSurroundingStrings.prefix,
      text: referencingFileData.slice(index, index + match[0].length),
      // suffix: referencingFileData.slice(
      // 	index + match[0].length,
      // 	index + match[0].length + 25
      // ),
      suffix: referencingSurroundingStrings.suffix,
      filename: referencingFile.path,
      from: match.index,
      // TODO do weird string format
      to: match.index + match[0].length,
      // TODO do weird string format
      portal,
      toggle
    };
    if (portal == "portal") {
      const getLineText = (text2, index2) => {
        const startOfLine = text2.lastIndexOf("\n", index2 - 1) + 1;
        const endOfLine = text2.indexOf("\n", index2);
        return text2.slice(
          startOfLine,
          endOfLine !== -1 ? endOfLine : void 0
        );
      };
      let line = getLineText(referencingFileData, index);
      let matchPositions = findMatchPositions(
        line,
        new RegExp(REFERENCE_REGEX)
      );
      let matchIndex = 0;
      for (let i = 0; i < matchPositions.length; i++) {
        if (matchPositions[i].match == match[0]) {
          break;
        } else {
          matchIndex += matchPositions[i].end - matchPositions[i].start - 1;
        }
      }
      let portalText = line.replace(new RegExp(REFERENCE_REGEX, "g"), "\u2197");
      let portalTextSlice = portalText.slice(0, PORTAL_TEXT_SLICE_SIZE);
      let portalTextIndex = line.indexOf(match[0]) - matchIndex;
      portalTextSlice = "\u2197";
      let startPortalText = portalText.substring(
        Math.max(portalTextIndex - 25, 0),
        portalTextIndex
      );
      if (portalText.substring(Math.max(portalTextIndex - 25, 0), portalTextIndex).length > 0 && portalTextIndex - 25 > 0)
        startPortalText = "..." + startPortalText;
      let endPortalText = portalText.substring(
        portalTextIndex + 1,
        Math.max(portalTextIndex + 25, portalText.length)
      );
      if (portalText.substring(
        portalTextIndex + 1,
        Math.max(portalTextIndex + 25, portalText.length)
      ).length > 0 && portalTextIndex + 25 < portalText.length)
        endPortalText = endPortalText + "...";
      backlinks2.push({
        referencedLocation,
        referencingLocation,
        dataString: match[1],
        portalText: encodeURIComponentString(startPortalText) + ":" + portalTextSlice + ":" + encodeURIComponentString(endPortalText)
      });
    } else {
      backlinks2.push({
        referencedLocation,
        referencingLocation,
        dataString: match[1]
      });
    }
  });
  return backlinks2;
}
async function generateBacklinks() {
  console.log("generating references");
  let backlinks2 = [];
  let markdownFiles = this.app.vault.getMarkdownFiles();
  await Promise.all(
    markdownFiles.map((file) => this.app.vault.read(file))
  ).then((files) => {
    const zippedArray = markdownFiles.map((file, index) => ({
      markdownFile: file,
      fileData: files[index]
    }));
    zippedArray.forEach((file) => {
      let fileBacklinks = createBacklinkData(file.fileData, file.markdownFile);
      updateBacklinks(fileBacklinks);
      backlinks2.push(...fileBacklinks);
    });
  });
}
async function recomputeReferencesForPage() {
  let references = [];
  let markdownFiles = this.app.vault.getMarkdownFiles();
  let promises = markdownFiles.map((file) => this.app.vault.read(file));
  let files = await Promise.all(promises);
  const zippedArray = markdownFiles.map((file, index) => ({
    markdownFile: file,
    fileData: files[index]
  }));
  zippedArray.forEach((file) => {
    let fileBacklinks = createBacklinkData(file.fileData, file.markdownFile);
    updateBacklinks(fileBacklinks);
    references.push(...fileBacklinks);
  });
  return references;
}
async function openBacklinkReference(ev) {
  let cursor = getCursor();
  let hover = getBacklinkHover();
  let leaf = getThat().workspace.getLeafById(hover.leafId);
  let container = leaf.containerEl;
  if (!container)
    throw new Error("Container not found");
  container.querySelector(".view-content").style.boxShadow = "none";
  if (cursor && hover && cursor.dataString && hover.dataString && cursor.dataString == hover.dataString) {
    updateCursor({
      temp: false,
      cursorViewport: null,
      peek: false
    });
  }
  updateBacklinkHover({
    temp: false,
    cursorViewport: null,
    peek: false
  });
  handleRemoveHoveredCursor(ACTION_TYPE.CURSOR);
  resetCursor();
}
async function openReference(ev) {
  let cursor = getCursor();
  let hover = getHover();
  let leaf = getThat().workspace.getLeafById(hover.leafId);
  let container = leaf.containerEl;
  if (!container)
    throw new Error("Container not found");
  container.querySelector(".view-content").style.boxShadow = "none";
  if (cursor && hover && cursor.dataString && hover.dataString && cursor.dataString == hover.dataString) {
    updateCursor({
      temp: false,
      cursorViewport: null,
      peek: false
    });
  }
  updateHover({
    temp: false,
    cursorViewport: null,
    peek: false
  });
  handleRemoveHoveredCursor(ACTION_TYPE.CURSOR);
  resetCursor();
}

// src/widget/referenceWidget.ts
function processLine(line) {
  let lineCopy = line == null ? void 0 : line.cloneNode(true);
  lineCopy == null ? void 0 : lineCopy.querySelectorAll(".reference-span").forEach((span) => {
    span.innerHTML = "\u2197";
  });
  return lineCopy;
}
async function serializeReference(content, referenceSpan, view) {
  var _a;
  content = typeof content == "string" ? content : content[1];
  const [prefix, text, suffix, file, from, to, portal, toggle = "f"] = content.split(":");
  let newToggle = referenceSpan.classList.contains("reference-span-hidden") ? "f" : "t";
  let reference = `[\u2197](urn:${prefix}:${text}:${suffix}:${file}:${from}:${to}:${portal}:${newToggle})`;
  let lines = view.contentDOM.querySelectorAll(".cm-line");
  let currLine = (_a = referenceSpan == null ? void 0 : referenceSpan.parentElement) == null ? void 0 : _a.parentElement;
  let activeLineIndex;
  let seenActive = false;
  lines.forEach((line, i) => {
    if (seenActive)
      return;
    if (line == currLine) {
      seenActive = true;
      activeLineIndex = i;
    }
  });
  if (activeLineIndex === void 0)
    return;
  let activeLine = lines[activeLineIndex];
  let activeLineCopy = processLine(activeLine);
  let parts = activeLineCopy.innerText.split("\u2197");
  let lineReferences = activeLine == null ? void 0 : activeLine.querySelectorAll(".reference-data-span");
  let lineReferencesData = Array.from(lineReferences || []).map(
    (span) => "[\u2197](urn:" + span.getAttribute("data") + ")"
  );
  if (content) {
    const index = lineReferencesData.reduce(
      (prevIndex, currentValue, currentIndex) => {
        if (currentValue.includes(content[0])) {
          return currentIndex;
        }
        return prevIndex;
      },
      null
    );
    if (!index && index != 0)
      throw new Error("Reference not found");
    let startText = [
      ...parts.slice(0, index + 1),
      ...lineReferencesData.slice(0, index)
    ];
    let prevLineCharCount = Array.from(lines).slice(0, activeLineIndex).reduce((acc, line) => {
      let processedLine = processLine(line);
      let parts2 = processedLine.innerText.split("\u2197");
      let lineReferences2 = line == null ? void 0 : line.querySelectorAll(".reference-data-span");
      let lineReferencesData2 = Array.from(lineReferences2 || []).map(
        (span) => "[\u2197](urn:" + span.getAttribute("data") + ")"
      );
      let allSerializedText = [...parts2, ...lineReferencesData2].join("") + "\n";
      return allSerializedText.length + acc;
    }, 0);
    let from2 = prevLineCharCount + startText.join("").length;
    let to2 = from2 + reference.length;
    const transaction = view.state.update({
      changes: { from: from2, to: to2, insert: reference }
    });
    console.log(transaction);
    view.dispatch(transaction);
    await updateBacklinkMarkPositions();
  }
}
var ReferenceWidget = class extends import_view4.WidgetType {
  constructor(name, view, pos) {
    super();
    this.name = name;
    this.view = view;
    this.pos = pos;
  }
  eq(other) {
    return this.name === other.name;
  }
  async updateName(name, from, to) {
    this.name = name;
  }
  getView() {
    return this.view;
  }
  toDOM() {
    const regex = /\[↗\]\(urn:([^)]*)\)/g;
    let content = regex.exec(this.name);
    if (!content)
      throw new Error("Invalid reference");
    const [prefix, text, suffix, file, from, to, portal, toggle = "f"] = content[1].split(":");
    const { span, svg } = createReferenceIcon(
      portal == "portal" ? "inline reference widget |*|" : null
    );
    if (content)
      span.setAttribute("data", content[1]);
    const containerSpan = document.createElement("span");
    containerSpan.classList.add("reference-container-span");
    const referenceSpan = document.createElement("span");
    referenceSpan.classList.add("reference-span");
    referenceSpan.innerHTML = decodeURIComponentString(text);
    referenceSpan.classList.toggle("reference-span-hidden", toggle === "f");
    containerSpan.appendChild(referenceSpan);
    containerSpan.appendChild(span);
    containerSpan.addEventListener("click", async (ev) => {
      if (ev.metaKey || ev.ctrlKey) {
        referenceSpan.classList.toggle("reference-span-hidden");
        await serializeReference(content, referenceSpan, this.view);
        if (content)
          this.name = content[0];
      } else {
        openReference(ev);
      }
    });
    return containerSpan;
  }
};
var referenceDecoration = (match, view, pos) => {
  let decoration = import_view4.Decoration.replace({
    widget: new ReferenceWidget(match[0], view, pos)
  });
  return decoration;
};
var referenceMatcher = new import_view4.MatchDecorator({
  // regexp: /\[\u2197\]\(urn:[\s\S^\)]*\)/g,
  // regexp: /\[\u2197\]\(urn:([^:]*:){5,6}[^:]*\)/g,
  // regexp: /\[\u2197\]\(urn:([^:]*:){6}[^:)]*\)/g,
  regexp: /\[\u2197\]\(urn:([^:]*:){7}[^:)]*\)/g,
  decoration: (match, view, pos) => {
    return referenceDecoration(match, view, pos);
  }
});
var referenceResources = import_view4.ViewPlugin.fromClass(
  class {
    constructor(view) {
      this.referenceResources = referenceMatcher.createDeco(view);
    }
    update(update) {
      this.referenceResources = referenceMatcher.updateDeco(
        update,
        this.referenceResources
      );
    }
    destroy() {
      this.referenceResources = import_view4.Decoration.none;
    }
  },
  {
    decorations: (instance) => instance.referenceResources,
    provide: (plugin) => import_view4.EditorView.atomicRanges.of((view) => {
      var _a;
      return ((_a = view.plugin(plugin)) == null ? void 0 : _a.referenceResources) || import_view4.Decoration.none;
    })
  }
);

// src/clipboard.ts
var import_obsidian5 = require("obsidian");
async function updateClipboard(toggle = false, only = false) {
  const view = this.app.workspace.getActiveViewOfType(import_obsidian5.MarkdownView);
  if (view) {
    let selection = view.editor.getSelection();
    if (view.file) {
      const text = view.data;
      const from = view.editor.posToOffset(view.editor.getCursor("from"));
      const to = view.editor.posToOffset(view.editor.getCursor("to"));
      const { prefix, suffix } = getPrefixAndSuffix(text, from, to);
      let reference = `[\u2197](urn:${encodeURIComponentString(
        prefix
      )}-:${encodeURIComponentString(selection)}:-${encodeURIComponentString(
        suffix
      )}:${encodeURIComponentString(view.file.path)}:${from}:${to}:${// only ? "portal" : "no-portal"
      "portal"}:${toggle ? "t" : "f"})`;
      await navigator.clipboard.writeText(reference);
    }
  }
}

// src/main.ts
var import_view5 = require("@codemirror/view");
function generateDefaultHighlights(leaf) {
  const editor = getMarkdownView(leaf).editor;
  const backlinkContainer = getBacklinkContainer(editor);
  let backlinks2 = [];
  for (let i = 0; i < backlinkContainer.children.length; i++) {
    backlinks2.push(backlinkContainer.children.item(i));
  }
  for (let backlink of backlinks2) {
    let reference = backlink.getAttribute("reference") ? JSON.parse(backlink.getAttribute("reference")) : null;
    if (reference) {
      let referenceFrom = reference.referencedLocation.from;
      let referenceTo = reference.referencedLocation.to;
      let editorView = getCodeMirrorEditorView(editor);
      defaultHighlightSelection(editorView, referenceFrom, referenceTo);
    }
  }
}
var ReferencePlugin = class extends import_obsidian6.Plugin {
  onload() {
    setTimeout(async () => {
      await generateBacklinks();
      const leaves = this.app.workspace.getLeavesOfType("markdown");
      let promises = leaves.map(
        (leaf) => {
          return addReferencesToLeaf(leaf);
        }
      );
      Promise.all(promises).then(async (leaves2) => {
        await delay(2e3);
        leaves2.forEach((leaf) => {
          generateDefaultHighlights(leaf);
        });
      });
      this.registerEvent(
        this.app.workspace.on("active-leaf-change", async (ev) => {
          try {
            const activeView = this.app.workspace.getActiveViewOfType(import_obsidian6.MarkdownView);
            if ((activeView == null ? void 0 : activeView.leaf) != null) {
              await addReferencesToLeaf(activeView.leaf);
              await delay(2e3);
              generateDefaultHighlights(activeView.leaf);
            }
          } catch (e) {
            console.log(e);
          }
        })
      );
    }, 4e3);
    updateThat(this);
    this.registerEditorExtension([
      highlights,
      referenceResources,
      import_view5.EditorView.updateListener.of(function(e) {
        if (Math.abs(e.changes.desc.newLength - e.changes.desc.length) > 1) {
          updateBacklinkMarkPositions();
        }
      })
    ]);
    this.registerDomEvent(document, "mousemove", async (evt) => {
      if (evt.metaKey || evt.ctrlKey)
        return;
      let span;
      if (evt.target && (evt.target instanceof HTMLSpanElement || evt.target instanceof SVGElement || evt.target instanceof SVGPathElement)) {
        span = evt.target;
        while (!(span instanceof HTMLSpanElement) && span.parentElement != null) {
          span = span.parentElement;
        }
      }
      if (span && span instanceof HTMLSpanElement && (span == null ? void 0 : span.parentElement) && (span == null ? void 0 : span.parentElement.classList.contains("reference-container-span"))) {
        console.log("start hover reference effect");
        if (getHover() != null)
          return;
        if (!span.getAttribute("data")) {
          span = span.parentElement;
          span = span.querySelector(".reference-data-span");
          if (!span)
            throw new Error("Span element not found");
        }
        updateHoveredCursorColor(span, ACTION_TYPE.MOUSE);
        startReferenceEffect(span, ACTION_TYPE.MOUSE);
      } else if (span && span instanceof HTMLSpanElement && span.getAttribute("reference")) {
        console.log("start hover backlink effect");
        if (getBacklinkHover() != null)
          return;
        startBacklinkEffect(span);
      } else if (getHover() != null) {
        console.log("end hover reference effect");
        const requiredKeys = [
          "dataString",
          "leafId",
          "originalLeafId",
          "temp",
          "cursorViewport",
          "peek",
          "uuid"
        ];
        const allKeysPresent = () => requiredKeys.every((key) => key in getHover());
        if (!allKeysPresent()) {
          await new Promise((resolve) => setTimeout(resolve, 50));
        }
        await endReferenceHoverEffect();
        handleRemoveHoveredCursor(ACTION_TYPE.MOUSE);
      } else if (getBacklinkHover() != null) {
        console.log("end hover backlink effect");
        const requiredKeys = [
          "dataString",
          "leafId",
          "originalLeafId",
          "backlinkLeafId",
          "temp",
          "cursorViewport",
          "peek",
          "uuid",
          "backlinkUUID"
        ];
        const allKeysPresent = () => requiredKeys.every((key) => key in getBacklinkHover());
        if (!allKeysPresent()) {
          await new Promise((resolve) => setTimeout(resolve, 50));
        }
        console.log("start end backlink effect!!!!!");
        await endBacklinkHoverEffect();
      } else {
      }
    });
    this.registerDomEvent(document, "click", async (evt) => {
      console.log("click");
      await checkFocusCursor(evt);
      updateBacklinkMarkPositions();
    });
    this.registerDomEvent(document, "keyup", async (evt) => {
      if (evt.metaKey || evt.ctrlKey)
        return;
      await checkFocusCursor(evt);
      updateBacklinkMarkPositions();
    });
    this.registerDomEvent(document, "keydown", async (evt) => {
      console.log(evt.key);
      console.log(evt.shiftKey);
      console.log(evt.ctrlKey);
      console.log(evt.metaKey);
      console.log(
        evt.key == "s" && (evt.metaKey || evt.ctrlKey) && evt.shiftKey
      );
      if (evt.key == "\xC7" && (evt.metaKey || evt.ctrlKey) && evt.shiftKey && evt.altKey) {
        updateClipboard(false);
        new import_obsidian6.Notice("Copied reference to clipboard");
      } else if ((evt.key == "c" || evt.key == "C") && (evt.metaKey || evt.ctrlKey) && evt.shiftKey) {
        updateClipboard(true);
        new import_obsidian6.Notice("Copied reference to clipboard");
      } else if ((evt.key == "s" || evt.key == "S") && (evt.metaKey || evt.ctrlKey) && evt.shiftKey) {
        let target = evt.target;
        let children = Array.from(target.children);
        let currentLine = children.filter(
          (child) => child.classList.contains("cm-active")
        )[0];
        const spans = Array.from(
          currentLine.querySelectorAll(".reference-span")
        );
        if (spans.every(
          (span) => span.classList.contains("reference-span-hidden")
        ) || !spans.every(
          (span) => span.classList.contains("reference-span-hidden")
        ) && spans.reduce((acc, span) => {
          if (acc)
            return acc;
          return span.classList.contains("reference-span-hidden");
        }, false)) {
          spans.forEach((span) => {
            var _a;
            span.classList.toggle("reference-span-hidden", false);
            let referenceSpan = (_a = span.parentElement) == null ? void 0 : _a.querySelector(
              ".reference-data-span"
            );
            let content = referenceSpan == null ? void 0 : referenceSpan.getAttribute("data");
            const activeView = this.app.workspace.getLeaf();
            const editor = getMarkdownView(activeView).editor;
            const editorView = getCodeMirrorEditorView(editor);
            serializeReference(content, span, editorView);
          });
          new import_obsidian6.Notice("Toggle annotations on");
        } else {
          spans.forEach((span) => {
            spans.forEach((span2) => {
              var _a;
              span2.classList.toggle("reference-span-hidden", true);
              let referenceSpan = (_a = span2.parentElement) == null ? void 0 : _a.querySelector(
                ".reference-data-span"
              );
              let content = referenceSpan == null ? void 0 : referenceSpan.getAttribute("data");
              const activeView = this.app.workspace.getLeaf();
              const editor = getMarkdownView(activeView).editor;
              const editorView = getCodeMirrorEditorView(editor);
              serializeReference(content, span2, editorView);
            });
          });
          new import_obsidian6.Notice("Toggle annotations off");
        }
      }
    });
  }
  onunload() {
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL3N0YXRlLnRzIiwgInNyYy93aWRnZXQvaGlnaGxpZ2h0V2lkZ2V0LnRzIiwgInNyYy9jb25zdGFudHMudHMiLCAic3JjL3dpZGdldC9yZWZlcmVuY2VXaWRnZXQudHMiLCAic3JjL3JlZmVyZW5jZXMudHMiLCAibm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci9ybmcuanMiLCAibm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci9yZWdleC5qcyIsICJub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS1icm93c2VyL3ZhbGlkYXRlLmpzIiwgIm5vZGVfbW9kdWxlcy91dWlkL2Rpc3QvZXNtLWJyb3dzZXIvc3RyaW5naWZ5LmpzIiwgIm5vZGVfbW9kdWxlcy91dWlkL2Rpc3QvZXNtLWJyb3dzZXIvcGFyc2UuanMiLCAibm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci92MzUuanMiLCAibm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci9uYXRpdmUuanMiLCAibm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci92NC5qcyIsICJub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS1icm93c2VyL3NoYTEuanMiLCAibm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci92NS5qcyIsICJzcmMvdXRpbHMudHMiLCAic3JjL3dvcmtzcGFjZS50cyIsICJzcmMvZWZmZWN0cy50cyIsICJzcmMvbWFyay50cyIsICJzcmMvY2xpcGJvYXJkLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBQbHVnaW4sIE1hcmtkb3duVmlldywgTm90aWNlLCBXb3Jrc3BhY2VMZWFmIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5cbmltcG9ydCB7XG5cdHVwZGF0ZVRoYXQsXG5cdGdldEhvdmVyLFxuXHRnZXRCYWNrbGlua3MsXG5cdGdldEJhY2tsaW5rSG92ZXIsXG5cdGdldFRoYXQsXG5cdGdldEN1cnNvcixcbn0gZnJvbSBcIi4vc3RhdGVcIjtcbmltcG9ydCB7IGhpZ2hsaWdodHMsIHJlZmVyZW5jZVJlc291cmNlcyB9IGZyb20gXCIuL3dpZGdldFwiO1xuaW1wb3J0IHsgdXBkYXRlQ2xpcGJvYXJkIH0gZnJvbSBcIi4vY2xpcGJvYXJkXCI7XG5pbXBvcnQge1xuXHRnZW5lcmF0ZUJhY2tsaW5rcyxcblx0YWRkUmVmZXJlbmNlc1RvTGVhZixcblx0dXBkYXRlQmFja2xpbmtNYXJrUG9zaXRpb25zLFxuXHR1cGRhdGVIb3ZlcmVkQ3Vyc29yQ29sb3IsXG5cdGdldE1hcmtkb3duVmlldyxcblx0Z2V0QmFja2xpbmtDb250YWluZXIsXG5cdGdldENvZGVNaXJyb3JFZGl0b3JWaWV3LFxufSBmcm9tIFwiLi9yZWZlcmVuY2VzXCI7XG5pbXBvcnQge1xuXHRzdGFydFJlZmVyZW5jZUVmZmVjdCxcblx0ZW5kUmVmZXJlbmNlSG92ZXJFZmZlY3QsXG5cdHN0YXJ0QmFja2xpbmtFZmZlY3QsXG5cdGVuZEJhY2tsaW5rSG92ZXJFZmZlY3QsXG5cdGVuZFJlZmVyZW5jZUN1cnNvckVmZmVjdCxcblx0ZGVsYXksXG59IGZyb20gXCIuL2VmZmVjdHNcIjtcbmltcG9ydCB7IGNoZWNrRm9jdXNDdXJzb3IsIGhhbmRsZVJlbW92ZUhvdmVyZWRDdXJzb3IgfSBmcm9tIFwiLi91dGlsc1wiO1xuaW1wb3J0IHsgQUNUSU9OX1RZUEUgfSBmcm9tIFwiLi9jb25zdGFudHNcIjtcbmltcG9ydCB7IEVkaXRvclZpZXcgfSBmcm9tIFwiQGNvZGVtaXJyb3Ivdmlld1wiO1xuaW1wb3J0IHsgc2VyaWFsaXplUmVmZXJlbmNlIH0gZnJvbSBcIi4vd2lkZ2V0L3JlZmVyZW5jZVdpZGdldFwiO1xuaW1wb3J0IHsgZGVmYXVsdEhpZ2hsaWdodFNlbGVjdGlvbiB9IGZyb20gXCIuL21hcmtcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIGdlbmVyYXRlRGVmYXVsdEhpZ2hsaWdodHMobGVhZjogV29ya3NwYWNlTGVhZikge1xuXHRjb25zdCBlZGl0b3IgPSBnZXRNYXJrZG93blZpZXcobGVhZikuZWRpdG9yO1xuXHRjb25zdCBiYWNrbGlua0NvbnRhaW5lciA9IGdldEJhY2tsaW5rQ29udGFpbmVyKGVkaXRvcik7XG5cblx0bGV0IGJhY2tsaW5rcyA9IFtdO1xuXHRmb3IgKGxldCBpID0gMDsgaSA8IGJhY2tsaW5rQ29udGFpbmVyLmNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG5cdFx0YmFja2xpbmtzLnB1c2goYmFja2xpbmtDb250YWluZXIuY2hpbGRyZW4uaXRlbShpKSBhcyBIVE1MRWxlbWVudCk7XG5cdH1cblxuXHRmb3IgKGxldCBiYWNrbGluayBvZiBiYWNrbGlua3MpIHtcblx0XHRsZXQgcmVmZXJlbmNlID0gYmFja2xpbmsuZ2V0QXR0cmlidXRlKFwicmVmZXJlbmNlXCIpXG5cdFx0XHQ/IEpTT04ucGFyc2UoYmFja2xpbmsuZ2V0QXR0cmlidXRlKFwicmVmZXJlbmNlXCIpISlcblx0XHRcdDogbnVsbDtcblx0XHRpZiAocmVmZXJlbmNlKSB7XG5cdFx0XHRsZXQgcmVmZXJlbmNlRnJvbSA9IHJlZmVyZW5jZS5yZWZlcmVuY2VkTG9jYXRpb24uZnJvbTtcblx0XHRcdGxldCByZWZlcmVuY2VUbyA9IHJlZmVyZW5jZS5yZWZlcmVuY2VkTG9jYXRpb24udG87XG5cdFx0XHRsZXQgZWRpdG9yVmlldyA9IGdldENvZGVNaXJyb3JFZGl0b3JWaWV3KGVkaXRvcik7XG5cdFx0XHRkZWZhdWx0SGlnaGxpZ2h0U2VsZWN0aW9uKGVkaXRvclZpZXcsIHJlZmVyZW5jZUZyb20sIHJlZmVyZW5jZVRvKTtcblx0XHR9XG5cdH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUmVmZXJlbmNlUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcblx0b25sb2FkKCkge1xuXHRcdHNldFRpbWVvdXQoYXN5bmMgKCkgPT4ge1xuXHRcdFx0YXdhaXQgZ2VuZXJhdGVCYWNrbGlua3MoKTtcblx0XHRcdGNvbnN0IGxlYXZlcyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoXCJtYXJrZG93blwiKTtcblxuXHRcdFx0bGV0IHByb21pc2VzOiBQcm9taXNlPFdvcmtzcGFjZUxlYWY+W10gPSBsZWF2ZXMubWFwKFxuXHRcdFx0XHQobGVhZjogV29ya3NwYWNlTGVhZikgPT4ge1xuXHRcdFx0XHRcdC8vIGF3YWl0IGFkZFJlZmVyZW5jZXNUb0xlYWYobGVhZik7XG5cdFx0XHRcdFx0cmV0dXJuIGFkZFJlZmVyZW5jZXNUb0xlYWYobGVhZik7XG5cdFx0XHRcdH1cblx0XHRcdCk7XG5cblx0XHRcdFByb21pc2UuYWxsKHByb21pc2VzKS50aGVuKGFzeW5jIChsZWF2ZXM6IFdvcmtzcGFjZUxlYWZbXSkgPT4ge1xuXHRcdFx0XHRhd2FpdCBkZWxheSgyMDAwKTtcblx0XHRcdFx0bGVhdmVzLmZvckVhY2goKGxlYWY6IFdvcmtzcGFjZUxlYWYpID0+IHtcblx0XHRcdFx0XHRnZW5lcmF0ZURlZmF1bHRIaWdobGlnaHRzKGxlYWYpO1xuXHRcdFx0XHRcdC8vIGNvbnN0IGVkaXRvciA9IGdldE1hcmtkb3duVmlldyhsZWFmKS5lZGl0b3I7XG5cdFx0XHRcdFx0Ly8gY29uc3QgYmFja2xpbmtDb250YWluZXIgPSBnZXRCYWNrbGlua0NvbnRhaW5lcihlZGl0b3IpO1xuXG5cdFx0XHRcdFx0Ly8gbGV0IGJhY2tsaW5rcyA9IFtdO1xuXHRcdFx0XHRcdC8vIGZvciAobGV0IGkgPSAwOyBpIDwgYmFja2xpbmtDb250YWluZXIuY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHQvLyBcdGJhY2tsaW5rcy5wdXNoKGJhY2tsaW5rQ29udGFpbmVyLmNoaWxkcmVuLml0ZW0oaSkgYXMgSFRNTEVsZW1lbnQpO1xuXHRcdFx0XHRcdC8vIH1cblxuXHRcdFx0XHRcdC8vIGZvciAobGV0IGJhY2tsaW5rIG9mIGJhY2tsaW5rcykge1xuXHRcdFx0XHRcdC8vIFx0bGV0IHJlZmVyZW5jZSA9IGJhY2tsaW5rLmdldEF0dHJpYnV0ZShcInJlZmVyZW5jZVwiKVxuXHRcdFx0XHRcdC8vIFx0XHQ/IEpTT04ucGFyc2UoYmFja2xpbmsuZ2V0QXR0cmlidXRlKFwicmVmZXJlbmNlXCIpISlcblx0XHRcdFx0XHQvLyBcdFx0OiBudWxsO1xuXHRcdFx0XHRcdC8vIFx0aWYgKHJlZmVyZW5jZSkge1xuXHRcdFx0XHRcdC8vIFx0XHRsZXQgcmVmZXJlbmNlRnJvbSA9IHJlZmVyZW5jZS5yZWZlcmVuY2VkTG9jYXRpb24uZnJvbTtcblx0XHRcdFx0XHQvLyBcdFx0bGV0IHJlZmVyZW5jZVRvID0gcmVmZXJlbmNlLnJlZmVyZW5jZWRMb2NhdGlvbi50bztcblx0XHRcdFx0XHQvLyBcdFx0bGV0IGVkaXRvclZpZXcgPSBnZXRDb2RlTWlycm9yRWRpdG9yVmlldyhlZGl0b3IpO1xuXHRcdFx0XHRcdC8vIFx0XHRkZWZhdWx0SGlnaGxpZ2h0U2VsZWN0aW9uKGVkaXRvclZpZXcsIHJlZmVyZW5jZUZyb20sIHJlZmVyZW5jZVRvKTtcblx0XHRcdFx0XHQvLyBcdH1cblx0XHRcdFx0XHQvLyB9XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG5cblx0XHRcdHRoaXMucmVnaXN0ZXJFdmVudChcblx0XHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLm9uKFwiYWN0aXZlLWxlYWYtY2hhbmdlXCIsIGFzeW5jIChldikgPT4ge1xuXHRcdFx0XHRcdC8vIFRoaXMgc2hvdWxkIGNyZWF0ZSByZWZlcmVuY2VNYXJrZXJzIGlmIHRoZXkgZG9uJ3QgZXhpc3QgYW5kIHVwZGF0ZVxuXHRcdFx0XHRcdC8vIGVsc2UgdXBkYXRlIG9ubHlcblxuXHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRjb25zdCBhY3RpdmVWaWV3ID1cblx0XHRcdFx0XHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcblx0XHRcdFx0XHRcdGlmIChhY3RpdmVWaWV3Py5sZWFmICE9IG51bGwpIHtcblx0XHRcdFx0XHRcdFx0YXdhaXQgYWRkUmVmZXJlbmNlc1RvTGVhZihhY3RpdmVWaWV3LmxlYWYpO1xuXHRcdFx0XHRcdFx0XHRhd2FpdCBkZWxheSgyMDAwKTtcblxuXHRcdFx0XHRcdFx0XHRnZW5lcmF0ZURlZmF1bHRIaWdobGlnaHRzKGFjdGl2ZVZpZXcubGVhZik7XG5cblx0XHRcdFx0XHRcdFx0Ly8gY29uc3QgZWRpdG9yID0gZ2V0TWFya2Rvd25WaWV3KGFjdGl2ZVZpZXcubGVhZikuZWRpdG9yO1xuXHRcdFx0XHRcdFx0XHQvLyBjb25zdCBiYWNrbGlua0NvbnRhaW5lciA9IGdldEJhY2tsaW5rQ29udGFpbmVyKGVkaXRvcik7XG5cblx0XHRcdFx0XHRcdFx0Ly8gbGV0IGJhY2tsaW5rcyA9IFtdO1xuXHRcdFx0XHRcdFx0XHQvLyBmb3IgKGxldCBpID0gMDsgaSA8IGJhY2tsaW5rQ29udGFpbmVyLmNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRcdC8vIFx0YmFja2xpbmtzLnB1c2goXG5cdFx0XHRcdFx0XHRcdC8vIFx0XHRiYWNrbGlua0NvbnRhaW5lci5jaGlsZHJlbi5pdGVtKGkpIGFzIEhUTUxFbGVtZW50XG5cdFx0XHRcdFx0XHRcdC8vIFx0KTtcblx0XHRcdFx0XHRcdFx0Ly8gfVxuXG5cdFx0XHRcdFx0XHRcdC8vIGZvciAobGV0IGJhY2tsaW5rIG9mIGJhY2tsaW5rcykge1xuXHRcdFx0XHRcdFx0XHQvLyBcdGxldCByZWZlcmVuY2UgPSBiYWNrbGluay5nZXRBdHRyaWJ1dGUoXCJyZWZlcmVuY2VcIilcblx0XHRcdFx0XHRcdFx0Ly8gXHRcdD8gSlNPTi5wYXJzZShiYWNrbGluay5nZXRBdHRyaWJ1dGUoXCJyZWZlcmVuY2VcIikhKVxuXHRcdFx0XHRcdFx0XHQvLyBcdFx0OiBudWxsO1xuXHRcdFx0XHRcdFx0XHQvLyBcdGlmIChyZWZlcmVuY2UpIHtcblx0XHRcdFx0XHRcdFx0Ly8gXHRcdGNvbnNvbGUubG9nKHJlZmVyZW5jZSk7XG5cdFx0XHRcdFx0XHRcdC8vIFx0XHRsZXQgcmVmZXJlbmNlRnJvbSA9IHJlZmVyZW5jZS5yZWZlcmVuY2VkTG9jYXRpb24uZnJvbTtcblx0XHRcdFx0XHRcdFx0Ly8gXHRcdGxldCByZWZlcmVuY2VUbyA9IHJlZmVyZW5jZS5yZWZlcmVuY2VkTG9jYXRpb24udG87XG5cdFx0XHRcdFx0XHRcdC8vIFx0XHRsZXQgZWRpdG9yVmlldyA9IGdldENvZGVNaXJyb3JFZGl0b3JWaWV3KGVkaXRvcik7XG5cdFx0XHRcdFx0XHRcdC8vIFx0XHRkZWZhdWx0SGlnaGxpZ2h0U2VsZWN0aW9uKFxuXHRcdFx0XHRcdFx0XHQvLyBcdFx0XHRlZGl0b3JWaWV3LFxuXHRcdFx0XHRcdFx0XHQvLyBcdFx0XHRyZWZlcmVuY2VGcm9tLFxuXHRcdFx0XHRcdFx0XHQvLyBcdFx0XHRyZWZlcmVuY2VUb1xuXHRcdFx0XHRcdFx0XHQvLyBcdFx0KTtcblx0XHRcdFx0XHRcdFx0Ly8gXHR9XG5cdFx0XHRcdFx0XHRcdC8vIH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZyhlKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pXG5cdFx0XHQpO1xuXHRcdH0sIDQwMDApO1xuXG5cdFx0dXBkYXRlVGhhdCh0aGlzKTtcblxuXHRcdHRoaXMucmVnaXN0ZXJFZGl0b3JFeHRlbnNpb24oW1xuXHRcdFx0aGlnaGxpZ2h0cyxcblx0XHRcdHJlZmVyZW5jZVJlc291cmNlcyxcblx0XHRcdEVkaXRvclZpZXcudXBkYXRlTGlzdGVuZXIub2YoZnVuY3Rpb24gKGUpIHtcblx0XHRcdFx0aWYgKE1hdGguYWJzKGUuY2hhbmdlcy5kZXNjLm5ld0xlbmd0aCAtIGUuY2hhbmdlcy5kZXNjLmxlbmd0aCkgPiAxKSB7XG5cdFx0XHRcdFx0dXBkYXRlQmFja2xpbmtNYXJrUG9zaXRpb25zKCk7XG5cdFx0XHRcdH1cblx0XHRcdH0pLFxuXHRcdF0pO1xuXG5cdFx0dGhpcy5yZWdpc3RlckRvbUV2ZW50KGRvY3VtZW50LCBcIm1vdXNlbW92ZVwiLCBhc3luYyAoZXZ0KSA9PiB7XG5cdFx0XHRpZiAoZXZ0Lm1ldGFLZXkgfHwgZXZ0LmN0cmxLZXkpIHJldHVybjtcblxuXHRcdFx0bGV0IHNwYW47XG5cdFx0XHRpZiAoXG5cdFx0XHRcdGV2dC50YXJnZXQgJiZcblx0XHRcdFx0KGV2dC50YXJnZXQgaW5zdGFuY2VvZiBIVE1MU3BhbkVsZW1lbnQgfHxcblx0XHRcdFx0XHRldnQudGFyZ2V0IGluc3RhbmNlb2YgU1ZHRWxlbWVudCB8fFxuXHRcdFx0XHRcdGV2dC50YXJnZXQgaW5zdGFuY2VvZiBTVkdQYXRoRWxlbWVudClcblx0XHRcdCkge1xuXHRcdFx0XHQvLyBJZiBlbGVtZW50IGlzIHN2ZywgZmluZCB0aGUgY29udGFpbmluZyBwYXJlbnQgc3BhblxuXHRcdFx0XHRzcGFuID0gZXZ0LnRhcmdldDtcblxuXHRcdFx0XHR3aGlsZSAoXG5cdFx0XHRcdFx0IShzcGFuIGluc3RhbmNlb2YgSFRNTFNwYW5FbGVtZW50KSAmJlxuXHRcdFx0XHRcdHNwYW4ucGFyZW50RWxlbWVudCAhPSBudWxsXG5cdFx0XHRcdCkge1xuXHRcdFx0XHRcdHNwYW4gPSBzcGFuLnBhcmVudEVsZW1lbnQ7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0aWYgKFxuXHRcdFx0XHRzcGFuICYmXG5cdFx0XHRcdHNwYW4gaW5zdGFuY2VvZiBIVE1MU3BhbkVsZW1lbnQgJiZcblx0XHRcdFx0c3Bhbj8ucGFyZW50RWxlbWVudCAmJlxuXHRcdFx0XHRzcGFuPy5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyhcInJlZmVyZW5jZS1jb250YWluZXItc3BhblwiKVxuXHRcdFx0KSB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKFwic3RhcnQgaG92ZXIgcmVmZXJlbmNlIGVmZmVjdFwiKTtcblx0XHRcdFx0aWYgKGdldEhvdmVyKCkgIT0gbnVsbCkgcmV0dXJuO1xuXG5cdFx0XHRcdGlmICghc3Bhbi5nZXRBdHRyaWJ1dGUoXCJkYXRhXCIpKSB7XG5cdFx0XHRcdFx0c3BhbiA9IHNwYW4ucGFyZW50RWxlbWVudDtcblx0XHRcdFx0XHRzcGFuID0gc3Bhbi5xdWVyeVNlbGVjdG9yKFwiLnJlZmVyZW5jZS1kYXRhLXNwYW5cIikgYXMgSFRNTFNwYW5FbGVtZW50O1xuXHRcdFx0XHRcdGlmICghc3BhbikgdGhyb3cgbmV3IEVycm9yKFwiU3BhbiBlbGVtZW50IG5vdCBmb3VuZFwiKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHVwZGF0ZUhvdmVyZWRDdXJzb3JDb2xvcihzcGFuLCBBQ1RJT05fVFlQRS5NT1VTRSk7XG5cdFx0XHRcdHN0YXJ0UmVmZXJlbmNlRWZmZWN0KHNwYW4sIEFDVElPTl9UWVBFLk1PVVNFKTtcblx0XHRcdH0gZWxzZSBpZiAoXG5cdFx0XHRcdHNwYW4gJiZcblx0XHRcdFx0c3BhbiBpbnN0YW5jZW9mIEhUTUxTcGFuRWxlbWVudCAmJlxuXHRcdFx0XHRzcGFuLmdldEF0dHJpYnV0ZShcInJlZmVyZW5jZVwiKVxuXHRcdFx0KSB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKFwic3RhcnQgaG92ZXIgYmFja2xpbmsgZWZmZWN0XCIpO1xuXHRcdFx0XHRpZiAoZ2V0QmFja2xpbmtIb3ZlcigpICE9IG51bGwpIHJldHVybjtcblxuXHRcdFx0XHRzdGFydEJhY2tsaW5rRWZmZWN0KHNwYW4pO1xuXHRcdFx0fSBlbHNlIGlmIChnZXRIb3ZlcigpICE9IG51bGwpIHtcblx0XHRcdFx0Y29uc29sZS5sb2coXCJlbmQgaG92ZXIgcmVmZXJlbmNlIGVmZmVjdFwiKTtcblxuXHRcdFx0XHQvLyBEZWZpbmUgdGhlIGtleXMgeW91J3JlIHdhaXRpbmcgZm9yXG5cdFx0XHRcdGNvbnN0IHJlcXVpcmVkS2V5cyA9IFtcblx0XHRcdFx0XHRcImRhdGFTdHJpbmdcIixcblx0XHRcdFx0XHRcImxlYWZJZFwiLFxuXHRcdFx0XHRcdFwib3JpZ2luYWxMZWFmSWRcIixcblx0XHRcdFx0XHRcInRlbXBcIixcblx0XHRcdFx0XHRcImN1cnNvclZpZXdwb3J0XCIsXG5cdFx0XHRcdFx0XCJwZWVrXCIsXG5cdFx0XHRcdFx0XCJ1dWlkXCIsXG5cdFx0XHRcdF07XG5cblx0XHRcdFx0Ly8gRnVuY3Rpb24gdG8gY2hlY2sgaWYgYWxsIHJlcXVpcmVkIGtleXMgYXJlIHByZXNlbnRcblx0XHRcdFx0Y29uc3QgYWxsS2V5c1ByZXNlbnQgPSAoKSA9PlxuXHRcdFx0XHRcdHJlcXVpcmVkS2V5cy5ldmVyeSgoa2V5KSA9PiBrZXkgaW4gZ2V0SG92ZXIoKSk7XG5cblx0XHRcdFx0Ly8gV2FpdCB1bnRpbCBhbGwga2V5cyBhcmUgcHJlc2VudFxuXHRcdFx0XHRpZiAoIWFsbEtleXNQcmVzZW50KCkpIHtcblx0XHRcdFx0XHRhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gc2V0VGltZW91dChyZXNvbHZlLCA1MCkpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0YXdhaXQgZW5kUmVmZXJlbmNlSG92ZXJFZmZlY3QoKTtcblx0XHRcdFx0aGFuZGxlUmVtb3ZlSG92ZXJlZEN1cnNvcihBQ1RJT05fVFlQRS5NT1VTRSk7XG5cdFx0XHR9IGVsc2UgaWYgKGdldEJhY2tsaW5rSG92ZXIoKSAhPSBudWxsKSB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKFwiZW5kIGhvdmVyIGJhY2tsaW5rIGVmZmVjdFwiKTtcblxuXHRcdFx0XHQvLyBEZWZpbmUgdGhlIGtleXMgeW91J3JlIHdhaXRpbmcgZm9yXG5cdFx0XHRcdGNvbnN0IHJlcXVpcmVkS2V5cyA9IFtcblx0XHRcdFx0XHRcImRhdGFTdHJpbmdcIixcblx0XHRcdFx0XHRcImxlYWZJZFwiLFxuXHRcdFx0XHRcdFwib3JpZ2luYWxMZWFmSWRcIixcblx0XHRcdFx0XHRcImJhY2tsaW5rTGVhZklkXCIsXG5cdFx0XHRcdFx0XCJ0ZW1wXCIsXG5cdFx0XHRcdFx0XCJjdXJzb3JWaWV3cG9ydFwiLFxuXHRcdFx0XHRcdFwicGVla1wiLFxuXHRcdFx0XHRcdFwidXVpZFwiLFxuXHRcdFx0XHRcdFwiYmFja2xpbmtVVUlEXCIsXG5cdFx0XHRcdF07XG5cblx0XHRcdFx0Ly8gRnVuY3Rpb24gdG8gY2hlY2sgaWYgYWxsIHJlcXVpcmVkIGtleXMgYXJlIHByZXNlbnRcblx0XHRcdFx0Y29uc3QgYWxsS2V5c1ByZXNlbnQgPSAoKSA9PlxuXHRcdFx0XHRcdHJlcXVpcmVkS2V5cy5ldmVyeSgoa2V5KSA9PiBrZXkgaW4gZ2V0QmFja2xpbmtIb3ZlcigpKTtcblxuXHRcdFx0XHQvLyBXYWl0IHVudGlsIGFsbCBrZXlzIGFyZSBwcmVzZW50XG5cdFx0XHRcdGlmICghYWxsS2V5c1ByZXNlbnQoKSkge1xuXHRcdFx0XHRcdGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDUwKSk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRjb25zb2xlLmxvZyhcInN0YXJ0IGVuZCBiYWNrbGluayBlZmZlY3QhISEhIVwiKTtcblxuXHRcdFx0XHRhd2FpdCBlbmRCYWNrbGlua0hvdmVyRWZmZWN0KCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0fVxuXHRcdFx0Ly8gZWxzZSB7XG5cdFx0XHQvLyBcdC8vIGNvbnNvbGUubG9nKFwiZW5kIGhvdmVyIHJlZmVyZW5jZSBlZmZlY3RcIik7XG5cdFx0XHQvLyBcdGVuZFJlZmVyZW5jZUhvdmVyRWZmZWN0KCk7XG5cdFx0XHQvLyBcdGhhbmRsZVJlbW92ZUhvdmVyZWRDdXJzb3IoQUNUSU9OX1RZUEUuTU9VU0UpO1xuXHRcdFx0Ly8gfVxuXHRcdH0pO1xuXG5cdFx0Ly8gb24gc2VsZWN0aW9uIGNoYW5nZXMsIGV2ZW50IG92ZXIgY2xpY2sgYW5kIGtleWRvd25cblxuXHRcdHRoaXMucmVnaXN0ZXJEb21FdmVudChkb2N1bWVudCwgXCJjbGlja1wiLCBhc3luYyAoZXZ0KSA9PiB7XG5cdFx0XHRjb25zb2xlLmxvZyhcImNsaWNrXCIpO1xuXHRcdFx0YXdhaXQgY2hlY2tGb2N1c0N1cnNvcihldnQpO1xuXHRcdFx0dXBkYXRlQmFja2xpbmtNYXJrUG9zaXRpb25zKCk7XG5cblx0XHRcdC8vIGlmIChldnQubWV0YUtleSB8fCBldnQuY3RybEtleSkgcmV0dXJuO1xuXHRcdFx0Ly8gYXdhaXQgZW5kUmVmZXJlbmNlQ3Vyc29yRWZmZWN0KCk7XG5cdFx0fSk7XG5cblx0XHR0aGlzLnJlZ2lzdGVyRG9tRXZlbnQoZG9jdW1lbnQsIFwia2V5dXBcIiwgYXN5bmMgKGV2dCkgPT4ge1xuXHRcdFx0aWYgKGV2dC5tZXRhS2V5IHx8IGV2dC5jdHJsS2V5KSByZXR1cm47XG5cblx0XHRcdC8vIGNvbnNvbGUubG9nKFwia2V5dXBcIik7XG5cdFx0XHRhd2FpdCBjaGVja0ZvY3VzQ3Vyc29yKGV2dCk7XG5cdFx0XHR1cGRhdGVCYWNrbGlua01hcmtQb3NpdGlvbnMoKTtcblx0XHRcdC8vIHVwZGF0ZUJhY2tsaW5rTWFya1Bvc2l0aW9ucygpO1xuXHRcdH0pO1xuXG5cdFx0dGhpcy5yZWdpc3RlckRvbUV2ZW50KGRvY3VtZW50LCBcImtleWRvd25cIiwgYXN5bmMgKGV2dCkgPT4ge1xuXHRcdFx0Ly8gY29uc29sZS5sb2coXCJrZXlkb3duXCIpO1xuXG5cdFx0XHRjb25zb2xlLmxvZyhldnQua2V5KTtcblxuXHRcdFx0Y29uc29sZS5sb2coZXZ0LnNoaWZ0S2V5KTtcblxuXHRcdFx0Y29uc29sZS5sb2coZXZ0LmN0cmxLZXkpO1xuXHRcdFx0Y29uc29sZS5sb2coZXZ0Lm1ldGFLZXkpO1xuXG5cdFx0XHRjb25zb2xlLmxvZyhcblx0XHRcdFx0ZXZ0LmtleSA9PSBcInNcIiAmJiAoZXZ0Lm1ldGFLZXkgfHwgZXZ0LmN0cmxLZXkpICYmIGV2dC5zaGlmdEtleVxuXHRcdFx0KTtcblx0XHRcdGlmIChcblx0XHRcdFx0ZXZ0LmtleSA9PSBcIlx1MDBDN1wiICYmXG5cdFx0XHRcdChldnQubWV0YUtleSB8fCBldnQuY3RybEtleSkgJiZcblx0XHRcdFx0ZXZ0LnNoaWZ0S2V5ICYmXG5cdFx0XHRcdGV2dC5hbHRLZXlcblx0XHRcdCkge1xuXHRcdFx0XHQvLyBjb25zb2xlLmxvZyhcImNcIik7XG5cdFx0XHRcdHVwZGF0ZUNsaXBib2FyZChmYWxzZSk7XG5cdFx0XHRcdG5ldyBOb3RpY2UoXCJDb3BpZWQgcmVmZXJlbmNlIHRvIGNsaXBib2FyZFwiKTtcblx0XHRcdH0gZWxzZSBpZiAoXG5cdFx0XHRcdChldnQua2V5ID09IFwiY1wiIHx8IGV2dC5rZXkgPT0gXCJDXCIpICYmXG5cdFx0XHRcdChldnQubWV0YUtleSB8fCBldnQuY3RybEtleSkgJiZcblx0XHRcdFx0ZXZ0LnNoaWZ0S2V5XG5cdFx0XHQpIHtcblx0XHRcdFx0Ly8gY29uc29sZS5sb2coXCJyXCIpO1xuXHRcdFx0XHR1cGRhdGVDbGlwYm9hcmQodHJ1ZSk7XG5cdFx0XHRcdG5ldyBOb3RpY2UoXCJDb3BpZWQgcmVmZXJlbmNlIHRvIGNsaXBib2FyZFwiKTtcblx0XHRcdH0gZWxzZSBpZiAoXG5cdFx0XHRcdChldnQua2V5ID09IFwic1wiIHx8IGV2dC5rZXkgPT0gXCJTXCIpICYmXG5cdFx0XHRcdChldnQubWV0YUtleSB8fCBldnQuY3RybEtleSkgJiZcblx0XHRcdFx0ZXZ0LnNoaWZ0S2V5XG5cdFx0XHQpIHtcblx0XHRcdFx0bGV0IHRhcmdldCA9IGV2dC50YXJnZXQgYXMgSFRNTEVsZW1lbnQ7XG5cdFx0XHRcdGxldCBjaGlsZHJlbiA9IEFycmF5LmZyb20odGFyZ2V0LmNoaWxkcmVuKTtcblx0XHRcdFx0bGV0IGN1cnJlbnRMaW5lID0gY2hpbGRyZW4uZmlsdGVyKChjaGlsZCkgPT5cblx0XHRcdFx0XHRjaGlsZC5jbGFzc0xpc3QuY29udGFpbnMoXCJjbS1hY3RpdmVcIilcblx0XHRcdFx0KVswXTtcblxuXHRcdFx0XHRjb25zdCBzcGFucyA9IEFycmF5LmZyb208SFRNTFNwYW5FbGVtZW50Pihcblx0XHRcdFx0XHRjdXJyZW50TGluZS5xdWVyeVNlbGVjdG9yQWxsKFwiLnJlZmVyZW5jZS1zcGFuXCIpXG5cdFx0XHRcdCk7XG5cblx0XHRcdFx0aWYgKFxuXHRcdFx0XHRcdHNwYW5zLmV2ZXJ5KChzcGFuKSA9PlxuXHRcdFx0XHRcdFx0c3Bhbi5jbGFzc0xpc3QuY29udGFpbnMoXCJyZWZlcmVuY2Utc3Bhbi1oaWRkZW5cIilcblx0XHRcdFx0XHQpIHx8XG5cdFx0XHRcdFx0KCFzcGFucy5ldmVyeSgoc3BhbikgPT5cblx0XHRcdFx0XHRcdHNwYW4uY2xhc3NMaXN0LmNvbnRhaW5zKFwicmVmZXJlbmNlLXNwYW4taGlkZGVuXCIpXG5cdFx0XHRcdFx0KSAmJlxuXHRcdFx0XHRcdFx0c3BhbnMucmVkdWNlKChhY2MsIHNwYW4pID0+IHtcblx0XHRcdFx0XHRcdFx0aWYgKGFjYykgcmV0dXJuIGFjYztcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHNwYW4uY2xhc3NMaXN0LmNvbnRhaW5zKFwicmVmZXJlbmNlLXNwYW4taGlkZGVuXCIpO1xuXHRcdFx0XHRcdFx0fSwgZmFsc2UpKVxuXHRcdFx0XHQpIHtcblx0XHRcdFx0XHRzcGFucy5mb3JFYWNoKChzcGFuKSA9PiB7XG5cdFx0XHRcdFx0XHRzcGFuLmNsYXNzTGlzdC50b2dnbGUoXCJyZWZlcmVuY2Utc3Bhbi1oaWRkZW5cIiwgZmFsc2UpO1xuXHRcdFx0XHRcdFx0Ly8gV2FudCB0byBzZXJpYWxpemUgcmVmZXJlbmNlcyBhdCBzb21lIHBvaW50XG5cdFx0XHRcdFx0XHQvLyBjb25zb2xlLmxvZyhzcGFuKTtcblx0XHRcdFx0XHRcdC8vIGdldFRoYXQoKS53b3Jrc3BhY2UuZ2V0TGVhZigpLnZpZXc7XG5cdFx0XHRcdFx0XHRsZXQgcmVmZXJlbmNlU3BhbiA9IHNwYW4ucGFyZW50RWxlbWVudD8ucXVlcnlTZWxlY3Rvcihcblx0XHRcdFx0XHRcdFx0XCIucmVmZXJlbmNlLWRhdGEtc3BhblwiXG5cdFx0XHRcdFx0XHQpO1xuXHRcdFx0XHRcdFx0bGV0IGNvbnRlbnQgPSByZWZlcmVuY2VTcGFuPy5nZXRBdHRyaWJ1dGUoXCJkYXRhXCIpO1xuXHRcdFx0XHRcdFx0Y29uc3QgYWN0aXZlVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWFmKCk7XG5cdFx0XHRcdFx0XHRjb25zdCBlZGl0b3IgPSBnZXRNYXJrZG93blZpZXcoYWN0aXZlVmlldykuZWRpdG9yO1xuXHRcdFx0XHRcdFx0Y29uc3QgZWRpdG9yVmlldyA9IGdldENvZGVNaXJyb3JFZGl0b3JWaWV3KGVkaXRvcik7XG5cblx0XHRcdFx0XHRcdHNlcmlhbGl6ZVJlZmVyZW5jZShjb250ZW50LCBzcGFuLCBlZGl0b3JWaWV3KTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRuZXcgTm90aWNlKFwiVG9nZ2xlIGFubm90YXRpb25zIG9uXCIpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHNwYW5zLmZvckVhY2goKHNwYW46IEhUTUxTcGFuRWxlbWVudCkgPT4ge1xuXHRcdFx0XHRcdFx0c3BhbnMuZm9yRWFjaCgoc3BhbikgPT4ge1xuXHRcdFx0XHRcdFx0XHRzcGFuLmNsYXNzTGlzdC50b2dnbGUoXCJyZWZlcmVuY2Utc3Bhbi1oaWRkZW5cIiwgdHJ1ZSk7XG5cblx0XHRcdFx0XHRcdFx0bGV0IHJlZmVyZW5jZVNwYW4gPSBzcGFuLnBhcmVudEVsZW1lbnQ/LnF1ZXJ5U2VsZWN0b3IoXG5cdFx0XHRcdFx0XHRcdFx0XCIucmVmZXJlbmNlLWRhdGEtc3BhblwiXG5cdFx0XHRcdFx0XHRcdCk7XG5cdFx0XHRcdFx0XHRcdGxldCBjb250ZW50ID0gcmVmZXJlbmNlU3Bhbj8uZ2V0QXR0cmlidXRlKFwiZGF0YVwiKTtcblx0XHRcdFx0XHRcdFx0Y29uc3QgYWN0aXZlVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWFmKCk7XG5cdFx0XHRcdFx0XHRcdGNvbnN0IGVkaXRvciA9IGdldE1hcmtkb3duVmlldyhhY3RpdmVWaWV3KS5lZGl0b3I7XG5cdFx0XHRcdFx0XHRcdGNvbnN0IGVkaXRvclZpZXcgPSBnZXRDb2RlTWlycm9yRWRpdG9yVmlldyhlZGl0b3IpO1xuXG5cdFx0XHRcdFx0XHRcdHNlcmlhbGl6ZVJlZmVyZW5jZShjb250ZW50LCBzcGFuLCBlZGl0b3JWaWV3KTtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdG5ldyBOb3RpY2UoXCJUb2dnbGUgYW5ub3RhdGlvbnMgb2ZmXCIpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHQvLyBnZXRUaGF0KCkud29ya3NwYWNlLm9uKFwiZWRpdG9yLWNoYW5nZVwiLCAoZXYpID0+IHtcblx0XHQvLyBcdGNvbnNvbGUubG9nKGV2KTtcblx0XHQvLyB9KTtcblxuXHRcdC8vIHRoaXMucmVnaXN0ZXJFdmVudChcblx0XHQvLyBcdHRoaXMuYXBwLndvcmtzcGFjZS5vbihcIndpbmRvdy1jbG9zZVwiLCAoZXYpID0+IHtcblx0XHQvLyBcdFx0Y29uc29sZS5sb2coXCJ3aW5kb3cgY2xvc2VkOlwiKTtcblx0XHQvLyBcdFx0Y29uc29sZS5sb2coZXYpO1xuXHRcdC8vIFx0fSlcblx0XHQvLyApO1xuXG5cdFx0Ly8gdGhpcy5yZWdpc3RlckV2ZW50KFxuXHRcdC8vIFx0dGhpcy5hcHAud29ya3NwYWNlLm9uKFwiZWRpdG9yLWRyb3BcIiwgKGV2KSA9PiB7XG5cdFx0Ly8gXHRcdGNvbnNvbGUubG9nKFwiRWRpdG9yIGRyb3BwZWQ6XCIpO1xuXHRcdC8vIFx0XHRjb25zb2xlLmxvZyhldik7XG5cdFx0Ly8gXHR9KVxuXHRcdC8vICk7XG5cblx0XHQvLyB0aGlzLnJlZ2lzdGVyRXZlbnQoXG5cdFx0Ly8gXHR0aGlzLmFwcC53b3Jrc3BhY2Uub24oXCJ3aW5kb3ctb3BlblwiLCAoZXYpID0+IHtcblx0XHQvLyBcdFx0Y29uc29sZS5sb2coXCJ3aW5kb3cgb3BlbmVkOlwiKTtcblx0XHQvLyBcdFx0Ly8gY29uc29sZS5sb2coZXYpO1xuXHRcdC8vIFx0fSlcblx0XHQvLyApO1xuXG5cdFx0Ly8gdGhpcy5yZWdpc3RlckV2ZW50KFxuXHRcdC8vIFx0dGhpcy5hcHAud29ya3NwYWNlLm9uKFwicmVzaXplXCIsICgpID0+IHtcblx0XHQvLyBcdFx0Y29uc29sZS5sb2coXCJyZXNpemVcIik7XG5cdFx0Ly8gXHR9KVxuXHRcdC8vICk7XG5cblx0XHQvLyB0aGlzLnJlZ2lzdGVyRXZlbnQoXG5cdFx0Ly8gXHR0aGlzLmFwcC53b3Jrc3BhY2Uub24oXCJmaWxlLW9wZW5cIiwgKGV2KSA9PiB7XG5cdFx0Ly8gXHRcdGNvbnNvbGUubG9nKFwiZmlsZSBvcGVuZWQ6XCIpO1xuXHRcdC8vIFx0XHQvLyBjb25zb2xlLmxvZyhldik7XG5cdFx0Ly8gXHRcdC8vIGNvbnNvbGUubG9nKGdldFJlZmVyZW5jZXMoKSk7XG5cblx0XHQvLyBcdFx0bGV0IGN1cnJlbnRMZWFmOiBhbnkgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhZigpO1xuXG5cdFx0Ly8gXHRcdC8vIGNoZWNrIGl0IHJlZmVyZW5jZXMgaGF2ZSBhbHJlYWR5IGJlZW4gY3JlYXRlZCwgZWxzZSBjcmVhdGUgcmVmZXJlbmNlc1xuXHRcdC8vIFx0fSlcblx0XHQvLyApO1xuXG5cdFx0Ly8gdGhpcy5yZWdpc3RlckV2ZW50KFxuXHRcdC8vIFx0dGhpcy5hcHAud29ya3NwYWNlLm9uKFwibGF5b3V0LWNoYW5nZVwiLCAoKSA9PiB7XG5cdFx0Ly8gXHRcdGNvbnNvbGUubG9nKFwibGF5b3V0LWNoYW5nZWQ6XCIpO1xuXHRcdC8vIFx0fSlcblx0XHQvLyApO1xuXHR9XG5cblx0b251bmxvYWQoKSB7fVxufVxuIiwgImltcG9ydCB7XG5cdEVkaXRvclN0YXRlLFxuXHRTdGF0ZUZpZWxkLFxuXHRBbm5vdGF0aW9uLFxuXHRTdGF0ZUVmZmVjdCxcbn0gZnJvbSBcIkBjb2RlbWlycm9yL3N0YXRlXCI7XG5pbXBvcnQgeyBCYWNrbGluayB9IGZyb20gXCIuL3R5cGVzXCI7XG5pbXBvcnQgeyB1cGRhdGVCYWNrbGlua01hcmtQb3NpdGlvbnMgfSBmcm9tIFwiLi9yZWZlcmVuY2VzXCI7XG5pbXBvcnQgeyBBcHAgfSBmcm9tIFwib2JzaWRpYW5cIjtcblxuZXhwb3J0IGxldCB0aGF0ID0gU3RhdGVGaWVsZC5kZWZpbmU8QXBwIHwgbnVsbD4oe1xuXHRjcmVhdGUoKSB7XG5cdFx0cmV0dXJuIG51bGw7XG5cdH0sXG5cdHVwZGF0ZSh2YWx1ZSwgdHI6IGFueSkge1xuXHRcdGlmIChcblx0XHRcdHRyW1wiYW5ub3RhdGlvbnNcIl0ubGVuZ3RoID09IDIgJiZcblx0XHRcdHRyW1wiYW5ub3RhdGlvbnNcIl1bMF0udmFsdWUudHlwZSA9PSBcInRoYXRcIlxuXHRcdCkge1xuXHRcdFx0cmV0dXJuIHRyW1wiYW5ub3RhdGlvbnNcIl1bMF0udmFsdWUudGhhdC5hcHA7XG5cdFx0fVxuXHRcdHJldHVybiB2YWx1ZTtcblx0fSxcbn0pO1xuXG5leHBvcnQgbGV0IGhvdmVyZWRDdXJzb3IgPSBTdGF0ZUZpZWxkLmRlZmluZTxhbnk+KHtcblx0Y3JlYXRlKCkge1xuXHRcdHJldHVybiBudWxsO1xuXHR9LFxuXHR1cGRhdGUodmFsdWUsIHRyOiBhbnkpIHtcblx0XHRpZiAoXG5cdFx0XHR0cltcImFubm90YXRpb25zXCJdLmxlbmd0aCA9PSAyICYmXG5cdFx0XHR0cltcImFubm90YXRpb25zXCJdWzBdLnZhbHVlLnR5cGUgPT0gXCJob3ZlcmVkQ3Vyc29yXCJcblx0XHQpIHtcblx0XHRcdGlmICh2YWx1ZSlcblx0XHRcdFx0cmV0dXJuIFtcblx0XHRcdFx0XHQuLi52YWx1ZS5maWx0ZXIoXG5cdFx0XHRcdFx0XHQoY3Vyc29yOiBhbnkpID0+IGN1cnNvci51c2VyICE9IHRyW1wiYW5ub3RhdGlvbnNcIl1bMF0udmFsdWUudXNlclxuXHRcdFx0XHRcdCksXG5cdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0Y3Vyc29yOiB0cltcImFubm90YXRpb25zXCJdWzBdLnZhbHVlLmN1cnNvcixcblx0XHRcdFx0XHRcdHVzZXI6IHRyW1wiYW5ub3RhdGlvbnNcIl1bMF0udmFsdWUudXNlcixcblx0XHRcdFx0XHR9LFxuXHRcdFx0XHRdO1xuXHRcdFx0cmV0dXJuIFtcblx0XHRcdFx0e1xuXHRcdFx0XHRcdGN1cnNvcjogdHJbXCJhbm5vdGF0aW9uc1wiXVswXS52YWx1ZS5jdXJzb3IsXG5cdFx0XHRcdFx0dXNlcjogdHJbXCJhbm5vdGF0aW9uc1wiXVswXS52YWx1ZS51c2VyLFxuXHRcdFx0XHR9LFxuXHRcdFx0XTtcblx0XHR9IGVsc2UgaWYgKFxuXHRcdFx0dHJbXCJhbm5vdGF0aW9uc1wiXS5sZW5ndGggPT0gMiAmJlxuXHRcdFx0dHJbXCJhbm5vdGF0aW9uc1wiXVswXS52YWx1ZS50eXBlID09IFwicmVtb3ZlSG92ZXJlZEN1cnNvclwiXG5cdFx0KSB7XG5cdFx0XHRpZiAodmFsdWUpXG5cdFx0XHRcdHJldHVybiB2YWx1ZS5maWx0ZXIoXG5cdFx0XHRcdFx0KGN1cnNvcjogYW55KSA9PiBjdXJzb3IudXNlciAhPSB0cltcImFubm90YXRpb25zXCJdWzBdLnZhbHVlLnVzZXJcblx0XHRcdFx0KTtcblx0XHRcdHJldHVybiB2YWx1ZTtcblx0XHR9XG5cdFx0cmV0dXJuIHZhbHVlO1xuXHR9LFxufSk7XG5cbmV4cG9ydCBsZXQgYmFja2xpbmtzID0gU3RhdGVGaWVsZC5kZWZpbmU8QmFja2xpbmtbXT4oe1xuXHRjcmVhdGUoKSB7XG5cdFx0cmV0dXJuIFtdO1xuXHR9LFxuXHR1cGRhdGUodmFsdWUsIHRyKSB7XG5cdFx0Lypcblx0XHRcdEkgIHdhbnQgdG8gZ2V0IHRoZSBjdXJyZW50IGFjdGl2ZUxlYWYgYW5kIHJlY29tcHV0ZSB0aGUgcmVmZXJlbmNlc1xuXHRcdFx0bWVyZ2UgdGhpcyBpbnRvIHRoZSByZWZlcmVuY2VzIGZpZWxkXG5cdFx0Ki9cblxuXHRcdGlmICh0ci5lZmZlY3RzLmxlbmd0aCA+IDApIHtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdGxldCBkYXRhOiB7IHR5cGU6IHN0cmluZzsgYmFja2xpbmtzOiBCYWNrbGlua1tdIH0gPSBKU09OLnBhcnNlKFxuXHRcdFx0XHRcdHRyLmVmZmVjdHNbMF0udmFsdWVcblx0XHRcdFx0KTtcblx0XHRcdFx0aWYgKGRhdGEudHlwZSA9PSBcImJhY2tsaW5rXCIpIHtcblx0XHRcdFx0XHRpZiAoZGF0YS5iYWNrbGlua3MubGVuZ3RoID09IDApIHJldHVybiB2YWx1ZTtcblx0XHRcdFx0XHRsZXQgcmVmZXJlbmNpbmdMb2NhdGlvbiA9XG5cdFx0XHRcdFx0XHRkYXRhLmJhY2tsaW5rc1swXVtcInJlZmVyZW5jaW5nTG9jYXRpb25cIl1bXCJmaWxlbmFtZVwiXTtcblx0XHRcdFx0XHRsZXQgZmlsdGVyZWRWYWx1ZXMgPSB2YWx1ZS5maWx0ZXIoXG5cdFx0XHRcdFx0XHQoYmFja2xpbmspID0+XG5cdFx0XHRcdFx0XHRcdGJhY2tsaW5rLnJlZmVyZW5jaW5nTG9jYXRpb24uZmlsZW5hbWUgIT0gcmVmZXJlbmNpbmdMb2NhdGlvblxuXHRcdFx0XHRcdCk7XG5cdFx0XHRcdFx0cmV0dXJuIFsuLi5maWx0ZXJlZFZhbHVlcywgLi4uZGF0YS5iYWNrbGlua3NdO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiB2YWx1ZTtcblx0XHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdFx0Y29uc29sZS5sb2coZSk7XG5cdFx0XHRcdHJldHVybiB2YWx1ZTtcblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIHZhbHVlO1xuXHR9LFxufSk7XG5cbmV4cG9ydCBsZXQgaG92ZXJFbGVtZW50ID0gU3RhdGVGaWVsZC5kZWZpbmU8b2JqZWN0IHwgbnVsbD4oe1xuXHRjcmVhdGUoKSB7XG5cdFx0cmV0dXJuIG51bGw7XG5cdH0sXG5cdHVwZGF0ZSh2YWx1ZSwgdHIpIHtcblx0XHRpZiAodHIuZWZmZWN0cy5sZW5ndGggPiAwKSB7XG5cdFx0XHR0cnkge1xuXHRcdFx0XHRsZXQgZGF0YSA9IEpTT04ucGFyc2UodHIuZWZmZWN0c1swXS52YWx1ZSk7XG5cdFx0XHRcdGlmIChkYXRhLnR5cGUgPT0gXCJob3Zlci1zdGFydFwiKSB7XG5cdFx0XHRcdFx0cmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIGRhdGEpO1xuXHRcdFx0XHR9IGVsc2UgaWYgKGRhdGEudHlwZSA9PSBcImhvdmVyXCIpIHtcblx0XHRcdFx0XHRpZiAodmFsdWUpIHJldHVybiBPYmplY3QuYXNzaWduKHZhbHVlLCBkYXRhKTtcblx0XHRcdFx0XHRyZXR1cm4gZGF0YTtcblx0XHRcdFx0fSBlbHNlIGlmIChkYXRhLnR5cGUgPT0gXCJob3Zlci1vZmZcIikge1xuXHRcdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiB2YWx1ZTtcblx0XHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdFx0Y29uc29sZS5sb2coZSk7XG5cdFx0XHRcdHJldHVybiB2YWx1ZTtcblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIHZhbHVlO1xuXHR9LFxufSk7XG5cbmV4cG9ydCBsZXQgYmFja2xpbmtIb3ZlckVsZW1lbnQgPSBTdGF0ZUZpZWxkLmRlZmluZTxvYmplY3QgfCBudWxsPih7XG5cdGNyZWF0ZSgpIHtcblx0XHRyZXR1cm4gbnVsbDtcblx0fSxcblx0dXBkYXRlKHZhbHVlLCB0cikge1xuXHRcdGlmICh0ci5lZmZlY3RzLmxlbmd0aCA+IDApIHtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdGxldCBkYXRhID0gSlNPTi5wYXJzZSh0ci5lZmZlY3RzWzBdLnZhbHVlKTtcblx0XHRcdFx0aWYgKGRhdGEudHlwZSA9PSBcImJhY2tsaW5rLXN0YXJ0XCIpIHtcblx0XHRcdFx0XHRyZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgZGF0YSk7XG5cdFx0XHRcdH0gZWxzZSBpZiAoZGF0YS50eXBlID09IFwiYmFja2xpbmstdXBkYXRlXCIpIHtcblx0XHRcdFx0XHRpZiAodmFsdWUpIHJldHVybiBPYmplY3QuYXNzaWduKHZhbHVlLCBkYXRhKTtcblx0XHRcdFx0XHRyZXR1cm4gZGF0YTtcblx0XHRcdFx0fSBlbHNlIGlmIChkYXRhLnR5cGUgPT0gXCJiYWNrbGluay1vZmZcIikge1xuXHRcdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiB2YWx1ZTtcblx0XHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdFx0Y29uc29sZS5sb2coZSk7XG5cdFx0XHRcdHJldHVybiB2YWx1ZTtcblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIHZhbHVlO1xuXHR9LFxufSk7XG5cbmV4cG9ydCBsZXQgY3Vyc29yRWxlbWVudCA9IFN0YXRlRmllbGQuZGVmaW5lPG9iamVjdCB8IG51bGw+KHtcblx0Y3JlYXRlKCkge1xuXHRcdHJldHVybiBudWxsO1xuXHR9LFxuXHR1cGRhdGUodmFsdWUsIHRyKSB7XG5cdFx0aWYgKHRyLmVmZmVjdHMubGVuZ3RoID4gMCkge1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0bGV0IGRhdGEgPSBKU09OLnBhcnNlKHRyLmVmZmVjdHNbMF0udmFsdWUpO1xuXHRcdFx0XHRpZiAoZGF0YS50eXBlID09IFwiY3Vyc29yLXN0YXJ0XCIpIHtcblx0XHRcdFx0XHRyZXR1cm4ge307XG5cdFx0XHRcdH0gZWxzZSBpZiAoZGF0YS50eXBlID09IFwiY3Vyc29yXCIpIHtcblx0XHRcdFx0XHRpZiAodmFsdWUpIHJldHVybiBPYmplY3QuYXNzaWduKHZhbHVlLCBkYXRhKTtcblx0XHRcdFx0XHRyZXR1cm4gZGF0YTtcblx0XHRcdFx0fSBlbHNlIGlmIChkYXRhLnR5cGUgPT0gXCJjdXJzb3Itb2ZmXCIpIHtcblx0XHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gdmFsdWU7XG5cdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKGUpO1xuXHRcdFx0XHRyZXR1cm4gdmFsdWU7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiB2YWx1ZTtcblx0fSxcbn0pO1xuXG5leHBvcnQgbGV0IGVkaXRvckNoYW5nZSA9IFN0YXRlRmllbGQuZGVmaW5lPG51bGw+KHtcblx0Y3JlYXRlKCkge1xuXHRcdHJldHVybiBudWxsO1xuXHR9LFxuXHR1cGRhdGUodmFsdWUsIHRyKSB7XG5cdFx0aWYgKHRyLmVmZmVjdHMubGVuZ3RoID4gMCkge1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0bGV0IGRhdGEgPSBKU09OLnBhcnNlKHRyLmVmZmVjdHNbMF0udmFsdWUpO1xuXHRcdFx0XHRpZiAoZGF0YS50eXBlID09IFwic3luY1wiKSB7XG5cdFx0XHRcdFx0Ly8gdXBkYXRlQmFja2xpbmtNYXJrUG9zaXRpb25zKCk7XG5cdFx0XHRcdFx0cmV0dXJuIHZhbHVlO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiB2YWx1ZTtcblx0XHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdFx0Y29uc29sZS5sb2coZSk7XG5cdFx0XHRcdHJldHVybiB2YWx1ZTtcblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIHZhbHVlO1xuXHR9LFxufSk7XG5cbmV4cG9ydCBjb25zdCB0aGF0QW5ub3RhdGlvbiA9IEFubm90YXRpb24uZGVmaW5lPGFueT4oKTtcbmV4cG9ydCBjb25zdCBob3ZlcmVkQ3Vyc29yQW5ub3RhdGlvbiA9IEFubm90YXRpb24uZGVmaW5lPGFueT4oKTtcbmV4cG9ydCBjb25zdCBob3ZlckVmZmVjdCA9IFN0YXRlRWZmZWN0LmRlZmluZTxzdHJpbmc+KCk7XG5leHBvcnQgY29uc3QgYmFja2xpbmtIb3ZlckVmZmVjdCA9IFN0YXRlRWZmZWN0LmRlZmluZTxzdHJpbmc+KCk7XG5leHBvcnQgY29uc3QgY3Vyc29yRWZmZWN0ID0gU3RhdGVFZmZlY3QuZGVmaW5lPHN0cmluZz4oKTtcbmV4cG9ydCBjb25zdCBiYWNrbGlua0VmZmVjdCA9IFN0YXRlRWZmZWN0LmRlZmluZTxzdHJpbmc+KCk7XG5cbmV4cG9ydCBsZXQgc3RhdGU6IGFueSA9IEVkaXRvclN0YXRlLmNyZWF0ZSh7XG5cdGV4dGVuc2lvbnM6IFtcblx0XHR0aGF0LFxuXHRcdGhvdmVyZWRDdXJzb3IsXG5cdFx0YmFja2xpbmtzLFxuXHRcdGhvdmVyRWxlbWVudCxcblx0XHRiYWNrbGlua0hvdmVyRWxlbWVudCxcblx0XHRjdXJzb3JFbGVtZW50LFxuXHRcdGVkaXRvckNoYW5nZSxcblx0XSxcbn0pO1xuXG5leHBvcnQgZnVuY3Rpb24gc3luY0JhY2tsaW5rcygpIHtcblx0c3RhdGUgPSBzdGF0ZS51cGRhdGUoe1xuXHRcdGVmZmVjdHM6IGJhY2tsaW5rRWZmZWN0Lm9mKEpTT04uc3RyaW5naWZ5KHsgdHlwZTogXCJzeW5jXCIgfSkpLFxuXHR9KS5zdGF0ZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFRoYXQoKTogQXBwIHtcblx0cmV0dXJuIHN0YXRlLmZpZWxkKHRoYXQpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlVGhhdCh0aGF0OiBhbnkpIHtcblx0c3RhdGUgPSBzdGF0ZS51cGRhdGUoe1xuXHRcdGFubm90YXRpb25zOiB0aGF0QW5ub3RhdGlvbi5vZih7XG5cdFx0XHR0eXBlOiBcInRoYXRcIixcblx0XHRcdHRoYXQsXG5cdFx0fSksXG5cdH0pLnN0YXRlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0SG92ZXJlZEN1cnNvcigpIHtcblx0cmV0dXJuIHN0YXRlLmZpZWxkKGhvdmVyZWRDdXJzb3IpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlSG92ZXJlZEN1cnNvcihjdXJzb3I6IEhUTUxPclNWR0VsZW1lbnQsIHVzZXI6IHN0cmluZykge1xuXHRzdGF0ZSA9IHN0YXRlLnVwZGF0ZSh7XG5cdFx0YW5ub3RhdGlvbnM6IGhvdmVyZWRDdXJzb3JBbm5vdGF0aW9uLm9mKHtcblx0XHRcdHR5cGU6IFwiaG92ZXJlZEN1cnNvclwiLFxuXHRcdFx0Y3Vyc29yLFxuXHRcdFx0dXNlcixcblx0XHR9KSxcblx0fSkuc3RhdGU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVIb3ZlcmVkQ3Vyc29yKHVzZXI6IHN0cmluZykge1xuXHRzdGF0ZSA9IHN0YXRlLnVwZGF0ZSh7XG5cdFx0YW5ub3RhdGlvbnM6IGhvdmVyZWRDdXJzb3JBbm5vdGF0aW9uLm9mKHtcblx0XHRcdHR5cGU6IFwicmVtb3ZlSG92ZXJlZEN1cnNvclwiLFxuXHRcdFx0dXNlcixcblx0XHR9KSxcblx0fSkuc3RhdGU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRIb3ZlcigpIHtcblx0cmV0dXJuIHN0YXRlLmZpZWxkKGhvdmVyRWxlbWVudCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVIb3Zlcih2YWx1ZTogb2JqZWN0KSB7XG5cdHN0YXRlID0gc3RhdGUudXBkYXRlKHtcblx0XHRlZmZlY3RzOiBob3ZlckVmZmVjdC5vZihcblx0XHRcdEpTT04uc3RyaW5naWZ5KE9iamVjdC5hc3NpZ24odmFsdWUsIHsgdHlwZTogXCJob3ZlclwiIH0pKVxuXHRcdCksXG5cdH0pLnN0YXRlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVzZXRIb3ZlcigpIHtcblx0c3RhdGUgPSBzdGF0ZS51cGRhdGUoe1xuXHRcdGVmZmVjdHM6IGhvdmVyRWZmZWN0Lm9mKFxuXHRcdFx0SlNPTi5zdHJpbmdpZnkoe1xuXHRcdFx0XHR0eXBlOiBcImhvdmVyLW9mZlwiLFxuXHRcdFx0fSlcblx0XHQpLFxuXHR9KS5zdGF0ZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEJhY2tsaW5rSG92ZXIoKSB7XG5cdHJldHVybiBzdGF0ZS5maWVsZChiYWNrbGlua0hvdmVyRWxlbWVudCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVCYWNrbGlua0hvdmVyKHZhbHVlOiBvYmplY3QpIHtcblx0c3RhdGUgPSBzdGF0ZS51cGRhdGUoe1xuXHRcdGVmZmVjdHM6IGJhY2tsaW5rSG92ZXJFZmZlY3Qub2YoXG5cdFx0XHRKU09OLnN0cmluZ2lmeShPYmplY3QuYXNzaWduKHZhbHVlLCB7IHR5cGU6IFwiYmFja2xpbmstdXBkYXRlXCIgfSkpXG5cdFx0KSxcblx0fSkuc3RhdGU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZXNldEJhY2tsaW5rSG92ZXIoKSB7XG5cdHN0YXRlID0gc3RhdGUudXBkYXRlKHtcblx0XHRlZmZlY3RzOiBiYWNrbGlua0hvdmVyRWZmZWN0Lm9mKFxuXHRcdFx0SlNPTi5zdHJpbmdpZnkoe1xuXHRcdFx0XHR0eXBlOiBcImJhY2tsaW5rLW9mZlwiLFxuXHRcdFx0fSlcblx0XHQpLFxuXHR9KS5zdGF0ZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEN1cnNvcigpIHtcblx0cmV0dXJuIHN0YXRlLmZpZWxkKGN1cnNvckVsZW1lbnQpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlQ3Vyc29yKHZhbHVlOiBvYmplY3QpIHtcblx0c3RhdGUgPSBzdGF0ZS51cGRhdGUoe1xuXHRcdGVmZmVjdHM6IGN1cnNvckVmZmVjdC5vZihcblx0XHRcdEpTT04uc3RyaW5naWZ5KE9iamVjdC5hc3NpZ24odmFsdWUsIHsgdHlwZTogXCJjdXJzb3JcIiB9KSlcblx0XHQpLFxuXHR9KS5zdGF0ZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlc2V0Q3Vyc29yKCkge1xuXHRzdGF0ZSA9IHN0YXRlLnVwZGF0ZSh7XG5cdFx0ZWZmZWN0czogY3Vyc29yRWZmZWN0Lm9mKFxuXHRcdFx0SlNPTi5zdHJpbmdpZnkoe1xuXHRcdFx0XHR0eXBlOiBcImN1cnNvci1vZmZcIixcblx0XHRcdH0pXG5cdFx0KSxcblx0fSkuc3RhdGU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRCYWNrbGlua3MoKTogQmFja2xpbmtbXSB7XG5cdHJldHVybiBzdGF0ZS5maWVsZChiYWNrbGlua3MpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlQmFja2xpbmtzKHZhbHVlOiBCYWNrbGlua1tdKSB7XG5cdHN0YXRlID0gc3RhdGUudXBkYXRlKHtcblx0XHRlZmZlY3RzOiBiYWNrbGlua0VmZmVjdC5vZihcblx0XHRcdEpTT04uc3RyaW5naWZ5KE9iamVjdC5hc3NpZ24oeyBiYWNrbGlua3M6IHZhbHVlIH0sIHsgdHlwZTogXCJiYWNrbGlua1wiIH0pKVxuXHRcdCksXG5cdH0pLnN0YXRlO1xufVxuIiwgImltcG9ydCB7XG5cdEVkaXRvclZpZXcsXG5cdFdpZGdldFR5cGUsXG5cdERlY29yYXRpb24sXG5cdERlY29yYXRpb25TZXQsXG5cdFZpZXdQbHVnaW4sXG5cdFZpZXdVcGRhdGUsXG5cdE1hdGNoRGVjb3JhdG9yLFxuXHRndXR0ZXIsXG5cdEd1dHRlck1hcmtlcixcbn0gZnJvbSBcIkBjb2RlbWlycm9yL3ZpZXdcIjtcbmltcG9ydCB7IFNWR19IT1ZFUl9DT0xPUiB9IGZyb20gXCIuLi9jb25zdGFudHNcIjtcblxuLyogaGlnaGxpZ2h0ICovXG5jbGFzcyBIaWdobGlnaHRlcldpZGdldCBleHRlbmRzIFdpZGdldFR5cGUge1xuXHRjb25zdHJ1Y3Rvcihwcml2YXRlIG5hbWU6IHN0cmluZywgcHJpdmF0ZSB2aWV3OiBFZGl0b3JWaWV3KSB7XG5cdFx0c3VwZXIoKTtcblx0fVxuXG5cdGVxKG90aGVyOiBIaWdobGlnaHRlcldpZGdldCkge1xuXHRcdHJldHVybiB0aGlzLm5hbWUgPT09IG90aGVyLm5hbWU7XG5cdH1cblxuXHR0b0RPTSgpIHtcblx0XHRjb25zdCBzcGFuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImZyYWdtZW50XCIpO1xuXHRcdHNwYW4udGV4dENvbnRlbnQgPSB0aGlzLm5hbWU7XG5cdFx0c3Bhbi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBTVkdfSE9WRVJfQ09MT1I7XG5cdFx0c3Bhbi5zdHlsZS5jb2xvciA9IFwiYmxhY2tcIjtcblxuXHRcdHJldHVybiBzcGFuO1xuXHR9XG59XG5cbmNvbnN0IGhpZ2hsaWdodGVyRGVjb3JhdGlvbiA9IChtYXRjaDogUmVnRXhwRXhlY0FycmF5LCB2aWV3OiBFZGl0b3JWaWV3KSA9PlxuXHREZWNvcmF0aW9uLnJlcGxhY2Uoe1xuXHRcdHdpZGdldDogbmV3IEhpZ2hsaWdodGVyV2lkZ2V0KG1hdGNoWzFdLCB2aWV3KSxcblx0fSk7XG5cbmNvbnN0IGhpZ2hsaWdodE1hdGNoZXIgPSBuZXcgTWF0Y2hEZWNvcmF0b3Ioe1xuXHRyZWdleHA6IC9cXCtcXCtcXCsoLio/KVxcK1xcK1xcKy9nLFxuXHRkZWNvcmF0aW9uOiAobWF0Y2gsIHZpZXcsIHBvcykgPT4ge1xuXHRcdHJldHVybiBoaWdobGlnaHRlckRlY29yYXRpb24obWF0Y2gsIHZpZXcpO1xuXHR9LFxufSk7XG5cbmV4cG9ydCBjb25zdCBoaWdobGlnaHRzID0gVmlld1BsdWdpbi5mcm9tQ2xhc3MoXG5cdGNsYXNzIHtcblx0XHRoaWdobGlnaHRzOiBEZWNvcmF0aW9uU2V0O1xuXHRcdGNvbnN0cnVjdG9yKHZpZXc6IEVkaXRvclZpZXcpIHtcblx0XHRcdHRoaXMuaGlnaGxpZ2h0cyA9IGhpZ2hsaWdodE1hdGNoZXIuY3JlYXRlRGVjbyh2aWV3KTtcblx0XHR9XG5cdFx0dXBkYXRlKHVwZGF0ZTogVmlld1VwZGF0ZSkge1xuXHRcdFx0dGhpcy5oaWdobGlnaHRzID0gaGlnaGxpZ2h0TWF0Y2hlci51cGRhdGVEZWNvKHVwZGF0ZSwgdGhpcy5oaWdobGlnaHRzKTtcblx0XHR9XG5cdFx0ZGVzdHJveSgpIHtcblx0XHRcdHRoaXMuaGlnaGxpZ2h0cyA9IERlY29yYXRpb24ubm9uZTtcblx0XHR9XG5cdH0sXG5cdHtcblx0XHRkZWNvcmF0aW9uczogKGluc3RhbmNlKSA9PiBpbnN0YW5jZS5oaWdobGlnaHRzLFxuXHRcdHByb3ZpZGU6IChwbHVnaW4pID0+XG5cdFx0XHRFZGl0b3JWaWV3LmF0b21pY1Jhbmdlcy5vZigodmlldykgPT4ge1xuXHRcdFx0XHRyZXR1cm4gdmlldy5wbHVnaW4ocGx1Z2luKT8uaGlnaGxpZ2h0cyB8fCBEZWNvcmF0aW9uLm5vbmU7XG5cdFx0XHR9KSxcblx0fVxuKTtcbiIsICJleHBvcnQgbGV0IFJFRkVSRU5DRV9SRUdFWCA9IC9cXFtcXHUyMTk3XFxdXFwodXJuOihbXildKilcXCkvZztcblxuZXhwb3J0IGxldCBBQ1RJT05fVFlQRSA9IHtcblx0TU9VU0U6IFwibW91c2VcIixcblx0Q1VSU09SOiBcImN1cnNvclwiLFxuXHRCQUNLTElOSzogXCJiYWNrbGlua1wiLFxufTtcblxuZXhwb3J0IGxldCBTVkdfSE9WRVJfQ09MT1IgPSBcInJnYigxODcsIDIxNSwgMjMwKVwiO1xuZXhwb3J0IGxldCBTVkdfSE9WRVJfQ09MT1JfTElHSFQgPSBcInJnYigxODcsIDIxNSwgMjMwLCAwLjUpXCI7XG5leHBvcnQgbGV0IFNWR19DT0xPUiA9IFwicmdiKDIxNSwgMjM1LCAwKVwiO1xuXG5leHBvcnQgY29uc3QgUkVGRVJFTkNFX0lDT05fSEVJR0hUID0gMjA7XG5cbmV4cG9ydCBjb25zdCBQT1JUQUxfVEVYVF9TTElDRV9TSVpFID0gMTAwO1xuIiwgImltcG9ydCB7XG5cdEVkaXRvclZpZXcsXG5cdFdpZGdldFR5cGUsXG5cdERlY29yYXRpb24sXG5cdERlY29yYXRpb25TZXQsXG5cdFZpZXdQbHVnaW4sXG5cdFZpZXdVcGRhdGUsXG5cdE1hdGNoRGVjb3JhdG9yLFxuXHRndXR0ZXIsXG5cdEd1dHRlck1hcmtlcixcbn0gZnJvbSBcIkBjb2RlbWlycm9yL3ZpZXdcIjtcblxuaW1wb3J0IHtcblx0b3BlblJlZmVyZW5jZSxcblx0Y3JlYXRlUmVmZXJlbmNlSWNvbixcblx0dXBkYXRlQmFja2xpbmtNYXJrUG9zaXRpb25zLFxufSBmcm9tIFwiLi4vcmVmZXJlbmNlc1wiO1xuaW1wb3J0IHsgZGVjb2RlVVJJQ29tcG9uZW50U3RyaW5nLCBlbmNvZGVVUklDb21wb25lbnRTdHJpbmcgfSBmcm9tIFwic3JjL3V0aWxzXCI7XG5pbXBvcnQgeyBnZXRUaGF0IH0gZnJvbSBcInNyYy9zdGF0ZVwiO1xuaW1wb3J0IHsgRWRpdG9yLCBNYXJrZG93blZpZXcgfSBmcm9tIFwib2JzaWRpYW5cIjtcblxuZnVuY3Rpb24gcHJvY2Vzc0xpbmUobGluZTogRWxlbWVudCkge1xuXHRsZXQgbGluZUNvcHkgPSBsaW5lPy5jbG9uZU5vZGUodHJ1ZSkgYXMgSFRNTEVsZW1lbnQ7XG5cdGxpbmVDb3B5Py5xdWVyeVNlbGVjdG9yQWxsKFwiLnJlZmVyZW5jZS1zcGFuXCIpLmZvckVhY2goKHNwYW4pID0+IHtcblx0XHRzcGFuLmlubmVySFRNTCA9IFwiXHUyMTk3XCI7XG5cdH0pO1xuXG5cdHJldHVybiBsaW5lQ29weTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNlcmlhbGl6ZVJlZmVyZW5jZShcblx0Y29udGVudDogYW55LFxuXHRyZWZlcmVuY2VTcGFuOiBFbGVtZW50LFxuXHR2aWV3OiBFZGl0b3JWaWV3XG4pIHtcblx0Y29udGVudCA9IHR5cGVvZiBjb250ZW50ID09IFwic3RyaW5nXCIgPyBjb250ZW50IDogY29udGVudFsxXTtcblx0Y29uc3QgW3ByZWZpeCwgdGV4dCwgc3VmZml4LCBmaWxlLCBmcm9tLCB0bywgcG9ydGFsLCB0b2dnbGUgPSBcImZcIl0gPVxuXHRcdGNvbnRlbnQuc3BsaXQoXCI6XCIpO1xuXHQvLyBTZXJpYWxpemUgdGhlIHRvZ2dsZSBzdGF0ZSBmb3IgcmVmZXJlbmNlIGludG8gZmlsZVxuXHQvLyBLTk9XTiBFUlJPUi4gY29udGVudERPTSBvbmx5IHJldHVybnMgcGFydGlhbCBmaWxlIGZvciBlZmZpY2llbmN5IG9uIGxhcmdlIGRvY3VtZW50cy4gU28gd2lsbCBsb3NlIHNlcmlhbGl6YXRpb24gaW4gdGhpcyBjYXNlLlxuXHQvLyByZWZlcmVuY2VTcGFuLmNsYXNzTGlzdC50b2dnbGUoXCJyZWZlcmVuY2Utc3Bhbi1oaWRkZW5cIik7XG5cblx0bGV0IG5ld1RvZ2dsZSA9IHJlZmVyZW5jZVNwYW4uY2xhc3NMaXN0LmNvbnRhaW5zKFwicmVmZXJlbmNlLXNwYW4taGlkZGVuXCIpXG5cdFx0PyBcImZcIlxuXHRcdDogXCJ0XCI7XG5cdGxldCByZWZlcmVuY2UgPSBgW1x1MjE5N10odXJuOiR7cHJlZml4fToke3RleHR9OiR7c3VmZml4fToke2ZpbGV9OiR7ZnJvbX06JHt0b306JHtwb3J0YWx9OiR7bmV3VG9nZ2xlfSlgO1xuXG5cdGxldCBsaW5lcyA9IHZpZXcuY29udGVudERPTS5xdWVyeVNlbGVjdG9yQWxsKFwiLmNtLWxpbmVcIik7XG5cdGxldCBjdXJyTGluZSA9IHJlZmVyZW5jZVNwYW4/LnBhcmVudEVsZW1lbnQ/LnBhcmVudEVsZW1lbnQ7XG5cblx0Ly8gZ2V0IHRoZSBpbmRleCBvZiB0aGUgYWN0aXZlTGluZVxuXHRsZXQgYWN0aXZlTGluZUluZGV4O1xuXHRsZXQgc2VlbkFjdGl2ZSA9IGZhbHNlO1xuXHRsaW5lcy5mb3JFYWNoKChsaW5lLCBpKSA9PiB7XG5cdFx0aWYgKHNlZW5BY3RpdmUpIHJldHVybjtcblx0XHRpZiAobGluZSA9PSBjdXJyTGluZSkge1xuXHRcdFx0c2VlbkFjdGl2ZSA9IHRydWU7XG5cdFx0XHRhY3RpdmVMaW5lSW5kZXggPSBpO1xuXHRcdH1cblx0fSk7XG5cblx0Ly8gY29uc3QgZWRpdG9yOiBFZGl0b3IgfCB1bmRlZmluZWQgPVxuXHQvLyBcdGdldFRoYXQoKS53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpPy5lZGl0b3I7XG5cdC8vIGlmICghZWRpdG9yKSByZXR1cm47XG5cdC8vIGNvbnN0IGN1cnNvciA9IGVkaXRvci5nZXRDdXJzb3IoKTtcblx0Ly8gY29uc29sZS5sb2coY3Vyc29yKTtcblx0Ly8gY29uc29sZS5sb2coYWN0aXZlTGluZUluZGV4KTtcblxuXHRpZiAoYWN0aXZlTGluZUluZGV4ID09PSB1bmRlZmluZWQpIHJldHVybjtcblx0bGV0IGFjdGl2ZUxpbmUgPSBsaW5lc1thY3RpdmVMaW5lSW5kZXhdO1xuXHQvLyBtYWtlIGNvcHkgb2YgYWN0aXZlTGluZSBlbGVtZW50XG5cdGxldCBhY3RpdmVMaW5lQ29weSA9IHByb2Nlc3NMaW5lKGFjdGl2ZUxpbmUpO1xuXHQvLyBub24tcmVmZXJlbmNlZCBwYXJ0cyBvZiB0aGUgdGV4dFxuXHRsZXQgcGFydHMgPSBhY3RpdmVMaW5lQ29weS5pbm5lclRleHQuc3BsaXQoXCJcdTIxOTdcIik7XG5cblx0Ly8gZ2V0IGFsbCByZWZlcmVuY2VzXG5cdGxldCBsaW5lUmVmZXJlbmNlcyA9IGFjdGl2ZUxpbmU/LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucmVmZXJlbmNlLWRhdGEtc3BhblwiKTtcblxuXHQvLyBnZXQgdGhlIGZ1bGwgc2VyaWFsaXplZCB2ZXJzaW9uIGZvciB0aGVzZSByZWZlcmVuY2VzXG5cdGxldCBsaW5lUmVmZXJlbmNlc0RhdGEgPSBBcnJheS5mcm9tKGxpbmVSZWZlcmVuY2VzIHx8IFtdKS5tYXAoXG5cdFx0KHNwYW4pID0+IFwiW1x1MjE5N10odXJuOlwiICsgc3Bhbi5nZXRBdHRyaWJ1dGUoXCJkYXRhXCIpICsgXCIpXCJcblx0KTtcblx0aWYgKGNvbnRlbnQpIHtcblx0XHQvLyBpZGVudGlmeSB3aGljaCByZWZlcmVuY2UgaXMgYmVpbmcgdG9nZ2xlZFxuXHRcdC8vIGxldCBpbmRleCA9IGxpbmVSZWZlcmVuY2VzRGF0YS5yZWR1Y2UoXG5cdFx0Ly8gXHQocHJldlZhbHVlLCBjdXJyZW50VmFsdWUsIGN1cnJlbnRJbmRleCkgPT4ge1xuXHRcdC8vIFx0XHRpZiAoY3VycmVudFZhbHVlLmNvbnRhaW5zKGNvbnRlbnQpKSByZXR1cm4gY3VycmVudEluZGV4O1xuXHRcdC8vIFx0XHRyZXR1cm4gY3VycmVudFZhbHVlO1xuXHRcdC8vIFx0fSxcblx0XHQvLyBcdG51bGxcblx0XHQvLyApO1xuXHRcdGNvbnN0IGluZGV4ID0gbGluZVJlZmVyZW5jZXNEYXRhLnJlZHVjZShcblx0XHRcdChwcmV2SW5kZXgsIGN1cnJlbnRWYWx1ZSwgY3VycmVudEluZGV4KSA9PiB7XG5cdFx0XHRcdGlmIChjdXJyZW50VmFsdWUuaW5jbHVkZXMoY29udGVudFswXSkpIHtcblx0XHRcdFx0XHRyZXR1cm4gY3VycmVudEluZGV4O1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiBwcmV2SW5kZXg7XG5cdFx0XHR9LFxuXHRcdFx0bnVsbFxuXHRcdCk7XG5cblx0XHRpZiAoIWluZGV4ICYmIGluZGV4ICE9IDApIHRocm93IG5ldyBFcnJvcihcIlJlZmVyZW5jZSBub3QgZm91bmRcIik7XG5cblx0XHQvLyBnZXQgdGhlIHRleHQgYmVmb3JlIHRoZSByZWZlcmVuY2Vcblx0XHRsZXQgc3RhcnRUZXh0ID0gW1xuXHRcdFx0Li4ucGFydHMuc2xpY2UoMCwgaW5kZXggKyAxKSxcblx0XHRcdC4uLmxpbmVSZWZlcmVuY2VzRGF0YS5zbGljZSgwLCBpbmRleCksXG5cdFx0XTtcblxuXHRcdC8vIGdldCBhbGwgdGhlIHByaW9yIGxpbmVzIHRvIGFjdGl2ZSBsaW5lIGFuZCB0aGUgbGVuZ3RoIG9mIHRoZSB0ZXh0XG5cdFx0bGV0IHByZXZMaW5lQ2hhckNvdW50ID0gQXJyYXkuZnJvbShsaW5lcylcblx0XHRcdC5zbGljZSgwLCBhY3RpdmVMaW5lSW5kZXgpXG5cdFx0XHQucmVkdWNlKChhY2MsIGxpbmUpID0+IHtcblx0XHRcdFx0bGV0IHByb2Nlc3NlZExpbmUgPSBwcm9jZXNzTGluZShsaW5lKTtcblx0XHRcdFx0bGV0IHBhcnRzID0gcHJvY2Vzc2VkTGluZS5pbm5lclRleHQuc3BsaXQoXCJcdTIxOTdcIik7XG5cblx0XHRcdFx0bGV0IGxpbmVSZWZlcmVuY2VzID0gbGluZT8ucXVlcnlTZWxlY3RvckFsbChcIi5yZWZlcmVuY2UtZGF0YS1zcGFuXCIpO1xuXHRcdFx0XHRsZXQgbGluZVJlZmVyZW5jZXNEYXRhID0gQXJyYXkuZnJvbShsaW5lUmVmZXJlbmNlcyB8fCBbXSkubWFwKFxuXHRcdFx0XHRcdChzcGFuKSA9PiBcIltcdTIxOTddKHVybjpcIiArIHNwYW4uZ2V0QXR0cmlidXRlKFwiZGF0YVwiKSArIFwiKVwiXG5cdFx0XHRcdCk7XG5cdFx0XHRcdGxldCBhbGxTZXJpYWxpemVkVGV4dCA9XG5cdFx0XHRcdFx0Wy4uLnBhcnRzLCAuLi5saW5lUmVmZXJlbmNlc0RhdGFdLmpvaW4oXCJcIikgKyBcIlxcblwiO1xuXHRcdFx0XHRyZXR1cm4gYWxsU2VyaWFsaXplZFRleHQubGVuZ3RoICsgYWNjO1xuXHRcdFx0fSwgMCk7XG5cblx0XHQvLyBzZXQgcmFuZ2UgdG8gcmVwbGFjZSB3aXRoIG5ldyByZWZlcmVuY2Ugc2VyaWFsaXphdGlvblxuXHRcdGxldCBmcm9tID0gcHJldkxpbmVDaGFyQ291bnQgKyBzdGFydFRleHQuam9pbihcIlwiKS5sZW5ndGg7XG5cdFx0bGV0IHRvID0gZnJvbSArIHJlZmVyZW5jZS5sZW5ndGg7XG5cblx0XHRjb25zdCB0cmFuc2FjdGlvbiA9IHZpZXcuc3RhdGUudXBkYXRlKHtcblx0XHRcdGNoYW5nZXM6IHsgZnJvbSwgdG8sIGluc2VydDogcmVmZXJlbmNlIH0sXG5cdFx0fSk7XG5cdFx0Y29uc29sZS5sb2codHJhbnNhY3Rpb24pO1xuXHRcdHZpZXcuZGlzcGF0Y2godHJhbnNhY3Rpb24pO1xuXHRcdGF3YWl0IHVwZGF0ZUJhY2tsaW5rTWFya1Bvc2l0aW9ucygpO1xuXG5cdFx0Ly8gYXdhaXQgdGhpcy51cGRhdGVOYW1lKHJlZmVyZW5jZSwgZnJvbSwgdG8pO1xuXHR9XG59XG5cbi8qIG5ldyBwbGFjZWhvbGRlciAqL1xuY2xhc3MgUmVmZXJlbmNlV2lkZ2V0IGV4dGVuZHMgV2lkZ2V0VHlwZSB7XG5cdGNvbnN0cnVjdG9yKFxuXHRcdHByaXZhdGUgbmFtZTogc3RyaW5nLFxuXHRcdHByaXZhdGUgdmlldzogRWRpdG9yVmlldyxcblx0XHRwcml2YXRlIHBvczogbnVtYmVyXG5cdCkge1xuXHRcdHN1cGVyKCk7XG5cdH1cblxuXHRlcShvdGhlcjogUmVmZXJlbmNlV2lkZ2V0KSB7XG5cdFx0cmV0dXJuIHRoaXMubmFtZSA9PT0gb3RoZXIubmFtZTtcblx0fVxuXG5cdGFzeW5jIHVwZGF0ZU5hbWUobmFtZTogc3RyaW5nLCBmcm9tOiBudW1iZXIsIHRvOiBudW1iZXIpIHtcblx0XHQvLyBjb25zdCB0cmFuc2FjdGlvbiA9IHRoaXMudmlldy5zdGF0ZS51cGRhdGUoe1xuXHRcdC8vIFx0Y2hhbmdlczogeyBmcm9tLCB0bywgaW5zZXJ0OiBuYW1lIH0sXG5cdFx0Ly8gfSk7XG5cdFx0Ly8gdGhpcy52aWV3LmRpc3BhdGNoKHRyYW5zYWN0aW9uKTtcblx0XHQvLyBhd2FpdCB1cGRhdGVCYWNrbGlua01hcmtQb3NpdGlvbnMoKTtcblx0XHR0aGlzLm5hbWUgPSBuYW1lO1xuXHR9XG5cblx0Z2V0VmlldygpIHtcblx0XHRyZXR1cm4gdGhpcy52aWV3O1xuXHR9XG5cblx0dG9ET00oKSB7XG5cdFx0Y29uc3QgcmVnZXggPSAvXFxbXHUyMTk3XFxdXFwodXJuOihbXildKilcXCkvZztcblx0XHRsZXQgY29udGVudCA9IHJlZ2V4LmV4ZWModGhpcy5uYW1lKTtcblx0XHRpZiAoIWNvbnRlbnQpIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgcmVmZXJlbmNlXCIpO1xuXG5cdFx0Y29uc3QgW3ByZWZpeCwgdGV4dCwgc3VmZml4LCBmaWxlLCBmcm9tLCB0bywgcG9ydGFsLCB0b2dnbGUgPSBcImZcIl0gPVxuXHRcdFx0Y29udGVudFsxXS5zcGxpdChcIjpcIik7XG5cblx0XHQvLyBoaWdobGlnaHREZWZhdWx0U2VsZWN0aW9uKHRoaXMudmlldywgcGFyc2VGbG9hdChmcm9tKSwgcGFyc2VGbG9hdCh0bykpO1xuXG5cdFx0Y29uc3QgeyBzcGFuLCBzdmcgfSA9IGNyZWF0ZVJlZmVyZW5jZUljb24oXG5cdFx0XHRwb3J0YWwgPT0gXCJwb3J0YWxcIiA/IFwiaW5saW5lIHJlZmVyZW5jZSB3aWRnZXQgfCp8XCIgOiBudWxsXG5cdFx0KTtcblxuXHRcdGlmIChjb250ZW50KSBzcGFuLnNldEF0dHJpYnV0ZShcImRhdGFcIiwgY29udGVudFsxXSk7XG5cblx0XHRjb25zdCBjb250YWluZXJTcGFuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XG5cdFx0Y29udGFpbmVyU3Bhbi5jbGFzc0xpc3QuYWRkKFwicmVmZXJlbmNlLWNvbnRhaW5lci1zcGFuXCIpO1xuXHRcdGNvbnN0IHJlZmVyZW5jZVNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTtcblx0XHQvLyBhZGQgY2xhc3Ncblx0XHRyZWZlcmVuY2VTcGFuLmNsYXNzTGlzdC5hZGQoXCJyZWZlcmVuY2Utc3BhblwiKTtcblxuXHRcdHJlZmVyZW5jZVNwYW4uaW5uZXJIVE1MID0gZGVjb2RlVVJJQ29tcG9uZW50U3RyaW5nKHRleHQpO1xuXHRcdHJlZmVyZW5jZVNwYW4uY2xhc3NMaXN0LnRvZ2dsZShcInJlZmVyZW5jZS1zcGFuLWhpZGRlblwiLCB0b2dnbGUgPT09IFwiZlwiKTtcblxuXHRcdGNvbnRhaW5lclNwYW4uYXBwZW5kQ2hpbGQocmVmZXJlbmNlU3Bhbik7XG5cdFx0Y29udGFpbmVyU3Bhbi5hcHBlbmRDaGlsZChzcGFuKTtcblxuXHRcdGNvbnRhaW5lclNwYW4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGFzeW5jIChldikgPT4ge1xuXHRcdFx0aWYgKGV2Lm1ldGFLZXkgfHwgZXYuY3RybEtleSkge1xuXHRcdFx0XHRyZWZlcmVuY2VTcGFuLmNsYXNzTGlzdC50b2dnbGUoXCJyZWZlcmVuY2Utc3Bhbi1oaWRkZW5cIik7XG5cdFx0XHRcdGF3YWl0IHNlcmlhbGl6ZVJlZmVyZW5jZShjb250ZW50LCByZWZlcmVuY2VTcGFuLCB0aGlzLnZpZXcpO1xuXHRcdFx0XHRpZiAoY29udGVudCkgdGhpcy5uYW1lID0gY29udGVudFswXTtcblxuXHRcdFx0XHQvLyAvLyBTZXJpYWxpemUgdGhlIHRvZ2dsZSBzdGF0ZSBmb3IgcmVmZXJlbmNlIGludG8gZmlsZVxuXHRcdFx0XHQvLyAvLyBLTk9XTiBFUlJPUi4gY29udGVudERPTSBvbmx5IHJldHVybnMgcGFydGlhbCBmaWxlIGZvciBlZmZpY2llbmN5IG9uIGxhcmdlIGRvY3VtZW50cy4gU28gd2lsbCBsb3NlIHNlcmlhbGl6YXRpb24gaW4gdGhpcyBjYXNlLlxuXHRcdFx0XHQvLyByZWZlcmVuY2VTcGFuLmNsYXNzTGlzdC50b2dnbGUoXCJyZWZlcmVuY2Utc3Bhbi1oaWRkZW5cIik7XG5cblx0XHRcdFx0Ly8gbGV0IG5ld1RvZ2dsZSA9IHJlZmVyZW5jZVNwYW4uY2xhc3NMaXN0LmNvbnRhaW5zKFxuXHRcdFx0XHQvLyBcdFwicmVmZXJlbmNlLXNwYW4taGlkZGVuXCJcblx0XHRcdFx0Ly8gKVxuXHRcdFx0XHQvLyBcdD8gXCJmXCJcblx0XHRcdFx0Ly8gXHQ6IFwidFwiO1xuXHRcdFx0XHQvLyBsZXQgcmVmZXJlbmNlID0gYFtcdTIxOTddKHVybjoke3ByZWZpeH06JHt0ZXh0fToke3N1ZmZpeH06JHtmaWxlfToke2Zyb219OiR7dG99OiR7cG9ydGFsfToke25ld1RvZ2dsZX0pYDtcblxuXHRcdFx0XHQvLyBsZXQgbGluZXMgPSB0aGlzLmdldFZpZXcoKS5jb250ZW50RE9NLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY20tbGluZVwiKTtcblxuXHRcdFx0XHQvLyAvLyBnZXQgdGhlIGluZGV4IG9mIHRoZSBhY3RpdmVMaW5lXG5cdFx0XHRcdC8vIGxldCBhY3RpdmVMaW5lSW5kZXg7XG5cdFx0XHRcdC8vIGxldCBzZWVuQWN0aXZlID0gZmFsc2U7XG5cdFx0XHRcdC8vIGxpbmVzLmZvckVhY2goKGxpbmUsIGkpID0+IHtcblx0XHRcdFx0Ly8gXHRpZiAoc2VlbkFjdGl2ZSkgcmV0dXJuO1xuXHRcdFx0XHQvLyBcdGlmIChsaW5lLmNsYXNzTGlzdC5jb250YWlucyhcImNtLWFjdGl2ZVwiKSkge1xuXHRcdFx0XHQvLyBcdFx0c2VlbkFjdGl2ZSA9IHRydWU7XG5cdFx0XHRcdC8vIFx0XHRhY3RpdmVMaW5lSW5kZXggPSBpO1xuXHRcdFx0XHQvLyBcdH1cblx0XHRcdFx0Ly8gfSk7XG5cblx0XHRcdFx0Ly8gLy8gY29uc3QgZWRpdG9yOiBFZGl0b3IgfCB1bmRlZmluZWQgPVxuXHRcdFx0XHQvLyAvLyBcdGdldFRoYXQoKS53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpPy5lZGl0b3I7XG5cdFx0XHRcdC8vIC8vIGlmICghZWRpdG9yKSByZXR1cm47XG5cdFx0XHRcdC8vIC8vIGNvbnN0IGN1cnNvciA9IGVkaXRvci5nZXRDdXJzb3IoKTtcblx0XHRcdFx0Ly8gLy8gY29uc29sZS5sb2coY3Vyc29yKTtcblx0XHRcdFx0Ly8gLy8gY29uc29sZS5sb2coYWN0aXZlTGluZUluZGV4KTtcblxuXHRcdFx0XHQvLyBpZiAoYWN0aXZlTGluZUluZGV4ID09PSB1bmRlZmluZWQpIHJldHVybjtcblx0XHRcdFx0Ly8gbGV0IGFjdGl2ZUxpbmUgPSBsaW5lc1thY3RpdmVMaW5lSW5kZXhdO1xuXHRcdFx0XHQvLyAvLyBtYWtlIGNvcHkgb2YgYWN0aXZlTGluZSBlbGVtZW50XG5cdFx0XHRcdC8vIGxldCBhY3RpdmVMaW5lQ29weSA9IHByb2Nlc3NMaW5lKGFjdGl2ZUxpbmUpO1xuXHRcdFx0XHQvLyAvLyBub24tcmVmZXJlbmNlZCBwYXJ0cyBvZiB0aGUgdGV4dFxuXHRcdFx0XHQvLyBsZXQgcGFydHMgPSBhY3RpdmVMaW5lQ29weS5pbm5lclRleHQuc3BsaXQoXCJcdTIxOTdcIik7XG5cblx0XHRcdFx0Ly8gLy8gZ2V0IGFsbCByZWZlcmVuY2VzXG5cdFx0XHRcdC8vIGxldCBsaW5lUmVmZXJlbmNlcyA9IGFjdGl2ZUxpbmU/LnF1ZXJ5U2VsZWN0b3JBbGwoXG5cdFx0XHRcdC8vIFx0XCIucmVmZXJlbmNlLWRhdGEtc3BhblwiXG5cdFx0XHRcdC8vICk7XG5cblx0XHRcdFx0Ly8gLy8gZ2V0IHRoZSBmdWxsIHNlcmlhbGl6ZWQgdmVyc2lvbiBmb3IgdGhlc2UgcmVmZXJlbmNlc1xuXHRcdFx0XHQvLyBsZXQgbGluZVJlZmVyZW5jZXNEYXRhID0gQXJyYXkuZnJvbShsaW5lUmVmZXJlbmNlcyB8fCBbXSkubWFwKFxuXHRcdFx0XHQvLyBcdChzcGFuKSA9PiBcIltcdTIxOTddKHVybjpcIiArIHNwYW4uZ2V0QXR0cmlidXRlKFwiZGF0YVwiKSArIFwiKVwiXG5cdFx0XHRcdC8vICk7XG5cdFx0XHRcdC8vIGlmIChjb250ZW50ICYmIGNvbnRlbnRbMV0pIHtcblx0XHRcdFx0Ly8gXHQvLyBpZGVudGlmeSB3aGljaCByZWZlcmVuY2UgaXMgYmVpbmcgdG9nZ2xlZFxuXHRcdFx0XHQvLyBcdGxldCBpbmRleCA9IGxpbmVSZWZlcmVuY2VzRGF0YS5pbmRleE9mKGNvbnRlbnRbMF0pO1xuXHRcdFx0XHQvLyBcdGlmIChpbmRleCA9PSAtMSkgdGhyb3cgbmV3IEVycm9yKFwiUmVmZXJlbmNlIG5vdCBmb3VuZFwiKTtcblxuXHRcdFx0XHQvLyBcdC8vIGdldCB0aGUgdGV4dCBiZWZvcmUgdGhlIHJlZmVyZW5jZVxuXHRcdFx0XHQvLyBcdGxldCBzdGFydFRleHQgPSBbXG5cdFx0XHRcdC8vIFx0XHQuLi5wYXJ0cy5zbGljZSgwLCBpbmRleCArIDEpLFxuXHRcdFx0XHQvLyBcdFx0Li4ubGluZVJlZmVyZW5jZXNEYXRhLnNsaWNlKDAsIGluZGV4KSxcblx0XHRcdFx0Ly8gXHRdO1xuXG5cdFx0XHRcdC8vIFx0Ly8gZ2V0IGFsbCB0aGUgcHJpb3IgbGluZXMgdG8gYWN0aXZlIGxpbmUgYW5kIHRoZSBsZW5ndGggb2YgdGhlIHRleHRcblx0XHRcdFx0Ly8gXHRsZXQgcHJldkxpbmVDaGFyQ291bnQgPSBBcnJheS5mcm9tKGxpbmVzKVxuXHRcdFx0XHQvLyBcdFx0LnNsaWNlKDAsIGFjdGl2ZUxpbmVJbmRleClcblx0XHRcdFx0Ly8gXHRcdC5yZWR1Y2UoKGFjYywgbGluZSkgPT4ge1xuXHRcdFx0XHQvLyBcdFx0XHRsZXQgcHJvY2Vzc2VkTGluZSA9IHByb2Nlc3NMaW5lKGxpbmUpO1xuXHRcdFx0XHQvLyBcdFx0XHRsZXQgcGFydHMgPSBwcm9jZXNzZWRMaW5lLmlubmVyVGV4dC5zcGxpdChcIlx1MjE5N1wiKTtcblxuXHRcdFx0XHQvLyBcdFx0XHRsZXQgbGluZVJlZmVyZW5jZXMgPSBsaW5lPy5xdWVyeVNlbGVjdG9yQWxsKFxuXHRcdFx0XHQvLyBcdFx0XHRcdFwiLnJlZmVyZW5jZS1kYXRhLXNwYW5cIlxuXHRcdFx0XHQvLyBcdFx0XHQpO1xuXHRcdFx0XHQvLyBcdFx0XHRsZXQgbGluZVJlZmVyZW5jZXNEYXRhID0gQXJyYXkuZnJvbShsaW5lUmVmZXJlbmNlcyB8fCBbXSkubWFwKFxuXHRcdFx0XHQvLyBcdFx0XHRcdChzcGFuKSA9PiBcIltcdTIxOTddKHVybjpcIiArIHNwYW4uZ2V0QXR0cmlidXRlKFwiZGF0YVwiKSArIFwiKVwiXG5cdFx0XHRcdC8vIFx0XHRcdCk7XG5cdFx0XHRcdC8vIFx0XHRcdGxldCBhbGxTZXJpYWxpemVkVGV4dCA9XG5cdFx0XHRcdC8vIFx0XHRcdFx0Wy4uLnBhcnRzLCAuLi5saW5lUmVmZXJlbmNlc0RhdGFdLmpvaW4oXCJcIikgKyBcIlxcblwiO1xuXHRcdFx0XHQvLyBcdFx0XHRyZXR1cm4gYWxsU2VyaWFsaXplZFRleHQubGVuZ3RoICsgYWNjO1xuXHRcdFx0XHQvLyBcdFx0fSwgMCk7XG5cblx0XHRcdFx0Ly8gXHQvLyBzZXQgcmFuZ2UgdG8gcmVwbGFjZSB3aXRoIG5ldyByZWZlcmVuY2Ugc2VyaWFsaXphdGlvblxuXHRcdFx0XHQvLyBcdGxldCBmcm9tID0gcHJldkxpbmVDaGFyQ291bnQgKyBzdGFydFRleHQuam9pbihcIlwiKS5sZW5ndGg7XG5cdFx0XHRcdC8vIFx0bGV0IHRvID0gZnJvbSArIHJlZmVyZW5jZS5sZW5ndGg7XG5cblx0XHRcdFx0Ly8gXHRhd2FpdCB0aGlzLnVwZGF0ZU5hbWUocmVmZXJlbmNlLCBmcm9tLCB0byk7XG5cdFx0XHRcdC8vIH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG9wZW5SZWZlcmVuY2UoZXYpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0cmV0dXJuIGNvbnRhaW5lclNwYW47XG5cdH1cbn1cblxuY29uc3QgcmVmZXJlbmNlRGVjb3JhdGlvbiA9IChcblx0bWF0Y2g6IFJlZ0V4cEV4ZWNBcnJheSxcblx0dmlldzogRWRpdG9yVmlldyxcblx0cG9zOiBudW1iZXJcbikgPT4ge1xuXHRsZXQgZGVjb3JhdGlvbiA9IERlY29yYXRpb24ucmVwbGFjZSh7XG5cdFx0d2lkZ2V0OiBuZXcgUmVmZXJlbmNlV2lkZ2V0KG1hdGNoWzBdLCB2aWV3LCBwb3MpLFxuXHR9KTtcblx0cmV0dXJuIGRlY29yYXRpb247XG59O1xuXG5jb25zdCByZWZlcmVuY2VNYXRjaGVyID0gbmV3IE1hdGNoRGVjb3JhdG9yKHtcblx0Ly8gcmVnZXhwOiAvXFxbXFx1MjE5N1xcXVxcKHVybjpbXFxzXFxTXlxcKV0qXFwpL2csXG5cdC8vIHJlZ2V4cDogL1xcW1xcdTIxOTdcXF1cXCh1cm46KFteOl0qOil7NSw2fVteOl0qXFwpL2csXG5cdC8vIHJlZ2V4cDogL1xcW1xcdTIxOTdcXF1cXCh1cm46KFteOl0qOil7Nn1bXjopXSpcXCkvZyxcblx0cmVnZXhwOiAvXFxbXFx1MjE5N1xcXVxcKHVybjooW146XSo6KXs3fVteOildKlxcKS9nLFxuXHRkZWNvcmF0aW9uOiAobWF0Y2gsIHZpZXcsIHBvcykgPT4ge1xuXHRcdHJldHVybiByZWZlcmVuY2VEZWNvcmF0aW9uKG1hdGNoLCB2aWV3LCBwb3MpO1xuXHR9LFxufSk7XG5cbmV4cG9ydCBjb25zdCByZWZlcmVuY2VSZXNvdXJjZXMgPSBWaWV3UGx1Z2luLmZyb21DbGFzcyhcblx0Y2xhc3Mge1xuXHRcdHJlZmVyZW5jZVJlc291cmNlczogRGVjb3JhdGlvblNldDtcblx0XHRjb25zdHJ1Y3Rvcih2aWV3OiBFZGl0b3JWaWV3KSB7XG5cdFx0XHR0aGlzLnJlZmVyZW5jZVJlc291cmNlcyA9IHJlZmVyZW5jZU1hdGNoZXIuY3JlYXRlRGVjbyh2aWV3KTtcblx0XHR9XG5cdFx0dXBkYXRlKHVwZGF0ZTogVmlld1VwZGF0ZSkge1xuXHRcdFx0dGhpcy5yZWZlcmVuY2VSZXNvdXJjZXMgPSByZWZlcmVuY2VNYXRjaGVyLnVwZGF0ZURlY28oXG5cdFx0XHRcdHVwZGF0ZSxcblx0XHRcdFx0dGhpcy5yZWZlcmVuY2VSZXNvdXJjZXNcblx0XHRcdCk7XG5cdFx0fVxuXHRcdGRlc3Ryb3koKSB7XG5cdFx0XHR0aGlzLnJlZmVyZW5jZVJlc291cmNlcyA9IERlY29yYXRpb24ubm9uZTtcblx0XHR9XG5cdH0sXG5cdHtcblx0XHRkZWNvcmF0aW9uczogKGluc3RhbmNlKSA9PiBpbnN0YW5jZS5yZWZlcmVuY2VSZXNvdXJjZXMsXG5cdFx0cHJvdmlkZTogKHBsdWdpbikgPT5cblx0XHRcdEVkaXRvclZpZXcuYXRvbWljUmFuZ2VzLm9mKCh2aWV3KSA9PiB7XG5cdFx0XHRcdHJldHVybiB2aWV3LnBsdWdpbihwbHVnaW4pPy5yZWZlcmVuY2VSZXNvdXJjZXMgfHwgRGVjb3JhdGlvbi5ub25lO1xuXHRcdFx0fSksXG5cdH1cbik7XG4iLCAiaW1wb3J0IHsgRWRpdG9yLCBURmlsZSwgV29ya3NwYWNlTGVhZiwgTWFya2Rvd25WaWV3IH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBFZGl0b3JWaWV3LCBzY3JvbGxQYXN0RW5kIH0gZnJvbSBcIkBjb2RlbWlycm9yL3ZpZXdcIjtcbmltcG9ydCB7IHY1IGFzIHV1aWR2NSB9IGZyb20gXCJ1dWlkXCI7XG5cbmltcG9ydCB7XG5cdHN0YXRlLFxuXHR1cGRhdGVIb3Zlcixcblx0Z2V0VGhhdCxcblx0Z2V0QmFja2xpbmtzLFxuXHR1cGRhdGVCYWNrbGlua3MsXG5cdHVwZGF0ZUN1cnNvcixcblx0Z2V0Q3Vyc29yLFxuXHRnZXRIb3Zlcixcblx0cmVzZXRDdXJzb3IsXG5cdHVwZGF0ZUhvdmVyZWRDdXJzb3IsXG5cdHVwZGF0ZUJhY2tsaW5rSG92ZXIsXG5cdGdldEJhY2tsaW5rSG92ZXIsXG59IGZyb20gXCIuL3N0YXRlXCI7XG5pbXBvcnQge1xuXHRwcm9jZXNzVVJJLFxuXHRnZXRQcmVmaXhBbmRTdWZmaXgsXG5cdGhhbmRsZVJlbW92ZUhvdmVyZWRDdXJzb3IsXG5cdGVuY29kZVVSSUNvbXBvbmVudFN0cmluZyxcblx0ZGVjb2RlVVJJQ29tcG9uZW50U3RyaW5nLFxufSBmcm9tIFwiLi91dGlsc1wiO1xuaW1wb3J0IHtcblx0QUNUSU9OX1RZUEUsXG5cdFBPUlRBTF9URVhUX1NMSUNFX1NJWkUsXG5cdFJFRkVSRU5DRV9JQ09OX0hFSUdIVCxcblx0UkVGRVJFTkNFX1JFR0VYLFxuXHRTVkdfSE9WRVJfQ09MT1IsXG59IGZyb20gXCIuL2NvbnN0YW50c1wiO1xuaW1wb3J0IHsgRG9jdW1lbnRMb2NhdGlvbiwgQmFja2xpbmsgfSBmcm9tIFwiLi90eXBlc1wiO1xuaW1wb3J0IHsgdjQgYXMgdXVpZHY0IH0gZnJvbSBcInV1aWRcIjtcbmltcG9ydCB7IGRlZmF1bHRIaWdobGlnaHRTZWxlY3Rpb24gfSBmcm9tIFwiLi9tYXJrXCI7XG5pbXBvcnQgeyBkZWxheSB9IGZyb20gXCIuL2VmZmVjdHNcIjtcbmltcG9ydCB7IGdlbmVyYXRlRGVmYXVsdEhpZ2hsaWdodHMgfSBmcm9tIFwiLi9tYWluXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVSZWZlcmVuY2VJY29uKHBvcnRhbFRleHQ6IHN0cmluZyB8IG51bGwgPSBudWxsKToge1xuXHRzcGFuOiBIVE1MU3BhbkVsZW1lbnQ7XG5cdHN2ZzogU1ZHRWxlbWVudDtcbn0ge1xuXHRjb25zdCBzcGFuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XG5cdHNwYW4uc3R5bGUuY3Vyc29yID0gXCJwb2ludGVyXCI7XG5cdHNwYW4uY2xhc3NMaXN0LmFkZChcInJlZmVyZW5jZS1kYXRhLXNwYW5cIik7XG5cdHNwYW4uY2xhc3NMaXN0LmFkZChcInV1aWQtXCIgKyB1dWlkdjQoKSk7XG5cblx0Y29uc3QgaGVpZ2h0ID0gUkVGRVJFTkNFX0lDT05fSEVJR0hUO1xuXHRjb25zdCB3aWR0aCA9IGhlaWdodCAqIDAuOTtcblxuXHRpZiAocG9ydGFsVGV4dCA9PSBudWxsKSB7XG5cdFx0Y29uc3Qgc3ZnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiwgXCJzdmdcIik7XG5cdFx0Ly8gc3ZnLnNldEF0dHJpYnV0ZShcIndpZHRoXCIsIGAke3dpZHRofWApO1xuXHRcdC8vIHN2Zy5zZXRBdHRyaWJ1dGUoXCJoZWlnaHRcIiwgYCR7aGVpZ2h0fWApO1xuXHRcdC8vIHN2Zy5zZXRBdHRyaWJ1dGUoXCJ2aWV3Qm94XCIsIGAwIDAgJHt3aWR0aH0gJHtoZWlnaHR9YCk7XG5cdFx0Ly8gc3ZnLnNldEF0dHJpYnV0ZShcImZpbGxcIiwgXCJ3aGl0ZVwiKTtcblx0XHQvLyBzdmcuc2V0QXR0cmlidXRlKFwieG1sbnNcIiwgXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiKTtcblx0XHQvLyBzdmcuc3R5bGUuYm9yZGVyID0gXCIzcHggc29saWQgZ3JleVwiO1xuXHRcdC8vIHN2Zy5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIndoaXRlXCI7XG5cdFx0Ly8gc3ZnLnN0eWxlLmJvcmRlclJhZGl1cyA9IFwiM3B4XCI7XG5cdFx0Ly8gc3ZnLnN0eWxlLmN1cnNvciA9IFwicG9pbnRlclwiO1xuXHRcdC8vIHN2Zy5jbGFzc0xpc3QuYWRkKFwicmVmZXJlbmNlLWljb25cIik7XG5cblx0XHQvLyBjb25zdCBsaW5lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiwgXCJsaW5lXCIpO1xuXHRcdC8vIGxpbmUuc2V0QXR0cmlidXRlKFwieDFcIiwgXCIzXCIpO1xuXHRcdC8vIGxpbmUuc2V0QXR0cmlidXRlKFwieTFcIiwgYCR7KGhlaWdodCAtIDMpIC8gM31gKTtcblx0XHQvLyBsaW5lLnNldEF0dHJpYnV0ZShcIngyXCIsIFwiMTJcIik7XG5cdFx0Ly8gbGluZS5zZXRBdHRyaWJ1dGUoXCJ5MlwiLCBgJHsoaGVpZ2h0IC0gMykgLyAzfWApO1xuXHRcdC8vIGxpbmUuc2V0QXR0cmlidXRlKFwic3Ryb2tlLXdpZHRoXCIsIFwiMlwiKTsgLy8gU2V0IHRoZSBzdHJva2Ugd2VpZ2h0IHRvIDFcblx0XHQvLyBsaW5lLnNldEF0dHJpYnV0ZShcInN0cm9rZVwiLCBcImdyZXlcIik7IC8vIFNldCB0aGUgc3Ryb2tlIGNvbG9yIHRvIGJsYWNrXG5cblx0XHQvLyBzdmcuYXBwZW5kQ2hpbGQobGluZSk7XG5cblx0XHQvLyBjb25zdCBsaW5lMiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyhcblx0XHQvLyBcdFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIixcblx0XHQvLyBcdFwibGluZVwiXG5cdFx0Ly8gKTtcblx0XHQvLyBsaW5lMi5zZXRBdHRyaWJ1dGUoXCJ4MVwiLCBcIjNcIik7XG5cdFx0Ly8gbGluZTIuc2V0QXR0cmlidXRlKFwieTFcIiwgYCR7KChoZWlnaHQgLSAzKSAvIDMpICogMn1gKTtcblx0XHQvLyBsaW5lMi5zZXRBdHRyaWJ1dGUoXCJ4MlwiLCBcIjE1XCIpO1xuXHRcdC8vIGxpbmUyLnNldEF0dHJpYnV0ZShcInkyXCIsIGAkeygoaGVpZ2h0IC0gMykgLyAzKSAqIDJ9YCk7XG5cdFx0Ly8gbGluZTIuc2V0QXR0cmlidXRlKFwic3Ryb2tlLXdpZHRoXCIsIFwiMlwiKTsgLy8gU2V0IHRoZSBzdHJva2Ugd2VpZ2h0IHRvIDFcblx0XHQvLyBsaW5lMi5zZXRBdHRyaWJ1dGUoXCJzdHJva2VcIiwgXCJncmV5XCIpOyAvLyBTZXQgdGhlIHN0cm9rZSBjb2xvciB0byBibGFja1xuXG5cdFx0Ly8gc3ZnLmFwcGVuZENoaWxkKGxpbmUyKTtcblxuXHRcdC8vIGNvbnN0IGxpbmUzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKFxuXHRcdC8vIFx0XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiLFxuXHRcdC8vIFx0XCJsaW5lXCJcblx0XHQvLyApO1xuXHRcdC8vIGxpbmUzLnNldEF0dHJpYnV0ZShcIngxXCIsIFwiM1wiKTtcblx0XHQvLyBsaW5lMy5zZXRBdHRyaWJ1dGUoXCJ5MVwiLCBgJHsoKGhlaWdodCAtIDMpIC8gMykgKiAzfWApO1xuXHRcdC8vIGxpbmUzLnNldEF0dHJpYnV0ZShcIngyXCIsIFwiMTBcIik7XG5cdFx0Ly8gbGluZTMuc2V0QXR0cmlidXRlKFwieTJcIiwgYCR7KChoZWlnaHQgLSAzKSAvIDMpICogM31gKTtcblx0XHQvLyBsaW5lMy5zZXRBdHRyaWJ1dGUoXCJzdHJva2Utd2lkdGhcIiwgXCIyXCIpOyAvLyBTZXQgdGhlIHN0cm9rZSB3ZWlnaHQgdG8gMVxuXHRcdC8vIGxpbmUzLnNldEF0dHJpYnV0ZShcInN0cm9rZVwiLCBcImdyZXlcIik7IC8vIFNldCB0aGUgc3Ryb2tlIGNvbG9yIHRvIGJsYWNrXG5cblx0XHQvLyBzdmcuYXBwZW5kQ2hpbGQobGluZTMpO1xuXG5cdFx0Ly8gc3Bhbi5hcHBlbmRDaGlsZChzdmcpO1xuXHRcdHJldHVybiB7IHNwYW46IHNwYW4sIHN2ZyB9O1xuXHR9XG5cblx0Y29uc3Qgc3ZnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiwgXCJzdmdcIik7XG5cdC8vIHN2Zy5zZXRBdHRyaWJ1dGUoXCJ3aWR0aFwiLCBgJHt3aWR0aH1gKTtcblx0Ly8gc3ZnLnNldEF0dHJpYnV0ZShcImhlaWdodFwiLCBgJHtoZWlnaHR9YCk7XG5cdC8vIHN2Zy5zZXRBdHRyaWJ1dGUoXCJ2aWV3Qm94XCIsIGAwIDAgJHt3aWR0aH0gJHtoZWlnaHR9YCk7XG5cdC8vIHN2Zy5zZXRBdHRyaWJ1dGUoXCJmaWxsXCIsIFwid2hpdGVcIik7XG5cdC8vIHN2Zy5zZXRBdHRyaWJ1dGUoXCJ4bWxuc1wiLCBcImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIpO1xuXHQvLyAvLyBzdmcuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCJ3aGl0ZVwiO1xuXHQvLyBzdmcuY2xhc3NMaXN0LmFkZChcInBvcnRhbC1pY29uXCIpO1xuXG5cdC8vIC8vIDxwYXRoIGQ9XCJNNCA2SDEzTTQgMTBIMTRNMy45OTY0MyAxLjAwMDM3QzcuMDg1MyAwLjk5OTkyMyAxMS4xNjE4IDAuOTk5ODgxIDE0LjAwNDMgMS4wMDAyNUMxNS42NjAzIDEuMDAwNDYgMTcgMi4zNDMxNSAxNyAzLjk5OTIzVjExLjM2MDFDMTcgMTIuOTk1MSAxNS42OTA5IDE0LjMyNzYgMTQuMDU2MyAxNC4zNTgyTDcuMzQzMDEgMTQuNDg0MkM2Ljc5MTY4IDE0LjQ5NDUgNi4yNTM4NyAxNC42NTY2IDUuNzg4NjYgMTQuOTUyN0wyLjUzNjg4IDE3LjAyMkMxLjg3MTE1IDE3LjQ0NTYgMSAxNi45Njc0IDEgMTYuMTc4M1YzLjk5OTkzQzEgMi4zNDM1MSAyLjM0MDAxIDEuMDAwNiAzLjk5NjQzIDEuMDAwMzdaXCIgc3Ryb2tlPVwiYmxhY2tcIiBzdHJva2Utd2lkdGg9XCIyXCIvPlxuXHQvLyBjb25zdCBwYXRoID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiwgXCJwYXRoXCIpO1xuXHQvLyBwYXRoLnNldEF0dHJpYnV0ZShcblx0Ly8gXHRcImRcIixcblx0Ly8gXHRcIk00IDZIMTNNNCAxMEgxNE0zLjk5NjQzIDEuMDAwMzdDNy4wODUzIDAuOTk5OTIzIDExLjE2MTggMC45OTk4ODEgMTQuMDA0MyAxLjAwMDI1QzE1LjY2MDMgMS4wMDA0NiAxNyAyLjM0MzE1IDE3IDMuOTk5MjNWMTEuMzYwMUMxNyAxMi45OTUxIDE1LjY5MDkgMTQuMzI3NiAxNC4wNTYzIDE0LjM1ODJMNy4zNDMwMSAxNC40ODQyQzYuNzkxNjggMTQuNDk0NSA2LjI1Mzg3IDE0LjY1NjYgNS43ODg2NiAxNC45NTI3TDIuNTM2ODggMTcuMDIyQzEuODcxMTUgMTcuNDQ1NiAxIDE2Ljk2NzQgMSAxNi4xNzgzVjMuOTk5OTNDMSAyLjM0MzUxIDIuMzQwMDEgMS4wMDA2IDMuOTk2NDMgMS4wMDAzN1pcIlxuXHQvLyApO1xuXHQvLyBwYXRoLnNldEF0dHJpYnV0ZShcInN0cm9rZVwiLCBcImdyYXlcIik7XG5cdC8vIHBhdGguc2V0QXR0cmlidXRlKFwic3Ryb2tlLXdpZHRoXCIsIFwiMlwiKTtcblxuXHQvLyBzcGFuLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiXCI7XG5cblx0Ly8gc3ZnLmFwcGVuZENoaWxkKHBhdGgpO1xuXG5cdC8vIHNwYW4uYXBwZW5kQ2hpbGQoc3ZnKTtcblxuXHRpZiAocG9ydGFsVGV4dCAhPSBcImlubGluZSByZWZlcmVuY2Ugd2lkZ2V0IHwqfFwiKSB7XG5cdFx0bGV0IHBvcnRhbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0Ly8gcG9ydGFsLnN0eWxlLmNvbG9yID0gXCJibGFja1wiO1xuXHRcdHBvcnRhbC5jbGFzc0xpc3QuYWRkKFwicG9ydGFsXCIpO1xuXG5cdFx0cG9ydGFsVGV4dC5zcGxpdChcIjpcIikuZm9yRWFjaCgodGV4dCwgaW5kZXgpID0+IHtcblx0XHRcdGlmIChpbmRleCA9PT0gMCB8fCBpbmRleCA9PT0gMilcblx0XHRcdFx0cG9ydGFsLmlubmVySFRNTCArPSBkZWNvZGVVUklDb21wb25lbnRTdHJpbmcodGV4dCk7XG5cdFx0XHRlbHNlIGlmIChpbmRleCA9PT0gMSkge1xuXHRcdFx0XHRwb3J0YWwuaW5uZXJIVE1MICs9IGA8c3BhbiBjbGFzcz1cInRleHQtYWNjZW50XCI7PiR7dGV4dH08L3NwYW4+YDtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdC8vIHNwYW4uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCJ3aGl0ZVwiO1xuXHRcdHBvcnRhbC5zdHlsZS51c2VyU2VsZWN0ID0gXCJub25lXCI7XG5cdFx0cG9ydGFsLnN0eWxlLnBvaW50ZXJFdmVudHMgPSBcIm5vbmVcIjtcblx0XHRzcGFuLmFwcGVuZENoaWxkKHBvcnRhbCk7XG5cdH1cblxuXHRyZXR1cm4geyBzcGFuOiBzcGFuLCBzdmcgfTtcblxuXHQvLyBsZXQgbmV3U3BhbjogSFRNTFNwYW5FbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XG5cdC8vIG5ld1NwYW4uaW5uZXJIVE1MID0gXCJcdUQ4M0RcdURDQzRcIjtcblx0Ly8gbmV3U3Bhbi5zdHlsZS5jdXJzb3IgPSBcInBvaW50ZXJcIjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZUhvdmVyZWRDdXJzb3JDb2xvcihzcGFuOiBIVE1MU3BhbkVsZW1lbnQsIHVzZXI6IHN0cmluZykge1xuXHQvLyByZW1vdmUgZXhpc3RpbmcgY3Vyc29yc1xuXHRjb25zdCBzdmcgPSBzcGFuLnF1ZXJ5U2VsZWN0b3IoXCJzdmdcIik7XG5cdGNvbnN0IHBvcnRhbDogSFRNTEVsZW1lbnQgfCBudWxsID0gc3Bhbi5xdWVyeVNlbGVjdG9yKFwiLnBvcnRhbFwiKTtcblxuXHRpZiAoc3BhbiAmJiBzdmcgJiYgIXBvcnRhbCkge1xuXHRcdGhhbmRsZVJlbW92ZUhvdmVyZWRDdXJzb3IodXNlcik7IC8vIHJlbW92ZSBhbnkgZXhpc3RpbmcgaG92ZXJlZCByZWZlcmVuY2UgaWNvblxuXHRcdGlmIChzdmcuY2xhc3NMaXN0LmNvbnRhaW5zKFwicmVmZXJlbmNlLWljb25cIikpXG5cdFx0XHRzdmcuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gU1ZHX0hPVkVSX0NPTE9SO1xuXHRcdGVsc2Uge1xuXHRcdFx0Ly8gc3ZnLnNldEF0dHJpYnV0ZShcImZpbGxcIiwgU1ZHX0hPVkVSX0NPTE9SKTtcblx0XHRcdHNwYW4gPSBzcGFuLnF1ZXJ5U2VsZWN0b3IoXCJzcGFuXCIpIGFzIEhUTUxTcGFuRWxlbWVudDtcblx0XHRcdHNwYW4uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gU1ZHX0hPVkVSX0NPTE9SO1xuXHRcdH1cblxuXHRcdHVwZGF0ZUhvdmVyZWRDdXJzb3Ioc3ZnLCB1c2VyKTsgLy8gYWRkIHRoZSBjdXJyZW50bHkgaG92ZXJlZCByZWZlcmVuY2UgaWNvblxuXHR9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDb2RlTWlycm9yRWRpdG9yVmlldyhlZGl0b3I6IEVkaXRvcik6IEVkaXRvclZpZXcge1xuXHQvLyBAdHMtaWdub3JlIHRoaXMgdHlwZSBpcyBtaXNzaW5nLi4uIGJ1dCB0aGUgT2JzaWRpYW4gZG9jcyB0ZWxsIHVzIHRvIGRvIGl0IHRoaXMgd2F5Pz9cblx0cmV0dXJuIGVkaXRvci5jbSBhcyBFZGl0b3JWaWV3O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q29udGFpbmVyRWxlbWVudChcblx0ZWRpdG9yT3JMZWFmOiBFZGl0b3IgfCBXb3Jrc3BhY2VMZWFmXG4pOiBIVE1MRWxlbWVudCB7XG5cdC8vIEB0cy1pZ25vcmUgVE9ETzogZmluZCBhIGJldHRlciB3YXkgdG8gYWNjZXNzIHRoaXMuLi4gRVhUUkVNRUxZIFNLRVRDSFlcblx0cmV0dXJuIGVkaXRvck9yTGVhZi5jb250YWluZXJFbDtcbn1cblxuZnVuY3Rpb24gZ2V0QmFja2xpbmtJRChiYWNrbGluazogQmFja2xpbmspOiBzdHJpbmcge1xuXHRjb25zdCBqc29uU3RyaW5nID0gSlNPTi5zdHJpbmdpZnkoYmFja2xpbmspO1xuXHRjb25zdCBpZCA9IHV1aWR2NShqc29uU3RyaW5nLCBcImZiODEzZWJiLTFiNTMtNDMwNi1hYTljLTY1NTYyNzQ0N2YwYlwiKTtcblx0cmV0dXJuIGBiYWNrbGluay0ke2lkfWA7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRCYWNrbGlua0NvbnRhaW5lcihlZGl0b3I6IEVkaXRvcik6IEhUTUxFbGVtZW50IHtcblx0Y29uc3QgY29udGFpbmVyRWw6IEhUTUxFbGVtZW50ID0gZ2V0Q29udGFpbmVyRWxlbWVudChlZGl0b3IpO1xuXHRjb25zdCByZWZlcmVuY2VNYXJrQ29udGFpbmVySUQgPSBcInJlZmVyZW5jZU1hcmtDb250YWluZXJcIjtcblx0Y29uc3QgY29udGFpbmVyID0gY29udGFpbmVyRWwucXVlcnlTZWxlY3RvcihgIyR7cmVmZXJlbmNlTWFya0NvbnRhaW5lcklEfWApO1xuXHRpZiAoY29udGFpbmVyKSB7XG5cdFx0cmV0dXJuIGNvbnRhaW5lciBhcyBIVE1MRWxlbWVudDtcblx0fSBlbHNlIHtcblx0XHRjb25zdCBuZXdDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXHRcdG5ld0NvbnRhaW5lci5pZCA9IHJlZmVyZW5jZU1hcmtDb250YWluZXJJRDtcblx0XHRjb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKFwiLmNtLXNjcm9sbGVyXCIpIS5hcHBlbmRDaGlsZChuZXdDb250YWluZXIpO1xuXHRcdHJldHVybiBuZXdDb250YWluZXI7XG5cdH1cbn1cblxuZnVuY3Rpb24gZ2V0UmVmZXJlbmNlTWFya3MoZWRpdG9yOiBFZGl0b3IpOiBIVE1MRWxlbWVudFtdIHtcblx0Y29uc3QgY29udGFpbmVyID0gZ2V0QmFja2xpbmtDb250YWluZXIoZWRpdG9yKTtcblx0Y29uc3QgZWxlbWVudHM6IEhUTUxFbGVtZW50W10gPSBbXTtcblx0Zm9yIChsZXQgaSA9IDA7IGkgPCBjb250YWluZXIuY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcblx0XHRlbGVtZW50cy5wdXNoKGNvbnRhaW5lci5jaGlsZHJlbi5pdGVtKGkpIGFzIEhUTUxFbGVtZW50KTtcblx0fVxuXHRyZXR1cm4gZWxlbWVudHM7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRMZWFmQkJveEVsZW1lbnRzKGxlYWY6IFdvcmtzcGFjZUxlYWYpIHtcblx0Y29uc3QgdGl0bGUgPSBnZXRDb250YWluZXJFbGVtZW50KGxlYWYpLnF1ZXJ5U2VsZWN0b3IoXCIuaW5saW5lLXRpdGxlXCIpO1xuXHRpZiAoIXRpdGxlKSB7XG5cdFx0dGhyb3cgbmV3IEVycm9yKFwiTWlzc2luZyB0aXRsZVwiKTtcblx0fVxuXHRjb25zdCB0aXRsZUJib3ggPSB0aXRsZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblx0Y29uc3QgbGluZSA9IGdldENvbnRhaW5lckVsZW1lbnQobGVhZikucXVlcnlTZWxlY3RvcihcIi5jbS1saW5lXCIpO1xuXHRpZiAoIWxpbmUpIHtcblx0XHR0aHJvdyBuZXcgRXJyb3IoXCJEb2N1bWVudCBoYXMgbm8gbGluZXNcIik7XG5cdH1cblx0Y29uc3QgbGluZUJib3ggPSBsaW5lLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXG5cdHJldHVybiB7IHRpdGxlQmJveCwgbGluZUJib3ggfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZUJhY2tsaW5rTWFya1Bvc2l0aW9uKFxuXHRsZWFmOiBXb3Jrc3BhY2VMZWFmLFxuXHRiYWNrbGlua3NUb0xlYWY6IEJhY2tsaW5rW10sXG5cdHNob3dQb3J0YWxzOiBib29sZWFuXG4pIHtcblx0Y29uc3QgZWRpdG9yID0gZ2V0TWFya2Rvd25WaWV3KGxlYWYpLmVkaXRvcjtcblx0Y29uc3QgYmFja2xpbmtDb250YWluZXIgPSBnZXRCYWNrbGlua0NvbnRhaW5lcihlZGl0b3IpO1xuXG5cdGxldCBiYWNrbGlua3MgPSBbXTtcblx0Zm9yIChsZXQgaSA9IDA7IGkgPCBiYWNrbGlua0NvbnRhaW5lci5jaGlsZHJlbi5sZW5ndGg7IGkrKykge1xuXHRcdGJhY2tsaW5rcy5wdXNoKGJhY2tsaW5rQ29udGFpbmVyLmNoaWxkcmVuLml0ZW0oaSkgYXMgSFRNTEVsZW1lbnQpO1xuXHR9XG5cdGxldCBiYWNrbGlua0lkczogc3RyaW5nW10gPSBiYWNrbGlua3NUb0xlYWYubWFwKCh4KSA9PiBnZXRCYWNrbGlua0lEKHgpKTtcblxuXHRiYWNrbGlua3Ncblx0XHQubWFwKCh4OiBIVE1MU3BhbkVsZW1lbnQpID0+IHguaWQpXG5cdFx0LmZvckVhY2goKGlkKSA9PiB7XG5cdFx0XHRpZiAoIWJhY2tsaW5rSWRzLmluY2x1ZGVzKGlkKSkge1xuXHRcdFx0XHRsZXQgZWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTtcblx0XHRcdFx0aWYgKGVsZW1lbnQpIGVsZW1lbnQucmVtb3ZlKCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0Y29uc3QgeyB0aXRsZUJib3gsIGxpbmVCYm94IH0gPSBnZXRMZWFmQkJveEVsZW1lbnRzKGxlYWYpO1xuXG5cdC8vIENyZWF0ZSB0aGUgaW5pdGlhbCBiYWNrbGluayBtYXJrIGlmIG5lY2Vzc2FyeSBhbmQgcG9zaXRpb24gaXQgaW4gdGhlIGNvcnJlY3QgdmVydGljYWwgcG9zaXRpb25cblx0bGV0IHJlZmVyZW5jZU1hcmtlcnMgPSBiYWNrbGlua3NUb0xlYWYubWFwKChiYWNrbGluaykgPT4ge1xuXHRcdGNvbnN0IHsgZnJvbSB9ID0gYmFja2xpbmsucmVmZXJlbmNlZExvY2F0aW9uO1xuXG5cdFx0Y29uc3QgYmJveCA9IGdldENvZGVNaXJyb3JFZGl0b3JWaWV3KGVkaXRvcikuY29vcmRzQXRQb3MoZnJvbSk7XG5cdFx0aWYgKCFiYm94KSByZXR1cm47XG5cblx0XHRsZXQgcmVmZXJlbmNlTWFya2VyID0gYmFja2xpbmtDb250YWluZXIucXVlcnlTZWxlY3Rvcihcblx0XHRcdGAjJHtnZXRCYWNrbGlua0lEKGJhY2tsaW5rKX1gXG5cdFx0KSBhcyBIVE1MRWxlbWVudCB8IG51bGw7XG5cblx0XHRpZiAocmVmZXJlbmNlTWFya2VyID09PSBudWxsKSB7XG5cdFx0XHRyZWZlcmVuY2VNYXJrZXIgPSBjcmVhdGVCYWNrbGlua01hcmsoYmFja2xpbmspO1xuXHRcdFx0YmFja2xpbmtDb250YWluZXIuYXBwZW5kQ2hpbGQocmVmZXJlbmNlTWFya2VyKTtcblx0XHR9XG5cblx0XHRpZiAoYmJveCkge1xuXHRcdFx0cmVmZXJlbmNlTWFya2VyLnN0eWxlLnBvc2l0aW9uID0gXCJhYnNvbHV0ZVwiO1xuXG5cdFx0XHRyZWZlcmVuY2VNYXJrZXIuc2V0QXR0cmlidXRlKFwidG9wXCIsIGJib3gudG9wLnRvU3RyaW5nKCkpO1xuXHRcdFx0cmVmZXJlbmNlTWFya2VyLnN0eWxlLnRvcCA9IGJib3gudG9wIC0gdGl0bGVCYm94LnRvcCArIDMyICsgXCJweFwiO1xuXHRcdFx0cmVmZXJlbmNlTWFya2VyLnN0eWxlLmxlZnQgPSBsaW5lQmJveC53aWR0aCArIDQwICsgXCJweFwiO1xuXHRcdH1cblxuXHRcdHJldHVybiByZWZlcmVuY2VNYXJrZXI7XG5cdH0pO1xuXG5cdC8vIE5vdyBhY2NvdW50IGZvciBwb3NzaWJsZSBwb3NpdGlvbiBvdmVybGFwcyBhbmQgc2hpZnQgZG93bndhcmRzXG5cdC8vIGFsc28gY29uc2lkZXIgd2hldGhlciB0aGUgcG9ydGFscyBzaG91bGQgYmUgc2hvd24gb3Igbm90LlxuXHRsZXQgbGFzdFlCb3R0b20gPSAtSW5maW5pdHk7IC8vIGZvciBsYXJnZSBkb2N1bWVudHMgXHVEODNEXHVERTAxXG5cdGxldCBtYXJnaW4gPSA0O1xuXHRyZWZlcmVuY2VNYXJrZXJzXG5cdFx0LnNvcnQoXG5cdFx0XHQoYSwgYikgPT5cblx0XHRcdFx0cGFyc2VJbnQoYSEuZ2V0QXR0cmlidXRlKFwidG9wXCIpISkgLSBwYXJzZUludChiIS5nZXRBdHRyaWJ1dGUoXCJ0b3BcIikhKVxuXHRcdClcblx0XHQuZm9yRWFjaCgobWFya2VyKSA9PiB7XG5cdFx0XHRpZiAoIW1hcmtlcikgcmV0dXJuO1xuXHRcdFx0Ly8gdG9nZ2xlIHBvcnRhbHNcblx0XHRcdGNvbnN0IHBvcnRhbDogSFRNTEVsZW1lbnQgfCBudWxsID0gbWFya2VyLnF1ZXJ5U2VsZWN0b3IoXCIucG9ydGFsXCIpO1xuXG5cdFx0XHRpZiAoc2hvd1BvcnRhbHMpIHtcblx0XHRcdFx0Ly8gaWYgKHN2ZyAmJiAhcG9ydGFsKSBzdmcuc3R5bGUuZGlzcGxheSA9IFwiaW5saW5lXCI7XG5cdFx0XHRcdC8vIGVsc2UgaWYgKHN2Zykgc3ZnLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcblxuXHRcdFx0XHRpZiAocG9ydGFsKSB7XG5cdFx0XHRcdFx0cG9ydGFsLnN0eWxlLmRpc3BsYXkgPSBcImlubGluZVwiO1xuXHRcdFx0XHRcdG1hcmtlci5jbGFzc0xpc3QuYWRkKFwiYmFja2xpbmstc3BhblwiKTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gaWYgKHN2Zykgc3ZnLnN0eWxlLmRpc3BsYXkgPSBcImlubGluZVwiO1xuXHRcdFx0XHRpZiAocG9ydGFsKSB7XG5cdFx0XHRcdFx0cG9ydGFsLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcblx0XHRcdFx0fVxuXHRcdFx0XHRtYXJrZXIuY2xhc3NMaXN0LnJlbW92ZShcImJhY2tsaW5rLXNwYW5cIik7XG5cdFx0XHR9XG5cdFx0XHQvLyBnZXQgcG9zaXRpb25pbmdcblx0XHRcdGxldCB0b3AgPSBwYXJzZUludChtYXJrZXIhLmdldEF0dHJpYnV0ZShcInRvcFwiKSEpO1xuXHRcdFx0dG9wID0gTWF0aC5tYXgodG9wLCBsYXN0WUJvdHRvbSArIG1hcmdpbik7XG5cdFx0XHRsYXN0WUJvdHRvbSA9IHRvcCArIG1hcmtlci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHQgKyBtYXJnaW47XG5cdFx0XHRtYXJrZXIuc2V0QXR0cmlidXRlKFwidG9wXCIsIHRvcC50b1N0cmluZygpKTtcblx0XHRcdG1hcmtlci5zdHlsZS50b3AgPSB0b3AgLSB0aXRsZUJib3gudG9wICsgMzIgKyBcInB4XCI7XG5cdFx0XHRtYXJrZXIuc3R5bGUubGVmdCA9IGxpbmVCYm94LndpZHRoICsgNDAgKyBcInB4XCI7XG5cdFx0fSk7XG59XG5cbmxldCBkZWJvdW5jZVRpbWVyOiBOb2RlSlMuVGltZW91dDtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUJhY2tsaW5rTWFya1Bvc2l0aW9ucygpIHtcblx0Y2xlYXJUaW1lb3V0KGRlYm91bmNlVGltZXIpO1xuXHRkZWJvdW5jZVRpbWVyID0gc2V0VGltZW91dChhc3luYyAoKSA9PiB7XG5cdFx0Y29uc3QgbGVhdmVzID0gZ2V0VGhhdCgpLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoXG5cdFx0XHRcIm1hcmtkb3duXCJcblx0XHQpIGFzIFdvcmtzcGFjZUxlYWZbXTtcblxuXHRcdHNldFRpbWVvdXQoYXN5bmMgKCkgPT4ge1xuXHRcdFx0Y29uc3QgYWxsQmFja2xpbmtzOiBCYWNrbGlua1tdID0gYXdhaXQgcmVjb21wdXRlUmVmZXJlbmNlc0ZvclBhZ2UoKTtcblxuXHRcdFx0bGVhdmVzLm1hcChhc3luYyAobGVhZikgPT4ge1xuXHRcdFx0XHRjb25zdCBiYWNrbGlua3NUb0xlYWYgPSBhbGxCYWNrbGlua3MuZmlsdGVyKFxuXHRcdFx0XHRcdC8vIEB0cy1pZ25vcmVcblx0XHRcdFx0XHQoYikgPT4gYi5yZWZlcmVuY2VkTG9jYXRpb24uZmlsZW5hbWUgPT0gbGVhZi52aWV3LmZpbGUucGF0aFxuXHRcdFx0XHQpO1xuXHRcdFx0XHQvLyB3aWR0aCA5MDAsIHNob3cgdGhlIHJlZmVyZW5jZVxuXHRcdFx0XHRjb25zdCBzaG93UG9ydGFscyA9IGdldENvbnRhaW5lckVsZW1lbnQobGVhZikuaW5uZXJXaWR0aCA+IDkwMDtcblx0XHRcdFx0dXBkYXRlQmFja2xpbmtNYXJrUG9zaXRpb24obGVhZiwgYmFja2xpbmtzVG9MZWFmLCBzaG93UG9ydGFscyk7XG5cdFx0XHR9KTtcblx0XHRcdGF3YWl0IFByb21pc2UuYWxsKFxuXHRcdFx0XHRsZWF2ZXMubWFwKGFzeW5jIChsZWFmKSA9PiB7XG5cdFx0XHRcdFx0Y29uc3QgYmFja2xpbmtzVG9MZWFmID0gYWxsQmFja2xpbmtzLmZpbHRlcihcblx0XHRcdFx0XHRcdC8vIEB0cy1pZ25vcmVcblx0XHRcdFx0XHRcdChiKSA9PiBiLnJlZmVyZW5jZWRMb2NhdGlvbi5maWxlbmFtZSA9PSBsZWFmLnZpZXcuZmlsZS5wYXRoXG5cdFx0XHRcdFx0KTtcblx0XHRcdFx0XHQvLyB3aWR0aCA5MDAsIHNob3cgdGhlIHJlZmVyZW5jZVxuXHRcdFx0XHRcdGNvbnN0IHNob3dQb3J0YWxzID0gZ2V0Q29udGFpbmVyRWxlbWVudChsZWFmKS5pbm5lcldpZHRoID4gOTAwO1xuXHRcdFx0XHRcdHVwZGF0ZUJhY2tsaW5rTWFya1Bvc2l0aW9uKGxlYWYsIGJhY2tsaW5rc1RvTGVhZiwgc2hvd1BvcnRhbHMpO1xuXHRcdFx0XHR9KVxuXHRcdFx0KTtcblx0XHR9LCA1MDApO1xuXHR9LCAxMDApO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlQmFja2xpbmtNYXJrKGJhY2tsaW5rOiBCYWNrbGluayk6IEhUTUxFbGVtZW50IHtcblx0bGV0IHsgc3Bhbiwgc3ZnIH0gPSBjcmVhdGVSZWZlcmVuY2VJY29uKGJhY2tsaW5rLnBvcnRhbFRleHQpO1xuXHRzcGFuLmNsYXNzTGlzdC5hZGQoXCJiYWNrbGluay1kYXRhLXNwYW5cIik7XG5cblx0Y29uc3QgcG9ydGFsOiBIVE1MRWxlbWVudCB8IG51bGwgPSBzcGFuLnF1ZXJ5U2VsZWN0b3IoXCIucG9ydGFsXCIpO1xuXG5cdHNwYW4uc3R5bGUucG9zaXRpb24gPSBcImFic29sdXRlXCI7XG5cblx0c3Bhbi5pZCA9IGdldEJhY2tsaW5rSUQoYmFja2xpbmspO1xuXHRzcGFuLnNldEF0dHJpYnV0ZShcInJlZmVyZW5jZVwiLCBKU09OLnN0cmluZ2lmeShiYWNrbGluaykpO1xuXG5cdGNvbnN0IHJlc2l6ZU9ic2VydmVyID0gbmV3IFJlc2l6ZU9ic2VydmVyKChlbnRyaWVzKSA9PiB7XG5cdFx0aWYgKHBvcnRhbCAmJiBwb3J0YWwuc3R5bGUuZGlzcGxheSAhPSBcIm5vbmVcIikge1xuXHRcdFx0Ly8gc3Bhbi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIndoaXRlXCI7XG5cdFx0XHRzcGFuLmNsYXNzTGlzdC5hZGQoXCJiYWNrbGluay1wb3J0YWwtb3BlblwiKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gc3Bhbi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIlwiO1xuXHRcdFx0c3Bhbi5jbGFzc0xpc3QucmVtb3ZlKFwiYmFja2xpbmstcG9ydGFsLW9wZW5cIik7XG5cdFx0fVxuXHR9KTtcblxuXHQvLyBTdGFydCBvYnNlcnZpbmcgYW4gZWxlbWVudFxuXHRyZXNpemVPYnNlcnZlci5vYnNlcnZlKHNwYW4pO1xuXG5cdHNwYW4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9wZW5CYWNrbGlua1JlZmVyZW5jZSk7XG5cblx0cmV0dXJuIHNwYW47XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhZGRSZWZlcmVuY2VzVG9MZWFmKGxlYWY6IFdvcmtzcGFjZUxlYWYpIHtcblx0Y29uc3QgbWFya2Rvd25WaWV3ID0gZ2V0TWFya2Rvd25WaWV3KGxlYWYpO1xuXHRsZXQgd29ya3NwYWNlVGFicyA9IG1hcmtkb3duVmlldy5jb250YWluZXJFbC5jbG9zZXN0KFwiLndvcmtzcGFjZS10YWJzXCIpO1xuXHRpZiAoIXdvcmtzcGFjZVRhYnMpIHtcblx0XHR0aHJvdyBuZXcgRXJyb3IoXCJNaXNzaW5nIHdvcmtzcGFjZSB0YWJzXCIpO1xuXHR9XG5cblx0YXdhaXQgdXBkYXRlQmFja2xpbmtNYXJrUG9zaXRpb25zKCk7XG5cdGF3YWl0IGRlbGF5KDIwMDApO1xuXHRnZW5lcmF0ZURlZmF1bHRIaWdobGlnaHRzKGxlYWYpO1xuXG5cdGdldENvbnRhaW5lckVsZW1lbnQobWFya2Rvd25WaWV3LmVkaXRvcilcblx0XHQucXVlcnlTZWxlY3RvcihcIi5jbS1zY3JvbGxlclwiKSFcblx0XHQuYWRkRXZlbnRMaXN0ZW5lcihcInNjcm9sbFwiLCBhc3luYyAoKSA9PiB7XG5cdFx0XHRhd2FpdCB1cGRhdGVCYWNrbGlua01hcmtQb3NpdGlvbnMoKTtcblx0XHRcdGF3YWl0IGRlbGF5KDIwMDApO1xuXHRcdFx0Z2VuZXJhdGVEZWZhdWx0SGlnaGxpZ2h0cyhsZWFmKTtcblx0XHR9KTtcblxuXHRsZXQgcmVzaXplT2JzZXJ2ZXIgPSBuZXcgUmVzaXplT2JzZXJ2ZXIoYXN5bmMgKCkgPT4ge1xuXHRcdGF3YWl0IHVwZGF0ZUJhY2tsaW5rTWFya1Bvc2l0aW9ucygpO1xuXHRcdGF3YWl0IGRlbGF5KDIwMDApO1xuXHRcdGdlbmVyYXRlRGVmYXVsdEhpZ2hsaWdodHMobGVhZik7XG5cdH0pO1xuXG5cdHJlc2l6ZU9ic2VydmVyLm9ic2VydmUod29ya3NwYWNlVGFicyk7XG5cblx0cmV0dXJuIGxlYWY7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRNYXJrZG93blZpZXcobGVhZjogV29ya3NwYWNlTGVhZik6IE1hcmtkb3duVmlldyB7XG5cdGlmICghKGxlYWYudmlldyBpbnN0YW5jZW9mIE1hcmtkb3duVmlldykpIHtcblx0XHR0aHJvdyBuZXcgRXJyb3IoXCJVbmV4cGVjdGVkIG5vbi1tYXJrZG93biB2aWV3XCIpO1xuXHR9XG5cdHJldHVybiBsZWFmLnZpZXcgYXMgTWFya2Rvd25WaWV3O1xufVxuXG5mdW5jdGlvbiBnZXRGaWxlbmFtZShsZWFmOiBXb3Jrc3BhY2VMZWFmKTogc3RyaW5nIHtcblx0Y29uc3QgeyBmaWxlIH0gPSBnZXRNYXJrZG93blZpZXcobGVhZik7XG5cdGlmICghZmlsZSkge1xuXHRcdHRocm93IG5ldyBFcnJvcihcIlVuZXhwZWN0ZWQgbWlzc2luZyBmaWxlXCIpO1xuXHR9XG5cdHJldHVybiBmaWxlLm5hbWU7XG59XG5cbmZ1bmN0aW9uIGZpbmRNYXRjaFBvc2l0aW9ucyhsaW5lOiBzdHJpbmcsIHJlZ2V4OiBSZWdFeHApIHtcblx0bGV0IG1hdGNoO1xuXHRjb25zdCBwb3NpdGlvbnMgPSBbXTtcblx0d2hpbGUgKChtYXRjaCA9IHJlZ2V4LmV4ZWMobGluZSkpICE9PSBudWxsKSB7XG5cdFx0cG9zaXRpb25zLnB1c2goe1xuXHRcdFx0bWF0Y2g6IG1hdGNoWzBdLFxuXHRcdFx0c3RhcnQ6IG1hdGNoLmluZGV4LFxuXHRcdFx0ZW5kOiBtYXRjaC5pbmRleCArIG1hdGNoWzBdLmxlbmd0aCxcblx0XHR9KTtcblx0fVxuXHRyZXR1cm4gcG9zaXRpb25zO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVCYWNrbGlua0RhdGEoXG5cdHJlZmVyZW5jaW5nRmlsZURhdGE6IHN0cmluZyxcblx0cmVmZXJlbmNpbmdGaWxlOiBURmlsZVxuKTogQmFja2xpbmtbXSB7XG5cdGxldCBiYWNrbGlua3M6IEJhY2tsaW5rW10gPSBbXTtcblxuXHRsZXQgbWF0Y2hlcyA9IFsuLi5yZWZlcmVuY2luZ0ZpbGVEYXRhLm1hdGNoQWxsKFJFRkVSRU5DRV9SRUdFWCldO1xuXHRtYXRjaGVzLmZvckVhY2goKG1hdGNoKSA9PiB7XG5cdFx0aWYgKG1hdGNoWzFdLnNwbGl0KFwiOlwiKS5sZW5ndGggIT0gOCkgcmV0dXJuO1xuXHRcdGxldCBbcHJlZml4LCB0ZXh0LCBzdWZmaXgsIGZpbGVuYW1lLCBmcm9tLCB0bywgcG9ydGFsLCB0b2dnbGVdID0gcHJvY2Vzc1VSSShcblx0XHRcdG1hdGNoWzFdXG5cdFx0KTtcblx0XHRjb25zdCByZWZlcmVuY2VkTG9jYXRpb246IERvY3VtZW50TG9jYXRpb24gPSB7XG5cdFx0XHRwcmVmaXgsXG5cdFx0XHR0ZXh0LFxuXHRcdFx0c3VmZml4LFxuXHRcdFx0ZmlsZW5hbWUsXG5cdFx0XHRmcm9tLFxuXHRcdFx0dG8sXG5cdFx0XHRwb3J0YWwsXG5cdFx0XHR0b2dnbGUsXG5cdFx0fTtcblxuXHRcdGxldCBpbmRleCA9IHJlZmVyZW5jaW5nRmlsZURhdGEuaW5kZXhPZihtYXRjaFswXSk7XG5cblx0XHRjb25zdCByZWZlcmVuY2luZ1N1cnJvdW5kaW5nU3RyaW5ncyA9IGdldFByZWZpeEFuZFN1ZmZpeChcblx0XHRcdHJlZmVyZW5jaW5nRmlsZURhdGEsXG5cdFx0XHRpbmRleCxcblx0XHRcdGluZGV4ICsgbWF0Y2hbMF0ubGVuZ3RoXG5cdFx0KTtcblxuXHRcdGNvbnN0IHJlZmVyZW5jaW5nTG9jYXRpb246IERvY3VtZW50TG9jYXRpb24gPSB7XG5cdFx0XHQvLyBwcmVmaXg6IHJlZmVyZW5jaW5nRmlsZURhdGEuc2xpY2UoaW5kZXggLSAyNSwgaW5kZXgpLFxuXHRcdFx0cHJlZml4OiByZWZlcmVuY2luZ1N1cnJvdW5kaW5nU3RyaW5ncy5wcmVmaXgsXG5cdFx0XHR0ZXh0OiByZWZlcmVuY2luZ0ZpbGVEYXRhLnNsaWNlKGluZGV4LCBpbmRleCArIG1hdGNoWzBdLmxlbmd0aCksXG5cdFx0XHQvLyBzdWZmaXg6IHJlZmVyZW5jaW5nRmlsZURhdGEuc2xpY2UoXG5cdFx0XHQvLyBcdGluZGV4ICsgbWF0Y2hbMF0ubGVuZ3RoLFxuXHRcdFx0Ly8gXHRpbmRleCArIG1hdGNoWzBdLmxlbmd0aCArIDI1XG5cdFx0XHQvLyApLFxuXHRcdFx0c3VmZml4OiByZWZlcmVuY2luZ1N1cnJvdW5kaW5nU3RyaW5ncy5zdWZmaXgsXG5cdFx0XHRmaWxlbmFtZTogcmVmZXJlbmNpbmdGaWxlLnBhdGgsXG5cdFx0XHRmcm9tOiBtYXRjaC5pbmRleCEsIC8vIFRPRE8gZG8gd2VpcmQgc3RyaW5nIGZvcm1hdFxuXHRcdFx0dG86IG1hdGNoLmluZGV4ISArIG1hdGNoWzBdLmxlbmd0aCwgLy8gVE9ETyBkbyB3ZWlyZCBzdHJpbmcgZm9ybWF0XG5cdFx0XHRwb3J0YWwsXG5cdFx0XHR0b2dnbGUsXG5cdFx0fTtcblxuXHRcdGlmIChwb3J0YWwgPT0gXCJwb3J0YWxcIikge1xuXHRcdFx0Ly8gT1Igbm8tcG9ydGFsXG5cblx0XHRcdC8vIGdldCBhbGwgdGhlIHRleHQgZnJvbSB0aGUgc3RhcnQgb2YgdGhlIGxpbmUgdG8gdGhlIGVuZCBvZiB0aGUgbGluZVxuXHRcdFx0Y29uc3QgZ2V0TGluZVRleHQgPSAodGV4dDogc3RyaW5nLCBpbmRleDogbnVtYmVyKTogc3RyaW5nID0+IHtcblx0XHRcdFx0Y29uc3Qgc3RhcnRPZkxpbmUgPSB0ZXh0Lmxhc3RJbmRleE9mKFwiXFxuXCIsIGluZGV4IC0gMSkgKyAxO1xuXHRcdFx0XHRjb25zdCBlbmRPZkxpbmUgPSB0ZXh0LmluZGV4T2YoXCJcXG5cIiwgaW5kZXgpO1xuXHRcdFx0XHRyZXR1cm4gdGV4dC5zbGljZShcblx0XHRcdFx0XHRzdGFydE9mTGluZSxcblx0XHRcdFx0XHRlbmRPZkxpbmUgIT09IC0xID8gZW5kT2ZMaW5lIDogdW5kZWZpbmVkXG5cdFx0XHRcdCk7XG5cdFx0XHR9O1xuXG5cdFx0XHRsZXQgbGluZSA9IGdldExpbmVUZXh0KHJlZmVyZW5jaW5nRmlsZURhdGEsIGluZGV4KTtcblx0XHRcdGxldCBtYXRjaFBvc2l0aW9ucyA9IGZpbmRNYXRjaFBvc2l0aW9ucyhcblx0XHRcdFx0bGluZSxcblx0XHRcdFx0bmV3IFJlZ0V4cChSRUZFUkVOQ0VfUkVHRVgpXG5cdFx0XHQpO1xuXG5cdFx0XHRsZXQgbWF0Y2hJbmRleCA9IDA7XG5cdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IG1hdGNoUG9zaXRpb25zLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdGlmIChtYXRjaFBvc2l0aW9uc1tpXS5tYXRjaCA9PSBtYXRjaFswXSkge1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdG1hdGNoSW5kZXggKz0gbWF0Y2hQb3NpdGlvbnNbaV0uZW5kIC0gbWF0Y2hQb3NpdGlvbnNbaV0uc3RhcnQgLSAxOyAvLyAtMSBiZWNhdXNlIHRoZSBsaW5lIGlzIHJlcGxhY2VkIGJ5IGEgc2luZ2xlIGNoYXJhY3RlclxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdGxldCBwb3J0YWxUZXh0ID0gbGluZS5yZXBsYWNlKG5ldyBSZWdFeHAoUkVGRVJFTkNFX1JFR0VYLCBcImdcIiksIFwiXHUyMTk3XCIpO1xuXHRcdFx0bGV0IHBvcnRhbFRleHRTbGljZSA9IHBvcnRhbFRleHQuc2xpY2UoMCwgUE9SVEFMX1RFWFRfU0xJQ0VfU0laRSk7XG5cblx0XHRcdGxldCBwb3J0YWxUZXh0SW5kZXggPSBsaW5lLmluZGV4T2YobWF0Y2hbMF0pIC0gbWF0Y2hJbmRleDtcblxuXHRcdFx0Ly8gZ2V0dGluZyB0aGUgcG9ydGFsIHRleHQgc2VsZWN0aW9uIGFyb3VuZCB0aGUgcmVmZXJlbmNlXG5cdFx0XHRwb3J0YWxUZXh0U2xpY2UgPSBcIlx1MjE5N1wiO1xuXG5cdFx0XHRsZXQgc3RhcnRQb3J0YWxUZXh0ID0gcG9ydGFsVGV4dC5zdWJzdHJpbmcoXG5cdFx0XHRcdE1hdGgubWF4KHBvcnRhbFRleHRJbmRleCAtIDI1LCAwKSxcblx0XHRcdFx0cG9ydGFsVGV4dEluZGV4XG5cdFx0XHQpO1xuXHRcdFx0aWYgKFxuXHRcdFx0XHRwb3J0YWxUZXh0LnN1YnN0cmluZyhNYXRoLm1heChwb3J0YWxUZXh0SW5kZXggLSAyNSwgMCksIHBvcnRhbFRleHRJbmRleClcblx0XHRcdFx0XHQubGVuZ3RoID4gMCAmJlxuXHRcdFx0XHRwb3J0YWxUZXh0SW5kZXggLSAyNSA+IDBcblx0XHRcdClcblx0XHRcdFx0c3RhcnRQb3J0YWxUZXh0ID0gXCIuLi5cIiArIHN0YXJ0UG9ydGFsVGV4dDtcblxuXHRcdFx0bGV0IGVuZFBvcnRhbFRleHQgPSBwb3J0YWxUZXh0LnN1YnN0cmluZyhcblx0XHRcdFx0cG9ydGFsVGV4dEluZGV4ICsgMSxcblx0XHRcdFx0TWF0aC5tYXgocG9ydGFsVGV4dEluZGV4ICsgMjUsIHBvcnRhbFRleHQubGVuZ3RoKVxuXHRcdFx0KTtcblx0XHRcdGlmIChcblx0XHRcdFx0cG9ydGFsVGV4dC5zdWJzdHJpbmcoXG5cdFx0XHRcdFx0cG9ydGFsVGV4dEluZGV4ICsgMSxcblx0XHRcdFx0XHRNYXRoLm1heChwb3J0YWxUZXh0SW5kZXggKyAyNSwgcG9ydGFsVGV4dC5sZW5ndGgpXG5cdFx0XHRcdCkubGVuZ3RoID4gMCAmJlxuXHRcdFx0XHRwb3J0YWxUZXh0SW5kZXggKyAyNSA8IHBvcnRhbFRleHQubGVuZ3RoXG5cdFx0XHQpXG5cdFx0XHRcdGVuZFBvcnRhbFRleHQgPSBlbmRQb3J0YWxUZXh0ICsgXCIuLi5cIjtcblxuXHRcdFx0YmFja2xpbmtzLnB1c2goe1xuXHRcdFx0XHRyZWZlcmVuY2VkTG9jYXRpb24sXG5cdFx0XHRcdHJlZmVyZW5jaW5nTG9jYXRpb24sXG5cdFx0XHRcdGRhdGFTdHJpbmc6IG1hdGNoWzFdLFxuXHRcdFx0XHRwb3J0YWxUZXh0OlxuXHRcdFx0XHRcdGVuY29kZVVSSUNvbXBvbmVudFN0cmluZyhzdGFydFBvcnRhbFRleHQpICtcblx0XHRcdFx0XHRcIjpcIiArXG5cdFx0XHRcdFx0cG9ydGFsVGV4dFNsaWNlICtcblx0XHRcdFx0XHRcIjpcIiArXG5cdFx0XHRcdFx0ZW5jb2RlVVJJQ29tcG9uZW50U3RyaW5nKGVuZFBvcnRhbFRleHQpLFxuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGJhY2tsaW5rcy5wdXNoKHtcblx0XHRcdFx0cmVmZXJlbmNlZExvY2F0aW9uLFxuXHRcdFx0XHRyZWZlcmVuY2luZ0xvY2F0aW9uLFxuXHRcdFx0XHRkYXRhU3RyaW5nOiBtYXRjaFsxXSxcblx0XHRcdH0pO1xuXHRcdH1cblx0fSk7XG5cdHJldHVybiBiYWNrbGlua3M7XG59XG5cbi8vIGxldCBkZWJvdW5jZVRpbWVyOiBOb2RlSlMuVGltZW91dDtcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZW5lcmF0ZUJhY2tsaW5rcygpIHtcblx0Ly8gY2xlYXJUaW1lb3V0KGRlYm91bmNlVGltZXIpO1xuXHQvLyBkZWJvdW5jZVRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7XG5cdGNvbnNvbGUubG9nKFwiZ2VuZXJhdGluZyByZWZlcmVuY2VzXCIpO1xuXHRsZXQgYmFja2xpbmtzOiBCYWNrbGlua1tdID0gW107XG5cdGxldCBtYXJrZG93bkZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xuXG5cdGF3YWl0IFByb21pc2UuYWxsKFxuXHRcdG1hcmtkb3duRmlsZXMubWFwKChmaWxlOiBURmlsZSkgPT4gdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKSlcblx0KS50aGVuKChmaWxlcykgPT4ge1xuXHRcdGNvbnN0IHppcHBlZEFycmF5ID0gbWFya2Rvd25GaWxlcy5tYXAoKGZpbGU6IFRGaWxlLCBpbmRleDogbnVtYmVyKSA9PiAoe1xuXHRcdFx0bWFya2Rvd25GaWxlOiBmaWxlLFxuXHRcdFx0ZmlsZURhdGE6IGZpbGVzW2luZGV4XSxcblx0XHR9KSk7XG5cblx0XHR6aXBwZWRBcnJheS5mb3JFYWNoKChmaWxlOiB7IG1hcmtkb3duRmlsZTogVEZpbGU7IGZpbGVEYXRhOiBzdHJpbmcgfSkgPT4ge1xuXHRcdFx0bGV0IGZpbGVCYWNrbGlua3MgPSBjcmVhdGVCYWNrbGlua0RhdGEoZmlsZS5maWxlRGF0YSwgZmlsZS5tYXJrZG93bkZpbGUpO1xuXHRcdFx0dXBkYXRlQmFja2xpbmtzKGZpbGVCYWNrbGlua3MpO1xuXG5cdFx0XHRiYWNrbGlua3MucHVzaCguLi5maWxlQmFja2xpbmtzKTtcblx0XHR9KTtcblx0fSk7XG5cdC8vIH0sIDEwMCk7XG59XG5cbi8vIFNob3VsZCBvbmx5IHJlY29tcHV0ZSBmb3IgdGhlIHBhcnRpY3VsYXIgcGFnZSBiZWluZyBvcGVuZWQgb3IgaW50ZXJhY3RlZCB3aXRoXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVjb21wdXRlUmVmZXJlbmNlc0ZvclBhZ2UoKTogUHJvbWlzZTxCYWNrbGlua1tdPiB7XG5cdGxldCByZWZlcmVuY2VzOiBCYWNrbGlua1tdID0gW107XG5cdGxldCBtYXJrZG93bkZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xuXG5cdGxldCBwcm9taXNlcyA9IG1hcmtkb3duRmlsZXMubWFwKChmaWxlOiBURmlsZSkgPT4gdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKSk7XG5cblx0bGV0IGZpbGVzID0gYXdhaXQgUHJvbWlzZS5hbGwocHJvbWlzZXMpO1xuXHRjb25zdCB6aXBwZWRBcnJheSA9IG1hcmtkb3duRmlsZXMubWFwKChmaWxlOiBURmlsZSwgaW5kZXg6IG51bWJlcikgPT4gKHtcblx0XHRtYXJrZG93bkZpbGU6IGZpbGUsXG5cdFx0ZmlsZURhdGE6IGZpbGVzW2luZGV4XSxcblx0fSkpO1xuXHR6aXBwZWRBcnJheS5mb3JFYWNoKChmaWxlOiB7IG1hcmtkb3duRmlsZTogVEZpbGU7IGZpbGVEYXRhOiBzdHJpbmcgfSkgPT4ge1xuXHRcdGxldCBmaWxlQmFja2xpbmtzID0gY3JlYXRlQmFja2xpbmtEYXRhKGZpbGUuZmlsZURhdGEsIGZpbGUubWFya2Rvd25GaWxlKTtcblx0XHR1cGRhdGVCYWNrbGlua3MoZmlsZUJhY2tsaW5rcyk7XG5cblx0XHRyZWZlcmVuY2VzLnB1c2goLi4uZmlsZUJhY2tsaW5rcyk7XG5cdH0pO1xuXHRyZXR1cm4gcmVmZXJlbmNlcztcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIG9wZW5CYWNrbGlua1JlZmVyZW5jZShldjogTW91c2VFdmVudCkge1xuXHRsZXQgY3Vyc29yID0gZ2V0Q3Vyc29yKCk7XG5cdGxldCBob3ZlciA9IGdldEJhY2tsaW5rSG92ZXIoKTtcblx0bGV0IGxlYWYgPSBnZXRUaGF0KCkud29ya3NwYWNlLmdldExlYWZCeUlkKGhvdmVyLmxlYWZJZCk7XG5cblx0Ly8gQHRzLWlnbm9yZVxuXHRsZXQgY29udGFpbmVyID0gbGVhZi5jb250YWluZXJFbDtcblx0aWYgKCFjb250YWluZXIpIHRocm93IG5ldyBFcnJvcihcIkNvbnRhaW5lciBub3QgZm91bmRcIik7XG5cdGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiLnZpZXctY29udGVudFwiKS5zdHlsZS5ib3hTaGFkb3cgPSBcIm5vbmVcIjtcblxuXHRpZiAoXG5cdFx0Y3Vyc29yICYmXG5cdFx0aG92ZXIgJiZcblx0XHRjdXJzb3IuZGF0YVN0cmluZyAmJlxuXHRcdGhvdmVyLmRhdGFTdHJpbmcgJiZcblx0XHRjdXJzb3IuZGF0YVN0cmluZyA9PSBob3Zlci5kYXRhU3RyaW5nXG5cdCkge1xuXHRcdHVwZGF0ZUN1cnNvcih7XG5cdFx0XHR0ZW1wOiBmYWxzZSxcblx0XHRcdGN1cnNvclZpZXdwb3J0OiBudWxsLFxuXHRcdFx0cGVlazogZmFsc2UsXG5cdFx0fSk7XG5cdH1cblx0dXBkYXRlQmFja2xpbmtIb3Zlcih7XG5cdFx0dGVtcDogZmFsc2UsXG5cdFx0Y3Vyc29yVmlld3BvcnQ6IG51bGwsXG5cdFx0cGVlazogZmFsc2UsXG5cdH0pO1xuXG5cdGhhbmRsZVJlbW92ZUhvdmVyZWRDdXJzb3IoQUNUSU9OX1RZUEUuQ1VSU09SKTtcblxuXHRyZXNldEN1cnNvcigpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gb3BlblJlZmVyZW5jZShldjogTW91c2VFdmVudCkge1xuXHRsZXQgY3Vyc29yID0gZ2V0Q3Vyc29yKCk7XG5cdGxldCBob3ZlciA9IGdldEhvdmVyKCk7XG5cdGxldCBsZWFmID0gZ2V0VGhhdCgpLndvcmtzcGFjZS5nZXRMZWFmQnlJZChob3Zlci5sZWFmSWQpO1xuXG5cdC8vIEB0cy1pZ25vcmVcblx0bGV0IGNvbnRhaW5lciA9IGxlYWYuY29udGFpbmVyRWw7XG5cdGlmICghY29udGFpbmVyKSB0aHJvdyBuZXcgRXJyb3IoXCJDb250YWluZXIgbm90IGZvdW5kXCIpO1xuXHRjb250YWluZXIucXVlcnlTZWxlY3RvcihcIi52aWV3LWNvbnRlbnRcIikuc3R5bGUuYm94U2hhZG93ID0gXCJub25lXCI7XG5cblx0aWYgKFxuXHRcdGN1cnNvciAmJlxuXHRcdGhvdmVyICYmXG5cdFx0Y3Vyc29yLmRhdGFTdHJpbmcgJiZcblx0XHRob3Zlci5kYXRhU3RyaW5nICYmXG5cdFx0Y3Vyc29yLmRhdGFTdHJpbmcgPT0gaG92ZXIuZGF0YVN0cmluZ1xuXHQpIHtcblx0XHR1cGRhdGVDdXJzb3Ioe1xuXHRcdFx0dGVtcDogZmFsc2UsXG5cdFx0XHRjdXJzb3JWaWV3cG9ydDogbnVsbCxcblx0XHRcdHBlZWs6IGZhbHNlLFxuXHRcdH0pO1xuXHR9XG5cdHVwZGF0ZUhvdmVyKHtcblx0XHR0ZW1wOiBmYWxzZSxcblx0XHRjdXJzb3JWaWV3cG9ydDogbnVsbCxcblx0XHRwZWVrOiBmYWxzZSxcblx0fSk7XG5cblx0aGFuZGxlUmVtb3ZlSG92ZXJlZEN1cnNvcihBQ1RJT05fVFlQRS5DVVJTT1IpO1xuXG5cdHJlc2V0Q3Vyc29yKCk7XG59XG4iLCAiLy8gVW5pcXVlIElEIGNyZWF0aW9uIHJlcXVpcmVzIGEgaGlnaCBxdWFsaXR5IHJhbmRvbSAjIGdlbmVyYXRvci4gSW4gdGhlIGJyb3dzZXIgd2UgdGhlcmVmb3JlXG4vLyByZXF1aXJlIHRoZSBjcnlwdG8gQVBJIGFuZCBkbyBub3Qgc3VwcG9ydCBidWlsdC1pbiBmYWxsYmFjayB0byBsb3dlciBxdWFsaXR5IHJhbmRvbSBudW1iZXJcbi8vIGdlbmVyYXRvcnMgKGxpa2UgTWF0aC5yYW5kb20oKSkuXG5sZXQgZ2V0UmFuZG9tVmFsdWVzO1xuY29uc3Qgcm5kczggPSBuZXcgVWludDhBcnJheSgxNik7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBybmcoKSB7XG4gIC8vIGxhenkgbG9hZCBzbyB0aGF0IGVudmlyb25tZW50cyB0aGF0IG5lZWQgdG8gcG9seWZpbGwgaGF2ZSBhIGNoYW5jZSB0byBkbyBzb1xuICBpZiAoIWdldFJhbmRvbVZhbHVlcykge1xuICAgIC8vIGdldFJhbmRvbVZhbHVlcyBuZWVkcyB0byBiZSBpbnZva2VkIGluIGEgY29udGV4dCB3aGVyZSBcInRoaXNcIiBpcyBhIENyeXB0byBpbXBsZW1lbnRhdGlvbi5cbiAgICBnZXRSYW5kb21WYWx1ZXMgPSB0eXBlb2YgY3J5cHRvICE9PSAndW5kZWZpbmVkJyAmJiBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzICYmIGNyeXB0by5nZXRSYW5kb21WYWx1ZXMuYmluZChjcnlwdG8pO1xuXG4gICAgaWYgKCFnZXRSYW5kb21WYWx1ZXMpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignY3J5cHRvLmdldFJhbmRvbVZhbHVlcygpIG5vdCBzdXBwb3J0ZWQuIFNlZSBodHRwczovL2dpdGh1Yi5jb20vdXVpZGpzL3V1aWQjZ2V0cmFuZG9tdmFsdWVzLW5vdC1zdXBwb3J0ZWQnKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gZ2V0UmFuZG9tVmFsdWVzKHJuZHM4KTtcbn0iLCAiZXhwb3J0IGRlZmF1bHQgL14oPzpbMC05YS1mXXs4fS1bMC05YS1mXXs0fS1bMS01XVswLTlhLWZdezN9LVs4OWFiXVswLTlhLWZdezN9LVswLTlhLWZdezEyfXwwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDApJC9pOyIsICJpbXBvcnQgUkVHRVggZnJvbSAnLi9yZWdleC5qcyc7XG5cbmZ1bmN0aW9uIHZhbGlkYXRlKHV1aWQpIHtcbiAgcmV0dXJuIHR5cGVvZiB1dWlkID09PSAnc3RyaW5nJyAmJiBSRUdFWC50ZXN0KHV1aWQpO1xufVxuXG5leHBvcnQgZGVmYXVsdCB2YWxpZGF0ZTsiLCAiaW1wb3J0IHZhbGlkYXRlIGZyb20gJy4vdmFsaWRhdGUuanMnO1xuLyoqXG4gKiBDb252ZXJ0IGFycmF5IG9mIDE2IGJ5dGUgdmFsdWVzIHRvIFVVSUQgc3RyaW5nIGZvcm1hdCBvZiB0aGUgZm9ybTpcbiAqIFhYWFhYWFhYLVhYWFgtWFhYWC1YWFhYLVhYWFhYWFhYWFhYWFxuICovXG5cbmNvbnN0IGJ5dGVUb0hleCA9IFtdO1xuXG5mb3IgKGxldCBpID0gMDsgaSA8IDI1NjsgKytpKSB7XG4gIGJ5dGVUb0hleC5wdXNoKChpICsgMHgxMDApLnRvU3RyaW5nKDE2KS5zbGljZSgxKSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1bnNhZmVTdHJpbmdpZnkoYXJyLCBvZmZzZXQgPSAwKSB7XG4gIC8vIE5vdGU6IEJlIGNhcmVmdWwgZWRpdGluZyB0aGlzIGNvZGUhICBJdCdzIGJlZW4gdHVuZWQgZm9yIHBlcmZvcm1hbmNlXG4gIC8vIGFuZCB3b3JrcyBpbiB3YXlzIHlvdSBtYXkgbm90IGV4cGVjdC4gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS91dWlkanMvdXVpZC9wdWxsLzQzNFxuICByZXR1cm4gYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAwXV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDFdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMl1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAzXV0gKyAnLScgKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDRdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgNV1dICsgJy0nICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA2XV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDddXSArICctJyArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgOF1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA5XV0gKyAnLScgKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDEwXV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDExXV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDEyXV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDEzXV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDE0XV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDE1XV07XG59XG5cbmZ1bmN0aW9uIHN0cmluZ2lmeShhcnIsIG9mZnNldCA9IDApIHtcbiAgY29uc3QgdXVpZCA9IHVuc2FmZVN0cmluZ2lmeShhcnIsIG9mZnNldCk7IC8vIENvbnNpc3RlbmN5IGNoZWNrIGZvciB2YWxpZCBVVUlELiAgSWYgdGhpcyB0aHJvd3MsIGl0J3MgbGlrZWx5IGR1ZSB0byBvbmVcbiAgLy8gb2YgdGhlIGZvbGxvd2luZzpcbiAgLy8gLSBPbmUgb3IgbW9yZSBpbnB1dCBhcnJheSB2YWx1ZXMgZG9uJ3QgbWFwIHRvIGEgaGV4IG9jdGV0IChsZWFkaW5nIHRvXG4gIC8vIFwidW5kZWZpbmVkXCIgaW4gdGhlIHV1aWQpXG4gIC8vIC0gSW52YWxpZCBpbnB1dCB2YWx1ZXMgZm9yIHRoZSBSRkMgYHZlcnNpb25gIG9yIGB2YXJpYW50YCBmaWVsZHNcblxuICBpZiAoIXZhbGlkYXRlKHV1aWQpKSB7XG4gICAgdGhyb3cgVHlwZUVycm9yKCdTdHJpbmdpZmllZCBVVUlEIGlzIGludmFsaWQnKTtcbiAgfVxuXG4gIHJldHVybiB1dWlkO1xufVxuXG5leHBvcnQgZGVmYXVsdCBzdHJpbmdpZnk7IiwgImltcG9ydCB2YWxpZGF0ZSBmcm9tICcuL3ZhbGlkYXRlLmpzJztcblxuZnVuY3Rpb24gcGFyc2UodXVpZCkge1xuICBpZiAoIXZhbGlkYXRlKHV1aWQpKSB7XG4gICAgdGhyb3cgVHlwZUVycm9yKCdJbnZhbGlkIFVVSUQnKTtcbiAgfVxuXG4gIGxldCB2O1xuICBjb25zdCBhcnIgPSBuZXcgVWludDhBcnJheSgxNik7IC8vIFBhcnNlICMjIyMjIyMjLS4uLi4tLi4uLi0uLi4uLS4uLi4uLi4uLi4uLlxuXG4gIGFyclswXSA9ICh2ID0gcGFyc2VJbnQodXVpZC5zbGljZSgwLCA4KSwgMTYpKSA+Pj4gMjQ7XG4gIGFyclsxXSA9IHYgPj4+IDE2ICYgMHhmZjtcbiAgYXJyWzJdID0gdiA+Pj4gOCAmIDB4ZmY7XG4gIGFyclszXSA9IHYgJiAweGZmOyAvLyBQYXJzZSAuLi4uLi4uLi0jIyMjLS4uLi4tLi4uLi0uLi4uLi4uLi4uLi5cblxuICBhcnJbNF0gPSAodiA9IHBhcnNlSW50KHV1aWQuc2xpY2UoOSwgMTMpLCAxNikpID4+PiA4O1xuICBhcnJbNV0gPSB2ICYgMHhmZjsgLy8gUGFyc2UgLi4uLi4uLi4tLi4uLi0jIyMjLS4uLi4tLi4uLi4uLi4uLi4uXG5cbiAgYXJyWzZdID0gKHYgPSBwYXJzZUludCh1dWlkLnNsaWNlKDE0LCAxOCksIDE2KSkgPj4+IDg7XG4gIGFycls3XSA9IHYgJiAweGZmOyAvLyBQYXJzZSAuLi4uLi4uLi0uLi4uLS4uLi4tIyMjIy0uLi4uLi4uLi4uLi5cblxuICBhcnJbOF0gPSAodiA9IHBhcnNlSW50KHV1aWQuc2xpY2UoMTksIDIzKSwgMTYpKSA+Pj4gODtcbiAgYXJyWzldID0gdiAmIDB4ZmY7IC8vIFBhcnNlIC4uLi4uLi4uLS4uLi4tLi4uLi0uLi4uLSMjIyMjIyMjIyMjI1xuICAvLyAoVXNlIFwiL1wiIHRvIGF2b2lkIDMyLWJpdCB0cnVuY2F0aW9uIHdoZW4gYml0LXNoaWZ0aW5nIGhpZ2gtb3JkZXIgYnl0ZXMpXG5cbiAgYXJyWzEwXSA9ICh2ID0gcGFyc2VJbnQodXVpZC5zbGljZSgyNCwgMzYpLCAxNikpIC8gMHgxMDAwMDAwMDAwMCAmIDB4ZmY7XG4gIGFyclsxMV0gPSB2IC8gMHgxMDAwMDAwMDAgJiAweGZmO1xuICBhcnJbMTJdID0gdiA+Pj4gMjQgJiAweGZmO1xuICBhcnJbMTNdID0gdiA+Pj4gMTYgJiAweGZmO1xuICBhcnJbMTRdID0gdiA+Pj4gOCAmIDB4ZmY7XG4gIGFyclsxNV0gPSB2ICYgMHhmZjtcbiAgcmV0dXJuIGFycjtcbn1cblxuZXhwb3J0IGRlZmF1bHQgcGFyc2U7IiwgImltcG9ydCB7IHVuc2FmZVN0cmluZ2lmeSB9IGZyb20gJy4vc3RyaW5naWZ5LmpzJztcbmltcG9ydCBwYXJzZSBmcm9tICcuL3BhcnNlLmpzJztcblxuZnVuY3Rpb24gc3RyaW5nVG9CeXRlcyhzdHIpIHtcbiAgc3RyID0gdW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KHN0cikpOyAvLyBVVEY4IGVzY2FwZVxuXG4gIGNvbnN0IGJ5dGVzID0gW107XG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyArK2kpIHtcbiAgICBieXRlcy5wdXNoKHN0ci5jaGFyQ29kZUF0KGkpKTtcbiAgfVxuXG4gIHJldHVybiBieXRlcztcbn1cblxuZXhwb3J0IGNvbnN0IEROUyA9ICc2YmE3YjgxMC05ZGFkLTExZDEtODBiNC0wMGMwNGZkNDMwYzgnO1xuZXhwb3J0IGNvbnN0IFVSTCA9ICc2YmE3YjgxMS05ZGFkLTExZDEtODBiNC0wMGMwNGZkNDMwYzgnO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gdjM1KG5hbWUsIHZlcnNpb24sIGhhc2hmdW5jKSB7XG4gIGZ1bmN0aW9uIGdlbmVyYXRlVVVJRCh2YWx1ZSwgbmFtZXNwYWNlLCBidWYsIG9mZnNldCkge1xuICAgIHZhciBfbmFtZXNwYWNlO1xuXG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgIHZhbHVlID0gc3RyaW5nVG9CeXRlcyh2YWx1ZSk7XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiBuYW1lc3BhY2UgPT09ICdzdHJpbmcnKSB7XG4gICAgICBuYW1lc3BhY2UgPSBwYXJzZShuYW1lc3BhY2UpO1xuICAgIH1cblxuICAgIGlmICgoKF9uYW1lc3BhY2UgPSBuYW1lc3BhY2UpID09PSBudWxsIHx8IF9uYW1lc3BhY2UgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9uYW1lc3BhY2UubGVuZ3RoKSAhPT0gMTYpIHtcbiAgICAgIHRocm93IFR5cGVFcnJvcignTmFtZXNwYWNlIG11c3QgYmUgYXJyYXktbGlrZSAoMTYgaXRlcmFibGUgaW50ZWdlciB2YWx1ZXMsIDAtMjU1KScpO1xuICAgIH0gLy8gQ29tcHV0ZSBoYXNoIG9mIG5hbWVzcGFjZSBhbmQgdmFsdWUsIFBlciA0LjNcbiAgICAvLyBGdXR1cmU6IFVzZSBzcHJlYWQgc3ludGF4IHdoZW4gc3VwcG9ydGVkIG9uIGFsbCBwbGF0Zm9ybXMsIGUuZy4gYGJ5dGVzID1cbiAgICAvLyBoYXNoZnVuYyhbLi4ubmFtZXNwYWNlLCAuLi4gdmFsdWVdKWBcblxuXG4gICAgbGV0IGJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoMTYgKyB2YWx1ZS5sZW5ndGgpO1xuICAgIGJ5dGVzLnNldChuYW1lc3BhY2UpO1xuICAgIGJ5dGVzLnNldCh2YWx1ZSwgbmFtZXNwYWNlLmxlbmd0aCk7XG4gICAgYnl0ZXMgPSBoYXNoZnVuYyhieXRlcyk7XG4gICAgYnl0ZXNbNl0gPSBieXRlc1s2XSAmIDB4MGYgfCB2ZXJzaW9uO1xuICAgIGJ5dGVzWzhdID0gYnl0ZXNbOF0gJiAweDNmIHwgMHg4MDtcblxuICAgIGlmIChidWYpIHtcbiAgICAgIG9mZnNldCA9IG9mZnNldCB8fCAwO1xuXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDE2OyArK2kpIHtcbiAgICAgICAgYnVmW29mZnNldCArIGldID0gYnl0ZXNbaV07XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBidWY7XG4gICAgfVxuXG4gICAgcmV0dXJuIHVuc2FmZVN0cmluZ2lmeShieXRlcyk7XG4gIH0gLy8gRnVuY3Rpb24jbmFtZSBpcyBub3Qgc2V0dGFibGUgb24gc29tZSBwbGF0Zm9ybXMgKCMyNzApXG5cblxuICB0cnkge1xuICAgIGdlbmVyYXRlVVVJRC5uYW1lID0gbmFtZTsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWVtcHR5XG4gIH0gY2F0Y2ggKGVycikge30gLy8gRm9yIENvbW1vbkpTIGRlZmF1bHQgZXhwb3J0IHN1cHBvcnRcblxuXG4gIGdlbmVyYXRlVVVJRC5ETlMgPSBETlM7XG4gIGdlbmVyYXRlVVVJRC5VUkwgPSBVUkw7XG4gIHJldHVybiBnZW5lcmF0ZVVVSUQ7XG59IiwgImNvbnN0IHJhbmRvbVVVSUQgPSB0eXBlb2YgY3J5cHRvICE9PSAndW5kZWZpbmVkJyAmJiBjcnlwdG8ucmFuZG9tVVVJRCAmJiBjcnlwdG8ucmFuZG9tVVVJRC5iaW5kKGNyeXB0byk7XG5leHBvcnQgZGVmYXVsdCB7XG4gIHJhbmRvbVVVSURcbn07IiwgImltcG9ydCBuYXRpdmUgZnJvbSAnLi9uYXRpdmUuanMnO1xuaW1wb3J0IHJuZyBmcm9tICcuL3JuZy5qcyc7XG5pbXBvcnQgeyB1bnNhZmVTdHJpbmdpZnkgfSBmcm9tICcuL3N0cmluZ2lmeS5qcyc7XG5cbmZ1bmN0aW9uIHY0KG9wdGlvbnMsIGJ1Ziwgb2Zmc2V0KSB7XG4gIGlmIChuYXRpdmUucmFuZG9tVVVJRCAmJiAhYnVmICYmICFvcHRpb25zKSB7XG4gICAgcmV0dXJuIG5hdGl2ZS5yYW5kb21VVUlEKCk7XG4gIH1cblxuICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgY29uc3Qgcm5kcyA9IG9wdGlvbnMucmFuZG9tIHx8IChvcHRpb25zLnJuZyB8fCBybmcpKCk7IC8vIFBlciA0LjQsIHNldCBiaXRzIGZvciB2ZXJzaW9uIGFuZCBgY2xvY2tfc2VxX2hpX2FuZF9yZXNlcnZlZGBcblxuICBybmRzWzZdID0gcm5kc1s2XSAmIDB4MGYgfCAweDQwO1xuICBybmRzWzhdID0gcm5kc1s4XSAmIDB4M2YgfCAweDgwOyAvLyBDb3B5IGJ5dGVzIHRvIGJ1ZmZlciwgaWYgcHJvdmlkZWRcblxuICBpZiAoYnVmKSB7XG4gICAgb2Zmc2V0ID0gb2Zmc2V0IHx8IDA7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDE2OyArK2kpIHtcbiAgICAgIGJ1ZltvZmZzZXQgKyBpXSA9IHJuZHNbaV07XG4gICAgfVxuXG4gICAgcmV0dXJuIGJ1ZjtcbiAgfVxuXG4gIHJldHVybiB1bnNhZmVTdHJpbmdpZnkocm5kcyk7XG59XG5cbmV4cG9ydCBkZWZhdWx0IHY0OyIsICIvLyBBZGFwdGVkIGZyb20gQ2hyaXMgVmVuZXNzJyBTSEExIGNvZGUgYXRcbi8vIGh0dHA6Ly93d3cubW92YWJsZS10eXBlLmNvLnVrL3NjcmlwdHMvc2hhMS5odG1sXG5mdW5jdGlvbiBmKHMsIHgsIHksIHopIHtcbiAgc3dpdGNoIChzKSB7XG4gICAgY2FzZSAwOlxuICAgICAgcmV0dXJuIHggJiB5IF4gfnggJiB6O1xuXG4gICAgY2FzZSAxOlxuICAgICAgcmV0dXJuIHggXiB5IF4gejtcblxuICAgIGNhc2UgMjpcbiAgICAgIHJldHVybiB4ICYgeSBeIHggJiB6IF4geSAmIHo7XG5cbiAgICBjYXNlIDM6XG4gICAgICByZXR1cm4geCBeIHkgXiB6O1xuICB9XG59XG5cbmZ1bmN0aW9uIFJPVEwoeCwgbikge1xuICByZXR1cm4geCA8PCBuIHwgeCA+Pj4gMzIgLSBuO1xufVxuXG5mdW5jdGlvbiBzaGExKGJ5dGVzKSB7XG4gIGNvbnN0IEsgPSBbMHg1YTgyNzk5OSwgMHg2ZWQ5ZWJhMSwgMHg4ZjFiYmNkYywgMHhjYTYyYzFkNl07XG4gIGNvbnN0IEggPSBbMHg2NzQ1MjMwMSwgMHhlZmNkYWI4OSwgMHg5OGJhZGNmZSwgMHgxMDMyNTQ3NiwgMHhjM2QyZTFmMF07XG5cbiAgaWYgKHR5cGVvZiBieXRlcyA9PT0gJ3N0cmluZycpIHtcbiAgICBjb25zdCBtc2cgPSB1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoYnl0ZXMpKTsgLy8gVVRGOCBlc2NhcGVcblxuICAgIGJ5dGVzID0gW107XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG1zZy5sZW5ndGg7ICsraSkge1xuICAgICAgYnl0ZXMucHVzaChtc2cuY2hhckNvZGVBdChpKSk7XG4gICAgfVxuICB9IGVsc2UgaWYgKCFBcnJheS5pc0FycmF5KGJ5dGVzKSkge1xuICAgIC8vIENvbnZlcnQgQXJyYXktbGlrZSB0byBBcnJheVxuICAgIGJ5dGVzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYnl0ZXMpO1xuICB9XG5cbiAgYnl0ZXMucHVzaCgweDgwKTtcbiAgY29uc3QgbCA9IGJ5dGVzLmxlbmd0aCAvIDQgKyAyO1xuICBjb25zdCBOID0gTWF0aC5jZWlsKGwgLyAxNik7XG4gIGNvbnN0IE0gPSBuZXcgQXJyYXkoTik7XG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBOOyArK2kpIHtcbiAgICBjb25zdCBhcnIgPSBuZXcgVWludDMyQXJyYXkoMTYpO1xuXG4gICAgZm9yIChsZXQgaiA9IDA7IGogPCAxNjsgKytqKSB7XG4gICAgICBhcnJbal0gPSBieXRlc1tpICogNjQgKyBqICogNF0gPDwgMjQgfCBieXRlc1tpICogNjQgKyBqICogNCArIDFdIDw8IDE2IHwgYnl0ZXNbaSAqIDY0ICsgaiAqIDQgKyAyXSA8PCA4IHwgYnl0ZXNbaSAqIDY0ICsgaiAqIDQgKyAzXTtcbiAgICB9XG5cbiAgICBNW2ldID0gYXJyO1xuICB9XG5cbiAgTVtOIC0gMV1bMTRdID0gKGJ5dGVzLmxlbmd0aCAtIDEpICogOCAvIE1hdGgucG93KDIsIDMyKTtcbiAgTVtOIC0gMV1bMTRdID0gTWF0aC5mbG9vcihNW04gLSAxXVsxNF0pO1xuICBNW04gLSAxXVsxNV0gPSAoYnl0ZXMubGVuZ3RoIC0gMSkgKiA4ICYgMHhmZmZmZmZmZjtcblxuICBmb3IgKGxldCBpID0gMDsgaSA8IE47ICsraSkge1xuICAgIGNvbnN0IFcgPSBuZXcgVWludDMyQXJyYXkoODApO1xuXG4gICAgZm9yIChsZXQgdCA9IDA7IHQgPCAxNjsgKyt0KSB7XG4gICAgICBXW3RdID0gTVtpXVt0XTtcbiAgICB9XG5cbiAgICBmb3IgKGxldCB0ID0gMTY7IHQgPCA4MDsgKyt0KSB7XG4gICAgICBXW3RdID0gUk9UTChXW3QgLSAzXSBeIFdbdCAtIDhdIF4gV1t0IC0gMTRdIF4gV1t0IC0gMTZdLCAxKTtcbiAgICB9XG5cbiAgICBsZXQgYSA9IEhbMF07XG4gICAgbGV0IGIgPSBIWzFdO1xuICAgIGxldCBjID0gSFsyXTtcbiAgICBsZXQgZCA9IEhbM107XG4gICAgbGV0IGUgPSBIWzRdO1xuXG4gICAgZm9yIChsZXQgdCA9IDA7IHQgPCA4MDsgKyt0KSB7XG4gICAgICBjb25zdCBzID0gTWF0aC5mbG9vcih0IC8gMjApO1xuICAgICAgY29uc3QgVCA9IFJPVEwoYSwgNSkgKyBmKHMsIGIsIGMsIGQpICsgZSArIEtbc10gKyBXW3RdID4+PiAwO1xuICAgICAgZSA9IGQ7XG4gICAgICBkID0gYztcbiAgICAgIGMgPSBST1RMKGIsIDMwKSA+Pj4gMDtcbiAgICAgIGIgPSBhO1xuICAgICAgYSA9IFQ7XG4gICAgfVxuXG4gICAgSFswXSA9IEhbMF0gKyBhID4+PiAwO1xuICAgIEhbMV0gPSBIWzFdICsgYiA+Pj4gMDtcbiAgICBIWzJdID0gSFsyXSArIGMgPj4+IDA7XG4gICAgSFszXSA9IEhbM10gKyBkID4+PiAwO1xuICAgIEhbNF0gPSBIWzRdICsgZSA+Pj4gMDtcbiAgfVxuXG4gIHJldHVybiBbSFswXSA+PiAyNCAmIDB4ZmYsIEhbMF0gPj4gMTYgJiAweGZmLCBIWzBdID4+IDggJiAweGZmLCBIWzBdICYgMHhmZiwgSFsxXSA+PiAyNCAmIDB4ZmYsIEhbMV0gPj4gMTYgJiAweGZmLCBIWzFdID4+IDggJiAweGZmLCBIWzFdICYgMHhmZiwgSFsyXSA+PiAyNCAmIDB4ZmYsIEhbMl0gPj4gMTYgJiAweGZmLCBIWzJdID4+IDggJiAweGZmLCBIWzJdICYgMHhmZiwgSFszXSA+PiAyNCAmIDB4ZmYsIEhbM10gPj4gMTYgJiAweGZmLCBIWzNdID4+IDggJiAweGZmLCBIWzNdICYgMHhmZiwgSFs0XSA+PiAyNCAmIDB4ZmYsIEhbNF0gPj4gMTYgJiAweGZmLCBIWzRdID4+IDggJiAweGZmLCBIWzRdICYgMHhmZl07XG59XG5cbmV4cG9ydCBkZWZhdWx0IHNoYTE7IiwgImltcG9ydCB2MzUgZnJvbSAnLi92MzUuanMnO1xuaW1wb3J0IHNoYTEgZnJvbSAnLi9zaGExLmpzJztcbmNvbnN0IHY1ID0gdjM1KCd2NScsIDB4NTAsIHNoYTEpO1xuZXhwb3J0IGRlZmF1bHQgdjU7IiwgImltcG9ydCB7IE1hcmtkb3duVmlldywgVGV4dEZpbGVWaWV3LCBWaWV3IH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBSRUZFUkVOQ0VfUkVHRVgsIEFDVElPTl9UWVBFLCBTVkdfSE9WRVJfQ09MT1IgfSBmcm9tIFwiLi9jb25zdGFudHNcIjtcbmltcG9ydCB7IHN0YXJ0UmVmZXJlbmNlRWZmZWN0LCBlbmRSZWZlcmVuY2VDdXJzb3JFZmZlY3QgfSBmcm9tIFwiLi9lZmZlY3RzXCI7XG5pbXBvcnQge1xuXHRnZXRIb3ZlcmVkQ3Vyc29yLFxuXHR1cGRhdGVIb3ZlcmVkQ3Vyc29yLFxuXHRyZW1vdmVIb3ZlcmVkQ3Vyc29yLFxuXHRnZXRIb3Zlcixcbn0gZnJvbSBcIi4vc3RhdGVcIjtcbmltcG9ydCB7IHVwZGF0ZUhvdmVyZWRDdXJzb3JDb2xvciB9IGZyb20gXCIuL3JlZmVyZW5jZXNcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlRWRpdG9yUG9zaXRpb24ocG9zaXRpb25TdHJpbmc6IHN0cmluZykge1xuXHRsZXQgW2xpbmUsIGNoXSA9IHBvc2l0aW9uU3RyaW5nLnNwbGl0KFwiLFwiKTtcblx0cmV0dXJuIHsgbGluZTogcGFyc2VJbnQobGluZSksIGNoOiBwYXJzZUludChjaCkgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGVuY29kZVVSSUNvbXBvbmVudFN0cmluZyhzdHI6IHN0cmluZyk6IHN0cmluZyB7XG5cdHJldHVybiBlbmNvZGVVUklDb21wb25lbnQoc3RyKS5yZXBsYWNlKC9bOigpXS9nLCBmdW5jdGlvbiAoYykge1xuXHRcdHJldHVybiBcIiVcIiArIGMuY2hhckNvZGVBdCgwKS50b1N0cmluZygxNik7XG5cdH0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGVjb2RlVVJJQ29tcG9uZW50U3RyaW5nKHN0cjogc3RyaW5nKTogc3RyaW5nIHtcblx0cmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChcblx0XHRzdHIucmVwbGFjZSgvJTNBL2csIFwiOlwiKS5yZXBsYWNlKC8lMjgvZywgXCIoXCIpLnJlcGxhY2UoLyUyOS9nLCBcIilcIilcblx0KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHByb2Nlc3NVUkkoXG5cdGRhdGFTdHJpbmc6IHN0cmluZ1xuKTogW1xuXHRwcmVmaXg6IHN0cmluZyxcblx0dGV4dDogc3RyaW5nLFxuXHRzdWZmaXg6IHN0cmluZyxcblx0ZmlsZTogc3RyaW5nLFxuXHRmcm9tOiBudW1iZXIsXG5cdHRvOiBudW1iZXIsXG5cdHBvcnRhbDogc3RyaW5nLFxuXHR0b2dnbGU6IHN0cmluZ1xuXSB7XG5cdGxldCBbcHJlZml4LCB0ZXh0LCBzdWZmaXgsIGZpbGUsIGZyb20sIHRvLCBwb3J0YWwsIHRvZ2dsZV0gPVxuXHRcdGRhdGFTdHJpbmcuc3BsaXQoXCI6XCIpO1xuXHRwcmVmaXggPSBkZWNvZGVVUklDb21wb25lbnRTdHJpbmcocHJlZml4KTtcblx0dGV4dCA9IGRlY29kZVVSSUNvbXBvbmVudFN0cmluZyh0ZXh0KTtcblx0c3VmZml4ID0gZGVjb2RlVVJJQ29tcG9uZW50U3RyaW5nKHN1ZmZpeCk7XG5cdGZpbGUgPSBkZWNvZGVVUklDb21wb25lbnRTdHJpbmcoZmlsZSk7XG5cdGZyb20gPSBkZWNvZGVVUklDb21wb25lbnRTdHJpbmcoZnJvbSk7XG5cdHRvID0gZGVjb2RlVVJJQ29tcG9uZW50U3RyaW5nKHRvKTtcblx0aWYgKHBvcnRhbCkgcG9ydGFsID0gZGVjb2RlVVJJQ29tcG9uZW50U3RyaW5nKHBvcnRhbCk7XG5cdHRvZ2dsZSA9IGRlY29kZVVSSUNvbXBvbmVudFN0cmluZyh0b2dnbGUpO1xuXG5cdHJldHVybiBbXG5cdFx0cHJlZml4LFxuXHRcdHRleHQsXG5cdFx0c3VmZml4LFxuXHRcdGZpbGUsXG5cdFx0cGFyc2VJbnQoZnJvbSksXG5cdFx0cGFyc2VJbnQodG8pLFxuXHRcdHBvcnRhbCxcblx0XHR0b2dnbGUsXG5cdF07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRQcmVmaXhBbmRTdWZmaXgoZG9jdW1lbnQ6IHN0cmluZywgZnJvbTogbnVtYmVyLCB0bzogbnVtYmVyKSB7XG5cdGxldCBwcmVmaXggPSBkb2N1bWVudFxuXHRcdC5zbGljZShmcm9tIC0gMjUsIGZyb20pXG5cdFx0LnNwbGl0KFwiXFxuXCIpXG5cdFx0LnNsaWNlKC0xKVswXTtcblx0Ly8gLnNsaWNlKGZyb20gLSAyNSA+IDAgPyBmcm9tIC0gMjUgOiAwLCBmcm9tKVxuXG5cdGxldCBzdWZmaXggPSBkb2N1bWVudC5zbGljZSh0bywgdG8gKyAyNSkuc3BsaXQoXCJcXG5cIilbMF07XG5cdHJldHVybiB7IHByZWZpeCwgc3VmZml4IH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmaW5kVGV4dFBvc2l0aW9ucyhcblx0dGV4dDogc3RyaW5nLFxuXHRzZWFyY2hUZXJtOiBzdHJpbmcsXG5cdHByZWZpeDogc3RyaW5nID0gXCJcIixcblx0c3VmZml4OiBzdHJpbmcgPSBcIlwiXG4pIHtcblx0bGV0IHJvbGxpbmdJbmRleCA9IDA7XG5cblx0Y29uc3QgbGluZXMgPSB0ZXh0LnNwbGl0KFwiXFxuXCIpLm1hcCgobGluZTogc3RyaW5nLCBpOiBudW1iZXIpID0+IHtcblx0XHRsZXQgZGF0YSA9IHsgbGluZSwgaW5kZXg6IHJvbGxpbmdJbmRleCwgbGVuZ3RoOiBsaW5lLmxlbmd0aCArIDEsIGkgfTtcblx0XHRyb2xsaW5nSW5kZXggKz0gZGF0YS5sZW5ndGg7XG5cdFx0cmV0dXJuIGRhdGE7XG5cdH0pO1xuXG5cdGlmICh0ZXh0LmluY2x1ZGVzKHByZWZpeCArIHNlYXJjaFRlcm0gKyBzdWZmaXgpKSB7XG5cdFx0bGV0IG1hdGNoSW5kZXggPSB0ZXh0LmluZGV4T2YocHJlZml4ICsgc2VhcmNoVGVybSArIHN1ZmZpeCk7XG5cdFx0bGV0IHN0YXJ0SW5kZXggPVxuXHRcdFx0bGluZXMuZmluZEluZGV4KChsaW5lOiBhbnkpID0+IGxpbmUuaW5kZXggPiBtYXRjaEluZGV4ICsgcHJlZml4Lmxlbmd0aCkgLVxuXHRcdFx0MTtcblx0XHRsZXQgZW5kSW5kZXggPVxuXHRcdFx0bGluZXMuZmluZEluZGV4KFxuXHRcdFx0XHQobGluZTogYW55KSA9PlxuXHRcdFx0XHRcdGxpbmUuaW5kZXggPiBtYXRjaEluZGV4ICsgcHJlZml4Lmxlbmd0aCArIHNlYXJjaFRlcm0ubGVuZ3RoXG5cdFx0XHQpIC0gMTtcblxuXHRcdGlmIChzdGFydEluZGV4ID09IC0yKSBzdGFydEluZGV4ID0gbGluZXMubGVuZ3RoIC0gMTtcblx0XHRpZiAoZW5kSW5kZXggPT0gLTIpIGVuZEluZGV4ID0gbGluZXMubGVuZ3RoIC0gMTtcblxuXHRcdHJldHVybiB7XG5cdFx0XHRyYW5nZVN0YXJ0OiB7XG5cdFx0XHRcdGxpbmU6IHN0YXJ0SW5kZXgsXG5cdFx0XHRcdGNoOiBtYXRjaEluZGV4ICsgcHJlZml4Lmxlbmd0aCAtIGxpbmVzW3N0YXJ0SW5kZXhdLmluZGV4LFxuXHRcdFx0fSxcblx0XHRcdHJhbmdlRW5kOiB7XG5cdFx0XHRcdGxpbmU6IGVuZEluZGV4LFxuXHRcdFx0XHRjaDpcblx0XHRcdFx0XHRtYXRjaEluZGV4ICtcblx0XHRcdFx0XHRwcmVmaXgubGVuZ3RoICtcblx0XHRcdFx0XHRzZWFyY2hUZXJtLmxlbmd0aCAtXG5cdFx0XHRcdFx0bGluZXNbZW5kSW5kZXhdLmluZGV4LFxuXHRcdFx0fSxcblx0XHRcdGxpbmVzLFxuXHRcdH07XG5cdH1cblx0cmV0dXJuIG51bGw7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBsaXN0SXRlbUxlbmd0aChsaW5lOiBzdHJpbmcpIHtcblx0Ly8gTWF0Y2hlcyBsaW5lcyB0aGF0IHN0YXJ0IHdpdGggYSBidWxsZXQgKGVpdGhlciAtLCAqLCBvciArIGZvbGxvd2VkIGJ5IGEgc3BhY2UpXG5cdGNvbnN0IGJ1bGxldFJlZ2V4ID0gL14oXFxzKlstKitdXFxzKykvO1xuXG5cdC8vIE1hdGNoZXMgbGluZXMgdGhhdCBzdGFydCB3aXRoIGEgbnVtYmVyIGZvbGxvd2VkIGJ5IGEgZG90IGFuZCBhIHNwYWNlIChsaWtlIFwiMS4gXCIpXG5cdGNvbnN0IG51bWJlclJlZ2V4ID0gL14oXFxzKlxcZCtcXC5cXHMrKS87XG5cblx0bGV0IG1hdGNoID0gbGluZS5tYXRjaChidWxsZXRSZWdleCkgfHwgbGluZS5tYXRjaChudW1iZXJSZWdleCk7XG5cdHJldHVybiBtYXRjaCA/IG1hdGNoWzBdLmxlbmd0aCA6IDA7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjaGVja0N1cnNvclBvc2l0aW9uQXREYXRhc3RyaW5nKGV2dDogRXZlbnQpOiB7XG5cdG1hdGNoZWQ6IGJvb2xlYW47XG5cdHNwYW46IEhUTUxTcGFuRWxlbWVudCB8IHVuZGVmaW5lZDtcbn0ge1xuXHRjb25zdCBhY3RpdmVWaWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcblx0Y29uc3QgY3Vyc29yRnJvbSA9IGFjdGl2ZVZpZXc/LmVkaXRvci5nZXRDdXJzb3IoXCJmcm9tXCIpO1xuXHRjb25zdCBjdXJzb3JUbyA9IGFjdGl2ZVZpZXc/LmVkaXRvci5nZXRDdXJzb3IoXCJ0b1wiKTtcblxuXHRsZXQgbWF0Y2hlZCA9IGZhbHNlO1xuXHRsZXQgbWF0Y2hTcGFuOiBIVE1MU3BhbkVsZW1lbnQgfCB1bmRlZmluZWQgPSB1bmRlZmluZWQ7XG5cdGlmIChcblx0XHRjdXJzb3JGcm9tICYmXG5cdFx0Y3Vyc29yVG8gJiZcblx0XHRjdXJzb3JGcm9tLmNoID09IGN1cnNvclRvLmNoICYmXG5cdFx0Y3Vyc29yRnJvbS5saW5lID09IGN1cnNvclRvLmxpbmVcblx0XHQvLyAmJmN1cnNvckZyb20uY2ggLSAxID49IC0xXG5cdCkge1xuXHRcdGNvbnN0IGxpbmVUZXh0ID0gYWN0aXZlVmlldz8uZWRpdG9yLmdldExpbmUoY3Vyc29yRnJvbS5saW5lKTtcblxuXHRcdC8vIGZyb20gcG9zc2libGUgcmVnZXggbWF0Y2hlcyBpbiBsaW5lVGV4dFxuXHRcdGlmIChsaW5lVGV4dCkge1xuXHRcdFx0Y29uc3QgbWF0Y2hlcyA9IFsuLi5saW5lVGV4dC5tYXRjaEFsbChSRUZFUkVOQ0VfUkVHRVgpXTtcblx0XHRcdG1hdGNoZXMuZm9yRWFjaCgobWF0Y2gpID0+IHtcblx0XHRcdFx0aWYgKG1hdGNoLmluZGV4Py50b1N0cmluZygpKSB7XG5cdFx0XHRcdFx0Y29uc3Qgc3RhcnQ6IG51bWJlciA9IG1hdGNoLmluZGV4O1xuXHRcdFx0XHRcdGNvbnN0IGVuZDogbnVtYmVyID0gc3RhcnQgKyBtYXRjaFswXS5sZW5ndGg7XG5cdFx0XHRcdFx0aWYgKGVuZCA9PSBjdXJzb3JUby5jaCAmJiBldnQudGFyZ2V0KSB7XG5cdFx0XHRcdFx0XHRjb25zdCBkYXRhU3RyaW5nID0gbWF0Y2hbMV07XG5cdFx0XHRcdFx0XHQvLyBnZXQgdGhlIGh0bWwgZWxlbWVudCBhdCB0aGUgbWF0Y2ggbG9jYXRpb25cblx0XHRcdFx0XHRcdGxldCBjaGVja0NvbnRhaW5lciA9IGV2dC50YXJnZXQgaW5zdGFuY2VvZiBFbGVtZW50O1xuXHRcdFx0XHRcdFx0aWYgKCFjaGVja0NvbnRhaW5lcilcblx0XHRcdFx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKFwiRWxlbWVudCBub3QgaW5zdGFuY2Ugb2YgRWxlbWVudFwiKTtcblx0XHRcdFx0XHRcdGxldCBjb250YWluZXIgPSBldnQudGFyZ2V0IGFzIEVsZW1lbnQ7XG5cblx0XHRcdFx0XHRcdC8vIGxldCBhY3RpdmVMaW5lO1xuXHRcdFx0XHRcdFx0Ly8gaWYgKGNvbnRhaW5lci5jbGFzc0xpc3QuY29udGFpbnMoXCJjbS1hY3RpdmVcIikpIHtcblx0XHRcdFx0XHRcdC8vIFx0YWN0aXZlTGluZSA9IGNvbnRhaW5lcjtcblx0XHRcdFx0XHRcdC8vIH1cblx0XHRcdFx0XHRcdC8vIC8vIGVsc2UgaWYgKGNvbnRhaW5lci5jbG9zZXN0KFwiLmNtLWFjdGl2ZVwiKSkge1xuXHRcdFx0XHRcdFx0Ly8gLy8gXHRhY3RpdmVMaW5lID0gY29udGFpbmVyLmNsb3Nlc3QoXCIuY20tYWN0aXZlXCIpO1xuXHRcdFx0XHRcdFx0Ly8gLy8gfVxuXHRcdFx0XHRcdFx0Ly8gZWxzZSB7XG5cdFx0XHRcdFx0XHQvLyBcdGFjdGl2ZUxpbmUgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcihcIi5jbS1hY3RpdmVcIik7XG5cdFx0XHRcdFx0XHQvLyB9XG5cdFx0XHRcdFx0XHQvLyBpZiAoIWFjdGl2ZUxpbmUpIHRocm93IG5ldyBFcnJvcihcIkVsZW1lbnQgbm90IGluc3RhbmNlIG9mIEVsZW1lbnRcIik7XG5cdFx0XHRcdFx0XHQvLyBmaW5kIGh0bWwgc3BhbiBlbGVtZW50IGluIHRhcmdldCB0aGF0IGhhcyBhIGRhdGEgYXR0cmlidXRlIGVxdWFsIHRvIGNvbnRlbnRzXG5cdFx0XHRcdFx0XHRsZXQgc3BhbiA9IGNvbnRhaW5lcjtcblx0XHRcdFx0XHRcdGlmICghc3Bhbi5nZXRBdHRyaWJ1dGUoXCJkYXRhXCIpKVxuXHRcdFx0XHRcdFx0XHRzcGFuID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXG5cdFx0XHRcdFx0XHRcdFx0YHNwYW5bZGF0YT1cIiR7ZGF0YVN0cmluZ31cIl1gXG5cdFx0XHRcdFx0XHRcdCkgYXMgSFRNTFNwYW5FbGVtZW50O1xuXG5cdFx0XHRcdFx0XHRpZiAoc3BhbiAmJiBzcGFuIGluc3RhbmNlb2YgSFRNTFNwYW5FbGVtZW50KSB7XG5cdFx0XHRcdFx0XHRcdC8vIGNvbnNvbGUubG9nKFwiRm91bmQgc3BhbiBlbGVtZW50OlwiLCBzcGFuKTtcblx0XHRcdFx0XHRcdFx0Ly8gRG8gc29tZXRoaW5nIHdpdGggdGhlIHNwYW4gZWxlbWVudFxuXHRcdFx0XHRcdFx0XHRtYXRjaGVkID0gdHJ1ZTtcblxuXHRcdFx0XHRcdFx0XHRtYXRjaFNwYW4gPSBzcGFuO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0Ly8gY29uc29sZS5sb2coXCJTcGFuIGVsZW1lbnQgbm90IGZvdW5kXCIpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0fVxuXHR9XG5cdHJldHVybiB7IG1hdGNoZWQsIHNwYW46IG1hdGNoU3BhbiB9O1xufVxuXG4vLyBSZW1vdmUgYW4gZXhpc3RtYWluaW5nIGhpZ2xpZ2h0ZWQgcmVmZXJlbmNlXG5leHBvcnQgZnVuY3Rpb24gaGFuZGxlUmVtb3ZlSG92ZXJlZEN1cnNvcih1c2VyOiBzdHJpbmcpIHtcblx0aWYgKGdldEhvdmVyZWRDdXJzb3IoKSkge1xuXHRcdC8vIGN1cnNvcnMgbm90IGFzc29jaWF0ZWQgd2l0aCB0aGUgdXNlciBhY3Rpb25cblx0XHRsZXQgbm9uQ3Vyc29ycyA9IGdldEhvdmVyZWRDdXJzb3IoKVxuXHRcdFx0LmZpbHRlcigoZWxlbWVudDogYW55KSA9PiB7XG5cdFx0XHRcdHJldHVybiBlbGVtZW50LnVzZXIgIT09IHVzZXI7XG5cdFx0XHR9KVxuXHRcdFx0Lm1hcCgoZWxlbWVudDogYW55KSA9PiBlbGVtZW50LmN1cnNvci5jbG9zZXN0KFwic3BhblwiKSk7XG5cblx0XHQvLyB3aGl0ZSBiYWNrZ3JvdW5kIGlmIGN1cnNvcnMgYXJlIG5vdCBhc3NvY2lhdGVkIHdpdGggdGhlIHVzZXIgYWN0aW9uXG5cdFx0Z2V0SG92ZXJlZEN1cnNvcigpXG5cdFx0XHQuZmlsdGVyKChlbGVtZW50OiBhbnkpID0+IGVsZW1lbnQudXNlciA9PT0gdXNlcilcblx0XHRcdC5mb3JFYWNoKChlbGVtZW50OiBhbnkpID0+IHtcblx0XHRcdFx0aWYgKCFub25DdXJzb3JzLmluY2x1ZGVzKGVsZW1lbnQuY3Vyc29yLmNsb3Nlc3QoXCJzcGFuXCIpKSkge1xuXHRcdFx0XHRcdGxldCBzdmcgPSBlbGVtZW50LmN1cnNvcjtcblx0XHRcdFx0XHRpZiAoIXN2ZykgdGhyb3cgbmV3IEVycm9yKFwiU1ZHIG5vdCBmb3VuZFwiKTtcblx0XHRcdFx0XHRpZiAoc3ZnLmNsYXNzTGlzdC5jb250YWlucyhcInJlZmVyZW5jZS1pY29uXCIpKVxuXHRcdFx0XHRcdFx0c3ZnLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwid2hpdGVcIjtcblx0XHRcdFx0XHRlbHNlIHtcblx0XHRcdFx0XHRcdHN2Zy5zZXRBdHRyaWJ1dGUoXCJmaWxsXCIsIFwid2hpdGVcIik7XG5cdFx0XHRcdFx0XHRzdmcuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCJcIjtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0ZWxlbWVudC5jdXJzb3Iuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCJ3aGl0ZVwiO1xuXHRcdFx0XHRcdC8vIGVsZW1lbnQuY3Vyc29yLnN0eWxlLmJveFNoYWRvdyA9IFwibm9uZVwiO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblxuXHRcdHJlbW92ZUhvdmVyZWRDdXJzb3IodXNlcik7XG5cdH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNoZWNrRm9jdXNDdXJzb3IoZXZ0OiBFdmVudCkge1xuXHRsZXQgeyBtYXRjaGVkLCBzcGFuIH0gPSBjaGVja0N1cnNvclBvc2l0aW9uQXREYXRhc3RyaW5nKGV2dCk7XG5cblx0aWYgKG1hdGNoZWQgJiYgc3Bhbikge1xuXHRcdGF3YWl0IGVuZFJlZmVyZW5jZUN1cnNvckVmZmVjdCgpOyAvLyB0aGlzIHRha2VzIDEwMG1zIHRvIGNsb3NlIGV4aXN0aW5nIHBlZWsgdGFiXG5cdFx0aGFuZGxlUmVtb3ZlSG92ZXJlZEN1cnNvcihBQ1RJT05fVFlQRS5DVVJTT1IpO1xuXHRcdHVwZGF0ZUhvdmVyZWRDdXJzb3JDb2xvcihzcGFuLCBBQ1RJT05fVFlQRS5DVVJTT1IpO1xuXHRcdGF3YWl0IHN0YXJ0UmVmZXJlbmNlRWZmZWN0KHNwYW4sIEFDVElPTl9UWVBFLkNVUlNPUik7XG5cdH0gZWxzZSB7XG5cdFx0YXdhaXQgZW5kUmVmZXJlbmNlQ3Vyc29yRWZmZWN0KCk7XG5cdFx0aGFuZGxlUmVtb3ZlSG92ZXJlZEN1cnNvcihBQ1RJT05fVFlQRS5DVVJTT1IpO1xuXHR9XG59XG4iLCAiaW1wb3J0IHtcblx0VEFic3RyYWN0RmlsZSxcblx0VEZpbGUsXG5cdFdvcmtzcGFjZSxcblx0V29ya3NwYWNlTGVhZixcblx0V29ya3NwYWNlUm9vdCxcblx0V29ya3NwYWNlU3BsaXQsXG5cdFdvcmtzcGFjZVRhYnMsXG59IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgZ2V0VGhhdCB9IGZyb20gXCIuL3N0YXRlXCI7XG5cbmZ1bmN0aW9uIGNvbGxlY3RMZWF2ZXNCeVRhYihcblx0c3BsaXQ6IFdvcmtzcGFjZVNwbGl0LFxuXHRyZXN1bHQ6IFtXb3Jrc3BhY2VMZWFmW11dIHwgW10gPSBbXVxuKSB7XG5cdC8vIEB0cy1pZ25vcmVcblx0Y29uc3QgdHlwZSA9IHNwbGl0LnR5cGU7XG5cdGlmICghdHlwZSkgdGhyb3cgbmV3IEVycm9yKFwiU3BsaXQgdHlwZSBub3QgZm91bmRcIik7XG5cblx0aWYgKHR5cGUgPT0gXCJ0YWJzXCIgfHwgdHlwZSA9PSBcInNwbGl0XCIpIHtcblx0XHQvLyBAdHMtaWdub3JlXG5cdFx0Y29uc3QgY2hpbGRyZW4gPSBzcGxpdC5jaGlsZHJlbjtcblx0XHRpZiAoIWNoaWxkcmVuKSB0aHJvdyBuZXcgRXJyb3IoXCJTcGxpdCBjaGlsZHJlbiBub3QgZm91bmRcIik7XG5cblx0XHRpZiAoY2hpbGRyZW4pIHtcblx0XHRcdGZvciAoY29uc3QgY2hpbGQgb2YgY2hpbGRyZW4pIHtcblx0XHRcdFx0bGV0IGVtcHR5TGlzdDogV29ya3NwYWNlTGVhZltdID0gW107XG5cblx0XHRcdFx0Y29sbGVjdExlYXZlc0J5VGFiKGNoaWxkLCByZXN1bHQpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHQvLyByZXN1bHQucHVzaChbXSk7XG5cdFx0Ly8gY29sbGVjdExlYXZlc0J5VGFiKGNoaWxkcmVuLCByZXN1bHQpO1xuXHR9IGVsc2UgaWYgKHR5cGUgPT0gXCJsZWFmXCIpIHtcblx0XHQvLyBAdHMtaWdub3JlXG5cdFx0Y29uc3QgcGFyZW50U3BsaXRJZCA9IHNwbGl0LnBhcmVudC5pZDtcblx0XHRpZiAoIXBhcmVudFNwbGl0SWQpIHRocm93IG5ldyBFcnJvcihcIlNwbGl0IHBhcmVudCBpZCBub3QgZm91bmRcIik7XG5cblx0XHQvLyBmaW5kIGFycmF5IGluZGV4IGZvciBzcGxpdCB3aXRoIGlkIHBhcmVudFNwbGl0SWRcblx0XHRsZXQgaWR4ID0gcmVzdWx0LmZpbmRJbmRleCgodGFiOiBXb3Jrc3BhY2VMZWFmW10pID0+IHtcblx0XHRcdC8vIEB0cy1pZ25vcmVcblx0XHRcdGNvbnN0IHRhYklkID0gdGFiWzBdLnBhcmVudC5pZDtcblx0XHRcdHJldHVybiB0YWJJZCA9PSBwYXJlbnRTcGxpdElkO1xuXHRcdH0pO1xuXHRcdGlmIChpZHggPT0gLTEpIHtcblx0XHRcdC8vIEB0cy1pZ25vcmVcblx0XHRcdHJlc3VsdC5wdXNoKFtzcGxpdCBhcyBXb3Jrc3BhY2VMZWFmXSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJlc3VsdFtpZHhdLnB1c2goc3BsaXQgYXMgV29ya3NwYWNlTGVhZik7XG5cdFx0fVxuXHR9XG5cblx0Ly8gaWYgKGNoaWxkcmVuKSB7XG5cdC8vIFx0Zm9yIChjb25zdCBjaGlsZCBvZiBjaGlsZHJlbikge1xuXHQvLyBcdFx0Y29sbGVjdExlYXZlc0J5VGFiKGNoaWxkLCByZXN1bHQpO1xuXHQvLyBcdH1cblx0Ly8gfVxuXHRyZXR1cm4gcmVzdWx0O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY29sbGVjdExlYXZlc0J5VGFiSGVscGVyKCkge1xuXHRjb25zdCB7IHdvcmtzcGFjZSB9ID0gZ2V0VGhhdCgpO1xuXHRjb25zdCBjdXJyTGVhZjogV29ya3NwYWNlTGVhZiA9IHdvcmtzcGFjZS5nZXRMZWFmKCk7XG5cdC8vIGNvbnN0IHJvb3RTcGxpdCA9IGZpbmRSb290U3BsaXQoY3VyckxlYWYpO1xuXHRjb25zdCByb290U3BsaXQ6IFdvcmtzcGFjZVNwbGl0ID0gY3VyckxlYWYuZ2V0Um9vdCgpO1xuXHRyZXR1cm4gY29sbGVjdExlYXZlc0J5VGFiKHJvb3RTcGxpdCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDdXJyZW50VGFiSW5kZXgobGVhdmVzQnlUYWI6IGFueVtdLCBzcGFuOiBIVE1MU3BhbkVsZW1lbnQpIHtcblx0bGV0IHdvcmtzcGFjZVRhYiA9IHNwYW4uY2xvc2VzdChcIi53b3Jrc3BhY2UtdGFic1wiKTtcblx0bGV0IGN1cnJUYWJJZHggPSBsZWF2ZXNCeVRhYi5maW5kSW5kZXgoKHRhYjogV29ya3NwYWNlTGVhZltdKSA9PiB7XG5cdFx0Y29uc3QgbGVhZlRhYiA9IHRhYlswXS52aWV3LmNvbnRhaW5lckVsLmNsb3Nlc3QoXCIud29ya3NwYWNlLXRhYnNcIik7XG5cdFx0cmV0dXJuIGxlYWZUYWIgPT0gd29ya3NwYWNlVGFiO1xuXHR9KTtcblx0cmV0dXJuIGN1cnJUYWJJZHg7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRBZGphY2VudFRhYnMoXG5cdGxlYXZlc0J5VGFiOiBhbnlbXSxcblx0Y3VyclRhYklkeDogbnVtYmVyLFxuXHRmaWxlOiBzdHJpbmdcbikge1xuXHRsZXQgcmlnaHRBZGphY2VudFRhYjogYW55W10gPSBbXTtcblx0bGV0IGxlZnRBZGphY2VudFRhYjogYW55W10gPSBbXTtcblx0bGV0IGFkamFjZW50VGFiczogYW55W10gPSBbXTtcblxuXHRpZiAobGVhdmVzQnlUYWJbY3VyclRhYklkeCArIDFdKSB7XG5cdFx0cmlnaHRBZGphY2VudFRhYiA9IGxlYXZlc0J5VGFiW2N1cnJUYWJJZHggKyAxXTtcblx0XHRhZGphY2VudFRhYnMgPSBbLi4uYWRqYWNlbnRUYWJzLCAuLi5yaWdodEFkamFjZW50VGFiXTtcblx0fVxuXHRpZiAobGVhdmVzQnlUYWJbY3VyclRhYklkeCAtIDFdKSB7XG5cdFx0bGVmdEFkamFjZW50VGFiID0gbGVhdmVzQnlUYWJbY3VyclRhYklkeCAtIDFdO1xuXHRcdGFkamFjZW50VGFicyA9IFsuLi5hZGphY2VudFRhYnMsIC4uLmxlZnRBZGphY2VudFRhYl07XG5cdH1cblxuXHRsZXQgaW5kZXggPSBhZGphY2VudFRhYnMuZmluZEluZGV4KFxuXHRcdCh4OiBXb3Jrc3BhY2VMZWFmKSA9PiB4LmdldFZpZXdTdGF0ZSgpLnN0YXRlLmZpbGUgPT0gZmlsZVxuXHQpO1xuXHRyZXR1cm4geyBhZGphY2VudFRhYnMsIHJpZ2h0QWRqYWNlbnRUYWIsIGxlZnRBZGphY2VudFRhYiwgaW5kZXggfTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIG9wZW5GaWxlSW5BZGphY2VudFRhYihcblx0bGVhdmVzQnlUYWI6IGFueVtdLFxuXHRjdXJyVGFiSWR4OiBudW1iZXIsXG5cdGZpbGU6IHN0cmluZyxcblx0dHlwZT86IHN0cmluZ1xuKSB7XG5cdGxldCB7IGFkamFjZW50VGFicywgcmlnaHRBZGphY2VudFRhYiwgbGVmdEFkamFjZW50VGFiIH0gPSBnZXRBZGphY2VudFRhYnMoXG5cdFx0bGVhdmVzQnlUYWIsXG5cdFx0Y3VyclRhYklkeCxcblx0XHRmaWxlXG5cdCk7XG5cblx0bGV0IGFsbFRhYk5hbWVzID0gbGVhdmVzQnlUYWIubWFwKCh0YWI6IFdvcmtzcGFjZUxlYWZbXSkgPT5cblx0XHR0YWIubWFwKCh4OiBXb3Jrc3BhY2VMZWFmKSA9PiB4LmdldFZpZXdTdGF0ZSgpLnN0YXRlLmZpbGUpXG5cdCk7XG5cdGxldCByaWdodEFkamFjZW50VGFiTmFtZXMgPSByaWdodEFkamFjZW50VGFiLm1hcChcblx0XHQoeDogV29ya3NwYWNlTGVhZikgPT4geC5nZXRWaWV3U3RhdGUoKS5zdGF0ZS5maWxlXG5cdCk7XG5cdGxldCBsZWZ0QWRqYWNlbnRUYWJOYW1lcyA9IGxlZnRBZGphY2VudFRhYi5tYXAoXG5cdFx0KHg6IFdvcmtzcGFjZUxlYWYpID0+IHguZ2V0Vmlld1N0YXRlKCkuc3RhdGUuZmlsZVxuXHQpO1xuXHRjb25zdCB7IHdvcmtzcGFjZSB9ID0gZ2V0VGhhdCgpO1xuXHRpZiAoXG5cdFx0YWxsVGFiTmFtZXNcblx0XHRcdC5maWx0ZXIoKHYsIGkpID0+IGkgIT0gY3VyclRhYklkeClcblx0XHRcdC5mbGF0KClcblx0XHRcdC5pbmNsdWRlcyhmaWxlKSAmJlxuXHRcdCFyaWdodEFkamFjZW50VGFiTmFtZXMuaW5jbHVkZXMoZmlsZSkgJiZcblx0XHQhbGVmdEFkamFjZW50VGFiTmFtZXMuaW5jbHVkZXMoZmlsZSlcblx0KSB7XG5cdFx0Ly8gZmlsZSBleGlzdHMsIG5vdCBhZGphY2VudCBsZWZ0IG9yIHJpZ2h0IHRhYlxuXHRcdGxldCBjdXJyZW50VGFiTmFtZXM6IGFueVtdID0gW107XG5cdFx0bGV0IGN1cnJlbnRUYWI6IGFueVtdID0gW107XG5cdFx0YWxsVGFiTmFtZXMuZm9yRWFjaCgodGFiTmFtZXMsIGkpID0+IHtcblx0XHRcdGlmIChcblx0XHRcdFx0dGFiTmFtZXMgIT0gcmlnaHRBZGphY2VudFRhYk5hbWVzICYmXG5cdFx0XHRcdHRhYk5hbWVzICE9IGxlZnRBZGphY2VudFRhYk5hbWVzICYmXG5cdFx0XHRcdGN1cnJUYWJJZHggIT0gaVxuXHRcdFx0KSB7XG5cdFx0XHRcdGlmICh0YWJOYW1lcy5pbmNsdWRlcyhmaWxlKSkge1xuXHRcdFx0XHRcdGN1cnJlbnRUYWJOYW1lcyA9IHRhYk5hbWVzO1xuXHRcdFx0XHRcdGN1cnJlbnRUYWIgPSBsZWF2ZXNCeVRhYltpXTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0Y29uc3Qgb3JpZ2luYWxMZWFmID0gY3VycmVudFRhYi5maWx0ZXIoXG5cdFx0XHQodCkgPT4gdC5jb250YWluZXJFbC5zdHlsZS5kaXNwbGF5ICE9IFwibm9uZVwiXG5cdFx0KVswXTtcblx0XHRsZXQgbGVhZiA9IGN1cnJlbnRUYWJbY3VycmVudFRhYk5hbWVzLmluZGV4T2YoZmlsZSldO1xuXHRcdHdvcmtzcGFjZS5yZXZlYWxMZWFmKGxlYWYpO1xuXG5cdFx0cmV0dXJuIHsgbmV3TGVhZjogbGVhZiwgdGVtcDogZmFsc2UsIG9yaWdpbmFsTGVhZiB9O1xuXHR9IGVsc2UgaWYgKHJpZ2h0QWRqYWNlbnRUYWJOYW1lcy5pbmNsdWRlcyhmaWxlKSkge1xuXHRcdC8vIGZpbGUgZXhpc3RzIGluIHJpZ2h0IHRhYlxuXHRcdGNvbnN0IG9yaWdpbmFsTGVhZiA9IHJpZ2h0QWRqYWNlbnRUYWIuZmlsdGVyKFxuXHRcdFx0KHQpID0+IHQuY29udGFpbmVyRWwuc3R5bGUuZGlzcGxheSAhPSBcIm5vbmVcIlxuXHRcdClbMF07XG5cdFx0bGV0IGxlYWYgPSByaWdodEFkamFjZW50VGFiW3JpZ2h0QWRqYWNlbnRUYWJOYW1lcy5pbmRleE9mKGZpbGUpXTtcblx0XHR3b3Jrc3BhY2UucmV2ZWFsTGVhZihsZWFmKTtcblx0XHRyZXR1cm4geyBuZXdMZWFmOiBsZWFmLCB0ZW1wOiBmYWxzZSwgb3JpZ2luYWxMZWFmIH07XG5cdH0gZWxzZSBpZiAobGVmdEFkamFjZW50VGFiTmFtZXMuaW5jbHVkZXMoZmlsZSkpIHtcblx0XHQvLyBmaWxlIGV4aXN0cyBpbiBsZWZ0IHRhYlxuXHRcdGNvbnN0IG9yaWdpbmFsTGVhZiA9IGxlZnRBZGphY2VudFRhYi5maWx0ZXIoXG5cdFx0XHQodCkgPT4gdC5jb250YWluZXJFbC5zdHlsZS5kaXNwbGF5ICE9IFwibm9uZVwiXG5cdFx0KVswXTtcblxuXHRcdGxldCBsZWFmID0gbGVmdEFkamFjZW50VGFiW2xlZnRBZGphY2VudFRhYk5hbWVzLmluZGV4T2YoZmlsZSldO1xuXHRcdHdvcmtzcGFjZS5yZXZlYWxMZWFmKGxlYWYpO1xuXHRcdHJldHVybiB7IG5ld0xlYWY6IGxlYWYsIHRlbXA6IGZhbHNlLCBvcmlnaW5hbExlYWYgfTtcblx0fSBlbHNlIGlmIChyaWdodEFkamFjZW50VGFiLmxlbmd0aCA+IDApIHtcblx0XHQvLyB0aGVyZSBleGlzdHMgYSByaWdodCB0YWJcblx0XHRjb25zdCBvcmlnaW5hbExlYWYgPSByaWdodEFkamFjZW50VGFiLmZpbHRlcihcblx0XHRcdCh0KSA9PiB0LmNvbnRhaW5lckVsLnN0eWxlLmRpc3BsYXkgIT0gXCJub25lXCJcblx0XHQpWzBdO1xuXG5cdFx0bGV0IGN1cnJMZWFmID0gd29ya3NwYWNlLmdldExlYWYoKTtcblx0XHR3b3Jrc3BhY2Uuc2V0QWN0aXZlTGVhZihvcmlnaW5hbExlYWYpO1xuXHRcdGxldCBuZXdMZWFmID0gd29ya3NwYWNlLmdldExlYWYodHJ1ZSk7XG5cdFx0YXdhaXQgb3BlbkZpbGVJbkxlYWYobmV3TGVhZiwgZmlsZSk7XG5cdFx0d29ya3NwYWNlLnJldmVhbExlYWYobmV3TGVhZik7XG5cdFx0d29ya3NwYWNlLnNldEFjdGl2ZUxlYWYoY3VyckxlYWYpO1xuXHRcdHJldHVybiB7IG5ld0xlYWYsIHRlbXA6IHRydWUsIG9yaWdpbmFsTGVhZiB9O1xuXHR9IGVsc2UgaWYgKGxlZnRBZGphY2VudFRhYi5sZW5ndGggPiAwKSB7XG5cdFx0Ly8gdGhlcmUgZXhpc3RzIGEgbGVmdCB0YWJcblx0XHRjb25zdCBvcmlnaW5hbExlYWYgPSBsZWZ0QWRqYWNlbnRUYWIuZmlsdGVyKFxuXHRcdFx0KHQpID0+IHQuY29udGFpbmVyRWwuc3R5bGUuZGlzcGxheSAhPSBcIm5vbmVcIlxuXHRcdClbMF07XG5cblx0XHRsZXQgY3VyckxlYWYgPSB3b3Jrc3BhY2UuZ2V0TGVhZigpOyAvLyBnZXQgY3VycmVudCBhY3RpdmUgbGVhZlxuXHRcdHdvcmtzcGFjZS5zZXRBY3RpdmVMZWFmKG9yaWdpbmFsTGVhZik7IC8vIGdldCB0aGUgbGVhZiBpbiBhZGphY2VudCB0YWJcblx0XHRsZXQgbmV3TGVhZiA9IHdvcmtzcGFjZS5nZXRMZWFmKHRydWUpOyAvLyBjcmVhdGUgYSBuZXcgbGVhZlxuXHRcdGF3YWl0IG9wZW5GaWxlSW5MZWFmKG5ld0xlYWYsIGZpbGUpOyAvLyBsb2FkIGZpbGUgaW50byBuZXcgbGVhZlxuXHRcdHdvcmtzcGFjZS5yZXZlYWxMZWFmKG5ld0xlYWYpOyAvLyByZXZlYWwgbmV3IGxlYWZcblx0XHR3b3Jrc3BhY2Uuc2V0QWN0aXZlTGVhZihjdXJyTGVhZik7IC8vIHNldCBhY3RpdmUgbGVhZiBiYWNrIHRvIG9yaWdpbmFsXG5cdFx0cmV0dXJuIHsgbmV3TGVhZiwgdGVtcDogdHJ1ZSwgb3JpZ2luYWxMZWFmIH07XG5cdH0gZWxzZSB7XG5cdFx0Ly8gbm8gYWRqYWNlbnQgdGFic1xuXHRcdGNvbnN0IGN1cnJMZWFmID0gd29ya3NwYWNlLmdldExlYWYoKTtcblx0XHRsZXQgbmV3TGVhZiA9IHdvcmtzcGFjZS5jcmVhdGVMZWFmQnlTcGxpdChjdXJyTGVhZik7XG5cdFx0YXdhaXQgb3BlbkZpbGVJbkxlYWYobmV3TGVhZiwgZmlsZSk7XG5cdFx0cmV0dXJuIHsgbmV3TGVhZiwgdGVtcDogdHJ1ZSB9O1xuXHR9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBvcGVuRmlsZUluTGVhZihsZWFmOiBXb3Jrc3BhY2VMZWFmLCBmaWxlOiBzdHJpbmcpIHtcblx0bGV0IHRhcmdldEZpbGU6IFRBYnN0cmFjdEZpbGUgfCBudWxsID1cblx0XHRnZXRUaGF0KCkudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGUpO1xuXHRpZiAodGFyZ2V0RmlsZSAmJiB0YXJnZXRGaWxlIGluc3RhbmNlb2YgVEZpbGUpXG5cdFx0YXdhaXQgbGVhZi5vcGVuRmlsZSh0YXJnZXRGaWxlLCB7IGFjdGl2ZTogZmFsc2UgfSk7XG59XG4iLCAiaW1wb3J0IHtcblx0c3RhdGUsXG5cdHVwZGF0ZUN1cnNvcixcblx0dXBkYXRlSG92ZXIsXG5cdGdldEN1cnNvcixcblx0Z2V0SG92ZXIsXG5cdHJlc2V0SG92ZXIsXG5cdHJlc2V0Q3Vyc29yLFxuXHRnZXRUaGF0LFxuXHRnZXRCYWNrbGlua0hvdmVyLFxuXHR1cGRhdGVCYWNrbGlua0hvdmVyLFxuXHRyZXNldEJhY2tsaW5rSG92ZXIsXG5cdHVwZGF0ZUhvdmVyZWRDdXJzb3IsXG59IGZyb20gXCIuL3N0YXRlXCI7XG5pbXBvcnQgeyBBQ1RJT05fVFlQRSwgUkVGRVJFTkNFX1JFR0VYIH0gZnJvbSBcIi4vY29uc3RhbnRzXCI7XG5pbXBvcnQge1xuXHRjb2xsZWN0TGVhdmVzQnlUYWJIZWxwZXIsXG5cdGdldEN1cnJlbnRUYWJJbmRleCxcblx0b3BlbkZpbGVJbkFkamFjZW50VGFiLFxufSBmcm9tIFwiLi93b3Jrc3BhY2VcIjtcbmltcG9ydCB7IHByb2Nlc3NVUkksIGZpbmRUZXh0UG9zaXRpb25zIH0gZnJvbSBcIi4vdXRpbHNcIjtcbmltcG9ydCB7IE1hcmtkb3duVmlldywgV29ya3NwYWNlLCBXb3Jrc3BhY2VMZWFmIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQge1xuXHRkZWZhdWx0SGlnaGxpZ2h0U2VsZWN0aW9uLFxuXHRoaWdobGlnaHRTZWxlY3Rpb24sXG5cdHJlbW92ZUhpZ2hsaWdodCxcblx0cmVtb3ZlSGlnaGxpZ2h0cyxcbn0gZnJvbSBcIi4vbWFya1wiO1xuaW1wb3J0IHsgRWRpdG9yVmlldyB9IGZyb20gXCJAY29kZW1pcnJvci92aWV3XCI7XG5pbXBvcnQge1xuXHRnZXRCYWNrbGlua0NvbnRhaW5lcixcblx0Z2V0Q29udGFpbmVyRWxlbWVudCxcblx0Z2V0TWFya2Rvd25WaWV3LFxufSBmcm9tIFwiLi9yZWZlcmVuY2VzXCI7XG5cbmZ1bmN0aW9uIGdldEVkaXRvclZpZXcobGVhZjogV29ya3NwYWNlTGVhZikge1xuXHRpZiAoIWxlYWYpIHJldHVybiBudWxsO1xuXHRjb25zdCB2aWV3ID0gbGVhZi52aWV3O1xuXG5cdC8vIEB0cy1pZ25vcmVcblx0Y29uc3QgZWRpdG9yID0gdmlldy5zb3VyY2VNb2RlPy5jbUVkaXRvcjtcblxuXHQvLyAnZWRpdG9yJyBoZXJlIGlzIGFuIGluc3RhbmNlIG9mICdFZGl0b3InLCBhbiBhYnN0cmFjdGlvbiBvdmVyIENNNSBhbmQgQ002LlxuXHQvLyBDaGVja2luZyBmb3IgJ0NvZGVNaXJyb3InIHdvdWxkIGluZGljYXRlIENNNS5cblx0aWYgKCFlZGl0b3IuQ29kZU1pcnJvciAmJiBlZGl0b3IuY20gaW5zdGFuY2VvZiBFZGl0b3JWaWV3KSB7XG5cdFx0Ly8gWW91IG5vdyBoYXZlIGFjY2VzcyB0byB0aGUgQ29kZU1pcnJvciA2IEVkaXRvclZpZXcgaW5zdGFuY2UuXG5cdFx0Y29uc3QgZWRpdG9yVmlldyA9IGVkaXRvci5jbTtcblxuXHRcdHJldHVybiBlZGl0b3JWaWV3O1xuXG5cdFx0Ly8gWW91IGNhbiBub3cgdXNlIHRoZSBDb2RlTWlycm9yIDYgQVBJIHdpdGggYGVkaXRvclZpZXdgLlxuXHR9XG5cdHJldHVybiBudWxsO1xufVxuXG5mdW5jdGlvbiBjaGVja1NwYW5FbGVtZW50RXhpc3RzKFxuXHRzcGFuOiBIVE1MU3BhbkVsZW1lbnQsXG5cdGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudFxuKTogYm9vbGVhbiB7XG5cdGNvbnN0IHNwYW5FbGVtZW50cyA9IGNvbnRhaW5lckVsLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwic3BhblwiKTtcblx0Zm9yIChsZXQgaSA9IDA7IGkgPCBzcGFuRWxlbWVudHMubGVuZ3RoOyBpKyspIHtcblx0XHRpZiAoc3BhbkVsZW1lbnRzW2ldID09PSBzcGFuKSB7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cdH1cblx0cmV0dXJuIGZhbHNlO1xufVxuXG5mdW5jdGlvbiBwYXJzZUNTU1N0cmluZyhjc3M6IHN0cmluZykge1xuXHQvLyBVc2UgYSByZWd1bGFyIGV4cHJlc3Npb24gdG8gbWF0Y2gga2V5LXZhbHVlIHBhaXJzIGluIHRoZSBDU1Mgc3RyaW5nXG5cdGNvbnN0IGNzc1Byb3BlcnRpZXNSZWdleCA9IC8oW1xcdy1dKylcXHMqOlxccyooW147XSspXFxzKjs/L2c7XG5cblx0Ly8gSW5pdGlhbGl6ZSBhbiBlbXB0eSBvYmplY3QgdG8gc3RvcmUgdGhlIENTUyBwcm9wZXJ0aWVzXG5cdGxldCBjc3NQcm9wZXJ0aWVzT2JqZWN0OiBhbnkgPSB7fTtcblxuXHQvLyBJdGVyYXRlIG92ZXIgYWxsIGtleS12YWx1ZSBwYWlycyBmb3VuZCBieSB0aGUgcmVnZXhcblx0bGV0IG1hdGNoO1xuXHR3aGlsZSAoKG1hdGNoID0gY3NzUHJvcGVydGllc1JlZ2V4LmV4ZWMoY3NzKSkgIT09IG51bGwpIHtcblx0XHQvLyBtYXRjaFsxXSBpcyB0aGUga2V5XG5cdFx0Ly8gbWF0Y2hbMl0gaXMgdGhlIHZhbHVlXG5cdFx0Y3NzUHJvcGVydGllc09iamVjdFttYXRjaFsxXV0gPSBtYXRjaFsyXTtcblx0fVxuXG5cdHJldHVybiBjc3NQcm9wZXJ0aWVzT2JqZWN0O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGVsYXkobWlsbGlzZWNvbmRzOiBhbnkpIHtcblx0cmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG5cdFx0c2V0VGltZW91dChyZXNvbHZlLCBtaWxsaXNlY29uZHMpO1xuXHR9KTtcbn1cblxuZnVuY3Rpb24gdGVtcERpcmVjdGlvbkluZGljYXRvcihcblx0bGVhZjogYW55LFxuXHR0ZXh0OiBzdHJpbmcsXG5cdHByZWZpeDogc3RyaW5nLFxuXHRzdWZmaXg6IHN0cmluZyxcblx0ZGF0YVN0cmluZzogc3RyaW5nLFxuXHRpc1NhbWU6IGJvb2xlYW4sXG5cdHVzZXI/OiBzdHJpbmdcbikge1xuXHRpZiAodXNlciA9PT0gQUNUSU9OX1RZUEUuQkFDS0xJTkspIHtcblx0XHQvLyBPaCEgSVx1MjAxOWQgY29tcGFyZSB0aGUgYmJveCBvZiB0aGUgcmFuZ2Vcblx0XHQvLyAod2hpY2ggSSBrbm93IHlvdSBmaW5kIGluIHRoZSBtYXJrIGxheW91dCByb3V0aW5lKVxuXHRcdC8vIHRvIHRoZSBzY3JvbGxUb3AgKyBpbm5lckhlaWdodFxuXHRcdGNvbnN0IGVkaXRvciA9IGdldE1hcmtkb3duVmlldyhsZWFmKS5lZGl0b3I7XG5cdFx0Y29uc3QgYmFja2xpbmtDb250YWluZXIgPSBnZXRCYWNrbGlua0NvbnRhaW5lcihlZGl0b3IpO1xuXG5cdFx0Y29uc3Qgd2luZG93SGVpZ2h0ID0gbGVhZi52aWV3LmNvbnRhaW5lckVsXG5cdFx0XHQucXVlcnlTZWxlY3RvcihcIi5jbS1zY3JvbGxlclwiKVxuXHRcdFx0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmhlaWdodDtcblx0XHRjb25zdCBzY3JvbGxUb3AgPVxuXHRcdFx0bGVhZi52aWV3LmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoXCIuY20tc2Nyb2xsZXJcIikuc2Nyb2xsVG9wO1xuXHRcdGNvbnN0IHNjcm9sbEJvdHRvbSA9IHNjcm9sbFRvcCArIHdpbmRvd0hlaWdodDtcblxuXHRcdC8vIEdldCB0aGUgZWxlbWVudHMgdGhhdCBhcmUgYmV0d2VlbiB0aGUgdG9wIGFuZCBib3R0b20gb2YgdGhlIHNjcmVlblxuXHRcdC8vIEB0cy1pZ25vcmVcblx0XHRsZXQgY29udGFpbmVyID0gZWRpdG9yLmNvbnRhaW5lckVsO1xuXHRcdGxldCBjb250ZW50ID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCIuY20tY29udGVudFwiKTtcblx0XHRsZXQgcmVmZXJlbmNlcyA9IGNvbnRlbnQucXVlcnlTZWxlY3RvckFsbChcIi5yZWZlcmVuY2UtZGF0YS1zcGFuXCIpO1xuXG5cdFx0bGV0IHZpc2libGVFbGVtZW50czogSFRNTEVsZW1lbnRbXSA9IFtdO1xuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgcmVmZXJlbmNlcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0bGV0IGJib3ggPSByZWZlcmVuY2VzW2ldLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXHRcdFx0aWYgKGJib3gudG9wID49IHNjcm9sbFRvcCAmJiBiYm94LmJvdHRvbSA8PSBzY3JvbGxCb3R0b20pIHtcblx0XHRcdFx0dmlzaWJsZUVsZW1lbnRzLnB1c2gocmVmZXJlbmNlc1tpXSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0bGV0IGRhdGFTdHJpbmdzID0gdmlzaWJsZUVsZW1lbnRzLm1hcCgoZWw6IEhUTUxFbGVtZW50KSA9PlxuXHRcdFx0ZWwuZ2V0QXR0cmlidXRlKFwiZGF0YVwiKVxuXHRcdCk7XG5cblx0XHRsZXQgc3RhcnRUb3AgPSBsZWFmLnZpZXcuZWRpdG9yLmdldFNjcm9sbEluZm8oKS50b3A7XG5cblx0XHRpZiAoIWRhdGFTdHJpbmdzLmluY2x1ZGVzKGRhdGFTdHJpbmcpKSB7XG5cdFx0XHRsZXQgcG9zaXRpb25zID0gZmluZFRleHRQb3NpdGlvbnMoXG5cdFx0XHRcdGxlYWYudmlldy5kYXRhLFxuXHRcdFx0XHR0ZXh0LFxuXHRcdFx0XHRwcmVmaXguc2xpY2UoMCwgcHJlZml4Lmxlbmd0aCAtIDEpLFxuXHRcdFx0XHRzdWZmaXguc2xpY2UoMSwgc3VmZml4Lmxlbmd0aClcblx0XHRcdCk7XG5cdFx0XHRpZiAoIXBvc2l0aW9ucykgdGhyb3cgbmV3IEVycm9yKFwiUG9zaXRpb25zIG5vdCBmb3VuZFwiKTtcblx0XHRcdGxldCByYW5nZVN0YXJ0ID0gcG9zaXRpb25zLnJhbmdlU3RhcnQ7XG5cdFx0XHRsZXQgcmFuZ2VFbmQgPSBwb3NpdGlvbnMucmFuZ2VFbmQ7XG5cblx0XHRcdGxlYWYudmlldy5lZGl0b3Iuc2Nyb2xsSW50b1ZpZXcoXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRmcm9tOiBPYmplY3QuYXNzaWduKHJhbmdlU3RhcnQsIHsgY2g6IDAgfSksXG5cdFx0XHRcdFx0dG86IE9iamVjdC5hc3NpZ24ocmFuZ2VFbmQsIHsgY2g6IDAgfSksXG5cdFx0XHRcdH0sXG5cdFx0XHRcdHRydWVcblx0XHRcdCk7XG5cdFx0fVxuXG5cdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHQvLyBpZiAodGVtcCkgcmV0dXJuO1xuXHRcdFx0bGV0IGVuZFRvcCA9IGxlYWYudmlldy5lZGl0b3IuZ2V0U2Nyb2xsSW5mbygpLnRvcDtcblxuXHRcdFx0bGV0IGNvbnRhaW5lciA9IGxlYWYuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvcihcIi52aWV3LWNvbnRlbnRcIik7XG5cdFx0XHRjb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZShcIm5vLXNoYWRvd1wiKTtcblx0XHRcdGNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKFwibmV3LXNoYWRvd1wiKTtcblx0XHRcdGNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKFwidG9wLXNoYWRvd1wiKTtcblx0XHRcdGNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKFwiYm90dG9tLXNoYWRvd1wiKTtcblxuXHRcdFx0aWYgKHN0YXJ0VG9wID09PSBlbmRUb3AgJiYgaXNTYW1lKSB7XG5cdFx0XHRcdGNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwibm8tc2hhZG93XCIpO1xuXHRcdFx0fSBlbHNlIGlmIChzdGFydFRvcCA9PT0gZW5kVG9wICYmICFpc1NhbWUpIHtcblx0XHRcdFx0Y29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJuZXctc2hhZG93XCIpO1xuXHRcdFx0fSBlbHNlIGlmIChzdGFydFRvcCA8IGVuZFRvcCkge1xuXHRcdFx0XHQvLyBzaG93IG1hcmsgYWJvdmVcblx0XHRcdFx0Y29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJ0b3Atc2hhZG93XCIpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gc2hvdyBtYXJrIGJlbG93XG5cdFx0XHRcdGNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwiYm90dG9tLXNoYWRvd1wiKTtcblx0XHRcdH1cblx0XHR9LCAxMCk7XG5cblx0XHRyZXR1cm47XG5cdH1cblxuXHQvLyBPaCEgSVx1MjAxOWQgY29tcGFyZSB0aGUgYmJveCBvZiB0aGUgcmFuZ2Vcblx0Ly8gKHdoaWNoIEkga25vdyB5b3UgZmluZCBpbiB0aGUgbWFyayBsYXlvdXQgcm91dGluZSlcblx0Ly8gdG8gdGhlIHNjcm9sbFRvcCArIGlubmVySGVpZ2h0XG5cdGNvbnN0IGVkaXRvciA9IGdldE1hcmtkb3duVmlldyhsZWFmKS5lZGl0b3I7XG5cdGNvbnN0IGJhY2tsaW5rQ29udGFpbmVyID0gZ2V0QmFja2xpbmtDb250YWluZXIoZWRpdG9yKTtcblxuXHRjb25zdCB3aW5kb3dIZWlnaHQgPSBsZWFmLnZpZXcuY29udGFpbmVyRWxcblx0XHQucXVlcnlTZWxlY3RvcihcIi5jbS1zY3JvbGxlclwiKVxuXHRcdC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHQ7XG5cdGNvbnN0IHNjcm9sbFRvcCA9XG5cdFx0bGVhZi52aWV3LmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoXCIuY20tc2Nyb2xsZXJcIikuc2Nyb2xsVG9wO1xuXHRjb25zdCBzY3JvbGxCb3R0b20gPSBzY3JvbGxUb3AgKyB3aW5kb3dIZWlnaHQ7XG5cblx0Ly8gR2V0IHRoZSBlbGVtZW50cyB0aGF0IGFyZSBiZXR3ZWVuIHRoZSB0b3AgYW5kIGJvdHRvbSBvZiB0aGUgc2NyZWVuXG5cdGxldCB2aXNpYmxlRWxlbWVudHM6IHN0cmluZ1tdID0gW107XG5cdGZvciAobGV0IGkgPSAwOyBpIDwgYmFja2xpbmtDb250YWluZXIuY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcblx0XHRsZXQgc3R5bGUgPSBiYWNrbGlua0NvbnRhaW5lci5jaGlsZHJlbltpXS5nZXRBdHRyaWJ1dGUoXCJzdHlsZVwiKTtcblx0XHRpZiAoc3R5bGUgPT0gbnVsbCkgY29udGludWU7XG5cdFx0bGV0IGNzc1Byb3BlcnRpZXMgPSBwYXJzZUNTU1N0cmluZyhzdHlsZSk7XG5cdFx0bGV0IHRvcCA9IHBhcnNlRmxvYXQoY3NzUHJvcGVydGllc1tcInRvcFwiXS5yZXBsYWNlKFwicHhcIiwgXCJcIikpO1xuXHRcdGlmICh0b3AgPT0gbnVsbCkgY29udGludWU7XG5cblx0XHRpZiAoXG5cdFx0XHRzY3JvbGxUb3AgPD0gdG9wICYmXG5cdFx0XHR0b3AgPD0gc2Nyb2xsQm90dG9tICYmXG5cdFx0XHRiYWNrbGlua0NvbnRhaW5lci5jaGlsZHJlbltpXVxuXHRcdCkge1xuXHRcdFx0bGV0IHJlZmVyZW5jZSA9IGJhY2tsaW5rQ29udGFpbmVyLmNoaWxkcmVuW2ldLmdldEF0dHJpYnV0ZShcInJlZmVyZW5jZVwiKTtcblx0XHRcdGlmIChyZWZlcmVuY2UpIHtcblx0XHRcdFx0dmlzaWJsZUVsZW1lbnRzLnB1c2goSlNPTi5wYXJzZShyZWZlcmVuY2UpLmRhdGFTdHJpbmcpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdGlmICghdmlzaWJsZUVsZW1lbnRzLmluY2x1ZGVzKGRhdGFTdHJpbmcpKSB7XG5cdFx0bGV0IHN0YXJ0VG9wID0gbGVhZi52aWV3LmVkaXRvci5nZXRTY3JvbGxJbmZvKCkudG9wO1xuXG5cdFx0bGV0IHBvc2l0aW9ucyA9IGZpbmRUZXh0UG9zaXRpb25zKFxuXHRcdFx0bGVhZi52aWV3LmRhdGEsXG5cdFx0XHR0ZXh0LFxuXHRcdFx0cHJlZml4LnNsaWNlKDAsIHByZWZpeC5sZW5ndGggLSAxKSxcblx0XHRcdHN1ZmZpeC5zbGljZSgxLCBzdWZmaXgubGVuZ3RoKVxuXHRcdCk7XG5cdFx0aWYgKCFwb3NpdGlvbnMpIHRocm93IG5ldyBFcnJvcihcIlBvc2l0aW9ucyBub3QgZm91bmRcIik7XG5cdFx0bGV0IHJhbmdlU3RhcnQgPSBwb3NpdGlvbnMucmFuZ2VTdGFydDtcblx0XHRsZXQgcmFuZ2VFbmQgPSBwb3NpdGlvbnMucmFuZ2VFbmQ7XG5cblx0XHRsZWFmLnZpZXcuZWRpdG9yLnNjcm9sbEludG9WaWV3KFxuXHRcdFx0e1xuXHRcdFx0XHRmcm9tOiBPYmplY3QuYXNzaWduKHJhbmdlU3RhcnQsIHsgY2g6IDAgfSksXG5cdFx0XHRcdHRvOiBPYmplY3QuYXNzaWduKHJhbmdlRW5kLCB7IGNoOiAwIH0pLFxuXHRcdFx0fSxcblx0XHRcdHRydWVcblx0XHQpO1xuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0Ly8gaWYgKHRlbXApIHJldHVybjtcblx0XHRcdGxldCBlbmRUb3AgPSBsZWFmLnZpZXcuZWRpdG9yLmdldFNjcm9sbEluZm8oKS50b3A7XG5cdFx0XHRsZXQgY29udGFpbmVyID0gbGVhZi5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKFwiLnZpZXctY29udGVudFwiKTtcblx0XHRcdGNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKFwibm8tc2hhZG93XCIpO1xuXHRcdFx0Y29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoXCJuZXctc2hhZG93XCIpO1xuXHRcdFx0Y29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoXCJ0b3Atc2hhZG93XCIpO1xuXHRcdFx0Y29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoXCJib3R0b20tc2hhZG93XCIpO1xuXG5cdFx0XHRpZiAoc3RhcnRUb3AgPT09IGVuZFRvcCAmJiBpc1NhbWUpIHtcblx0XHRcdFx0Y29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJuby1zaGFkb3dcIik7XG5cdFx0XHR9IGVsc2UgaWYgKHN0YXJ0VG9wID09PSBlbmRUb3AgJiYgIWlzU2FtZSkge1xuXHRcdFx0XHRjb250YWluZXIuY2xhc3NMaXN0LmFkZChcIm5ldy1zaGFkb3dcIik7XG5cdFx0XHR9IGVsc2UgaWYgKHN0YXJ0VG9wIDwgZW5kVG9wKSB7XG5cdFx0XHRcdC8vIHNob3cgbWFyayBhYm92ZVxuXHRcdFx0XHRjb250YWluZXIuY2xhc3NMaXN0LmFkZChcInRvcC1zaGFkb3dcIik7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBzaG93IG1hcmsgYmVsb3dcblx0XHRcdFx0Y29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJib3R0b20tc2hhZG93XCIpO1xuXHRcdFx0fVxuXHRcdH0sIDEwKTtcblx0fVxufVxuXG5mdW5jdGlvbiBlbmRFZmZlY3RSZW1vdmVIaWdobGlnaHRzKFxuXHR3b3Jrc3BhY2U6IFdvcmtzcGFjZSxcblx0bGVhZklkOiBzdHJpbmcsXG5cdHV1aWQ6IHN0cmluZyxcblx0YmFja2xpbmtVVUlEPzogc3RyaW5nXG4pIHtcblx0Y29uc3Qgd29ya3NwYWNlQ29udGFpbmVyID0gd29ya3NwYWNlLmNvbnRhaW5lckVsO1xuXHRjb25zdCBzcGFuID0gd29ya3NwYWNlQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCIuXCIgKyB1dWlkKTtcblxuXHRzcGFuPy5wYXJlbnRFbGVtZW50XG5cdFx0Py5xdWVyeVNlbGVjdG9yKFwiLnJlZmVyZW5jZS1zcGFuXCIpXG5cdFx0Py5jbGFzc0xpc3QucmVtb3ZlKFwicmVmZXJlbmNlLXNwYW4tc2VsZWN0ZWRcIik7XG5cdC8vIGZpcnN0U3BhblBhcnQ/LmNsYXNzTGlzdC5yZW1vdmUodXVpZCk7XG5cdHNwYW4/LmNsYXNzTGlzdC5yZW1vdmUoXCJyZWZlcmVuY2UtZGF0YS1zcGFuLXNlbGVjdGVkXCIpO1xuXG5cdGlmIChiYWNrbGlua1VVSUQpIHtcblx0XHRjb25zdCBiYWNrbGlua1NwYW4gPSB3b3Jrc3BhY2VDb250YWluZXIucXVlcnlTZWxlY3RvcihcIi5cIiArIGJhY2tsaW5rVVVJRCk7XG5cblx0XHRiYWNrbGlua1NwYW4/LnBhcmVudEVsZW1lbnRcblx0XHRcdD8ucXVlcnlTZWxlY3RvcihcIi5yZWZlcmVuY2Utc3BhblwiKVxuXHRcdFx0Py5jbGFzc0xpc3QucmVtb3ZlKFwicmVmZXJlbmNlLXNwYW4tc2VsZWN0ZWRcIik7XG5cdFx0YmFja2xpbmtTcGFuPy5jbGFzc0xpc3QucmVtb3ZlKFwicmVmZXJlbmNlLWRhdGEtc3Bhbi1zZWxlY3RlZFwiKTtcblx0fVxuXG5cdGxldCB0YXJnZXRMZWFmID0gd29ya3NwYWNlLmdldExlYWZCeUlkKGxlYWZJZCk7XG5cdGlmICghdGFyZ2V0TGVhZikge1xuXHRcdHJlc2V0Q3Vyc29yKCk7XG5cdFx0dGhyb3cgbmV3IEVycm9yKFwiVGFyZ2V0IGxlYWYgbm90IGZvdW5kXCIpO1xuXHR9XG5cblx0Ly8gcmVtb3ZlIGJveCBzaGFkb3dzIGlmIGFueVxuXHRsZXQgY29udGFpbmVyID1cblx0XHRnZXRDb250YWluZXJFbGVtZW50KHRhcmdldExlYWYpPy5xdWVyeVNlbGVjdG9yKFwiLnZpZXctY29udGVudFwiKTtcblxuXHRpZiAoY29udGFpbmVyKSB7XG5cdFx0Y29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoXCJuby1zaGFkb3dcIik7XG5cdFx0Y29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoXCJuZXctc2hhZG93XCIpO1xuXHRcdGNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKFwidG9wLXNoYWRvd1wiKTtcblx0XHRjb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZShcImJvdHRvbS1zaGFkb3dcIik7XG5cdH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHN0YXJ0QmFja2xpbmtFZmZlY3Qoc3BhbjogSFRNTFNwYW5FbGVtZW50KSB7XG5cdGxldCBzb3VyY2UgPSBnZXRCYWNrbGlua0hvdmVyKCk7XG5cdGxldCBkZXN0aW5hdGlvbiA9IGdldEN1cnNvcigpO1xuXHRsZXQgdXBkYXRlU3RhdGUgPSB1cGRhdGVCYWNrbGlua0hvdmVyO1xuXG5cdC8vIE11dGV4LCBwcmV2ZW50IGNvbmN1cnJlbnQgYWNjZXNzIHRvIGZvbGxvd2luZyBzZWN0aW9uIG9mIGNvZGVcblx0aWYgKHNvdXJjZSAhPSBudWxsKSByZXR1cm47XG5cdHVwZGF0ZVN0YXRlKHtcblx0XHR0eXBlOiBgJHtBQ1RJT05fVFlQRS5CQUNLTElOS30tc3RhcnRgLFxuXHR9KTtcblxuXHRpZiAoIXNwYW4pIHJldHVybjtcblxuXHQvLyBUb2dnbGUgaG92ZXIgc3RhdGVcblx0bGV0IHV1aWQgPSBBcnJheS5mcm9tKHNwYW4uY2xhc3NMaXN0KS5maWx0ZXIoKGVsKSA9PiBlbC5pbmNsdWRlcyhcInV1aWRcIikpWzBdO1xuXHRzcGFuLnBhcmVudEVsZW1lbnRcblx0XHQ/LnF1ZXJ5U2VsZWN0b3IoXCIucmVmZXJlbmNlLXNwYW5cIilcblx0XHQ/LmNsYXNzTGlzdC5hZGQoXCJyZWZlcmVuY2Utc3Bhbi1zZWxlY3RlZFwiKTtcblxuXHRzcGFuLmNsYXNzTGlzdC5hZGQoXCJyZWZlcmVuY2UtZGF0YS1zcGFuLXNlbGVjdGVkXCIpO1xuXG5cdHVwZGF0ZVN0YXRlKHtcblx0XHR1dWlkLFxuXHR9KTtcblxuXHRjb25zdCByZWZlcmVuY2VEYXRhID0gc3Bhbi5nZXRBdHRyaWJ1dGUoXCJyZWZlcmVuY2VcIik7XG5cdGlmICghcmVmZXJlbmNlRGF0YSkgdGhyb3cgbmV3IEVycm9yKFwiUmVmZXJlbmNlIGRhdGEgbm90IGZvdW5kXCIpO1xuXG5cdGNvbnN0IGJhY2tsaW5rID0gSlNPTi5wYXJzZShyZWZlcmVuY2VEYXRhKTtcblx0Y29uc3QgZGF0YVN0cmluZyA9IGJhY2tsaW5rLmRhdGFTdHJpbmc7XG5cblx0Ly8gQ2hlY2sgaWYgdGhlIGN1cnNvciBpcyBhbHJlYWR5IG9uIHRoZSBzYW1lIHJlZmVyZW5jZVxuXHRpZiAoZGVzdGluYXRpb24gIT0gbnVsbCAmJiBkZXN0aW5hdGlvbi5kYXRhU3RyaW5nID09IGRhdGFTdHJpbmcpIHtcblx0XHR1cGRhdGVTdGF0ZShkZXN0aW5hdGlvbik7XG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0bGV0IFtwcmVmaXgsIHRleHQsIHN1ZmZpeCwgZmlsZSwgZnJvbSwgdG9dID0gcHJvY2Vzc1VSSShkYXRhU3RyaW5nKTtcblxuXHQvLyBnZXQgYmFja2xpbmsgbGVhZlxuXHRsZXQgbGVhdmVzQnlUYWIgPSBjb2xsZWN0TGVhdmVzQnlUYWJIZWxwZXIoKTtcblxuXHRsZXQgY3VyclRhYklkeCA9IGdldEN1cnJlbnRUYWJJbmRleChsZWF2ZXNCeVRhYiwgc3Bhbik7XG5cblx0bGV0IGJhY2tsaW5rTGVhZiA9IGxlYXZlc0J5VGFiW2N1cnJUYWJJZHhdLmZpbHRlcigobGVhZjogV29ya3NwYWNlTGVhZikgPT4ge1xuXHRcdGxldCBjb250YWluZXJFbCA9IGdldENvbnRhaW5lckVsZW1lbnQobGVhZik7XG5cdFx0Y29uc3QgZXhpc3RzID0gY2hlY2tTcGFuRWxlbWVudEV4aXN0cyhzcGFuLCBjb250YWluZXJFbCk7XG5cdFx0cmV0dXJuIGV4aXN0cztcblx0fSlbMF07XG5cblx0Ly8gQHRzLWlnbm9yZVxuXHRsZXQgYmFja2xpbmtMZWFmSUQgPSBiYWNrbGlua0xlYWYuaWQ7XG5cdGlmICghYmFja2xpbmtMZWFmSUQpIHRocm93IG5ldyBFcnJvcihcIkxlYWYgaWQgbm90IGZvdW5kXCIpO1xuXG5cdGlmIChiYWNrbGlua0xlYWYgJiYgYmFja2xpbmtMZWFmLnZpZXcgaW5zdGFuY2VvZiBNYXJrZG93blZpZXcpIHtcblx0XHRjb25zdCBlZGl0b3JWaWV3OiBFZGl0b3JWaWV3ID0gZ2V0RWRpdG9yVmlldyhiYWNrbGlua0xlYWYpO1xuXHRcdGlmICghZWRpdG9yVmlldykgdGhyb3cgbmV3IEVycm9yKFwiRWRpdG9yIHZpZXcgbm90IGZvdW5kXCIpO1xuXHRcdGNvbnN0IHZpZXdwb3J0ID0gYmFja2xpbmtMZWFmLnZpZXcuZWRpdG9yLmdldFNjcm9sbEluZm8oKTtcblxuXHRcdHJlbW92ZUhpZ2hsaWdodChlZGl0b3JWaWV3LCBmcm9tLCB0byk7XG5cdFx0aGlnaGxpZ2h0U2VsZWN0aW9uKGVkaXRvclZpZXcsIGZyb20sIHRvKTtcblx0XHQvLyBsZXQgcG9zaXRpb25zID0gZmluZFRleHRQb3NpdGlvbnMoXG5cdFx0Ly8gXHRiYWNrbGlua0xlYWYudmlldy5kYXRhLFxuXHRcdC8vIFx0dGV4dCxcblx0XHQvLyBcdHByZWZpeC5zbGljZSgwLCBwcmVmaXgubGVuZ3RoIC0gMSksXG5cdFx0Ly8gXHRzdWZmaXguc2xpY2UoMSwgc3VmZml4Lmxlbmd0aClcblx0XHQvLyApO1xuXHRcdC8vIGlmICghcG9zaXRpb25zKSB0aHJvdyBuZXcgRXJyb3IoXCJQb3NpdGlvbnMgbm90IGZvdW5kXCIpO1xuXG5cdFx0dXBkYXRlU3RhdGUoe1xuXHRcdFx0ZGF0YVN0cmluZyxcblx0XHRcdG9yaWdpbmFsVG9wOiBlZGl0b3JWaWV3LmRvY3VtZW50VG9wLFxuXHRcdFx0YmFja2xpbmtMZWFmSWQ6IGJhY2tsaW5rTGVhZklELFxuXHRcdH0pO1xuXHR9XG5cblx0bGV0IHJlZmVyZW5jaW5nRmlsZSA9IGJhY2tsaW5rLnJlZmVyZW5jaW5nTG9jYXRpb24uZmlsZW5hbWU7XG5cblx0Ly8gaWYgKGN1cnJUYWJJZHggIT0gLTEpIHtcblx0Ly8gJiYgY3VyclRhYiAhPSAtMSkge1xuXHQvLyAvLyBDaGVjayBhZGphY2VudCB0YWJzIGZvciBmaWxlIGFuZCBvcGVuIGZpbGUgaWYgbmVlZGVkXG5cdGNvbnN0IHsgbmV3TGVhZiwgdGVtcCwgb3JpZ2luYWxMZWFmIH0gPSBhd2FpdCBvcGVuRmlsZUluQWRqYWNlbnRUYWIoXG5cdFx0bGVhdmVzQnlUYWIsXG5cdFx0Y3VyclRhYklkeCxcblx0XHRyZWZlcmVuY2luZ0ZpbGVcblx0KTtcblxuXHQvLyBAdHMtaWdub3JlXG5cdGxldCBpZCA9IG5ld0xlYWYuaWQ7XG5cdGlmICghaWQpIHRocm93IG5ldyBFcnJvcihcIkxlYWYgaWQgbm90IGZvdW5kXCIpO1xuXHR1cGRhdGVTdGF0ZSh7XG5cdFx0bGVhZklkOiBpZCxcblx0XHR0ZW1wLFxuXHRcdHBlZWs6IHRydWUsXG5cdH0pO1xuXG5cdGNvbnN0IG9yaWdpbmFsTGVhZklkID0gb3JpZ2luYWxMZWFmLmlkO1xuXG5cdGNvbnN0IG1hdGNoZXMgPSBbXG5cdFx0Li4uYmFja2xpbmsucmVmZXJlbmNpbmdMb2NhdGlvbi50ZXh0Lm1hdGNoQWxsKFJFRkVSRU5DRV9SRUdFWCksXG5cdF07XG5cdGlmIChtYXRjaGVzLmxlbmd0aCA9PSAwKSB0aHJvdyBuZXcgRXJyb3IoXCJNYXRjaGVzIG5vdCBmb3VuZFwiKTtcblx0Ly8gVGhpcyBvbmUgc3dpdGNoLCB0aGlzIG9uZSBkb2VzIHRoZSBjb3JyZWN0IHNjcm9sbFxuXHQvLyB0ZW1wRGlyZWN0aW9uSW5kaWNhdG9yKG5ld0xlYWYsIHRleHQsIHByZWZpeCwgc3VmZml4LCBkYXRhU3RyaW5nKTtcblxuXHQvLyBUaGlzIG9uZSBkb2VzIHRoZSBjb3JyZWN0IGdyYWJiaW5nIG9mIHNwYW4gZWxlbWVudHNcblx0dGVtcERpcmVjdGlvbkluZGljYXRvcihcblx0XHRuZXdMZWFmLFxuXHRcdGJhY2tsaW5rLnJlZmVyZW5jaW5nTG9jYXRpb24udGV4dCxcblx0XHRiYWNrbGluay5yZWZlcmVuY2luZ0xvY2F0aW9uLnByZWZpeCArIFwiLVwiLFxuXHRcdFwiLVwiICsgYmFja2xpbmsucmVmZXJlbmNpbmdMb2NhdGlvbi5zdWZmaXgsXG5cdFx0bWF0Y2hlc1swXVsxXSxcblx0XHRpZCA9PT0gb3JpZ2luYWxMZWFmSWQsXG5cdFx0QUNUSU9OX1RZUEUuQkFDS0xJTktcblx0KTtcblxuXHRjb25zdCBjdXJzb3JWaWV3cG9ydCA9IG5ld0xlYWYudmlldy5lZGl0b3IuZ2V0U2Nyb2xsSW5mbygpO1xuXG5cdHVwZGF0ZVN0YXRlKHtcblx0XHRjdXJzb3JWaWV3cG9ydCxcblx0fSk7XG5cblx0bGV0IGJhY2tsaW5rU3BhbjogSFRNTFNwYW5FbGVtZW50ID0gbmV3TGVhZi5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKFxuXHRcdGBzcGFuW2RhdGE9XCIke2JhY2tsaW5rLmRhdGFTdHJpbmd9XCJdYFxuXHQpO1xuXG5cdC8vIENhbid0IGd1YXJhbnRlZSB0aGF0IHRoaXMgd2lsbCBiZSB2aXNpYmxlLlxuXHRpZiAoYmFja2xpbmtTcGFuKSB7XG5cdFx0bGV0IGJhY2tsaW5rVVVJRCA9IEFycmF5LmZyb20oYmFja2xpbmtTcGFuLmNsYXNzTGlzdCkuZmlsdGVyKChlbCkgPT5cblx0XHRcdGVsLmluY2x1ZGVzKFwidXVpZFwiKVxuXHRcdClbMF07XG5cdFx0YmFja2xpbmtTcGFuLnBhcmVudEVsZW1lbnRcblx0XHRcdD8ucXVlcnlTZWxlY3RvcihcIi5yZWZlcmVuY2Utc3BhblwiKVxuXHRcdFx0Py5jbGFzc0xpc3QuYWRkKFwicmVmZXJlbmNlLXNwYW4tc2VsZWN0ZWRcIik7XG5cblx0XHRiYWNrbGlua1NwYW4uY2xhc3NMaXN0LmFkZChcInJlZmVyZW5jZS1kYXRhLXNwYW4tc2VsZWN0ZWRcIik7XG5cblx0XHR1cGRhdGVTdGF0ZSh7XG5cdFx0XHRiYWNrbGlua1VVSUQsXG5cdFx0fSk7XG5cdH1cblxuXHQvLyBAdHMtaWdub3JlXG5cdGlmIChvcmlnaW5hbExlYWZJZCkge1xuXHRcdHVwZGF0ZVN0YXRlKHtcblx0XHRcdG9yaWdpbmFsTGVhZklkLFxuXHRcdH0pO1xuXHR9XG5cblx0cmV0dXJuO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc3RhcnRSZWZlcmVuY2VFZmZlY3QoXG5cdHNwYW46IEhUTUxTcGFuRWxlbWVudCB8IG51bGwgfCB1bmRlZmluZWQsXG5cdHR5cGU6IHN0cmluZ1xuKSB7XG5cdGxldCBzb3VyY2UgPSB0eXBlID09IEFDVElPTl9UWVBFLk1PVVNFID8gZ2V0SG92ZXIoKSA6IGdldEN1cnNvcigpO1xuXHRsZXQgZGVzdGluYXRpb24gPSB0eXBlID09IEFDVElPTl9UWVBFLk1PVVNFID8gZ2V0Q3Vyc29yKCkgOiBnZXRIb3ZlcigpO1xuXHRsZXQgdXBkYXRlU3RhdGUgPSB0eXBlID09IEFDVElPTl9UWVBFLk1PVVNFID8gdXBkYXRlSG92ZXIgOiB1cGRhdGVDdXJzb3I7XG5cblx0Ly8gTXV0ZXgsIHByZXZlbnQgY29uY3VycmVudCBhY2Nlc3MgdG8gZm9sbG93aW5nIHNlY3Rpb24gb2YgY29kZVxuXHRpZiAoc291cmNlICE9IG51bGwpIHtcblx0XHRpZiAoQUNUSU9OX1RZUEUuQ1VSU09SID09IHR5cGUpIHtcblx0XHRcdC8vIGlmIHRoZXJlIHdhcyBhbm90aGVyIGN1cnNvciBlZmZlY3QsIGVuZCBpdCBhbmQgc3RhcnQgYSBuZXcgb25lXG5cdFx0XHRhd2FpdCBlbmRSZWZlcmVuY2VDdXJzb3JFZmZlY3QoKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0fVxuXHR1cGRhdGVTdGF0ZSh7XG5cdFx0dHlwZTogYCR7dHlwZX0tc3RhcnRgLFxuXHR9KTtcblxuXHRpZiAoIXNwYW4pIHJldHVybjtcblxuXHRsZXQgdXVpZCA9IEFycmF5LmZyb20oc3Bhbi5jbGFzc0xpc3QpLmZpbHRlcigoZWwpID0+IGVsLmluY2x1ZGVzKFwidXVpZFwiKSlbMF07XG5cdHNwYW4ucGFyZW50RWxlbWVudFxuXHRcdD8ucXVlcnlTZWxlY3RvcihcIi5yZWZlcmVuY2Utc3BhblwiKVxuXHRcdD8uY2xhc3NMaXN0LmFkZChcInJlZmVyZW5jZS1zcGFuLXNlbGVjdGVkXCIpO1xuXG5cdHNwYW4uY2xhc3NMaXN0LmFkZChcInJlZmVyZW5jZS1kYXRhLXNwYW4tc2VsZWN0ZWRcIik7XG5cblx0dXBkYXRlU3RhdGUoe1xuXHRcdHV1aWQsXG5cdH0pO1xuXG5cdGNvbnN0IGRhdGFTdHJpbmcgPSBzcGFuLmdldEF0dHJpYnV0ZShcImRhdGFcIik7XG5cdGlmICghZGF0YVN0cmluZykgdGhyb3cgbmV3IEVycm9yKFwiRGF0YSBzdHJpbmcgbm90IGZvdW5kXCIpO1xuXG5cdGlmIChcblx0XHRkZXN0aW5hdGlvbiAhPSBudWxsICYmXG5cdFx0ZGVzdGluYXRpb24uZGF0YVN0cmluZyA9PSBkYXRhU3RyaW5nICYmXG5cdFx0QUNUSU9OX1RZUEUuQ1VSU09SICE9IHR5cGVcblx0KSB7XG5cdFx0dXBkYXRlSG92ZXIoZGVzdGluYXRpb24pO1xuXHRcdHJldHVybjtcblx0fVxuXG5cdGxldCBbcHJlZml4LCB0ZXh0LCBzdWZmaXgsIGZpbGUsIGZyb20sIHRvXSA9IHByb2Nlc3NVUkkoZGF0YVN0cmluZyk7XG5cblx0bGV0IGxlYXZlc0J5VGFiID0gY29sbGVjdExlYXZlc0J5VGFiSGVscGVyKCk7XG5cblx0bGV0IGN1cnJUYWJJZHggPSBnZXRDdXJyZW50VGFiSW5kZXgobGVhdmVzQnlUYWIsIHNwYW4pO1xuXG5cdGxldCBjdXJyTGVhZiA9IGdldFRoYXQoKS53b3Jrc3BhY2UuZ2V0TGVhZigpO1xuXG5cdC8vIEB0cy1pZ25vcmVcblx0bGV0IGN1cnJMZWFmSUQgPSBjdXJyTGVhZi5pZDtcblx0aWYgKCFjdXJyTGVhZklEKSB0aHJvdyBuZXcgRXJyb3IoXCJjdXJyTGVhZklEIGlkIG5vdCBmb3VuZFwiKTtcblxuXHRjb25zdCB7IG5ld0xlYWYsIHRlbXAsIG9yaWdpbmFsTGVhZiB9ID0gYXdhaXQgb3BlbkZpbGVJbkFkamFjZW50VGFiKFxuXHRcdGxlYXZlc0J5VGFiLFxuXHRcdGN1cnJUYWJJZHgsXG5cdFx0ZmlsZSxcblx0XHR0eXBlXG5cdCk7XG5cblx0Ly8gQHRzLWlnbm9yZVxuXHRsZXQgaWQgPSBuZXdMZWFmLmlkO1xuXHRpZiAoIWlkKSB0aHJvdyBuZXcgRXJyb3IoXCJMZWFmIGlkIG5vdCBmb3VuZFwiKTtcblx0dXBkYXRlU3RhdGUoe1xuXHRcdGxlYWZJZDogaWQsXG5cdFx0dGVtcCxcblx0XHRwZWVrOiB0cnVlLFxuXHR9KTtcblxuXHQvLyBAdHMtaWdub3JlXG5cdGNvbnN0IG9yaWdpbmFsTGVhZklkID0gb3JpZ2luYWxMZWFmLmlkO1xuXG5cdGlmIChuZXdMZWFmICYmIG5ld0xlYWYudmlldyBpbnN0YW5jZW9mIE1hcmtkb3duVmlldykge1xuXHRcdGNvbnN0IGVkaXRvclZpZXc6IEVkaXRvclZpZXcgPSBnZXRFZGl0b3JWaWV3KG5ld0xlYWYpO1xuXHRcdGlmICghZWRpdG9yVmlldykgdGhyb3cgbmV3IEVycm9yKFwiRWRpdG9yIHZpZXcgbm90IGZvdW5kXCIpO1xuXHRcdGNvbnN0IHZpZXdwb3J0ID0gbmV3TGVhZi52aWV3LmVkaXRvci5nZXRTY3JvbGxJbmZvKCk7XG5cblx0XHRyZW1vdmVIaWdobGlnaHQoZWRpdG9yVmlldywgZnJvbSwgdG8pO1xuXHRcdGhpZ2hsaWdodFNlbGVjdGlvbihlZGl0b3JWaWV3LCBmcm9tLCB0byk7XG5cblx0XHR0ZW1wRGlyZWN0aW9uSW5kaWNhdG9yKFxuXHRcdFx0bmV3TGVhZixcblx0XHRcdHRleHQsXG5cdFx0XHRwcmVmaXgsXG5cdFx0XHRzdWZmaXgsXG5cdFx0XHRkYXRhU3RyaW5nLFxuXHRcdFx0aWQgPT09IG9yaWdpbmFsTGVhZklkXG5cdFx0KTtcblxuXHRcdGNvbnN0IGN1cnNvclZpZXdwb3J0ID0gbmV3TGVhZi52aWV3LmVkaXRvci5nZXRTY3JvbGxJbmZvKCk7XG5cblx0XHR1cGRhdGVTdGF0ZSh7XG5cdFx0XHRkYXRhU3RyaW5nLFxuXHRcdFx0b3JpZ2luYWxUb3A6IGVkaXRvclZpZXcuZG9jdW1lbnRUb3AsXG5cdFx0XHQvLyBvcmlnaW5hbExlYWZJZDogY3VyckxlYWZJRCxcblx0XHRcdGN1cnNvclZpZXdwb3J0LFxuXHRcdH0pO1xuXHR9XG5cblx0aWYgKG9yaWdpbmFsTGVhZklkKSB7XG5cdFx0dXBkYXRlU3RhdGUoe1xuXHRcdFx0b3JpZ2luYWxMZWFmSWQsXG5cdFx0fSk7XG5cdH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGVuZFJlZmVyZW5jZUN1cnNvckVmZmVjdCgpIHtcblx0aWYgKCFnZXRDdXJzb3IoKSB8fCBPYmplY3Qua2V5cyhnZXRDdXJzb3IoKSkubGVuZ3RoID09IDApIHtcblx0XHQvLyBFbmQgbXV0ZXggbG9ja1xuXHRcdHJlc2V0Q3Vyc29yKCk7XG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0Y29uc3Qge1xuXHRcdGRhdGFTdHJpbmcsXG5cdFx0bGVhZklkLFxuXHRcdG9yaWdpbmFsTGVhZklkLFxuXHRcdHRlbXAsXG5cdFx0Y3Vyc29yVmlld3BvcnQsXG5cdFx0cGVlayxcblx0XHR1dWlkLFxuXHR9ID0gZ2V0Q3Vyc29yKCk7XG5cdHJlc2V0Q3Vyc29yKCk7XG5cblx0aWYgKGdldEhvdmVyKCkgIT0gbnVsbCAmJiBnZXRIb3ZlcigpLmRhdGFTdHJpbmcgPT0gZGF0YVN0cmluZykge1xuXHRcdC8vIEVuZCBtdXRleCBsb2NrXG5cdFx0cmVzZXRDdXJzb3IoKTtcblx0XHRyZXR1cm47XG5cdH1cblxuXHRjb25zdCB7IHdvcmtzcGFjZSB9ID0gZ2V0VGhhdCgpO1xuXHRsZXQgdGFyZ2V0TGVhZiA9IHdvcmtzcGFjZS5nZXRMZWFmQnlJZChsZWFmSWQpO1xuXHRlbmRFZmZlY3RSZW1vdmVIaWdobGlnaHRzKHdvcmtzcGFjZSwgbGVhZklkLCB1dWlkKTtcblxuXHRjb25zdCBhY3RpdmVMZWFmID0gZ2V0VGhhdCgpLndvcmtzcGFjZS5nZXRMZWFmKCk7XG5cdC8vIEB0cy1pZ25vcmUgaWRcblx0Y29uc3QgYWN0aXZlTGVhZklkID0gYWN0aXZlTGVhZi5pZDtcblxuXHRsZXQgZWRpdG9yVmlldyA9IGdldEVkaXRvclZpZXcodGFyZ2V0TGVhZik7XG5cblx0bGV0IFtwcmVmaXgsIHRleHQsIHN1ZmZpeCwgZmlsZSwgZnJvbSwgdG9dID0gcHJvY2Vzc1VSSShkYXRhU3RyaW5nKTtcblx0cmVtb3ZlSGlnaGxpZ2h0KGVkaXRvclZpZXcsIGZyb20sIHRvKTtcblx0ZGVmYXVsdEhpZ2hsaWdodFNlbGVjdGlvbihlZGl0b3JWaWV3LCBmcm9tLCB0byk7XG5cblx0Ly8gcmVtb3ZlSGlnaGxpZ2h0cyhlZGl0b3JWaWV3KTtcblxuXHRpZiAoYWN0aXZlTGVhZklkID09PSBsZWFmSWQpIHtcblx0XHRyZXNldEN1cnNvcigpO1xuXHRcdGxldCBjb250YWluZXJFbDogSFRNTEVsZW1lbnQgPSBnZXRDb250YWluZXJFbGVtZW50KHRhcmdldExlYWYpO1xuXHRcdGlmIChjb250YWluZXJFbCAhPSBudWxsKSB7XG5cdFx0XHQvLyBAdHMtaWdub3JlXG5cdFx0XHRjb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKFwiLnZpZXctY29udGVudFwiKT8uc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJcIik7XG5cdFx0fVxuXHRcdHJldHVybjtcblx0fVxuXG5cdGlmIChjdXJzb3JWaWV3cG9ydCAmJiB0YXJnZXRMZWFmICYmIHRhcmdldExlYWYudmlldyBpbnN0YW5jZW9mIE1hcmtkb3duVmlldykge1xuXHRcdGNvbnN0IHZpZXc6IE1hcmtkb3duVmlldyA9IHRhcmdldExlYWYudmlldztcblx0XHR2aWV3LmVkaXRvci5zY3JvbGxUbygwLCBjdXJzb3JWaWV3cG9ydC50b3ApO1xuXG5cdFx0Ly8gY29uc3QgcmVzdWx0ID0gYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcblx0XHQvLyBcdGNvbnN0IHNjcm9sbGluZyA9IHNldEludGVydmFsKCgpID0+IHtcblx0XHQvLyBcdFx0Y29uc3Qgc2Nyb2xsQW1vdW50ID0gNDA7XG5cdFx0Ly8gXHRcdGNvbnN0IGN1cnJlbnRTY3JvbGwgPSB2aWV3LmVkaXRvci5nZXRTY3JvbGxJbmZvKCkudG9wO1xuXHRcdC8vIFx0XHRpZiAoY3VycmVudFNjcm9sbCA9PSBjdXJzb3JWaWV3cG9ydC50b3ApIHtcblx0XHQvLyBcdFx0XHRjbGVhckludGVydmFsKHNjcm9sbGluZyk7XG5cdFx0Ly8gXHRcdH0gZWxzZSBpZiAoY3VycmVudFNjcm9sbCA+IGN1cnNvclZpZXdwb3J0LnRvcCkge1xuXHRcdC8vIFx0XHRcdGlmIChjdXJyZW50U2Nyb2xsIC0gc2Nyb2xsQW1vdW50IDwgY3Vyc29yVmlld3BvcnQudG9wKSB7XG5cdFx0Ly8gXHRcdFx0XHR2aWV3LmVkaXRvci5zY3JvbGxUbygwLCBjdXJzb3JWaWV3cG9ydC50b3ApO1xuXHRcdC8vIFx0XHRcdFx0Y2xlYXJJbnRlcnZhbChzY3JvbGxpbmcpO1xuXHRcdC8vIFx0XHRcdFx0cmVzb2x2ZShcImRvbmVcIik7XG5cdFx0Ly8gXHRcdFx0fSBlbHNlIHtcblx0XHQvLyBcdFx0XHRcdHZpZXcuZWRpdG9yLnNjcm9sbFRvKDAsIGN1cnJlbnRTY3JvbGwgLSBzY3JvbGxBbW91bnQpO1xuXHRcdC8vIFx0XHRcdH1cblx0XHQvLyBcdFx0fSBlbHNlIGlmIChjdXJyZW50U2Nyb2xsIDwgY3Vyc29yVmlld3BvcnQudG9wKSB7XG5cdFx0Ly8gXHRcdFx0aWYgKGN1cnJlbnRTY3JvbGwgKyBzY3JvbGxBbW91bnQgPiBjdXJzb3JWaWV3cG9ydC50b3ApIHtcblx0XHQvLyBcdFx0XHRcdHZpZXcuZWRpdG9yLnNjcm9sbFRvKDAsIGN1cnNvclZpZXdwb3J0LnRvcCk7XG5cdFx0Ly8gXHRcdFx0XHRjbGVhckludGVydmFsKHNjcm9sbGluZyk7XG5cdFx0Ly8gXHRcdFx0XHRyZXNvbHZlKFwiZG9uZVwiKTtcblx0XHQvLyBcdFx0XHR9IGVsc2Uge1xuXHRcdC8vIFx0XHRcdFx0dmlldy5lZGl0b3Iuc2Nyb2xsVG8oMCwgY3VycmVudFNjcm9sbCArIHNjcm9sbEFtb3VudCk7XG5cdFx0Ly8gXHRcdFx0fVxuXHRcdC8vIFx0XHR9XG5cdFx0Ly8gXHR9LCAxMCk7XG5cdFx0Ly8gfSk7XG5cblx0XHQvLyB2aWV3LmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoXCIuY20tc2Nyb2xsZXJcIik/LnNjcm9sbFRvKHtcblx0XHQvLyBcdHRvcDogY3Vyc29yVmlld3BvcnQudG9wLFxuXHRcdC8vIFx0YmVoYXZpb3I6IFwic21vb3RoXCIsXG5cdFx0Ly8gfSk7XG5cblx0XHQvLyBpZiB0aGUgaG92ZXIgaXMgYWN0aXZlLCBoaWdobGlnaHQgdGhlIHNlbGVjdGlvblxuXHRcdGlmIChnZXRIb3ZlcigpICE9IG51bGwpIHtcblx0XHRcdGNvbnN0IHsgZGF0YVN0cmluZywgY3Vyc29yVmlld3BvcnQsIGxlYWZJZCwgb3JpZ2luYWxMZWFmSWQgfSA9IGdldEhvdmVyKCk7XG5cdFx0XHRsZXQgW3ByZWZpeCwgdGV4dCwgc3VmZml4LCBmaWxlLCBmcm9tLCB0b10gPSBwcm9jZXNzVVJJKGRhdGFTdHJpbmcpO1xuXHRcdFx0Y29uc3QgY3Vyc29yTGVhZiA9IHdvcmtzcGFjZS5nZXRMZWFmQnlJZChsZWFmSWQpO1xuXHRcdFx0d29ya3NwYWNlLnJldmVhbExlYWYoY3Vyc29yTGVhZik7XG5cdFx0XHRjb25zdCBlZGl0b3JWaWV3OiBFZGl0b3JWaWV3ID0gZ2V0RWRpdG9yVmlldyhjdXJzb3JMZWFmKTtcblx0XHRcdGhpZ2hsaWdodFNlbGVjdGlvbihlZGl0b3JWaWV3LCBmcm9tLCB0byk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGxldCBjb250YWluZXJFbDogSFRNTEVsZW1lbnQgPSBnZXRDb250YWluZXJFbGVtZW50KHRhcmdldExlYWYpO1xuXHRcdFx0aWYgKGNvbnRhaW5lckVsICE9IG51bGwpIHtcblx0XHRcdFx0Ly8gQHRzLWlnbm9yZVxuXHRcdFx0XHRjb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKFwiLnZpZXctY29udGVudFwiKT8uc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJcIik7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0aWYgKHRlbXAgJiYgdGFyZ2V0TGVhZikge1xuXHRcdHRhcmdldExlYWYuZGV0YWNoKCk7XG5cdH1cblxuXHRpZiAocGVlaykge1xuXHRcdGxldCBvcmlnaW5hbExlYWYgPSB3b3Jrc3BhY2UuZ2V0TGVhZkJ5SWQob3JpZ2luYWxMZWFmSWQpO1xuXHRcdGlmICghb3JpZ2luYWxMZWFmKSB0aHJvdyBuZXcgRXJyb3IoXCJPcmlnaW5hbCBsZWFmIG5vdCBmb3VuZFwiKTtcblxuXHRcdHdvcmtzcGFjZS5yZXZlYWxMZWFmKG9yaWdpbmFsTGVhZik7XG5cdH1cblxuXHQvLyBpZiAoIXRlbXApIHtcblx0Ly8gXHRsZXQgb3JpZ2luYWxMZWFmID0gd29ya3NwYWNlLmdldExlYWZCeUlkKG9yaWdpbmFsTGVhZklkKTtcblx0Ly8gXHRpZiAoIW9yaWdpbmFsTGVhZikgdGhyb3cgbmV3IEVycm9yKFwiT3JpZ2luYWwgbGVhZiBub3QgZm91bmRcIik7XG5cblx0Ly8gXHR3b3Jrc3BhY2UucmV2ZWFsTGVhZihvcmlnaW5hbExlYWYpO1xuXHQvLyB9XG5cdC8vIEVuZCBtdXRleCBsb2NrXG5cdHJlc2V0Q3Vyc29yKCk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBlbmRSZWZlcmVuY2VIb3ZlckVmZmVjdCgpIHtcblx0aWYgKCFnZXRIb3ZlcigpIHx8IE9iamVjdC5rZXlzKGdldEhvdmVyKCkpLmxlbmd0aCA9PSAwKSB7XG5cdFx0Ly8gRW5kIG11dGV4IGxvY2tcblx0XHRyZXNldEhvdmVyKCk7XG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0bGV0IHsgZGF0YVN0cmluZywgbGVhZklkLCBvcmlnaW5hbExlYWZJZCwgdGVtcCwgY3Vyc29yVmlld3BvcnQsIHBlZWssIHV1aWQgfSA9XG5cdFx0Z2V0SG92ZXIoKTtcblx0cmVzZXRIb3ZlcigpO1xuXG5cdGlmIChnZXRDdXJzb3IoKSAhPSBudWxsICYmIGdldEN1cnNvcigpLmRhdGFTdHJpbmcgPT0gZGF0YVN0cmluZykge1xuXHRcdC8vIGNvbnNvbGUubG9nKFwiY3Vyc29yIHJlc2V0XCIpO1xuXHRcdC8vIEVuZCBtdXRleCBsb2NrXG5cdFx0cmVzZXRIb3ZlcigpO1xuXHRcdHJldHVybjtcblx0fVxuXG5cdGNvbnN0IHsgd29ya3NwYWNlIH0gPSBnZXRUaGF0KCk7XG5cdGxldCB0YXJnZXRMZWFmID0gd29ya3NwYWNlLmdldExlYWZCeUlkKGxlYWZJZCk7XG5cdGVuZEVmZmVjdFJlbW92ZUhpZ2hsaWdodHMod29ya3NwYWNlLCBsZWFmSWQsIHV1aWQpO1xuXG5cdGxldCBlZGl0b3JWaWV3ID0gZ2V0RWRpdG9yVmlldyh0YXJnZXRMZWFmKTtcblxuXHRsZXQgW3ByZWZpeCwgdGV4dCwgc3VmZml4LCBmaWxlLCBmcm9tLCB0b10gPSBwcm9jZXNzVVJJKGRhdGFTdHJpbmcpO1xuXHRyZW1vdmVIaWdobGlnaHQoZWRpdG9yVmlldywgZnJvbSwgdG8pO1xuXHRkZWZhdWx0SGlnaGxpZ2h0U2VsZWN0aW9uKGVkaXRvclZpZXcsIGZyb20sIHRvKTtcblxuXHQvLyByZW1vdmVIaWdobGlnaHRzKGVkaXRvclZpZXcpO1xuXG5cdGlmIChjdXJzb3JWaWV3cG9ydCAmJiB0YXJnZXRMZWFmICYmIHRhcmdldExlYWYudmlldyBpbnN0YW5jZW9mIE1hcmtkb3duVmlldykge1xuXHRcdGNvbnN0IHZpZXc6IE1hcmtkb3duVmlldyA9IHRhcmdldExlYWYudmlldztcblx0XHR2aWV3LmVkaXRvci5zY3JvbGxUbygwLCBjdXJzb3JWaWV3cG9ydC50b3ApO1xuXG5cdFx0Ly8gaWYgdGhlIGN1cnNvciBpcyBhY3RpdmUsIGhpZ2hsaWdodCB0aGUgc2VsZWN0aW9uXG5cdFx0aWYgKGdldEN1cnNvcigpICE9IG51bGwgJiYgZ2V0Q3Vyc29yKCkuZGF0YVN0cmluZykge1xuXHRcdFx0Y29uc3QgeyBkYXRhU3RyaW5nLCBjdXJzb3JWaWV3cG9ydCwgbGVhZklkLCBvcmlnaW5hbExlYWZJZCB9ID1cblx0XHRcdFx0Z2V0Q3Vyc29yKCk7XG5cdFx0XHRsZXQgW3ByZWZpeCwgdGV4dCwgc3VmZml4LCBmaWxlLCBmcm9tLCB0bywgcG9ydGFsLCB0b2dnbGVdID1cblx0XHRcdFx0cHJvY2Vzc1VSSShkYXRhU3RyaW5nKTtcblx0XHRcdGNvbnN0IGN1cnNvckxlYWYgPSB3b3Jrc3BhY2UuZ2V0TGVhZkJ5SWQobGVhZklkKTtcblx0XHRcdHdvcmtzcGFjZS5yZXZlYWxMZWFmKGN1cnNvckxlYWYpO1xuXHRcdFx0Y29uc3QgZWRpdG9yVmlldzogRWRpdG9yVmlldyA9IGdldEVkaXRvclZpZXcoY3Vyc29yTGVhZik7XG5cdFx0XHRpZiAoIWVkaXRvclZpZXcpIHRocm93IG5ldyBFcnJvcihcIkVkaXRvciB2aWV3IG5vdCBmb3VuZFwiKTtcblxuXHRcdFx0aGlnaGxpZ2h0U2VsZWN0aW9uKGVkaXRvclZpZXcsIGZyb20sIHRvKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0bGV0IGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCA9IGdldENvbnRhaW5lckVsZW1lbnQodGFyZ2V0TGVhZik7XG5cdFx0XHRpZiAoY29udGFpbmVyRWwgIT0gbnVsbCkge1xuXHRcdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0XHQvLyBAdHMtaWdub3JlXG5cdFx0XHRcdFx0Y29udGFpbmVyRWwucXVlcnlTZWxlY3RvcihcIi52aWV3LWNvbnRlbnRcIik/LnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiXCIpO1xuXHRcdFx0XHR9LCA1MCk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0aWYgKHRlbXAgJiYgdGFyZ2V0TGVhZikge1xuXHRcdHRhcmdldExlYWYuZGV0YWNoKCk7XG5cblx0XHRsZXQgb3JpZ2luYWxMZWFmID0gd29ya3NwYWNlLmdldExlYWZCeUlkKG9yaWdpbmFsTGVhZklkKTtcblx0XHRpZiAoIW9yaWdpbmFsTGVhZikgdGhyb3cgbmV3IEVycm9yKFwiT3JpZ2luYWwgbGVhZiBub3QgZm91bmRcIik7XG5cblx0XHR3b3Jrc3BhY2UucmV2ZWFsTGVhZihvcmlnaW5hbExlYWYpO1xuXHR9XG5cblx0aWYgKHBlZWspIHtcblx0XHRsZXQgb3JpZ2luYWxMZWFmID0gd29ya3NwYWNlLmdldExlYWZCeUlkKG9yaWdpbmFsTGVhZklkKTtcblx0XHRpZiAoIW9yaWdpbmFsTGVhZikge1xuXHRcdFx0cmVzZXRIb3ZlcigpO1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKFwiT3JpZ2luYWwgbGVhZiBub3QgZm91bmRcIik7XG5cdFx0fVxuXG5cdFx0d29ya3NwYWNlLnJldmVhbExlYWYob3JpZ2luYWxMZWFmKTtcblx0fVxuXHQvLyBpZiAoIXRlbXApIHtcblx0Ly8gXHRsZXQgb3JpZ2luYWxMZWFmID0gd29ya3NwYWNlLmdldExlYWZCeUlkKG9yaWdpbmFsTGVhZklkKTtcblx0Ly8gXHRpZiAoIW9yaWdpbmFsTGVhZikgdGhyb3cgbmV3IEVycm9yKFwiT3JpZ2luYWwgbGVhZiBub3QgZm91bmRcIik7XG5cblx0Ly8gXHR3b3Jrc3BhY2UucmV2ZWFsTGVhZihvcmlnaW5hbExlYWYpO1xuXHQvLyB9XG5cblx0Ly8gRW5kIG11dGV4IGxvY2tcblx0cmVzZXRIb3ZlcigpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZW5kQmFja2xpbmtIb3ZlckVmZmVjdCgpIHtcblx0aWYgKCFnZXRCYWNrbGlua0hvdmVyKCkgfHwgT2JqZWN0LmtleXMoZ2V0QmFja2xpbmtIb3ZlcigpKS5sZW5ndGggPT0gMCkge1xuXHRcdC8vIEVuZCBtdXRleCBsb2NrXG5cdFx0cmVzZXRCYWNrbGlua0hvdmVyKCk7XG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0Y29uc3Qge1xuXHRcdGRhdGFTdHJpbmcsXG5cdFx0bGVhZklkLFxuXHRcdG9yaWdpbmFsTGVhZklkLFxuXHRcdGJhY2tsaW5rTGVhZklkLFxuXHRcdHRlbXAsXG5cdFx0Y3Vyc29yVmlld3BvcnQsXG5cdFx0cGVlayxcblx0XHR1dWlkLFxuXHRcdGJhY2tsaW5rVVVJRCxcblx0fSA9IGdldEJhY2tsaW5rSG92ZXIoKTtcblx0cmVzZXRCYWNrbGlua0hvdmVyKCk7XG5cblx0aWYgKGdldEN1cnNvcigpICE9IG51bGwgJiYgZ2V0Q3Vyc29yKCkuZGF0YVN0cmluZyA9PSBkYXRhU3RyaW5nKSB7XG5cdFx0Ly8gRW5kIG11dGV4IGxvY2tcblx0XHRyZXNldEJhY2tsaW5rSG92ZXIoKTtcblx0XHRyZXR1cm47XG5cdH1cblxuXHRjb25zdCB7IHdvcmtzcGFjZSB9ID0gZ2V0VGhhdCgpO1xuXHRsZXQgdGFyZ2V0TGVhZiA9IHdvcmtzcGFjZS5nZXRMZWFmQnlJZChsZWFmSWQpO1xuXHRlbmRFZmZlY3RSZW1vdmVIaWdobGlnaHRzKHdvcmtzcGFjZSwgbGVhZklkLCB1dWlkLCBiYWNrbGlua1VVSUQpO1xuXG5cdGlmIChjdXJzb3JWaWV3cG9ydCAmJiB0YXJnZXRMZWFmICYmIHRhcmdldExlYWYudmlldyBpbnN0YW5jZW9mIE1hcmtkb3duVmlldykge1xuXHRcdGNvbnN0IHZpZXc6IE1hcmtkb3duVmlldyA9IHRhcmdldExlYWYudmlldztcblx0XHR2aWV3LmVkaXRvci5zY3JvbGxUbygwLCBjdXJzb3JWaWV3cG9ydC50b3ApO1xuXHR9XG5cblx0bGV0IGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCA9IGdldENvbnRhaW5lckVsZW1lbnQodGFyZ2V0TGVhZik7XG5cdGlmIChjb250YWluZXJFbCAhPSBudWxsKSB7XG5cdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHQvLyBAdHMtaWdub3JlXG5cdFx0XHRjb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKFwiLnZpZXctY29udGVudFwiKT8uc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJcIik7XG5cdFx0fSwgNTApO1xuXHR9XG5cblx0bGV0IGVkaXRvclZpZXc6IEVkaXRvclZpZXcgPSBnZXRFZGl0b3JWaWV3KHRhcmdldExlYWYpO1xuXG5cdGxldCBbcHJlZml4LCB0ZXh0LCBzdWZmaXgsIGZpbGUsIGZyb20sIHRvXSA9IHByb2Nlc3NVUkkoZGF0YVN0cmluZyk7XG5cdC8vIHJlbW92ZUhpZ2hsaWdodChlZGl0b3JWaWV3LCBmcm9tLCB0byk7XG5cdC8vIHJlbW92ZUhpZ2hsaWdodHMoZWRpdG9yVmlldyk7XG5cblx0Ly8gYmFja2xpbmsgZWZmZWN0XG5cdGNvbnN0IG9yaWdpbmFsTGVhZiA9IHdvcmtzcGFjZS5nZXRMZWFmQnlJZChiYWNrbGlua0xlYWZJZCk7XG5cdGlmICghb3JpZ2luYWxMZWFmKSB7XG5cdFx0cmVzZXRCYWNrbGlua0hvdmVyKCk7XG5cdFx0dGhyb3cgbmV3IEVycm9yKFwiT3JpZ2luYWwgbGVhZiBub3QgZm91bmRcIik7XG5cdH1cblx0bGV0IG9yaWdpbmFsRWRpdG9yVmlldzogRWRpdG9yVmlldyA9IGdldEVkaXRvclZpZXcob3JpZ2luYWxMZWFmKTtcblxuXHRyZW1vdmVIaWdobGlnaHQob3JpZ2luYWxFZGl0b3JWaWV3LCBmcm9tLCB0byk7XG5cdGRlZmF1bHRIaWdobGlnaHRTZWxlY3Rpb24ob3JpZ2luYWxFZGl0b3JWaWV3LCBmcm9tLCB0byk7XG5cblx0Ly8gcmVtb3ZlSGlnaGxpZ2h0cyhvcmlnaW5hbEVkaXRvclZpZXcpO1xuXG5cdGlmIChnZXRDdXJzb3IoKSAhPSBudWxsICYmIGdldEN1cnNvcigpLmRhdGFTdHJpbmcpIHtcblx0XHRjb25zdCB7IGRhdGFTdHJpbmcsIGN1cnNvclZpZXdwb3J0LCBsZWFmSWQsIG9yaWdpbmFsTGVhZklkIH0gPSBnZXRDdXJzb3IoKTtcblx0XHRsZXQgW3ByZWZpeCwgdGV4dCwgc3VmZml4LCBmaWxlLCBmcm9tLCB0b10gPSBwcm9jZXNzVVJJKGRhdGFTdHJpbmcpO1xuXHRcdGNvbnN0IGN1cnNvckxlYWYgPSB3b3Jrc3BhY2UuZ2V0TGVhZkJ5SWQobGVhZklkKTtcblx0XHR3b3Jrc3BhY2UucmV2ZWFsTGVhZihjdXJzb3JMZWFmKTtcblxuXHRcdGNvbnN0IGVkaXRvclZpZXc6IEVkaXRvclZpZXcgPSBnZXRFZGl0b3JWaWV3KGN1cnNvckxlYWYpO1xuXHRcdGhpZ2hsaWdodFNlbGVjdGlvbihlZGl0b3JWaWV3LCBmcm9tLCB0byk7XG5cdH1cblxuXHRpZiAodGVtcCAmJiB0YXJnZXRMZWFmKSB7XG5cdFx0dGFyZ2V0TGVhZi5kZXRhY2goKTtcblx0fVxuXG5cdGlmIChwZWVrKSB7XG5cdFx0bGV0IG9yaWdpbmFsTGVhZiA9IHdvcmtzcGFjZS5nZXRMZWFmQnlJZChvcmlnaW5hbExlYWZJZCk7XG5cdFx0aWYgKCFvcmlnaW5hbExlYWYpIHtcblx0XHRcdHJlc2V0QmFja2xpbmtIb3ZlcigpO1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKFwiT3JpZ2luYWwgbGVhZiBub3QgZm91bmRcIik7XG5cdFx0fVxuXG5cdFx0d29ya3NwYWNlLnJldmVhbExlYWYob3JpZ2luYWxMZWFmKTtcblx0fVxuXG5cdC8vIGlmICh0ZW1wKSB7XG5cdC8vIFx0dGFyZ2V0TGVhZi5kZXRhY2goKTtcblx0Ly8gXHQvLyBzZXRUaW1lb3V0KCgpID0+IHtcblx0Ly8gXHQvLyBcdHRhcmdldExlYWYuZGV0YWNoKCk7XG5cdC8vIFx0Ly8gfSwgMTAwKTtcblx0Ly8gfSBlbHNlIHtcblx0Ly8gXHQvLyBpZiB0aGUgY3Vyc29yIGlzIGFjdGl2ZSwgaGlnaGxpZ2h0IHRoZSBzZWxlY3Rpb25cblx0Ly8gfVxuXG5cdC8vIEVuZCBtdXRleCBsb2NrXG5cdHJlc2V0QmFja2xpbmtIb3ZlcigpO1xufVxuIiwgImltcG9ydCB7IEVkaXRvclZpZXcsIERlY29yYXRpb24sIERlY29yYXRpb25TZXQgfSBmcm9tIFwiQGNvZGVtaXJyb3Ivdmlld1wiO1xuaW1wb3J0IHsgU3RhdGVGaWVsZCwgU3RhdGVFZmZlY3QgfSBmcm9tIFwiQGNvZGVtaXJyb3Ivc3RhdGVcIjtcbmltcG9ydCB7IFNWR19IT1ZFUl9DT0xPUiB9IGZyb20gXCIuL2NvbnN0YW50c1wiO1xuXG5jb25zdCBhZGRIaWdobGlnaHQgPSBTdGF0ZUVmZmVjdC5kZWZpbmU8eyBmcm9tOiBudW1iZXI7IHRvOiBudW1iZXIgfT4oe1xuXHRtYXA6ICh7IGZyb20sIHRvIH0sIGNoYW5nZSkgPT4gKHtcblx0XHRmcm9tOiBjaGFuZ2UubWFwUG9zKGZyb20pLFxuXHRcdHRvOiBjaGFuZ2UubWFwUG9zKHRvKSxcblx0fSksXG59KTtcblxuY29uc3QgYWRkRGVmYXVsdEhpZ2hsaWdodCA9IFN0YXRlRWZmZWN0LmRlZmluZTx7IGZyb206IG51bWJlcjsgdG86IG51bWJlciB9Pih7XG5cdG1hcDogKHsgZnJvbSwgdG8gfSwgY2hhbmdlKSA9PiAoe1xuXHRcdGZyb206IGNoYW5nZS5tYXBQb3MoZnJvbSksXG5cdFx0dG86IGNoYW5nZS5tYXBQb3ModG8pLFxuXHR9KSxcbn0pO1xuXG5jb25zdCByZXNldEhpZ2hsaWdodCA9IFN0YXRlRWZmZWN0LmRlZmluZTx7IGZyb206IG51bWJlcjsgdG86IG51bWJlciB9Pih7XG5cdG1hcDogKHsgZnJvbSwgdG8gfSwgY2hhbmdlKSA9PiAoe1xuXHRcdGZyb206IGNoYW5nZS5tYXBQb3MoZnJvbSksXG5cdFx0dG86IGNoYW5nZS5tYXBQb3ModG8pLFxuXHR9KSxcbn0pO1xuXG5jb25zdCBoaWdobGlnaHRGaWVsZCA9IFN0YXRlRmllbGQuZGVmaW5lPERlY29yYXRpb25TZXQ+KHtcblx0Y3JlYXRlKCkge1xuXHRcdHJldHVybiBEZWNvcmF0aW9uLm5vbmU7XG5cdH0sXG5cdHVwZGF0ZShoaWdsaWdodHMsIHRyKSB7XG5cdFx0aGlnbGlnaHRzID0gaGlnbGlnaHRzLm1hcCh0ci5jaGFuZ2VzKTtcblx0XHRmb3IgKGxldCBlIG9mIHRyLmVmZmVjdHMpXG5cdFx0XHRpZiAoZS5pcyhhZGREZWZhdWx0SGlnaGxpZ2h0KSkge1xuXHRcdFx0XHRoaWdsaWdodHMgPSBoaWdsaWdodHMudXBkYXRlKHtcblx0XHRcdFx0XHRhZGQ6IFtkZWZhdWx0SGlnaGxpZ2h0TWFyay5yYW5nZShlLnZhbHVlLmZyb20sIGUudmFsdWUudG8pXSxcblx0XHRcdFx0fSk7XG5cdFx0XHR9IGVsc2UgaWYgKGUuaXMoYWRkSGlnaGxpZ2h0KSkge1xuXHRcdFx0XHRoaWdsaWdodHMgPSBoaWdsaWdodHMudXBkYXRlKHtcblx0XHRcdFx0XHRhZGQ6IFtoaWdobGlnaHRNYXJrLnJhbmdlKGUudmFsdWUuZnJvbSwgZS52YWx1ZS50byldLFxuXHRcdFx0XHR9KTtcblx0XHRcdH0gZWxzZSBpZiAoZS5pcyhyZXNldEhpZ2hsaWdodCkpIHtcblx0XHRcdFx0aGlnbGlnaHRzID0gaGlnbGlnaHRzLnVwZGF0ZSh7XG5cdFx0XHRcdFx0ZmlsdGVyOiAoZnJvbSwgdG8pID0+IHtcblx0XHRcdFx0XHRcdHJldHVybiAhKGZyb20gPT09IGUudmFsdWUuZnJvbSAmJiB0byA9PT0gZS52YWx1ZS50byk7XG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0cmV0dXJuIGhpZ2xpZ2h0cztcblx0fSxcblx0cHJvdmlkZTogKGYpID0+IEVkaXRvclZpZXcuZGVjb3JhdGlvbnMuZnJvbShmKSxcbn0pO1xuXG5jb25zdCBoaWdobGlnaHRNYXJrID0gRGVjb3JhdGlvbi5tYXJrKHsgY2xhc3M6IFwiaGlnaGxpZ2h0XCIgfSk7XG5jb25zdCBkZWZhdWx0SGlnaGxpZ2h0TWFyayA9IERlY29yYXRpb24ubWFyayh7IGNsYXNzOiBcImRlZmF1bHQtaGlnaGxpZ2h0XCIgfSk7XG5jb25zdCB0aGVtZSA9IEVkaXRvclZpZXcuYmFzZVRoZW1lKHt9KTtcbmNvbnN0IGhpZ2hsaWdodFRoZW1lID0gRWRpdG9yVmlldy5iYXNlVGhlbWUoe1xuXHRcIi5oaWdobGlnaHRcIjoge1xuXHRcdFwiYmFja2dyb3VuZC1jb2xvclwiOlxuXHRcdFx0XCJoc2woY2FsYyh2YXIoLS1hY2NlbnQtaCkgLSAzKSwgY2FsYyh2YXIoLS1hY2NlbnQtcykgKiAxLjAyKSwgY2FsYyh2YXIoLS1hY2NlbnQtbCkgKiAxLjMpKVwiLFxuXHRcdGNvbG9yOiBcImJsYWNrXCIsXG5cdH0sXG59KTtcbi8vIGNvbnN0IGRlZmF1bHRIaWdobGlnaHRUaGVtZSA9IEVkaXRvclZpZXcuYmFzZVRoZW1lKHtcbi8vIFx0XCIuaGlnaGxpZ2h0XCI6IHtcbi8vIFx0XHRcImJhY2tncm91bmQtY29sb3JcIjpcbi8vIFx0XHRcdFwiaHNsKGNhbGModmFyKC0tYWNjZW50LWgpIC0gMyksIGNhbGModmFyKC0tYWNjZW50LXMpICogMS4wMiksIGNhbGModmFyKC0tYWNjZW50LWwpICogMS40MykpXCIsXG4vLyBcdFx0Y29sb3I6IFwiYmxhY2tcIixcbi8vIFx0fSxcbi8vIH0pO1xuY29uc3QgZGVmYXVsdEhpZ2hsaWdodFRoZW1lID0gRWRpdG9yVmlldy5iYXNlVGhlbWUoe1xuXHRcIi5kZWZhdWx0LWhpZ2hsaWdodFwiOiB7XG5cdFx0XCJiYWNrZ3JvdW5kLWNvbG9yXCI6XG5cdFx0XHRcImhzbChjYWxjKHZhcigtLWFjY2VudC1oKSAtIDMpLCBjYWxjKHZhcigtLWFjY2VudC1zKSAqIDEuMDIpLCBjYWxjKHZhcigtLWFjY2VudC1sKSAqIDEuNDMpKVwiLFxuXHRcdGNvbG9yOiBcImJsYWNrXCIsXG5cdH0sXG59KTtcblxuZXhwb3J0IGZ1bmN0aW9uIGhpZ2hsaWdodFNlbGVjdGlvbih2aWV3OiBFZGl0b3JWaWV3LCBmcm9tOiBudW1iZXIsIHRvOiBudW1iZXIpIHtcblx0bGV0IGVmZmVjdHM6IFN0YXRlRWZmZWN0PHVua25vd24+W10gPSBbYWRkSGlnaGxpZ2h0Lm9mKHsgZnJvbSwgdG8gfSldO1xuXG5cdGlmICghZWZmZWN0cy5sZW5ndGgpIHJldHVybiBmYWxzZTtcblxuXHRpZiAoIXZpZXcuc3RhdGUuZmllbGQoaGlnaGxpZ2h0RmllbGQsIGZhbHNlKSlcblx0XHRlZmZlY3RzLnB1c2goU3RhdGVFZmZlY3QuYXBwZW5kQ29uZmlnLm9mKFtoaWdobGlnaHRGaWVsZCwgdGhlbWVdKSk7XG5cblx0dmlldy5kaXNwYXRjaCh7IGVmZmVjdHMgfSk7XG5cdHJldHVybiB0cnVlO1xufVxuXG4vLyBoYXZlIGEgZnVuY3Rpb24gdGhhdCBhZGRzIHN1YnRsZSBoaWdobGlnaHRzIHRvIHN0YXRlXG5leHBvcnQgZnVuY3Rpb24gZGVmYXVsdEhpZ2hsaWdodFNlbGVjdGlvbihcblx0dmlldzogRWRpdG9yVmlldyxcblx0ZnJvbTogbnVtYmVyLFxuXHR0bzogbnVtYmVyXG4pIHtcblx0bGV0IGVmZmVjdHM6IFN0YXRlRWZmZWN0PHVua25vd24+W10gPSBbYWRkRGVmYXVsdEhpZ2hsaWdodC5vZih7IGZyb20sIHRvIH0pXTtcblxuXHRpZiAoIWVmZmVjdHMubGVuZ3RoKSByZXR1cm4gZmFsc2U7XG5cblx0aWYgKCF2aWV3LnN0YXRlLmZpZWxkKGhpZ2hsaWdodEZpZWxkLCBmYWxzZSkpXG5cdFx0ZWZmZWN0cy5wdXNoKFN0YXRlRWZmZWN0LmFwcGVuZENvbmZpZy5vZihbaGlnaGxpZ2h0RmllbGQsIHRoZW1lXSkpO1xuXG5cdHZpZXcuZGlzcGF0Y2goeyBlZmZlY3RzIH0pO1xuXG5cdHJldHVybiB0cnVlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlSGlnaGxpZ2h0KHZpZXc6IEVkaXRvclZpZXcsIGZyb206IG51bWJlciwgdG86IG51bWJlcikge1xuXHRsZXQgZWZmZWN0czogU3RhdGVFZmZlY3Q8dW5rbm93bj5bXSA9IFtyZXNldEhpZ2hsaWdodC5vZih7IGZyb20sIHRvIH0pXTtcblxuXHRpZiAoIWVmZmVjdHMubGVuZ3RoKSByZXR1cm4gZmFsc2U7XG5cblx0dmlldy5kaXNwYXRjaCh7IGVmZmVjdHMgfSk7XG5cdHJldHVybiB0cnVlO1xufVxuXG4vLyB1cGRhdGUgcmVtb3ZlIGhpZ2hsaWdodHMgc28gdGhhdFxuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZUhpZ2hsaWdodHModmlldzogRWRpdG9yVmlldykge1xuXHRpZiAoIXZpZXcpIHJldHVybjtcblxuXHRsZXQgZWZmZWN0czogU3RhdGVFZmZlY3Q8dW5rbm93bj5bXSA9IHZpZXcuc3RhdGUuc2VsZWN0aW9uLnJhbmdlcy5tYXAoXG5cdFx0KHsgZnJvbSwgdG8gfSkgPT4gcmVzZXRIaWdobGlnaHQub2YoeyBmcm9tLCB0byB9KVxuXHQpO1xuXHRpZiAoZWZmZWN0cy5sZW5ndGgpIHtcblx0XHR2aWV3LmRpc3BhdGNoKHsgZWZmZWN0cyB9KTtcblx0XHRyZXR1cm4gdHJ1ZTtcblx0fVxuXHRyZXR1cm4gZmFsc2U7XG59XG5cbi8vIEkgd2FudCB0byBhZGQgYSBidW5jaCBvZiBoaWdobGlnaHRzIHRvIHRoZSBzdGF0ZSB0aGF0IHVzZSBzb21lIGxpZ2h0ZXIgaGlnaGxpZ2h0IHRoZW1lXG4vLyBBbmQgdGhlbiByZW1vdmUgdGhlbSBhbmQgdXBkYXRlIHRoZSBoaWdobGlnaHRzIG9uIGVhY2ggZ2VuZXJhdGlvbiBvZiBiYWNrbGlua01hcmtQb3NpdGlvbnNcbiIsICJpbXBvcnQgeyBQbHVnaW4sIE1hcmtkb3duVmlldywgRWRpdG9yIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQge1xuXHRwcm9jZXNzVVJJLFxuXHRwYXJzZUVkaXRvclBvc2l0aW9uLFxuXHRlbmNvZGVVUklDb21wb25lbnRTdHJpbmcsXG5cdGdldFByZWZpeEFuZFN1ZmZpeCxcbn0gZnJvbSBcIi4vdXRpbHNcIjtcblxuLy8gW1x1MjE5N10odXJuOkFsc28tOiBob3BlZnVsbHkgZml4IHRoZSBtdWx0aS1saW5lIHJlZmVyZW5jZTotJTBBLSBVUk5zOjExLTIzIFRvZG8ubWQpXG4vLyBbXHUyMTk3XSh1cm46UFJFRklYLTpURVhUOi1TVUZGSVg6RklMRTpTVEFSVElOREVYOkVORElOREVYKVxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUNsaXBib2FyZChcblx0dG9nZ2xlOiBib29sZWFuID0gZmFsc2UsXG5cdG9ubHk6IGJvb2xlYW4gPSBmYWxzZVxuKSB7XG5cdGNvbnN0IHZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuXHQvLyBNYWtlIHN1cmUgdGhlIHVzZXIgaXMgZWRpdGluZyBhIE1hcmtkb3duIGZpbGUuXG5cdGlmICh2aWV3KSB7XG5cdFx0bGV0IHNlbGVjdGlvbiA9IHZpZXcuZWRpdG9yLmdldFNlbGVjdGlvbigpO1xuXHRcdGlmICh2aWV3LmZpbGUpIHtcblx0XHRcdGNvbnN0IHRleHQgPSB2aWV3LmRhdGE7XG5cdFx0XHRjb25zdCBmcm9tID0gdmlldy5lZGl0b3IucG9zVG9PZmZzZXQodmlldy5lZGl0b3IuZ2V0Q3Vyc29yKFwiZnJvbVwiKSk7XG5cdFx0XHRjb25zdCB0byA9IHZpZXcuZWRpdG9yLnBvc1RvT2Zmc2V0KHZpZXcuZWRpdG9yLmdldEN1cnNvcihcInRvXCIpKTtcblx0XHRcdGNvbnN0IHsgcHJlZml4LCBzdWZmaXggfSA9IGdldFByZWZpeEFuZFN1ZmZpeCh0ZXh0LCBmcm9tLCB0byk7XG5cdFx0XHRsZXQgcmVmZXJlbmNlID0gYFtcdTIxOTddKHVybjoke2VuY29kZVVSSUNvbXBvbmVudFN0cmluZyhcblx0XHRcdFx0cHJlZml4XG5cdFx0XHQpfS06JHtlbmNvZGVVUklDb21wb25lbnRTdHJpbmcoc2VsZWN0aW9uKX06LSR7ZW5jb2RlVVJJQ29tcG9uZW50U3RyaW5nKFxuXHRcdFx0XHRzdWZmaXhcblx0XHRcdCl9OiR7ZW5jb2RlVVJJQ29tcG9uZW50U3RyaW5nKHZpZXcuZmlsZS5wYXRoKX06JHtmcm9tfToke3RvfToke1xuXHRcdFx0XHQvLyBvbmx5ID8gXCJwb3J0YWxcIiA6IFwibm8tcG9ydGFsXCJcblx0XHRcdFx0XCJwb3J0YWxcIlxuXHRcdFx0fToke3RvZ2dsZSA/IFwidFwiIDogXCJmXCJ9KWA7XG5cblx0XHRcdC8vIFdyaXRlIHRoZSBzZWxlY3RlZCB0ZXh0IHRvIHRoZSBjbGlwYm9hcmRcblx0XHRcdGF3YWl0IG5hdmlnYXRvci5jbGlwYm9hcmQud3JpdGVUZXh0KHJlZmVyZW5jZSk7XG5cdFx0fVxuXHR9XG59XG4iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxJQUFBQSxtQkFBNEQ7OztBQ0E1RCxtQkFLTztBQUtBLElBQUksT0FBTyx3QkFBVyxPQUFtQjtBQUFBLEVBQy9DLFNBQVM7QUFDUixXQUFPO0FBQUEsRUFDUjtBQUFBLEVBQ0EsT0FBTyxPQUFPLElBQVM7QUFDdEIsUUFDQyxHQUFHLGFBQWEsRUFBRSxVQUFVLEtBQzVCLEdBQUcsYUFBYSxFQUFFLENBQUMsRUFBRSxNQUFNLFFBQVEsUUFDbEM7QUFDRCxhQUFPLEdBQUcsYUFBYSxFQUFFLENBQUMsRUFBRSxNQUFNLEtBQUs7QUFBQSxJQUN4QztBQUNBLFdBQU87QUFBQSxFQUNSO0FBQ0QsQ0FBQztBQUVNLElBQUksZ0JBQWdCLHdCQUFXLE9BQVk7QUFBQSxFQUNqRCxTQUFTO0FBQ1IsV0FBTztBQUFBLEVBQ1I7QUFBQSxFQUNBLE9BQU8sT0FBTyxJQUFTO0FBQ3RCLFFBQ0MsR0FBRyxhQUFhLEVBQUUsVUFBVSxLQUM1QixHQUFHLGFBQWEsRUFBRSxDQUFDLEVBQUUsTUFBTSxRQUFRLGlCQUNsQztBQUNELFVBQUk7QUFDSCxlQUFPO0FBQUEsVUFDTixHQUFHLE1BQU07QUFBQSxZQUNSLENBQUMsV0FBZ0IsT0FBTyxRQUFRLEdBQUcsYUFBYSxFQUFFLENBQUMsRUFBRSxNQUFNO0FBQUEsVUFDNUQ7QUFBQSxVQUNBO0FBQUEsWUFDQyxRQUFRLEdBQUcsYUFBYSxFQUFFLENBQUMsRUFBRSxNQUFNO0FBQUEsWUFDbkMsTUFBTSxHQUFHLGFBQWEsRUFBRSxDQUFDLEVBQUUsTUFBTTtBQUFBLFVBQ2xDO0FBQUEsUUFDRDtBQUNELGFBQU87QUFBQSxRQUNOO0FBQUEsVUFDQyxRQUFRLEdBQUcsYUFBYSxFQUFFLENBQUMsRUFBRSxNQUFNO0FBQUEsVUFDbkMsTUFBTSxHQUFHLGFBQWEsRUFBRSxDQUFDLEVBQUUsTUFBTTtBQUFBLFFBQ2xDO0FBQUEsTUFDRDtBQUFBLElBQ0QsV0FDQyxHQUFHLGFBQWEsRUFBRSxVQUFVLEtBQzVCLEdBQUcsYUFBYSxFQUFFLENBQUMsRUFBRSxNQUFNLFFBQVEsdUJBQ2xDO0FBQ0QsVUFBSTtBQUNILGVBQU8sTUFBTTtBQUFBLFVBQ1osQ0FBQyxXQUFnQixPQUFPLFFBQVEsR0FBRyxhQUFhLEVBQUUsQ0FBQyxFQUFFLE1BQU07QUFBQSxRQUM1RDtBQUNELGFBQU87QUFBQSxJQUNSO0FBQ0EsV0FBTztBQUFBLEVBQ1I7QUFDRCxDQUFDO0FBRU0sSUFBSSxZQUFZLHdCQUFXLE9BQW1CO0FBQUEsRUFDcEQsU0FBUztBQUNSLFdBQU8sQ0FBQztBQUFBLEVBQ1Q7QUFBQSxFQUNBLE9BQU8sT0FBTyxJQUFJO0FBTWpCLFFBQUksR0FBRyxRQUFRLFNBQVMsR0FBRztBQUMxQixVQUFJO0FBQ0gsWUFBSSxPQUFnRCxLQUFLO0FBQUEsVUFDeEQsR0FBRyxRQUFRLENBQUMsRUFBRTtBQUFBLFFBQ2Y7QUFDQSxZQUFJLEtBQUssUUFBUSxZQUFZO0FBQzVCLGNBQUksS0FBSyxVQUFVLFVBQVU7QUFBRyxtQkFBTztBQUN2QyxjQUFJLHNCQUNILEtBQUssVUFBVSxDQUFDLEVBQUUscUJBQXFCLEVBQUUsVUFBVTtBQUNwRCxjQUFJLGlCQUFpQixNQUFNO0FBQUEsWUFDMUIsQ0FBQyxhQUNBLFNBQVMsb0JBQW9CLFlBQVk7QUFBQSxVQUMzQztBQUNBLGlCQUFPLENBQUMsR0FBRyxnQkFBZ0IsR0FBRyxLQUFLLFNBQVM7QUFBQSxRQUM3QztBQUNBLGVBQU87QUFBQSxNQUNSLFNBQVMsR0FBUDtBQUNELGdCQUFRLElBQUksQ0FBQztBQUNiLGVBQU87QUFBQSxNQUNSO0FBQUEsSUFDRDtBQUNBLFdBQU87QUFBQSxFQUNSO0FBQ0QsQ0FBQztBQUVNLElBQUksZUFBZSx3QkFBVyxPQUFzQjtBQUFBLEVBQzFELFNBQVM7QUFDUixXQUFPO0FBQUEsRUFDUjtBQUFBLEVBQ0EsT0FBTyxPQUFPLElBQUk7QUFDakIsUUFBSSxHQUFHLFFBQVEsU0FBUyxHQUFHO0FBQzFCLFVBQUk7QUFDSCxZQUFJLE9BQU8sS0FBSyxNQUFNLEdBQUcsUUFBUSxDQUFDLEVBQUUsS0FBSztBQUN6QyxZQUFJLEtBQUssUUFBUSxlQUFlO0FBQy9CLGlCQUFPLE9BQU8sT0FBTyxDQUFDLEdBQUcsSUFBSTtBQUFBLFFBQzlCLFdBQVcsS0FBSyxRQUFRLFNBQVM7QUFDaEMsY0FBSTtBQUFPLG1CQUFPLE9BQU8sT0FBTyxPQUFPLElBQUk7QUFDM0MsaUJBQU87QUFBQSxRQUNSLFdBQVcsS0FBSyxRQUFRLGFBQWE7QUFDcEMsaUJBQU87QUFBQSxRQUNSO0FBQ0EsZUFBTztBQUFBLE1BQ1IsU0FBUyxHQUFQO0FBQ0QsZ0JBQVEsSUFBSSxDQUFDO0FBQ2IsZUFBTztBQUFBLE1BQ1I7QUFBQSxJQUNEO0FBQ0EsV0FBTztBQUFBLEVBQ1I7QUFDRCxDQUFDO0FBRU0sSUFBSSx1QkFBdUIsd0JBQVcsT0FBc0I7QUFBQSxFQUNsRSxTQUFTO0FBQ1IsV0FBTztBQUFBLEVBQ1I7QUFBQSxFQUNBLE9BQU8sT0FBTyxJQUFJO0FBQ2pCLFFBQUksR0FBRyxRQUFRLFNBQVMsR0FBRztBQUMxQixVQUFJO0FBQ0gsWUFBSSxPQUFPLEtBQUssTUFBTSxHQUFHLFFBQVEsQ0FBQyxFQUFFLEtBQUs7QUFDekMsWUFBSSxLQUFLLFFBQVEsa0JBQWtCO0FBQ2xDLGlCQUFPLE9BQU8sT0FBTyxDQUFDLEdBQUcsSUFBSTtBQUFBLFFBQzlCLFdBQVcsS0FBSyxRQUFRLG1CQUFtQjtBQUMxQyxjQUFJO0FBQU8sbUJBQU8sT0FBTyxPQUFPLE9BQU8sSUFBSTtBQUMzQyxpQkFBTztBQUFBLFFBQ1IsV0FBVyxLQUFLLFFBQVEsZ0JBQWdCO0FBQ3ZDLGlCQUFPO0FBQUEsUUFDUjtBQUNBLGVBQU87QUFBQSxNQUNSLFNBQVMsR0FBUDtBQUNELGdCQUFRLElBQUksQ0FBQztBQUNiLGVBQU87QUFBQSxNQUNSO0FBQUEsSUFDRDtBQUNBLFdBQU87QUFBQSxFQUNSO0FBQ0QsQ0FBQztBQUVNLElBQUksZ0JBQWdCLHdCQUFXLE9BQXNCO0FBQUEsRUFDM0QsU0FBUztBQUNSLFdBQU87QUFBQSxFQUNSO0FBQUEsRUFDQSxPQUFPLE9BQU8sSUFBSTtBQUNqQixRQUFJLEdBQUcsUUFBUSxTQUFTLEdBQUc7QUFDMUIsVUFBSTtBQUNILFlBQUksT0FBTyxLQUFLLE1BQU0sR0FBRyxRQUFRLENBQUMsRUFBRSxLQUFLO0FBQ3pDLFlBQUksS0FBSyxRQUFRLGdCQUFnQjtBQUNoQyxpQkFBTyxDQUFDO0FBQUEsUUFDVCxXQUFXLEtBQUssUUFBUSxVQUFVO0FBQ2pDLGNBQUk7QUFBTyxtQkFBTyxPQUFPLE9BQU8sT0FBTyxJQUFJO0FBQzNDLGlCQUFPO0FBQUEsUUFDUixXQUFXLEtBQUssUUFBUSxjQUFjO0FBQ3JDLGlCQUFPO0FBQUEsUUFDUjtBQUNBLGVBQU87QUFBQSxNQUNSLFNBQVMsR0FBUDtBQUNELGdCQUFRLElBQUksQ0FBQztBQUNiLGVBQU87QUFBQSxNQUNSO0FBQUEsSUFDRDtBQUNBLFdBQU87QUFBQSxFQUNSO0FBQ0QsQ0FBQztBQUVNLElBQUksZUFBZSx3QkFBVyxPQUFhO0FBQUEsRUFDakQsU0FBUztBQUNSLFdBQU87QUFBQSxFQUNSO0FBQUEsRUFDQSxPQUFPLE9BQU8sSUFBSTtBQUNqQixRQUFJLEdBQUcsUUFBUSxTQUFTLEdBQUc7QUFDMUIsVUFBSTtBQUNILFlBQUksT0FBTyxLQUFLLE1BQU0sR0FBRyxRQUFRLENBQUMsRUFBRSxLQUFLO0FBQ3pDLFlBQUksS0FBSyxRQUFRLFFBQVE7QUFFeEIsaUJBQU87QUFBQSxRQUNSO0FBQ0EsZUFBTztBQUFBLE1BQ1IsU0FBUyxHQUFQO0FBQ0QsZ0JBQVEsSUFBSSxDQUFDO0FBQ2IsZUFBTztBQUFBLE1BQ1I7QUFBQSxJQUNEO0FBQ0EsV0FBTztBQUFBLEVBQ1I7QUFDRCxDQUFDO0FBRU0sSUFBTSxpQkFBaUIsd0JBQVcsT0FBWTtBQUM5QyxJQUFNLDBCQUEwQix3QkFBVyxPQUFZO0FBQ3ZELElBQU0sY0FBYyx5QkFBWSxPQUFlO0FBQy9DLElBQU0sc0JBQXNCLHlCQUFZLE9BQWU7QUFDdkQsSUFBTSxlQUFlLHlCQUFZLE9BQWU7QUFDaEQsSUFBTSxpQkFBaUIseUJBQVksT0FBZTtBQUVsRCxJQUFJLFFBQWEseUJBQVksT0FBTztBQUFBLEVBQzFDLFlBQVk7QUFBQSxJQUNYO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsRUFDRDtBQUNELENBQUM7QUFRTSxTQUFTLFVBQWU7QUFDOUIsU0FBTyxNQUFNLE1BQU0sSUFBSTtBQUN4QjtBQUVPLFNBQVMsV0FBV0MsT0FBVztBQUNyQyxVQUFRLE1BQU0sT0FBTztBQUFBLElBQ3BCLGFBQWEsZUFBZSxHQUFHO0FBQUEsTUFDOUIsTUFBTTtBQUFBLE1BQ04sTUFBQUE7QUFBQSxJQUNELENBQUM7QUFBQSxFQUNGLENBQUMsRUFBRTtBQUNKO0FBRU8sU0FBUyxtQkFBbUI7QUFDbEMsU0FBTyxNQUFNLE1BQU0sYUFBYTtBQUNqQztBQUVPLFNBQVMsb0JBQW9CLFFBQTBCLE1BQWM7QUFDM0UsVUFBUSxNQUFNLE9BQU87QUFBQSxJQUNwQixhQUFhLHdCQUF3QixHQUFHO0FBQUEsTUFDdkMsTUFBTTtBQUFBLE1BQ047QUFBQSxNQUNBO0FBQUEsSUFDRCxDQUFDO0FBQUEsRUFDRixDQUFDLEVBQUU7QUFDSjtBQUVPLFNBQVMsb0JBQW9CLE1BQWM7QUFDakQsVUFBUSxNQUFNLE9BQU87QUFBQSxJQUNwQixhQUFhLHdCQUF3QixHQUFHO0FBQUEsTUFDdkMsTUFBTTtBQUFBLE1BQ047QUFBQSxJQUNELENBQUM7QUFBQSxFQUNGLENBQUMsRUFBRTtBQUNKO0FBRU8sU0FBUyxXQUFXO0FBQzFCLFNBQU8sTUFBTSxNQUFNLFlBQVk7QUFDaEM7QUFFTyxTQUFTLFlBQVksT0FBZTtBQUMxQyxVQUFRLE1BQU0sT0FBTztBQUFBLElBQ3BCLFNBQVMsWUFBWTtBQUFBLE1BQ3BCLEtBQUssVUFBVSxPQUFPLE9BQU8sT0FBTyxFQUFFLE1BQU0sUUFBUSxDQUFDLENBQUM7QUFBQSxJQUN2RDtBQUFBLEVBQ0QsQ0FBQyxFQUFFO0FBQ0o7QUFFTyxTQUFTLGFBQWE7QUFDNUIsVUFBUSxNQUFNLE9BQU87QUFBQSxJQUNwQixTQUFTLFlBQVk7QUFBQSxNQUNwQixLQUFLLFVBQVU7QUFBQSxRQUNkLE1BQU07QUFBQSxNQUNQLENBQUM7QUFBQSxJQUNGO0FBQUEsRUFDRCxDQUFDLEVBQUU7QUFDSjtBQUVPLFNBQVMsbUJBQW1CO0FBQ2xDLFNBQU8sTUFBTSxNQUFNLG9CQUFvQjtBQUN4QztBQUVPLFNBQVMsb0JBQW9CLE9BQWU7QUFDbEQsVUFBUSxNQUFNLE9BQU87QUFBQSxJQUNwQixTQUFTLG9CQUFvQjtBQUFBLE1BQzVCLEtBQUssVUFBVSxPQUFPLE9BQU8sT0FBTyxFQUFFLE1BQU0sa0JBQWtCLENBQUMsQ0FBQztBQUFBLElBQ2pFO0FBQUEsRUFDRCxDQUFDLEVBQUU7QUFDSjtBQUVPLFNBQVMscUJBQXFCO0FBQ3BDLFVBQVEsTUFBTSxPQUFPO0FBQUEsSUFDcEIsU0FBUyxvQkFBb0I7QUFBQSxNQUM1QixLQUFLLFVBQVU7QUFBQSxRQUNkLE1BQU07QUFBQSxNQUNQLENBQUM7QUFBQSxJQUNGO0FBQUEsRUFDRCxDQUFDLEVBQUU7QUFDSjtBQUVPLFNBQVMsWUFBWTtBQUMzQixTQUFPLE1BQU0sTUFBTSxhQUFhO0FBQ2pDO0FBRU8sU0FBUyxhQUFhLE9BQWU7QUFDM0MsVUFBUSxNQUFNLE9BQU87QUFBQSxJQUNwQixTQUFTLGFBQWE7QUFBQSxNQUNyQixLQUFLLFVBQVUsT0FBTyxPQUFPLE9BQU8sRUFBRSxNQUFNLFNBQVMsQ0FBQyxDQUFDO0FBQUEsSUFDeEQ7QUFBQSxFQUNELENBQUMsRUFBRTtBQUNKO0FBRU8sU0FBUyxjQUFjO0FBQzdCLFVBQVEsTUFBTSxPQUFPO0FBQUEsSUFDcEIsU0FBUyxhQUFhO0FBQUEsTUFDckIsS0FBSyxVQUFVO0FBQUEsUUFDZCxNQUFNO0FBQUEsTUFDUCxDQUFDO0FBQUEsSUFDRjtBQUFBLEVBQ0QsQ0FBQyxFQUFFO0FBQ0o7QUFNTyxTQUFTLGdCQUFnQixPQUFtQjtBQUNsRCxVQUFRLE1BQU0sT0FBTztBQUFBLElBQ3BCLFNBQVMsZUFBZTtBQUFBLE1BQ3ZCLEtBQUssVUFBVSxPQUFPLE9BQU8sRUFBRSxXQUFXLE1BQU0sR0FBRyxFQUFFLE1BQU0sV0FBVyxDQUFDLENBQUM7QUFBQSxJQUN6RTtBQUFBLEVBQ0QsQ0FBQyxFQUFFO0FBQ0o7OztBQ2hWQSxrQkFVTzs7O0FDVkEsSUFBSSxrQkFBa0I7QUFFdEIsSUFBSSxjQUFjO0FBQUEsRUFDeEIsT0FBTztBQUFBLEVBQ1AsUUFBUTtBQUFBLEVBQ1IsVUFBVTtBQUNYO0FBRU8sSUFBSSxrQkFBa0I7QUFJdEIsSUFBTSx3QkFBd0I7QUFFOUIsSUFBTSx5QkFBeUI7OztBREF0QyxJQUFNLG9CQUFOLGNBQWdDLHVCQUFXO0FBQUEsRUFDMUMsWUFBb0IsTUFBc0IsTUFBa0I7QUFDM0QsVUFBTTtBQURhO0FBQXNCO0FBQUEsRUFFMUM7QUFBQSxFQUVBLEdBQUcsT0FBMEI7QUFDNUIsV0FBTyxLQUFLLFNBQVMsTUFBTTtBQUFBLEVBQzVCO0FBQUEsRUFFQSxRQUFRO0FBQ1AsVUFBTSxPQUFPLFNBQVMsY0FBYyxVQUFVO0FBQzlDLFNBQUssY0FBYyxLQUFLO0FBQ3hCLFNBQUssTUFBTSxrQkFBa0I7QUFDN0IsU0FBSyxNQUFNLFFBQVE7QUFFbkIsV0FBTztBQUFBLEVBQ1I7QUFDRDtBQUVBLElBQU0sd0JBQXdCLENBQUMsT0FBd0IsU0FDdEQsdUJBQVcsUUFBUTtBQUFBLEVBQ2xCLFFBQVEsSUFBSSxrQkFBa0IsTUFBTSxDQUFDLEdBQUcsSUFBSTtBQUM3QyxDQUFDO0FBRUYsSUFBTSxtQkFBbUIsSUFBSSwyQkFBZTtBQUFBLEVBQzNDLFFBQVE7QUFBQSxFQUNSLFlBQVksQ0FBQyxPQUFPLE1BQU0sUUFBUTtBQUNqQyxXQUFPLHNCQUFzQixPQUFPLElBQUk7QUFBQSxFQUN6QztBQUNELENBQUM7QUFFTSxJQUFNLGFBQWEsdUJBQVc7QUFBQSxFQUNwQyxNQUFNO0FBQUEsSUFFTCxZQUFZLE1BQWtCO0FBQzdCLFdBQUssYUFBYSxpQkFBaUIsV0FBVyxJQUFJO0FBQUEsSUFDbkQ7QUFBQSxJQUNBLE9BQU8sUUFBb0I7QUFDMUIsV0FBSyxhQUFhLGlCQUFpQixXQUFXLFFBQVEsS0FBSyxVQUFVO0FBQUEsSUFDdEU7QUFBQSxJQUNBLFVBQVU7QUFDVCxXQUFLLGFBQWEsdUJBQVc7QUFBQSxJQUM5QjtBQUFBLEVBQ0Q7QUFBQSxFQUNBO0FBQUEsSUFDQyxhQUFhLENBQUMsYUFBYSxTQUFTO0FBQUEsSUFDcEMsU0FBUyxDQUFDLFdBQ1QsdUJBQVcsYUFBYSxHQUFHLENBQUMsU0FBUztBQTdEeEM7QUE4REksZUFBTyxVQUFLLE9BQU8sTUFBTSxNQUFsQixtQkFBcUIsZUFBYyx1QkFBVztBQUFBLElBQ3RELENBQUM7QUFBQSxFQUNIO0FBQ0Q7OztBRWpFQSxJQUFBQyxlQVVPOzs7QUNWUCxJQUFBQyxtQkFBMkQ7OztBQ0czRCxJQUFJO0FBQ0osSUFBTSxRQUFRLElBQUksV0FBVyxFQUFFO0FBQ2hCLFNBQVIsTUFBdUI7QUFFNUIsTUFBSSxDQUFDLGlCQUFpQjtBQUVwQixzQkFBa0IsT0FBTyxXQUFXLGVBQWUsT0FBTyxtQkFBbUIsT0FBTyxnQkFBZ0IsS0FBSyxNQUFNO0FBRS9HLFFBQUksQ0FBQyxpQkFBaUI7QUFDcEIsWUFBTSxJQUFJLE1BQU0sMEdBQTBHO0FBQUEsSUFDNUg7QUFBQSxFQUNGO0FBRUEsU0FBTyxnQkFBZ0IsS0FBSztBQUM5Qjs7O0FDakJBLElBQU8sZ0JBQVE7OztBQ0VmLFNBQVMsU0FBUyxNQUFNO0FBQ3RCLFNBQU8sT0FBTyxTQUFTLFlBQVksY0FBTSxLQUFLLElBQUk7QUFDcEQ7QUFFQSxJQUFPLG1CQUFROzs7QUNBZixJQUFNLFlBQVksQ0FBQztBQUVuQixTQUFTLElBQUksR0FBRyxJQUFJLEtBQUssRUFBRSxHQUFHO0FBQzVCLFlBQVUsTUFBTSxJQUFJLEtBQU8sU0FBUyxFQUFFLEVBQUUsTUFBTSxDQUFDLENBQUM7QUFDbEQ7QUFFTyxTQUFTLGdCQUFnQixLQUFLLFNBQVMsR0FBRztBQUcvQyxTQUFPLFVBQVUsSUFBSSxTQUFTLENBQUMsQ0FBQyxJQUFJLFVBQVUsSUFBSSxTQUFTLENBQUMsQ0FBQyxJQUFJLFVBQVUsSUFBSSxTQUFTLENBQUMsQ0FBQyxJQUFJLFVBQVUsSUFBSSxTQUFTLENBQUMsQ0FBQyxJQUFJLE1BQU0sVUFBVSxJQUFJLFNBQVMsQ0FBQyxDQUFDLElBQUksVUFBVSxJQUFJLFNBQVMsQ0FBQyxDQUFDLElBQUksTUFBTSxVQUFVLElBQUksU0FBUyxDQUFDLENBQUMsSUFBSSxVQUFVLElBQUksU0FBUyxDQUFDLENBQUMsSUFBSSxNQUFNLFVBQVUsSUFBSSxTQUFTLENBQUMsQ0FBQyxJQUFJLFVBQVUsSUFBSSxTQUFTLENBQUMsQ0FBQyxJQUFJLE1BQU0sVUFBVSxJQUFJLFNBQVMsRUFBRSxDQUFDLElBQUksVUFBVSxJQUFJLFNBQVMsRUFBRSxDQUFDLElBQUksVUFBVSxJQUFJLFNBQVMsRUFBRSxDQUFDLElBQUksVUFBVSxJQUFJLFNBQVMsRUFBRSxDQUFDLElBQUksVUFBVSxJQUFJLFNBQVMsRUFBRSxDQUFDLElBQUksVUFBVSxJQUFJLFNBQVMsRUFBRSxDQUFDO0FBQ25mOzs7QUNkQSxTQUFTLE1BQU0sTUFBTTtBQUNuQixNQUFJLENBQUMsaUJBQVMsSUFBSSxHQUFHO0FBQ25CLFVBQU0sVUFBVSxjQUFjO0FBQUEsRUFDaEM7QUFFQSxNQUFJO0FBQ0osUUFBTSxNQUFNLElBQUksV0FBVyxFQUFFO0FBRTdCLE1BQUksQ0FBQyxLQUFLLElBQUksU0FBUyxLQUFLLE1BQU0sR0FBRyxDQUFDLEdBQUcsRUFBRSxPQUFPO0FBQ2xELE1BQUksQ0FBQyxJQUFJLE1BQU0sS0FBSztBQUNwQixNQUFJLENBQUMsSUFBSSxNQUFNLElBQUk7QUFDbkIsTUFBSSxDQUFDLElBQUksSUFBSTtBQUViLE1BQUksQ0FBQyxLQUFLLElBQUksU0FBUyxLQUFLLE1BQU0sR0FBRyxFQUFFLEdBQUcsRUFBRSxPQUFPO0FBQ25ELE1BQUksQ0FBQyxJQUFJLElBQUk7QUFFYixNQUFJLENBQUMsS0FBSyxJQUFJLFNBQVMsS0FBSyxNQUFNLElBQUksRUFBRSxHQUFHLEVBQUUsT0FBTztBQUNwRCxNQUFJLENBQUMsSUFBSSxJQUFJO0FBRWIsTUFBSSxDQUFDLEtBQUssSUFBSSxTQUFTLEtBQUssTUFBTSxJQUFJLEVBQUUsR0FBRyxFQUFFLE9BQU87QUFDcEQsTUFBSSxDQUFDLElBQUksSUFBSTtBQUdiLE1BQUksRUFBRSxLQUFLLElBQUksU0FBUyxLQUFLLE1BQU0sSUFBSSxFQUFFLEdBQUcsRUFBRSxLQUFLLGdCQUFnQjtBQUNuRSxNQUFJLEVBQUUsSUFBSSxJQUFJLGFBQWM7QUFDNUIsTUFBSSxFQUFFLElBQUksTUFBTSxLQUFLO0FBQ3JCLE1BQUksRUFBRSxJQUFJLE1BQU0sS0FBSztBQUNyQixNQUFJLEVBQUUsSUFBSSxNQUFNLElBQUk7QUFDcEIsTUFBSSxFQUFFLElBQUksSUFBSTtBQUNkLFNBQU87QUFDVDtBQUVBLElBQU8sZ0JBQVE7OztBQy9CZixTQUFTLGNBQWMsS0FBSztBQUMxQixRQUFNLFNBQVMsbUJBQW1CLEdBQUcsQ0FBQztBQUV0QyxRQUFNLFFBQVEsQ0FBQztBQUVmLFdBQVMsSUFBSSxHQUFHLElBQUksSUFBSSxRQUFRLEVBQUUsR0FBRztBQUNuQyxVQUFNLEtBQUssSUFBSSxXQUFXLENBQUMsQ0FBQztBQUFBLEVBQzlCO0FBRUEsU0FBTztBQUNUO0FBRU8sSUFBTSxNQUFNO0FBQ1osSUFBTSxNQUFNO0FBQ0osU0FBUixJQUFxQixNQUFNLFNBQVMsVUFBVTtBQUNuRCxXQUFTLGFBQWEsT0FBTyxXQUFXLEtBQUssUUFBUTtBQUNuRCxRQUFJO0FBRUosUUFBSSxPQUFPLFVBQVUsVUFBVTtBQUM3QixjQUFRLGNBQWMsS0FBSztBQUFBLElBQzdCO0FBRUEsUUFBSSxPQUFPLGNBQWMsVUFBVTtBQUNqQyxrQkFBWSxjQUFNLFNBQVM7QUFBQSxJQUM3QjtBQUVBLFVBQU0sYUFBYSxlQUFlLFFBQVEsZUFBZSxTQUFTLFNBQVMsV0FBVyxZQUFZLElBQUk7QUFDcEcsWUFBTSxVQUFVLGtFQUFrRTtBQUFBLElBQ3BGO0FBS0EsUUFBSSxRQUFRLElBQUksV0FBVyxLQUFLLE1BQU0sTUFBTTtBQUM1QyxVQUFNLElBQUksU0FBUztBQUNuQixVQUFNLElBQUksT0FBTyxVQUFVLE1BQU07QUFDakMsWUFBUSxTQUFTLEtBQUs7QUFDdEIsVUFBTSxDQUFDLElBQUksTUFBTSxDQUFDLElBQUksS0FBTztBQUM3QixVQUFNLENBQUMsSUFBSSxNQUFNLENBQUMsSUFBSSxLQUFPO0FBRTdCLFFBQUksS0FBSztBQUNQLGVBQVMsVUFBVTtBQUVuQixlQUFTLElBQUksR0FBRyxJQUFJLElBQUksRUFBRSxHQUFHO0FBQzNCLFlBQUksU0FBUyxDQUFDLElBQUksTUFBTSxDQUFDO0FBQUEsTUFDM0I7QUFFQSxhQUFPO0FBQUEsSUFDVDtBQUVBLFdBQU8sZ0JBQWdCLEtBQUs7QUFBQSxFQUM5QjtBQUdBLE1BQUk7QUFDRixpQkFBYSxPQUFPO0FBQUEsRUFDdEIsU0FBUyxLQUFQO0FBQUEsRUFBYTtBQUdmLGVBQWEsTUFBTTtBQUNuQixlQUFhLE1BQU07QUFDbkIsU0FBTztBQUNUOzs7QUNqRUEsSUFBTSxhQUFhLE9BQU8sV0FBVyxlQUFlLE9BQU8sY0FBYyxPQUFPLFdBQVcsS0FBSyxNQUFNO0FBQ3RHLElBQU8saUJBQVE7QUFBQSxFQUNiO0FBQ0Y7OztBQ0NBLFNBQVMsR0FBRyxTQUFTLEtBQUssUUFBUTtBQUNoQyxNQUFJLGVBQU8sY0FBYyxDQUFDLE9BQU8sQ0FBQyxTQUFTO0FBQ3pDLFdBQU8sZUFBTyxXQUFXO0FBQUEsRUFDM0I7QUFFQSxZQUFVLFdBQVcsQ0FBQztBQUN0QixRQUFNLE9BQU8sUUFBUSxXQUFXLFFBQVEsT0FBTyxLQUFLO0FBRXBELE9BQUssQ0FBQyxJQUFJLEtBQUssQ0FBQyxJQUFJLEtBQU87QUFDM0IsT0FBSyxDQUFDLElBQUksS0FBSyxDQUFDLElBQUksS0FBTztBQUUzQixNQUFJLEtBQUs7QUFDUCxhQUFTLFVBQVU7QUFFbkIsYUFBUyxJQUFJLEdBQUcsSUFBSSxJQUFJLEVBQUUsR0FBRztBQUMzQixVQUFJLFNBQVMsQ0FBQyxJQUFJLEtBQUssQ0FBQztBQUFBLElBQzFCO0FBRUEsV0FBTztBQUFBLEVBQ1Q7QUFFQSxTQUFPLGdCQUFnQixJQUFJO0FBQzdCO0FBRUEsSUFBTyxhQUFROzs7QUMxQmYsU0FBUyxFQUFFLEdBQUcsR0FBRyxHQUFHLEdBQUc7QUFDckIsVUFBUSxHQUFHO0FBQUEsSUFDVCxLQUFLO0FBQ0gsYUFBTyxJQUFJLElBQUksQ0FBQyxJQUFJO0FBQUEsSUFFdEIsS0FBSztBQUNILGFBQU8sSUFBSSxJQUFJO0FBQUEsSUFFakIsS0FBSztBQUNILGFBQU8sSUFBSSxJQUFJLElBQUksSUFBSSxJQUFJO0FBQUEsSUFFN0IsS0FBSztBQUNILGFBQU8sSUFBSSxJQUFJO0FBQUEsRUFDbkI7QUFDRjtBQUVBLFNBQVMsS0FBSyxHQUFHLEdBQUc7QUFDbEIsU0FBTyxLQUFLLElBQUksTUFBTSxLQUFLO0FBQzdCO0FBRUEsU0FBUyxLQUFLLE9BQU87QUFDbkIsUUFBTSxJQUFJLENBQUMsWUFBWSxZQUFZLFlBQVksVUFBVTtBQUN6RCxRQUFNLElBQUksQ0FBQyxZQUFZLFlBQVksWUFBWSxXQUFZLFVBQVU7QUFFckUsTUFBSSxPQUFPLFVBQVUsVUFBVTtBQUM3QixVQUFNLE1BQU0sU0FBUyxtQkFBbUIsS0FBSyxDQUFDO0FBRTlDLFlBQVEsQ0FBQztBQUVULGFBQVMsSUFBSSxHQUFHLElBQUksSUFBSSxRQUFRLEVBQUUsR0FBRztBQUNuQyxZQUFNLEtBQUssSUFBSSxXQUFXLENBQUMsQ0FBQztBQUFBLElBQzlCO0FBQUEsRUFDRixXQUFXLENBQUMsTUFBTSxRQUFRLEtBQUssR0FBRztBQUVoQyxZQUFRLE1BQU0sVUFBVSxNQUFNLEtBQUssS0FBSztBQUFBLEVBQzFDO0FBRUEsUUFBTSxLQUFLLEdBQUk7QUFDZixRQUFNLElBQUksTUFBTSxTQUFTLElBQUk7QUFDN0IsUUFBTSxJQUFJLEtBQUssS0FBSyxJQUFJLEVBQUU7QUFDMUIsUUFBTSxJQUFJLElBQUksTUFBTSxDQUFDO0FBRXJCLFdBQVMsSUFBSSxHQUFHLElBQUksR0FBRyxFQUFFLEdBQUc7QUFDMUIsVUFBTSxNQUFNLElBQUksWUFBWSxFQUFFO0FBRTlCLGFBQVMsSUFBSSxHQUFHLElBQUksSUFBSSxFQUFFLEdBQUc7QUFDM0IsVUFBSSxDQUFDLElBQUksTUFBTSxJQUFJLEtBQUssSUFBSSxDQUFDLEtBQUssS0FBSyxNQUFNLElBQUksS0FBSyxJQUFJLElBQUksQ0FBQyxLQUFLLEtBQUssTUFBTSxJQUFJLEtBQUssSUFBSSxJQUFJLENBQUMsS0FBSyxJQUFJLE1BQU0sSUFBSSxLQUFLLElBQUksSUFBSSxDQUFDO0FBQUEsSUFDcEk7QUFFQSxNQUFFLENBQUMsSUFBSTtBQUFBLEVBQ1Q7QUFFQSxJQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsS0FBSyxNQUFNLFNBQVMsS0FBSyxJQUFJLEtBQUssSUFBSSxHQUFHLEVBQUU7QUFDdEQsSUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLElBQUksS0FBSyxNQUFNLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDO0FBQ3RDLElBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRSxLQUFLLE1BQU0sU0FBUyxLQUFLLElBQUk7QUFFeEMsV0FBUyxJQUFJLEdBQUcsSUFBSSxHQUFHLEVBQUUsR0FBRztBQUMxQixVQUFNLElBQUksSUFBSSxZQUFZLEVBQUU7QUFFNUIsYUFBUyxJQUFJLEdBQUcsSUFBSSxJQUFJLEVBQUUsR0FBRztBQUMzQixRQUFFLENBQUMsSUFBSSxFQUFFLENBQUMsRUFBRSxDQUFDO0FBQUEsSUFDZjtBQUVBLGFBQVMsSUFBSSxJQUFJLElBQUksSUFBSSxFQUFFLEdBQUc7QUFDNUIsUUFBRSxDQUFDLElBQUksS0FBSyxFQUFFLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxHQUFHLENBQUM7QUFBQSxJQUM1RDtBQUVBLFFBQUksSUFBSSxFQUFFLENBQUM7QUFDWCxRQUFJLElBQUksRUFBRSxDQUFDO0FBQ1gsUUFBSSxJQUFJLEVBQUUsQ0FBQztBQUNYLFFBQUksSUFBSSxFQUFFLENBQUM7QUFDWCxRQUFJLElBQUksRUFBRSxDQUFDO0FBRVgsYUFBUyxJQUFJLEdBQUcsSUFBSSxJQUFJLEVBQUUsR0FBRztBQUMzQixZQUFNLElBQUksS0FBSyxNQUFNLElBQUksRUFBRTtBQUMzQixZQUFNLElBQUksS0FBSyxHQUFHLENBQUMsSUFBSSxFQUFFLEdBQUcsR0FBRyxHQUFHLENBQUMsSUFBSSxJQUFJLEVBQUUsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxNQUFNO0FBQzNELFVBQUk7QUFDSixVQUFJO0FBQ0osVUFBSSxLQUFLLEdBQUcsRUFBRSxNQUFNO0FBQ3BCLFVBQUk7QUFDSixVQUFJO0FBQUEsSUFDTjtBQUVBLE1BQUUsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxJQUFJLE1BQU07QUFDcEIsTUFBRSxDQUFDLElBQUksRUFBRSxDQUFDLElBQUksTUFBTTtBQUNwQixNQUFFLENBQUMsSUFBSSxFQUFFLENBQUMsSUFBSSxNQUFNO0FBQ3BCLE1BQUUsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxJQUFJLE1BQU07QUFDcEIsTUFBRSxDQUFDLElBQUksRUFBRSxDQUFDLElBQUksTUFBTTtBQUFBLEVBQ3RCO0FBRUEsU0FBTyxDQUFDLEVBQUUsQ0FBQyxLQUFLLEtBQUssS0FBTSxFQUFFLENBQUMsS0FBSyxLQUFLLEtBQU0sRUFBRSxDQUFDLEtBQUssSUFBSSxLQUFNLEVBQUUsQ0FBQyxJQUFJLEtBQU0sRUFBRSxDQUFDLEtBQUssS0FBSyxLQUFNLEVBQUUsQ0FBQyxLQUFLLEtBQUssS0FBTSxFQUFFLENBQUMsS0FBSyxJQUFJLEtBQU0sRUFBRSxDQUFDLElBQUksS0FBTSxFQUFFLENBQUMsS0FBSyxLQUFLLEtBQU0sRUFBRSxDQUFDLEtBQUssS0FBSyxLQUFNLEVBQUUsQ0FBQyxLQUFLLElBQUksS0FBTSxFQUFFLENBQUMsSUFBSSxLQUFNLEVBQUUsQ0FBQyxLQUFLLEtBQUssS0FBTSxFQUFFLENBQUMsS0FBSyxLQUFLLEtBQU0sRUFBRSxDQUFDLEtBQUssSUFBSSxLQUFNLEVBQUUsQ0FBQyxJQUFJLEtBQU0sRUFBRSxDQUFDLEtBQUssS0FBSyxLQUFNLEVBQUUsQ0FBQyxLQUFLLEtBQUssS0FBTSxFQUFFLENBQUMsS0FBSyxJQUFJLEtBQU0sRUFBRSxDQUFDLElBQUksR0FBSTtBQUNqVztBQUVBLElBQU8sZUFBUTs7O0FDN0ZmLElBQU0sS0FBSyxJQUFJLE1BQU0sSUFBTSxZQUFJO0FBQy9CLElBQU8sYUFBUTs7O0FDSGYsSUFBQUMsbUJBQWlEOzs7QUNBakQsc0JBUU87QUFHUCxTQUFTLG1CQUNSLE9BQ0EsU0FBaUMsQ0FBQyxHQUNqQztBQUVELFFBQU0sT0FBTyxNQUFNO0FBQ25CLE1BQUksQ0FBQztBQUFNLFVBQU0sSUFBSSxNQUFNLHNCQUFzQjtBQUVqRCxNQUFJLFFBQVEsVUFBVSxRQUFRLFNBQVM7QUFFdEMsVUFBTSxXQUFXLE1BQU07QUFDdkIsUUFBSSxDQUFDO0FBQVUsWUFBTSxJQUFJLE1BQU0sMEJBQTBCO0FBRXpELFFBQUksVUFBVTtBQUNiLGlCQUFXLFNBQVMsVUFBVTtBQUM3QixZQUFJLFlBQTZCLENBQUM7QUFFbEMsMkJBQW1CLE9BQU8sTUFBTTtBQUFBLE1BQ2pDO0FBQUEsSUFDRDtBQUFBLEVBR0QsV0FBVyxRQUFRLFFBQVE7QUFFMUIsVUFBTSxnQkFBZ0IsTUFBTSxPQUFPO0FBQ25DLFFBQUksQ0FBQztBQUFlLFlBQU0sSUFBSSxNQUFNLDJCQUEyQjtBQUcvRCxRQUFJLE1BQU0sT0FBTyxVQUFVLENBQUMsUUFBeUI7QUFFcEQsWUFBTSxRQUFRLElBQUksQ0FBQyxFQUFFLE9BQU87QUFDNUIsYUFBTyxTQUFTO0FBQUEsSUFDakIsQ0FBQztBQUNELFFBQUksT0FBTyxJQUFJO0FBRWQsYUFBTyxLQUFLLENBQUMsS0FBc0IsQ0FBQztBQUFBLElBQ3JDLE9BQU87QUFDTixhQUFPLEdBQUcsRUFBRSxLQUFLLEtBQXNCO0FBQUEsSUFDeEM7QUFBQSxFQUNEO0FBT0EsU0FBTztBQUNSO0FBRU8sU0FBUywyQkFBMkI7QUFDMUMsUUFBTSxFQUFFLFVBQVUsSUFBSSxRQUFRO0FBQzlCLFFBQU0sV0FBMEIsVUFBVSxRQUFRO0FBRWxELFFBQU0sWUFBNEIsU0FBUyxRQUFRO0FBQ25ELFNBQU8sbUJBQW1CLFNBQVM7QUFDcEM7QUFFTyxTQUFTLG1CQUFtQixhQUFvQixNQUF1QjtBQUM3RSxNQUFJLGVBQWUsS0FBSyxRQUFRLGlCQUFpQjtBQUNqRCxNQUFJLGFBQWEsWUFBWSxVQUFVLENBQUMsUUFBeUI7QUFDaEUsVUFBTSxVQUFVLElBQUksQ0FBQyxFQUFFLEtBQUssWUFBWSxRQUFRLGlCQUFpQjtBQUNqRSxXQUFPLFdBQVc7QUFBQSxFQUNuQixDQUFDO0FBQ0QsU0FBTztBQUNSO0FBRU8sU0FBUyxnQkFDZixhQUNBLFlBQ0EsTUFDQztBQUNELE1BQUksbUJBQTBCLENBQUM7QUFDL0IsTUFBSSxrQkFBeUIsQ0FBQztBQUM5QixNQUFJLGVBQXNCLENBQUM7QUFFM0IsTUFBSSxZQUFZLGFBQWEsQ0FBQyxHQUFHO0FBQ2hDLHVCQUFtQixZQUFZLGFBQWEsQ0FBQztBQUM3QyxtQkFBZSxDQUFDLEdBQUcsY0FBYyxHQUFHLGdCQUFnQjtBQUFBLEVBQ3JEO0FBQ0EsTUFBSSxZQUFZLGFBQWEsQ0FBQyxHQUFHO0FBQ2hDLHNCQUFrQixZQUFZLGFBQWEsQ0FBQztBQUM1QyxtQkFBZSxDQUFDLEdBQUcsY0FBYyxHQUFHLGVBQWU7QUFBQSxFQUNwRDtBQUVBLE1BQUksUUFBUSxhQUFhO0FBQUEsSUFDeEIsQ0FBQyxNQUFxQixFQUFFLGFBQWEsRUFBRSxNQUFNLFFBQVE7QUFBQSxFQUN0RDtBQUNBLFNBQU8sRUFBRSxjQUFjLGtCQUFrQixpQkFBaUIsTUFBTTtBQUNqRTtBQUVBLGVBQXNCLHNCQUNyQixhQUNBLFlBQ0EsTUFDQSxNQUNDO0FBQ0QsTUFBSSxFQUFFLGNBQWMsa0JBQWtCLGdCQUFnQixJQUFJO0FBQUEsSUFDekQ7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLEVBQ0Q7QUFFQSxNQUFJLGNBQWMsWUFBWTtBQUFBLElBQUksQ0FBQyxRQUNsQyxJQUFJLElBQUksQ0FBQyxNQUFxQixFQUFFLGFBQWEsRUFBRSxNQUFNLElBQUk7QUFBQSxFQUMxRDtBQUNBLE1BQUksd0JBQXdCLGlCQUFpQjtBQUFBLElBQzVDLENBQUMsTUFBcUIsRUFBRSxhQUFhLEVBQUUsTUFBTTtBQUFBLEVBQzlDO0FBQ0EsTUFBSSx1QkFBdUIsZ0JBQWdCO0FBQUEsSUFDMUMsQ0FBQyxNQUFxQixFQUFFLGFBQWEsRUFBRSxNQUFNO0FBQUEsRUFDOUM7QUFDQSxRQUFNLEVBQUUsVUFBVSxJQUFJLFFBQVE7QUFDOUIsTUFDQyxZQUNFLE9BQU8sQ0FBQyxHQUFHLE1BQU0sS0FBSyxVQUFVLEVBQ2hDLEtBQUssRUFDTCxTQUFTLElBQUksS0FDZixDQUFDLHNCQUFzQixTQUFTLElBQUksS0FDcEMsQ0FBQyxxQkFBcUIsU0FBUyxJQUFJLEdBQ2xDO0FBRUQsUUFBSSxrQkFBeUIsQ0FBQztBQUM5QixRQUFJLGFBQW9CLENBQUM7QUFDekIsZ0JBQVksUUFBUSxDQUFDLFVBQVUsTUFBTTtBQUNwQyxVQUNDLFlBQVkseUJBQ1osWUFBWSx3QkFDWixjQUFjLEdBQ2I7QUFDRCxZQUFJLFNBQVMsU0FBUyxJQUFJLEdBQUc7QUFDNUIsNEJBQWtCO0FBQ2xCLHVCQUFhLFlBQVksQ0FBQztBQUFBLFFBQzNCO0FBQUEsTUFDRDtBQUFBLElBQ0QsQ0FBQztBQUVELFVBQU0sZUFBZSxXQUFXO0FBQUEsTUFDL0IsQ0FBQyxNQUFNLEVBQUUsWUFBWSxNQUFNLFdBQVc7QUFBQSxJQUN2QyxFQUFFLENBQUM7QUFDSCxRQUFJLE9BQU8sV0FBVyxnQkFBZ0IsUUFBUSxJQUFJLENBQUM7QUFDbkQsY0FBVSxXQUFXLElBQUk7QUFFekIsV0FBTyxFQUFFLFNBQVMsTUFBTSxNQUFNLE9BQU8sYUFBYTtBQUFBLEVBQ25ELFdBQVcsc0JBQXNCLFNBQVMsSUFBSSxHQUFHO0FBRWhELFVBQU0sZUFBZSxpQkFBaUI7QUFBQSxNQUNyQyxDQUFDLE1BQU0sRUFBRSxZQUFZLE1BQU0sV0FBVztBQUFBLElBQ3ZDLEVBQUUsQ0FBQztBQUNILFFBQUksT0FBTyxpQkFBaUIsc0JBQXNCLFFBQVEsSUFBSSxDQUFDO0FBQy9ELGNBQVUsV0FBVyxJQUFJO0FBQ3pCLFdBQU8sRUFBRSxTQUFTLE1BQU0sTUFBTSxPQUFPLGFBQWE7QUFBQSxFQUNuRCxXQUFXLHFCQUFxQixTQUFTLElBQUksR0FBRztBQUUvQyxVQUFNLGVBQWUsZ0JBQWdCO0FBQUEsTUFDcEMsQ0FBQyxNQUFNLEVBQUUsWUFBWSxNQUFNLFdBQVc7QUFBQSxJQUN2QyxFQUFFLENBQUM7QUFFSCxRQUFJLE9BQU8sZ0JBQWdCLHFCQUFxQixRQUFRLElBQUksQ0FBQztBQUM3RCxjQUFVLFdBQVcsSUFBSTtBQUN6QixXQUFPLEVBQUUsU0FBUyxNQUFNLE1BQU0sT0FBTyxhQUFhO0FBQUEsRUFDbkQsV0FBVyxpQkFBaUIsU0FBUyxHQUFHO0FBRXZDLFVBQU0sZUFBZSxpQkFBaUI7QUFBQSxNQUNyQyxDQUFDLE1BQU0sRUFBRSxZQUFZLE1BQU0sV0FBVztBQUFBLElBQ3ZDLEVBQUUsQ0FBQztBQUVILFFBQUksV0FBVyxVQUFVLFFBQVE7QUFDakMsY0FBVSxjQUFjLFlBQVk7QUFDcEMsUUFBSSxVQUFVLFVBQVUsUUFBUSxJQUFJO0FBQ3BDLFVBQU0sZUFBZSxTQUFTLElBQUk7QUFDbEMsY0FBVSxXQUFXLE9BQU87QUFDNUIsY0FBVSxjQUFjLFFBQVE7QUFDaEMsV0FBTyxFQUFFLFNBQVMsTUFBTSxNQUFNLGFBQWE7QUFBQSxFQUM1QyxXQUFXLGdCQUFnQixTQUFTLEdBQUc7QUFFdEMsVUFBTSxlQUFlLGdCQUFnQjtBQUFBLE1BQ3BDLENBQUMsTUFBTSxFQUFFLFlBQVksTUFBTSxXQUFXO0FBQUEsSUFDdkMsRUFBRSxDQUFDO0FBRUgsUUFBSSxXQUFXLFVBQVUsUUFBUTtBQUNqQyxjQUFVLGNBQWMsWUFBWTtBQUNwQyxRQUFJLFVBQVUsVUFBVSxRQUFRLElBQUk7QUFDcEMsVUFBTSxlQUFlLFNBQVMsSUFBSTtBQUNsQyxjQUFVLFdBQVcsT0FBTztBQUM1QixjQUFVLGNBQWMsUUFBUTtBQUNoQyxXQUFPLEVBQUUsU0FBUyxNQUFNLE1BQU0sYUFBYTtBQUFBLEVBQzVDLE9BQU87QUFFTixVQUFNLFdBQVcsVUFBVSxRQUFRO0FBQ25DLFFBQUksVUFBVSxVQUFVLGtCQUFrQixRQUFRO0FBQ2xELFVBQU0sZUFBZSxTQUFTLElBQUk7QUFDbEMsV0FBTyxFQUFFLFNBQVMsTUFBTSxLQUFLO0FBQUEsRUFDOUI7QUFDRDtBQUVBLGVBQXNCLGVBQWUsTUFBcUIsTUFBYztBQUN2RSxNQUFJLGFBQ0gsUUFBUSxFQUFFLE1BQU0sc0JBQXNCLElBQUk7QUFDM0MsTUFBSSxjQUFjLHNCQUFzQjtBQUN2QyxVQUFNLEtBQUssU0FBUyxZQUFZLEVBQUUsUUFBUSxNQUFNLENBQUM7QUFDbkQ7OztBQzlMQSxJQUFBQyxtQkFBdUQ7OztBQ3JCdkQsSUFBQUMsZUFBc0Q7QUFDdEQsSUFBQUMsZ0JBQXdDO0FBR3hDLElBQU0sZUFBZSwwQkFBWSxPQUFxQztBQUFBLEVBQ3JFLEtBQUssQ0FBQyxFQUFFLE1BQU0sR0FBRyxHQUFHLFlBQVk7QUFBQSxJQUMvQixNQUFNLE9BQU8sT0FBTyxJQUFJO0FBQUEsSUFDeEIsSUFBSSxPQUFPLE9BQU8sRUFBRTtBQUFBLEVBQ3JCO0FBQ0QsQ0FBQztBQUVELElBQU0sc0JBQXNCLDBCQUFZLE9BQXFDO0FBQUEsRUFDNUUsS0FBSyxDQUFDLEVBQUUsTUFBTSxHQUFHLEdBQUcsWUFBWTtBQUFBLElBQy9CLE1BQU0sT0FBTyxPQUFPLElBQUk7QUFBQSxJQUN4QixJQUFJLE9BQU8sT0FBTyxFQUFFO0FBQUEsRUFDckI7QUFDRCxDQUFDO0FBRUQsSUFBTSxpQkFBaUIsMEJBQVksT0FBcUM7QUFBQSxFQUN2RSxLQUFLLENBQUMsRUFBRSxNQUFNLEdBQUcsR0FBRyxZQUFZO0FBQUEsSUFDL0IsTUFBTSxPQUFPLE9BQU8sSUFBSTtBQUFBLElBQ3hCLElBQUksT0FBTyxPQUFPLEVBQUU7QUFBQSxFQUNyQjtBQUNELENBQUM7QUFFRCxJQUFNLGlCQUFpQix5QkFBVyxPQUFzQjtBQUFBLEVBQ3ZELFNBQVM7QUFDUixXQUFPLHdCQUFXO0FBQUEsRUFDbkI7QUFBQSxFQUNBLE9BQU8sV0FBVyxJQUFJO0FBQ3JCLGdCQUFZLFVBQVUsSUFBSSxHQUFHLE9BQU87QUFDcEMsYUFBUyxLQUFLLEdBQUc7QUFDaEIsVUFBSSxFQUFFLEdBQUcsbUJBQW1CLEdBQUc7QUFDOUIsb0JBQVksVUFBVSxPQUFPO0FBQUEsVUFDNUIsS0FBSyxDQUFDLHFCQUFxQixNQUFNLEVBQUUsTUFBTSxNQUFNLEVBQUUsTUFBTSxFQUFFLENBQUM7QUFBQSxRQUMzRCxDQUFDO0FBQUEsTUFDRixXQUFXLEVBQUUsR0FBRyxZQUFZLEdBQUc7QUFDOUIsb0JBQVksVUFBVSxPQUFPO0FBQUEsVUFDNUIsS0FBSyxDQUFDLGNBQWMsTUFBTSxFQUFFLE1BQU0sTUFBTSxFQUFFLE1BQU0sRUFBRSxDQUFDO0FBQUEsUUFDcEQsQ0FBQztBQUFBLE1BQ0YsV0FBVyxFQUFFLEdBQUcsY0FBYyxHQUFHO0FBQ2hDLG9CQUFZLFVBQVUsT0FBTztBQUFBLFVBQzVCLFFBQVEsQ0FBQyxNQUFNLE9BQU87QUFDckIsbUJBQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxRQUFRLE9BQU8sRUFBRSxNQUFNO0FBQUEsVUFDbEQ7QUFBQSxRQUNELENBQUM7QUFBQSxNQUNGO0FBQ0QsV0FBTztBQUFBLEVBQ1I7QUFBQSxFQUNBLFNBQVMsQ0FBQ0MsT0FBTSx3QkFBVyxZQUFZLEtBQUtBLEVBQUM7QUFDOUMsQ0FBQztBQUVELElBQU0sZ0JBQWdCLHdCQUFXLEtBQUssRUFBRSxPQUFPLFlBQVksQ0FBQztBQUM1RCxJQUFNLHVCQUF1Qix3QkFBVyxLQUFLLEVBQUUsT0FBTyxvQkFBb0IsQ0FBQztBQUMzRSxJQUFNLFFBQVEsd0JBQVcsVUFBVSxDQUFDLENBQUM7QUFDckMsSUFBTSxpQkFBaUIsd0JBQVcsVUFBVTtBQUFBLEVBQzNDLGNBQWM7QUFBQSxJQUNiLG9CQUNDO0FBQUEsSUFDRCxPQUFPO0FBQUEsRUFDUjtBQUNELENBQUM7QUFRRCxJQUFNLHdCQUF3Qix3QkFBVyxVQUFVO0FBQUEsRUFDbEQsc0JBQXNCO0FBQUEsSUFDckIsb0JBQ0M7QUFBQSxJQUNELE9BQU87QUFBQSxFQUNSO0FBQ0QsQ0FBQztBQUVNLFNBQVMsbUJBQW1CLE1BQWtCLE1BQWMsSUFBWTtBQUM5RSxNQUFJLFVBQWtDLENBQUMsYUFBYSxHQUFHLEVBQUUsTUFBTSxHQUFHLENBQUMsQ0FBQztBQUVwRSxNQUFJLENBQUMsUUFBUTtBQUFRLFdBQU87QUFFNUIsTUFBSSxDQUFDLEtBQUssTUFBTSxNQUFNLGdCQUFnQixLQUFLO0FBQzFDLFlBQVEsS0FBSywwQkFBWSxhQUFhLEdBQUcsQ0FBQyxnQkFBZ0IsS0FBSyxDQUFDLENBQUM7QUFFbEUsT0FBSyxTQUFTLEVBQUUsUUFBUSxDQUFDO0FBQ3pCLFNBQU87QUFDUjtBQUdPLFNBQVMsMEJBQ2YsTUFDQSxNQUNBLElBQ0M7QUFDRCxNQUFJLFVBQWtDLENBQUMsb0JBQW9CLEdBQUcsRUFBRSxNQUFNLEdBQUcsQ0FBQyxDQUFDO0FBRTNFLE1BQUksQ0FBQyxRQUFRO0FBQVEsV0FBTztBQUU1QixNQUFJLENBQUMsS0FBSyxNQUFNLE1BQU0sZ0JBQWdCLEtBQUs7QUFDMUMsWUFBUSxLQUFLLDBCQUFZLGFBQWEsR0FBRyxDQUFDLGdCQUFnQixLQUFLLENBQUMsQ0FBQztBQUVsRSxPQUFLLFNBQVMsRUFBRSxRQUFRLENBQUM7QUFFekIsU0FBTztBQUNSO0FBRU8sU0FBUyxnQkFBZ0IsTUFBa0IsTUFBYyxJQUFZO0FBQzNFLE1BQUksVUFBa0MsQ0FBQyxlQUFlLEdBQUcsRUFBRSxNQUFNLEdBQUcsQ0FBQyxDQUFDO0FBRXRFLE1BQUksQ0FBQyxRQUFRO0FBQVEsV0FBTztBQUU1QixPQUFLLFNBQVMsRUFBRSxRQUFRLENBQUM7QUFDekIsU0FBTztBQUNSOzs7QUR0RkEsSUFBQUMsZUFBMkI7QUFPM0IsU0FBUyxjQUFjLE1BQXFCO0FBbkM1QztBQW9DQyxNQUFJLENBQUM7QUFBTSxXQUFPO0FBQ2xCLFFBQU0sT0FBTyxLQUFLO0FBR2xCLFFBQU0sVUFBUyxVQUFLLGVBQUwsbUJBQWlCO0FBSWhDLE1BQUksQ0FBQyxPQUFPLGNBQWMsT0FBTyxjQUFjLHlCQUFZO0FBRTFELFVBQU0sYUFBYSxPQUFPO0FBRTFCLFdBQU87QUFBQSxFQUdSO0FBQ0EsU0FBTztBQUNSO0FBRUEsU0FBUyx1QkFDUixNQUNBLGFBQ1U7QUFDVixRQUFNLGVBQWUsWUFBWSxxQkFBcUIsTUFBTTtBQUM1RCxXQUFTLElBQUksR0FBRyxJQUFJLGFBQWEsUUFBUSxLQUFLO0FBQzdDLFFBQUksYUFBYSxDQUFDLE1BQU0sTUFBTTtBQUM3QixhQUFPO0FBQUEsSUFDUjtBQUFBLEVBQ0Q7QUFDQSxTQUFPO0FBQ1I7QUFFQSxTQUFTLGVBQWUsS0FBYTtBQUVwQyxRQUFNLHFCQUFxQjtBQUczQixNQUFJLHNCQUEyQixDQUFDO0FBR2hDLE1BQUk7QUFDSixVQUFRLFFBQVEsbUJBQW1CLEtBQUssR0FBRyxPQUFPLE1BQU07QUFHdkQsd0JBQW9CLE1BQU0sQ0FBQyxDQUFDLElBQUksTUFBTSxDQUFDO0FBQUEsRUFDeEM7QUFFQSxTQUFPO0FBQ1I7QUFFTyxTQUFTLE1BQU0sY0FBbUI7QUFDeEMsU0FBTyxJQUFJLFFBQVEsQ0FBQyxZQUFZO0FBQy9CLGVBQVcsU0FBUyxZQUFZO0FBQUEsRUFDakMsQ0FBQztBQUNGO0FBRUEsU0FBUyx1QkFDUixNQUNBLE1BQ0EsUUFDQSxRQUNBLFlBQ0EsUUFDQSxNQUNDO0FBQ0QsTUFBSSxTQUFTLFlBQVksVUFBVTtBQUlsQyxVQUFNQyxVQUFTLGdCQUFnQixJQUFJLEVBQUU7QUFDckMsVUFBTUMscUJBQW9CLHFCQUFxQkQsT0FBTTtBQUVyRCxVQUFNRSxnQkFBZSxLQUFLLEtBQUssWUFDN0IsY0FBYyxjQUFjLEVBQzVCLHNCQUFzQixFQUFFO0FBQzFCLFVBQU1DLGFBQ0wsS0FBSyxLQUFLLFlBQVksY0FBYyxjQUFjLEVBQUU7QUFDckQsVUFBTUMsZ0JBQWVELGFBQVlEO0FBSWpDLFFBQUksWUFBWUYsUUFBTztBQUN2QixRQUFJLFVBQVUsVUFBVSxjQUFjLGFBQWE7QUFDbkQsUUFBSSxhQUFhLFFBQVEsaUJBQWlCLHNCQUFzQjtBQUVoRSxRQUFJSyxtQkFBaUMsQ0FBQztBQUN0QyxhQUFTLElBQUksR0FBRyxJQUFJLFdBQVcsUUFBUSxLQUFLO0FBQzNDLFVBQUksT0FBTyxXQUFXLENBQUMsRUFBRSxzQkFBc0I7QUFDL0MsVUFBSSxLQUFLLE9BQU9GLGNBQWEsS0FBSyxVQUFVQyxlQUFjO0FBQ3pELFFBQUFDLGlCQUFnQixLQUFLLFdBQVcsQ0FBQyxDQUFDO0FBQUEsTUFDbkM7QUFBQSxJQUNEO0FBRUEsUUFBSSxjQUFjQSxpQkFBZ0I7QUFBQSxNQUFJLENBQUMsT0FDdEMsR0FBRyxhQUFhLE1BQU07QUFBQSxJQUN2QjtBQUVBLFFBQUksV0FBVyxLQUFLLEtBQUssT0FBTyxjQUFjLEVBQUU7QUFFaEQsUUFBSSxDQUFDLFlBQVksU0FBUyxVQUFVLEdBQUc7QUFDdEMsVUFBSSxZQUFZO0FBQUEsUUFDZixLQUFLLEtBQUs7QUFBQSxRQUNWO0FBQUEsUUFDQSxPQUFPLE1BQU0sR0FBRyxPQUFPLFNBQVMsQ0FBQztBQUFBLFFBQ2pDLE9BQU8sTUFBTSxHQUFHLE9BQU8sTUFBTTtBQUFBLE1BQzlCO0FBQ0EsVUFBSSxDQUFDO0FBQVcsY0FBTSxJQUFJLE1BQU0scUJBQXFCO0FBQ3JELFVBQUksYUFBYSxVQUFVO0FBQzNCLFVBQUksV0FBVyxVQUFVO0FBRXpCLFdBQUssS0FBSyxPQUFPO0FBQUEsUUFDaEI7QUFBQSxVQUNDLE1BQU0sT0FBTyxPQUFPLFlBQVksRUFBRSxJQUFJLEVBQUUsQ0FBQztBQUFBLFVBQ3pDLElBQUksT0FBTyxPQUFPLFVBQVUsRUFBRSxJQUFJLEVBQUUsQ0FBQztBQUFBLFFBQ3RDO0FBQUEsUUFDQTtBQUFBLE1BQ0Q7QUFBQSxJQUNEO0FBRUEsZUFBVyxNQUFNO0FBRWhCLFVBQUksU0FBUyxLQUFLLEtBQUssT0FBTyxjQUFjLEVBQUU7QUFFOUMsVUFBSUMsYUFBWSxLQUFLLFlBQVksY0FBYyxlQUFlO0FBQzlELE1BQUFBLFdBQVUsVUFBVSxPQUFPLFdBQVc7QUFDdEMsTUFBQUEsV0FBVSxVQUFVLE9BQU8sWUFBWTtBQUN2QyxNQUFBQSxXQUFVLFVBQVUsT0FBTyxZQUFZO0FBQ3ZDLE1BQUFBLFdBQVUsVUFBVSxPQUFPLGVBQWU7QUFFMUMsVUFBSSxhQUFhLFVBQVUsUUFBUTtBQUNsQyxRQUFBQSxXQUFVLFVBQVUsSUFBSSxXQUFXO0FBQUEsTUFDcEMsV0FBVyxhQUFhLFVBQVUsQ0FBQyxRQUFRO0FBQzFDLFFBQUFBLFdBQVUsVUFBVSxJQUFJLFlBQVk7QUFBQSxNQUNyQyxXQUFXLFdBQVcsUUFBUTtBQUU3QixRQUFBQSxXQUFVLFVBQVUsSUFBSSxZQUFZO0FBQUEsTUFDckMsT0FBTztBQUVOLFFBQUFBLFdBQVUsVUFBVSxJQUFJLGVBQWU7QUFBQSxNQUN4QztBQUFBLElBQ0QsR0FBRyxFQUFFO0FBRUw7QUFBQSxFQUNEO0FBS0EsUUFBTSxTQUFTLGdCQUFnQixJQUFJLEVBQUU7QUFDckMsUUFBTSxvQkFBb0IscUJBQXFCLE1BQU07QUFFckQsUUFBTSxlQUFlLEtBQUssS0FBSyxZQUM3QixjQUFjLGNBQWMsRUFDNUIsc0JBQXNCLEVBQUU7QUFDMUIsUUFBTSxZQUNMLEtBQUssS0FBSyxZQUFZLGNBQWMsY0FBYyxFQUFFO0FBQ3JELFFBQU0sZUFBZSxZQUFZO0FBR2pDLE1BQUksa0JBQTRCLENBQUM7QUFDakMsV0FBUyxJQUFJLEdBQUcsSUFBSSxrQkFBa0IsU0FBUyxRQUFRLEtBQUs7QUFDM0QsUUFBSSxRQUFRLGtCQUFrQixTQUFTLENBQUMsRUFBRSxhQUFhLE9BQU87QUFDOUQsUUFBSSxTQUFTO0FBQU07QUFDbkIsUUFBSSxnQkFBZ0IsZUFBZSxLQUFLO0FBQ3hDLFFBQUksTUFBTSxXQUFXLGNBQWMsS0FBSyxFQUFFLFFBQVEsTUFBTSxFQUFFLENBQUM7QUFDM0QsUUFBSSxPQUFPO0FBQU07QUFFakIsUUFDQyxhQUFhLE9BQ2IsT0FBTyxnQkFDUCxrQkFBa0IsU0FBUyxDQUFDLEdBQzNCO0FBQ0QsVUFBSSxZQUFZLGtCQUFrQixTQUFTLENBQUMsRUFBRSxhQUFhLFdBQVc7QUFDdEUsVUFBSSxXQUFXO0FBQ2Qsd0JBQWdCLEtBQUssS0FBSyxNQUFNLFNBQVMsRUFBRSxVQUFVO0FBQUEsTUFDdEQ7QUFBQSxJQUNEO0FBQUEsRUFDRDtBQUVBLE1BQUksQ0FBQyxnQkFBZ0IsU0FBUyxVQUFVLEdBQUc7QUFDMUMsUUFBSSxXQUFXLEtBQUssS0FBSyxPQUFPLGNBQWMsRUFBRTtBQUVoRCxRQUFJLFlBQVk7QUFBQSxNQUNmLEtBQUssS0FBSztBQUFBLE1BQ1Y7QUFBQSxNQUNBLE9BQU8sTUFBTSxHQUFHLE9BQU8sU0FBUyxDQUFDO0FBQUEsTUFDakMsT0FBTyxNQUFNLEdBQUcsT0FBTyxNQUFNO0FBQUEsSUFDOUI7QUFDQSxRQUFJLENBQUM7QUFBVyxZQUFNLElBQUksTUFBTSxxQkFBcUI7QUFDckQsUUFBSSxhQUFhLFVBQVU7QUFDM0IsUUFBSSxXQUFXLFVBQVU7QUFFekIsU0FBSyxLQUFLLE9BQU87QUFBQSxNQUNoQjtBQUFBLFFBQ0MsTUFBTSxPQUFPLE9BQU8sWUFBWSxFQUFFLElBQUksRUFBRSxDQUFDO0FBQUEsUUFDekMsSUFBSSxPQUFPLE9BQU8sVUFBVSxFQUFFLElBQUksRUFBRSxDQUFDO0FBQUEsTUFDdEM7QUFBQSxNQUNBO0FBQUEsSUFDRDtBQUNBLGVBQVcsTUFBTTtBQUVoQixVQUFJLFNBQVMsS0FBSyxLQUFLLE9BQU8sY0FBYyxFQUFFO0FBQzlDLFVBQUksWUFBWSxLQUFLLFlBQVksY0FBYyxlQUFlO0FBQzlELGdCQUFVLFVBQVUsT0FBTyxXQUFXO0FBQ3RDLGdCQUFVLFVBQVUsT0FBTyxZQUFZO0FBQ3ZDLGdCQUFVLFVBQVUsT0FBTyxZQUFZO0FBQ3ZDLGdCQUFVLFVBQVUsT0FBTyxlQUFlO0FBRTFDLFVBQUksYUFBYSxVQUFVLFFBQVE7QUFDbEMsa0JBQVUsVUFBVSxJQUFJLFdBQVc7QUFBQSxNQUNwQyxXQUFXLGFBQWEsVUFBVSxDQUFDLFFBQVE7QUFDMUMsa0JBQVUsVUFBVSxJQUFJLFlBQVk7QUFBQSxNQUNyQyxXQUFXLFdBQVcsUUFBUTtBQUU3QixrQkFBVSxVQUFVLElBQUksWUFBWTtBQUFBLE1BQ3JDLE9BQU87QUFFTixrQkFBVSxVQUFVLElBQUksZUFBZTtBQUFBLE1BQ3hDO0FBQUEsSUFDRCxHQUFHLEVBQUU7QUFBQSxFQUNOO0FBQ0Q7QUFFQSxTQUFTLDBCQUNSLFdBQ0EsUUFDQSxNQUNBLGNBQ0M7QUF4UUY7QUF5UUMsUUFBTSxxQkFBcUIsVUFBVTtBQUNyQyxRQUFNLE9BQU8sbUJBQW1CLGNBQWMsTUFBTSxJQUFJO0FBRXhELDJDQUFNLGtCQUFOLG1CQUNHLGNBQWMsdUJBRGpCLG1CQUVHLFVBQVUsT0FBTztBQUVwQiwrQkFBTSxVQUFVLE9BQU87QUFFdkIsTUFBSSxjQUFjO0FBQ2pCLFVBQU0sZUFBZSxtQkFBbUIsY0FBYyxNQUFNLFlBQVk7QUFFeEUsNkRBQWMsa0JBQWQsbUJBQ0csY0FBYyx1QkFEakIsbUJBRUcsVUFBVSxPQUFPO0FBQ3BCLGlEQUFjLFVBQVUsT0FBTztBQUFBLEVBQ2hDO0FBRUEsTUFBSSxhQUFhLFVBQVUsWUFBWSxNQUFNO0FBQzdDLE1BQUksQ0FBQyxZQUFZO0FBQ2hCLGdCQUFZO0FBQ1osVUFBTSxJQUFJLE1BQU0sdUJBQXVCO0FBQUEsRUFDeEM7QUFHQSxNQUFJLGFBQ0gseUJBQW9CLFVBQVUsTUFBOUIsbUJBQWlDLGNBQWM7QUFFaEQsTUFBSSxXQUFXO0FBQ2QsY0FBVSxVQUFVLE9BQU8sV0FBVztBQUN0QyxjQUFVLFVBQVUsT0FBTyxZQUFZO0FBQ3ZDLGNBQVUsVUFBVSxPQUFPLFlBQVk7QUFDdkMsY0FBVSxVQUFVLE9BQU8sZUFBZTtBQUFBLEVBQzNDO0FBQ0Q7QUFFQSxlQUFzQixvQkFBb0IsTUFBdUI7QUE3U2pFO0FBOFNDLE1BQUksU0FBUyxpQkFBaUI7QUFDOUIsTUFBSSxjQUFjLFVBQVU7QUFDNUIsTUFBSSxjQUFjO0FBR2xCLE1BQUksVUFBVTtBQUFNO0FBQ3BCLGNBQVk7QUFBQSxJQUNYLE1BQU0sR0FBRyxZQUFZO0FBQUEsRUFDdEIsQ0FBQztBQUVELE1BQUksQ0FBQztBQUFNO0FBR1gsTUFBSSxPQUFPLE1BQU0sS0FBSyxLQUFLLFNBQVMsRUFBRSxPQUFPLENBQUMsT0FBTyxHQUFHLFNBQVMsTUFBTSxDQUFDLEVBQUUsQ0FBQztBQUMzRSxtQkFBSyxrQkFBTCxtQkFDRyxjQUFjLHVCQURqQixtQkFFRyxVQUFVLElBQUk7QUFFakIsT0FBSyxVQUFVLElBQUksOEJBQThCO0FBRWpELGNBQVk7QUFBQSxJQUNYO0FBQUEsRUFDRCxDQUFDO0FBRUQsUUFBTSxnQkFBZ0IsS0FBSyxhQUFhLFdBQVc7QUFDbkQsTUFBSSxDQUFDO0FBQWUsVUFBTSxJQUFJLE1BQU0sMEJBQTBCO0FBRTlELFFBQU0sV0FBVyxLQUFLLE1BQU0sYUFBYTtBQUN6QyxRQUFNLGFBQWEsU0FBUztBQUc1QixNQUFJLGVBQWUsUUFBUSxZQUFZLGNBQWMsWUFBWTtBQUNoRSxnQkFBWSxXQUFXO0FBQ3ZCO0FBQUEsRUFDRDtBQUVBLE1BQUksQ0FBQyxRQUFRLE1BQU0sUUFBUSxNQUFNLE1BQU0sRUFBRSxJQUFJLFdBQVcsVUFBVTtBQUdsRSxNQUFJLGNBQWMseUJBQXlCO0FBRTNDLE1BQUksYUFBYSxtQkFBbUIsYUFBYSxJQUFJO0FBRXJELE1BQUksZUFBZSxZQUFZLFVBQVUsRUFBRSxPQUFPLENBQUMsU0FBd0I7QUFDMUUsUUFBSSxjQUFjLG9CQUFvQixJQUFJO0FBQzFDLFVBQU0sU0FBUyx1QkFBdUIsTUFBTSxXQUFXO0FBQ3ZELFdBQU87QUFBQSxFQUNSLENBQUMsRUFBRSxDQUFDO0FBR0osTUFBSSxpQkFBaUIsYUFBYTtBQUNsQyxNQUFJLENBQUM7QUFBZ0IsVUFBTSxJQUFJLE1BQU0sbUJBQW1CO0FBRXhELE1BQUksZ0JBQWdCLGFBQWEsZ0JBQWdCLCtCQUFjO0FBQzlELFVBQU0sYUFBeUIsY0FBYyxZQUFZO0FBQ3pELFFBQUksQ0FBQztBQUFZLFlBQU0sSUFBSSxNQUFNLHVCQUF1QjtBQUN4RCxVQUFNLFdBQVcsYUFBYSxLQUFLLE9BQU8sY0FBYztBQUV4RCxvQkFBZ0IsWUFBWSxNQUFNLEVBQUU7QUFDcEMsdUJBQW1CLFlBQVksTUFBTSxFQUFFO0FBU3ZDLGdCQUFZO0FBQUEsTUFDWDtBQUFBLE1BQ0EsYUFBYSxXQUFXO0FBQUEsTUFDeEIsZ0JBQWdCO0FBQUEsSUFDakIsQ0FBQztBQUFBLEVBQ0Y7QUFFQSxNQUFJLGtCQUFrQixTQUFTLG9CQUFvQjtBQUtuRCxRQUFNLEVBQUUsU0FBUyxNQUFNLGFBQWEsSUFBSSxNQUFNO0FBQUEsSUFDN0M7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLEVBQ0Q7QUFHQSxNQUFJLEtBQUssUUFBUTtBQUNqQixNQUFJLENBQUM7QUFBSSxVQUFNLElBQUksTUFBTSxtQkFBbUI7QUFDNUMsY0FBWTtBQUFBLElBQ1gsUUFBUTtBQUFBLElBQ1I7QUFBQSxJQUNBLE1BQU07QUFBQSxFQUNQLENBQUM7QUFFRCxRQUFNLGlCQUFpQixhQUFhO0FBRXBDLFFBQU0sVUFBVTtBQUFBLElBQ2YsR0FBRyxTQUFTLG9CQUFvQixLQUFLLFNBQVMsZUFBZTtBQUFBLEVBQzlEO0FBQ0EsTUFBSSxRQUFRLFVBQVU7QUFBRyxVQUFNLElBQUksTUFBTSxtQkFBbUI7QUFLNUQ7QUFBQSxJQUNDO0FBQUEsSUFDQSxTQUFTLG9CQUFvQjtBQUFBLElBQzdCLFNBQVMsb0JBQW9CLFNBQVM7QUFBQSxJQUN0QyxNQUFNLFNBQVMsb0JBQW9CO0FBQUEsSUFDbkMsUUFBUSxDQUFDLEVBQUUsQ0FBQztBQUFBLElBQ1osT0FBTztBQUFBLElBQ1AsWUFBWTtBQUFBLEVBQ2I7QUFFQSxRQUFNLGlCQUFpQixRQUFRLEtBQUssT0FBTyxjQUFjO0FBRXpELGNBQVk7QUFBQSxJQUNYO0FBQUEsRUFDRCxDQUFDO0FBRUQsTUFBSSxlQUFnQyxRQUFRLFlBQVk7QUFBQSxJQUN2RCxjQUFjLFNBQVM7QUFBQSxFQUN4QjtBQUdBLE1BQUksY0FBYztBQUNqQixRQUFJLGVBQWUsTUFBTSxLQUFLLGFBQWEsU0FBUyxFQUFFO0FBQUEsTUFBTyxDQUFDLE9BQzdELEdBQUcsU0FBUyxNQUFNO0FBQUEsSUFDbkIsRUFBRSxDQUFDO0FBQ0gsNkJBQWEsa0JBQWIsbUJBQ0csY0FBYyx1QkFEakIsbUJBRUcsVUFBVSxJQUFJO0FBRWpCLGlCQUFhLFVBQVUsSUFBSSw4QkFBOEI7QUFFekQsZ0JBQVk7QUFBQSxNQUNYO0FBQUEsSUFDRCxDQUFDO0FBQUEsRUFDRjtBQUdBLE1BQUksZ0JBQWdCO0FBQ25CLGdCQUFZO0FBQUEsTUFDWDtBQUFBLElBQ0QsQ0FBQztBQUFBLEVBQ0Y7QUFFQTtBQUNEO0FBRUEsZUFBc0IscUJBQ3JCLE1BQ0EsTUFDQztBQXhjRjtBQXljQyxNQUFJLFNBQVMsUUFBUSxZQUFZLFFBQVEsU0FBUyxJQUFJLFVBQVU7QUFDaEUsTUFBSSxjQUFjLFFBQVEsWUFBWSxRQUFRLFVBQVUsSUFBSSxTQUFTO0FBQ3JFLE1BQUksY0FBYyxRQUFRLFlBQVksUUFBUSxjQUFjO0FBRzVELE1BQUksVUFBVSxNQUFNO0FBQ25CLFFBQUksWUFBWSxVQUFVLE1BQU07QUFFL0IsWUFBTSx5QkFBeUI7QUFBQSxJQUNoQyxPQUFPO0FBQ047QUFBQSxJQUNEO0FBQUEsRUFDRDtBQUNBLGNBQVk7QUFBQSxJQUNYLE1BQU0sR0FBRztBQUFBLEVBQ1YsQ0FBQztBQUVELE1BQUksQ0FBQztBQUFNO0FBRVgsTUFBSSxPQUFPLE1BQU0sS0FBSyxLQUFLLFNBQVMsRUFBRSxPQUFPLENBQUMsT0FBTyxHQUFHLFNBQVMsTUFBTSxDQUFDLEVBQUUsQ0FBQztBQUMzRSxtQkFBSyxrQkFBTCxtQkFDRyxjQUFjLHVCQURqQixtQkFFRyxVQUFVLElBQUk7QUFFakIsT0FBSyxVQUFVLElBQUksOEJBQThCO0FBRWpELGNBQVk7QUFBQSxJQUNYO0FBQUEsRUFDRCxDQUFDO0FBRUQsUUFBTSxhQUFhLEtBQUssYUFBYSxNQUFNO0FBQzNDLE1BQUksQ0FBQztBQUFZLFVBQU0sSUFBSSxNQUFNLHVCQUF1QjtBQUV4RCxNQUNDLGVBQWUsUUFDZixZQUFZLGNBQWMsY0FDMUIsWUFBWSxVQUFVLE1BQ3JCO0FBQ0QsZ0JBQVksV0FBVztBQUN2QjtBQUFBLEVBQ0Q7QUFFQSxNQUFJLENBQUMsUUFBUSxNQUFNLFFBQVEsTUFBTSxNQUFNLEVBQUUsSUFBSSxXQUFXLFVBQVU7QUFFbEUsTUFBSSxjQUFjLHlCQUF5QjtBQUUzQyxNQUFJLGFBQWEsbUJBQW1CLGFBQWEsSUFBSTtBQUVyRCxNQUFJLFdBQVcsUUFBUSxFQUFFLFVBQVUsUUFBUTtBQUczQyxNQUFJLGFBQWEsU0FBUztBQUMxQixNQUFJLENBQUM7QUFBWSxVQUFNLElBQUksTUFBTSx5QkFBeUI7QUFFMUQsUUFBTSxFQUFFLFNBQVMsTUFBTSxhQUFhLElBQUksTUFBTTtBQUFBLElBQzdDO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsRUFDRDtBQUdBLE1BQUksS0FBSyxRQUFRO0FBQ2pCLE1BQUksQ0FBQztBQUFJLFVBQU0sSUFBSSxNQUFNLG1CQUFtQjtBQUM1QyxjQUFZO0FBQUEsSUFDWCxRQUFRO0FBQUEsSUFDUjtBQUFBLElBQ0EsTUFBTTtBQUFBLEVBQ1AsQ0FBQztBQUdELFFBQU0saUJBQWlCLGFBQWE7QUFFcEMsTUFBSSxXQUFXLFFBQVEsZ0JBQWdCLCtCQUFjO0FBQ3BELFVBQU0sYUFBeUIsY0FBYyxPQUFPO0FBQ3BELFFBQUksQ0FBQztBQUFZLFlBQU0sSUFBSSxNQUFNLHVCQUF1QjtBQUN4RCxVQUFNLFdBQVcsUUFBUSxLQUFLLE9BQU8sY0FBYztBQUVuRCxvQkFBZ0IsWUFBWSxNQUFNLEVBQUU7QUFDcEMsdUJBQW1CLFlBQVksTUFBTSxFQUFFO0FBRXZDO0FBQUEsTUFDQztBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBLE9BQU87QUFBQSxJQUNSO0FBRUEsVUFBTSxpQkFBaUIsUUFBUSxLQUFLLE9BQU8sY0FBYztBQUV6RCxnQkFBWTtBQUFBLE1BQ1g7QUFBQSxNQUNBLGFBQWEsV0FBVztBQUFBO0FBQUEsTUFFeEI7QUFBQSxJQUNELENBQUM7QUFBQSxFQUNGO0FBRUEsTUFBSSxnQkFBZ0I7QUFDbkIsZ0JBQVk7QUFBQSxNQUNYO0FBQUEsSUFDRCxDQUFDO0FBQUEsRUFDRjtBQUNEO0FBRUEsZUFBc0IsMkJBQTJCO0FBcGpCakQ7QUFxakJDLE1BQUksQ0FBQyxVQUFVLEtBQUssT0FBTyxLQUFLLFVBQVUsQ0FBQyxFQUFFLFVBQVUsR0FBRztBQUV6RCxnQkFBWTtBQUNaO0FBQUEsRUFDRDtBQUVBLFFBQU07QUFBQSxJQUNMO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsRUFDRCxJQUFJLFVBQVU7QUFDZCxjQUFZO0FBRVosTUFBSSxTQUFTLEtBQUssUUFBUSxTQUFTLEVBQUUsY0FBYyxZQUFZO0FBRTlELGdCQUFZO0FBQ1o7QUFBQSxFQUNEO0FBRUEsUUFBTSxFQUFFLFVBQVUsSUFBSSxRQUFRO0FBQzlCLE1BQUksYUFBYSxVQUFVLFlBQVksTUFBTTtBQUM3Qyw0QkFBMEIsV0FBVyxRQUFRLElBQUk7QUFFakQsUUFBTSxhQUFhLFFBQVEsRUFBRSxVQUFVLFFBQVE7QUFFL0MsUUFBTSxlQUFlLFdBQVc7QUFFaEMsTUFBSSxhQUFhLGNBQWMsVUFBVTtBQUV6QyxNQUFJLENBQUMsUUFBUSxNQUFNLFFBQVEsTUFBTSxNQUFNLEVBQUUsSUFBSSxXQUFXLFVBQVU7QUFDbEUsa0JBQWdCLFlBQVksTUFBTSxFQUFFO0FBQ3BDLDRCQUEwQixZQUFZLE1BQU0sRUFBRTtBQUk5QyxNQUFJLGlCQUFpQixRQUFRO0FBQzVCLGdCQUFZO0FBQ1osUUFBSSxjQUEyQixvQkFBb0IsVUFBVTtBQUM3RCxRQUFJLGVBQWUsTUFBTTtBQUV4Qix3QkFBWSxjQUFjLGVBQWUsTUFBekMsbUJBQTRDLGFBQWEsU0FBUztBQUFBLElBQ25FO0FBQ0E7QUFBQSxFQUNEO0FBRUEsTUFBSSxrQkFBa0IsY0FBYyxXQUFXLGdCQUFnQiwrQkFBYztBQUM1RSxVQUFNLE9BQXFCLFdBQVc7QUFDdEMsU0FBSyxPQUFPLFNBQVMsR0FBRyxlQUFlLEdBQUc7QUFrQzFDLFFBQUksU0FBUyxLQUFLLE1BQU07QUFDdkIsWUFBTSxFQUFFLFlBQUFDLGFBQVksZ0JBQUFDLGlCQUFnQixRQUFBQyxTQUFRLGdCQUFBQyxnQkFBZSxJQUFJLFNBQVM7QUFDeEUsVUFBSSxDQUFDQyxTQUFRQyxPQUFNQyxTQUFRQyxPQUFNQyxPQUFNQyxHQUFFLElBQUksV0FBV1QsV0FBVTtBQUNsRSxZQUFNLGFBQWEsVUFBVSxZQUFZRSxPQUFNO0FBQy9DLGdCQUFVLFdBQVcsVUFBVTtBQUMvQixZQUFNUSxjQUF5QixjQUFjLFVBQVU7QUFDdkQseUJBQW1CQSxhQUFZRixPQUFNQyxHQUFFO0FBQUEsSUFDeEMsT0FBTztBQUNOLFVBQUksY0FBMkIsb0JBQW9CLFVBQVU7QUFDN0QsVUFBSSxlQUFlLE1BQU07QUFFeEIsMEJBQVksY0FBYyxlQUFlLE1BQXpDLG1CQUE0QyxhQUFhLFNBQVM7QUFBQSxNQUNuRTtBQUFBLElBQ0Q7QUFBQSxFQUNEO0FBRUEsTUFBSSxRQUFRLFlBQVk7QUFDdkIsZUFBVyxPQUFPO0FBQUEsRUFDbkI7QUFFQSxNQUFJLE1BQU07QUFDVCxRQUFJLGVBQWUsVUFBVSxZQUFZLGNBQWM7QUFDdkQsUUFBSSxDQUFDO0FBQWMsWUFBTSxJQUFJLE1BQU0seUJBQXlCO0FBRTVELGNBQVUsV0FBVyxZQUFZO0FBQUEsRUFDbEM7QUFTQSxjQUFZO0FBQ2I7QUFFQSxlQUFzQiwwQkFBMEI7QUFDL0MsTUFBSSxDQUFDLFNBQVMsS0FBSyxPQUFPLEtBQUssU0FBUyxDQUFDLEVBQUUsVUFBVSxHQUFHO0FBRXZELGVBQVc7QUFDWDtBQUFBLEVBQ0Q7QUFFQSxNQUFJLEVBQUUsWUFBWSxRQUFRLGdCQUFnQixNQUFNLGdCQUFnQixNQUFNLEtBQUssSUFDMUUsU0FBUztBQUNWLGFBQVc7QUFFWCxNQUFJLFVBQVUsS0FBSyxRQUFRLFVBQVUsRUFBRSxjQUFjLFlBQVk7QUFHaEUsZUFBVztBQUNYO0FBQUEsRUFDRDtBQUVBLFFBQU0sRUFBRSxVQUFVLElBQUksUUFBUTtBQUM5QixNQUFJLGFBQWEsVUFBVSxZQUFZLE1BQU07QUFDN0MsNEJBQTBCLFdBQVcsUUFBUSxJQUFJO0FBRWpELE1BQUksYUFBYSxjQUFjLFVBQVU7QUFFekMsTUFBSSxDQUFDLFFBQVEsTUFBTSxRQUFRLE1BQU0sTUFBTSxFQUFFLElBQUksV0FBVyxVQUFVO0FBQ2xFLGtCQUFnQixZQUFZLE1BQU0sRUFBRTtBQUNwQyw0QkFBMEIsWUFBWSxNQUFNLEVBQUU7QUFJOUMsTUFBSSxrQkFBa0IsY0FBYyxXQUFXLGdCQUFnQiwrQkFBYztBQUM1RSxVQUFNLE9BQXFCLFdBQVc7QUFDdEMsU0FBSyxPQUFPLFNBQVMsR0FBRyxlQUFlLEdBQUc7QUFHMUMsUUFBSSxVQUFVLEtBQUssUUFBUSxVQUFVLEVBQUUsWUFBWTtBQUNsRCxZQUFNLEVBQUUsWUFBQVQsYUFBWSxnQkFBQUMsaUJBQWdCLFFBQUFDLFNBQVEsZ0JBQUFDLGdCQUFlLElBQzFELFVBQVU7QUFDWCxVQUFJLENBQUNDLFNBQVFDLE9BQU1DLFNBQVFDLE9BQU1DLE9BQU1DLEtBQUksUUFBUSxNQUFNLElBQ3hELFdBQVdULFdBQVU7QUFDdEIsWUFBTSxhQUFhLFVBQVUsWUFBWUUsT0FBTTtBQUMvQyxnQkFBVSxXQUFXLFVBQVU7QUFDL0IsWUFBTVEsY0FBeUIsY0FBYyxVQUFVO0FBQ3ZELFVBQUksQ0FBQ0E7QUFBWSxjQUFNLElBQUksTUFBTSx1QkFBdUI7QUFFeEQseUJBQW1CQSxhQUFZRixPQUFNQyxHQUFFO0FBQUEsSUFDeEMsT0FBTztBQUNOLFVBQUksY0FBMkIsb0JBQW9CLFVBQVU7QUFDN0QsVUFBSSxlQUFlLE1BQU07QUFDeEIsbUJBQVcsTUFBTTtBQWh1QnJCO0FBa3VCSyw0QkFBWSxjQUFjLGVBQWUsTUFBekMsbUJBQTRDLGFBQWEsU0FBUztBQUFBLFFBQ25FLEdBQUcsRUFBRTtBQUFBLE1BQ047QUFBQSxJQUNEO0FBQUEsRUFDRDtBQUVBLE1BQUksUUFBUSxZQUFZO0FBQ3ZCLGVBQVcsT0FBTztBQUVsQixRQUFJLGVBQWUsVUFBVSxZQUFZLGNBQWM7QUFDdkQsUUFBSSxDQUFDO0FBQWMsWUFBTSxJQUFJLE1BQU0seUJBQXlCO0FBRTVELGNBQVUsV0FBVyxZQUFZO0FBQUEsRUFDbEM7QUFFQSxNQUFJLE1BQU07QUFDVCxRQUFJLGVBQWUsVUFBVSxZQUFZLGNBQWM7QUFDdkQsUUFBSSxDQUFDLGNBQWM7QUFDbEIsaUJBQVc7QUFDWCxZQUFNLElBQUksTUFBTSx5QkFBeUI7QUFBQSxJQUMxQztBQUVBLGNBQVUsV0FBVyxZQUFZO0FBQUEsRUFDbEM7QUFTQSxhQUFXO0FBQ1o7QUFFQSxlQUFzQix5QkFBeUI7QUFDOUMsTUFBSSxDQUFDLGlCQUFpQixLQUFLLE9BQU8sS0FBSyxpQkFBaUIsQ0FBQyxFQUFFLFVBQVUsR0FBRztBQUV2RSx1QkFBbUI7QUFDbkI7QUFBQSxFQUNEO0FBRUEsUUFBTTtBQUFBLElBQ0w7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLEVBQ0QsSUFBSSxpQkFBaUI7QUFDckIscUJBQW1CO0FBRW5CLE1BQUksVUFBVSxLQUFLLFFBQVEsVUFBVSxFQUFFLGNBQWMsWUFBWTtBQUVoRSx1QkFBbUI7QUFDbkI7QUFBQSxFQUNEO0FBRUEsUUFBTSxFQUFFLFVBQVUsSUFBSSxRQUFRO0FBQzlCLE1BQUksYUFBYSxVQUFVLFlBQVksTUFBTTtBQUM3Qyw0QkFBMEIsV0FBVyxRQUFRLE1BQU0sWUFBWTtBQUUvRCxNQUFJLGtCQUFrQixjQUFjLFdBQVcsZ0JBQWdCLCtCQUFjO0FBQzVFLFVBQU0sT0FBcUIsV0FBVztBQUN0QyxTQUFLLE9BQU8sU0FBUyxHQUFHLGVBQWUsR0FBRztBQUFBLEVBQzNDO0FBRUEsTUFBSSxjQUEyQixvQkFBb0IsVUFBVTtBQUM3RCxNQUFJLGVBQWUsTUFBTTtBQUN4QixlQUFXLE1BQU07QUExeUJuQjtBQTR5Qkcsd0JBQVksY0FBYyxlQUFlLE1BQXpDLG1CQUE0QyxhQUFhLFNBQVM7QUFBQSxJQUNuRSxHQUFHLEVBQUU7QUFBQSxFQUNOO0FBRUEsTUFBSSxhQUF5QixjQUFjLFVBQVU7QUFFckQsTUFBSSxDQUFDLFFBQVEsTUFBTSxRQUFRLE1BQU0sTUFBTSxFQUFFLElBQUksV0FBVyxVQUFVO0FBS2xFLFFBQU0sZUFBZSxVQUFVLFlBQVksY0FBYztBQUN6RCxNQUFJLENBQUMsY0FBYztBQUNsQix1QkFBbUI7QUFDbkIsVUFBTSxJQUFJLE1BQU0seUJBQXlCO0FBQUEsRUFDMUM7QUFDQSxNQUFJLHFCQUFpQyxjQUFjLFlBQVk7QUFFL0Qsa0JBQWdCLG9CQUFvQixNQUFNLEVBQUU7QUFDNUMsNEJBQTBCLG9CQUFvQixNQUFNLEVBQUU7QUFJdEQsTUFBSSxVQUFVLEtBQUssUUFBUSxVQUFVLEVBQUUsWUFBWTtBQUNsRCxVQUFNLEVBQUUsWUFBQVQsYUFBWSxnQkFBQUMsaUJBQWdCLFFBQUFDLFNBQVEsZ0JBQUFDLGdCQUFlLElBQUksVUFBVTtBQUN6RSxRQUFJLENBQUNDLFNBQVFDLE9BQU1DLFNBQVFDLE9BQU1DLE9BQU1DLEdBQUUsSUFBSSxXQUFXVCxXQUFVO0FBQ2xFLFVBQU0sYUFBYSxVQUFVLFlBQVlFLE9BQU07QUFDL0MsY0FBVSxXQUFXLFVBQVU7QUFFL0IsVUFBTVEsY0FBeUIsY0FBYyxVQUFVO0FBQ3ZELHVCQUFtQkEsYUFBWUYsT0FBTUMsR0FBRTtBQUFBLEVBQ3hDO0FBRUEsTUFBSSxRQUFRLFlBQVk7QUFDdkIsZUFBVyxPQUFPO0FBQUEsRUFDbkI7QUFFQSxNQUFJLE1BQU07QUFDVCxRQUFJRSxnQkFBZSxVQUFVLFlBQVksY0FBYztBQUN2RCxRQUFJLENBQUNBLGVBQWM7QUFDbEIseUJBQW1CO0FBQ25CLFlBQU0sSUFBSSxNQUFNLHlCQUF5QjtBQUFBLElBQzFDO0FBRUEsY0FBVSxXQUFXQSxhQUFZO0FBQUEsRUFDbEM7QUFZQSxxQkFBbUI7QUFDcEI7OztBRnQxQk8sU0FBUyx5QkFBeUIsS0FBcUI7QUFDN0QsU0FBTyxtQkFBbUIsR0FBRyxFQUFFLFFBQVEsVUFBVSxTQUFVLEdBQUc7QUFDN0QsV0FBTyxNQUFNLEVBQUUsV0FBVyxDQUFDLEVBQUUsU0FBUyxFQUFFO0FBQUEsRUFDekMsQ0FBQztBQUNGO0FBRU8sU0FBUyx5QkFBeUIsS0FBcUI7QUFDN0QsU0FBTztBQUFBLElBQ04sSUFBSSxRQUFRLFFBQVEsR0FBRyxFQUFFLFFBQVEsUUFBUSxHQUFHLEVBQUUsUUFBUSxRQUFRLEdBQUc7QUFBQSxFQUNsRTtBQUNEO0FBRU8sU0FBUyxXQUNmLFlBVUM7QUFDRCxNQUFJLENBQUMsUUFBUSxNQUFNLFFBQVEsTUFBTSxNQUFNLElBQUksUUFBUSxNQUFNLElBQ3hELFdBQVcsTUFBTSxHQUFHO0FBQ3JCLFdBQVMseUJBQXlCLE1BQU07QUFDeEMsU0FBTyx5QkFBeUIsSUFBSTtBQUNwQyxXQUFTLHlCQUF5QixNQUFNO0FBQ3hDLFNBQU8seUJBQXlCLElBQUk7QUFDcEMsU0FBTyx5QkFBeUIsSUFBSTtBQUNwQyxPQUFLLHlCQUF5QixFQUFFO0FBQ2hDLE1BQUk7QUFBUSxhQUFTLHlCQUF5QixNQUFNO0FBQ3BELFdBQVMseUJBQXlCLE1BQU07QUFFeEMsU0FBTztBQUFBLElBQ047QUFBQSxJQUNBO0FBQUEsSUFDQTtBQUFBLElBQ0E7QUFBQSxJQUNBLFNBQVMsSUFBSTtBQUFBLElBQ2IsU0FBUyxFQUFFO0FBQUEsSUFDWDtBQUFBLElBQ0E7QUFBQSxFQUNEO0FBQ0Q7QUFFTyxTQUFTLG1CQUFtQkMsV0FBa0IsTUFBYyxJQUFZO0FBQzlFLE1BQUksU0FBU0EsVUFDWCxNQUFNLE9BQU8sSUFBSSxJQUFJLEVBQ3JCLE1BQU0sSUFBSSxFQUNWLE1BQU0sRUFBRSxFQUFFLENBQUM7QUFHYixNQUFJLFNBQVNBLFVBQVMsTUFBTSxJQUFJLEtBQUssRUFBRSxFQUFFLE1BQU0sSUFBSSxFQUFFLENBQUM7QUFDdEQsU0FBTyxFQUFFLFFBQVEsT0FBTztBQUN6QjtBQUVPLFNBQVMsa0JBQ2YsTUFDQSxZQUNBLFNBQWlCLElBQ2pCLFNBQWlCLElBQ2hCO0FBQ0QsTUFBSSxlQUFlO0FBRW5CLFFBQU0sUUFBUSxLQUFLLE1BQU0sSUFBSSxFQUFFLElBQUksQ0FBQyxNQUFjLE1BQWM7QUFDL0QsUUFBSSxPQUFPLEVBQUUsTUFBTSxPQUFPLGNBQWMsUUFBUSxLQUFLLFNBQVMsR0FBRyxFQUFFO0FBQ25FLG9CQUFnQixLQUFLO0FBQ3JCLFdBQU87QUFBQSxFQUNSLENBQUM7QUFFRCxNQUFJLEtBQUssU0FBUyxTQUFTLGFBQWEsTUFBTSxHQUFHO0FBQ2hELFFBQUksYUFBYSxLQUFLLFFBQVEsU0FBUyxhQUFhLE1BQU07QUFDMUQsUUFBSSxhQUNILE1BQU0sVUFBVSxDQUFDLFNBQWMsS0FBSyxRQUFRLGFBQWEsT0FBTyxNQUFNLElBQ3RFO0FBQ0QsUUFBSSxXQUNILE1BQU07QUFBQSxNQUNMLENBQUMsU0FDQSxLQUFLLFFBQVEsYUFBYSxPQUFPLFNBQVMsV0FBVztBQUFBLElBQ3ZELElBQUk7QUFFTCxRQUFJLGNBQWM7QUFBSSxtQkFBYSxNQUFNLFNBQVM7QUFDbEQsUUFBSSxZQUFZO0FBQUksaUJBQVcsTUFBTSxTQUFTO0FBRTlDLFdBQU87QUFBQSxNQUNOLFlBQVk7QUFBQSxRQUNYLE1BQU07QUFBQSxRQUNOLElBQUksYUFBYSxPQUFPLFNBQVMsTUFBTSxVQUFVLEVBQUU7QUFBQSxNQUNwRDtBQUFBLE1BQ0EsVUFBVTtBQUFBLFFBQ1QsTUFBTTtBQUFBLFFBQ04sSUFDQyxhQUNBLE9BQU8sU0FDUCxXQUFXLFNBQ1gsTUFBTSxRQUFRLEVBQUU7QUFBQSxNQUNsQjtBQUFBLE1BQ0E7QUFBQSxJQUNEO0FBQUEsRUFDRDtBQUNBLFNBQU87QUFDUjtBQWFPLFNBQVMsZ0NBQWdDLEtBRzlDO0FBQ0QsUUFBTSxhQUFhLEtBQUssSUFBSSxVQUFVLG9CQUFvQiw2QkFBWTtBQUN0RSxRQUFNLGFBQWEseUNBQVksT0FBTyxVQUFVO0FBQ2hELFFBQU0sV0FBVyx5Q0FBWSxPQUFPLFVBQVU7QUFFOUMsTUFBSSxVQUFVO0FBQ2QsTUFBSSxZQUF5QztBQUM3QyxNQUNDLGNBQ0EsWUFDQSxXQUFXLE1BQU0sU0FBUyxNQUMxQixXQUFXLFFBQVEsU0FBUyxNQUUzQjtBQUNELFVBQU0sV0FBVyx5Q0FBWSxPQUFPLFFBQVEsV0FBVztBQUd2RCxRQUFJLFVBQVU7QUFDYixZQUFNLFVBQVUsQ0FBQyxHQUFHLFNBQVMsU0FBUyxlQUFlLENBQUM7QUFDdEQsY0FBUSxRQUFRLENBQUMsVUFBVTtBQTFKOUI7QUEySkksYUFBSSxXQUFNLFVBQU4sbUJBQWEsWUFBWTtBQUM1QixnQkFBTSxRQUFnQixNQUFNO0FBQzVCLGdCQUFNLE1BQWMsUUFBUSxNQUFNLENBQUMsRUFBRTtBQUNyQyxjQUFJLE9BQU8sU0FBUyxNQUFNLElBQUksUUFBUTtBQUNyQyxrQkFBTSxhQUFhLE1BQU0sQ0FBQztBQUUxQixnQkFBSSxpQkFBaUIsSUFBSSxrQkFBa0I7QUFDM0MsZ0JBQUksQ0FBQztBQUNKLG9CQUFNLElBQUksTUFBTSxpQ0FBaUM7QUFDbEQsZ0JBQUksWUFBWSxJQUFJO0FBY3BCLGdCQUFJLE9BQU87QUFDWCxnQkFBSSxDQUFDLEtBQUssYUFBYSxNQUFNO0FBQzVCLHFCQUFPLFVBQVU7QUFBQSxnQkFDaEIsY0FBYztBQUFBLGNBQ2Y7QUFFRCxnQkFBSSxRQUFRLGdCQUFnQixpQkFBaUI7QUFHNUMsd0JBQVU7QUFFViwwQkFBWTtBQUFBLFlBQ2IsT0FBTztBQUFBLFlBRVA7QUFBQSxVQUNEO0FBQUEsUUFDRDtBQUFBLE1BQ0QsQ0FBQztBQUFBLElBQ0Y7QUFBQSxFQUNEO0FBQ0EsU0FBTyxFQUFFLFNBQVMsTUFBTSxVQUFVO0FBQ25DO0FBR08sU0FBUywwQkFBMEIsTUFBYztBQUN2RCxNQUFJLGlCQUFpQixHQUFHO0FBRXZCLFFBQUksYUFBYSxpQkFBaUIsRUFDaEMsT0FBTyxDQUFDLFlBQWlCO0FBQ3pCLGFBQU8sUUFBUSxTQUFTO0FBQUEsSUFDekIsQ0FBQyxFQUNBLElBQUksQ0FBQyxZQUFpQixRQUFRLE9BQU8sUUFBUSxNQUFNLENBQUM7QUFHdEQscUJBQWlCLEVBQ2YsT0FBTyxDQUFDLFlBQWlCLFFBQVEsU0FBUyxJQUFJLEVBQzlDLFFBQVEsQ0FBQyxZQUFpQjtBQUMxQixVQUFJLENBQUMsV0FBVyxTQUFTLFFBQVEsT0FBTyxRQUFRLE1BQU0sQ0FBQyxHQUFHO0FBQ3pELFlBQUksTUFBTSxRQUFRO0FBQ2xCLFlBQUksQ0FBQztBQUFLLGdCQUFNLElBQUksTUFBTSxlQUFlO0FBQ3pDLFlBQUksSUFBSSxVQUFVLFNBQVMsZ0JBQWdCO0FBQzFDLGNBQUksTUFBTSxrQkFBa0I7QUFBQSxhQUN4QjtBQUNKLGNBQUksYUFBYSxRQUFRLE9BQU87QUFDaEMsY0FBSSxNQUFNLGtCQUFrQjtBQUFBLFFBQzdCO0FBQ0EsZ0JBQVEsT0FBTyxNQUFNLGtCQUFrQjtBQUFBLE1BRXhDO0FBQUEsSUFDRCxDQUFDO0FBRUYsd0JBQW9CLElBQUk7QUFBQSxFQUN6QjtBQUNEO0FBRUEsZUFBc0IsaUJBQWlCLEtBQVk7QUFDbEQsTUFBSSxFQUFFLFNBQVMsS0FBSyxJQUFJLGdDQUFnQyxHQUFHO0FBRTNELE1BQUksV0FBVyxNQUFNO0FBQ3BCLFVBQU0seUJBQXlCO0FBQy9CLDhCQUEwQixZQUFZLE1BQU07QUFDNUMsNkJBQXlCLE1BQU0sWUFBWSxNQUFNO0FBQ2pELFVBQU0scUJBQXFCLE1BQU0sWUFBWSxNQUFNO0FBQUEsRUFDcEQsT0FBTztBQUNOLFVBQU0seUJBQXlCO0FBQy9CLDhCQUEwQixZQUFZLE1BQU07QUFBQSxFQUM3QztBQUNEOzs7QVgvTU8sU0FBUyxvQkFBb0IsYUFBNEIsTUFHOUQ7QUFDRCxRQUFNLE9BQU8sU0FBUyxjQUFjLE1BQU07QUFDMUMsT0FBSyxNQUFNLFNBQVM7QUFDcEIsT0FBSyxVQUFVLElBQUkscUJBQXFCO0FBQ3hDLE9BQUssVUFBVSxJQUFJLFVBQVUsV0FBTyxDQUFDO0FBRXJDLFFBQU0sU0FBUztBQUNmLFFBQU0sUUFBUSxTQUFTO0FBRXZCLE1BQUksY0FBYyxNQUFNO0FBQ3ZCLFVBQU1DLE9BQU0sU0FBUyxnQkFBZ0IsOEJBQThCLEtBQUs7QUFpRHhFLFdBQU8sRUFBRSxNQUFZLEtBQUFBLEtBQUk7QUFBQSxFQUMxQjtBQUVBLFFBQU0sTUFBTSxTQUFTLGdCQUFnQiw4QkFBOEIsS0FBSztBQXdCeEUsTUFBSSxjQUFjLCtCQUErQjtBQUNoRCxRQUFJLFNBQVMsU0FBUyxjQUFjLEtBQUs7QUFFekMsV0FBTyxVQUFVLElBQUksUUFBUTtBQUU3QixlQUFXLE1BQU0sR0FBRyxFQUFFLFFBQVEsQ0FBQyxNQUFNLFVBQVU7QUFDOUMsVUFBSSxVQUFVLEtBQUssVUFBVTtBQUM1QixlQUFPLGFBQWEseUJBQXlCLElBQUk7QUFBQSxlQUN6QyxVQUFVLEdBQUc7QUFDckIsZUFBTyxhQUFhLDhCQUE4QjtBQUFBLE1BQ25EO0FBQUEsSUFDRCxDQUFDO0FBR0QsV0FBTyxNQUFNLGFBQWE7QUFDMUIsV0FBTyxNQUFNLGdCQUFnQjtBQUM3QixTQUFLLFlBQVksTUFBTTtBQUFBLEVBQ3hCO0FBRUEsU0FBTyxFQUFFLE1BQVksSUFBSTtBQUsxQjtBQUVPLFNBQVMseUJBQXlCLE1BQXVCLE1BQWM7QUFFN0UsUUFBTSxNQUFNLEtBQUssY0FBYyxLQUFLO0FBQ3BDLFFBQU0sU0FBNkIsS0FBSyxjQUFjLFNBQVM7QUFFL0QsTUFBSSxRQUFRLE9BQU8sQ0FBQyxRQUFRO0FBQzNCLDhCQUEwQixJQUFJO0FBQzlCLFFBQUksSUFBSSxVQUFVLFNBQVMsZ0JBQWdCO0FBQzFDLFVBQUksTUFBTSxrQkFBa0I7QUFBQSxTQUN4QjtBQUVKLGFBQU8sS0FBSyxjQUFjLE1BQU07QUFDaEMsV0FBSyxNQUFNLGtCQUFrQjtBQUFBLElBQzlCO0FBRUEsd0JBQW9CLEtBQUssSUFBSTtBQUFBLEVBQzlCO0FBQ0Q7QUFFTyxTQUFTLHdCQUF3QixRQUE0QjtBQUVuRSxTQUFPLE9BQU87QUFDZjtBQUVPLFNBQVMsb0JBQ2YsY0FDYztBQUVkLFNBQU8sYUFBYTtBQUNyQjtBQUVBLFNBQVMsY0FBYyxVQUE0QjtBQUNsRCxRQUFNLGFBQWEsS0FBSyxVQUFVLFFBQVE7QUFDMUMsUUFBTSxLQUFLLFdBQU8sWUFBWSxzQ0FBc0M7QUFDcEUsU0FBTyxZQUFZO0FBQ3BCO0FBRU8sU0FBUyxxQkFBcUIsUUFBNkI7QUFDakUsUUFBTSxjQUEyQixvQkFBb0IsTUFBTTtBQUMzRCxRQUFNLDJCQUEyQjtBQUNqQyxRQUFNLFlBQVksWUFBWSxjQUFjLElBQUksMEJBQTBCO0FBQzFFLE1BQUksV0FBVztBQUNkLFdBQU87QUFBQSxFQUNSLE9BQU87QUFDTixVQUFNLGVBQWUsU0FBUyxjQUFjLEtBQUs7QUFDakQsaUJBQWEsS0FBSztBQUNsQixnQkFBWSxjQUFjLGNBQWMsRUFBRyxZQUFZLFlBQVk7QUFDbkUsV0FBTztBQUFBLEVBQ1I7QUFDRDtBQVdPLFNBQVMsb0JBQW9CLE1BQXFCO0FBQ3hELFFBQU0sUUFBUSxvQkFBb0IsSUFBSSxFQUFFLGNBQWMsZUFBZTtBQUNyRSxNQUFJLENBQUMsT0FBTztBQUNYLFVBQU0sSUFBSSxNQUFNLGVBQWU7QUFBQSxFQUNoQztBQUNBLFFBQU0sWUFBWSxNQUFNLHNCQUFzQjtBQUM5QyxRQUFNLE9BQU8sb0JBQW9CLElBQUksRUFBRSxjQUFjLFVBQVU7QUFDL0QsTUFBSSxDQUFDLE1BQU07QUFDVixVQUFNLElBQUksTUFBTSx1QkFBdUI7QUFBQSxFQUN4QztBQUNBLFFBQU0sV0FBVyxLQUFLLHNCQUFzQjtBQUU1QyxTQUFPLEVBQUUsV0FBVyxTQUFTO0FBQzlCO0FBRU8sU0FBUywyQkFDZixNQUNBLGlCQUNBLGFBQ0M7QUFDRCxRQUFNLFNBQVMsZ0JBQWdCLElBQUksRUFBRTtBQUNyQyxRQUFNLG9CQUFvQixxQkFBcUIsTUFBTTtBQUVyRCxNQUFJQyxhQUFZLENBQUM7QUFDakIsV0FBUyxJQUFJLEdBQUcsSUFBSSxrQkFBa0IsU0FBUyxRQUFRLEtBQUs7QUFDM0QsSUFBQUEsV0FBVSxLQUFLLGtCQUFrQixTQUFTLEtBQUssQ0FBQyxDQUFnQjtBQUFBLEVBQ2pFO0FBQ0EsTUFBSSxjQUF3QixnQkFBZ0IsSUFBSSxDQUFDLE1BQU0sY0FBYyxDQUFDLENBQUM7QUFFdkUsRUFBQUEsV0FDRSxJQUFJLENBQUMsTUFBdUIsRUFBRSxFQUFFLEVBQ2hDLFFBQVEsQ0FBQyxPQUFPO0FBQ2hCLFFBQUksQ0FBQyxZQUFZLFNBQVMsRUFBRSxHQUFHO0FBQzlCLFVBQUksVUFBVSxTQUFTLGVBQWUsRUFBRTtBQUN4QyxVQUFJO0FBQVMsZ0JBQVEsT0FBTztBQUFBLElBQzdCO0FBQUEsRUFDRCxDQUFDO0FBRUYsUUFBTSxFQUFFLFdBQVcsU0FBUyxJQUFJLG9CQUFvQixJQUFJO0FBR3hELE1BQUksbUJBQW1CLGdCQUFnQixJQUFJLENBQUMsYUFBYTtBQUN4RCxVQUFNLEVBQUUsS0FBSyxJQUFJLFNBQVM7QUFFMUIsVUFBTSxPQUFPLHdCQUF3QixNQUFNLEVBQUUsWUFBWSxJQUFJO0FBQzdELFFBQUksQ0FBQztBQUFNO0FBRVgsUUFBSSxrQkFBa0Isa0JBQWtCO0FBQUEsTUFDdkMsSUFBSSxjQUFjLFFBQVE7QUFBQSxJQUMzQjtBQUVBLFFBQUksb0JBQW9CLE1BQU07QUFDN0Isd0JBQWtCLG1CQUFtQixRQUFRO0FBQzdDLHdCQUFrQixZQUFZLGVBQWU7QUFBQSxJQUM5QztBQUVBLFFBQUksTUFBTTtBQUNULHNCQUFnQixNQUFNLFdBQVc7QUFFakMsc0JBQWdCLGFBQWEsT0FBTyxLQUFLLElBQUksU0FBUyxDQUFDO0FBQ3ZELHNCQUFnQixNQUFNLE1BQU0sS0FBSyxNQUFNLFVBQVUsTUFBTSxLQUFLO0FBQzVELHNCQUFnQixNQUFNLE9BQU8sU0FBUyxRQUFRLEtBQUs7QUFBQSxJQUNwRDtBQUVBLFdBQU87QUFBQSxFQUNSLENBQUM7QUFJRCxNQUFJLGNBQWM7QUFDbEIsTUFBSSxTQUFTO0FBQ2IsbUJBQ0U7QUFBQSxJQUNBLENBQUMsR0FBRyxNQUNILFNBQVMsRUFBRyxhQUFhLEtBQUssQ0FBRSxJQUFJLFNBQVMsRUFBRyxhQUFhLEtBQUssQ0FBRTtBQUFBLEVBQ3RFLEVBQ0MsUUFBUSxDQUFDLFdBQVc7QUFDcEIsUUFBSSxDQUFDO0FBQVE7QUFFYixVQUFNLFNBQTZCLE9BQU8sY0FBYyxTQUFTO0FBRWpFLFFBQUksYUFBYTtBQUloQixVQUFJLFFBQVE7QUFDWCxlQUFPLE1BQU0sVUFBVTtBQUN2QixlQUFPLFVBQVUsSUFBSSxlQUFlO0FBQUEsTUFDckM7QUFBQSxJQUNELE9BQU87QUFFTixVQUFJLFFBQVE7QUFDWCxlQUFPLE1BQU0sVUFBVTtBQUFBLE1BQ3hCO0FBQ0EsYUFBTyxVQUFVLE9BQU8sZUFBZTtBQUFBLElBQ3hDO0FBRUEsUUFBSSxNQUFNLFNBQVMsT0FBUSxhQUFhLEtBQUssQ0FBRTtBQUMvQyxVQUFNLEtBQUssSUFBSSxLQUFLLGNBQWMsTUFBTTtBQUN4QyxrQkFBYyxNQUFNLE9BQU8sc0JBQXNCLEVBQUUsU0FBUztBQUM1RCxXQUFPLGFBQWEsT0FBTyxJQUFJLFNBQVMsQ0FBQztBQUN6QyxXQUFPLE1BQU0sTUFBTSxNQUFNLFVBQVUsTUFBTSxLQUFLO0FBQzlDLFdBQU8sTUFBTSxPQUFPLFNBQVMsUUFBUSxLQUFLO0FBQUEsRUFDM0MsQ0FBQztBQUNIO0FBRUEsSUFBSTtBQUVKLGVBQXNCLDhCQUE4QjtBQUNuRCxlQUFhLGFBQWE7QUFDMUIsa0JBQWdCLFdBQVcsWUFBWTtBQUN0QyxVQUFNLFNBQVMsUUFBUSxFQUFFLFVBQVU7QUFBQSxNQUNsQztBQUFBLElBQ0Q7QUFFQSxlQUFXLFlBQVk7QUFDdEIsWUFBTSxlQUEyQixNQUFNLDJCQUEyQjtBQUVsRSxhQUFPLElBQUksT0FBTyxTQUFTO0FBQzFCLGNBQU0sa0JBQWtCLGFBQWE7QUFBQTtBQUFBLFVBRXBDLENBQUMsTUFBTSxFQUFFLG1CQUFtQixZQUFZLEtBQUssS0FBSyxLQUFLO0FBQUEsUUFDeEQ7QUFFQSxjQUFNLGNBQWMsb0JBQW9CLElBQUksRUFBRSxhQUFhO0FBQzNELG1DQUEyQixNQUFNLGlCQUFpQixXQUFXO0FBQUEsTUFDOUQsQ0FBQztBQUNELFlBQU0sUUFBUTtBQUFBLFFBQ2IsT0FBTyxJQUFJLE9BQU8sU0FBUztBQUMxQixnQkFBTSxrQkFBa0IsYUFBYTtBQUFBO0FBQUEsWUFFcEMsQ0FBQyxNQUFNLEVBQUUsbUJBQW1CLFlBQVksS0FBSyxLQUFLLEtBQUs7QUFBQSxVQUN4RDtBQUVBLGdCQUFNLGNBQWMsb0JBQW9CLElBQUksRUFBRSxhQUFhO0FBQzNELHFDQUEyQixNQUFNLGlCQUFpQixXQUFXO0FBQUEsUUFDOUQsQ0FBQztBQUFBLE1BQ0Y7QUFBQSxJQUNELEdBQUcsR0FBRztBQUFBLEVBQ1AsR0FBRyxHQUFHO0FBQ1A7QUFFTyxTQUFTLG1CQUFtQixVQUFpQztBQUNuRSxNQUFJLEVBQUUsTUFBTSxJQUFJLElBQUksb0JBQW9CLFNBQVMsVUFBVTtBQUMzRCxPQUFLLFVBQVUsSUFBSSxvQkFBb0I7QUFFdkMsUUFBTSxTQUE2QixLQUFLLGNBQWMsU0FBUztBQUUvRCxPQUFLLE1BQU0sV0FBVztBQUV0QixPQUFLLEtBQUssY0FBYyxRQUFRO0FBQ2hDLE9BQUssYUFBYSxhQUFhLEtBQUssVUFBVSxRQUFRLENBQUM7QUFFdkQsUUFBTSxpQkFBaUIsSUFBSSxlQUFlLENBQUMsWUFBWTtBQUN0RCxRQUFJLFVBQVUsT0FBTyxNQUFNLFdBQVcsUUFBUTtBQUU3QyxXQUFLLFVBQVUsSUFBSSxzQkFBc0I7QUFBQSxJQUMxQyxPQUFPO0FBRU4sV0FBSyxVQUFVLE9BQU8sc0JBQXNCO0FBQUEsSUFDN0M7QUFBQSxFQUNELENBQUM7QUFHRCxpQkFBZSxRQUFRLElBQUk7QUFFM0IsT0FBSyxpQkFBaUIsU0FBUyxxQkFBcUI7QUFFcEQsU0FBTztBQUNSO0FBRUEsZUFBc0Isb0JBQW9CLE1BQXFCO0FBQzlELFFBQU0sZUFBZSxnQkFBZ0IsSUFBSTtBQUN6QyxNQUFJLGdCQUFnQixhQUFhLFlBQVksUUFBUSxpQkFBaUI7QUFDdEUsTUFBSSxDQUFDLGVBQWU7QUFDbkIsVUFBTSxJQUFJLE1BQU0sd0JBQXdCO0FBQUEsRUFDekM7QUFFQSxRQUFNLDRCQUE0QjtBQUNsQyxRQUFNLE1BQU0sR0FBSTtBQUNoQiw0QkFBMEIsSUFBSTtBQUU5QixzQkFBb0IsYUFBYSxNQUFNLEVBQ3JDLGNBQWMsY0FBYyxFQUM1QixpQkFBaUIsVUFBVSxZQUFZO0FBQ3ZDLFVBQU0sNEJBQTRCO0FBQ2xDLFVBQU0sTUFBTSxHQUFJO0FBQ2hCLDhCQUEwQixJQUFJO0FBQUEsRUFDL0IsQ0FBQztBQUVGLE1BQUksaUJBQWlCLElBQUksZUFBZSxZQUFZO0FBQ25ELFVBQU0sNEJBQTRCO0FBQ2xDLFVBQU0sTUFBTSxHQUFJO0FBQ2hCLDhCQUEwQixJQUFJO0FBQUEsRUFDL0IsQ0FBQztBQUVELGlCQUFlLFFBQVEsYUFBYTtBQUVwQyxTQUFPO0FBQ1I7QUFFTyxTQUFTLGdCQUFnQixNQUFtQztBQUNsRSxNQUFJLEVBQUUsS0FBSyxnQkFBZ0IsZ0NBQWU7QUFDekMsVUFBTSxJQUFJLE1BQU0sOEJBQThCO0FBQUEsRUFDL0M7QUFDQSxTQUFPLEtBQUs7QUFDYjtBQVVBLFNBQVMsbUJBQW1CLE1BQWMsT0FBZTtBQUN4RCxNQUFJO0FBQ0osUUFBTSxZQUFZLENBQUM7QUFDbkIsVUFBUSxRQUFRLE1BQU0sS0FBSyxJQUFJLE9BQU8sTUFBTTtBQUMzQyxjQUFVLEtBQUs7QUFBQSxNQUNkLE9BQU8sTUFBTSxDQUFDO0FBQUEsTUFDZCxPQUFPLE1BQU07QUFBQSxNQUNiLEtBQUssTUFBTSxRQUFRLE1BQU0sQ0FBQyxFQUFFO0FBQUEsSUFDN0IsQ0FBQztBQUFBLEVBQ0Y7QUFDQSxTQUFPO0FBQ1I7QUFFQSxTQUFTLG1CQUNSLHFCQUNBLGlCQUNhO0FBQ2IsTUFBSUMsYUFBd0IsQ0FBQztBQUU3QixNQUFJLFVBQVUsQ0FBQyxHQUFHLG9CQUFvQixTQUFTLGVBQWUsQ0FBQztBQUMvRCxVQUFRLFFBQVEsQ0FBQyxVQUFVO0FBQzFCLFFBQUksTUFBTSxDQUFDLEVBQUUsTUFBTSxHQUFHLEVBQUUsVUFBVTtBQUFHO0FBQ3JDLFFBQUksQ0FBQyxRQUFRLE1BQU0sUUFBUSxVQUFVLE1BQU0sSUFBSSxRQUFRLE1BQU0sSUFBSTtBQUFBLE1BQ2hFLE1BQU0sQ0FBQztBQUFBLElBQ1I7QUFDQSxVQUFNLHFCQUF1QztBQUFBLE1BQzVDO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLElBQ0Q7QUFFQSxRQUFJLFFBQVEsb0JBQW9CLFFBQVEsTUFBTSxDQUFDLENBQUM7QUFFaEQsVUFBTSxnQ0FBZ0M7QUFBQSxNQUNyQztBQUFBLE1BQ0E7QUFBQSxNQUNBLFFBQVEsTUFBTSxDQUFDLEVBQUU7QUFBQSxJQUNsQjtBQUVBLFVBQU0sc0JBQXdDO0FBQUE7QUFBQSxNQUU3QyxRQUFRLDhCQUE4QjtBQUFBLE1BQ3RDLE1BQU0sb0JBQW9CLE1BQU0sT0FBTyxRQUFRLE1BQU0sQ0FBQyxFQUFFLE1BQU07QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLE1BSzlELFFBQVEsOEJBQThCO0FBQUEsTUFDdEMsVUFBVSxnQkFBZ0I7QUFBQSxNQUMxQixNQUFNLE1BQU07QUFBQTtBQUFBLE1BQ1osSUFBSSxNQUFNLFFBQVMsTUFBTSxDQUFDLEVBQUU7QUFBQTtBQUFBLE1BQzVCO0FBQUEsTUFDQTtBQUFBLElBQ0Q7QUFFQSxRQUFJLFVBQVUsVUFBVTtBQUl2QixZQUFNLGNBQWMsQ0FBQ0MsT0FBY0MsV0FBMEI7QUFDNUQsY0FBTSxjQUFjRCxNQUFLLFlBQVksTUFBTUMsU0FBUSxDQUFDLElBQUk7QUFDeEQsY0FBTSxZQUFZRCxNQUFLLFFBQVEsTUFBTUMsTUFBSztBQUMxQyxlQUFPRCxNQUFLO0FBQUEsVUFDWDtBQUFBLFVBQ0EsY0FBYyxLQUFLLFlBQVk7QUFBQSxRQUNoQztBQUFBLE1BQ0Q7QUFFQSxVQUFJLE9BQU8sWUFBWSxxQkFBcUIsS0FBSztBQUNqRCxVQUFJLGlCQUFpQjtBQUFBLFFBQ3BCO0FBQUEsUUFDQSxJQUFJLE9BQU8sZUFBZTtBQUFBLE1BQzNCO0FBRUEsVUFBSSxhQUFhO0FBQ2pCLGVBQVMsSUFBSSxHQUFHLElBQUksZUFBZSxRQUFRLEtBQUs7QUFDL0MsWUFBSSxlQUFlLENBQUMsRUFBRSxTQUFTLE1BQU0sQ0FBQyxHQUFHO0FBQ3hDO0FBQUEsUUFDRCxPQUFPO0FBQ04sd0JBQWMsZUFBZSxDQUFDLEVBQUUsTUFBTSxlQUFlLENBQUMsRUFBRSxRQUFRO0FBQUEsUUFDakU7QUFBQSxNQUNEO0FBRUEsVUFBSSxhQUFhLEtBQUssUUFBUSxJQUFJLE9BQU8saUJBQWlCLEdBQUcsR0FBRyxRQUFHO0FBQ25FLFVBQUksa0JBQWtCLFdBQVcsTUFBTSxHQUFHLHNCQUFzQjtBQUVoRSxVQUFJLGtCQUFrQixLQUFLLFFBQVEsTUFBTSxDQUFDLENBQUMsSUFBSTtBQUcvQyx3QkFBa0I7QUFFbEIsVUFBSSxrQkFBa0IsV0FBVztBQUFBLFFBQ2hDLEtBQUssSUFBSSxrQkFBa0IsSUFBSSxDQUFDO0FBQUEsUUFDaEM7QUFBQSxNQUNEO0FBQ0EsVUFDQyxXQUFXLFVBQVUsS0FBSyxJQUFJLGtCQUFrQixJQUFJLENBQUMsR0FBRyxlQUFlLEVBQ3JFLFNBQVMsS0FDWCxrQkFBa0IsS0FBSztBQUV2QiwwQkFBa0IsUUFBUTtBQUUzQixVQUFJLGdCQUFnQixXQUFXO0FBQUEsUUFDOUIsa0JBQWtCO0FBQUEsUUFDbEIsS0FBSyxJQUFJLGtCQUFrQixJQUFJLFdBQVcsTUFBTTtBQUFBLE1BQ2pEO0FBQ0EsVUFDQyxXQUFXO0FBQUEsUUFDVixrQkFBa0I7QUFBQSxRQUNsQixLQUFLLElBQUksa0JBQWtCLElBQUksV0FBVyxNQUFNO0FBQUEsTUFDakQsRUFBRSxTQUFTLEtBQ1gsa0JBQWtCLEtBQUssV0FBVztBQUVsQyx3QkFBZ0IsZ0JBQWdCO0FBRWpDLE1BQUFELFdBQVUsS0FBSztBQUFBLFFBQ2Q7QUFBQSxRQUNBO0FBQUEsUUFDQSxZQUFZLE1BQU0sQ0FBQztBQUFBLFFBQ25CLFlBQ0MseUJBQXlCLGVBQWUsSUFDeEMsTUFDQSxrQkFDQSxNQUNBLHlCQUF5QixhQUFhO0FBQUEsTUFDeEMsQ0FBQztBQUFBLElBQ0YsT0FBTztBQUNOLE1BQUFBLFdBQVUsS0FBSztBQUFBLFFBQ2Q7QUFBQSxRQUNBO0FBQUEsUUFDQSxZQUFZLE1BQU0sQ0FBQztBQUFBLE1BQ3BCLENBQUM7QUFBQSxJQUNGO0FBQUEsRUFDRCxDQUFDO0FBQ0QsU0FBT0E7QUFDUjtBQUdBLGVBQXNCLG9CQUFvQjtBQUd6QyxVQUFRLElBQUksdUJBQXVCO0FBQ25DLE1BQUlBLGFBQXdCLENBQUM7QUFDN0IsTUFBSSxnQkFBZ0IsS0FBSyxJQUFJLE1BQU0saUJBQWlCO0FBRXBELFFBQU0sUUFBUTtBQUFBLElBQ2IsY0FBYyxJQUFJLENBQUMsU0FBZ0IsS0FBSyxJQUFJLE1BQU0sS0FBSyxJQUFJLENBQUM7QUFBQSxFQUM3RCxFQUFFLEtBQUssQ0FBQyxVQUFVO0FBQ2pCLFVBQU0sY0FBYyxjQUFjLElBQUksQ0FBQyxNQUFhLFdBQW1CO0FBQUEsTUFDdEUsY0FBYztBQUFBLE1BQ2QsVUFBVSxNQUFNLEtBQUs7QUFBQSxJQUN0QixFQUFFO0FBRUYsZ0JBQVksUUFBUSxDQUFDLFNBQW9EO0FBQ3hFLFVBQUksZ0JBQWdCLG1CQUFtQixLQUFLLFVBQVUsS0FBSyxZQUFZO0FBQ3ZFLHNCQUFnQixhQUFhO0FBRTdCLE1BQUFBLFdBQVUsS0FBSyxHQUFHLGFBQWE7QUFBQSxJQUNoQyxDQUFDO0FBQUEsRUFDRixDQUFDO0FBRUY7QUFHQSxlQUFzQiw2QkFBa0Q7QUFDdkUsTUFBSSxhQUF5QixDQUFDO0FBQzlCLE1BQUksZ0JBQWdCLEtBQUssSUFBSSxNQUFNLGlCQUFpQjtBQUVwRCxNQUFJLFdBQVcsY0FBYyxJQUFJLENBQUMsU0FBZ0IsS0FBSyxJQUFJLE1BQU0sS0FBSyxJQUFJLENBQUM7QUFFM0UsTUFBSSxRQUFRLE1BQU0sUUFBUSxJQUFJLFFBQVE7QUFDdEMsUUFBTSxjQUFjLGNBQWMsSUFBSSxDQUFDLE1BQWEsV0FBbUI7QUFBQSxJQUN0RSxjQUFjO0FBQUEsSUFDZCxVQUFVLE1BQU0sS0FBSztBQUFBLEVBQ3RCLEVBQUU7QUFDRixjQUFZLFFBQVEsQ0FBQyxTQUFvRDtBQUN4RSxRQUFJLGdCQUFnQixtQkFBbUIsS0FBSyxVQUFVLEtBQUssWUFBWTtBQUN2RSxvQkFBZ0IsYUFBYTtBQUU3QixlQUFXLEtBQUssR0FBRyxhQUFhO0FBQUEsRUFDakMsQ0FBQztBQUNELFNBQU87QUFDUjtBQUVBLGVBQXNCLHNCQUFzQixJQUFnQjtBQUMzRCxNQUFJLFNBQVMsVUFBVTtBQUN2QixNQUFJLFFBQVEsaUJBQWlCO0FBQzdCLE1BQUksT0FBTyxRQUFRLEVBQUUsVUFBVSxZQUFZLE1BQU0sTUFBTTtBQUd2RCxNQUFJLFlBQVksS0FBSztBQUNyQixNQUFJLENBQUM7QUFBVyxVQUFNLElBQUksTUFBTSxxQkFBcUI7QUFDckQsWUFBVSxjQUFjLGVBQWUsRUFBRSxNQUFNLFlBQVk7QUFFM0QsTUFDQyxVQUNBLFNBQ0EsT0FBTyxjQUNQLE1BQU0sY0FDTixPQUFPLGNBQWMsTUFBTSxZQUMxQjtBQUNELGlCQUFhO0FBQUEsTUFDWixNQUFNO0FBQUEsTUFDTixnQkFBZ0I7QUFBQSxNQUNoQixNQUFNO0FBQUEsSUFDUCxDQUFDO0FBQUEsRUFDRjtBQUNBLHNCQUFvQjtBQUFBLElBQ25CLE1BQU07QUFBQSxJQUNOLGdCQUFnQjtBQUFBLElBQ2hCLE1BQU07QUFBQSxFQUNQLENBQUM7QUFFRCw0QkFBMEIsWUFBWSxNQUFNO0FBRTVDLGNBQVk7QUFDYjtBQUVBLGVBQXNCLGNBQWMsSUFBZ0I7QUFDbkQsTUFBSSxTQUFTLFVBQVU7QUFDdkIsTUFBSSxRQUFRLFNBQVM7QUFDckIsTUFBSSxPQUFPLFFBQVEsRUFBRSxVQUFVLFlBQVksTUFBTSxNQUFNO0FBR3ZELE1BQUksWUFBWSxLQUFLO0FBQ3JCLE1BQUksQ0FBQztBQUFXLFVBQU0sSUFBSSxNQUFNLHFCQUFxQjtBQUNyRCxZQUFVLGNBQWMsZUFBZSxFQUFFLE1BQU0sWUFBWTtBQUUzRCxNQUNDLFVBQ0EsU0FDQSxPQUFPLGNBQ1AsTUFBTSxjQUNOLE9BQU8sY0FBYyxNQUFNLFlBQzFCO0FBQ0QsaUJBQWE7QUFBQSxNQUNaLE1BQU07QUFBQSxNQUNOLGdCQUFnQjtBQUFBLE1BQ2hCLE1BQU07QUFBQSxJQUNQLENBQUM7QUFBQSxFQUNGO0FBQ0EsY0FBWTtBQUFBLElBQ1gsTUFBTTtBQUFBLElBQ04sZ0JBQWdCO0FBQUEsSUFDaEIsTUFBTTtBQUFBLEVBQ1AsQ0FBQztBQUVELDRCQUEwQixZQUFZLE1BQU07QUFFNUMsY0FBWTtBQUNiOzs7QUR2cEJBLFNBQVMsWUFBWSxNQUFlO0FBQ25DLE1BQUksV0FBVyw2QkFBTSxVQUFVO0FBQy9CLHVDQUFVLGlCQUFpQixtQkFBbUIsUUFBUSxDQUFDLFNBQVM7QUFDL0QsU0FBSyxZQUFZO0FBQUEsRUFDbEI7QUFFQSxTQUFPO0FBQ1I7QUFFQSxlQUFzQixtQkFDckIsU0FDQSxlQUNBLE1BQ0M7QUFsQ0Y7QUFtQ0MsWUFBVSxPQUFPLFdBQVcsV0FBVyxVQUFVLFFBQVEsQ0FBQztBQUMxRCxRQUFNLENBQUMsUUFBUSxNQUFNLFFBQVEsTUFBTSxNQUFNLElBQUksUUFBUSxTQUFTLEdBQUcsSUFDaEUsUUFBUSxNQUFNLEdBQUc7QUFLbEIsTUFBSSxZQUFZLGNBQWMsVUFBVSxTQUFTLHVCQUF1QixJQUNyRSxNQUNBO0FBQ0gsTUFBSSxZQUFZLGdCQUFXLFVBQVUsUUFBUSxVQUFVLFFBQVEsUUFBUSxNQUFNLFVBQVU7QUFFdkYsTUFBSSxRQUFRLEtBQUssV0FBVyxpQkFBaUIsVUFBVTtBQUN2RCxNQUFJLFlBQVcsb0RBQWUsa0JBQWYsbUJBQThCO0FBRzdDLE1BQUk7QUFDSixNQUFJLGFBQWE7QUFDakIsUUFBTSxRQUFRLENBQUMsTUFBTSxNQUFNO0FBQzFCLFFBQUk7QUFBWTtBQUNoQixRQUFJLFFBQVEsVUFBVTtBQUNyQixtQkFBYTtBQUNiLHdCQUFrQjtBQUFBLElBQ25CO0FBQUEsRUFDRCxDQUFDO0FBU0QsTUFBSSxvQkFBb0I7QUFBVztBQUNuQyxNQUFJLGFBQWEsTUFBTSxlQUFlO0FBRXRDLE1BQUksaUJBQWlCLFlBQVksVUFBVTtBQUUzQyxNQUFJLFFBQVEsZUFBZSxVQUFVLE1BQU0sUUFBRztBQUc5QyxNQUFJLGlCQUFpQix5Q0FBWSxpQkFBaUI7QUFHbEQsTUFBSSxxQkFBcUIsTUFBTSxLQUFLLGtCQUFrQixDQUFDLENBQUMsRUFBRTtBQUFBLElBQ3pELENBQUMsU0FBUyxrQkFBYSxLQUFLLGFBQWEsTUFBTSxJQUFJO0FBQUEsRUFDcEQ7QUFDQSxNQUFJLFNBQVM7QUFTWixVQUFNLFFBQVEsbUJBQW1CO0FBQUEsTUFDaEMsQ0FBQyxXQUFXLGNBQWMsaUJBQWlCO0FBQzFDLFlBQUksYUFBYSxTQUFTLFFBQVEsQ0FBQyxDQUFDLEdBQUc7QUFDdEMsaUJBQU87QUFBQSxRQUNSO0FBQ0EsZUFBTztBQUFBLE1BQ1I7QUFBQSxNQUNBO0FBQUEsSUFDRDtBQUVBLFFBQUksQ0FBQyxTQUFTLFNBQVM7QUFBRyxZQUFNLElBQUksTUFBTSxxQkFBcUI7QUFHL0QsUUFBSSxZQUFZO0FBQUEsTUFDZixHQUFHLE1BQU0sTUFBTSxHQUFHLFFBQVEsQ0FBQztBQUFBLE1BQzNCLEdBQUcsbUJBQW1CLE1BQU0sR0FBRyxLQUFLO0FBQUEsSUFDckM7QUFHQSxRQUFJLG9CQUFvQixNQUFNLEtBQUssS0FBSyxFQUN0QyxNQUFNLEdBQUcsZUFBZSxFQUN4QixPQUFPLENBQUMsS0FBSyxTQUFTO0FBQ3RCLFVBQUksZ0JBQWdCLFlBQVksSUFBSTtBQUNwQyxVQUFJRyxTQUFRLGNBQWMsVUFBVSxNQUFNLFFBQUc7QUFFN0MsVUFBSUMsa0JBQWlCLDZCQUFNLGlCQUFpQjtBQUM1QyxVQUFJQyxzQkFBcUIsTUFBTSxLQUFLRCxtQkFBa0IsQ0FBQyxDQUFDLEVBQUU7QUFBQSxRQUN6RCxDQUFDLFNBQVMsa0JBQWEsS0FBSyxhQUFhLE1BQU0sSUFBSTtBQUFBLE1BQ3BEO0FBQ0EsVUFBSSxvQkFDSCxDQUFDLEdBQUdELFFBQU8sR0FBR0UsbUJBQWtCLEVBQUUsS0FBSyxFQUFFLElBQUk7QUFDOUMsYUFBTyxrQkFBa0IsU0FBUztBQUFBLElBQ25DLEdBQUcsQ0FBQztBQUdMLFFBQUlDLFFBQU8sb0JBQW9CLFVBQVUsS0FBSyxFQUFFLEVBQUU7QUFDbEQsUUFBSUMsTUFBS0QsUUFBTyxVQUFVO0FBRTFCLFVBQU0sY0FBYyxLQUFLLE1BQU0sT0FBTztBQUFBLE1BQ3JDLFNBQVMsRUFBRSxNQUFBQSxPQUFNLElBQUFDLEtBQUksUUFBUSxVQUFVO0FBQUEsSUFDeEMsQ0FBQztBQUNELFlBQVEsSUFBSSxXQUFXO0FBQ3ZCLFNBQUssU0FBUyxXQUFXO0FBQ3pCLFVBQU0sNEJBQTRCO0FBQUEsRUFHbkM7QUFDRDtBQUdBLElBQU0sa0JBQU4sY0FBOEIsd0JBQVc7QUFBQSxFQUN4QyxZQUNTLE1BQ0EsTUFDQSxLQUNQO0FBQ0QsVUFBTTtBQUpFO0FBQ0E7QUFDQTtBQUFBLEVBR1Q7QUFBQSxFQUVBLEdBQUcsT0FBd0I7QUFDMUIsV0FBTyxLQUFLLFNBQVMsTUFBTTtBQUFBLEVBQzVCO0FBQUEsRUFFQSxNQUFNLFdBQVcsTUFBYyxNQUFjLElBQVk7QUFNeEQsU0FBSyxPQUFPO0FBQUEsRUFDYjtBQUFBLEVBRUEsVUFBVTtBQUNULFdBQU8sS0FBSztBQUFBLEVBQ2I7QUFBQSxFQUVBLFFBQVE7QUFDUCxVQUFNLFFBQVE7QUFDZCxRQUFJLFVBQVUsTUFBTSxLQUFLLEtBQUssSUFBSTtBQUNsQyxRQUFJLENBQUM7QUFBUyxZQUFNLElBQUksTUFBTSxtQkFBbUI7QUFFakQsVUFBTSxDQUFDLFFBQVEsTUFBTSxRQUFRLE1BQU0sTUFBTSxJQUFJLFFBQVEsU0FBUyxHQUFHLElBQ2hFLFFBQVEsQ0FBQyxFQUFFLE1BQU0sR0FBRztBQUlyQixVQUFNLEVBQUUsTUFBTSxJQUFJLElBQUk7QUFBQSxNQUNyQixVQUFVLFdBQVcsZ0NBQWdDO0FBQUEsSUFDdEQ7QUFFQSxRQUFJO0FBQVMsV0FBSyxhQUFhLFFBQVEsUUFBUSxDQUFDLENBQUM7QUFFakQsVUFBTSxnQkFBZ0IsU0FBUyxjQUFjLE1BQU07QUFDbkQsa0JBQWMsVUFBVSxJQUFJLDBCQUEwQjtBQUN0RCxVQUFNLGdCQUFnQixTQUFTLGNBQWMsTUFBTTtBQUVuRCxrQkFBYyxVQUFVLElBQUksZ0JBQWdCO0FBRTVDLGtCQUFjLFlBQVkseUJBQXlCLElBQUk7QUFDdkQsa0JBQWMsVUFBVSxPQUFPLHlCQUF5QixXQUFXLEdBQUc7QUFFdEUsa0JBQWMsWUFBWSxhQUFhO0FBQ3ZDLGtCQUFjLFlBQVksSUFBSTtBQUU5QixrQkFBYyxpQkFBaUIsU0FBUyxPQUFPLE9BQU87QUFDckQsVUFBSSxHQUFHLFdBQVcsR0FBRyxTQUFTO0FBQzdCLHNCQUFjLFVBQVUsT0FBTyx1QkFBdUI7QUFDdEQsY0FBTSxtQkFBbUIsU0FBUyxlQUFlLEtBQUssSUFBSTtBQUMxRCxZQUFJO0FBQVMsZUFBSyxPQUFPLFFBQVEsQ0FBQztBQUFBLE1Bb0ZuQyxPQUFPO0FBQ04sc0JBQWMsRUFBRTtBQUFBLE1BQ2pCO0FBQUEsSUFDRCxDQUFDO0FBRUQsV0FBTztBQUFBLEVBQ1I7QUFDRDtBQUVBLElBQU0sc0JBQXNCLENBQzNCLE9BQ0EsTUFDQSxRQUNJO0FBQ0osTUFBSSxhQUFhLHdCQUFXLFFBQVE7QUFBQSxJQUNuQyxRQUFRLElBQUksZ0JBQWdCLE1BQU0sQ0FBQyxHQUFHLE1BQU0sR0FBRztBQUFBLEVBQ2hELENBQUM7QUFDRCxTQUFPO0FBQ1I7QUFFQSxJQUFNLG1CQUFtQixJQUFJLDRCQUFlO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFJM0MsUUFBUTtBQUFBLEVBQ1IsWUFBWSxDQUFDLE9BQU8sTUFBTSxRQUFRO0FBQ2pDLFdBQU8sb0JBQW9CLE9BQU8sTUFBTSxHQUFHO0FBQUEsRUFDNUM7QUFDRCxDQUFDO0FBRU0sSUFBTSxxQkFBcUIsd0JBQVc7QUFBQSxFQUM1QyxNQUFNO0FBQUEsSUFFTCxZQUFZLE1BQWtCO0FBQzdCLFdBQUsscUJBQXFCLGlCQUFpQixXQUFXLElBQUk7QUFBQSxJQUMzRDtBQUFBLElBQ0EsT0FBTyxRQUFvQjtBQUMxQixXQUFLLHFCQUFxQixpQkFBaUI7QUFBQSxRQUMxQztBQUFBLFFBQ0EsS0FBSztBQUFBLE1BQ047QUFBQSxJQUNEO0FBQUEsSUFDQSxVQUFVO0FBQ1QsV0FBSyxxQkFBcUIsd0JBQVc7QUFBQSxJQUN0QztBQUFBLEVBQ0Q7QUFBQSxFQUNBO0FBQUEsSUFDQyxhQUFhLENBQUMsYUFBYSxTQUFTO0FBQUEsSUFDcEMsU0FBUyxDQUFDLFdBQ1Qsd0JBQVcsYUFBYSxHQUFHLENBQUMsU0FBUztBQTVVeEM7QUE2VUksZUFBTyxVQUFLLE9BQU8sTUFBTSxNQUFsQixtQkFBcUIsdUJBQXNCLHdCQUFXO0FBQUEsSUFDOUQsQ0FBQztBQUFBLEVBQ0g7QUFDRDs7O0FnQmhWQSxJQUFBQyxtQkFBNkM7QUFVN0MsZUFBc0IsZ0JBQ3JCLFNBQWtCLE9BQ2xCLE9BQWdCLE9BQ2Y7QUFDRCxRQUFNLE9BQU8sS0FBSyxJQUFJLFVBQVUsb0JBQW9CLDZCQUFZO0FBRWhFLE1BQUksTUFBTTtBQUNULFFBQUksWUFBWSxLQUFLLE9BQU8sYUFBYTtBQUN6QyxRQUFJLEtBQUssTUFBTTtBQUNkLFlBQU0sT0FBTyxLQUFLO0FBQ2xCLFlBQU0sT0FBTyxLQUFLLE9BQU8sWUFBWSxLQUFLLE9BQU8sVUFBVSxNQUFNLENBQUM7QUFDbEUsWUFBTSxLQUFLLEtBQUssT0FBTyxZQUFZLEtBQUssT0FBTyxVQUFVLElBQUksQ0FBQztBQUM5RCxZQUFNLEVBQUUsUUFBUSxPQUFPLElBQUksbUJBQW1CLE1BQU0sTUFBTSxFQUFFO0FBQzVELFVBQUksWUFBWSxnQkFBVztBQUFBLFFBQzFCO0FBQUEsTUFDRCxNQUFNLHlCQUF5QixTQUFTLE1BQU07QUFBQSxRQUM3QztBQUFBLE1BQ0QsS0FBSyx5QkFBeUIsS0FBSyxLQUFLLElBQUksS0FBSyxRQUFRO0FBQUEsTUFFeEQsWUFDRyxTQUFTLE1BQU07QUFHbkIsWUFBTSxVQUFVLFVBQVUsVUFBVSxTQUFTO0FBQUEsSUFDOUM7QUFBQSxFQUNEO0FBQ0Q7OztBcEJMQSxJQUFBQyxlQUEyQjtBQUlwQixTQUFTLDBCQUEwQixNQUFxQjtBQUM5RCxRQUFNLFNBQVMsZ0JBQWdCLElBQUksRUFBRTtBQUNyQyxRQUFNLG9CQUFvQixxQkFBcUIsTUFBTTtBQUVyRCxNQUFJQyxhQUFZLENBQUM7QUFDakIsV0FBUyxJQUFJLEdBQUcsSUFBSSxrQkFBa0IsU0FBUyxRQUFRLEtBQUs7QUFDM0QsSUFBQUEsV0FBVSxLQUFLLGtCQUFrQixTQUFTLEtBQUssQ0FBQyxDQUFnQjtBQUFBLEVBQ2pFO0FBRUEsV0FBUyxZQUFZQSxZQUFXO0FBQy9CLFFBQUksWUFBWSxTQUFTLGFBQWEsV0FBVyxJQUM5QyxLQUFLLE1BQU0sU0FBUyxhQUFhLFdBQVcsQ0FBRSxJQUM5QztBQUNILFFBQUksV0FBVztBQUNkLFVBQUksZ0JBQWdCLFVBQVUsbUJBQW1CO0FBQ2pELFVBQUksY0FBYyxVQUFVLG1CQUFtQjtBQUMvQyxVQUFJLGFBQWEsd0JBQXdCLE1BQU07QUFDL0MsZ0NBQTBCLFlBQVksZUFBZSxXQUFXO0FBQUEsSUFDakU7QUFBQSxFQUNEO0FBQ0Q7QUFFQSxJQUFxQixrQkFBckIsY0FBNkMsd0JBQU87QUFBQSxFQUNuRCxTQUFTO0FBQ1IsZUFBVyxZQUFZO0FBQ3RCLFlBQU0sa0JBQWtCO0FBQ3hCLFlBQU0sU0FBUyxLQUFLLElBQUksVUFBVSxnQkFBZ0IsVUFBVTtBQUU1RCxVQUFJLFdBQXFDLE9BQU87QUFBQSxRQUMvQyxDQUFDLFNBQXdCO0FBRXhCLGlCQUFPLG9CQUFvQixJQUFJO0FBQUEsUUFDaEM7QUFBQSxNQUNEO0FBRUEsY0FBUSxJQUFJLFFBQVEsRUFBRSxLQUFLLE9BQU9DLFlBQTRCO0FBQzdELGNBQU0sTUFBTSxHQUFJO0FBQ2hCLFFBQUFBLFFBQU8sUUFBUSxDQUFDLFNBQXdCO0FBQ3ZDLG9DQUEwQixJQUFJO0FBQUEsUUFvQi9CLENBQUM7QUFBQSxNQUNGLENBQUM7QUFFRCxXQUFLO0FBQUEsUUFDSixLQUFLLElBQUksVUFBVSxHQUFHLHNCQUFzQixPQUFPLE9BQU87QUFJekQsY0FBSTtBQUNILGtCQUFNLGFBQ0wsS0FBSyxJQUFJLFVBQVUsb0JBQW9CLDZCQUFZO0FBQ3BELGlCQUFJLHlDQUFZLFNBQVEsTUFBTTtBQUM3QixvQkFBTSxvQkFBb0IsV0FBVyxJQUFJO0FBQ3pDLG9CQUFNLE1BQU0sR0FBSTtBQUVoQix3Q0FBMEIsV0FBVyxJQUFJO0FBQUEsWUE0QjFDO0FBQUEsVUFDRCxTQUFTLEdBQVA7QUFDRCxvQkFBUSxJQUFJLENBQUM7QUFBQSxVQUNkO0FBQUEsUUFDRCxDQUFDO0FBQUEsTUFDRjtBQUFBLElBQ0QsR0FBRyxHQUFJO0FBRVAsZUFBVyxJQUFJO0FBRWYsU0FBSyx3QkFBd0I7QUFBQSxNQUM1QjtBQUFBLE1BQ0E7QUFBQSxNQUNBLHdCQUFXLGVBQWUsR0FBRyxTQUFVLEdBQUc7QUFDekMsWUFBSSxLQUFLLElBQUksRUFBRSxRQUFRLEtBQUssWUFBWSxFQUFFLFFBQVEsS0FBSyxNQUFNLElBQUksR0FBRztBQUNuRSxzQ0FBNEI7QUFBQSxRQUM3QjtBQUFBLE1BQ0QsQ0FBQztBQUFBLElBQ0YsQ0FBQztBQUVELFNBQUssaUJBQWlCLFVBQVUsYUFBYSxPQUFPLFFBQVE7QUFDM0QsVUFBSSxJQUFJLFdBQVcsSUFBSTtBQUFTO0FBRWhDLFVBQUk7QUFDSixVQUNDLElBQUksV0FDSCxJQUFJLGtCQUFrQixtQkFDdEIsSUFBSSxrQkFBa0IsY0FDdEIsSUFBSSxrQkFBa0IsaUJBQ3RCO0FBRUQsZUFBTyxJQUFJO0FBRVgsZUFDQyxFQUFFLGdCQUFnQixvQkFDbEIsS0FBSyxpQkFBaUIsTUFDckI7QUFDRCxpQkFBTyxLQUFLO0FBQUEsUUFDYjtBQUFBLE1BQ0Q7QUFFQSxVQUNDLFFBQ0EsZ0JBQWdCLG9CQUNoQiw2QkFBTSxtQkFDTiw2QkFBTSxjQUFjLFVBQVUsU0FBUyw4QkFDdEM7QUFDRCxnQkFBUSxJQUFJLDhCQUE4QjtBQUMxQyxZQUFJLFNBQVMsS0FBSztBQUFNO0FBRXhCLFlBQUksQ0FBQyxLQUFLLGFBQWEsTUFBTSxHQUFHO0FBQy9CLGlCQUFPLEtBQUs7QUFDWixpQkFBTyxLQUFLLGNBQWMsc0JBQXNCO0FBQ2hELGNBQUksQ0FBQztBQUFNLGtCQUFNLElBQUksTUFBTSx3QkFBd0I7QUFBQSxRQUNwRDtBQUVBLGlDQUF5QixNQUFNLFlBQVksS0FBSztBQUNoRCw2QkFBcUIsTUFBTSxZQUFZLEtBQUs7QUFBQSxNQUM3QyxXQUNDLFFBQ0EsZ0JBQWdCLG1CQUNoQixLQUFLLGFBQWEsV0FBVyxHQUM1QjtBQUNELGdCQUFRLElBQUksNkJBQTZCO0FBQ3pDLFlBQUksaUJBQWlCLEtBQUs7QUFBTTtBQUVoQyw0QkFBb0IsSUFBSTtBQUFBLE1BQ3pCLFdBQVcsU0FBUyxLQUFLLE1BQU07QUFDOUIsZ0JBQVEsSUFBSSw0QkFBNEI7QUFHeEMsY0FBTSxlQUFlO0FBQUEsVUFDcEI7QUFBQSxVQUNBO0FBQUEsVUFDQTtBQUFBLFVBQ0E7QUFBQSxVQUNBO0FBQUEsVUFDQTtBQUFBLFVBQ0E7QUFBQSxRQUNEO0FBR0EsY0FBTSxpQkFBaUIsTUFDdEIsYUFBYSxNQUFNLENBQUMsUUFBUSxPQUFPLFNBQVMsQ0FBQztBQUc5QyxZQUFJLENBQUMsZUFBZSxHQUFHO0FBQ3RCLGdCQUFNLElBQUksUUFBUSxDQUFDLFlBQVksV0FBVyxTQUFTLEVBQUUsQ0FBQztBQUFBLFFBQ3ZEO0FBRUEsY0FBTSx3QkFBd0I7QUFDOUIsa0NBQTBCLFlBQVksS0FBSztBQUFBLE1BQzVDLFdBQVcsaUJBQWlCLEtBQUssTUFBTTtBQUN0QyxnQkFBUSxJQUFJLDJCQUEyQjtBQUd2QyxjQUFNLGVBQWU7QUFBQSxVQUNwQjtBQUFBLFVBQ0E7QUFBQSxVQUNBO0FBQUEsVUFDQTtBQUFBLFVBQ0E7QUFBQSxVQUNBO0FBQUEsVUFDQTtBQUFBLFVBQ0E7QUFBQSxVQUNBO0FBQUEsUUFDRDtBQUdBLGNBQU0saUJBQWlCLE1BQ3RCLGFBQWEsTUFBTSxDQUFDLFFBQVEsT0FBTyxpQkFBaUIsQ0FBQztBQUd0RCxZQUFJLENBQUMsZUFBZSxHQUFHO0FBQ3RCLGdCQUFNLElBQUksUUFBUSxDQUFDLFlBQVksV0FBVyxTQUFTLEVBQUUsQ0FBQztBQUFBLFFBQ3ZEO0FBRUEsZ0JBQVEsSUFBSSxnQ0FBZ0M7QUFFNUMsY0FBTSx1QkFBdUI7QUFBQSxNQUM5QixPQUFPO0FBQUEsTUFDUDtBQUFBLElBTUQsQ0FBQztBQUlELFNBQUssaUJBQWlCLFVBQVUsU0FBUyxPQUFPLFFBQVE7QUFDdkQsY0FBUSxJQUFJLE9BQU87QUFDbkIsWUFBTSxpQkFBaUIsR0FBRztBQUMxQixrQ0FBNEI7QUFBQSxJQUk3QixDQUFDO0FBRUQsU0FBSyxpQkFBaUIsVUFBVSxTQUFTLE9BQU8sUUFBUTtBQUN2RCxVQUFJLElBQUksV0FBVyxJQUFJO0FBQVM7QUFHaEMsWUFBTSxpQkFBaUIsR0FBRztBQUMxQixrQ0FBNEI7QUFBQSxJQUU3QixDQUFDO0FBRUQsU0FBSyxpQkFBaUIsVUFBVSxXQUFXLE9BQU8sUUFBUTtBQUd6RCxjQUFRLElBQUksSUFBSSxHQUFHO0FBRW5CLGNBQVEsSUFBSSxJQUFJLFFBQVE7QUFFeEIsY0FBUSxJQUFJLElBQUksT0FBTztBQUN2QixjQUFRLElBQUksSUFBSSxPQUFPO0FBRXZCLGNBQVE7QUFBQSxRQUNQLElBQUksT0FBTyxRQUFRLElBQUksV0FBVyxJQUFJLFlBQVksSUFBSTtBQUFBLE1BQ3ZEO0FBQ0EsVUFDQyxJQUFJLE9BQU8sV0FDVixJQUFJLFdBQVcsSUFBSSxZQUNwQixJQUFJLFlBQ0osSUFBSSxRQUNIO0FBRUQsd0JBQWdCLEtBQUs7QUFDckIsWUFBSSx3QkFBTywrQkFBK0I7QUFBQSxNQUMzQyxZQUNFLElBQUksT0FBTyxPQUFPLElBQUksT0FBTyxTQUM3QixJQUFJLFdBQVcsSUFBSSxZQUNwQixJQUFJLFVBQ0g7QUFFRCx3QkFBZ0IsSUFBSTtBQUNwQixZQUFJLHdCQUFPLCtCQUErQjtBQUFBLE1BQzNDLFlBQ0UsSUFBSSxPQUFPLE9BQU8sSUFBSSxPQUFPLFNBQzdCLElBQUksV0FBVyxJQUFJLFlBQ3BCLElBQUksVUFDSDtBQUNELFlBQUksU0FBUyxJQUFJO0FBQ2pCLFlBQUksV0FBVyxNQUFNLEtBQUssT0FBTyxRQUFRO0FBQ3pDLFlBQUksY0FBYyxTQUFTO0FBQUEsVUFBTyxDQUFDLFVBQ2xDLE1BQU0sVUFBVSxTQUFTLFdBQVc7QUFBQSxRQUNyQyxFQUFFLENBQUM7QUFFSCxjQUFNLFFBQVEsTUFBTTtBQUFBLFVBQ25CLFlBQVksaUJBQWlCLGlCQUFpQjtBQUFBLFFBQy9DO0FBRUEsWUFDQyxNQUFNO0FBQUEsVUFBTSxDQUFDLFNBQ1osS0FBSyxVQUFVLFNBQVMsdUJBQXVCO0FBQUEsUUFDaEQsS0FDQyxDQUFDLE1BQU07QUFBQSxVQUFNLENBQUMsU0FDZCxLQUFLLFVBQVUsU0FBUyx1QkFBdUI7QUFBQSxRQUNoRCxLQUNDLE1BQU0sT0FBTyxDQUFDLEtBQUssU0FBUztBQUMzQixjQUFJO0FBQUssbUJBQU87QUFDaEIsaUJBQU8sS0FBSyxVQUFVLFNBQVMsdUJBQXVCO0FBQUEsUUFDdkQsR0FBRyxLQUFLLEdBQ1I7QUFDRCxnQkFBTSxRQUFRLENBQUMsU0FBUztBQXRWN0I7QUF1Vk0saUJBQUssVUFBVSxPQUFPLHlCQUF5QixLQUFLO0FBSXBELGdCQUFJLGlCQUFnQixVQUFLLGtCQUFMLG1CQUFvQjtBQUFBLGNBQ3ZDO0FBQUE7QUFFRCxnQkFBSSxVQUFVLCtDQUFlLGFBQWE7QUFDMUMsa0JBQU0sYUFBYSxLQUFLLElBQUksVUFBVSxRQUFRO0FBQzlDLGtCQUFNLFNBQVMsZ0JBQWdCLFVBQVUsRUFBRTtBQUMzQyxrQkFBTSxhQUFhLHdCQUF3QixNQUFNO0FBRWpELCtCQUFtQixTQUFTLE1BQU0sVUFBVTtBQUFBLFVBQzdDLENBQUM7QUFDRCxjQUFJLHdCQUFPLHVCQUF1QjtBQUFBLFFBQ25DLE9BQU87QUFDTixnQkFBTSxRQUFRLENBQUMsU0FBMEI7QUFDeEMsa0JBQU0sUUFBUSxDQUFDQyxVQUFTO0FBeFc5QjtBQXlXTyxjQUFBQSxNQUFLLFVBQVUsT0FBTyx5QkFBeUIsSUFBSTtBQUVuRCxrQkFBSSxpQkFBZ0IsS0FBQUEsTUFBSyxrQkFBTCxtQkFBb0I7QUFBQSxnQkFDdkM7QUFBQTtBQUVELGtCQUFJLFVBQVUsK0NBQWUsYUFBYTtBQUMxQyxvQkFBTSxhQUFhLEtBQUssSUFBSSxVQUFVLFFBQVE7QUFDOUMsb0JBQU0sU0FBUyxnQkFBZ0IsVUFBVSxFQUFFO0FBQzNDLG9CQUFNLGFBQWEsd0JBQXdCLE1BQU07QUFFakQsaUNBQW1CLFNBQVNBLE9BQU0sVUFBVTtBQUFBLFlBQzdDLENBQUM7QUFBQSxVQUNGLENBQUM7QUFDRCxjQUFJLHdCQUFPLHdCQUF3QjtBQUFBLFFBQ3BDO0FBQUEsTUFDRDtBQUFBLElBQ0QsQ0FBQztBQUFBLEVBa0RGO0FBQUEsRUFFQSxXQUFXO0FBQUEsRUFBQztBQUNiOyIsCiAgIm5hbWVzIjogWyJpbXBvcnRfb2JzaWRpYW4iLCAidGhhdCIsICJpbXBvcnRfdmlldyIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfdmlldyIsICJpbXBvcnRfc3RhdGUiLCAiZiIsICJpbXBvcnRfdmlldyIsICJlZGl0b3IiLCAiYmFja2xpbmtDb250YWluZXIiLCAid2luZG93SGVpZ2h0IiwgInNjcm9sbFRvcCIsICJzY3JvbGxCb3R0b20iLCAidmlzaWJsZUVsZW1lbnRzIiwgImNvbnRhaW5lciIsICJkYXRhU3RyaW5nIiwgImN1cnNvclZpZXdwb3J0IiwgImxlYWZJZCIsICJvcmlnaW5hbExlYWZJZCIsICJwcmVmaXgiLCAidGV4dCIsICJzdWZmaXgiLCAiZmlsZSIsICJmcm9tIiwgInRvIiwgImVkaXRvclZpZXciLCAib3JpZ2luYWxMZWFmIiwgImRvY3VtZW50IiwgInN2ZyIsICJiYWNrbGlua3MiLCAiYmFja2xpbmtzIiwgInRleHQiLCAiaW5kZXgiLCAicGFydHMiLCAibGluZVJlZmVyZW5jZXMiLCAibGluZVJlZmVyZW5jZXNEYXRhIiwgImZyb20iLCAidG8iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF92aWV3IiwgImJhY2tsaW5rcyIsICJsZWF2ZXMiLCAic3BhbiJdCn0K
