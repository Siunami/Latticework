/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => ReferencePlugin,
  generateDefaultHighlights: () => generateDefaultHighlights,
  handleMovementEffects: () => handleMovementEffects2
});
module.exports = __toCommonJS(main_exports);
var import_obsidian6 = require("obsidian");

// src/state.ts
var import_state = require("@codemirror/state");
var that = import_state.StateField.define({
  create() {
    return null;
  },
  update(value, tr) {
    if (tr["annotations"].length == 2 && tr["annotations"][0].value.type == "that") {
      return tr["annotations"][0].value.that.app;
    }
    return value;
  }
});
var hoveredCursor = import_state.StateField.define({
  create() {
    return null;
  },
  update(value, tr) {
    if (tr["annotations"].length == 2 && tr["annotations"][0].value.type == "hoveredCursor") {
      if (value)
        return [
          ...value.filter(
            (cursor) => cursor.user != tr["annotations"][0].value.user
          ),
          {
            cursor: tr["annotations"][0].value.cursor,
            user: tr["annotations"][0].value.user
          }
        ];
      return [
        {
          cursor: tr["annotations"][0].value.cursor,
          user: tr["annotations"][0].value.user
        }
      ];
    } else if (tr["annotations"].length == 2 && tr["annotations"][0].value.type == "removeHoveredCursor") {
      if (value)
        return value.filter(
          (cursor) => cursor.user != tr["annotations"][0].value.user
        );
      return value;
    }
    return value;
  }
});
var backlinks = import_state.StateField.define({
  create() {
    return [];
  },
  update(value, tr) {
    if (tr.effects.length > 0) {
      try {
        let data = JSON.parse(
          tr.effects[0].value
        );
        if (data.type == "backlink") {
          if (data.backlinks.length == 0)
            return value;
          let referencingLocation = data.backlinks[0]["referencingLocation"]["filename"];
          let filteredValues = value.filter(
            (backlink) => backlink.referencingLocation.filename != referencingLocation
          );
          return [...filteredValues, ...data.backlinks];
        }
        return value;
      } catch (e) {
        console.log(e);
        return value;
      }
    }
    return value;
  }
});
var hoverElement = import_state.StateField.define({
  create() {
    return null;
  },
  update(value, tr) {
    if (tr.effects.length > 0) {
      try {
        let data = JSON.parse(tr.effects[0].value);
        if (data.type == "hover-start") {
          return Object.assign({}, data);
        } else if (data.type == "hover") {
          if (value)
            return Object.assign(value, data);
          return data;
        } else if (data.type == "hover-off") {
          return null;
        }
        return value;
      } catch (e) {
        console.log(e);
        return value;
      }
    }
    return value;
  }
});
var backlinkHoverElement = import_state.StateField.define({
  create() {
    return null;
  },
  update(value, tr) {
    if (tr.effects.length > 0) {
      try {
        let data = JSON.parse(tr.effects[0].value);
        if (data.type == "backlink-start") {
          return Object.assign({}, data);
        } else if (data.type == "backlink-update") {
          if (value)
            return Object.assign(value, data);
          return data;
        } else if (data.type == "backlink-off") {
          return null;
        }
        return value;
      } catch (e) {
        console.log(e);
        return value;
      }
    }
    return value;
  }
});
var cursorElement = import_state.StateField.define({
  create() {
    return null;
  },
  update(value, tr) {
    if (tr.effects.length > 0) {
      try {
        let data = JSON.parse(tr.effects[0].value);
        if (data.type == "cursor-start") {
          return {};
        } else if (data.type == "cursor") {
          if (value)
            return Object.assign(value, data);
          return data;
        } else if (data.type == "cursor-off") {
          return null;
        }
        return value;
      } catch (e) {
        console.log(e);
        return value;
      }
    }
    return value;
  }
});
var editorChange = import_state.StateField.define({
  create() {
    return null;
  },
  update(value, tr) {
    if (tr.effects.length > 0) {
      try {
        let data = JSON.parse(tr.effects[0].value);
        if (data.type == "sync") {
          return value;
        }
        return value;
      } catch (e) {
        console.log(e);
        return value;
      }
    }
    return value;
  }
});
var thatAnnotation = import_state.Annotation.define();
var hoveredCursorAnnotation = import_state.Annotation.define();
var hoverEffect = import_state.StateEffect.define();
var backlinkHoverEffect = import_state.StateEffect.define();
var cursorEffect = import_state.StateEffect.define();
var backlinkEffect = import_state.StateEffect.define();
var state = import_state.EditorState.create({
  extensions: [
    that,
    hoveredCursor,
    backlinks,
    hoverElement,
    backlinkHoverElement,
    cursorElement,
    editorChange
  ]
});
function getThat() {
  return state.field(that);
}
function updateThat(that2) {
  state = state.update({
    annotations: thatAnnotation.of({
      type: "that",
      that: that2
    })
  }).state;
}
function getHoveredCursor() {
  return state.field(hoveredCursor);
}
function updateHoveredCursor(cursor, user) {
  state = state.update({
    annotations: hoveredCursorAnnotation.of({
      type: "hoveredCursor",
      cursor,
      user
    })
  }).state;
}
function removeHoveredCursor(user) {
  state = state.update({
    annotations: hoveredCursorAnnotation.of({
      type: "removeHoveredCursor",
      user
    })
  }).state;
}
function getHover() {
  return state.field(hoverElement);
}
function updateHover(value) {
  state = state.update({
    effects: hoverEffect.of(
      JSON.stringify(Object.assign(value, { type: "hover" }))
    )
  }).state;
}
function resetHover() {
  state = state.update({
    effects: hoverEffect.of(
      JSON.stringify({
        type: "hover-off"
      })
    )
  }).state;
}
function getBacklinkHover() {
  return state.field(backlinkHoverElement);
}
function updateBacklinkHover(value) {
  state = state.update({
    effects: backlinkHoverEffect.of(
      JSON.stringify(Object.assign(value, { type: "backlink-update" }))
    )
  }).state;
}
function resetBacklinkHover() {
  state = state.update({
    effects: backlinkHoverEffect.of(
      JSON.stringify({
        type: "backlink-off"
      })
    )
  }).state;
}
function getCursor() {
  return state.field(cursorElement);
}
function updateCursor(value) {
  state = state.update({
    effects: cursorEffect.of(
      JSON.stringify(Object.assign(value, { type: "cursor" }))
    )
  }).state;
}
function resetCursor() {
  state = state.update({
    effects: cursorEffect.of(
      JSON.stringify({
        type: "cursor-off"
      })
    )
  }).state;
}
function updateBacklinks(value) {
  state = state.update({
    effects: backlinkEffect.of(
      JSON.stringify(Object.assign({ backlinks: value }, { type: "backlink" }))
    )
  }).state;
}

// src/widget/highlightWidget.ts
var import_view = require("@codemirror/view");

// src/constants.ts
var REFERENCE_REGEX = /\[\u2197\]\(urn:([^)]*)\)/g;
var ACTION_TYPE = {
  MOUSE: "mouse",
  CURSOR: "cursor",
  BACKLINK: "backlink"
};
var SVG_HOVER_COLOR = "rgb(187, 215, 230)";
var REFERENCE_ICON_HEIGHT = 20;
var PORTAL_TEXT_SLICE_SIZE = 100;

// src/widget/highlightWidget.ts
var HighlighterWidget = class extends import_view.WidgetType {
  constructor(name, view) {
    super();
    this.name = name;
    this.view = view;
  }
  eq(other) {
    return this.name === other.name;
  }
  toDOM() {
    const span = document.createElement("fragment");
    span.textContent = this.name;
    span.style.backgroundColor = SVG_HOVER_COLOR;
    span.style.color = "black";
    return span;
  }
};
var highlighterDecoration = (match, view) => import_view.Decoration.replace({
  widget: new HighlighterWidget(match[1], view)
});
var highlightMatcher = new import_view.MatchDecorator({
  regexp: /\+\+\+(.*?)\+\+\+/g,
  decoration: (match, view, pos) => {
    return highlighterDecoration(match, view);
  }
});
var highlights = import_view.ViewPlugin.fromClass(
  class {
    constructor(view) {
      this.highlights = highlightMatcher.createDeco(view);
    }
    update(update) {
      this.highlights = highlightMatcher.updateDeco(update, this.highlights);
    }
    destroy() {
      this.highlights = import_view.Decoration.none;
    }
  },
  {
    decorations: (instance) => instance.highlights,
    provide: (plugin) => import_view.EditorView.atomicRanges.of((view) => {
      var _a;
      return ((_a = view.plugin(plugin)) == null ? void 0 : _a.highlights) || import_view.Decoration.none;
    })
  }
);

// src/widget/referenceWidget.ts
var import_view4 = require("@codemirror/view");

// src/references.ts
var import_obsidian4 = require("obsidian");

// node_modules/uuid/dist/esm-browser/rng.js
var getRandomValues;
var rnds8 = new Uint8Array(16);
function rng() {
  if (!getRandomValues) {
    getRandomValues = typeof crypto !== "undefined" && crypto.getRandomValues && crypto.getRandomValues.bind(crypto);
    if (!getRandomValues) {
      throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");
    }
  }
  return getRandomValues(rnds8);
}

// node_modules/uuid/dist/esm-browser/regex.js
var regex_default = /^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;

// node_modules/uuid/dist/esm-browser/validate.js
function validate(uuid) {
  return typeof uuid === "string" && regex_default.test(uuid);
}
var validate_default = validate;

// node_modules/uuid/dist/esm-browser/stringify.js
var byteToHex = [];
for (let i = 0; i < 256; ++i) {
  byteToHex.push((i + 256).toString(16).slice(1));
}
function unsafeStringify(arr, offset = 0) {
  return byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + "-" + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + "-" + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + "-" + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + "-" + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]];
}

// node_modules/uuid/dist/esm-browser/parse.js
function parse(uuid) {
  if (!validate_default(uuid)) {
    throw TypeError("Invalid UUID");
  }
  let v;
  const arr = new Uint8Array(16);
  arr[0] = (v = parseInt(uuid.slice(0, 8), 16)) >>> 24;
  arr[1] = v >>> 16 & 255;
  arr[2] = v >>> 8 & 255;
  arr[3] = v & 255;
  arr[4] = (v = parseInt(uuid.slice(9, 13), 16)) >>> 8;
  arr[5] = v & 255;
  arr[6] = (v = parseInt(uuid.slice(14, 18), 16)) >>> 8;
  arr[7] = v & 255;
  arr[8] = (v = parseInt(uuid.slice(19, 23), 16)) >>> 8;
  arr[9] = v & 255;
  arr[10] = (v = parseInt(uuid.slice(24, 36), 16)) / 1099511627776 & 255;
  arr[11] = v / 4294967296 & 255;
  arr[12] = v >>> 24 & 255;
  arr[13] = v >>> 16 & 255;
  arr[14] = v >>> 8 & 255;
  arr[15] = v & 255;
  return arr;
}
var parse_default = parse;

// node_modules/uuid/dist/esm-browser/v35.js
function stringToBytes(str) {
  str = unescape(encodeURIComponent(str));
  const bytes = [];
  for (let i = 0; i < str.length; ++i) {
    bytes.push(str.charCodeAt(i));
  }
  return bytes;
}
var DNS = "6ba7b810-9dad-11d1-80b4-00c04fd430c8";
var URL = "6ba7b811-9dad-11d1-80b4-00c04fd430c8";
function v35(name, version, hashfunc) {
  function generateUUID(value, namespace, buf, offset) {
    var _namespace;
    if (typeof value === "string") {
      value = stringToBytes(value);
    }
    if (typeof namespace === "string") {
      namespace = parse_default(namespace);
    }
    if (((_namespace = namespace) === null || _namespace === void 0 ? void 0 : _namespace.length) !== 16) {
      throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");
    }
    let bytes = new Uint8Array(16 + value.length);
    bytes.set(namespace);
    bytes.set(value, namespace.length);
    bytes = hashfunc(bytes);
    bytes[6] = bytes[6] & 15 | version;
    bytes[8] = bytes[8] & 63 | 128;
    if (buf) {
      offset = offset || 0;
      for (let i = 0; i < 16; ++i) {
        buf[offset + i] = bytes[i];
      }
      return buf;
    }
    return unsafeStringify(bytes);
  }
  try {
    generateUUID.name = name;
  } catch (err) {
  }
  generateUUID.DNS = DNS;
  generateUUID.URL = URL;
  return generateUUID;
}

// node_modules/uuid/dist/esm-browser/native.js
var randomUUID = typeof crypto !== "undefined" && crypto.randomUUID && crypto.randomUUID.bind(crypto);
var native_default = {
  randomUUID
};

// node_modules/uuid/dist/esm-browser/v4.js
function v4(options, buf, offset) {
  if (native_default.randomUUID && !buf && !options) {
    return native_default.randomUUID();
  }
  options = options || {};
  const rnds = options.random || (options.rng || rng)();
  rnds[6] = rnds[6] & 15 | 64;
  rnds[8] = rnds[8] & 63 | 128;
  if (buf) {
    offset = offset || 0;
    for (let i = 0; i < 16; ++i) {
      buf[offset + i] = rnds[i];
    }
    return buf;
  }
  return unsafeStringify(rnds);
}
var v4_default = v4;

// node_modules/uuid/dist/esm-browser/sha1.js
function f(s, x, y, z) {
  switch (s) {
    case 0:
      return x & y ^ ~x & z;
    case 1:
      return x ^ y ^ z;
    case 2:
      return x & y ^ x & z ^ y & z;
    case 3:
      return x ^ y ^ z;
  }
}
function ROTL(x, n) {
  return x << n | x >>> 32 - n;
}
function sha1(bytes) {
  const K = [1518500249, 1859775393, 2400959708, 3395469782];
  const H = [1732584193, 4023233417, 2562383102, 271733878, 3285377520];
  if (typeof bytes === "string") {
    const msg = unescape(encodeURIComponent(bytes));
    bytes = [];
    for (let i = 0; i < msg.length; ++i) {
      bytes.push(msg.charCodeAt(i));
    }
  } else if (!Array.isArray(bytes)) {
    bytes = Array.prototype.slice.call(bytes);
  }
  bytes.push(128);
  const l = bytes.length / 4 + 2;
  const N = Math.ceil(l / 16);
  const M = new Array(N);
  for (let i = 0; i < N; ++i) {
    const arr = new Uint32Array(16);
    for (let j = 0; j < 16; ++j) {
      arr[j] = bytes[i * 64 + j * 4] << 24 | bytes[i * 64 + j * 4 + 1] << 16 | bytes[i * 64 + j * 4 + 2] << 8 | bytes[i * 64 + j * 4 + 3];
    }
    M[i] = arr;
  }
  M[N - 1][14] = (bytes.length - 1) * 8 / Math.pow(2, 32);
  M[N - 1][14] = Math.floor(M[N - 1][14]);
  M[N - 1][15] = (bytes.length - 1) * 8 & 4294967295;
  for (let i = 0; i < N; ++i) {
    const W = new Uint32Array(80);
    for (let t = 0; t < 16; ++t) {
      W[t] = M[i][t];
    }
    for (let t = 16; t < 80; ++t) {
      W[t] = ROTL(W[t - 3] ^ W[t - 8] ^ W[t - 14] ^ W[t - 16], 1);
    }
    let a = H[0];
    let b = H[1];
    let c = H[2];
    let d = H[3];
    let e = H[4];
    for (let t = 0; t < 80; ++t) {
      const s = Math.floor(t / 20);
      const T = ROTL(a, 5) + f(s, b, c, d) + e + K[s] + W[t] >>> 0;
      e = d;
      d = c;
      c = ROTL(b, 30) >>> 0;
      b = a;
      a = T;
    }
    H[0] = H[0] + a >>> 0;
    H[1] = H[1] + b >>> 0;
    H[2] = H[2] + c >>> 0;
    H[3] = H[3] + d >>> 0;
    H[4] = H[4] + e >>> 0;
  }
  return [H[0] >> 24 & 255, H[0] >> 16 & 255, H[0] >> 8 & 255, H[0] & 255, H[1] >> 24 & 255, H[1] >> 16 & 255, H[1] >> 8 & 255, H[1] & 255, H[2] >> 24 & 255, H[2] >> 16 & 255, H[2] >> 8 & 255, H[2] & 255, H[3] >> 24 & 255, H[3] >> 16 & 255, H[3] >> 8 & 255, H[3] & 255, H[4] >> 24 & 255, H[4] >> 16 & 255, H[4] >> 8 & 255, H[4] & 255];
}
var sha1_default = sha1;

// node_modules/uuid/dist/esm-browser/v5.js
var v5 = v35("v5", 80, sha1_default);
var v5_default = v5;

// src/utils.ts
var import_obsidian3 = require("obsidian");

// src/workspace.ts
var import_obsidian = require("obsidian");
function collectLeavesByTab(split, result = []) {
  const type = split.type;
  if (!type)
    throw new Error("Split type not found");
  if (type == "tabs" || type == "split") {
    const children = split.children;
    if (!children)
      throw new Error("Split children not found");
    if (children) {
      for (const child of children) {
        let emptyList = [];
        collectLeavesByTab(child, result);
      }
    }
  } else if (type == "leaf") {
    const parentSplitId = split.parent.id;
    if (!parentSplitId)
      throw new Error("Split parent id not found");
    let idx = result.findIndex((tab) => {
      const tabId = tab[0].parent.id;
      return tabId == parentSplitId;
    });
    if (idx == -1) {
      result.push([split]);
    } else {
      result[idx].push(split);
    }
  }
  return result;
}
function collectLeavesByTabHelper() {
  const { workspace } = getThat();
  const currLeaf = workspace.getLeaf();
  const rootSplit = currLeaf.getRoot();
  return collectLeavesByTab(rootSplit);
}
function getCurrentTabIndex(leavesByTab, span) {
  let workspaceTab = span.closest(".workspace-tabs");
  let currTabIdx = leavesByTab.findIndex((tab) => {
    const leafTab = tab[0].view.containerEl.closest(".workspace-tabs");
    return leafTab == workspaceTab;
  });
  return currTabIdx;
}
function getAdjacentTabs(leavesByTab, currTabIdx, file) {
  let rightAdjacentTab = [];
  let leftAdjacentTab = [];
  let adjacentTabs = [];
  if (leavesByTab[currTabIdx + 1]) {
    rightAdjacentTab = leavesByTab[currTabIdx + 1];
    adjacentTabs = [...adjacentTabs, ...rightAdjacentTab];
  }
  if (leavesByTab[currTabIdx - 1]) {
    leftAdjacentTab = leavesByTab[currTabIdx - 1];
    adjacentTabs = [...adjacentTabs, ...leftAdjacentTab];
  }
  let index = adjacentTabs.findIndex(
    (x) => x.getViewState().state.file == file
  );
  return { adjacentTabs, rightAdjacentTab, leftAdjacentTab, index };
}
async function openFileInAdjacentTab(leavesByTab, currTabIdx, file, type) {
  let { adjacentTabs, rightAdjacentTab, leftAdjacentTab } = getAdjacentTabs(
    leavesByTab,
    currTabIdx,
    file
  );
  let allTabNames = leavesByTab.map(
    (tab) => tab.map((x) => x.getViewState().state.file)
  );
  let rightAdjacentTabNames = rightAdjacentTab.map(
    (x) => x.getViewState().state.file
  );
  let leftAdjacentTabNames = leftAdjacentTab.map(
    (x) => x.getViewState().state.file
  );
  const { workspace } = getThat();
  if (allTabNames.filter((v, i) => i != currTabIdx).flat().includes(file) && !rightAdjacentTabNames.includes(file) && !leftAdjacentTabNames.includes(file)) {
    let currentTabNames = [];
    let currentTab = [];
    allTabNames.forEach((tabNames, i) => {
      if (tabNames != rightAdjacentTabNames && tabNames != leftAdjacentTabNames && currTabIdx != i) {
        if (tabNames.includes(file)) {
          currentTabNames = tabNames;
          currentTab = leavesByTab[i];
        }
      }
    });
    const originalLeaf = currentTab.filter(
      (t) => t.containerEl.style.display != "none"
    )[0];
    let leaf = currentTab[currentTabNames.indexOf(file)];
    workspace.revealLeaf(leaf);
    console.log("open file new tab");
    console.log(leaf);
    console.log(originalLeaf);
    return { newLeaf: leaf, temp: false, originalLeaf };
  } else if (rightAdjacentTabNames.includes(file)) {
    const originalLeaf = rightAdjacentTab.filter(
      (t) => t.containerEl.style.display != "none"
    )[0];
    let leaf = rightAdjacentTab[rightAdjacentTabNames.indexOf(file)];
    workspace.revealLeaf(leaf);
    console.log("open existing file right tab");
    console.log(leaf);
    console.log(originalLeaf);
    return { newLeaf: leaf, temp: false, originalLeaf };
  } else if (leftAdjacentTabNames.includes(file)) {
    const originalLeaf = leftAdjacentTab.filter(
      (t) => t.containerEl.style.display != "none"
    )[0];
    let leaf = leftAdjacentTab[leftAdjacentTabNames.indexOf(file)];
    workspace.revealLeaf(leaf);
    console.log("open existing file left tab");
    console.log(leaf);
    console.log(originalLeaf);
    return { newLeaf: leaf, temp: false, originalLeaf };
  } else if (rightAdjacentTab.length > 0) {
    const originalLeaf = rightAdjacentTab.filter(
      (t) => t.containerEl.style.display != "none"
    )[0];
    let currLeaf = workspace.getLeaf();
    workspace.setActiveLeaf(originalLeaf);
    let newLeaf = workspace.getLeaf(true);
    await openFileInLeaf(newLeaf, file);
    workspace.revealLeaf(newLeaf);
    workspace.setActiveLeaf(currLeaf);
    console.log("open new file right tab");
    console.log(newLeaf);
    console.log(originalLeaf);
    return { newLeaf, temp: true, originalLeaf };
  } else if (leftAdjacentTab.length > 0) {
    const originalLeaf = leftAdjacentTab.filter(
      (t) => t.containerEl.style.display != "none"
    )[0];
    let currLeaf = workspace.getLeaf();
    workspace.setActiveLeaf(originalLeaf);
    let newLeaf = workspace.getLeaf(true);
    await openFileInLeaf(newLeaf, file);
    workspace.revealLeaf(newLeaf);
    workspace.setActiveLeaf(currLeaf);
    console.log("open new file left tab");
    console.log(newLeaf);
    console.log(originalLeaf);
    return { newLeaf, temp: true, originalLeaf };
  } else {
    const currLeaf = workspace.getLeaf();
    let newLeaf = workspace.createLeafBySplit(currLeaf);
    await openFileInLeaf(newLeaf, file);
    console.log("open new file left tab");
    console.log(newLeaf);
    console.log(currLeaf);
    return { newLeaf, temp: true, originalLeaf: currLeaf };
  }
}
async function openFileInLeaf(leaf, file) {
  let targetFile = getThat().vault.getAbstractFileByPath(file);
  if (targetFile && targetFile instanceof import_obsidian.TFile)
    await leaf.openFile(targetFile, { active: false });
}

// src/effects.ts
var import_obsidian2 = require("obsidian");

// src/mark.ts
var import_view2 = require("@codemirror/view");
var import_state3 = require("@codemirror/state");
var addHighlight = import_state3.StateEffect.define({
  map: ({ from, to }, change) => ({
    from: change.mapPos(from),
    to: change.mapPos(to)
  })
});
var addDefaultHighlight = import_state3.StateEffect.define({
  map: ({ from, to }, change) => ({
    from: change.mapPos(from),
    to: change.mapPos(to)
  })
});
var resetHighlight = import_state3.StateEffect.define({
  map: ({ from, to }, change) => ({
    from: change.mapPos(from),
    to: change.mapPos(to)
  })
});
var highlightField = import_state3.StateField.define({
  create() {
    return import_view2.Decoration.none;
  },
  update(higlights, tr) {
    higlights = higlights.map(tr.changes);
    for (let e of tr.effects)
      if (e.is(addDefaultHighlight)) {
        higlights = higlights.update({
          add: [defaultHighlightMark.range(e.value.from, e.value.to)]
        });
      } else if (e.is(addHighlight)) {
        higlights = higlights.update({
          add: [highlightMark.range(e.value.from, e.value.to)]
        });
      } else if (e.is(resetHighlight)) {
        higlights = higlights.update({
          filter: (from, to) => {
            return !(from === e.value.from && to === e.value.to);
          }
        });
      }
    return higlights;
  },
  provide: (f2) => import_view2.EditorView.decorations.from(f2)
});
var highlightMark = import_view2.Decoration.mark({ class: "highlight" });
var defaultHighlightMark = import_view2.Decoration.mark({ class: "default-highlight" });
var theme = import_view2.EditorView.baseTheme({});
var highlightTheme = import_view2.EditorView.baseTheme({
  ".highlight": {
    "background-color": "hsl(calc(var(--accent-h) - 3), calc(var(--accent-s) * 1.02), calc(var(--accent-l) * 1.3))",
    color: "black"
  }
});
var defaultHighlightTheme = import_view2.EditorView.baseTheme({
  ".default-highlight": {
    "background-color": "hsl(calc(var(--accent-h) - 3), calc(var(--accent-s) * 1.02), calc(var(--accent-l) * 1.43))",
    color: "black"
  }
});
function highlightSelection(view, from, to) {
  let effects = [addHighlight.of({ from, to })];
  if (!effects.length)
    return false;
  if (!view.state.field(highlightField, false))
    effects.push(import_state3.StateEffect.appendConfig.of([highlightField, theme]));
  view.dispatch({ effects });
  return true;
}
function defaultHighlightSelection(view, from, to) {
  let effects = [addDefaultHighlight.of({ from, to })];
  if (!effects.length)
    return false;
  if (!view.state.field(highlightField, false))
    effects.push(import_state3.StateEffect.appendConfig.of([highlightField, theme]));
  view.dispatch({ effects });
  return true;
}
function removeHighlight(view, from, to) {
  let effects = [resetHighlight.of({ from, to })];
  if (!effects.length)
    return false;
  view.dispatch({ effects });
  return true;
}

// src/effects.ts
var import_view3 = require("@codemirror/view");
function getEditorView(leaf) {
  var _a;
  if (!leaf)
    return null;
  const view = leaf.view;
  const editor = (_a = view.sourceMode) == null ? void 0 : _a.cmEditor;
  if (!editor.CodeMirror && editor.cm instanceof import_view3.EditorView) {
    const editorView = editor.cm;
    return editorView;
  }
  return null;
}
function checkSpanElementExists(span, containerEl) {
  const spanElements = containerEl.getElementsByTagName("span");
  for (let i = 0; i < spanElements.length; i++) {
    if (spanElements[i] === span) {
      return true;
    }
  }
  return false;
}
function parseCSSString(css) {
  const cssPropertiesRegex = /([\w-]+)\s*:\s*([^;]+)\s*;?/g;
  let cssPropertiesObject = {};
  let match;
  while ((match = cssPropertiesRegex.exec(css)) !== null) {
    cssPropertiesObject[match[1]] = match[2];
  }
  return cssPropertiesObject;
}
function delay(milliseconds) {
  return new Promise((resolve) => {
    setTimeout(resolve, milliseconds);
  });
}
function tempDirectionIndicator(leaf, text, prefix, suffix, dataString, isSame, user) {
  if (user === ACTION_TYPE.BACKLINK) {
    const editor2 = getMarkdownView(leaf).editor;
    const backlinkContainer2 = getBacklinkContainer(editor2);
    const windowHeight2 = leaf.view.containerEl.querySelector(".cm-scroller").getBoundingClientRect().height;
    const scrollTop2 = leaf.view.containerEl.querySelector(".cm-scroller").scrollTop;
    const scrollBottom2 = scrollTop2 + windowHeight2;
    let container = editor2.containerEl;
    let content = container.querySelector(".cm-content");
    let references = content.querySelectorAll(".reference-data-span");
    let visibleElements2 = [];
    for (let i = 0; i < references.length; i++) {
      let bbox = references[i].getBoundingClientRect();
      if (bbox.top >= scrollTop2 && bbox.bottom <= scrollBottom2) {
        visibleElements2.push(references[i]);
      }
    }
    let dataStrings = visibleElements2.map(
      (el) => el.getAttribute("data")
    );
    let startTop2 = leaf.view.editor.getScrollInfo().top;
    if (!dataStrings.includes(dataString)) {
      let positions2 = findTextPositions(
        leaf.view.data,
        text,
        prefix.slice(0, prefix.length - 1),
        suffix.slice(1, suffix.length)
      );
      if (!positions2)
        throw new Error("Positions not found");
      let rangeStart2 = positions2.rangeStart;
      let rangeEnd2 = positions2.rangeEnd;
      leaf.view.editor.scrollIntoView(
        {
          from: Object.assign(rangeStart2, { ch: 0 }),
          to: Object.assign(rangeEnd2, { ch: 0 })
        },
        true
      );
    }
    setTimeout(() => {
      let endTop = leaf.view.editor.getScrollInfo().top;
      console.log(endTop);
      let container2 = leaf.containerEl.querySelector(".view-content");
      container2.classList.remove("no-shadow");
      container2.classList.remove("new-shadow");
      container2.classList.remove("top-shadow");
      container2.classList.remove("bottom-shadow");
      if (startTop2 === endTop && isSame) {
        container2.classList.add("no-shadow");
      } else if (startTop2 === endTop && !isSame) {
        container2.classList.add("new-shadow");
      } else if (startTop2 < endTop) {
        container2.classList.add("top-shadow");
      } else {
        container2.classList.add("bottom-shadow");
      }
    }, 25);
    return;
  }
  const editor = getMarkdownView(leaf).editor;
  const backlinkContainer = getBacklinkContainer(editor);
  const windowHeight = leaf.view.containerEl.querySelector(".cm-scroller").getBoundingClientRect().height;
  const scrollTop = leaf.view.containerEl.querySelector(".cm-scroller").scrollTop;
  const scrollBottom = scrollTop + windowHeight;
  let visibleElements = [];
  for (let i = 0; i < backlinkContainer.children.length; i++) {
    let style = backlinkContainer.children[i].getAttribute("style");
    if (style == null)
      continue;
    let cssProperties = parseCSSString(style);
    let top = parseFloat(cssProperties["top"].replace("px", ""));
    if (top == null)
      continue;
    if (scrollTop <= top && top <= scrollBottom && backlinkContainer.children[i]) {
      let reference = backlinkContainer.children[i].getAttribute("reference");
      if (reference) {
        visibleElements.push(JSON.parse(reference).dataString);
      }
    }
  }
  console.log(!visibleElements.includes(dataString));
  let startTop = leaf.view.editor.getScrollInfo().top;
  let positions = findTextPositions(
    leaf.view.data,
    text,
    prefix.slice(0, prefix.length - 1),
    suffix.slice(1, suffix.length)
  );
  if (!positions)
    throw new Error("Positions not found");
  let rangeStart = positions.rangeStart;
  let rangeEnd = positions.rangeEnd;
  leaf.view.editor.scrollIntoView(
    {
      from: Object.assign(rangeStart, { ch: 0 }),
      to: Object.assign(rangeEnd, { ch: 0 })
    },
    true
  );
  console.log(startTop);
  setTimeout(() => {
    let endTop = leaf.view.editor.getScrollInfo().top;
    console.log(endTop);
    let container = leaf.containerEl.querySelector(".view-content");
    container.classList.remove("no-shadow");
    container.classList.remove("new-shadow");
    container.classList.remove("top-shadow");
    container.classList.remove("bottom-shadow");
    if (startTop === endTop && isSame) {
      container.classList.add("no-shadow");
    } else if (startTop === endTop && !isSame) {
      container.classList.add("new-shadow");
    } else if (startTop < endTop) {
      container.classList.add("top-shadow");
    } else {
      container.classList.add("bottom-shadow");
    }
  }, 25);
}
function endEffectRemoveHighlights(workspace, leafId, uuid, backlinkUUID) {
  var _a, _b, _c, _d, _e;
  const workspaceContainer = workspace.containerEl;
  const span = workspaceContainer.querySelector("." + uuid);
  (_b = (_a = span == null ? void 0 : span.parentElement) == null ? void 0 : _a.querySelector(".reference-span")) == null ? void 0 : _b.classList.remove("reference-span-selected");
  span == null ? void 0 : span.classList.remove("reference-data-span-selected");
  if (backlinkUUID) {
    const backlinkSpan = workspaceContainer.querySelector("." + backlinkUUID);
    (_d = (_c = backlinkSpan == null ? void 0 : backlinkSpan.parentElement) == null ? void 0 : _c.querySelector(".reference-span")) == null ? void 0 : _d.classList.remove("reference-span-selected");
    backlinkSpan == null ? void 0 : backlinkSpan.classList.remove("reference-data-span-selected");
  }
  let targetLeaf = workspace.getLeafById(leafId);
  if (!targetLeaf) {
    resetCursor();
    throw new Error("Target leaf not found");
  }
  let container = (_e = getContainerElement(targetLeaf)) == null ? void 0 : _e.querySelector(".view-content");
  if (container) {
    container.classList.remove("no-shadow");
    container.classList.remove("new-shadow");
    container.classList.remove("top-shadow");
    container.classList.remove("bottom-shadow");
  }
}
async function startBacklinkEffect(span) {
  var _a, _b, _c, _d;
  let source = getBacklinkHover();
  let destination = getCursor();
  let updateState = updateBacklinkHover;
  if (source != null)
    return;
  updateState({
    type: `${ACTION_TYPE.BACKLINK}-start`
  });
  if (!span)
    return;
  let uuid = Array.from(span.classList).filter((el) => el.includes("uuid"))[0];
  (_b = (_a = span.parentElement) == null ? void 0 : _a.querySelector(".reference-span")) == null ? void 0 : _b.classList.add("reference-span-selected");
  span.classList.add("reference-data-span-selected");
  updateState({
    uuid
  });
  const referenceData = span.getAttribute("reference");
  if (!referenceData)
    throw new Error("Reference data not found");
  const backlink = JSON.parse(referenceData);
  const dataString = backlink.dataString;
  if (destination != null && destination.dataString == dataString) {
    updateState(destination);
    return;
  }
  let [prefix, text, suffix, file, from, to] = processURI(dataString);
  let leavesByTab = collectLeavesByTabHelper();
  let currTabIdx = getCurrentTabIndex(leavesByTab, span);
  let backlinkLeaf = leavesByTab[currTabIdx].filter((leaf) => {
    let containerEl = getContainerElement(leaf);
    const exists = checkSpanElementExists(span, containerEl);
    return exists;
  })[0];
  let backlinkLeafID = backlinkLeaf.id;
  if (!backlinkLeafID)
    throw new Error("Leaf id not found");
  if (backlinkLeaf && backlinkLeaf.view instanceof import_obsidian2.MarkdownView) {
    const editorView = getEditorView(backlinkLeaf);
    if (!editorView)
      throw new Error("Editor view not found");
    const viewport = backlinkLeaf.view.editor.getScrollInfo();
    removeHighlight(editorView, from, to);
    highlightSelection(editorView, from, to);
    updateState({
      dataString,
      originalTop: editorView.documentTop,
      backlinkLeafId: backlinkLeafID
    });
  }
  let referencingFile = backlink.referencingLocation.filename;
  const { newLeaf, temp, originalLeaf } = await openFileInAdjacentTab(
    leavesByTab,
    currTabIdx,
    referencingFile
  );
  let id = newLeaf.id;
  if (!id)
    throw new Error("Leaf id not found");
  updateState({
    leafId: id,
    temp,
    peek: true
  });
  const originalLeafId = originalLeaf.id;
  const matches = [
    ...backlink.referencingLocation.text.matchAll(REFERENCE_REGEX)
  ];
  if (matches.length == 0)
    throw new Error("Matches not found");
  tempDirectionIndicator(
    newLeaf,
    backlink.referencingLocation.text,
    backlink.referencingLocation.prefix + "-",
    "-" + backlink.referencingLocation.suffix,
    matches[0][1],
    id === originalLeafId,
    ACTION_TYPE.BACKLINK
  );
  const cursorViewport = newLeaf.view.editor.getScrollInfo();
  updateState({
    cursorViewport
  });
  let backlinkSpan = newLeaf.containerEl.querySelector(
    `span[data="${backlink.dataString}"]`
  );
  if (backlinkSpan) {
    let backlinkUUID = Array.from(backlinkSpan.classList).filter(
      (el) => el.includes("uuid")
    )[0];
    (_d = (_c = backlinkSpan.parentElement) == null ? void 0 : _c.querySelector(".reference-span")) == null ? void 0 : _d.classList.add("reference-span-selected");
    backlinkSpan.classList.add("reference-data-span-selected");
    updateState({
      backlinkUUID
    });
  }
  if (originalLeafId) {
    updateState({
      originalLeafId
    });
  }
  return;
}
async function startReferenceEffect(span, type) {
  var _a, _b;
  let source = type == ACTION_TYPE.MOUSE ? getHover() : getCursor();
  let destination = type == ACTION_TYPE.MOUSE ? getCursor() : getHover();
  let updateState = type == ACTION_TYPE.MOUSE ? updateHover : updateCursor;
  if (source != null) {
    if (ACTION_TYPE.CURSOR == type) {
      await endReferenceCursorEffect();
    } else {
      return;
    }
  }
  updateState({
    type: `${type}-start`
  });
  if (!span)
    return;
  let uuid = Array.from(span.classList).filter((el) => el.includes("uuid"))[0];
  (_b = (_a = span.parentElement) == null ? void 0 : _a.querySelector(".reference-span")) == null ? void 0 : _b.classList.add("reference-span-selected");
  span.classList.add("reference-data-span-selected");
  updateState({
    uuid
  });
  const dataString = span.getAttribute("data");
  if (!dataString)
    throw new Error("Data string not found");
  if (destination != null && destination.dataString == dataString && ACTION_TYPE.CURSOR != type) {
    updateHover(destination);
    return;
  }
  let [prefix, text, suffix, file, from, to] = processURI(dataString);
  let leavesByTab = collectLeavesByTabHelper();
  let currTabIdx = getCurrentTabIndex(leavesByTab, span);
  let currLeaf = getThat().workspace.getLeaf();
  let currLeafID = currLeaf.id;
  if (!currLeafID)
    throw new Error("currLeafID id not found");
  const { newLeaf, temp, originalLeaf } = await openFileInAdjacentTab(
    leavesByTab,
    currTabIdx,
    file,
    type
  );
  let id = newLeaf.id;
  if (!id)
    throw new Error("Leaf id not found");
  updateState({
    leafId: id,
    temp,
    peek: true
  });
  const originalLeafId = originalLeaf.id;
  console.log(newLeaf && newLeaf.view instanceof import_obsidian2.MarkdownView);
  if (newLeaf && newLeaf.view instanceof import_obsidian2.MarkdownView) {
    const editorView = getEditorView(newLeaf);
    if (!editorView)
      throw new Error("Editor view not found");
    const viewport = newLeaf.view.editor.getScrollInfo();
    removeHighlight(editorView, from, to);
    highlightSelection(editorView, from, to);
    console.log("leaves are equal" + id === originalLeafId);
    tempDirectionIndicator(
      newLeaf,
      text,
      prefix,
      suffix,
      dataString,
      id === originalLeafId
    );
    const cursorViewport = newLeaf.view.editor.getScrollInfo();
    updateState({
      dataString,
      originalTop: editorView.documentTop,
      // originalLeafId: currLeafID,
      cursorViewport
    });
  }
  if (originalLeafId) {
    updateState({
      originalLeafId
    });
  }
}
async function endReferenceCursorEffect() {
  var _a, _b;
  if (!getCursor() || Object.keys(getCursor()).length == 0) {
    resetCursor();
    return;
  }
  const {
    dataString,
    leafId,
    originalLeafId,
    temp,
    cursorViewport,
    peek,
    uuid
  } = getCursor();
  resetCursor();
  if (getHover() != null && getHover().dataString == dataString) {
    resetCursor();
    return;
  }
  const { workspace } = getThat();
  let targetLeaf = workspace.getLeafById(leafId);
  endEffectRemoveHighlights(workspace, leafId, uuid);
  const activeLeaf = getThat().workspace.getLeaf();
  const activeLeafId = activeLeaf.id;
  let editorView = getEditorView(targetLeaf);
  let [prefix, text, suffix, file, from, to] = processURI(dataString);
  removeHighlight(editorView, from, to);
  defaultHighlightSelection(editorView, from, to);
  if (activeLeafId === leafId) {
    resetCursor();
    let containerEl = getContainerElement(targetLeaf);
    if (containerEl != null) {
      (_a = containerEl.querySelector(".view-content")) == null ? void 0 : _a.setAttribute("style", "");
    }
    return;
  }
  if (cursorViewport && targetLeaf && targetLeaf.view instanceof import_obsidian2.MarkdownView) {
    const view = targetLeaf.view;
    view.editor.scrollTo(0, cursorViewport.top);
    if (getHover() != null) {
      const { dataString: dataString2, cursorViewport: cursorViewport2, leafId: leafId2, originalLeafId: originalLeafId2 } = getHover();
      let [prefix2, text2, suffix2, file2, from2, to2] = processURI(dataString2);
      const cursorLeaf = workspace.getLeafById(leafId2);
      workspace.revealLeaf(cursorLeaf);
      const editorView2 = getEditorView(cursorLeaf);
      highlightSelection(editorView2, from2, to2);
    } else {
      let containerEl = getContainerElement(targetLeaf);
      if (containerEl != null) {
        (_b = containerEl.querySelector(".view-content")) == null ? void 0 : _b.setAttribute("style", "");
      }
    }
  }
  if (temp && targetLeaf) {
    targetLeaf.detach();
  }
  if (peek) {
    let originalLeaf = workspace.getLeafById(originalLeafId);
    if (!originalLeaf)
      throw new Error("Original leaf not found");
    workspace.revealLeaf(originalLeaf);
  }
  resetCursor();
}
async function endReferenceHoverEffect() {
  if (!getHover() || Object.keys(getHover()).length == 0) {
    resetHover();
    return;
  }
  let { dataString, leafId, originalLeafId, temp, cursorViewport, peek, uuid } = getHover();
  resetHover();
  if (getCursor() != null && getCursor().dataString == dataString) {
    resetHover();
    return;
  }
  const { workspace } = getThat();
  let targetLeaf = workspace.getLeafById(leafId);
  endEffectRemoveHighlights(workspace, leafId, uuid);
  let editorView = getEditorView(targetLeaf);
  let [prefix, text, suffix, file, from, to] = processURI(dataString);
  removeHighlight(editorView, from, to);
  defaultHighlightSelection(editorView, from, to);
  if (cursorViewport && targetLeaf && targetLeaf.view instanceof import_obsidian2.MarkdownView) {
    const view = targetLeaf.view;
    view.editor.scrollTo(0, cursorViewport.top);
    if (getCursor() != null && getCursor().dataString) {
      const { dataString: dataString2, cursorViewport: cursorViewport2, leafId: leafId2, originalLeafId: originalLeafId2 } = getCursor();
      let [prefix2, text2, suffix2, file2, from2, to2, portal, toggle] = processURI(dataString2);
      const cursorLeaf = workspace.getLeafById(leafId2);
      workspace.revealLeaf(cursorLeaf);
      const editorView2 = getEditorView(cursorLeaf);
      if (!editorView2)
        throw new Error("Editor view not found");
      highlightSelection(editorView2, from2, to2);
    } else {
      let containerEl = getContainerElement(targetLeaf);
      if (containerEl != null) {
        setTimeout(() => {
          var _a;
          (_a = containerEl.querySelector(".view-content")) == null ? void 0 : _a.setAttribute("style", "");
        }, 50);
      }
    }
  }
  if (temp && targetLeaf) {
    targetLeaf.detach();
    let originalLeaf = workspace.getLeafById(originalLeafId);
    if (!originalLeaf)
      throw new Error("Original leaf not found");
    workspace.revealLeaf(originalLeaf);
  }
  if (peek) {
    let originalLeaf = workspace.getLeafById(originalLeafId);
    if (!originalLeaf) {
      resetHover();
      throw new Error("Original leaf not found");
    }
    workspace.revealLeaf(originalLeaf);
  }
  resetHover();
}
async function endBacklinkHoverEffect() {
  if (!getBacklinkHover() || Object.keys(getBacklinkHover()).length == 0) {
    resetBacklinkHover();
    return;
  }
  const {
    dataString,
    leafId,
    originalLeafId,
    backlinkLeafId,
    temp,
    cursorViewport,
    peek,
    uuid,
    backlinkUUID
  } = getBacklinkHover();
  resetBacklinkHover();
  if (getCursor() != null && getCursor().dataString == dataString) {
    resetBacklinkHover();
    return;
  }
  const { workspace } = getThat();
  let targetLeaf = workspace.getLeafById(leafId);
  endEffectRemoveHighlights(workspace, leafId, uuid, backlinkUUID);
  if (cursorViewport && targetLeaf && targetLeaf.view instanceof import_obsidian2.MarkdownView) {
    const view = targetLeaf.view;
    view.editor.scrollTo(0, cursorViewport.top);
  }
  let containerEl = getContainerElement(targetLeaf);
  if (containerEl != null) {
    setTimeout(() => {
      var _a;
      (_a = containerEl.querySelector(".view-content")) == null ? void 0 : _a.setAttribute("style", "");
    }, 50);
  }
  let editorView = getEditorView(targetLeaf);
  let [prefix, text, suffix, file, from, to] = processURI(dataString);
  const originalLeaf = workspace.getLeafById(backlinkLeafId);
  if (!originalLeaf) {
    resetBacklinkHover();
    throw new Error("Original leaf not found");
  }
  let originalEditorView = getEditorView(originalLeaf);
  removeHighlight(originalEditorView, from, to);
  defaultHighlightSelection(originalEditorView, from, to);
  if (getCursor() != null && getCursor().dataString) {
    const { dataString: dataString2, cursorViewport: cursorViewport2, leafId: leafId2, originalLeafId: originalLeafId2 } = getCursor();
    let [prefix2, text2, suffix2, file2, from2, to2] = processURI(dataString2);
    const cursorLeaf = workspace.getLeafById(leafId2);
    workspace.revealLeaf(cursorLeaf);
    const editorView2 = getEditorView(cursorLeaf);
    highlightSelection(editorView2, from2, to2);
  }
  if (temp && targetLeaf) {
    targetLeaf.detach();
  }
  if (peek) {
    let originalLeaf2 = workspace.getLeafById(originalLeafId);
    if (!originalLeaf2) {
      resetBacklinkHover();
      throw new Error("Original leaf not found");
    }
    workspace.revealLeaf(originalLeaf2);
  }
  resetBacklinkHover();
}

// src/utils.ts
function encodeURIComponentString(str) {
  return encodeURIComponent(str).replace(/[:()]/g, function(c) {
    return "%" + c.charCodeAt(0).toString(16);
  });
}
function decodeURIComponentString(str) {
  return decodeURIComponent(
    str.replace(/%3A/g, ":").replace(/%28/g, "(").replace(/%29/g, ")")
  );
}
function processURI(dataString) {
  let [prefix, text, suffix, file, from, to, portal, toggle] = dataString.split(":");
  prefix = decodeURIComponentString(prefix);
  text = decodeURIComponentString(text);
  suffix = decodeURIComponentString(suffix);
  file = decodeURIComponentString(file);
  from = decodeURIComponentString(from);
  to = decodeURIComponentString(to);
  if (portal)
    portal = decodeURIComponentString(portal);
  toggle = decodeURIComponentString(toggle);
  return [
    prefix,
    text,
    suffix,
    file,
    parseInt(from),
    parseInt(to),
    portal,
    toggle
  ];
}
function getPrefixAndSuffix(document2, from, to) {
  let prefix = document2.slice(from - 25, from).split("\n").slice(-1)[0];
  let suffix = document2.slice(to, to + 25).split("\n")[0];
  return { prefix, suffix };
}
function findTextPositions(text, searchTerm, prefix = "", suffix = "") {
  let rollingIndex = 0;
  const lines = text.split("\n").map((line, i) => {
    let data = { line, index: rollingIndex, length: line.length + 1, i };
    rollingIndex += data.length;
    return data;
  });
  if (text.includes(prefix + searchTerm + suffix)) {
    let matchIndex = text.indexOf(prefix + searchTerm + suffix);
    let startIndex = lines.findIndex((line) => line.index > matchIndex + prefix.length) - 1;
    let endIndex = lines.findIndex(
      (line) => line.index > matchIndex + prefix.length + searchTerm.length
    ) - 1;
    if (startIndex == -2)
      startIndex = lines.length - 1;
    if (endIndex == -2)
      endIndex = lines.length - 1;
    return {
      rangeStart: {
        line: startIndex,
        ch: matchIndex + prefix.length - lines[startIndex].index
      },
      rangeEnd: {
        line: endIndex,
        ch: matchIndex + prefix.length + searchTerm.length - lines[endIndex].index
      },
      lines
    };
  }
  return null;
}
function checkCursorPositionAtDatastring(evt) {
  const activeView = this.app.workspace.getActiveViewOfType(import_obsidian3.MarkdownView);
  const cursorFrom = activeView == null ? void 0 : activeView.editor.getCursor("from");
  const cursorTo = activeView == null ? void 0 : activeView.editor.getCursor("to");
  let matched = false;
  let matchSpan = void 0;
  if (cursorFrom && cursorTo && cursorFrom.ch == cursorTo.ch && cursorFrom.line == cursorTo.line) {
    const lineText = activeView == null ? void 0 : activeView.editor.getLine(cursorFrom.line);
    if (lineText) {
      const matches = [...lineText.matchAll(REFERENCE_REGEX)];
      matches.forEach((match) => {
        var _a;
        if ((_a = match.index) == null ? void 0 : _a.toString()) {
          const start = match.index;
          const end = start + match[0].length;
          if (end == cursorTo.ch && evt.target) {
            const dataString = match[1];
            let checkContainer = evt.target instanceof Element;
            if (!checkContainer)
              throw new Error("Element not instance of Element");
            let container = evt.target;
            let span = container;
            if (!span.getAttribute("data"))
              span = container.querySelector(
                `span[data="${dataString}"]`
              );
            if (span && span instanceof HTMLSpanElement) {
              matched = true;
              matchSpan = span;
            } else {
            }
          }
        }
      });
    }
  }
  return { matched, span: matchSpan };
}
function handleRemoveHoveredCursor(user) {
  if (getHoveredCursor()) {
    let nonCursors = getHoveredCursor().filter((element) => {
      return element.user !== user;
    }).map((element) => element.cursor.closest("span"));
    getHoveredCursor().filter((element) => element.user === user).forEach((element) => {
      if (!nonCursors.includes(element.cursor.closest("span"))) {
        let svg = element.cursor;
        if (!svg)
          throw new Error("SVG not found");
        if (svg.classList.contains("reference-icon"))
          svg.style.backgroundColor = "white";
        else {
          svg.setAttribute("fill", "white");
          svg.style.backgroundColor = "";
        }
        element.cursor.style.backgroundColor = "white";
      }
    });
    removeHoveredCursor(user);
  }
}
async function checkFocusCursor(evt) {
  let { matched, span } = checkCursorPositionAtDatastring(evt);
  if (matched && span) {
    await endReferenceCursorEffect();
    handleRemoveHoveredCursor(ACTION_TYPE.CURSOR);
    updateHoveredCursorColor(span, ACTION_TYPE.CURSOR);
    await startReferenceEffect(span, ACTION_TYPE.CURSOR);
  } else {
    await endReferenceCursorEffect();
    handleRemoveHoveredCursor(ACTION_TYPE.CURSOR);
  }
}

// src/references.ts
function createReferenceIcon(portalText = null) {
  const span = document.createElement("span");
  span.style.cursor = "pointer";
  span.classList.add("reference-data-span");
  span.classList.add("uuid-" + v4_default());
  const height = REFERENCE_ICON_HEIGHT;
  const width = height * 0.9;
  if (portalText == null) {
    const svg2 = document.createElementNS("http://www.w3.org/2000/svg", "svg");
    return { span, svg: svg2 };
  }
  const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
  if (portalText != "inline reference widget |*|") {
    let portal = document.createElement("div");
    portal.classList.add("portal");
    portalText.split(":").forEach((text, index) => {
      if (index === 0 || index === 2)
        portal.innerHTML += decodeURIComponentString(text);
      else if (index === 1) {
        portal.innerHTML += `<span class="text-accent";>${text}</span>`;
      }
    });
    portal.style.userSelect = "none";
    portal.style.pointerEvents = "none";
    span.appendChild(portal);
  }
  return { span, svg };
}
function updateHoveredCursorColor(span, user) {
  const svg = span.querySelector("svg");
  const portal = span.querySelector(".portal");
  if (span && svg && !portal) {
    handleRemoveHoveredCursor(user);
    if (svg.classList.contains("reference-icon"))
      svg.style.backgroundColor = SVG_HOVER_COLOR;
    else {
      span = span.querySelector("span");
      span.style.backgroundColor = SVG_HOVER_COLOR;
    }
    updateHoveredCursor(svg, user);
  }
}
function getCodeMirrorEditorView(editor) {
  return editor.cm;
}
function getContainerElement(editorOrLeaf) {
  return editorOrLeaf.containerEl;
}
function getBacklinkID(backlink) {
  const jsonString = JSON.stringify(backlink);
  const id = v5_default(jsonString, "fb813ebb-1b53-4306-aa9c-655627447f0b");
  return `backlink-${id}`;
}
function getBacklinkContainer(editor) {
  const containerEl = getContainerElement(editor);
  const referenceMarkContainerID = "referenceMarkContainer";
  const container = containerEl.querySelector(`#${referenceMarkContainerID}`);
  if (container) {
    return container;
  } else {
    const newContainer = document.createElement("div");
    newContainer.id = referenceMarkContainerID;
    containerEl.querySelector(".cm-scroller").appendChild(newContainer);
    return newContainer;
  }
}
function getLeafBBoxElements(leaf) {
  const title = getContainerElement(leaf).querySelector(".inline-title");
  if (!title) {
    throw new Error("Missing title");
  }
  const titleBbox = title.getBoundingClientRect();
  const line = getContainerElement(leaf).querySelector(".cm-line");
  if (!line) {
    throw new Error("Document has no lines");
  }
  const lineBbox = line.getBoundingClientRect();
  return { titleBbox, lineBbox };
}
function updateBacklinkMarkPosition(leaf, backlinksToLeaf, showPortals) {
  const editor = getMarkdownView(leaf).editor;
  const backlinkContainer = getBacklinkContainer(editor);
  let backlinks2 = [];
  for (let i = 0; i < backlinkContainer.children.length; i++) {
    backlinks2.push(backlinkContainer.children.item(i));
  }
  let backlinkIds = backlinksToLeaf.map((x) => getBacklinkID(x));
  backlinks2.map((x) => x.id).forEach((id) => {
    if (!backlinkIds.includes(id)) {
      let element = document.getElementById(id);
      if (element)
        element.remove();
    }
  });
  const { titleBbox, lineBbox } = getLeafBBoxElements(leaf);
  let referenceMarkers = backlinksToLeaf.map((backlink) => {
    const { from } = backlink.referencedLocation;
    const bbox = getCodeMirrorEditorView(editor).coordsAtPos(from);
    if (!bbox)
      return;
    let referenceMarker = backlinkContainer.querySelector(
      `#${getBacklinkID(backlink)}`
    );
    if (referenceMarker === null) {
      referenceMarker = createBacklinkMark(backlink);
      backlinkContainer.appendChild(referenceMarker);
    }
    if (bbox) {
      referenceMarker.style.position = "absolute";
      referenceMarker.setAttribute("top", bbox.top.toString());
      referenceMarker.style.top = bbox.top - titleBbox.top + 32 + "px";
      referenceMarker.style.left = lineBbox.width + 40 + "px";
    }
    return referenceMarker;
  });
  let lastYBottom = -Infinity;
  let margin = 4;
  referenceMarkers.sort(
    (a, b) => parseInt(a.getAttribute("top")) - parseInt(b.getAttribute("top"))
  ).forEach((marker) => {
    if (!marker)
      return;
    const portal = marker.querySelector(".portal");
    if (showPortals) {
      if (portal) {
        portal.style.display = "inline";
        marker.classList.add("backlink-span");
      }
    } else {
      if (portal) {
        portal.style.display = "none";
      }
      marker.classList.remove("backlink-span");
    }
    let top = parseInt(marker.getAttribute("top"));
    top = Math.max(top, lastYBottom + margin);
    lastYBottom = top + marker.getBoundingClientRect().height + margin;
    marker.setAttribute("top", top.toString());
    marker.style.top = top - titleBbox.top + 32 + "px";
    marker.style.left = lineBbox.width + 40 + "px";
  });
}
var debounceTimer;
async function updateBacklinkMarkPositions() {
  clearTimeout(debounceTimer);
  debounceTimer = setTimeout(async () => {
    const leaves = getThat().workspace.getLeavesOfType(
      "markdown"
    );
    setTimeout(async () => {
      const allBacklinks = await recomputeReferencesForPage();
      leaves.map(async (leaf) => {
        const backlinksToLeaf = allBacklinks.filter(
          // @ts-ignore
          (b) => b.referencedLocation.filename == leaf.view.file.path
        );
        const showPortals = getContainerElement(leaf).innerWidth > 900;
        updateBacklinkMarkPosition(leaf, backlinksToLeaf, showPortals);
      });
      await Promise.all(
        leaves.map(async (leaf) => {
          const backlinksToLeaf = allBacklinks.filter(
            // @ts-ignore
            (b) => b.referencedLocation.filename == leaf.view.file.path
          );
          const showPortals = getContainerElement(leaf).innerWidth > 900;
          updateBacklinkMarkPosition(leaf, backlinksToLeaf, showPortals);
        })
      );
    }, 500);
  }, 100);
}
function createBacklinkMark(backlink) {
  let { span, svg } = createReferenceIcon(backlink.portalText);
  span.classList.add("backlink-data-span");
  const portal = span.querySelector(".portal");
  span.style.position = "absolute";
  span.id = getBacklinkID(backlink);
  span.setAttribute("reference", JSON.stringify(backlink));
  const resizeObserver = new ResizeObserver((entries) => {
    if (portal && portal.style.display != "none") {
      span.classList.add("backlink-portal-open");
    } else {
      span.classList.remove("backlink-portal-open");
    }
  });
  resizeObserver.observe(span);
  span.addEventListener("click", openBacklinkReference);
  return span;
}
async function addReferencesToLeaf(leaf) {
  const markdownView = getMarkdownView(leaf);
  let workspaceTabs = markdownView.containerEl.closest(".workspace-tabs");
  if (!workspaceTabs) {
    throw new Error("Missing workspace tabs");
  }
  await updateBacklinkMarkPositions();
  await delay(2e3);
  generateDefaultHighlights(leaf);
  getContainerElement(markdownView.editor).querySelector(".cm-scroller").addEventListener("scroll", async (ev) => {
    await updateBacklinkMarkPositions();
    await delay(2e3);
    generateDefaultHighlights(leaf);
    console.log("scroll");
  });
  let resizeObserver = new ResizeObserver(async () => {
    await updateBacklinkMarkPositions();
    await delay(2e3);
    generateDefaultHighlights(leaf);
  });
  resizeObserver.observe(workspaceTabs);
  return leaf;
}
function getMarkdownView(leaf) {
  if (!(leaf.view instanceof import_obsidian4.MarkdownView)) {
    throw new Error("Unexpected non-markdown view");
  }
  return leaf.view;
}
function findMatchPositions(line, regex) {
  let match;
  const positions = [];
  while ((match = regex.exec(line)) !== null) {
    positions.push({
      match: match[0],
      start: match.index,
      end: match.index + match[0].length
    });
  }
  return positions;
}
function createBacklinkData(referencingFileData, referencingFile) {
  let backlinks2 = [];
  let matches = [...referencingFileData.matchAll(REFERENCE_REGEX)];
  matches.forEach((match) => {
    if (match[1].split(":").length != 8)
      return;
    let [prefix, text, suffix, filename, from, to, portal, toggle] = processURI(
      match[1]
    );
    const referencedLocation = {
      prefix,
      text,
      suffix,
      filename,
      from,
      to,
      portal,
      toggle
    };
    let index = referencingFileData.indexOf(match[0]);
    const referencingSurroundingStrings = getPrefixAndSuffix(
      referencingFileData,
      index,
      index + match[0].length
    );
    const referencingLocation = {
      // prefix: referencingFileData.slice(index - 25, index),
      prefix: referencingSurroundingStrings.prefix,
      text: referencingFileData.slice(index, index + match[0].length),
      // suffix: referencingFileData.slice(
      // 	index + match[0].length,
      // 	index + match[0].length + 25
      // ),
      suffix: referencingSurroundingStrings.suffix,
      filename: referencingFile.path,
      from: match.index,
      // TODO do weird string format
      to: match.index + match[0].length,
      // TODO do weird string format
      portal,
      toggle
    };
    if (portal == "portal") {
      const getLineText = (text2, index2) => {
        const startOfLine = text2.lastIndexOf("\n", index2 - 1) + 1;
        const endOfLine = text2.indexOf("\n", index2);
        return text2.slice(
          startOfLine,
          endOfLine !== -1 ? endOfLine : void 0
        );
      };
      let line = getLineText(referencingFileData, index);
      let matchPositions = findMatchPositions(
        line,
        new RegExp(REFERENCE_REGEX)
      );
      let matchIndex = 0;
      for (let i = 0; i < matchPositions.length; i++) {
        if (matchPositions[i].match == match[0]) {
          break;
        } else {
          matchIndex += matchPositions[i].end - matchPositions[i].start - 1;
        }
      }
      let portalText = line.replace(new RegExp(REFERENCE_REGEX, "g"), "\u2197");
      let portalTextSlice = portalText.slice(0, PORTAL_TEXT_SLICE_SIZE);
      let portalTextIndex = line.indexOf(match[0]) - matchIndex;
      portalTextSlice = "\u2197";
      let startPortalText = portalText.substring(
        Math.max(portalTextIndex - 25, 0),
        portalTextIndex
      );
      if (portalText.substring(Math.max(portalTextIndex - 25, 0), portalTextIndex).length > 0 && portalTextIndex - 25 > 0)
        startPortalText = "..." + startPortalText;
      let endPortalText = portalText.substring(
        portalTextIndex + 1,
        Math.max(portalTextIndex + 25, portalText.length)
      );
      if (portalText.substring(
        portalTextIndex + 1,
        Math.max(portalTextIndex + 25, portalText.length)
      ).length > 0 && portalTextIndex + 25 < portalText.length)
        endPortalText = endPortalText + "...";
      backlinks2.push({
        referencedLocation,
        referencingLocation,
        dataString: match[1],
        portalText: encodeURIComponentString(startPortalText) + ":" + portalTextSlice + ":" + encodeURIComponentString(endPortalText)
      });
    } else {
      backlinks2.push({
        referencedLocation,
        referencingLocation,
        dataString: match[1]
      });
    }
  });
  return backlinks2;
}
async function generateBacklinks() {
  console.log("generating references");
  let backlinks2 = [];
  let markdownFiles = this.app.vault.getMarkdownFiles();
  await Promise.all(
    markdownFiles.map((file) => this.app.vault.read(file))
  ).then((files) => {
    const zippedArray = markdownFiles.map((file, index) => ({
      markdownFile: file,
      fileData: files[index]
    }));
    zippedArray.forEach((file) => {
      let fileBacklinks = createBacklinkData(file.fileData, file.markdownFile);
      updateBacklinks(fileBacklinks);
      backlinks2.push(...fileBacklinks);
    });
  });
}
async function recomputeReferencesForPage() {
  let references = [];
  let markdownFiles = this.app.vault.getMarkdownFiles();
  let promises = markdownFiles.map((file) => this.app.vault.read(file));
  let files = await Promise.all(promises);
  const zippedArray = markdownFiles.map((file, index) => ({
    markdownFile: file,
    fileData: files[index]
  }));
  zippedArray.forEach((file) => {
    let fileBacklinks = createBacklinkData(file.fileData, file.markdownFile);
    updateBacklinks(fileBacklinks);
    references.push(...fileBacklinks);
  });
  return references;
}
async function openBacklinkReference(ev) {
  let cursor = getCursor();
  let hover = getBacklinkHover();
  let leaf = getThat().workspace.getLeafById(hover.leafId);
  let container = leaf.containerEl;
  if (!container)
    throw new Error("Container not found");
  container.querySelector(".view-content").style.boxShadow = "none";
  if (cursor && hover && cursor.dataString && hover.dataString && cursor.dataString == hover.dataString) {
    updateCursor({
      temp: false,
      cursorViewport: null,
      peek: false
    });
  }
  updateBacklinkHover({
    temp: false,
    cursorViewport: null,
    peek: false
  });
  handleRemoveHoveredCursor(ACTION_TYPE.CURSOR);
  resetCursor();
}
async function openReference(ev) {
  let cursor = getCursor();
  let hover = getHover();
  let leaf = getThat().workspace.getLeafById(hover.leafId);
  let container = leaf.containerEl;
  if (!container)
    throw new Error("Container not found");
  container.querySelector(".view-content").style.boxShadow = "none";
  if (cursor && hover && cursor.dataString && hover.dataString && cursor.dataString == hover.dataString) {
    updateCursor({
      temp: false,
      cursorViewport: null,
      peek: false
    });
  }
  updateHover({
    temp: false,
    cursorViewport: null,
    peek: false
  });
  handleRemoveHoveredCursor(ACTION_TYPE.CURSOR);
  resetCursor();
}

// src/widget/referenceWidget.ts
function processLine(line) {
  let lineCopy = line == null ? void 0 : line.cloneNode(true);
  lineCopy == null ? void 0 : lineCopy.querySelectorAll(".reference-span").forEach((span) => {
    span.innerHTML = "\u2197";
  });
  return lineCopy;
}
function getReferencePosition(view, currLine, reference, content) {
  let lines = view.contentDOM.querySelectorAll(".cm-line");
  let activeLineIndex;
  let seenActive = false;
  lines.forEach((line, i) => {
    if (seenActive)
      return;
    if (line == currLine) {
      seenActive = true;
      activeLineIndex = i;
    }
  });
  console.log(currLine);
  if (activeLineIndex === void 0)
    return;
  let activeLine = lines[activeLineIndex];
  let activeLineCopy = processLine(activeLine);
  let parts = activeLineCopy.innerText.split("\u2197");
  let lineReferences = activeLine == null ? void 0 : activeLine.querySelectorAll(".reference-data-span");
  let lineReferencesData = Array.from(lineReferences || []).map(
    (span) => "[\u2197](urn:" + span.getAttribute("data") + ")"
  );
  if (!content)
    throw new Error("Reference not found");
  let index = null;
  lineReferencesData.forEach((reference2, i) => {
    if (!index) {
      if (reference2.includes(content)) {
        index = i;
      }
    }
  });
  if (!index && index != 0)
    throw new Error("Reference not found");
  let startText = [
    ...parts.slice(0, index + 1),
    ...lineReferencesData.slice(0, index)
  ];
  let prevLineCharCount = Array.from(lines).slice(0, activeLineIndex).reduce((acc, line) => {
    let processedLine = processLine(line);
    let parts2 = processedLine.innerText.split("\u2197");
    let lineReferences2 = line == null ? void 0 : line.querySelectorAll(".reference-data-span");
    let lineReferencesData2 = Array.from(lineReferences2 || []).map(
      (span) => "[\u2197](urn:" + span.getAttribute("data") + ")"
    );
    let allSerializedText = [...parts2, ...lineReferencesData2].join("") + "\n";
    return allSerializedText.length + acc;
  }, 0);
  let from = prevLineCharCount + startText.join("").length;
  let to = from + reference.length;
  return { from, to };
}
async function serializeReference(content, referenceSpan, view, toggleValue = null) {
  var _a;
  content = typeof content == "string" ? content : content[1];
  const [prefix, text, suffix, file, from, to, portal, toggle] = content.split(":");
  let newToggle = toggleValue ? toggleValue : toggle === "f" ? "t" : "f";
  let reference = `[\u2197](urn:${prefix}:${text}:${suffix}:${file}:${from}:${to}:${portal}:${newToggle})`;
  let currLine = (_a = referenceSpan == null ? void 0 : referenceSpan.parentElement) == null ? void 0 : _a.parentElement;
  const results = getReferencePosition(
    view,
    currLine,
    reference,
    text
  );
  if (results) {
    const { from: transactionFrom, to: transactionTo } = results;
    const transaction = view.state.update({
      changes: { from: transactionFrom, to: transactionTo, insert: reference }
    });
    view.dispatch(transaction);
    await updateBacklinkMarkPositions();
  }
  return;
}
var ReferenceWidget = class extends import_view4.WidgetType {
  constructor(name, view, pos, referenceSpan = null, parentElement = null) {
    super();
    this.name = name;
    this.view = view;
    this.pos = pos;
    this.referenceSpan = referenceSpan;
    this.parentElement = parentElement;
  }
  eq(other) {
    return this.name === other.name;
  }
  async updateName(name, from, to) {
    this.name = name;
  }
  getView() {
    return this.view;
  }
  destroy() {
    setTimeout(() => {
      console.log("remove highlight");
      console.log(this.name);
      console.log(this.pos);
      console.log(this.view);
      console.log(this.referenceSpan);
      console.log(this.parentElement);
      const regex = /\[\]\(urn:([^)]*)\)/g;
      let content = regex.exec(this.name);
      if (!content)
        throw new Error("Invalid reference");
      const [prefix, text, suffix, file, from, to, portal, toggle = "f"] = content[1].split(":");
      let decodedFile = decodeURIComponentString(file);
      let leavesByTab = collectLeavesByTabHelper();
      let leaf = leavesByTab.flat().filter((leaf2) => {
        return leaf2.getViewState().state.file == decodedFile;
      })[0];
      let view = getEditorView(leaf);
      const results = getReferencePosition(
        view,
        this.parentElement,
        this.name,
        text
      );
      if (!results)
        return;
      console.log(view);
      removeHighlight(view, results.from, results.to);
    }, 10);
  }
  toDOM() {
    const regex = /\[\]\(urn:([^)]*)\)/g;
    let content = regex.exec(this.name);
    if (!content)
      throw new Error("Invalid reference");
    const [prefix, text, suffix, file, from, to, portal, toggle = "f"] = content[1].split(":");
    const { span, svg } = createReferenceIcon(
      portal == "portal" ? "inline reference widget |*|" : null
    );
    if (content)
      span.setAttribute("data", content[1]);
    const containerSpan = document.createElement("span");
    containerSpan.classList.add("reference-container-span");
    const referenceSpan = document.createElement("span");
    referenceSpan.classList.add("reference-span");
    referenceSpan.innerHTML = decodeURIComponentString(text);
    referenceSpan.classList.toggle("reference-span-hidden", toggle === "f");
    containerSpan.appendChild(referenceSpan);
    containerSpan.appendChild(span);
    this.referenceSpan = referenceSpan;
    setTimeout(() => {
      this.parentElement = containerSpan.parentElement;
    }, 20);
    containerSpan.addEventListener("click", async (ev) => {
      var _a;
      if (ev.metaKey || ev.ctrlKey) {
        await serializeReference(content, referenceSpan, this.view);
        referenceSpan.classList.toggle("reference-span-hidden");
        if (content)
          this.name = content[0];
        if (referenceSpan) {
          this.referenceSpan = referenceSpan;
          this.parentElement = (_a = referenceSpan == null ? void 0 : referenceSpan.parentElement) == null ? void 0 : _a.parentElement;
        }
      } else {
        openReference(ev);
      }
    });
    return containerSpan;
  }
};
var referenceDecoration = (match, view, pos) => {
  let decoration = import_view4.Decoration.replace({
    widget: new ReferenceWidget(match[0], view, pos)
  });
  return decoration;
};
var referenceMatcher = new import_view4.MatchDecorator({
  // regexp: /\[\u2197\]\(urn:[\s\S^\)]*\)/g,
  // regexp: /\[\u2197\]\(urn:([^:]*:){5,6}[^:]*\)/g,
  // regexp: /\[\u2197\]\(urn:([^:]*:){6}[^:)]*\)/g,
  regexp: /\[\u2197\]\(urn:([^:]*:){7}[^:)]*\)/g,
  decoration: (match, view, pos) => {
    return referenceDecoration(match, view, pos);
  }
});
var referenceResources = import_view4.ViewPlugin.fromClass(
  class {
    constructor(view) {
      this.referenceResources = referenceMatcher.createDeco(view);
    }
    update(update) {
      this.referenceResources = referenceMatcher.updateDeco(
        update,
        this.referenceResources
      );
    }
    destroy() {
      this.referenceResources = import_view4.Decoration.none;
    }
  },
  {
    decorations: (instance) => instance.referenceResources,
    provide: (plugin) => import_view4.EditorView.atomicRanges.of((view) => {
      var _a;
      return ((_a = view.plugin(plugin)) == null ? void 0 : _a.referenceResources) || import_view4.Decoration.none;
    })
  }
);

// src/clipboard.ts
var import_obsidian5 = require("obsidian");
async function updateClipboard(toggle = false, only = false) {
  const view = this.app.workspace.getActiveViewOfType(import_obsidian5.MarkdownView);
  if (view) {
    let selection = view.editor.getSelection();
    if (view.file) {
      const text = view.data;
      const from = view.editor.posToOffset(view.editor.getCursor("from"));
      const to = view.editor.posToOffset(view.editor.getCursor("to"));
      const { prefix, suffix } = getPrefixAndSuffix(text, from, to);
      let reference = `[\u2197](urn:${encodeURIComponentString(
        prefix
      )}-:${encodeURIComponentString(selection)}:-${encodeURIComponentString(
        suffix
      )}:${encodeURIComponentString(view.file.path)}:${from}:${to}:${// only ? "portal" : "no-portal"
      "portal"}:${toggle ? "t" : "f"})`;
      await navigator.clipboard.writeText(reference);
    }
  }
}

// src/main.ts
var import_view5 = require("@codemirror/view");
function generateDefaultHighlights(leaf) {
  const editor = getMarkdownView(leaf).editor;
  const backlinkContainer = getBacklinkContainer(editor);
  let backlinks2 = [];
  for (let i = 0; i < backlinkContainer.children.length; i++) {
    backlinks2.push(backlinkContainer.children.item(i));
  }
  for (let backlink of backlinks2) {
    let reference = backlink.getAttribute("reference") ? JSON.parse(backlink.getAttribute("reference")) : null;
    if (reference) {
      let referenceFrom = reference.referencedLocation.from;
      let referenceTo = reference.referencedLocation.to;
      let editorView = getCodeMirrorEditorView(editor);
      defaultHighlightSelection(editorView, referenceFrom, referenceTo);
    }
  }
}
async function handleMovementEffects2(evt) {
  if (evt.metaKey || evt.ctrlKey)
    return;
  let span;
  if (evt.target && (evt.target instanceof HTMLSpanElement || evt.target instanceof SVGElement || evt.target instanceof SVGPathElement)) {
    span = evt.target;
    while (!(span instanceof HTMLSpanElement) && span.parentElement != null) {
      span = span.parentElement;
    }
  }
  if (span && span instanceof HTMLSpanElement && (span == null ? void 0 : span.parentElement) && (span == null ? void 0 : span.parentElement.classList.contains("reference-container-span"))) {
    console.log("start hover reference effect");
    if (getHover() != null)
      return;
    if (!span.getAttribute("data")) {
      span = span.parentElement;
      span = span.querySelector(".reference-data-span");
      if (!span)
        throw new Error("Span element not found");
    }
    updateHoveredCursorColor(span, ACTION_TYPE.MOUSE);
    startReferenceEffect(span, ACTION_TYPE.MOUSE);
  } else if (span && span instanceof HTMLSpanElement && span.getAttribute("reference")) {
    console.log("start hover backlink effect");
    if (getBacklinkHover() != null)
      return;
    startBacklinkEffect(span);
  } else if (getHover() != null) {
    console.log("end hover reference effect");
    const requiredKeys = [
      "dataString",
      "leafId",
      "originalLeafId",
      "temp",
      "cursorViewport",
      "peek",
      "uuid"
    ];
    const allKeysPresent = () => requiredKeys.every((key) => key in getHover());
    if (!allKeysPresent()) {
      await new Promise((resolve) => setTimeout(resolve, 50));
    }
    await endReferenceHoverEffect();
    handleRemoveHoveredCursor(ACTION_TYPE.MOUSE);
  } else if (getBacklinkHover() != null) {
    console.log("end hover backlink effect");
    const requiredKeys = [
      "dataString",
      "leafId",
      "originalLeafId",
      "backlinkLeafId",
      "temp",
      "cursorViewport",
      "peek",
      "uuid",
      "backlinkUUID"
    ];
    const allKeysPresent = () => requiredKeys.every((key) => key in getBacklinkHover());
    if (!allKeysPresent()) {
      await new Promise((resolve) => setTimeout(resolve, 50));
    }
    console.log("start end backlink effect!!!!!");
    await endBacklinkHoverEffect();
  } else {
  }
}
var ReferencePlugin = class extends import_obsidian6.Plugin {
  onload() {
    setTimeout(async () => {
      await generateBacklinks();
      const leaves = this.app.workspace.getLeavesOfType("markdown");
      let promises = leaves.map(
        (leaf) => {
          return addReferencesToLeaf(leaf);
        }
      );
      Promise.all(promises).then(async (leaves2) => {
        await delay(2e3);
        leaves2.forEach((leaf) => {
          generateDefaultHighlights(leaf);
        });
      });
      this.registerEvent(
        this.app.workspace.on("active-leaf-change", async (ev) => {
          try {
            const activeView = this.app.workspace.getActiveViewOfType(import_obsidian6.MarkdownView);
            if ((activeView == null ? void 0 : activeView.leaf) != null) {
              await addReferencesToLeaf(activeView.leaf);
              await delay(2e3);
              generateDefaultHighlights(activeView.leaf);
            }
          } catch (e) {
            console.log(e);
          }
        })
      );
    }, 4e3);
    updateThat(this);
    this.registerEditorExtension([
      highlights,
      referenceResources,
      import_view5.EditorView.updateListener.of(function(e) {
        if (Math.abs(e.changes.desc.newLength - e.changes.desc.length) > 1) {
          updateBacklinkMarkPositions();
        }
      })
    ]);
    let prevX = 0;
    let prevY = 0;
    this.registerDomEvent(document, "mousemove", async (evt) => {
      let difference = Math.abs(prevX - evt.clientX) + Math.abs(prevY - evt.clientY);
      prevX = evt.clientX;
      prevY = evt.clientY;
      if (difference > 10) {
        return;
      }
      handleMovementEffects2(evt);
    });
    this.registerDomEvent(document, "click", async (evt) => {
      console.log("click");
      await checkFocusCursor(evt);
      updateBacklinkMarkPositions();
    });
    this.registerDomEvent(document, "keyup", async (evt) => {
      if (evt.metaKey || evt.ctrlKey)
        return;
      await checkFocusCursor(evt);
      updateBacklinkMarkPositions();
    });
    this.registerDomEvent(document, "keydown", async (evt) => {
      var _a, _b;
      if (evt.key == "\xC7" && (evt.metaKey || evt.ctrlKey) && evt.shiftKey && evt.altKey) {
        updateClipboard(false);
        new import_obsidian6.Notice("Copied reference to clipboard");
      } else if ((evt.key == "c" || evt.key == "C") && (evt.metaKey || evt.ctrlKey) && evt.shiftKey) {
        updateClipboard(true);
        new import_obsidian6.Notice("Copied reference to clipboard");
      } else if ((evt.key == "s" || evt.key == "S") && (evt.metaKey || evt.ctrlKey) && evt.shiftKey) {
        let target = evt.target;
        let children = Array.from(target.children);
        let currentLine = children.filter(
          (child) => child.classList.contains("cm-active")
        )[0];
        const spans = Array.from(
          currentLine.querySelectorAll(".reference-span")
        );
        let hasOneHidden = false;
        spans.forEach((span) => {
          if (span.classList.contains("reference-span-hidden")) {
            hasOneHidden = true;
          }
        });
        if (spans.every(
          (span) => span.classList.contains("reference-span-hidden")
        ) || hasOneHidden) {
          new import_obsidian6.Notice("Toggle annotations on");
          for (const span of spans) {
            let referenceSpan = (_a = span.parentElement) == null ? void 0 : _a.querySelector(
              ".reference-data-span"
            );
            let content = referenceSpan == null ? void 0 : referenceSpan.getAttribute("data");
            const activeView = this.app.workspace.getLeaf();
            const editor = getMarkdownView(activeView).editor;
            const editorView = getCodeMirrorEditorView(editor);
            await serializeReference(content, span, editorView, "f");
            console.log(span);
            if (!span.classList.contains("reference-span-hidden")) {
              span.classList.add("reference-span-hidden");
            }
            span.classList.remove("reference-span-hidden");
          }
        } else {
          new import_obsidian6.Notice("Toggle annotations off");
          for (const span of spans) {
            let referenceSpan = (_b = span.parentElement) == null ? void 0 : _b.querySelector(
              ".reference-data-span"
            );
            let content = referenceSpan == null ? void 0 : referenceSpan.getAttribute("data");
            const activeView = this.app.workspace.getLeaf();
            const editor = getMarkdownView(activeView).editor;
            const editorView = getCodeMirrorEditorView(editor);
            await serializeReference(content, span, editorView, "t");
            console.log(span);
            if (span.classList.contains("reference-span-hidden")) {
              span.classList.remove("reference-span-hidden");
            }
            span.classList.add("reference-span-hidden");
          }
        }
      }
    });
  }
  onunload() {
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL3N0YXRlLnRzIiwgInNyYy93aWRnZXQvaGlnaGxpZ2h0V2lkZ2V0LnRzIiwgInNyYy9jb25zdGFudHMudHMiLCAic3JjL3dpZGdldC9yZWZlcmVuY2VXaWRnZXQudHMiLCAic3JjL3JlZmVyZW5jZXMudHMiLCAibm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci9ybmcuanMiLCAibm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci9yZWdleC5qcyIsICJub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS1icm93c2VyL3ZhbGlkYXRlLmpzIiwgIm5vZGVfbW9kdWxlcy91dWlkL2Rpc3QvZXNtLWJyb3dzZXIvc3RyaW5naWZ5LmpzIiwgIm5vZGVfbW9kdWxlcy91dWlkL2Rpc3QvZXNtLWJyb3dzZXIvcGFyc2UuanMiLCAibm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci92MzUuanMiLCAibm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci9uYXRpdmUuanMiLCAibm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci92NC5qcyIsICJub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS1icm93c2VyL3NoYTEuanMiLCAibm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci92NS5qcyIsICJzcmMvdXRpbHMudHMiLCAic3JjL3dvcmtzcGFjZS50cyIsICJzcmMvZWZmZWN0cy50cyIsICJzcmMvbWFyay50cyIsICJzcmMvY2xpcGJvYXJkLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBQbHVnaW4sIE1hcmtkb3duVmlldywgTm90aWNlLCBXb3Jrc3BhY2VMZWFmIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5cbmltcG9ydCB7XG5cdHVwZGF0ZVRoYXQsXG5cdGdldEhvdmVyLFxuXHRnZXRCYWNrbGlua3MsXG5cdGdldEJhY2tsaW5rSG92ZXIsXG5cdGdldFRoYXQsXG5cdGdldEN1cnNvcixcblx0cmVzZXRIb3Zlcixcbn0gZnJvbSBcIi4vc3RhdGVcIjtcbmltcG9ydCB7IGhpZ2hsaWdodHMsIHJlZmVyZW5jZVJlc291cmNlcyB9IGZyb20gXCIuL3dpZGdldFwiO1xuaW1wb3J0IHsgdXBkYXRlQ2xpcGJvYXJkIH0gZnJvbSBcIi4vY2xpcGJvYXJkXCI7XG5pbXBvcnQge1xuXHRnZW5lcmF0ZUJhY2tsaW5rcyxcblx0YWRkUmVmZXJlbmNlc1RvTGVhZixcblx0dXBkYXRlQmFja2xpbmtNYXJrUG9zaXRpb25zLFxuXHR1cGRhdGVIb3ZlcmVkQ3Vyc29yQ29sb3IsXG5cdGdldE1hcmtkb3duVmlldyxcblx0Z2V0QmFja2xpbmtDb250YWluZXIsXG5cdGdldENvZGVNaXJyb3JFZGl0b3JWaWV3LFxuXHRnZXRDb250YWluZXJFbGVtZW50LFxufSBmcm9tIFwiLi9yZWZlcmVuY2VzXCI7XG5pbXBvcnQge1xuXHRzdGFydFJlZmVyZW5jZUVmZmVjdCxcblx0ZW5kUmVmZXJlbmNlSG92ZXJFZmZlY3QsXG5cdHN0YXJ0QmFja2xpbmtFZmZlY3QsXG5cdGVuZEJhY2tsaW5rSG92ZXJFZmZlY3QsXG5cdGVuZFJlZmVyZW5jZUN1cnNvckVmZmVjdCxcblx0ZGVsYXksXG59IGZyb20gXCIuL2VmZmVjdHNcIjtcbmltcG9ydCB7IGNoZWNrRm9jdXNDdXJzb3IsIGhhbmRsZVJlbW92ZUhvdmVyZWRDdXJzb3IgfSBmcm9tIFwiLi91dGlsc1wiO1xuaW1wb3J0IHsgQUNUSU9OX1RZUEUgfSBmcm9tIFwiLi9jb25zdGFudHNcIjtcbmltcG9ydCB7IEVkaXRvclZpZXcgfSBmcm9tIFwiQGNvZGVtaXJyb3Ivdmlld1wiO1xuaW1wb3J0IHsgc2VyaWFsaXplUmVmZXJlbmNlIH0gZnJvbSBcIi4vd2lkZ2V0L3JlZmVyZW5jZVdpZGdldFwiO1xuaW1wb3J0IHsgZGVmYXVsdEhpZ2hsaWdodFNlbGVjdGlvbiwgcmVtb3ZlSGlnaGxpZ2h0cyB9IGZyb20gXCIuL21hcmtcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIGdlbmVyYXRlRGVmYXVsdEhpZ2hsaWdodHMobGVhZjogV29ya3NwYWNlTGVhZikge1xuXHRjb25zdCBlZGl0b3IgPSBnZXRNYXJrZG93blZpZXcobGVhZikuZWRpdG9yO1xuXHRjb25zdCBiYWNrbGlua0NvbnRhaW5lciA9IGdldEJhY2tsaW5rQ29udGFpbmVyKGVkaXRvcik7XG5cblx0bGV0IGJhY2tsaW5rcyA9IFtdO1xuXHRmb3IgKGxldCBpID0gMDsgaSA8IGJhY2tsaW5rQ29udGFpbmVyLmNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG5cdFx0YmFja2xpbmtzLnB1c2goYmFja2xpbmtDb250YWluZXIuY2hpbGRyZW4uaXRlbShpKSBhcyBIVE1MRWxlbWVudCk7XG5cdH1cblxuXHRmb3IgKGxldCBiYWNrbGluayBvZiBiYWNrbGlua3MpIHtcblx0XHRsZXQgcmVmZXJlbmNlID0gYmFja2xpbmsuZ2V0QXR0cmlidXRlKFwicmVmZXJlbmNlXCIpXG5cdFx0XHQ/IEpTT04ucGFyc2UoYmFja2xpbmsuZ2V0QXR0cmlidXRlKFwicmVmZXJlbmNlXCIpISlcblx0XHRcdDogbnVsbDtcblx0XHRpZiAocmVmZXJlbmNlKSB7XG5cdFx0XHRsZXQgcmVmZXJlbmNlRnJvbSA9IHJlZmVyZW5jZS5yZWZlcmVuY2VkTG9jYXRpb24uZnJvbTtcblx0XHRcdGxldCByZWZlcmVuY2VUbyA9IHJlZmVyZW5jZS5yZWZlcmVuY2VkTG9jYXRpb24udG87XG5cdFx0XHRsZXQgZWRpdG9yVmlldyA9IGdldENvZGVNaXJyb3JFZGl0b3JWaWV3KGVkaXRvcik7XG5cdFx0XHQvLyByZW1vdmVIaWdobGlnaHRzKGVkaXRvclZpZXcpO1xuXG5cdFx0XHRkZWZhdWx0SGlnaGxpZ2h0U2VsZWN0aW9uKGVkaXRvclZpZXcsIHJlZmVyZW5jZUZyb20sIHJlZmVyZW5jZVRvKTtcblx0XHR9XG5cdH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZU1vdmVtZW50RWZmZWN0cyhldnQ6IE1vdXNlRXZlbnQpIHtcblx0aWYgKGV2dC5tZXRhS2V5IHx8IGV2dC5jdHJsS2V5KSByZXR1cm47XG5cblx0bGV0IHNwYW47XG5cdGlmIChcblx0XHRldnQudGFyZ2V0ICYmXG5cdFx0KGV2dC50YXJnZXQgaW5zdGFuY2VvZiBIVE1MU3BhbkVsZW1lbnQgfHxcblx0XHRcdGV2dC50YXJnZXQgaW5zdGFuY2VvZiBTVkdFbGVtZW50IHx8XG5cdFx0XHRldnQudGFyZ2V0IGluc3RhbmNlb2YgU1ZHUGF0aEVsZW1lbnQpXG5cdCkge1xuXHRcdC8vIElmIGVsZW1lbnQgaXMgc3ZnLCBmaW5kIHRoZSBjb250YWluaW5nIHBhcmVudCBzcGFuXG5cdFx0c3BhbiA9IGV2dC50YXJnZXQ7XG5cdFx0d2hpbGUgKCEoc3BhbiBpbnN0YW5jZW9mIEhUTUxTcGFuRWxlbWVudCkgJiYgc3Bhbi5wYXJlbnRFbGVtZW50ICE9IG51bGwpIHtcblx0XHRcdHNwYW4gPSBzcGFuLnBhcmVudEVsZW1lbnQ7XG5cdFx0fVxuXHR9XG5cdGlmIChcblx0XHRzcGFuICYmXG5cdFx0c3BhbiBpbnN0YW5jZW9mIEhUTUxTcGFuRWxlbWVudCAmJlxuXHRcdHNwYW4/LnBhcmVudEVsZW1lbnQgJiZcblx0XHRzcGFuPy5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyhcInJlZmVyZW5jZS1jb250YWluZXItc3BhblwiKVxuXHQpIHtcblx0XHRjb25zb2xlLmxvZyhcInN0YXJ0IGhvdmVyIHJlZmVyZW5jZSBlZmZlY3RcIik7XG5cdFx0aWYgKGdldEhvdmVyKCkgIT0gbnVsbCkgcmV0dXJuO1xuXHRcdGlmICghc3Bhbi5nZXRBdHRyaWJ1dGUoXCJkYXRhXCIpKSB7XG5cdFx0XHRzcGFuID0gc3Bhbi5wYXJlbnRFbGVtZW50O1xuXHRcdFx0c3BhbiA9IHNwYW4ucXVlcnlTZWxlY3RvcihcIi5yZWZlcmVuY2UtZGF0YS1zcGFuXCIpIGFzIEhUTUxTcGFuRWxlbWVudDtcblx0XHRcdGlmICghc3BhbikgdGhyb3cgbmV3IEVycm9yKFwiU3BhbiBlbGVtZW50IG5vdCBmb3VuZFwiKTtcblx0XHR9XG5cdFx0dXBkYXRlSG92ZXJlZEN1cnNvckNvbG9yKHNwYW4sIEFDVElPTl9UWVBFLk1PVVNFKTtcblx0XHRzdGFydFJlZmVyZW5jZUVmZmVjdChzcGFuLCBBQ1RJT05fVFlQRS5NT1VTRSk7XG5cdH0gZWxzZSBpZiAoXG5cdFx0c3BhbiAmJlxuXHRcdHNwYW4gaW5zdGFuY2VvZiBIVE1MU3BhbkVsZW1lbnQgJiZcblx0XHRzcGFuLmdldEF0dHJpYnV0ZShcInJlZmVyZW5jZVwiKVxuXHQpIHtcblx0XHRjb25zb2xlLmxvZyhcInN0YXJ0IGhvdmVyIGJhY2tsaW5rIGVmZmVjdFwiKTtcblx0XHRpZiAoZ2V0QmFja2xpbmtIb3ZlcigpICE9IG51bGwpIHJldHVybjtcblx0XHRzdGFydEJhY2tsaW5rRWZmZWN0KHNwYW4pO1xuXHR9IGVsc2UgaWYgKGdldEhvdmVyKCkgIT0gbnVsbCkge1xuXHRcdGNvbnNvbGUubG9nKFwiZW5kIGhvdmVyIHJlZmVyZW5jZSBlZmZlY3RcIik7XG5cdFx0Ly8gRGVmaW5lIHRoZSBrZXlzIHlvdSdyZSB3YWl0aW5nIGZvclxuXHRcdGNvbnN0IHJlcXVpcmVkS2V5cyA9IFtcblx0XHRcdFwiZGF0YVN0cmluZ1wiLFxuXHRcdFx0XCJsZWFmSWRcIixcblx0XHRcdFwib3JpZ2luYWxMZWFmSWRcIixcblx0XHRcdFwidGVtcFwiLFxuXHRcdFx0XCJjdXJzb3JWaWV3cG9ydFwiLFxuXHRcdFx0XCJwZWVrXCIsXG5cdFx0XHRcInV1aWRcIixcblx0XHRdO1xuXHRcdC8vIEZ1bmN0aW9uIHRvIGNoZWNrIGlmIGFsbCByZXF1aXJlZCBrZXlzIGFyZSBwcmVzZW50XG5cdFx0Y29uc3QgYWxsS2V5c1ByZXNlbnQgPSAoKSA9PiByZXF1aXJlZEtleXMuZXZlcnkoKGtleSkgPT4ga2V5IGluIGdldEhvdmVyKCkpO1xuXHRcdC8vIFdhaXQgdW50aWwgYWxsIGtleXMgYXJlIHByZXNlbnRcblx0XHRpZiAoIWFsbEtleXNQcmVzZW50KCkpIHtcblx0XHRcdGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDUwKSk7XG5cdFx0fVxuXHRcdGF3YWl0IGVuZFJlZmVyZW5jZUhvdmVyRWZmZWN0KCk7XG5cdFx0aGFuZGxlUmVtb3ZlSG92ZXJlZEN1cnNvcihBQ1RJT05fVFlQRS5NT1VTRSk7XG5cdH0gZWxzZSBpZiAoZ2V0QmFja2xpbmtIb3ZlcigpICE9IG51bGwpIHtcblx0XHRjb25zb2xlLmxvZyhcImVuZCBob3ZlciBiYWNrbGluayBlZmZlY3RcIik7XG5cdFx0Ly8gRGVmaW5lIHRoZSBrZXlzIHlvdSdyZSB3YWl0aW5nIGZvclxuXHRcdGNvbnN0IHJlcXVpcmVkS2V5cyA9IFtcblx0XHRcdFwiZGF0YVN0cmluZ1wiLFxuXHRcdFx0XCJsZWFmSWRcIixcblx0XHRcdFwib3JpZ2luYWxMZWFmSWRcIixcblx0XHRcdFwiYmFja2xpbmtMZWFmSWRcIixcblx0XHRcdFwidGVtcFwiLFxuXHRcdFx0XCJjdXJzb3JWaWV3cG9ydFwiLFxuXHRcdFx0XCJwZWVrXCIsXG5cdFx0XHRcInV1aWRcIixcblx0XHRcdFwiYmFja2xpbmtVVUlEXCIsXG5cdFx0XTtcblx0XHQvLyBGdW5jdGlvbiB0byBjaGVjayBpZiBhbGwgcmVxdWlyZWQga2V5cyBhcmUgcHJlc2VudFxuXHRcdGNvbnN0IGFsbEtleXNQcmVzZW50ID0gKCkgPT5cblx0XHRcdHJlcXVpcmVkS2V5cy5ldmVyeSgoa2V5KSA9PiBrZXkgaW4gZ2V0QmFja2xpbmtIb3ZlcigpKTtcblx0XHQvLyBXYWl0IHVudGlsIGFsbCBrZXlzIGFyZSBwcmVzZW50XG5cdFx0aWYgKCFhbGxLZXlzUHJlc2VudCgpKSB7XG5cdFx0XHRhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gc2V0VGltZW91dChyZXNvbHZlLCA1MCkpO1xuXHRcdH1cblx0XHRjb25zb2xlLmxvZyhcInN0YXJ0IGVuZCBiYWNrbGluayBlZmZlY3QhISEhIVwiKTtcblx0XHRhd2FpdCBlbmRCYWNrbGlua0hvdmVyRWZmZWN0KCk7XG5cdH0gZWxzZSB7XG5cdH1cblx0Ly8gZWxzZSB7XG5cdC8vIFx0Ly8gY29uc29sZS5sb2coXCJlbmQgaG92ZXIgcmVmZXJlbmNlIGVmZmVjdFwiKTtcblx0Ly8gXHRlbmRSZWZlcmVuY2VIb3ZlckVmZmVjdCgpO1xuXHQvLyBcdGhhbmRsZVJlbW92ZUhvdmVyZWRDdXJzb3IoQUNUSU9OX1RZUEUuTU9VU0UpO1xuXHQvLyB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFJlZmVyZW5jZVBsdWdpbiBleHRlbmRzIFBsdWdpbiB7XG5cdG9ubG9hZCgpIHtcblx0XHRzZXRUaW1lb3V0KGFzeW5jICgpID0+IHtcblx0XHRcdGF3YWl0IGdlbmVyYXRlQmFja2xpbmtzKCk7XG5cdFx0XHRjb25zdCBsZWF2ZXMgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFwibWFya2Rvd25cIik7XG5cblx0XHRcdGxldCBwcm9taXNlczogUHJvbWlzZTxXb3Jrc3BhY2VMZWFmPltdID0gbGVhdmVzLm1hcChcblx0XHRcdFx0KGxlYWY6IFdvcmtzcGFjZUxlYWYpID0+IHtcblx0XHRcdFx0XHQvLyBhd2FpdCBhZGRSZWZlcmVuY2VzVG9MZWFmKGxlYWYpO1xuXHRcdFx0XHRcdHJldHVybiBhZGRSZWZlcmVuY2VzVG9MZWFmKGxlYWYpO1xuXHRcdFx0XHR9XG5cdFx0XHQpO1xuXG5cdFx0XHRQcm9taXNlLmFsbChwcm9taXNlcykudGhlbihhc3luYyAobGVhdmVzOiBXb3Jrc3BhY2VMZWFmW10pID0+IHtcblx0XHRcdFx0YXdhaXQgZGVsYXkoMjAwMCk7XG5cdFx0XHRcdGxlYXZlcy5mb3JFYWNoKChsZWFmOiBXb3Jrc3BhY2VMZWFmKSA9PiB7XG5cdFx0XHRcdFx0Z2VuZXJhdGVEZWZhdWx0SGlnaGxpZ2h0cyhsZWFmKTtcblx0XHRcdFx0XHQvLyBjb25zdCBlZGl0b3IgPSBnZXRNYXJrZG93blZpZXcobGVhZikuZWRpdG9yO1xuXHRcdFx0XHRcdC8vIGNvbnN0IGJhY2tsaW5rQ29udGFpbmVyID0gZ2V0QmFja2xpbmtDb250YWluZXIoZWRpdG9yKTtcblxuXHRcdFx0XHRcdC8vIGxldCBiYWNrbGlua3MgPSBbXTtcblx0XHRcdFx0XHQvLyBmb3IgKGxldCBpID0gMDsgaSA8IGJhY2tsaW5rQ29udGFpbmVyLmNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0Ly8gXHRiYWNrbGlua3MucHVzaChiYWNrbGlua0NvbnRhaW5lci5jaGlsZHJlbi5pdGVtKGkpIGFzIEhUTUxFbGVtZW50KTtcblx0XHRcdFx0XHQvLyB9XG5cblx0XHRcdFx0XHQvLyBmb3IgKGxldCBiYWNrbGluayBvZiBiYWNrbGlua3MpIHtcblx0XHRcdFx0XHQvLyBcdGxldCByZWZlcmVuY2UgPSBiYWNrbGluay5nZXRBdHRyaWJ1dGUoXCJyZWZlcmVuY2VcIilcblx0XHRcdFx0XHQvLyBcdFx0PyBKU09OLnBhcnNlKGJhY2tsaW5rLmdldEF0dHJpYnV0ZShcInJlZmVyZW5jZVwiKSEpXG5cdFx0XHRcdFx0Ly8gXHRcdDogbnVsbDtcblx0XHRcdFx0XHQvLyBcdGlmIChyZWZlcmVuY2UpIHtcblx0XHRcdFx0XHQvLyBcdFx0bGV0IHJlZmVyZW5jZUZyb20gPSByZWZlcmVuY2UucmVmZXJlbmNlZExvY2F0aW9uLmZyb207XG5cdFx0XHRcdFx0Ly8gXHRcdGxldCByZWZlcmVuY2VUbyA9IHJlZmVyZW5jZS5yZWZlcmVuY2VkTG9jYXRpb24udG87XG5cdFx0XHRcdFx0Ly8gXHRcdGxldCBlZGl0b3JWaWV3ID0gZ2V0Q29kZU1pcnJvckVkaXRvclZpZXcoZWRpdG9yKTtcblx0XHRcdFx0XHQvLyBcdFx0ZGVmYXVsdEhpZ2hsaWdodFNlbGVjdGlvbihlZGl0b3JWaWV3LCByZWZlcmVuY2VGcm9tLCByZWZlcmVuY2VUbyk7XG5cdFx0XHRcdFx0Ly8gXHR9XG5cdFx0XHRcdFx0Ly8gfVxuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXG5cdFx0XHR0aGlzLnJlZ2lzdGVyRXZlbnQoXG5cdFx0XHRcdHRoaXMuYXBwLndvcmtzcGFjZS5vbihcImFjdGl2ZS1sZWFmLWNoYW5nZVwiLCBhc3luYyAoZXYpID0+IHtcblx0XHRcdFx0XHQvLyBUaGlzIHNob3VsZCBjcmVhdGUgcmVmZXJlbmNlTWFya2VycyBpZiB0aGV5IGRvbid0IGV4aXN0IGFuZCB1cGRhdGVcblx0XHRcdFx0XHQvLyBlbHNlIHVwZGF0ZSBvbmx5XG5cblx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0Y29uc3QgYWN0aXZlVmlldyA9XG5cdFx0XHRcdFx0XHRcdHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG5cdFx0XHRcdFx0XHRpZiAoYWN0aXZlVmlldz8ubGVhZiAhPSBudWxsKSB7XG5cdFx0XHRcdFx0XHRcdGF3YWl0IGFkZFJlZmVyZW5jZXNUb0xlYWYoYWN0aXZlVmlldy5sZWFmKTtcblx0XHRcdFx0XHRcdFx0YXdhaXQgZGVsYXkoMjAwMCk7XG5cblx0XHRcdFx0XHRcdFx0Z2VuZXJhdGVEZWZhdWx0SGlnaGxpZ2h0cyhhY3RpdmVWaWV3LmxlYWYpO1xuXG5cdFx0XHRcdFx0XHRcdC8vIGxldCBjb250YWluZXIgPSBnZXRDb250YWluZXJFbGVtZW50KGFjdGl2ZVZpZXcubGVhZik7XG5cdFx0XHRcdFx0XHRcdC8vIGNvbnN0IGVkaXRvciA9IGdldE1hcmtkb3duVmlldyhhY3RpdmVWaWV3LmxlYWYpLmVkaXRvcjtcblx0XHRcdFx0XHRcdFx0Ly8gY29uc3QgYmFja2xpbmtDb250YWluZXIgPSBnZXRCYWNrbGlua0NvbnRhaW5lcihlZGl0b3IpO1xuXG5cdFx0XHRcdFx0XHRcdC8vIGxldCBiYWNrbGlua3MgPSBbXTtcblx0XHRcdFx0XHRcdFx0Ly8gZm9yIChsZXQgaSA9IDA7IGkgPCBiYWNrbGlua0NvbnRhaW5lci5jaGlsZHJlbi5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdFx0XHQvLyBcdGJhY2tsaW5rcy5wdXNoKFxuXHRcdFx0XHRcdFx0XHQvLyBcdFx0YmFja2xpbmtDb250YWluZXIuY2hpbGRyZW4uaXRlbShpKSBhcyBIVE1MRWxlbWVudFxuXHRcdFx0XHRcdFx0XHQvLyBcdCk7XG5cdFx0XHRcdFx0XHRcdC8vIH1cblxuXHRcdFx0XHRcdFx0XHQvLyBmb3IgKGxldCBiYWNrbGluayBvZiBiYWNrbGlua3MpIHtcblx0XHRcdFx0XHRcdFx0Ly8gXHRsZXQgcmVmZXJlbmNlID0gYmFja2xpbmsuZ2V0QXR0cmlidXRlKFwicmVmZXJlbmNlXCIpXG5cdFx0XHRcdFx0XHRcdC8vIFx0XHQ/IEpTT04ucGFyc2UoYmFja2xpbmsuZ2V0QXR0cmlidXRlKFwicmVmZXJlbmNlXCIpISlcblx0XHRcdFx0XHRcdFx0Ly8gXHRcdDogbnVsbDtcblx0XHRcdFx0XHRcdFx0Ly8gXHRpZiAocmVmZXJlbmNlKSB7XG5cdFx0XHRcdFx0XHRcdC8vIFx0XHRjb25zb2xlLmxvZyhyZWZlcmVuY2UpO1xuXHRcdFx0XHRcdFx0XHQvLyBcdFx0bGV0IHJlZmVyZW5jZUZyb20gPSByZWZlcmVuY2UucmVmZXJlbmNlZExvY2F0aW9uLmZyb207XG5cdFx0XHRcdFx0XHRcdC8vIFx0XHRsZXQgcmVmZXJlbmNlVG8gPSByZWZlcmVuY2UucmVmZXJlbmNlZExvY2F0aW9uLnRvO1xuXHRcdFx0XHRcdFx0XHQvLyBcdFx0bGV0IGVkaXRvclZpZXcgPSBnZXRDb2RlTWlycm9yRWRpdG9yVmlldyhlZGl0b3IpO1xuXHRcdFx0XHRcdFx0XHQvLyBcdFx0ZGVmYXVsdEhpZ2hsaWdodFNlbGVjdGlvbihcblx0XHRcdFx0XHRcdFx0Ly8gXHRcdFx0ZWRpdG9yVmlldyxcblx0XHRcdFx0XHRcdFx0Ly8gXHRcdFx0cmVmZXJlbmNlRnJvbSxcblx0XHRcdFx0XHRcdFx0Ly8gXHRcdFx0cmVmZXJlbmNlVG9cblx0XHRcdFx0XHRcdFx0Ly8gXHRcdCk7XG5cdFx0XHRcdFx0XHRcdC8vIFx0fVxuXHRcdFx0XHRcdFx0XHQvLyB9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coZSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KVxuXHRcdFx0KTtcblx0XHR9LCA0MDAwKTtcblxuXHRcdHVwZGF0ZVRoYXQodGhpcyk7XG5cblx0XHR0aGlzLnJlZ2lzdGVyRWRpdG9yRXh0ZW5zaW9uKFtcblx0XHRcdGhpZ2hsaWdodHMsXG5cdFx0XHRyZWZlcmVuY2VSZXNvdXJjZXMsXG5cdFx0XHRFZGl0b3JWaWV3LnVwZGF0ZUxpc3RlbmVyLm9mKGZ1bmN0aW9uIChlKSB7XG5cdFx0XHRcdGlmIChNYXRoLmFicyhlLmNoYW5nZXMuZGVzYy5uZXdMZW5ndGggLSBlLmNoYW5nZXMuZGVzYy5sZW5ndGgpID4gMSkge1xuXHRcdFx0XHRcdHVwZGF0ZUJhY2tsaW5rTWFya1Bvc2l0aW9ucygpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KSxcblx0XHRdKTtcblxuXHRcdC8vIHRoaXMucmVnaXN0ZXJEb21FdmVudChkb2N1bWVudCwgXCJzY3JvbGxcIiwgYXN5bmMgKGV2dCkgPT4ge1xuXHRcdC8vIFx0Y29uc29sZS5sb2coZXZ0KTtcblx0XHQvLyBcdGhhbmRsZU1vdmVtZW50RWZmZWN0cyhldnQgYXMgTW91c2VFdmVudCk7XG5cdFx0Ly8gfSk7XG5cblx0XHRsZXQgcHJldlggPSAwO1xuXHRcdGxldCBwcmV2WSA9IDA7XG5cblx0XHR0aGlzLnJlZ2lzdGVyRG9tRXZlbnQoZG9jdW1lbnQsIFwibW91c2Vtb3ZlXCIsIGFzeW5jIChldnQpID0+IHtcblx0XHRcdGxldCBkaWZmZXJlbmNlID1cblx0XHRcdFx0TWF0aC5hYnMocHJldlggLSBldnQuY2xpZW50WCkgKyBNYXRoLmFicyhwcmV2WSAtIGV2dC5jbGllbnRZKTtcblx0XHRcdHByZXZYID0gZXZ0LmNsaWVudFg7XG5cdFx0XHRwcmV2WSA9IGV2dC5jbGllbnRZO1xuXHRcdFx0aWYgKGRpZmZlcmVuY2UgPiAxMCkge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cdFx0XHRoYW5kbGVNb3ZlbWVudEVmZmVjdHMoZXZ0KTtcblx0XHR9KTtcblxuXHRcdC8vIG9uIHNlbGVjdGlvbiBjaGFuZ2VzLCBldmVudCBvdmVyIGNsaWNrIGFuZCBrZXlkb3duXG5cblx0XHR0aGlzLnJlZ2lzdGVyRG9tRXZlbnQoZG9jdW1lbnQsIFwiY2xpY2tcIiwgYXN5bmMgKGV2dCkgPT4ge1xuXHRcdFx0Y29uc29sZS5sb2coXCJjbGlja1wiKTtcblx0XHRcdGF3YWl0IGNoZWNrRm9jdXNDdXJzb3IoZXZ0KTtcblx0XHRcdHVwZGF0ZUJhY2tsaW5rTWFya1Bvc2l0aW9ucygpO1xuXG5cdFx0XHQvLyBpZiAoZXZ0Lm1ldGFLZXkgfHwgZXZ0LmN0cmxLZXkpIHJldHVybjtcblx0XHRcdC8vIGF3YWl0IGVuZFJlZmVyZW5jZUN1cnNvckVmZmVjdCgpO1xuXHRcdH0pO1xuXG5cdFx0dGhpcy5yZWdpc3RlckRvbUV2ZW50KGRvY3VtZW50LCBcImtleXVwXCIsIGFzeW5jIChldnQpID0+IHtcblx0XHRcdGlmIChldnQubWV0YUtleSB8fCBldnQuY3RybEtleSkgcmV0dXJuO1xuXG5cdFx0XHQvLyBjb25zb2xlLmxvZyhcImtleXVwXCIpO1xuXHRcdFx0YXdhaXQgY2hlY2tGb2N1c0N1cnNvcihldnQpO1xuXHRcdFx0dXBkYXRlQmFja2xpbmtNYXJrUG9zaXRpb25zKCk7XG5cdFx0XHQvLyB1cGRhdGVCYWNrbGlua01hcmtQb3NpdGlvbnMoKTtcblx0XHR9KTtcblxuXHRcdHRoaXMucmVnaXN0ZXJEb21FdmVudChkb2N1bWVudCwgXCJrZXlkb3duXCIsIGFzeW5jIChldnQpID0+IHtcblx0XHRcdC8vIGNvbnNvbGUubG9nKFwia2V5ZG93blwiKTtcblxuXHRcdFx0Ly8gY29uc29sZS5sb2coZXZ0LmtleSk7XG5cblx0XHRcdC8vIGNvbnNvbGUubG9nKGV2dC5zaGlmdEtleSk7XG5cblx0XHRcdC8vIGNvbnNvbGUubG9nKGV2dC5jdHJsS2V5KTtcblx0XHRcdC8vIGNvbnNvbGUubG9nKGV2dC5tZXRhS2V5KTtcblxuXHRcdFx0Ly8gY29uc29sZS5sb2coXG5cdFx0XHQvLyBcdGV2dC5rZXkgPT0gXCJzXCIgJiYgKGV2dC5tZXRhS2V5IHx8IGV2dC5jdHJsS2V5KSAmJiBldnQuc2hpZnRLZXlcblx0XHRcdC8vICk7XG5cdFx0XHRpZiAoXG5cdFx0XHRcdGV2dC5rZXkgPT0gXCJcdTAwQzdcIiAmJlxuXHRcdFx0XHQoZXZ0Lm1ldGFLZXkgfHwgZXZ0LmN0cmxLZXkpICYmXG5cdFx0XHRcdGV2dC5zaGlmdEtleSAmJlxuXHRcdFx0XHRldnQuYWx0S2V5XG5cdFx0XHQpIHtcblx0XHRcdFx0Ly8gY29uc29sZS5sb2coXCJjXCIpO1xuXHRcdFx0XHR1cGRhdGVDbGlwYm9hcmQoZmFsc2UpO1xuXHRcdFx0XHRuZXcgTm90aWNlKFwiQ29waWVkIHJlZmVyZW5jZSB0byBjbGlwYm9hcmRcIik7XG5cdFx0XHR9IGVsc2UgaWYgKFxuXHRcdFx0XHQoZXZ0LmtleSA9PSBcImNcIiB8fCBldnQua2V5ID09IFwiQ1wiKSAmJlxuXHRcdFx0XHQoZXZ0Lm1ldGFLZXkgfHwgZXZ0LmN0cmxLZXkpICYmXG5cdFx0XHRcdGV2dC5zaGlmdEtleVxuXHRcdFx0KSB7XG5cdFx0XHRcdC8vIGNvbnNvbGUubG9nKFwiclwiKTtcblx0XHRcdFx0dXBkYXRlQ2xpcGJvYXJkKHRydWUpO1xuXHRcdFx0XHRuZXcgTm90aWNlKFwiQ29waWVkIHJlZmVyZW5jZSB0byBjbGlwYm9hcmRcIik7XG5cdFx0XHR9IGVsc2UgaWYgKFxuXHRcdFx0XHQoZXZ0LmtleSA9PSBcInNcIiB8fCBldnQua2V5ID09IFwiU1wiKSAmJlxuXHRcdFx0XHQoZXZ0Lm1ldGFLZXkgfHwgZXZ0LmN0cmxLZXkpICYmXG5cdFx0XHRcdGV2dC5zaGlmdEtleVxuXHRcdFx0KSB7XG5cdFx0XHRcdGxldCB0YXJnZXQgPSBldnQudGFyZ2V0IGFzIEhUTUxFbGVtZW50O1xuXHRcdFx0XHRsZXQgY2hpbGRyZW4gPSBBcnJheS5mcm9tKHRhcmdldC5jaGlsZHJlbik7XG5cdFx0XHRcdGxldCBjdXJyZW50TGluZSA9IGNoaWxkcmVuLmZpbHRlcigoY2hpbGQpID0+XG5cdFx0XHRcdFx0Y2hpbGQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiY20tYWN0aXZlXCIpXG5cdFx0XHRcdClbMF07XG5cblx0XHRcdFx0Y29uc3Qgc3BhbnMgPSBBcnJheS5mcm9tPEhUTUxTcGFuRWxlbWVudD4oXG5cdFx0XHRcdFx0Y3VycmVudExpbmUucXVlcnlTZWxlY3RvckFsbChcIi5yZWZlcmVuY2Utc3BhblwiKVxuXHRcdFx0XHQpO1xuXG5cdFx0XHRcdGxldCBoYXNPbmVIaWRkZW4gPSBmYWxzZTtcblx0XHRcdFx0c3BhbnMuZm9yRWFjaCgoc3BhbikgPT4ge1xuXHRcdFx0XHRcdGlmIChzcGFuLmNsYXNzTGlzdC5jb250YWlucyhcInJlZmVyZW5jZS1zcGFuLWhpZGRlblwiKSkge1xuXHRcdFx0XHRcdFx0aGFzT25lSGlkZGVuID0gdHJ1ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHQvLyAvLyBzcGFucy5yZWR1Y2UoKGFjYywgc3BhbikgPT4ge1xuXHRcdFx0XHQvLyAvLyBcdGlmIChhY2MpIHJldHVybiBhY2M7XG5cdFx0XHRcdC8vIC8vIFx0cmV0dXJuIHNwYW4uY2xhc3NMaXN0LmNvbnRhaW5zKFwicmVmZXJlbmNlLXNwYW4taGlkZGVuXCIpO1xuXHRcdFx0XHQvLyAvLyB9LCBmYWxzZSkpXG5cblx0XHRcdFx0Ly8gY29uc29sZS5sb2coXG5cdFx0XHRcdC8vIFx0c3BhbnMuZXZlcnkoKHNwYW4pID0+XG5cdFx0XHRcdC8vIFx0XHRzcGFuLmNsYXNzTGlzdC5jb250YWlucyhcInJlZmVyZW5jZS1zcGFuLWhpZGRlblwiKVxuXHRcdFx0XHQvLyBcdClcblx0XHRcdFx0Ly8gKTtcblxuXHRcdFx0XHQvLyBjb25zb2xlLmxvZyhcblx0XHRcdFx0Ly8gXHQhc3BhbnMuZXZlcnkoKHNwYW4pID0+XG5cdFx0XHRcdC8vIFx0XHRzcGFuLmNsYXNzTGlzdC5jb250YWlucyhcInJlZmVyZW5jZS1zcGFuLWhpZGRlblwiKVxuXHRcdFx0XHQvLyBcdCkgJiYgaGFzT25lSGlkZGVuXG5cdFx0XHRcdC8vICk7XG5cblx0XHRcdFx0Ly8gY29uc29sZS5sb2coXG5cdFx0XHRcdC8vIFx0IXNwYW5zLmV2ZXJ5KChzcGFuKSA9PlxuXHRcdFx0XHQvLyBcdFx0c3Bhbi5jbGFzc0xpc3QuY29udGFpbnMoXCJyZWZlcmVuY2Utc3Bhbi1oaWRkZW5cIilcblx0XHRcdFx0Ly8gXHQpXG5cdFx0XHRcdC8vICk7XG5cdFx0XHRcdGlmIChcblx0XHRcdFx0XHRzcGFucy5ldmVyeSgoc3BhbikgPT5cblx0XHRcdFx0XHRcdHNwYW4uY2xhc3NMaXN0LmNvbnRhaW5zKFwicmVmZXJlbmNlLXNwYW4taGlkZGVuXCIpXG5cdFx0XHRcdFx0KSB8fFxuXHRcdFx0XHRcdGhhc09uZUhpZGRlblxuXHRcdFx0XHRcdC8vIHNwYW5zLmV2ZXJ5KChzcGFuKSA9PlxuXHRcdFx0XHRcdC8vIFx0c3Bhbi5jbGFzc0xpc3QuY29udGFpbnMoXCJyZWZlcmVuY2Utc3Bhbi1oaWRkZW5cIilcblx0XHRcdFx0XHQvLyApIHx8XG5cdFx0XHRcdFx0Ly8gKCFzcGFucy5ldmVyeSgoc3BhbikgPT5cblx0XHRcdFx0XHQvLyBcdHNwYW4uY2xhc3NMaXN0LmNvbnRhaW5zKFwicmVmZXJlbmNlLXNwYW4taGlkZGVuXCIpXG5cdFx0XHRcdFx0Ly8gKSAmJlxuXHRcdFx0XHRcdC8vIFx0aGFzT25lSGlkZGVuKVxuXHRcdFx0XHQpIHtcblx0XHRcdFx0XHRuZXcgTm90aWNlKFwiVG9nZ2xlIGFubm90YXRpb25zIG9uXCIpO1xuXG5cdFx0XHRcdFx0Ly8gc3BhbnMuZm9yRWFjaChhc3luYyAoc3BhbikgPT4ge1xuXHRcdFx0XHRcdGZvciAoY29uc3Qgc3BhbiBvZiBzcGFucykge1xuXHRcdFx0XHRcdFx0Ly8gV2FudCB0byBzZXJpYWxpemUgcmVmZXJlbmNlcyBhdCBzb21lIHBvaW50XG5cdFx0XHRcdFx0XHRsZXQgcmVmZXJlbmNlU3BhbiA9IHNwYW4ucGFyZW50RWxlbWVudD8ucXVlcnlTZWxlY3Rvcihcblx0XHRcdFx0XHRcdFx0XCIucmVmZXJlbmNlLWRhdGEtc3BhblwiXG5cdFx0XHRcdFx0XHQpO1xuXHRcdFx0XHRcdFx0bGV0IGNvbnRlbnQgPSByZWZlcmVuY2VTcGFuPy5nZXRBdHRyaWJ1dGUoXCJkYXRhXCIpO1xuXHRcdFx0XHRcdFx0Y29uc3QgYWN0aXZlVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWFmKCk7XG5cdFx0XHRcdFx0XHRjb25zdCBlZGl0b3IgPSBnZXRNYXJrZG93blZpZXcoYWN0aXZlVmlldykuZWRpdG9yO1xuXHRcdFx0XHRcdFx0Y29uc3QgZWRpdG9yVmlldyA9IGdldENvZGVNaXJyb3JFZGl0b3JWaWV3KGVkaXRvcik7XG5cblx0XHRcdFx0XHRcdGF3YWl0IHNlcmlhbGl6ZVJlZmVyZW5jZShjb250ZW50LCBzcGFuLCBlZGl0b3JWaWV3LCBcImZcIik7XG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZyhzcGFuKTtcblx0XHRcdFx0XHRcdGlmICghc3Bhbi5jbGFzc0xpc3QuY29udGFpbnMoXCJyZWZlcmVuY2Utc3Bhbi1oaWRkZW5cIikpIHtcblx0XHRcdFx0XHRcdFx0c3Bhbi5jbGFzc0xpc3QuYWRkKFwicmVmZXJlbmNlLXNwYW4taGlkZGVuXCIpO1xuXHRcdFx0XHRcdFx0XHQvLyBBbGxvdyB0aGUgYnJvd3NlciB0byByZS1yZW5kZXIgdGhlIGVsZW1lbnRcblx0XHRcdFx0XHRcdFx0Ly8gYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMCkpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0c3Bhbi5jbGFzc0xpc3QucmVtb3ZlKFwicmVmZXJlbmNlLXNwYW4taGlkZGVuXCIpO1xuXHRcdFx0XHRcdFx0Ly8gQWxsb3cgdGhlIGJyb3dzZXIgdG8gcmUtcmVuZGVyIHRoZSBlbGVtZW50XG5cdFx0XHRcdFx0XHQvLyBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gc2V0VGltZW91dChyZXNvbHZlLCAwKSk7XG5cdFx0XHRcdFx0XHQvLyBjb25zdCBjdXJzb3IgPSBlZGl0b3IuZ2V0Q3Vyc29yKCk7XG5cdFx0XHRcdFx0XHQvLyBlZGl0b3IucmVwbGFjZVJhbmdlKFwiIFwiLCBjdXJzb3IsIGN1cnNvcik7XG5cdFx0XHRcdFx0XHQvLyBlZGl0b3IudW5kbygpO1xuXHRcdFx0XHRcdFx0Ly8gfSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdG5ldyBOb3RpY2UoXCJUb2dnbGUgYW5ub3RhdGlvbnMgb2ZmXCIpO1xuXG5cdFx0XHRcdFx0Ly8gc3BhbnMuZm9yRWFjaChhc3luYyAoc3BhbjogSFRNTFNwYW5FbGVtZW50KSA9PiB7XG5cdFx0XHRcdFx0Ly8gXHRsZXQgcmVmZXJlbmNlU3BhbiA9IHNwYW4ucGFyZW50RWxlbWVudD8ucXVlcnlTZWxlY3Rvcihcblx0XHRcdFx0XHQvLyBcdFx0XCIucmVmZXJlbmNlLWRhdGEtc3BhblwiXG5cdFx0XHRcdFx0Ly8gXHQpO1xuXHRcdFx0XHRcdC8vIFx0bGV0IGNvbnRlbnQgPSByZWZlcmVuY2VTcGFuPy5nZXRBdHRyaWJ1dGUoXCJkYXRhXCIpO1xuXHRcdFx0XHRcdC8vIFx0Y29uc3QgYWN0aXZlVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWFmKCk7XG5cdFx0XHRcdFx0Ly8gXHRjb25zdCBlZGl0b3IgPSBnZXRNYXJrZG93blZpZXcoYWN0aXZlVmlldykuZWRpdG9yO1xuXHRcdFx0XHRcdC8vIFx0Y29uc3QgZWRpdG9yVmlldyA9IGdldENvZGVNaXJyb3JFZGl0b3JWaWV3KGVkaXRvcik7XG5cblx0XHRcdFx0XHQvLyBcdGF3YWl0IHNlcmlhbGl6ZVJlZmVyZW5jZShjb250ZW50LCBzcGFuLCBlZGl0b3JWaWV3LCBcInRcIik7XG5cdFx0XHRcdFx0Ly8gXHRjb25zb2xlLmxvZyhzcGFuKTtcblx0XHRcdFx0XHQvLyBcdHNwYW4uY2xhc3NMaXN0LnJlbW92ZShcInJlZmVyZW5jZS1zcGFuLWhpZGRlblwiKTtcblxuXHRcdFx0XHRcdC8vIFx0aWYgKCFzcGFuLmNsYXNzTGlzdC5jb250YWlucyhcInJlZmVyZW5jZS1zcGFuLWhpZGRlblwiKSkge1xuXHRcdFx0XHRcdC8vIFx0XHRzcGFuLmNsYXNzTGlzdC5hZGQoXCJyZWZlcmVuY2Utc3Bhbi1oaWRkZW5cIik7XG5cdFx0XHRcdFx0Ly8gXHR9XG5cdFx0XHRcdFx0Ly8gfSk7XG5cblx0XHRcdFx0XHRmb3IgKGNvbnN0IHNwYW4gb2Ygc3BhbnMpIHtcblx0XHRcdFx0XHRcdGxldCByZWZlcmVuY2VTcGFuID0gc3Bhbi5wYXJlbnRFbGVtZW50Py5xdWVyeVNlbGVjdG9yKFxuXHRcdFx0XHRcdFx0XHRcIi5yZWZlcmVuY2UtZGF0YS1zcGFuXCJcblx0XHRcdFx0XHRcdCk7XG5cdFx0XHRcdFx0XHRsZXQgY29udGVudCA9IHJlZmVyZW5jZVNwYW4/LmdldEF0dHJpYnV0ZShcImRhdGFcIik7XG5cdFx0XHRcdFx0XHRjb25zdCBhY3RpdmVWaWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYWYoKTtcblx0XHRcdFx0XHRcdGNvbnN0IGVkaXRvciA9IGdldE1hcmtkb3duVmlldyhhY3RpdmVWaWV3KS5lZGl0b3I7XG5cdFx0XHRcdFx0XHRjb25zdCBlZGl0b3JWaWV3ID0gZ2V0Q29kZU1pcnJvckVkaXRvclZpZXcoZWRpdG9yKTtcblxuXHRcdFx0XHRcdFx0YXdhaXQgc2VyaWFsaXplUmVmZXJlbmNlKGNvbnRlbnQsIHNwYW4sIGVkaXRvclZpZXcsIFwidFwiKTtcblx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKHNwYW4pO1xuXG5cdFx0XHRcdFx0XHQvLyBSZW1vdmUgdGhlIGNsYXNzIGlmIGl0IGV4aXN0c1xuXHRcdFx0XHRcdFx0aWYgKHNwYW4uY2xhc3NMaXN0LmNvbnRhaW5zKFwicmVmZXJlbmNlLXNwYW4taGlkZGVuXCIpKSB7XG5cdFx0XHRcdFx0XHRcdHNwYW4uY2xhc3NMaXN0LnJlbW92ZShcInJlZmVyZW5jZS1zcGFuLWhpZGRlblwiKTtcblx0XHRcdFx0XHRcdFx0Ly8gQWxsb3cgdGhlIGJyb3dzZXIgdG8gcmUtcmVuZGVyIHRoZSBlbGVtZW50XG5cdFx0XHRcdFx0XHRcdC8vIGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDApKTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0Ly8gQWRkIHRoZSBjbGFzc1xuXHRcdFx0XHRcdFx0c3Bhbi5jbGFzc0xpc3QuYWRkKFwicmVmZXJlbmNlLXNwYW4taGlkZGVuXCIpO1xuXHRcdFx0XHRcdFx0Ly8gQWxsb3cgdGhlIGJyb3dzZXIgdG8gcmUtcmVuZGVyIHRoZSBlbGVtZW50XG5cdFx0XHRcdFx0XHQvLyBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gc2V0VGltZW91dChyZXNvbHZlLCAwKSk7XG5cdFx0XHRcdFx0XHQvLyBjb25zdCBjdXJzb3IgPSBlZGl0b3IuZ2V0Q3Vyc29yKCk7XG5cdFx0XHRcdFx0XHQvLyBlZGl0b3IucmVwbGFjZVJhbmdlKFwiIFwiLCBjdXJzb3IsIGN1cnNvcik7XG5cdFx0XHRcdFx0XHQvLyBlZGl0b3IudW5kbygpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0Ly8gZ2V0VGhhdCgpLndvcmtzcGFjZS5vbihcImVkaXRvci1jaGFuZ2VcIiwgKGV2KSA9PiB7XG5cdFx0Ly8gXHRjb25zb2xlLmxvZyhldik7XG5cdFx0Ly8gfSk7XG5cblx0XHQvLyB0aGlzLnJlZ2lzdGVyRXZlbnQoXG5cdFx0Ly8gXHR0aGlzLmFwcC53b3Jrc3BhY2Uub24oXCJ3aW5kb3ctY2xvc2VcIiwgKGV2KSA9PiB7XG5cdFx0Ly8gXHRcdGNvbnNvbGUubG9nKFwid2luZG93IGNsb3NlZDpcIik7XG5cdFx0Ly8gXHRcdGNvbnNvbGUubG9nKGV2KTtcblx0XHQvLyBcdH0pXG5cdFx0Ly8gKTtcblxuXHRcdC8vIHRoaXMucmVnaXN0ZXJFdmVudChcblx0XHQvLyBcdHRoaXMuYXBwLndvcmtzcGFjZS5vbihcImVkaXRvci1kcm9wXCIsIChldikgPT4ge1xuXHRcdC8vIFx0XHRjb25zb2xlLmxvZyhcIkVkaXRvciBkcm9wcGVkOlwiKTtcblx0XHQvLyBcdFx0Y29uc29sZS5sb2coZXYpO1xuXHRcdC8vIFx0fSlcblx0XHQvLyApO1xuXG5cdFx0Ly8gdGhpcy5yZWdpc3RlckV2ZW50KFxuXHRcdC8vIFx0dGhpcy5hcHAud29ya3NwYWNlLm9uKFwid2luZG93LW9wZW5cIiwgKGV2KSA9PiB7XG5cdFx0Ly8gXHRcdGNvbnNvbGUubG9nKFwid2luZG93IG9wZW5lZDpcIik7XG5cdFx0Ly8gXHRcdC8vIGNvbnNvbGUubG9nKGV2KTtcblx0XHQvLyBcdH0pXG5cdFx0Ly8gKTtcblxuXHRcdC8vIHRoaXMucmVnaXN0ZXJFdmVudChcblx0XHQvLyBcdHRoaXMuYXBwLndvcmtzcGFjZS5vbihcInJlc2l6ZVwiLCAoKSA9PiB7XG5cdFx0Ly8gXHRcdGNvbnNvbGUubG9nKFwicmVzaXplXCIpO1xuXHRcdC8vIFx0fSlcblx0XHQvLyApO1xuXG5cdFx0Ly8gdGhpcy5yZWdpc3RlckV2ZW50KFxuXHRcdC8vIFx0dGhpcy5hcHAud29ya3NwYWNlLm9uKFwiZmlsZS1vcGVuXCIsIChldikgPT4ge1xuXHRcdC8vIFx0XHRjb25zb2xlLmxvZyhcImZpbGUgb3BlbmVkOlwiKTtcblx0XHQvLyBcdFx0Ly8gY29uc29sZS5sb2coZXYpO1xuXHRcdC8vIFx0XHQvLyBjb25zb2xlLmxvZyhnZXRSZWZlcmVuY2VzKCkpO1xuXG5cdFx0Ly8gXHRcdGxldCBjdXJyZW50TGVhZjogYW55ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYWYoKTtcblxuXHRcdC8vIFx0XHQvLyBjaGVjayBpdCByZWZlcmVuY2VzIGhhdmUgYWxyZWFkeSBiZWVuIGNyZWF0ZWQsIGVsc2UgY3JlYXRlIHJlZmVyZW5jZXNcblx0XHQvLyBcdH0pXG5cdFx0Ly8gKTtcblxuXHRcdC8vIHRoaXMucmVnaXN0ZXJFdmVudChcblx0XHQvLyBcdHRoaXMuYXBwLndvcmtzcGFjZS5vbihcImxheW91dC1jaGFuZ2VcIiwgKCkgPT4ge1xuXHRcdC8vIFx0XHRjb25zb2xlLmxvZyhcImxheW91dC1jaGFuZ2VkOlwiKTtcblx0XHQvLyBcdH0pXG5cdFx0Ly8gKTtcblx0fVxuXG5cdG9udW5sb2FkKCkge31cbn1cbiIsICJpbXBvcnQge1xuXHRFZGl0b3JTdGF0ZSxcblx0U3RhdGVGaWVsZCxcblx0QW5ub3RhdGlvbixcblx0U3RhdGVFZmZlY3QsXG59IGZyb20gXCJAY29kZW1pcnJvci9zdGF0ZVwiO1xuaW1wb3J0IHsgQmFja2xpbmsgfSBmcm9tIFwiLi90eXBlc1wiO1xuaW1wb3J0IHsgdXBkYXRlQmFja2xpbmtNYXJrUG9zaXRpb25zIH0gZnJvbSBcIi4vcmVmZXJlbmNlc1wiO1xuaW1wb3J0IHsgQXBwIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5cbmV4cG9ydCBsZXQgdGhhdCA9IFN0YXRlRmllbGQuZGVmaW5lPEFwcCB8IG51bGw+KHtcblx0Y3JlYXRlKCkge1xuXHRcdHJldHVybiBudWxsO1xuXHR9LFxuXHR1cGRhdGUodmFsdWUsIHRyOiBhbnkpIHtcblx0XHRpZiAoXG5cdFx0XHR0cltcImFubm90YXRpb25zXCJdLmxlbmd0aCA9PSAyICYmXG5cdFx0XHR0cltcImFubm90YXRpb25zXCJdWzBdLnZhbHVlLnR5cGUgPT0gXCJ0aGF0XCJcblx0XHQpIHtcblx0XHRcdHJldHVybiB0cltcImFubm90YXRpb25zXCJdWzBdLnZhbHVlLnRoYXQuYXBwO1xuXHRcdH1cblx0XHRyZXR1cm4gdmFsdWU7XG5cdH0sXG59KTtcblxuZXhwb3J0IGxldCBob3ZlcmVkQ3Vyc29yID0gU3RhdGVGaWVsZC5kZWZpbmU8YW55Pih7XG5cdGNyZWF0ZSgpIHtcblx0XHRyZXR1cm4gbnVsbDtcblx0fSxcblx0dXBkYXRlKHZhbHVlLCB0cjogYW55KSB7XG5cdFx0aWYgKFxuXHRcdFx0dHJbXCJhbm5vdGF0aW9uc1wiXS5sZW5ndGggPT0gMiAmJlxuXHRcdFx0dHJbXCJhbm5vdGF0aW9uc1wiXVswXS52YWx1ZS50eXBlID09IFwiaG92ZXJlZEN1cnNvclwiXG5cdFx0KSB7XG5cdFx0XHRpZiAodmFsdWUpXG5cdFx0XHRcdHJldHVybiBbXG5cdFx0XHRcdFx0Li4udmFsdWUuZmlsdGVyKFxuXHRcdFx0XHRcdFx0KGN1cnNvcjogYW55KSA9PiBjdXJzb3IudXNlciAhPSB0cltcImFubm90YXRpb25zXCJdWzBdLnZhbHVlLnVzZXJcblx0XHRcdFx0XHQpLFxuXHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdGN1cnNvcjogdHJbXCJhbm5vdGF0aW9uc1wiXVswXS52YWx1ZS5jdXJzb3IsXG5cdFx0XHRcdFx0XHR1c2VyOiB0cltcImFubm90YXRpb25zXCJdWzBdLnZhbHVlLnVzZXIsXG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XTtcblx0XHRcdHJldHVybiBbXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRjdXJzb3I6IHRyW1wiYW5ub3RhdGlvbnNcIl1bMF0udmFsdWUuY3Vyc29yLFxuXHRcdFx0XHRcdHVzZXI6IHRyW1wiYW5ub3RhdGlvbnNcIl1bMF0udmFsdWUudXNlcixcblx0XHRcdFx0fSxcblx0XHRcdF07XG5cdFx0fSBlbHNlIGlmIChcblx0XHRcdHRyW1wiYW5ub3RhdGlvbnNcIl0ubGVuZ3RoID09IDIgJiZcblx0XHRcdHRyW1wiYW5ub3RhdGlvbnNcIl1bMF0udmFsdWUudHlwZSA9PSBcInJlbW92ZUhvdmVyZWRDdXJzb3JcIlxuXHRcdCkge1xuXHRcdFx0aWYgKHZhbHVlKVxuXHRcdFx0XHRyZXR1cm4gdmFsdWUuZmlsdGVyKFxuXHRcdFx0XHRcdChjdXJzb3I6IGFueSkgPT4gY3Vyc29yLnVzZXIgIT0gdHJbXCJhbm5vdGF0aW9uc1wiXVswXS52YWx1ZS51c2VyXG5cdFx0XHRcdCk7XG5cdFx0XHRyZXR1cm4gdmFsdWU7XG5cdFx0fVxuXHRcdHJldHVybiB2YWx1ZTtcblx0fSxcbn0pO1xuXG5leHBvcnQgbGV0IGJhY2tsaW5rcyA9IFN0YXRlRmllbGQuZGVmaW5lPEJhY2tsaW5rW10+KHtcblx0Y3JlYXRlKCkge1xuXHRcdHJldHVybiBbXTtcblx0fSxcblx0dXBkYXRlKHZhbHVlLCB0cikge1xuXHRcdC8qXG5cdFx0XHRJICB3YW50IHRvIGdldCB0aGUgY3VycmVudCBhY3RpdmVMZWFmIGFuZCByZWNvbXB1dGUgdGhlIHJlZmVyZW5jZXNcblx0XHRcdG1lcmdlIHRoaXMgaW50byB0aGUgcmVmZXJlbmNlcyBmaWVsZFxuXHRcdCovXG5cblx0XHRpZiAodHIuZWZmZWN0cy5sZW5ndGggPiAwKSB7XG5cdFx0XHR0cnkge1xuXHRcdFx0XHRsZXQgZGF0YTogeyB0eXBlOiBzdHJpbmc7IGJhY2tsaW5rczogQmFja2xpbmtbXSB9ID0gSlNPTi5wYXJzZShcblx0XHRcdFx0XHR0ci5lZmZlY3RzWzBdLnZhbHVlXG5cdFx0XHRcdCk7XG5cdFx0XHRcdGlmIChkYXRhLnR5cGUgPT0gXCJiYWNrbGlua1wiKSB7XG5cdFx0XHRcdFx0aWYgKGRhdGEuYmFja2xpbmtzLmxlbmd0aCA9PSAwKSByZXR1cm4gdmFsdWU7XG5cdFx0XHRcdFx0bGV0IHJlZmVyZW5jaW5nTG9jYXRpb24gPVxuXHRcdFx0XHRcdFx0ZGF0YS5iYWNrbGlua3NbMF1bXCJyZWZlcmVuY2luZ0xvY2F0aW9uXCJdW1wiZmlsZW5hbWVcIl07XG5cdFx0XHRcdFx0bGV0IGZpbHRlcmVkVmFsdWVzID0gdmFsdWUuZmlsdGVyKFxuXHRcdFx0XHRcdFx0KGJhY2tsaW5rKSA9PlxuXHRcdFx0XHRcdFx0XHRiYWNrbGluay5yZWZlcmVuY2luZ0xvY2F0aW9uLmZpbGVuYW1lICE9IHJlZmVyZW5jaW5nTG9jYXRpb25cblx0XHRcdFx0XHQpO1xuXHRcdFx0XHRcdHJldHVybiBbLi4uZmlsdGVyZWRWYWx1ZXMsIC4uLmRhdGEuYmFja2xpbmtzXTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gdmFsdWU7XG5cdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKGUpO1xuXHRcdFx0XHRyZXR1cm4gdmFsdWU7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiB2YWx1ZTtcblx0fSxcbn0pO1xuXG5leHBvcnQgbGV0IGhvdmVyRWxlbWVudCA9IFN0YXRlRmllbGQuZGVmaW5lPG9iamVjdCB8IG51bGw+KHtcblx0Y3JlYXRlKCkge1xuXHRcdHJldHVybiBudWxsO1xuXHR9LFxuXHR1cGRhdGUodmFsdWUsIHRyKSB7XG5cdFx0aWYgKHRyLmVmZmVjdHMubGVuZ3RoID4gMCkge1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0bGV0IGRhdGEgPSBKU09OLnBhcnNlKHRyLmVmZmVjdHNbMF0udmFsdWUpO1xuXHRcdFx0XHRpZiAoZGF0YS50eXBlID09IFwiaG92ZXItc3RhcnRcIikge1xuXHRcdFx0XHRcdHJldHVybiBPYmplY3QuYXNzaWduKHt9LCBkYXRhKTtcblx0XHRcdFx0fSBlbHNlIGlmIChkYXRhLnR5cGUgPT0gXCJob3ZlclwiKSB7XG5cdFx0XHRcdFx0aWYgKHZhbHVlKSByZXR1cm4gT2JqZWN0LmFzc2lnbih2YWx1ZSwgZGF0YSk7XG5cdFx0XHRcdFx0cmV0dXJuIGRhdGE7XG5cdFx0XHRcdH0gZWxzZSBpZiAoZGF0YS50eXBlID09IFwiaG92ZXItb2ZmXCIpIHtcblx0XHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gdmFsdWU7XG5cdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKGUpO1xuXHRcdFx0XHRyZXR1cm4gdmFsdWU7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiB2YWx1ZTtcblx0fSxcbn0pO1xuXG5leHBvcnQgbGV0IGJhY2tsaW5rSG92ZXJFbGVtZW50ID0gU3RhdGVGaWVsZC5kZWZpbmU8b2JqZWN0IHwgbnVsbD4oe1xuXHRjcmVhdGUoKSB7XG5cdFx0cmV0dXJuIG51bGw7XG5cdH0sXG5cdHVwZGF0ZSh2YWx1ZSwgdHIpIHtcblx0XHRpZiAodHIuZWZmZWN0cy5sZW5ndGggPiAwKSB7XG5cdFx0XHR0cnkge1xuXHRcdFx0XHRsZXQgZGF0YSA9IEpTT04ucGFyc2UodHIuZWZmZWN0c1swXS52YWx1ZSk7XG5cdFx0XHRcdGlmIChkYXRhLnR5cGUgPT0gXCJiYWNrbGluay1zdGFydFwiKSB7XG5cdFx0XHRcdFx0cmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIGRhdGEpO1xuXHRcdFx0XHR9IGVsc2UgaWYgKGRhdGEudHlwZSA9PSBcImJhY2tsaW5rLXVwZGF0ZVwiKSB7XG5cdFx0XHRcdFx0aWYgKHZhbHVlKSByZXR1cm4gT2JqZWN0LmFzc2lnbih2YWx1ZSwgZGF0YSk7XG5cdFx0XHRcdFx0cmV0dXJuIGRhdGE7XG5cdFx0XHRcdH0gZWxzZSBpZiAoZGF0YS50eXBlID09IFwiYmFja2xpbmstb2ZmXCIpIHtcblx0XHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gdmFsdWU7XG5cdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKGUpO1xuXHRcdFx0XHRyZXR1cm4gdmFsdWU7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiB2YWx1ZTtcblx0fSxcbn0pO1xuXG5leHBvcnQgbGV0IGN1cnNvckVsZW1lbnQgPSBTdGF0ZUZpZWxkLmRlZmluZTxvYmplY3QgfCBudWxsPih7XG5cdGNyZWF0ZSgpIHtcblx0XHRyZXR1cm4gbnVsbDtcblx0fSxcblx0dXBkYXRlKHZhbHVlLCB0cikge1xuXHRcdGlmICh0ci5lZmZlY3RzLmxlbmd0aCA+IDApIHtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdGxldCBkYXRhID0gSlNPTi5wYXJzZSh0ci5lZmZlY3RzWzBdLnZhbHVlKTtcblx0XHRcdFx0aWYgKGRhdGEudHlwZSA9PSBcImN1cnNvci1zdGFydFwiKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHt9O1xuXHRcdFx0XHR9IGVsc2UgaWYgKGRhdGEudHlwZSA9PSBcImN1cnNvclwiKSB7XG5cdFx0XHRcdFx0aWYgKHZhbHVlKSByZXR1cm4gT2JqZWN0LmFzc2lnbih2YWx1ZSwgZGF0YSk7XG5cdFx0XHRcdFx0cmV0dXJuIGRhdGE7XG5cdFx0XHRcdH0gZWxzZSBpZiAoZGF0YS50eXBlID09IFwiY3Vyc29yLW9mZlwiKSB7XG5cdFx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIHZhbHVlO1xuXHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRjb25zb2xlLmxvZyhlKTtcblx0XHRcdFx0cmV0dXJuIHZhbHVlO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gdmFsdWU7XG5cdH0sXG59KTtcblxuZXhwb3J0IGxldCBlZGl0b3JDaGFuZ2UgPSBTdGF0ZUZpZWxkLmRlZmluZTxudWxsPih7XG5cdGNyZWF0ZSgpIHtcblx0XHRyZXR1cm4gbnVsbDtcblx0fSxcblx0dXBkYXRlKHZhbHVlLCB0cikge1xuXHRcdGlmICh0ci5lZmZlY3RzLmxlbmd0aCA+IDApIHtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdGxldCBkYXRhID0gSlNPTi5wYXJzZSh0ci5lZmZlY3RzWzBdLnZhbHVlKTtcblx0XHRcdFx0aWYgKGRhdGEudHlwZSA9PSBcInN5bmNcIikge1xuXHRcdFx0XHRcdC8vIHVwZGF0ZUJhY2tsaW5rTWFya1Bvc2l0aW9ucygpO1xuXHRcdFx0XHRcdHJldHVybiB2YWx1ZTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gdmFsdWU7XG5cdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKGUpO1xuXHRcdFx0XHRyZXR1cm4gdmFsdWU7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiB2YWx1ZTtcblx0fSxcbn0pO1xuXG5leHBvcnQgY29uc3QgdGhhdEFubm90YXRpb24gPSBBbm5vdGF0aW9uLmRlZmluZTxhbnk+KCk7XG5leHBvcnQgY29uc3QgaG92ZXJlZEN1cnNvckFubm90YXRpb24gPSBBbm5vdGF0aW9uLmRlZmluZTxhbnk+KCk7XG5leHBvcnQgY29uc3QgaG92ZXJFZmZlY3QgPSBTdGF0ZUVmZmVjdC5kZWZpbmU8c3RyaW5nPigpO1xuZXhwb3J0IGNvbnN0IGJhY2tsaW5rSG92ZXJFZmZlY3QgPSBTdGF0ZUVmZmVjdC5kZWZpbmU8c3RyaW5nPigpO1xuZXhwb3J0IGNvbnN0IGN1cnNvckVmZmVjdCA9IFN0YXRlRWZmZWN0LmRlZmluZTxzdHJpbmc+KCk7XG5leHBvcnQgY29uc3QgYmFja2xpbmtFZmZlY3QgPSBTdGF0ZUVmZmVjdC5kZWZpbmU8c3RyaW5nPigpO1xuXG5leHBvcnQgbGV0IHN0YXRlOiBhbnkgPSBFZGl0b3JTdGF0ZS5jcmVhdGUoe1xuXHRleHRlbnNpb25zOiBbXG5cdFx0dGhhdCxcblx0XHRob3ZlcmVkQ3Vyc29yLFxuXHRcdGJhY2tsaW5rcyxcblx0XHRob3ZlckVsZW1lbnQsXG5cdFx0YmFja2xpbmtIb3ZlckVsZW1lbnQsXG5cdFx0Y3Vyc29yRWxlbWVudCxcblx0XHRlZGl0b3JDaGFuZ2UsXG5cdF0sXG59KTtcblxuZXhwb3J0IGZ1bmN0aW9uIHN5bmNCYWNrbGlua3MoKSB7XG5cdHN0YXRlID0gc3RhdGUudXBkYXRlKHtcblx0XHRlZmZlY3RzOiBiYWNrbGlua0VmZmVjdC5vZihKU09OLnN0cmluZ2lmeSh7IHR5cGU6IFwic3luY1wiIH0pKSxcblx0fSkuc3RhdGU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRUaGF0KCk6IEFwcCB7XG5cdHJldHVybiBzdGF0ZS5maWVsZCh0aGF0KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZVRoYXQodGhhdDogYW55KSB7XG5cdHN0YXRlID0gc3RhdGUudXBkYXRlKHtcblx0XHRhbm5vdGF0aW9uczogdGhhdEFubm90YXRpb24ub2Yoe1xuXHRcdFx0dHlwZTogXCJ0aGF0XCIsXG5cdFx0XHR0aGF0LFxuXHRcdH0pLFxuXHR9KS5zdGF0ZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEhvdmVyZWRDdXJzb3IoKSB7XG5cdHJldHVybiBzdGF0ZS5maWVsZChob3ZlcmVkQ3Vyc29yKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZUhvdmVyZWRDdXJzb3IoY3Vyc29yOiBIVE1MT3JTVkdFbGVtZW50LCB1c2VyOiBzdHJpbmcpIHtcblx0c3RhdGUgPSBzdGF0ZS51cGRhdGUoe1xuXHRcdGFubm90YXRpb25zOiBob3ZlcmVkQ3Vyc29yQW5ub3RhdGlvbi5vZih7XG5cdFx0XHR0eXBlOiBcImhvdmVyZWRDdXJzb3JcIixcblx0XHRcdGN1cnNvcixcblx0XHRcdHVzZXIsXG5cdFx0fSksXG5cdH0pLnN0YXRlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlSG92ZXJlZEN1cnNvcih1c2VyOiBzdHJpbmcpIHtcblx0c3RhdGUgPSBzdGF0ZS51cGRhdGUoe1xuXHRcdGFubm90YXRpb25zOiBob3ZlcmVkQ3Vyc29yQW5ub3RhdGlvbi5vZih7XG5cdFx0XHR0eXBlOiBcInJlbW92ZUhvdmVyZWRDdXJzb3JcIixcblx0XHRcdHVzZXIsXG5cdFx0fSksXG5cdH0pLnN0YXRlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0SG92ZXIoKSB7XG5cdHJldHVybiBzdGF0ZS5maWVsZChob3ZlckVsZW1lbnQpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlSG92ZXIodmFsdWU6IG9iamVjdCkge1xuXHRzdGF0ZSA9IHN0YXRlLnVwZGF0ZSh7XG5cdFx0ZWZmZWN0czogaG92ZXJFZmZlY3Qub2YoXG5cdFx0XHRKU09OLnN0cmluZ2lmeShPYmplY3QuYXNzaWduKHZhbHVlLCB7IHR5cGU6IFwiaG92ZXJcIiB9KSlcblx0XHQpLFxuXHR9KS5zdGF0ZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlc2V0SG92ZXIoKSB7XG5cdHN0YXRlID0gc3RhdGUudXBkYXRlKHtcblx0XHRlZmZlY3RzOiBob3ZlckVmZmVjdC5vZihcblx0XHRcdEpTT04uc3RyaW5naWZ5KHtcblx0XHRcdFx0dHlwZTogXCJob3Zlci1vZmZcIixcblx0XHRcdH0pXG5cdFx0KSxcblx0fSkuc3RhdGU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRCYWNrbGlua0hvdmVyKCkge1xuXHRyZXR1cm4gc3RhdGUuZmllbGQoYmFja2xpbmtIb3ZlckVsZW1lbnQpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlQmFja2xpbmtIb3Zlcih2YWx1ZTogb2JqZWN0KSB7XG5cdHN0YXRlID0gc3RhdGUudXBkYXRlKHtcblx0XHRlZmZlY3RzOiBiYWNrbGlua0hvdmVyRWZmZWN0Lm9mKFxuXHRcdFx0SlNPTi5zdHJpbmdpZnkoT2JqZWN0LmFzc2lnbih2YWx1ZSwgeyB0eXBlOiBcImJhY2tsaW5rLXVwZGF0ZVwiIH0pKVxuXHRcdCksXG5cdH0pLnN0YXRlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVzZXRCYWNrbGlua0hvdmVyKCkge1xuXHRzdGF0ZSA9IHN0YXRlLnVwZGF0ZSh7XG5cdFx0ZWZmZWN0czogYmFja2xpbmtIb3ZlckVmZmVjdC5vZihcblx0XHRcdEpTT04uc3RyaW5naWZ5KHtcblx0XHRcdFx0dHlwZTogXCJiYWNrbGluay1vZmZcIixcblx0XHRcdH0pXG5cdFx0KSxcblx0fSkuc3RhdGU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDdXJzb3IoKSB7XG5cdHJldHVybiBzdGF0ZS5maWVsZChjdXJzb3JFbGVtZW50KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZUN1cnNvcih2YWx1ZTogb2JqZWN0KSB7XG5cdHN0YXRlID0gc3RhdGUudXBkYXRlKHtcblx0XHRlZmZlY3RzOiBjdXJzb3JFZmZlY3Qub2YoXG5cdFx0XHRKU09OLnN0cmluZ2lmeShPYmplY3QuYXNzaWduKHZhbHVlLCB7IHR5cGU6IFwiY3Vyc29yXCIgfSkpXG5cdFx0KSxcblx0fSkuc3RhdGU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZXNldEN1cnNvcigpIHtcblx0c3RhdGUgPSBzdGF0ZS51cGRhdGUoe1xuXHRcdGVmZmVjdHM6IGN1cnNvckVmZmVjdC5vZihcblx0XHRcdEpTT04uc3RyaW5naWZ5KHtcblx0XHRcdFx0dHlwZTogXCJjdXJzb3Itb2ZmXCIsXG5cdFx0XHR9KVxuXHRcdCksXG5cdH0pLnN0YXRlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0QmFja2xpbmtzKCk6IEJhY2tsaW5rW10ge1xuXHRyZXR1cm4gc3RhdGUuZmllbGQoYmFja2xpbmtzKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZUJhY2tsaW5rcyh2YWx1ZTogQmFja2xpbmtbXSkge1xuXHRzdGF0ZSA9IHN0YXRlLnVwZGF0ZSh7XG5cdFx0ZWZmZWN0czogYmFja2xpbmtFZmZlY3Qub2YoXG5cdFx0XHRKU09OLnN0cmluZ2lmeShPYmplY3QuYXNzaWduKHsgYmFja2xpbmtzOiB2YWx1ZSB9LCB7IHR5cGU6IFwiYmFja2xpbmtcIiB9KSlcblx0XHQpLFxuXHR9KS5zdGF0ZTtcbn1cbiIsICJpbXBvcnQge1xuXHRFZGl0b3JWaWV3LFxuXHRXaWRnZXRUeXBlLFxuXHREZWNvcmF0aW9uLFxuXHREZWNvcmF0aW9uU2V0LFxuXHRWaWV3UGx1Z2luLFxuXHRWaWV3VXBkYXRlLFxuXHRNYXRjaERlY29yYXRvcixcblx0Z3V0dGVyLFxuXHRHdXR0ZXJNYXJrZXIsXG59IGZyb20gXCJAY29kZW1pcnJvci92aWV3XCI7XG5pbXBvcnQgeyBTVkdfSE9WRVJfQ09MT1IgfSBmcm9tIFwiLi4vY29uc3RhbnRzXCI7XG5cbi8qIGhpZ2hsaWdodCAqL1xuY2xhc3MgSGlnaGxpZ2h0ZXJXaWRnZXQgZXh0ZW5kcyBXaWRnZXRUeXBlIHtcblx0Y29uc3RydWN0b3IocHJpdmF0ZSBuYW1lOiBzdHJpbmcsIHByaXZhdGUgdmlldzogRWRpdG9yVmlldykge1xuXHRcdHN1cGVyKCk7XG5cdH1cblxuXHRlcShvdGhlcjogSGlnaGxpZ2h0ZXJXaWRnZXQpIHtcblx0XHRyZXR1cm4gdGhpcy5uYW1lID09PSBvdGhlci5uYW1lO1xuXHR9XG5cblx0dG9ET00oKSB7XG5cdFx0Y29uc3Qgc3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJmcmFnbWVudFwiKTtcblx0XHRzcGFuLnRleHRDb250ZW50ID0gdGhpcy5uYW1lO1xuXHRcdHNwYW4uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gU1ZHX0hPVkVSX0NPTE9SO1xuXHRcdHNwYW4uc3R5bGUuY29sb3IgPSBcImJsYWNrXCI7XG5cblx0XHRyZXR1cm4gc3Bhbjtcblx0fVxufVxuXG5jb25zdCBoaWdobGlnaHRlckRlY29yYXRpb24gPSAobWF0Y2g6IFJlZ0V4cEV4ZWNBcnJheSwgdmlldzogRWRpdG9yVmlldykgPT5cblx0RGVjb3JhdGlvbi5yZXBsYWNlKHtcblx0XHR3aWRnZXQ6IG5ldyBIaWdobGlnaHRlcldpZGdldChtYXRjaFsxXSwgdmlldyksXG5cdH0pO1xuXG5jb25zdCBoaWdobGlnaHRNYXRjaGVyID0gbmV3IE1hdGNoRGVjb3JhdG9yKHtcblx0cmVnZXhwOiAvXFwrXFwrXFwrKC4qPylcXCtcXCtcXCsvZyxcblx0ZGVjb3JhdGlvbjogKG1hdGNoLCB2aWV3LCBwb3MpID0+IHtcblx0XHRyZXR1cm4gaGlnaGxpZ2h0ZXJEZWNvcmF0aW9uKG1hdGNoLCB2aWV3KTtcblx0fSxcbn0pO1xuXG5leHBvcnQgY29uc3QgaGlnaGxpZ2h0cyA9IFZpZXdQbHVnaW4uZnJvbUNsYXNzKFxuXHRjbGFzcyB7XG5cdFx0aGlnaGxpZ2h0czogRGVjb3JhdGlvblNldDtcblx0XHRjb25zdHJ1Y3Rvcih2aWV3OiBFZGl0b3JWaWV3KSB7XG5cdFx0XHR0aGlzLmhpZ2hsaWdodHMgPSBoaWdobGlnaHRNYXRjaGVyLmNyZWF0ZURlY28odmlldyk7XG5cdFx0fVxuXHRcdHVwZGF0ZSh1cGRhdGU6IFZpZXdVcGRhdGUpIHtcblx0XHRcdHRoaXMuaGlnaGxpZ2h0cyA9IGhpZ2hsaWdodE1hdGNoZXIudXBkYXRlRGVjbyh1cGRhdGUsIHRoaXMuaGlnaGxpZ2h0cyk7XG5cdFx0fVxuXHRcdGRlc3Ryb3koKSB7XG5cdFx0XHR0aGlzLmhpZ2hsaWdodHMgPSBEZWNvcmF0aW9uLm5vbmU7XG5cdFx0fVxuXHR9LFxuXHR7XG5cdFx0ZGVjb3JhdGlvbnM6IChpbnN0YW5jZSkgPT4gaW5zdGFuY2UuaGlnaGxpZ2h0cyxcblx0XHRwcm92aWRlOiAocGx1Z2luKSA9PlxuXHRcdFx0RWRpdG9yVmlldy5hdG9taWNSYW5nZXMub2YoKHZpZXcpID0+IHtcblx0XHRcdFx0cmV0dXJuIHZpZXcucGx1Z2luKHBsdWdpbik/LmhpZ2hsaWdodHMgfHwgRGVjb3JhdGlvbi5ub25lO1xuXHRcdFx0fSksXG5cdH1cbik7XG4iLCAiZXhwb3J0IGxldCBSRUZFUkVOQ0VfUkVHRVggPSAvXFxbXFx1MjE5N1xcXVxcKHVybjooW14pXSopXFwpL2c7XG5cbmV4cG9ydCBsZXQgQUNUSU9OX1RZUEUgPSB7XG5cdE1PVVNFOiBcIm1vdXNlXCIsXG5cdENVUlNPUjogXCJjdXJzb3JcIixcblx0QkFDS0xJTks6IFwiYmFja2xpbmtcIixcbn07XG5cbmV4cG9ydCBsZXQgU1ZHX0hPVkVSX0NPTE9SID0gXCJyZ2IoMTg3LCAyMTUsIDIzMClcIjtcbmV4cG9ydCBsZXQgU1ZHX0hPVkVSX0NPTE9SX0xJR0hUID0gXCJyZ2IoMTg3LCAyMTUsIDIzMCwgMC41KVwiO1xuZXhwb3J0IGxldCBTVkdfQ09MT1IgPSBcInJnYigyMTUsIDIzNSwgMClcIjtcblxuZXhwb3J0IGNvbnN0IFJFRkVSRU5DRV9JQ09OX0hFSUdIVCA9IDIwO1xuXG5leHBvcnQgY29uc3QgUE9SVEFMX1RFWFRfU0xJQ0VfU0laRSA9IDEwMDtcbiIsICJpbXBvcnQge1xuXHRFZGl0b3JWaWV3LFxuXHRXaWRnZXRUeXBlLFxuXHREZWNvcmF0aW9uLFxuXHREZWNvcmF0aW9uU2V0LFxuXHRWaWV3UGx1Z2luLFxuXHRWaWV3VXBkYXRlLFxuXHRNYXRjaERlY29yYXRvcixcblx0Z3V0dGVyLFxuXHRHdXR0ZXJNYXJrZXIsXG59IGZyb20gXCJAY29kZW1pcnJvci92aWV3XCI7XG5cbmltcG9ydCB7XG5cdG9wZW5SZWZlcmVuY2UsXG5cdGNyZWF0ZVJlZmVyZW5jZUljb24sXG5cdHVwZGF0ZUJhY2tsaW5rTWFya1Bvc2l0aW9ucyxcbn0gZnJvbSBcIi4uL3JlZmVyZW5jZXNcIjtcbmltcG9ydCB7IGRlY29kZVVSSUNvbXBvbmVudFN0cmluZywgZW5jb2RlVVJJQ29tcG9uZW50U3RyaW5nIH0gZnJvbSBcInNyYy91dGlsc1wiO1xuaW1wb3J0IHsgZ2V0VGhhdCB9IGZyb20gXCJzcmMvc3RhdGVcIjtcbmltcG9ydCB7IEVkaXRvciwgTWFya2Rvd25WaWV3IH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyByZW1vdmVIaWdobGlnaHQgfSBmcm9tIFwic3JjL21hcmtcIjtcbmltcG9ydCB7IGNvbGxlY3RMZWF2ZXNCeVRhYkhlbHBlciB9IGZyb20gXCJzcmMvd29ya3NwYWNlXCI7XG5pbXBvcnQgeyBnZXRFZGl0b3JWaWV3IH0gZnJvbSBcInNyYy9lZmZlY3RzXCI7XG5cbmZ1bmN0aW9uIHByb2Nlc3NMaW5lKGxpbmU6IEVsZW1lbnQpIHtcblx0bGV0IGxpbmVDb3B5ID0gbGluZT8uY2xvbmVOb2RlKHRydWUpIGFzIEhUTUxFbGVtZW50O1xuXHRsaW5lQ29weT8ucXVlcnlTZWxlY3RvckFsbChcIi5yZWZlcmVuY2Utc3BhblwiKS5mb3JFYWNoKChzcGFuKSA9PiB7XG5cdFx0c3Bhbi5pbm5lckhUTUwgPSBcIlx1MjE5N1wiO1xuXHR9KTtcblxuXHRyZXR1cm4gbGluZUNvcHk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRSZWZlcmVuY2VQb3NpdGlvbihcblx0dmlldzogRWRpdG9yVmlldyxcblx0Y3VyckxpbmU6IEhUTUxTcGFuRWxlbWVudCxcblx0cmVmZXJlbmNlOiBzdHJpbmcsXG5cdGNvbnRlbnQ6IHN0cmluZ1xuKSB7XG5cdGxldCBsaW5lcyA9IHZpZXcuY29udGVudERPTS5xdWVyeVNlbGVjdG9yQWxsKFwiLmNtLWxpbmVcIik7XG5cdC8vIGxldCBjdXJyTGluZSA9IHJlZmVyZW5jZVNwYW4/LnBhcmVudEVsZW1lbnQ/LnBhcmVudEVsZW1lbnQ7XG5cblx0Ly8gZ2V0IHRoZSBpbmRleCBvZiB0aGUgYWN0aXZlTGluZVxuXHRsZXQgYWN0aXZlTGluZUluZGV4O1xuXHRsZXQgc2VlbkFjdGl2ZSA9IGZhbHNlO1xuXHRsaW5lcy5mb3JFYWNoKChsaW5lLCBpKSA9PiB7XG5cdFx0aWYgKHNlZW5BY3RpdmUpIHJldHVybjtcblx0XHRpZiAobGluZSA9PSBjdXJyTGluZSkge1xuXHRcdFx0c2VlbkFjdGl2ZSA9IHRydWU7XG5cdFx0XHRhY3RpdmVMaW5lSW5kZXggPSBpO1xuXHRcdH1cblx0fSk7XG5cblx0Y29uc29sZS5sb2coY3VyckxpbmUpO1xuXG5cdC8vIGNvbnN0IGVkaXRvcjogRWRpdG9yIHwgdW5kZWZpbmVkID1cblx0Ly8gXHRnZXRUaGF0KCkud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KT8uZWRpdG9yO1xuXHQvLyBpZiAoIWVkaXRvcikgcmV0dXJuO1xuXHQvLyBjb25zdCBjdXJzb3IgPSBlZGl0b3IuZ2V0Q3Vyc29yKCk7XG5cdC8vIGNvbnNvbGUubG9nKGN1cnNvcik7XG5cdC8vIGNvbnNvbGUubG9nKGFjdGl2ZUxpbmVJbmRleCk7XG5cblx0aWYgKGFjdGl2ZUxpbmVJbmRleCA9PT0gdW5kZWZpbmVkKSByZXR1cm47XG5cdGxldCBhY3RpdmVMaW5lID0gbGluZXNbYWN0aXZlTGluZUluZGV4XTtcblx0Ly8gbWFrZSBjb3B5IG9mIGFjdGl2ZUxpbmUgZWxlbWVudFxuXHRsZXQgYWN0aXZlTGluZUNvcHkgPSBwcm9jZXNzTGluZShhY3RpdmVMaW5lKTtcblx0Ly8gbm9uLXJlZmVyZW5jZWQgcGFydHMgb2YgdGhlIHRleHRcblx0bGV0IHBhcnRzID0gYWN0aXZlTGluZUNvcHkuaW5uZXJUZXh0LnNwbGl0KFwiXHUyMTk3XCIpO1xuXG5cdC8vIGdldCBhbGwgcmVmZXJlbmNlc1xuXHRsZXQgbGluZVJlZmVyZW5jZXMgPSBhY3RpdmVMaW5lPy5xdWVyeVNlbGVjdG9yQWxsKFwiLnJlZmVyZW5jZS1kYXRhLXNwYW5cIik7XG5cblx0Ly8gZ2V0IHRoZSBmdWxsIHNlcmlhbGl6ZWQgdmVyc2lvbiBmb3IgdGhlc2UgcmVmZXJlbmNlc1xuXHRsZXQgbGluZVJlZmVyZW5jZXNEYXRhID0gQXJyYXkuZnJvbShsaW5lUmVmZXJlbmNlcyB8fCBbXSkubWFwKFxuXHRcdChzcGFuKSA9PiBcIltcdTIxOTddKHVybjpcIiArIHNwYW4uZ2V0QXR0cmlidXRlKFwiZGF0YVwiKSArIFwiKVwiXG5cdCk7XG5cblx0aWYgKCFjb250ZW50KSB0aHJvdyBuZXcgRXJyb3IoXCJSZWZlcmVuY2Ugbm90IGZvdW5kXCIpO1xuXHRsZXQgaW5kZXg6IG51bWJlciB8IG51bGwgPSBudWxsO1xuXHRsaW5lUmVmZXJlbmNlc0RhdGEuZm9yRWFjaCgocmVmZXJlbmNlLCBpKSA9PiB7XG5cdFx0aWYgKCFpbmRleCkge1xuXHRcdFx0aWYgKHJlZmVyZW5jZS5pbmNsdWRlcyhjb250ZW50KSkge1xuXHRcdFx0XHRpbmRleCA9IGk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9KTtcblxuXHQvLyBjb25zdCBpbmRleCA9IGxpbmVSZWZlcmVuY2VzRGF0YS5yZWR1Y2UoXG5cdC8vIFx0KHByZXZJbmRleCwgY3VycmVudFZhbHVlLCBjdXJyZW50SW5kZXgpID0+IHtcblx0Ly8gXHRcdGlmIChjdXJyZW50VmFsdWUuaW5jbHVkZXMoY29udGVudFswXSkpIHtcblx0Ly8gXHRcdFx0cmV0dXJuIGN1cnJlbnRJbmRleDtcblx0Ly8gXHRcdH1cblx0Ly8gXHRcdHJldHVybiBwcmV2SW5kZXg7XG5cdC8vIFx0fSxcblx0Ly8gXHRudWxsXG5cdC8vICk7XG5cblx0aWYgKCFpbmRleCAmJiBpbmRleCAhPSAwKSB0aHJvdyBuZXcgRXJyb3IoXCJSZWZlcmVuY2Ugbm90IGZvdW5kXCIpO1xuXG5cdC8vIGdldCB0aGUgdGV4dCBiZWZvcmUgdGhlIHJlZmVyZW5jZVxuXHRsZXQgc3RhcnRUZXh0ID0gW1xuXHRcdC4uLnBhcnRzLnNsaWNlKDAsIGluZGV4ICsgMSksXG5cdFx0Li4ubGluZVJlZmVyZW5jZXNEYXRhLnNsaWNlKDAsIGluZGV4KSxcblx0XTtcblxuXHQvLyBnZXQgYWxsIHRoZSBwcmlvciBsaW5lcyB0byBhY3RpdmUgbGluZSBhbmQgdGhlIGxlbmd0aCBvZiB0aGUgdGV4dFxuXHRsZXQgcHJldkxpbmVDaGFyQ291bnQgPSBBcnJheS5mcm9tKGxpbmVzKVxuXHRcdC5zbGljZSgwLCBhY3RpdmVMaW5lSW5kZXgpXG5cdFx0LnJlZHVjZSgoYWNjLCBsaW5lKSA9PiB7XG5cdFx0XHRsZXQgcHJvY2Vzc2VkTGluZSA9IHByb2Nlc3NMaW5lKGxpbmUpO1xuXHRcdFx0bGV0IHBhcnRzID0gcHJvY2Vzc2VkTGluZS5pbm5lclRleHQuc3BsaXQoXCJcdTIxOTdcIik7XG5cblx0XHRcdGxldCBsaW5lUmVmZXJlbmNlcyA9IGxpbmU/LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucmVmZXJlbmNlLWRhdGEtc3BhblwiKTtcblx0XHRcdGxldCBsaW5lUmVmZXJlbmNlc0RhdGEgPSBBcnJheS5mcm9tKGxpbmVSZWZlcmVuY2VzIHx8IFtdKS5tYXAoXG5cdFx0XHRcdChzcGFuKSA9PiBcIltcdTIxOTddKHVybjpcIiArIHNwYW4uZ2V0QXR0cmlidXRlKFwiZGF0YVwiKSArIFwiKVwiXG5cdFx0XHQpO1xuXHRcdFx0bGV0IGFsbFNlcmlhbGl6ZWRUZXh0ID0gWy4uLnBhcnRzLCAuLi5saW5lUmVmZXJlbmNlc0RhdGFdLmpvaW4oXCJcIikgKyBcIlxcblwiO1xuXHRcdFx0cmV0dXJuIGFsbFNlcmlhbGl6ZWRUZXh0Lmxlbmd0aCArIGFjYztcblx0XHR9LCAwKTtcblxuXHQvLyBzZXQgcmFuZ2UgdG8gcmVwbGFjZSB3aXRoIG5ldyByZWZlcmVuY2Ugc2VyaWFsaXphdGlvblxuXHRsZXQgZnJvbSA9IHByZXZMaW5lQ2hhckNvdW50ICsgc3RhcnRUZXh0LmpvaW4oXCJcIikubGVuZ3RoO1xuXHRsZXQgdG8gPSBmcm9tICsgcmVmZXJlbmNlLmxlbmd0aDtcblx0cmV0dXJuIHsgZnJvbSwgdG8gfTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNlcmlhbGl6ZVJlZmVyZW5jZShcblx0Y29udGVudDogYW55LFxuXHRyZWZlcmVuY2VTcGFuOiBIVE1MRWxlbWVudCxcblx0dmlldzogRWRpdG9yVmlldyxcblx0dG9nZ2xlVmFsdWU6IHN0cmluZyB8IG51bGwgPSBudWxsXG4pIHtcblx0Y29udGVudCA9IHR5cGVvZiBjb250ZW50ID09IFwic3RyaW5nXCIgPyBjb250ZW50IDogY29udGVudFsxXTtcblxuXHRjb25zdCBbcHJlZml4LCB0ZXh0LCBzdWZmaXgsIGZpbGUsIGZyb20sIHRvLCBwb3J0YWwsIHRvZ2dsZV0gPVxuXHRcdGNvbnRlbnQuc3BsaXQoXCI6XCIpO1xuXHQvLyBTZXJpYWxpemUgdGhlIHRvZ2dsZSBzdGF0ZSBmb3IgcmVmZXJlbmNlIGludG8gZmlsZVxuXHQvLyBLTk9XTiBFUlJPUi4gY29udGVudERPTSBvbmx5IHJldHVybnMgcGFydGlhbCBmaWxlIGZvciBlZmZpY2llbmN5IG9uIGxhcmdlIGRvY3VtZW50cy4gU28gd2lsbCBsb3NlIHNlcmlhbGl6YXRpb24gaW4gdGhpcyBjYXNlLlxuXHQvLyByZWZlcmVuY2VTcGFuLmNsYXNzTGlzdC50b2dnbGUoXCJyZWZlcmVuY2Utc3Bhbi1oaWRkZW5cIik7XG5cblx0Ly8gbGV0IG5ld1RvZ2dsZSA9IHJlZmVyZW5jZVNwYW4uY2xhc3NMaXN0LmNvbnRhaW5zKFwicmVmZXJlbmNlLXNwYW4taGlkZGVuXCIpXG5cdC8vIFx0PyBcImZcIlxuXHQvLyBcdDogXCJ0XCI7XG5cdGxldCBuZXdUb2dnbGUgPSB0b2dnbGVWYWx1ZSA/IHRvZ2dsZVZhbHVlIDogdG9nZ2xlID09PSBcImZcIiA/IFwidFwiIDogXCJmXCI7XG5cdGxldCByZWZlcmVuY2UgPSBgW1x1MjE5N10odXJuOiR7cHJlZml4fToke3RleHR9OiR7c3VmZml4fToke2ZpbGV9OiR7ZnJvbX06JHt0b306JHtwb3J0YWx9OiR7bmV3VG9nZ2xlfSlgO1xuXG5cdGxldCBjdXJyTGluZSA9IHJlZmVyZW5jZVNwYW4/LnBhcmVudEVsZW1lbnQ/LnBhcmVudEVsZW1lbnQ7XG5cblx0Y29uc3QgcmVzdWx0cyA9IGdldFJlZmVyZW5jZVBvc2l0aW9uKFxuXHRcdHZpZXcsXG5cdFx0Y3VyckxpbmUgYXMgSFRNTEVsZW1lbnQsXG5cdFx0cmVmZXJlbmNlLFxuXHRcdHRleHRcblx0KTtcblx0aWYgKHJlc3VsdHMpIHtcblx0XHRjb25zdCB7IGZyb206IHRyYW5zYWN0aW9uRnJvbSwgdG86IHRyYW5zYWN0aW9uVG8gfSA9IHJlc3VsdHM7XG5cdFx0Y29uc3QgdHJhbnNhY3Rpb24gPSB2aWV3LnN0YXRlLnVwZGF0ZSh7XG5cdFx0XHRjaGFuZ2VzOiB7IGZyb206IHRyYW5zYWN0aW9uRnJvbSwgdG86IHRyYW5zYWN0aW9uVG8sIGluc2VydDogcmVmZXJlbmNlIH0sXG5cdFx0fSk7XG5cdFx0dmlldy5kaXNwYXRjaCh0cmFuc2FjdGlvbik7XG5cdFx0YXdhaXQgdXBkYXRlQmFja2xpbmtNYXJrUG9zaXRpb25zKCk7XG5cdH1cblxuXHRyZXR1cm47XG5cblx0Ly8gLy8gcmVmZXJlbmNlU3Bhbi5jbGFzc0xpc3QudG9nZ2xlKFwicmVmZXJlbmNlLXNwYW4taGlkZGVuXCIsIG5ld1RvZ2dsZSA9PT0gXCJmXCIpO1xuXHQvLyBjb25zb2xlLmxvZyhcIm5ld1RvZ2dsZTogXCIgKyBuZXdUb2dnbGUpO1xuXG5cdC8vIGxldCBsaW5lcyA9IHZpZXcuY29udGVudERPTS5xdWVyeVNlbGVjdG9yQWxsKFwiLmNtLWxpbmVcIik7XG5cdC8vIGxldCBjdXJyTGluZSA9IHJlZmVyZW5jZVNwYW4/LnBhcmVudEVsZW1lbnQ/LnBhcmVudEVsZW1lbnQ7XG5cblx0Ly8gLy8gZ2V0IHRoZSBpbmRleCBvZiB0aGUgYWN0aXZlTGluZVxuXHQvLyBsZXQgYWN0aXZlTGluZUluZGV4O1xuXHQvLyBsZXQgc2VlbkFjdGl2ZSA9IGZhbHNlO1xuXHQvLyBsaW5lcy5mb3JFYWNoKChsaW5lLCBpKSA9PiB7XG5cdC8vIFx0aWYgKHNlZW5BY3RpdmUpIHJldHVybjtcblx0Ly8gXHRpZiAobGluZSA9PSBjdXJyTGluZSkge1xuXHQvLyBcdFx0c2VlbkFjdGl2ZSA9IHRydWU7XG5cdC8vIFx0XHRhY3RpdmVMaW5lSW5kZXggPSBpO1xuXHQvLyBcdH1cblx0Ly8gfSk7XG5cblx0Ly8gLy8gY29uc3QgZWRpdG9yOiBFZGl0b3IgfCB1bmRlZmluZWQgPVxuXHQvLyAvLyBcdGdldFRoYXQoKS53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpPy5lZGl0b3I7XG5cdC8vIC8vIGlmICghZWRpdG9yKSByZXR1cm47XG5cdC8vIC8vIGNvbnN0IGN1cnNvciA9IGVkaXRvci5nZXRDdXJzb3IoKTtcblx0Ly8gLy8gY29uc29sZS5sb2coY3Vyc29yKTtcblx0Ly8gLy8gY29uc29sZS5sb2coYWN0aXZlTGluZUluZGV4KTtcblxuXHQvLyBpZiAoYWN0aXZlTGluZUluZGV4ID09PSB1bmRlZmluZWQpIHJldHVybjtcblx0Ly8gbGV0IGFjdGl2ZUxpbmUgPSBsaW5lc1thY3RpdmVMaW5lSW5kZXhdO1xuXHQvLyAvLyBtYWtlIGNvcHkgb2YgYWN0aXZlTGluZSBlbGVtZW50XG5cdC8vIGxldCBhY3RpdmVMaW5lQ29weSA9IHByb2Nlc3NMaW5lKGFjdGl2ZUxpbmUpO1xuXHQvLyAvLyBub24tcmVmZXJlbmNlZCBwYXJ0cyBvZiB0aGUgdGV4dFxuXHQvLyBsZXQgcGFydHMgPSBhY3RpdmVMaW5lQ29weS5pbm5lclRleHQuc3BsaXQoXCJcdTIxOTdcIik7XG5cblx0Ly8gLy8gZ2V0IGFsbCByZWZlcmVuY2VzXG5cdC8vIGxldCBsaW5lUmVmZXJlbmNlcyA9IGFjdGl2ZUxpbmU/LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucmVmZXJlbmNlLWRhdGEtc3BhblwiKTtcblxuXHQvLyAvLyBnZXQgdGhlIGZ1bGwgc2VyaWFsaXplZCB2ZXJzaW9uIGZvciB0aGVzZSByZWZlcmVuY2VzXG5cdC8vIGxldCBsaW5lUmVmZXJlbmNlc0RhdGEgPSBBcnJheS5mcm9tKGxpbmVSZWZlcmVuY2VzIHx8IFtdKS5tYXAoXG5cdC8vIFx0KHNwYW4pID0+IFwiW1x1MjE5N10odXJuOlwiICsgc3Bhbi5nZXRBdHRyaWJ1dGUoXCJkYXRhXCIpICsgXCIpXCJcblx0Ly8gKTtcblxuXHQvLyBpZiAoY29udGVudCkge1xuXHQvLyBcdGxldCBpbmRleDogbnVtYmVyIHwgbnVsbCA9IG51bGw7XG5cdC8vIFx0bGluZVJlZmVyZW5jZXNEYXRhLmZvckVhY2goKHJlZmVyZW5jZSwgaSkgPT4ge1xuXHQvLyBcdFx0aWYgKCFpbmRleCkge1xuXHQvLyBcdFx0XHRpZiAocmVmZXJlbmNlLmluY2x1ZGVzKGNvbnRlbnQpKSB7XG5cdC8vIFx0XHRcdFx0aW5kZXggPSBpO1xuXHQvLyBcdFx0XHR9XG5cdC8vIFx0XHR9XG5cdC8vIFx0fSk7XG5cblx0Ly8gXHQvLyBjb25zdCBpbmRleCA9IGxpbmVSZWZlcmVuY2VzRGF0YS5yZWR1Y2UoXG5cdC8vIFx0Ly8gXHQocHJldkluZGV4LCBjdXJyZW50VmFsdWUsIGN1cnJlbnRJbmRleCkgPT4ge1xuXHQvLyBcdC8vIFx0XHRpZiAoY3VycmVudFZhbHVlLmluY2x1ZGVzKGNvbnRlbnRbMF0pKSB7XG5cdC8vIFx0Ly8gXHRcdFx0cmV0dXJuIGN1cnJlbnRJbmRleDtcblx0Ly8gXHQvLyBcdFx0fVxuXHQvLyBcdC8vIFx0XHRyZXR1cm4gcHJldkluZGV4O1xuXHQvLyBcdC8vIFx0fSxcblx0Ly8gXHQvLyBcdG51bGxcblx0Ly8gXHQvLyApO1xuXG5cdC8vIFx0aWYgKCFpbmRleCAmJiBpbmRleCAhPSAwKSB0aHJvdyBuZXcgRXJyb3IoXCJSZWZlcmVuY2Ugbm90IGZvdW5kXCIpO1xuXG5cdC8vIFx0Ly8gZ2V0IHRoZSB0ZXh0IGJlZm9yZSB0aGUgcmVmZXJlbmNlXG5cdC8vIFx0bGV0IHN0YXJ0VGV4dCA9IFtcblx0Ly8gXHRcdC4uLnBhcnRzLnNsaWNlKDAsIGluZGV4ICsgMSksXG5cdC8vIFx0XHQuLi5saW5lUmVmZXJlbmNlc0RhdGEuc2xpY2UoMCwgaW5kZXgpLFxuXHQvLyBcdF07XG5cblx0Ly8gXHQvLyBnZXQgYWxsIHRoZSBwcmlvciBsaW5lcyB0byBhY3RpdmUgbGluZSBhbmQgdGhlIGxlbmd0aCBvZiB0aGUgdGV4dFxuXHQvLyBcdGxldCBwcmV2TGluZUNoYXJDb3VudCA9IEFycmF5LmZyb20obGluZXMpXG5cdC8vIFx0XHQuc2xpY2UoMCwgYWN0aXZlTGluZUluZGV4KVxuXHQvLyBcdFx0LnJlZHVjZSgoYWNjLCBsaW5lKSA9PiB7XG5cdC8vIFx0XHRcdGxldCBwcm9jZXNzZWRMaW5lID0gcHJvY2Vzc0xpbmUobGluZSk7XG5cdC8vIFx0XHRcdGxldCBwYXJ0cyA9IHByb2Nlc3NlZExpbmUuaW5uZXJUZXh0LnNwbGl0KFwiXHUyMTk3XCIpO1xuXG5cdC8vIFx0XHRcdGxldCBsaW5lUmVmZXJlbmNlcyA9IGxpbmU/LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucmVmZXJlbmNlLWRhdGEtc3BhblwiKTtcblx0Ly8gXHRcdFx0bGV0IGxpbmVSZWZlcmVuY2VzRGF0YSA9IEFycmF5LmZyb20obGluZVJlZmVyZW5jZXMgfHwgW10pLm1hcChcblx0Ly8gXHRcdFx0XHQoc3BhbikgPT4gXCJbXHUyMTk3XSh1cm46XCIgKyBzcGFuLmdldEF0dHJpYnV0ZShcImRhdGFcIikgKyBcIilcIlxuXHQvLyBcdFx0XHQpO1xuXHQvLyBcdFx0XHRsZXQgYWxsU2VyaWFsaXplZFRleHQgPVxuXHQvLyBcdFx0XHRcdFsuLi5wYXJ0cywgLi4ubGluZVJlZmVyZW5jZXNEYXRhXS5qb2luKFwiXCIpICsgXCJcXG5cIjtcblx0Ly8gXHRcdFx0cmV0dXJuIGFsbFNlcmlhbGl6ZWRUZXh0Lmxlbmd0aCArIGFjYztcblx0Ly8gXHRcdH0sIDApO1xuXG5cdC8vIFx0Ly8gc2V0IHJhbmdlIHRvIHJlcGxhY2Ugd2l0aCBuZXcgcmVmZXJlbmNlIHNlcmlhbGl6YXRpb25cblx0Ly8gXHRsZXQgZnJvbSA9IHByZXZMaW5lQ2hhckNvdW50ICsgc3RhcnRUZXh0LmpvaW4oXCJcIikubGVuZ3RoO1xuXHQvLyBcdGxldCB0byA9IGZyb20gKyByZWZlcmVuY2UubGVuZ3RoO1xuXG5cdC8vIFx0Y29uc3QgdHJhbnNhY3Rpb24gPSB2aWV3LnN0YXRlLnVwZGF0ZSh7XG5cdC8vIFx0XHRjaGFuZ2VzOiB7IGZyb20sIHRvLCBpbnNlcnQ6IHJlZmVyZW5jZSB9LFxuXHQvLyBcdH0pO1xuXHQvLyBcdGNvbnNvbGUubG9nKHRyYW5zYWN0aW9uKTtcblx0Ly8gXHR2aWV3LmRpc3BhdGNoKHRyYW5zYWN0aW9uKTtcblx0Ly8gXHRhd2FpdCB1cGRhdGVCYWNrbGlua01hcmtQb3NpdGlvbnMoKTtcblxuXHQvLyBcdC8vIGF3YWl0IHRoaXMudXBkYXRlTmFtZShyZWZlcmVuY2UsIGZyb20sIHRvKTtcblx0Ly8gfVxufVxuXG4vKiBuZXcgcGxhY2Vob2xkZXIgKi9cbmNsYXNzIFJlZmVyZW5jZVdpZGdldCBleHRlbmRzIFdpZGdldFR5cGUge1xuXHRjb25zdHJ1Y3Rvcihcblx0XHRwcml2YXRlIG5hbWU6IHN0cmluZyxcblx0XHRwcml2YXRlIHZpZXc6IEVkaXRvclZpZXcsXG5cdFx0cHJpdmF0ZSBwb3M6IG51bWJlcixcblx0XHRwcml2YXRlIHJlZmVyZW5jZVNwYW46IEVsZW1lbnQgfCBudWxsID0gbnVsbCxcblx0XHRwcml2YXRlIHBhcmVudEVsZW1lbnQ6IEhUTUxFbGVtZW50IHwgbnVsbCB8IHVuZGVmaW5lZCA9IG51bGxcblx0KSB7XG5cdFx0c3VwZXIoKTtcblx0fVxuXG5cdGVxKG90aGVyOiBSZWZlcmVuY2VXaWRnZXQpIHtcblx0XHRyZXR1cm4gdGhpcy5uYW1lID09PSBvdGhlci5uYW1lO1xuXHR9XG5cblx0YXN5bmMgdXBkYXRlTmFtZShuYW1lOiBzdHJpbmcsIGZyb206IG51bWJlciwgdG86IG51bWJlcikge1xuXHRcdC8vIGNvbnN0IHRyYW5zYWN0aW9uID0gdGhpcy52aWV3LnN0YXRlLnVwZGF0ZSh7XG5cdFx0Ly8gXHRjaGFuZ2VzOiB7IGZyb20sIHRvLCBpbnNlcnQ6IG5hbWUgfSxcblx0XHQvLyB9KTtcblx0XHQvLyB0aGlzLnZpZXcuZGlzcGF0Y2godHJhbnNhY3Rpb24pO1xuXHRcdC8vIGF3YWl0IHVwZGF0ZUJhY2tsaW5rTWFya1Bvc2l0aW9ucygpO1xuXHRcdHRoaXMubmFtZSA9IG5hbWU7XG5cdH1cblxuXHRnZXRWaWV3KCkge1xuXHRcdHJldHVybiB0aGlzLnZpZXc7XG5cdH1cblxuXHRkZXN0cm95KCkge1xuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0Y29uc29sZS5sb2coXCJyZW1vdmUgaGlnaGxpZ2h0XCIpO1xuXHRcdFx0Y29uc29sZS5sb2codGhpcy5uYW1lKTtcblx0XHRcdGNvbnNvbGUubG9nKHRoaXMucG9zKTtcblx0XHRcdGNvbnNvbGUubG9nKHRoaXMudmlldyk7XG5cdFx0XHRjb25zb2xlLmxvZyh0aGlzLnJlZmVyZW5jZVNwYW4pO1xuXHRcdFx0Y29uc29sZS5sb2codGhpcy5wYXJlbnRFbGVtZW50KTtcblx0XHRcdGNvbnN0IHJlZ2V4ID0gL1xcW1x1MjE5N1xcXVxcKHVybjooW14pXSopXFwpL2c7XG5cdFx0XHRsZXQgY29udGVudCA9IHJlZ2V4LmV4ZWModGhpcy5uYW1lKTtcblx0XHRcdGlmICghY29udGVudCkgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCByZWZlcmVuY2VcIik7XG5cblx0XHRcdGNvbnN0IFtwcmVmaXgsIHRleHQsIHN1ZmZpeCwgZmlsZSwgZnJvbSwgdG8sIHBvcnRhbCwgdG9nZ2xlID0gXCJmXCJdID1cblx0XHRcdFx0Y29udGVudFsxXS5zcGxpdChcIjpcIik7XG5cblx0XHRcdGxldCBkZWNvZGVkRmlsZSA9IGRlY29kZVVSSUNvbXBvbmVudFN0cmluZyhmaWxlKTtcblx0XHRcdC8vIGNvbnN0IGxlYXZlcyA9IGdldFRoYXQoKS53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFwibWFya2Rvd25cIik7XG5cdFx0XHRsZXQgbGVhdmVzQnlUYWIgPSBjb2xsZWN0TGVhdmVzQnlUYWJIZWxwZXIoKTtcblx0XHRcdGxldCBsZWFmID0gbGVhdmVzQnlUYWIuZmxhdCgpLmZpbHRlcigobGVhZikgPT4ge1xuXHRcdFx0XHRyZXR1cm4gbGVhZi5nZXRWaWV3U3RhdGUoKS5zdGF0ZS5maWxlID09IGRlY29kZWRGaWxlO1xuXHRcdFx0fSlbMF07XG5cdFx0XHRsZXQgdmlldyA9IGdldEVkaXRvclZpZXcobGVhZik7XG5cblx0XHRcdGNvbnN0IHJlc3VsdHMgPSBnZXRSZWZlcmVuY2VQb3NpdGlvbihcblx0XHRcdFx0dmlldyxcblx0XHRcdFx0dGhpcy5wYXJlbnRFbGVtZW50IGFzIEhUTUxTcGFuRWxlbWVudCxcblx0XHRcdFx0dGhpcy5uYW1lLFxuXHRcdFx0XHR0ZXh0XG5cdFx0XHQpO1xuXHRcdFx0aWYgKCFyZXN1bHRzKSByZXR1cm47XG5cdFx0XHRjb25zb2xlLmxvZyh2aWV3KTtcblx0XHRcdHJlbW92ZUhpZ2hsaWdodCh2aWV3LCByZXN1bHRzLmZyb20sIHJlc3VsdHMudG8pO1xuXHRcdH0sIDEwKTtcblx0fVxuXG5cdHRvRE9NKCkge1xuXHRcdGNvbnN0IHJlZ2V4ID0gL1xcW1x1MjE5N1xcXVxcKHVybjooW14pXSopXFwpL2c7XG5cdFx0bGV0IGNvbnRlbnQgPSByZWdleC5leGVjKHRoaXMubmFtZSk7XG5cdFx0aWYgKCFjb250ZW50KSB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIHJlZmVyZW5jZVwiKTtcblxuXHRcdGNvbnN0IFtwcmVmaXgsIHRleHQsIHN1ZmZpeCwgZmlsZSwgZnJvbSwgdG8sIHBvcnRhbCwgdG9nZ2xlID0gXCJmXCJdID1cblx0XHRcdGNvbnRlbnRbMV0uc3BsaXQoXCI6XCIpO1xuXG5cdFx0Ly8gaGlnaGxpZ2h0RGVmYXVsdFNlbGVjdGlvbih0aGlzLnZpZXcsIHBhcnNlRmxvYXQoZnJvbSksIHBhcnNlRmxvYXQodG8pKTtcblxuXHRcdGNvbnN0IHsgc3Bhbiwgc3ZnIH0gPSBjcmVhdGVSZWZlcmVuY2VJY29uKFxuXHRcdFx0cG9ydGFsID09IFwicG9ydGFsXCIgPyBcImlubGluZSByZWZlcmVuY2Ugd2lkZ2V0IHwqfFwiIDogbnVsbFxuXHRcdCk7XG5cblx0XHRpZiAoY29udGVudCkgc3Bhbi5zZXRBdHRyaWJ1dGUoXCJkYXRhXCIsIGNvbnRlbnRbMV0pO1xuXG5cdFx0Y29uc3QgY29udGFpbmVyU3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO1xuXHRcdGNvbnRhaW5lclNwYW4uY2xhc3NMaXN0LmFkZChcInJlZmVyZW5jZS1jb250YWluZXItc3BhblwiKTtcblx0XHRjb25zdCByZWZlcmVuY2VTcGFuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XG5cdFx0Ly8gYWRkIGNsYXNzXG5cdFx0cmVmZXJlbmNlU3Bhbi5jbGFzc0xpc3QuYWRkKFwicmVmZXJlbmNlLXNwYW5cIik7XG5cblx0XHRyZWZlcmVuY2VTcGFuLmlubmVySFRNTCA9IGRlY29kZVVSSUNvbXBvbmVudFN0cmluZyh0ZXh0KTtcblx0XHRyZWZlcmVuY2VTcGFuLmNsYXNzTGlzdC50b2dnbGUoXCJyZWZlcmVuY2Utc3Bhbi1oaWRkZW5cIiwgdG9nZ2xlID09PSBcImZcIik7XG5cblx0XHRjb250YWluZXJTcGFuLmFwcGVuZENoaWxkKHJlZmVyZW5jZVNwYW4pO1xuXHRcdGNvbnRhaW5lclNwYW4uYXBwZW5kQ2hpbGQoc3Bhbik7XG5cblx0XHR0aGlzLnJlZmVyZW5jZVNwYW4gPSByZWZlcmVuY2VTcGFuO1xuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0dGhpcy5wYXJlbnRFbGVtZW50ID0gY29udGFpbmVyU3Bhbi5wYXJlbnRFbGVtZW50O1xuXHRcdH0sIDIwKTtcblxuXHRcdGNvbnRhaW5lclNwYW4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGFzeW5jIChldikgPT4ge1xuXHRcdFx0aWYgKGV2Lm1ldGFLZXkgfHwgZXYuY3RybEtleSkge1xuXHRcdFx0XHRhd2FpdCBzZXJpYWxpemVSZWZlcmVuY2UoY29udGVudCwgcmVmZXJlbmNlU3BhbiwgdGhpcy52aWV3KTtcblx0XHRcdFx0Ly8gcmVmZXJlbmNlU3Bhbi5cblx0XHRcdFx0cmVmZXJlbmNlU3Bhbi5jbGFzc0xpc3QudG9nZ2xlKFwicmVmZXJlbmNlLXNwYW4taGlkZGVuXCIpO1xuXHRcdFx0XHRpZiAoY29udGVudCkgdGhpcy5uYW1lID0gY29udGVudFswXTtcblx0XHRcdFx0aWYgKHJlZmVyZW5jZVNwYW4pIHtcblx0XHRcdFx0XHR0aGlzLnJlZmVyZW5jZVNwYW4gPSByZWZlcmVuY2VTcGFuO1xuXHRcdFx0XHRcdHRoaXMucGFyZW50RWxlbWVudCA9IHJlZmVyZW5jZVNwYW4/LnBhcmVudEVsZW1lbnQ/LnBhcmVudEVsZW1lbnQ7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyAvLyBTZXJpYWxpemUgdGhlIHRvZ2dsZSBzdGF0ZSBmb3IgcmVmZXJlbmNlIGludG8gZmlsZVxuXHRcdFx0XHQvLyAvLyBLTk9XTiBFUlJPUi4gY29udGVudERPTSBvbmx5IHJldHVybnMgcGFydGlhbCBmaWxlIGZvciBlZmZpY2llbmN5IG9uIGxhcmdlIGRvY3VtZW50cy4gU28gd2lsbCBsb3NlIHNlcmlhbGl6YXRpb24gaW4gdGhpcyBjYXNlLlxuXHRcdFx0XHQvLyByZWZlcmVuY2VTcGFuLmNsYXNzTGlzdC50b2dnbGUoXCJyZWZlcmVuY2Utc3Bhbi1oaWRkZW5cIik7XG5cblx0XHRcdFx0Ly8gbGV0IG5ld1RvZ2dsZSA9IHJlZmVyZW5jZVNwYW4uY2xhc3NMaXN0LmNvbnRhaW5zKFxuXHRcdFx0XHQvLyBcdFwicmVmZXJlbmNlLXNwYW4taGlkZGVuXCJcblx0XHRcdFx0Ly8gKVxuXHRcdFx0XHQvLyBcdD8gXCJmXCJcblx0XHRcdFx0Ly8gXHQ6IFwidFwiO1xuXHRcdFx0XHQvLyBsZXQgcmVmZXJlbmNlID0gYFtcdTIxOTddKHVybjoke3ByZWZpeH06JHt0ZXh0fToke3N1ZmZpeH06JHtmaWxlfToke2Zyb219OiR7dG99OiR7cG9ydGFsfToke25ld1RvZ2dsZX0pYDtcblxuXHRcdFx0XHQvLyBsZXQgbGluZXMgPSB0aGlzLmdldFZpZXcoKS5jb250ZW50RE9NLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY20tbGluZVwiKTtcblxuXHRcdFx0XHQvLyAvLyBnZXQgdGhlIGluZGV4IG9mIHRoZSBhY3RpdmVMaW5lXG5cdFx0XHRcdC8vIGxldCBhY3RpdmVMaW5lSW5kZXg7XG5cdFx0XHRcdC8vIGxldCBzZWVuQWN0aXZlID0gZmFsc2U7XG5cdFx0XHRcdC8vIGxpbmVzLmZvckVhY2goKGxpbmUsIGkpID0+IHtcblx0XHRcdFx0Ly8gXHRpZiAoc2VlbkFjdGl2ZSkgcmV0dXJuO1xuXHRcdFx0XHQvLyBcdGlmIChsaW5lLmNsYXNzTGlzdC5jb250YWlucyhcImNtLWFjdGl2ZVwiKSkge1xuXHRcdFx0XHQvLyBcdFx0c2VlbkFjdGl2ZSA9IHRydWU7XG5cdFx0XHRcdC8vIFx0XHRhY3RpdmVMaW5lSW5kZXggPSBpO1xuXHRcdFx0XHQvLyBcdH1cblx0XHRcdFx0Ly8gfSk7XG5cblx0XHRcdFx0Ly8gLy8gY29uc3QgZWRpdG9yOiBFZGl0b3IgfCB1bmRlZmluZWQgPVxuXHRcdFx0XHQvLyAvLyBcdGdldFRoYXQoKS53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpPy5lZGl0b3I7XG5cdFx0XHRcdC8vIC8vIGlmICghZWRpdG9yKSByZXR1cm47XG5cdFx0XHRcdC8vIC8vIGNvbnN0IGN1cnNvciA9IGVkaXRvci5nZXRDdXJzb3IoKTtcblx0XHRcdFx0Ly8gLy8gY29uc29sZS5sb2coY3Vyc29yKTtcblx0XHRcdFx0Ly8gLy8gY29uc29sZS5sb2coYWN0aXZlTGluZUluZGV4KTtcblxuXHRcdFx0XHQvLyBpZiAoYWN0aXZlTGluZUluZGV4ID09PSB1bmRlZmluZWQpIHJldHVybjtcblx0XHRcdFx0Ly8gbGV0IGFjdGl2ZUxpbmUgPSBsaW5lc1thY3RpdmVMaW5lSW5kZXhdO1xuXHRcdFx0XHQvLyAvLyBtYWtlIGNvcHkgb2YgYWN0aXZlTGluZSBlbGVtZW50XG5cdFx0XHRcdC8vIGxldCBhY3RpdmVMaW5lQ29weSA9IHByb2Nlc3NMaW5lKGFjdGl2ZUxpbmUpO1xuXHRcdFx0XHQvLyAvLyBub24tcmVmZXJlbmNlZCBwYXJ0cyBvZiB0aGUgdGV4dFxuXHRcdFx0XHQvLyBsZXQgcGFydHMgPSBhY3RpdmVMaW5lQ29weS5pbm5lclRleHQuc3BsaXQoXCJcdTIxOTdcIik7XG5cblx0XHRcdFx0Ly8gLy8gZ2V0IGFsbCByZWZlcmVuY2VzXG5cdFx0XHRcdC8vIGxldCBsaW5lUmVmZXJlbmNlcyA9IGFjdGl2ZUxpbmU/LnF1ZXJ5U2VsZWN0b3JBbGwoXG5cdFx0XHRcdC8vIFx0XCIucmVmZXJlbmNlLWRhdGEtc3BhblwiXG5cdFx0XHRcdC8vICk7XG5cblx0XHRcdFx0Ly8gLy8gZ2V0IHRoZSBmdWxsIHNlcmlhbGl6ZWQgdmVyc2lvbiBmb3IgdGhlc2UgcmVmZXJlbmNlc1xuXHRcdFx0XHQvLyBsZXQgbGluZVJlZmVyZW5jZXNEYXRhID0gQXJyYXkuZnJvbShsaW5lUmVmZXJlbmNlcyB8fCBbXSkubWFwKFxuXHRcdFx0XHQvLyBcdChzcGFuKSA9PiBcIltcdTIxOTddKHVybjpcIiArIHNwYW4uZ2V0QXR0cmlidXRlKFwiZGF0YVwiKSArIFwiKVwiXG5cdFx0XHRcdC8vICk7XG5cdFx0XHRcdC8vIGlmIChjb250ZW50ICYmIGNvbnRlbnRbMV0pIHtcblx0XHRcdFx0Ly8gXHQvLyBpZGVudGlmeSB3aGljaCByZWZlcmVuY2UgaXMgYmVpbmcgdG9nZ2xlZFxuXHRcdFx0XHQvLyBcdGxldCBpbmRleCA9IGxpbmVSZWZlcmVuY2VzRGF0YS5pbmRleE9mKGNvbnRlbnRbMF0pO1xuXHRcdFx0XHQvLyBcdGlmIChpbmRleCA9PSAtMSkgdGhyb3cgbmV3IEVycm9yKFwiUmVmZXJlbmNlIG5vdCBmb3VuZFwiKTtcblxuXHRcdFx0XHQvLyBcdC8vIGdldCB0aGUgdGV4dCBiZWZvcmUgdGhlIHJlZmVyZW5jZVxuXHRcdFx0XHQvLyBcdGxldCBzdGFydFRleHQgPSBbXG5cdFx0XHRcdC8vIFx0XHQuLi5wYXJ0cy5zbGljZSgwLCBpbmRleCArIDEpLFxuXHRcdFx0XHQvLyBcdFx0Li4ubGluZVJlZmVyZW5jZXNEYXRhLnNsaWNlKDAsIGluZGV4KSxcblx0XHRcdFx0Ly8gXHRdO1xuXG5cdFx0XHRcdC8vIFx0Ly8gZ2V0IGFsbCB0aGUgcHJpb3IgbGluZXMgdG8gYWN0aXZlIGxpbmUgYW5kIHRoZSBsZW5ndGggb2YgdGhlIHRleHRcblx0XHRcdFx0Ly8gXHRsZXQgcHJldkxpbmVDaGFyQ291bnQgPSBBcnJheS5mcm9tKGxpbmVzKVxuXHRcdFx0XHQvLyBcdFx0LnNsaWNlKDAsIGFjdGl2ZUxpbmVJbmRleClcblx0XHRcdFx0Ly8gXHRcdC5yZWR1Y2UoKGFjYywgbGluZSkgPT4ge1xuXHRcdFx0XHQvLyBcdFx0XHRsZXQgcHJvY2Vzc2VkTGluZSA9IHByb2Nlc3NMaW5lKGxpbmUpO1xuXHRcdFx0XHQvLyBcdFx0XHRsZXQgcGFydHMgPSBwcm9jZXNzZWRMaW5lLmlubmVyVGV4dC5zcGxpdChcIlx1MjE5N1wiKTtcblxuXHRcdFx0XHQvLyBcdFx0XHRsZXQgbGluZVJlZmVyZW5jZXMgPSBsaW5lPy5xdWVyeVNlbGVjdG9yQWxsKFxuXHRcdFx0XHQvLyBcdFx0XHRcdFwiLnJlZmVyZW5jZS1kYXRhLXNwYW5cIlxuXHRcdFx0XHQvLyBcdFx0XHQpO1xuXHRcdFx0XHQvLyBcdFx0XHRsZXQgbGluZVJlZmVyZW5jZXNEYXRhID0gQXJyYXkuZnJvbShsaW5lUmVmZXJlbmNlcyB8fCBbXSkubWFwKFxuXHRcdFx0XHQvLyBcdFx0XHRcdChzcGFuKSA9PiBcIltcdTIxOTddKHVybjpcIiArIHNwYW4uZ2V0QXR0cmlidXRlKFwiZGF0YVwiKSArIFwiKVwiXG5cdFx0XHRcdC8vIFx0XHRcdCk7XG5cdFx0XHRcdC8vIFx0XHRcdGxldCBhbGxTZXJpYWxpemVkVGV4dCA9XG5cdFx0XHRcdC8vIFx0XHRcdFx0Wy4uLnBhcnRzLCAuLi5saW5lUmVmZXJlbmNlc0RhdGFdLmpvaW4oXCJcIikgKyBcIlxcblwiO1xuXHRcdFx0XHQvLyBcdFx0XHRyZXR1cm4gYWxsU2VyaWFsaXplZFRleHQubGVuZ3RoICsgYWNjO1xuXHRcdFx0XHQvLyBcdFx0fSwgMCk7XG5cblx0XHRcdFx0Ly8gXHQvLyBzZXQgcmFuZ2UgdG8gcmVwbGFjZSB3aXRoIG5ldyByZWZlcmVuY2Ugc2VyaWFsaXphdGlvblxuXHRcdFx0XHQvLyBcdGxldCBmcm9tID0gcHJldkxpbmVDaGFyQ291bnQgKyBzdGFydFRleHQuam9pbihcIlwiKS5sZW5ndGg7XG5cdFx0XHRcdC8vIFx0bGV0IHRvID0gZnJvbSArIHJlZmVyZW5jZS5sZW5ndGg7XG5cblx0XHRcdFx0Ly8gXHRhd2FpdCB0aGlzLnVwZGF0ZU5hbWUocmVmZXJlbmNlLCBmcm9tLCB0byk7XG5cdFx0XHRcdC8vIH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG9wZW5SZWZlcmVuY2UoZXYpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0cmV0dXJuIGNvbnRhaW5lclNwYW47XG5cdH1cbn1cblxuY29uc3QgcmVmZXJlbmNlRGVjb3JhdGlvbiA9IChcblx0bWF0Y2g6IFJlZ0V4cEV4ZWNBcnJheSxcblx0dmlldzogRWRpdG9yVmlldyxcblx0cG9zOiBudW1iZXJcbikgPT4ge1xuXHRsZXQgZGVjb3JhdGlvbiA9IERlY29yYXRpb24ucmVwbGFjZSh7XG5cdFx0d2lkZ2V0OiBuZXcgUmVmZXJlbmNlV2lkZ2V0KG1hdGNoWzBdLCB2aWV3LCBwb3MpLFxuXHR9KTtcblx0cmV0dXJuIGRlY29yYXRpb247XG59O1xuXG5jb25zdCByZWZlcmVuY2VNYXRjaGVyID0gbmV3IE1hdGNoRGVjb3JhdG9yKHtcblx0Ly8gcmVnZXhwOiAvXFxbXFx1MjE5N1xcXVxcKHVybjpbXFxzXFxTXlxcKV0qXFwpL2csXG5cdC8vIHJlZ2V4cDogL1xcW1xcdTIxOTdcXF1cXCh1cm46KFteOl0qOil7NSw2fVteOl0qXFwpL2csXG5cdC8vIHJlZ2V4cDogL1xcW1xcdTIxOTdcXF1cXCh1cm46KFteOl0qOil7Nn1bXjopXSpcXCkvZyxcblx0cmVnZXhwOiAvXFxbXFx1MjE5N1xcXVxcKHVybjooW146XSo6KXs3fVteOildKlxcKS9nLFxuXHRkZWNvcmF0aW9uOiAobWF0Y2gsIHZpZXcsIHBvcykgPT4ge1xuXHRcdHJldHVybiByZWZlcmVuY2VEZWNvcmF0aW9uKG1hdGNoLCB2aWV3LCBwb3MpO1xuXHR9LFxufSk7XG5cbmV4cG9ydCBjb25zdCByZWZlcmVuY2VSZXNvdXJjZXMgPSBWaWV3UGx1Z2luLmZyb21DbGFzcyhcblx0Y2xhc3Mge1xuXHRcdHJlZmVyZW5jZVJlc291cmNlczogRGVjb3JhdGlvblNldDtcblx0XHRjb25zdHJ1Y3Rvcih2aWV3OiBFZGl0b3JWaWV3KSB7XG5cdFx0XHR0aGlzLnJlZmVyZW5jZVJlc291cmNlcyA9IHJlZmVyZW5jZU1hdGNoZXIuY3JlYXRlRGVjbyh2aWV3KTtcblx0XHR9XG5cdFx0dXBkYXRlKHVwZGF0ZTogVmlld1VwZGF0ZSkge1xuXHRcdFx0dGhpcy5yZWZlcmVuY2VSZXNvdXJjZXMgPSByZWZlcmVuY2VNYXRjaGVyLnVwZGF0ZURlY28oXG5cdFx0XHRcdHVwZGF0ZSxcblx0XHRcdFx0dGhpcy5yZWZlcmVuY2VSZXNvdXJjZXNcblx0XHRcdCk7XG5cdFx0fVxuXHRcdGRlc3Ryb3koKSB7XG5cdFx0XHR0aGlzLnJlZmVyZW5jZVJlc291cmNlcyA9IERlY29yYXRpb24ubm9uZTtcblx0XHR9XG5cdH0sXG5cdHtcblx0XHRkZWNvcmF0aW9uczogKGluc3RhbmNlKSA9PiBpbnN0YW5jZS5yZWZlcmVuY2VSZXNvdXJjZXMsXG5cdFx0cHJvdmlkZTogKHBsdWdpbikgPT5cblx0XHRcdEVkaXRvclZpZXcuYXRvbWljUmFuZ2VzLm9mKCh2aWV3KSA9PiB7XG5cdFx0XHRcdHJldHVybiB2aWV3LnBsdWdpbihwbHVnaW4pPy5yZWZlcmVuY2VSZXNvdXJjZXMgfHwgRGVjb3JhdGlvbi5ub25lO1xuXHRcdFx0fSksXG5cdH1cbik7XG4iLCAiaW1wb3J0IHsgRWRpdG9yLCBURmlsZSwgV29ya3NwYWNlTGVhZiwgTWFya2Rvd25WaWV3IH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBFZGl0b3JWaWV3LCBzY3JvbGxQYXN0RW5kIH0gZnJvbSBcIkBjb2RlbWlycm9yL3ZpZXdcIjtcbmltcG9ydCB7IHY1IGFzIHV1aWR2NSB9IGZyb20gXCJ1dWlkXCI7XG5cbmltcG9ydCB7XG5cdHN0YXRlLFxuXHR1cGRhdGVIb3Zlcixcblx0Z2V0VGhhdCxcblx0Z2V0QmFja2xpbmtzLFxuXHR1cGRhdGVCYWNrbGlua3MsXG5cdHVwZGF0ZUN1cnNvcixcblx0Z2V0Q3Vyc29yLFxuXHRnZXRIb3Zlcixcblx0cmVzZXRDdXJzb3IsXG5cdHVwZGF0ZUhvdmVyZWRDdXJzb3IsXG5cdHVwZGF0ZUJhY2tsaW5rSG92ZXIsXG5cdGdldEJhY2tsaW5rSG92ZXIsXG59IGZyb20gXCIuL3N0YXRlXCI7XG5pbXBvcnQge1xuXHRwcm9jZXNzVVJJLFxuXHRnZXRQcmVmaXhBbmRTdWZmaXgsXG5cdGhhbmRsZVJlbW92ZUhvdmVyZWRDdXJzb3IsXG5cdGVuY29kZVVSSUNvbXBvbmVudFN0cmluZyxcblx0ZGVjb2RlVVJJQ29tcG9uZW50U3RyaW5nLFxufSBmcm9tIFwiLi91dGlsc1wiO1xuaW1wb3J0IHtcblx0QUNUSU9OX1RZUEUsXG5cdFBPUlRBTF9URVhUX1NMSUNFX1NJWkUsXG5cdFJFRkVSRU5DRV9JQ09OX0hFSUdIVCxcblx0UkVGRVJFTkNFX1JFR0VYLFxuXHRTVkdfSE9WRVJfQ09MT1IsXG59IGZyb20gXCIuL2NvbnN0YW50c1wiO1xuaW1wb3J0IHsgRG9jdW1lbnRMb2NhdGlvbiwgQmFja2xpbmsgfSBmcm9tIFwiLi90eXBlc1wiO1xuaW1wb3J0IHsgdjQgYXMgdXVpZHY0IH0gZnJvbSBcInV1aWRcIjtcbmltcG9ydCB7IGRlZmF1bHRIaWdobGlnaHRTZWxlY3Rpb24gfSBmcm9tIFwiLi9tYXJrXCI7XG5pbXBvcnQgeyBkZWxheSB9IGZyb20gXCIuL2VmZmVjdHNcIjtcbmltcG9ydCB7IGdlbmVyYXRlRGVmYXVsdEhpZ2hsaWdodHMsIGhhbmRsZU1vdmVtZW50RWZmZWN0cyB9IGZyb20gXCIuL21haW5cIjtcblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVJlZmVyZW5jZUljb24ocG9ydGFsVGV4dDogc3RyaW5nIHwgbnVsbCA9IG51bGwpOiB7XG5cdHNwYW46IEhUTUxTcGFuRWxlbWVudDtcblx0c3ZnOiBTVkdFbGVtZW50O1xufSB7XG5cdGNvbnN0IHNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTtcblx0c3Bhbi5zdHlsZS5jdXJzb3IgPSBcInBvaW50ZXJcIjtcblx0c3Bhbi5jbGFzc0xpc3QuYWRkKFwicmVmZXJlbmNlLWRhdGEtc3BhblwiKTtcblx0c3Bhbi5jbGFzc0xpc3QuYWRkKFwidXVpZC1cIiArIHV1aWR2NCgpKTtcblxuXHRjb25zdCBoZWlnaHQgPSBSRUZFUkVOQ0VfSUNPTl9IRUlHSFQ7XG5cdGNvbnN0IHdpZHRoID0gaGVpZ2h0ICogMC45O1xuXG5cdGlmIChwb3J0YWxUZXh0ID09IG51bGwpIHtcblx0XHRjb25zdCBzdmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiLCBcInN2Z1wiKTtcblx0XHQvLyBzdmcuc2V0QXR0cmlidXRlKFwid2lkdGhcIiwgYCR7d2lkdGh9YCk7XG5cdFx0Ly8gc3ZnLnNldEF0dHJpYnV0ZShcImhlaWdodFwiLCBgJHtoZWlnaHR9YCk7XG5cdFx0Ly8gc3ZnLnNldEF0dHJpYnV0ZShcInZpZXdCb3hcIiwgYDAgMCAke3dpZHRofSAke2hlaWdodH1gKTtcblx0XHQvLyBzdmcuc2V0QXR0cmlidXRlKFwiZmlsbFwiLCBcIndoaXRlXCIpO1xuXHRcdC8vIHN2Zy5zZXRBdHRyaWJ1dGUoXCJ4bWxuc1wiLCBcImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIpO1xuXHRcdC8vIHN2Zy5zdHlsZS5ib3JkZXIgPSBcIjNweCBzb2xpZCBncmV5XCI7XG5cdFx0Ly8gc3ZnLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwid2hpdGVcIjtcblx0XHQvLyBzdmcuc3R5bGUuYm9yZGVyUmFkaXVzID0gXCIzcHhcIjtcblx0XHQvLyBzdmcuc3R5bGUuY3Vyc29yID0gXCJwb2ludGVyXCI7XG5cdFx0Ly8gc3ZnLmNsYXNzTGlzdC5hZGQoXCJyZWZlcmVuY2UtaWNvblwiKTtcblxuXHRcdC8vIGNvbnN0IGxpbmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiLCBcImxpbmVcIik7XG5cdFx0Ly8gbGluZS5zZXRBdHRyaWJ1dGUoXCJ4MVwiLCBcIjNcIik7XG5cdFx0Ly8gbGluZS5zZXRBdHRyaWJ1dGUoXCJ5MVwiLCBgJHsoaGVpZ2h0IC0gMykgLyAzfWApO1xuXHRcdC8vIGxpbmUuc2V0QXR0cmlidXRlKFwieDJcIiwgXCIxMlwiKTtcblx0XHQvLyBsaW5lLnNldEF0dHJpYnV0ZShcInkyXCIsIGAkeyhoZWlnaHQgLSAzKSAvIDN9YCk7XG5cdFx0Ly8gbGluZS5zZXRBdHRyaWJ1dGUoXCJzdHJva2Utd2lkdGhcIiwgXCIyXCIpOyAvLyBTZXQgdGhlIHN0cm9rZSB3ZWlnaHQgdG8gMVxuXHRcdC8vIGxpbmUuc2V0QXR0cmlidXRlKFwic3Ryb2tlXCIsIFwiZ3JleVwiKTsgLy8gU2V0IHRoZSBzdHJva2UgY29sb3IgdG8gYmxhY2tcblxuXHRcdC8vIHN2Zy5hcHBlbmRDaGlsZChsaW5lKTtcblxuXHRcdC8vIGNvbnN0IGxpbmUyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKFxuXHRcdC8vIFx0XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiLFxuXHRcdC8vIFx0XCJsaW5lXCJcblx0XHQvLyApO1xuXHRcdC8vIGxpbmUyLnNldEF0dHJpYnV0ZShcIngxXCIsIFwiM1wiKTtcblx0XHQvLyBsaW5lMi5zZXRBdHRyaWJ1dGUoXCJ5MVwiLCBgJHsoKGhlaWdodCAtIDMpIC8gMykgKiAyfWApO1xuXHRcdC8vIGxpbmUyLnNldEF0dHJpYnV0ZShcIngyXCIsIFwiMTVcIik7XG5cdFx0Ly8gbGluZTIuc2V0QXR0cmlidXRlKFwieTJcIiwgYCR7KChoZWlnaHQgLSAzKSAvIDMpICogMn1gKTtcblx0XHQvLyBsaW5lMi5zZXRBdHRyaWJ1dGUoXCJzdHJva2Utd2lkdGhcIiwgXCIyXCIpOyAvLyBTZXQgdGhlIHN0cm9rZSB3ZWlnaHQgdG8gMVxuXHRcdC8vIGxpbmUyLnNldEF0dHJpYnV0ZShcInN0cm9rZVwiLCBcImdyZXlcIik7IC8vIFNldCB0aGUgc3Ryb2tlIGNvbG9yIHRvIGJsYWNrXG5cblx0XHQvLyBzdmcuYXBwZW5kQ2hpbGQobGluZTIpO1xuXG5cdFx0Ly8gY29uc3QgbGluZTMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoXG5cdFx0Ly8gXHRcImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIsXG5cdFx0Ly8gXHRcImxpbmVcIlxuXHRcdC8vICk7XG5cdFx0Ly8gbGluZTMuc2V0QXR0cmlidXRlKFwieDFcIiwgXCIzXCIpO1xuXHRcdC8vIGxpbmUzLnNldEF0dHJpYnV0ZShcInkxXCIsIGAkeygoaGVpZ2h0IC0gMykgLyAzKSAqIDN9YCk7XG5cdFx0Ly8gbGluZTMuc2V0QXR0cmlidXRlKFwieDJcIiwgXCIxMFwiKTtcblx0XHQvLyBsaW5lMy5zZXRBdHRyaWJ1dGUoXCJ5MlwiLCBgJHsoKGhlaWdodCAtIDMpIC8gMykgKiAzfWApO1xuXHRcdC8vIGxpbmUzLnNldEF0dHJpYnV0ZShcInN0cm9rZS13aWR0aFwiLCBcIjJcIik7IC8vIFNldCB0aGUgc3Ryb2tlIHdlaWdodCB0byAxXG5cdFx0Ly8gbGluZTMuc2V0QXR0cmlidXRlKFwic3Ryb2tlXCIsIFwiZ3JleVwiKTsgLy8gU2V0IHRoZSBzdHJva2UgY29sb3IgdG8gYmxhY2tcblxuXHRcdC8vIHN2Zy5hcHBlbmRDaGlsZChsaW5lMyk7XG5cblx0XHQvLyBzcGFuLmFwcGVuZENoaWxkKHN2Zyk7XG5cdFx0cmV0dXJuIHsgc3Bhbjogc3Bhbiwgc3ZnIH07XG5cdH1cblxuXHRjb25zdCBzdmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiLCBcInN2Z1wiKTtcblx0Ly8gc3ZnLnNldEF0dHJpYnV0ZShcIndpZHRoXCIsIGAke3dpZHRofWApO1xuXHQvLyBzdmcuc2V0QXR0cmlidXRlKFwiaGVpZ2h0XCIsIGAke2hlaWdodH1gKTtcblx0Ly8gc3ZnLnNldEF0dHJpYnV0ZShcInZpZXdCb3hcIiwgYDAgMCAke3dpZHRofSAke2hlaWdodH1gKTtcblx0Ly8gc3ZnLnNldEF0dHJpYnV0ZShcImZpbGxcIiwgXCJ3aGl0ZVwiKTtcblx0Ly8gc3ZnLnNldEF0dHJpYnV0ZShcInhtbG5zXCIsIFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIik7XG5cdC8vIC8vIHN2Zy5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIndoaXRlXCI7XG5cdC8vIHN2Zy5jbGFzc0xpc3QuYWRkKFwicG9ydGFsLWljb25cIik7XG5cblx0Ly8gLy8gPHBhdGggZD1cIk00IDZIMTNNNCAxMEgxNE0zLjk5NjQzIDEuMDAwMzdDNy4wODUzIDAuOTk5OTIzIDExLjE2MTggMC45OTk4ODEgMTQuMDA0MyAxLjAwMDI1QzE1LjY2MDMgMS4wMDA0NiAxNyAyLjM0MzE1IDE3IDMuOTk5MjNWMTEuMzYwMUMxNyAxMi45OTUxIDE1LjY5MDkgMTQuMzI3NiAxNC4wNTYzIDE0LjM1ODJMNy4zNDMwMSAxNC40ODQyQzYuNzkxNjggMTQuNDk0NSA2LjI1Mzg3IDE0LjY1NjYgNS43ODg2NiAxNC45NTI3TDIuNTM2ODggMTcuMDIyQzEuODcxMTUgMTcuNDQ1NiAxIDE2Ljk2NzQgMSAxNi4xNzgzVjMuOTk5OTNDMSAyLjM0MzUxIDIuMzQwMDEgMS4wMDA2IDMuOTk2NDMgMS4wMDAzN1pcIiBzdHJva2U9XCJibGFja1wiIHN0cm9rZS13aWR0aD1cIjJcIi8+XG5cdC8vIGNvbnN0IHBhdGggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiLCBcInBhdGhcIik7XG5cdC8vIHBhdGguc2V0QXR0cmlidXRlKFxuXHQvLyBcdFwiZFwiLFxuXHQvLyBcdFwiTTQgNkgxM000IDEwSDE0TTMuOTk2NDMgMS4wMDAzN0M3LjA4NTMgMC45OTk5MjMgMTEuMTYxOCAwLjk5OTg4MSAxNC4wMDQzIDEuMDAwMjVDMTUuNjYwMyAxLjAwMDQ2IDE3IDIuMzQzMTUgMTcgMy45OTkyM1YxMS4zNjAxQzE3IDEyLjk5NTEgMTUuNjkwOSAxNC4zMjc2IDE0LjA1NjMgMTQuMzU4Mkw3LjM0MzAxIDE0LjQ4NDJDNi43OTE2OCAxNC40OTQ1IDYuMjUzODcgMTQuNjU2NiA1Ljc4ODY2IDE0Ljk1MjdMMi41MzY4OCAxNy4wMjJDMS44NzExNSAxNy40NDU2IDEgMTYuOTY3NCAxIDE2LjE3ODNWMy45OTk5M0MxIDIuMzQzNTEgMi4zNDAwMSAxLjAwMDYgMy45OTY0MyAxLjAwMDM3WlwiXG5cdC8vICk7XG5cdC8vIHBhdGguc2V0QXR0cmlidXRlKFwic3Ryb2tlXCIsIFwiZ3JheVwiKTtcblx0Ly8gcGF0aC5zZXRBdHRyaWJ1dGUoXCJzdHJva2Utd2lkdGhcIiwgXCIyXCIpO1xuXG5cdC8vIHNwYW4uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCJcIjtcblxuXHQvLyBzdmcuYXBwZW5kQ2hpbGQocGF0aCk7XG5cblx0Ly8gc3Bhbi5hcHBlbmRDaGlsZChzdmcpO1xuXG5cdGlmIChwb3J0YWxUZXh0ICE9IFwiaW5saW5lIHJlZmVyZW5jZSB3aWRnZXQgfCp8XCIpIHtcblx0XHRsZXQgcG9ydGFsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0XHQvLyBwb3J0YWwuc3R5bGUuY29sb3IgPSBcImJsYWNrXCI7XG5cdFx0cG9ydGFsLmNsYXNzTGlzdC5hZGQoXCJwb3J0YWxcIik7XG5cblx0XHRwb3J0YWxUZXh0LnNwbGl0KFwiOlwiKS5mb3JFYWNoKCh0ZXh0LCBpbmRleCkgPT4ge1xuXHRcdFx0aWYgKGluZGV4ID09PSAwIHx8IGluZGV4ID09PSAyKVxuXHRcdFx0XHRwb3J0YWwuaW5uZXJIVE1MICs9IGRlY29kZVVSSUNvbXBvbmVudFN0cmluZyh0ZXh0KTtcblx0XHRcdGVsc2UgaWYgKGluZGV4ID09PSAxKSB7XG5cdFx0XHRcdHBvcnRhbC5pbm5lckhUTUwgKz0gYDxzcGFuIGNsYXNzPVwidGV4dC1hY2NlbnRcIjs+JHt0ZXh0fTwvc3Bhbj5gO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0Ly8gc3Bhbi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIndoaXRlXCI7XG5cdFx0cG9ydGFsLnN0eWxlLnVzZXJTZWxlY3QgPSBcIm5vbmVcIjtcblx0XHRwb3J0YWwuc3R5bGUucG9pbnRlckV2ZW50cyA9IFwibm9uZVwiO1xuXHRcdHNwYW4uYXBwZW5kQ2hpbGQocG9ydGFsKTtcblx0fVxuXG5cdHJldHVybiB7IHNwYW46IHNwYW4sIHN2ZyB9O1xuXG5cdC8vIGxldCBuZXdTcGFuOiBIVE1MU3BhbkVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTtcblx0Ly8gbmV3U3Bhbi5pbm5lckhUTUwgPSBcIlx1RDgzRFx1RENDNFwiO1xuXHQvLyBuZXdTcGFuLnN0eWxlLmN1cnNvciA9IFwicG9pbnRlclwiO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlSG92ZXJlZEN1cnNvckNvbG9yKHNwYW46IEhUTUxTcGFuRWxlbWVudCwgdXNlcjogc3RyaW5nKSB7XG5cdC8vIHJlbW92ZSBleGlzdGluZyBjdXJzb3JzXG5cdGNvbnN0IHN2ZyA9IHNwYW4ucXVlcnlTZWxlY3RvcihcInN2Z1wiKTtcblx0Y29uc3QgcG9ydGFsOiBIVE1MRWxlbWVudCB8IG51bGwgPSBzcGFuLnF1ZXJ5U2VsZWN0b3IoXCIucG9ydGFsXCIpO1xuXG5cdGlmIChzcGFuICYmIHN2ZyAmJiAhcG9ydGFsKSB7XG5cdFx0aGFuZGxlUmVtb3ZlSG92ZXJlZEN1cnNvcih1c2VyKTsgLy8gcmVtb3ZlIGFueSBleGlzdGluZyBob3ZlcmVkIHJlZmVyZW5jZSBpY29uXG5cdFx0aWYgKHN2Zy5jbGFzc0xpc3QuY29udGFpbnMoXCJyZWZlcmVuY2UtaWNvblwiKSlcblx0XHRcdHN2Zy5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBTVkdfSE9WRVJfQ09MT1I7XG5cdFx0ZWxzZSB7XG5cdFx0XHQvLyBzdmcuc2V0QXR0cmlidXRlKFwiZmlsbFwiLCBTVkdfSE9WRVJfQ09MT1IpO1xuXHRcdFx0c3BhbiA9IHNwYW4ucXVlcnlTZWxlY3RvcihcInNwYW5cIikgYXMgSFRNTFNwYW5FbGVtZW50O1xuXHRcdFx0c3Bhbi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBTVkdfSE9WRVJfQ09MT1I7XG5cdFx0fVxuXG5cdFx0dXBkYXRlSG92ZXJlZEN1cnNvcihzdmcsIHVzZXIpOyAvLyBhZGQgdGhlIGN1cnJlbnRseSBob3ZlcmVkIHJlZmVyZW5jZSBpY29uXG5cdH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldENvZGVNaXJyb3JFZGl0b3JWaWV3KGVkaXRvcjogRWRpdG9yKTogRWRpdG9yVmlldyB7XG5cdC8vIEB0cy1pZ25vcmUgdGhpcyB0eXBlIGlzIG1pc3NpbmcuLi4gYnV0IHRoZSBPYnNpZGlhbiBkb2NzIHRlbGwgdXMgdG8gZG8gaXQgdGhpcyB3YXk/P1xuXHRyZXR1cm4gZWRpdG9yLmNtIGFzIEVkaXRvclZpZXc7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDb250YWluZXJFbGVtZW50KFxuXHRlZGl0b3JPckxlYWY6IEVkaXRvciB8IFdvcmtzcGFjZUxlYWZcbik6IEhUTUxFbGVtZW50IHtcblx0Ly8gQHRzLWlnbm9yZSBUT0RPOiBmaW5kIGEgYmV0dGVyIHdheSB0byBhY2Nlc3MgdGhpcy4uLiBFWFRSRU1FTFkgU0tFVENIWVxuXHRyZXR1cm4gZWRpdG9yT3JMZWFmLmNvbnRhaW5lckVsO1xufVxuXG5mdW5jdGlvbiBnZXRCYWNrbGlua0lEKGJhY2tsaW5rOiBCYWNrbGluayk6IHN0cmluZyB7XG5cdGNvbnN0IGpzb25TdHJpbmcgPSBKU09OLnN0cmluZ2lmeShiYWNrbGluayk7XG5cdGNvbnN0IGlkID0gdXVpZHY1KGpzb25TdHJpbmcsIFwiZmI4MTNlYmItMWI1My00MzA2LWFhOWMtNjU1NjI3NDQ3ZjBiXCIpO1xuXHRyZXR1cm4gYGJhY2tsaW5rLSR7aWR9YDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEJhY2tsaW5rQ29udGFpbmVyKGVkaXRvcjogRWRpdG9yKTogSFRNTEVsZW1lbnQge1xuXHRjb25zdCBjb250YWluZXJFbDogSFRNTEVsZW1lbnQgPSBnZXRDb250YWluZXJFbGVtZW50KGVkaXRvcik7XG5cdGNvbnN0IHJlZmVyZW5jZU1hcmtDb250YWluZXJJRCA9IFwicmVmZXJlbmNlTWFya0NvbnRhaW5lclwiO1xuXHRjb25zdCBjb250YWluZXIgPSBjb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKGAjJHtyZWZlcmVuY2VNYXJrQ29udGFpbmVySUR9YCk7XG5cdGlmIChjb250YWluZXIpIHtcblx0XHRyZXR1cm4gY29udGFpbmVyIGFzIEhUTUxFbGVtZW50O1xuXHR9IGVsc2Uge1xuXHRcdGNvbnN0IG5ld0NvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0bmV3Q29udGFpbmVyLmlkID0gcmVmZXJlbmNlTWFya0NvbnRhaW5lcklEO1xuXHRcdGNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoXCIuY20tc2Nyb2xsZXJcIikhLmFwcGVuZENoaWxkKG5ld0NvbnRhaW5lcik7XG5cdFx0cmV0dXJuIG5ld0NvbnRhaW5lcjtcblx0fVxufVxuXG5mdW5jdGlvbiBnZXRSZWZlcmVuY2VNYXJrcyhlZGl0b3I6IEVkaXRvcik6IEhUTUxFbGVtZW50W10ge1xuXHRjb25zdCBjb250YWluZXIgPSBnZXRCYWNrbGlua0NvbnRhaW5lcihlZGl0b3IpO1xuXHRjb25zdCBlbGVtZW50czogSFRNTEVsZW1lbnRbXSA9IFtdO1xuXHRmb3IgKGxldCBpID0gMDsgaSA8IGNvbnRhaW5lci5jaGlsZHJlbi5sZW5ndGg7IGkrKykge1xuXHRcdGVsZW1lbnRzLnB1c2goY29udGFpbmVyLmNoaWxkcmVuLml0ZW0oaSkgYXMgSFRNTEVsZW1lbnQpO1xuXHR9XG5cdHJldHVybiBlbGVtZW50cztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldExlYWZCQm94RWxlbWVudHMobGVhZjogV29ya3NwYWNlTGVhZikge1xuXHRjb25zdCB0aXRsZSA9IGdldENvbnRhaW5lckVsZW1lbnQobGVhZikucXVlcnlTZWxlY3RvcihcIi5pbmxpbmUtdGl0bGVcIik7XG5cdGlmICghdGl0bGUpIHtcblx0XHR0aHJvdyBuZXcgRXJyb3IoXCJNaXNzaW5nIHRpdGxlXCIpO1xuXHR9XG5cdGNvbnN0IHRpdGxlQmJveCA9IHRpdGxlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXHRjb25zdCBsaW5lID0gZ2V0Q29udGFpbmVyRWxlbWVudChsZWFmKS5xdWVyeVNlbGVjdG9yKFwiLmNtLWxpbmVcIik7XG5cdGlmICghbGluZSkge1xuXHRcdHRocm93IG5ldyBFcnJvcihcIkRvY3VtZW50IGhhcyBubyBsaW5lc1wiKTtcblx0fVxuXHRjb25zdCBsaW5lQmJveCA9IGxpbmUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cblx0cmV0dXJuIHsgdGl0bGVCYm94LCBsaW5lQmJveCB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlQmFja2xpbmtNYXJrUG9zaXRpb24oXG5cdGxlYWY6IFdvcmtzcGFjZUxlYWYsXG5cdGJhY2tsaW5rc1RvTGVhZjogQmFja2xpbmtbXSxcblx0c2hvd1BvcnRhbHM6IGJvb2xlYW5cbikge1xuXHRjb25zdCBlZGl0b3IgPSBnZXRNYXJrZG93blZpZXcobGVhZikuZWRpdG9yO1xuXHRjb25zdCBiYWNrbGlua0NvbnRhaW5lciA9IGdldEJhY2tsaW5rQ29udGFpbmVyKGVkaXRvcik7XG5cblx0bGV0IGJhY2tsaW5rcyA9IFtdO1xuXHRmb3IgKGxldCBpID0gMDsgaSA8IGJhY2tsaW5rQ29udGFpbmVyLmNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG5cdFx0YmFja2xpbmtzLnB1c2goYmFja2xpbmtDb250YWluZXIuY2hpbGRyZW4uaXRlbShpKSBhcyBIVE1MRWxlbWVudCk7XG5cdH1cblx0bGV0IGJhY2tsaW5rSWRzOiBzdHJpbmdbXSA9IGJhY2tsaW5rc1RvTGVhZi5tYXAoKHgpID0+IGdldEJhY2tsaW5rSUQoeCkpO1xuXG5cdGJhY2tsaW5rc1xuXHRcdC5tYXAoKHg6IEhUTUxTcGFuRWxlbWVudCkgPT4geC5pZClcblx0XHQuZm9yRWFjaCgoaWQpID0+IHtcblx0XHRcdGlmICghYmFja2xpbmtJZHMuaW5jbHVkZXMoaWQpKSB7XG5cdFx0XHRcdGxldCBlbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpO1xuXHRcdFx0XHRpZiAoZWxlbWVudCkgZWxlbWVudC5yZW1vdmUoKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRjb25zdCB7IHRpdGxlQmJveCwgbGluZUJib3ggfSA9IGdldExlYWZCQm94RWxlbWVudHMobGVhZik7XG5cblx0Ly8gQ3JlYXRlIHRoZSBpbml0aWFsIGJhY2tsaW5rIG1hcmsgaWYgbmVjZXNzYXJ5IGFuZCBwb3NpdGlvbiBpdCBpbiB0aGUgY29ycmVjdCB2ZXJ0aWNhbCBwb3NpdGlvblxuXHRsZXQgcmVmZXJlbmNlTWFya2VycyA9IGJhY2tsaW5rc1RvTGVhZi5tYXAoKGJhY2tsaW5rKSA9PiB7XG5cdFx0Y29uc3QgeyBmcm9tIH0gPSBiYWNrbGluay5yZWZlcmVuY2VkTG9jYXRpb247XG5cblx0XHRjb25zdCBiYm94ID0gZ2V0Q29kZU1pcnJvckVkaXRvclZpZXcoZWRpdG9yKS5jb29yZHNBdFBvcyhmcm9tKTtcblx0XHRpZiAoIWJib3gpIHJldHVybjtcblxuXHRcdGxldCByZWZlcmVuY2VNYXJrZXIgPSBiYWNrbGlua0NvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFxuXHRcdFx0YCMke2dldEJhY2tsaW5rSUQoYmFja2xpbmspfWBcblx0XHQpIGFzIEhUTUxFbGVtZW50IHwgbnVsbDtcblxuXHRcdGlmIChyZWZlcmVuY2VNYXJrZXIgPT09IG51bGwpIHtcblx0XHRcdHJlZmVyZW5jZU1hcmtlciA9IGNyZWF0ZUJhY2tsaW5rTWFyayhiYWNrbGluayk7XG5cdFx0XHRiYWNrbGlua0NvbnRhaW5lci5hcHBlbmRDaGlsZChyZWZlcmVuY2VNYXJrZXIpO1xuXHRcdH1cblxuXHRcdGlmIChiYm94KSB7XG5cdFx0XHRyZWZlcmVuY2VNYXJrZXIuc3R5bGUucG9zaXRpb24gPSBcImFic29sdXRlXCI7XG5cblx0XHRcdHJlZmVyZW5jZU1hcmtlci5zZXRBdHRyaWJ1dGUoXCJ0b3BcIiwgYmJveC50b3AudG9TdHJpbmcoKSk7XG5cdFx0XHRyZWZlcmVuY2VNYXJrZXIuc3R5bGUudG9wID0gYmJveC50b3AgLSB0aXRsZUJib3gudG9wICsgMzIgKyBcInB4XCI7XG5cdFx0XHRyZWZlcmVuY2VNYXJrZXIuc3R5bGUubGVmdCA9IGxpbmVCYm94LndpZHRoICsgNDAgKyBcInB4XCI7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHJlZmVyZW5jZU1hcmtlcjtcblx0fSk7XG5cblx0Ly8gTm93IGFjY291bnQgZm9yIHBvc3NpYmxlIHBvc2l0aW9uIG92ZXJsYXBzIGFuZCBzaGlmdCBkb3dud2FyZHNcblx0Ly8gYWxzbyBjb25zaWRlciB3aGV0aGVyIHRoZSBwb3J0YWxzIHNob3VsZCBiZSBzaG93biBvciBub3QuXG5cdGxldCBsYXN0WUJvdHRvbSA9IC1JbmZpbml0eTsgLy8gZm9yIGxhcmdlIGRvY3VtZW50cyBcdUQ4M0RcdURFMDFcblx0bGV0IG1hcmdpbiA9IDQ7XG5cdHJlZmVyZW5jZU1hcmtlcnNcblx0XHQuc29ydChcblx0XHRcdChhLCBiKSA9PlxuXHRcdFx0XHRwYXJzZUludChhIS5nZXRBdHRyaWJ1dGUoXCJ0b3BcIikhKSAtIHBhcnNlSW50KGIhLmdldEF0dHJpYnV0ZShcInRvcFwiKSEpXG5cdFx0KVxuXHRcdC5mb3JFYWNoKChtYXJrZXIpID0+IHtcblx0XHRcdGlmICghbWFya2VyKSByZXR1cm47XG5cdFx0XHQvLyB0b2dnbGUgcG9ydGFsc1xuXHRcdFx0Y29uc3QgcG9ydGFsOiBIVE1MRWxlbWVudCB8IG51bGwgPSBtYXJrZXIucXVlcnlTZWxlY3RvcihcIi5wb3J0YWxcIik7XG5cblx0XHRcdGlmIChzaG93UG9ydGFscykge1xuXHRcdFx0XHQvLyBpZiAoc3ZnICYmICFwb3J0YWwpIHN2Zy5zdHlsZS5kaXNwbGF5ID0gXCJpbmxpbmVcIjtcblx0XHRcdFx0Ly8gZWxzZSBpZiAoc3ZnKSBzdmcuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuXG5cdFx0XHRcdGlmIChwb3J0YWwpIHtcblx0XHRcdFx0XHRwb3J0YWwuc3R5bGUuZGlzcGxheSA9IFwiaW5saW5lXCI7XG5cdFx0XHRcdFx0bWFya2VyLmNsYXNzTGlzdC5hZGQoXCJiYWNrbGluay1zcGFuXCIpO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBpZiAoc3ZnKSBzdmcuc3R5bGUuZGlzcGxheSA9IFwiaW5saW5lXCI7XG5cdFx0XHRcdGlmIChwb3J0YWwpIHtcblx0XHRcdFx0XHRwb3J0YWwuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuXHRcdFx0XHR9XG5cdFx0XHRcdG1hcmtlci5jbGFzc0xpc3QucmVtb3ZlKFwiYmFja2xpbmstc3BhblwiKTtcblx0XHRcdH1cblx0XHRcdC8vIGdldCBwb3NpdGlvbmluZ1xuXHRcdFx0bGV0IHRvcCA9IHBhcnNlSW50KG1hcmtlciEuZ2V0QXR0cmlidXRlKFwidG9wXCIpISk7XG5cdFx0XHR0b3AgPSBNYXRoLm1heCh0b3AsIGxhc3RZQm90dG9tICsgbWFyZ2luKTtcblx0XHRcdGxhc3RZQm90dG9tID0gdG9wICsgbWFya2VyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmhlaWdodCArIG1hcmdpbjtcblx0XHRcdG1hcmtlci5zZXRBdHRyaWJ1dGUoXCJ0b3BcIiwgdG9wLnRvU3RyaW5nKCkpO1xuXHRcdFx0bWFya2VyLnN0eWxlLnRvcCA9IHRvcCAtIHRpdGxlQmJveC50b3AgKyAzMiArIFwicHhcIjtcblx0XHRcdG1hcmtlci5zdHlsZS5sZWZ0ID0gbGluZUJib3gud2lkdGggKyA0MCArIFwicHhcIjtcblx0XHR9KTtcbn1cblxubGV0IGRlYm91bmNlVGltZXI6IE5vZGVKUy5UaW1lb3V0O1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlQmFja2xpbmtNYXJrUG9zaXRpb25zKCkge1xuXHRjbGVhclRpbWVvdXQoZGVib3VuY2VUaW1lcik7XG5cdGRlYm91bmNlVGltZXIgPSBzZXRUaW1lb3V0KGFzeW5jICgpID0+IHtcblx0XHRjb25zdCBsZWF2ZXMgPSBnZXRUaGF0KCkud29ya3NwYWNlLmdldExlYXZlc09mVHlwZShcblx0XHRcdFwibWFya2Rvd25cIlxuXHRcdCkgYXMgV29ya3NwYWNlTGVhZltdO1xuXG5cdFx0c2V0VGltZW91dChhc3luYyAoKSA9PiB7XG5cdFx0XHRjb25zdCBhbGxCYWNrbGlua3M6IEJhY2tsaW5rW10gPSBhd2FpdCByZWNvbXB1dGVSZWZlcmVuY2VzRm9yUGFnZSgpO1xuXG5cdFx0XHRsZWF2ZXMubWFwKGFzeW5jIChsZWFmKSA9PiB7XG5cdFx0XHRcdGNvbnN0IGJhY2tsaW5rc1RvTGVhZiA9IGFsbEJhY2tsaW5rcy5maWx0ZXIoXG5cdFx0XHRcdFx0Ly8gQHRzLWlnbm9yZVxuXHRcdFx0XHRcdChiKSA9PiBiLnJlZmVyZW5jZWRMb2NhdGlvbi5maWxlbmFtZSA9PSBsZWFmLnZpZXcuZmlsZS5wYXRoXG5cdFx0XHRcdCk7XG5cdFx0XHRcdC8vIHdpZHRoIDkwMCwgc2hvdyB0aGUgcmVmZXJlbmNlXG5cdFx0XHRcdGNvbnN0IHNob3dQb3J0YWxzID0gZ2V0Q29udGFpbmVyRWxlbWVudChsZWFmKS5pbm5lcldpZHRoID4gOTAwO1xuXHRcdFx0XHR1cGRhdGVCYWNrbGlua01hcmtQb3NpdGlvbihsZWFmLCBiYWNrbGlua3NUb0xlYWYsIHNob3dQb3J0YWxzKTtcblx0XHRcdH0pO1xuXHRcdFx0YXdhaXQgUHJvbWlzZS5hbGwoXG5cdFx0XHRcdGxlYXZlcy5tYXAoYXN5bmMgKGxlYWYpID0+IHtcblx0XHRcdFx0XHRjb25zdCBiYWNrbGlua3NUb0xlYWYgPSBhbGxCYWNrbGlua3MuZmlsdGVyKFxuXHRcdFx0XHRcdFx0Ly8gQHRzLWlnbm9yZVxuXHRcdFx0XHRcdFx0KGIpID0+IGIucmVmZXJlbmNlZExvY2F0aW9uLmZpbGVuYW1lID09IGxlYWYudmlldy5maWxlLnBhdGhcblx0XHRcdFx0XHQpO1xuXHRcdFx0XHRcdC8vIHdpZHRoIDkwMCwgc2hvdyB0aGUgcmVmZXJlbmNlXG5cdFx0XHRcdFx0Y29uc3Qgc2hvd1BvcnRhbHMgPSBnZXRDb250YWluZXJFbGVtZW50KGxlYWYpLmlubmVyV2lkdGggPiA5MDA7XG5cdFx0XHRcdFx0dXBkYXRlQmFja2xpbmtNYXJrUG9zaXRpb24obGVhZiwgYmFja2xpbmtzVG9MZWFmLCBzaG93UG9ydGFscyk7XG5cdFx0XHRcdH0pXG5cdFx0XHQpO1xuXHRcdH0sIDUwMCk7XG5cdH0sIDEwMCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVCYWNrbGlua01hcmsoYmFja2xpbms6IEJhY2tsaW5rKTogSFRNTEVsZW1lbnQge1xuXHRsZXQgeyBzcGFuLCBzdmcgfSA9IGNyZWF0ZVJlZmVyZW5jZUljb24oYmFja2xpbmsucG9ydGFsVGV4dCk7XG5cdHNwYW4uY2xhc3NMaXN0LmFkZChcImJhY2tsaW5rLWRhdGEtc3BhblwiKTtcblxuXHRjb25zdCBwb3J0YWw6IEhUTUxFbGVtZW50IHwgbnVsbCA9IHNwYW4ucXVlcnlTZWxlY3RvcihcIi5wb3J0YWxcIik7XG5cblx0c3Bhbi5zdHlsZS5wb3NpdGlvbiA9IFwiYWJzb2x1dGVcIjtcblxuXHRzcGFuLmlkID0gZ2V0QmFja2xpbmtJRChiYWNrbGluayk7XG5cdHNwYW4uc2V0QXR0cmlidXRlKFwicmVmZXJlbmNlXCIsIEpTT04uc3RyaW5naWZ5KGJhY2tsaW5rKSk7XG5cblx0Y29uc3QgcmVzaXplT2JzZXJ2ZXIgPSBuZXcgUmVzaXplT2JzZXJ2ZXIoKGVudHJpZXMpID0+IHtcblx0XHRpZiAocG9ydGFsICYmIHBvcnRhbC5zdHlsZS5kaXNwbGF5ICE9IFwibm9uZVwiKSB7XG5cdFx0XHQvLyBzcGFuLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwid2hpdGVcIjtcblx0XHRcdHNwYW4uY2xhc3NMaXN0LmFkZChcImJhY2tsaW5rLXBvcnRhbC1vcGVuXCIpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBzcGFuLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiXCI7XG5cdFx0XHRzcGFuLmNsYXNzTGlzdC5yZW1vdmUoXCJiYWNrbGluay1wb3J0YWwtb3BlblwiKTtcblx0XHR9XG5cdH0pO1xuXG5cdC8vIFN0YXJ0IG9ic2VydmluZyBhbiBlbGVtZW50XG5cdHJlc2l6ZU9ic2VydmVyLm9ic2VydmUoc3Bhbik7XG5cblx0c3Bhbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgb3BlbkJhY2tsaW5rUmVmZXJlbmNlKTtcblxuXHRyZXR1cm4gc3Bhbjtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGFkZFJlZmVyZW5jZXNUb0xlYWYobGVhZjogV29ya3NwYWNlTGVhZikge1xuXHRjb25zdCBtYXJrZG93blZpZXcgPSBnZXRNYXJrZG93blZpZXcobGVhZik7XG5cdGxldCB3b3Jrc3BhY2VUYWJzID0gbWFya2Rvd25WaWV3LmNvbnRhaW5lckVsLmNsb3Nlc3QoXCIud29ya3NwYWNlLXRhYnNcIik7XG5cdGlmICghd29ya3NwYWNlVGFicykge1xuXHRcdHRocm93IG5ldyBFcnJvcihcIk1pc3Npbmcgd29ya3NwYWNlIHRhYnNcIik7XG5cdH1cblxuXHRhd2FpdCB1cGRhdGVCYWNrbGlua01hcmtQb3NpdGlvbnMoKTtcblx0YXdhaXQgZGVsYXkoMjAwMCk7XG5cdGdlbmVyYXRlRGVmYXVsdEhpZ2hsaWdodHMobGVhZik7XG5cblx0Ly8gbGV0IHByZXZTY3JvbGwgPSAwO1xuXHRnZXRDb250YWluZXJFbGVtZW50KG1hcmtkb3duVmlldy5lZGl0b3IpXG5cdFx0LnF1ZXJ5U2VsZWN0b3IoXCIuY20tc2Nyb2xsZXJcIikhXG5cdFx0LmFkZEV2ZW50TGlzdGVuZXIoXCJzY3JvbGxcIiwgYXN5bmMgKGV2KSA9PiB7XG5cdFx0XHRhd2FpdCB1cGRhdGVCYWNrbGlua01hcmtQb3NpdGlvbnMoKTtcblx0XHRcdGF3YWl0IGRlbGF5KDIwMDApO1xuXHRcdFx0Z2VuZXJhdGVEZWZhdWx0SGlnaGxpZ2h0cyhsZWFmKTtcblx0XHRcdGNvbnNvbGUubG9nKFwic2Nyb2xsXCIpO1xuXHRcdFx0Ly8gaWYgKGV2LnRhcmdldCAmJiAoZXYudGFyZ2V0IGFzIEhUTUxFbGVtZW50KS5zY3JvbGxUb3ApIHtcblx0XHRcdC8vIFx0Y29uc29sZS5sb2coKGV2LnRhcmdldCBhcyBIVE1MRWxlbWVudCkuc2Nyb2xsVG9wKTtcblx0XHRcdC8vIFx0aWYgKE1hdGguYWJzKHByZXZTY3JvbGwgLSAoZXYudGFyZ2V0IGFzIEhUTUxFbGVtZW50KS5zY3JvbGxUb3ApIDwgMTApIHtcblx0XHRcdC8vIFx0XHRjb25zb2xlLmxvZyhcInNsb3cgc2Nyb2xsXCIpO1xuXHRcdFx0Ly8gXHRcdGNvbnNvbGUubG9nKGV2KTtcblx0XHRcdC8vIFx0XHQvLyBORUVEIFRPIEhBTkRMRSBUSElTIERJRkZFUkVOVExZIEFORCBUSEVOIFBBU1MgVE8gSEFORExFIE1PVVNFIE1PVkVNRU5UUyBGVU5DVElPTlxuXHRcdFx0Ly8gXHRcdGhhbmRsZU1vdmVtZW50RWZmZWN0cyhldiBhcyBNb3VzZUV2ZW50KTtcblx0XHRcdC8vIFx0fVxuXHRcdFx0Ly8gXHRwcmV2U2Nyb2xsID0gKGV2LnRhcmdldCBhcyBIVE1MRWxlbWVudCkuc2Nyb2xsVG9wO1xuXHRcdFx0Ly8gfVxuXHRcdH0pO1xuXG5cdGxldCByZXNpemVPYnNlcnZlciA9IG5ldyBSZXNpemVPYnNlcnZlcihhc3luYyAoKSA9PiB7XG5cdFx0YXdhaXQgdXBkYXRlQmFja2xpbmtNYXJrUG9zaXRpb25zKCk7XG5cdFx0YXdhaXQgZGVsYXkoMjAwMCk7XG5cdFx0Z2VuZXJhdGVEZWZhdWx0SGlnaGxpZ2h0cyhsZWFmKTtcblx0fSk7XG5cblx0cmVzaXplT2JzZXJ2ZXIub2JzZXJ2ZSh3b3Jrc3BhY2VUYWJzKTtcblxuXHRyZXR1cm4gbGVhZjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldE1hcmtkb3duVmlldyhsZWFmOiBXb3Jrc3BhY2VMZWFmKTogTWFya2Rvd25WaWV3IHtcblx0aWYgKCEobGVhZi52aWV3IGluc3RhbmNlb2YgTWFya2Rvd25WaWV3KSkge1xuXHRcdHRocm93IG5ldyBFcnJvcihcIlVuZXhwZWN0ZWQgbm9uLW1hcmtkb3duIHZpZXdcIik7XG5cdH1cblx0cmV0dXJuIGxlYWYudmlldyBhcyBNYXJrZG93blZpZXc7XG59XG5cbmZ1bmN0aW9uIGdldEZpbGVuYW1lKGxlYWY6IFdvcmtzcGFjZUxlYWYpOiBzdHJpbmcge1xuXHRjb25zdCB7IGZpbGUgfSA9IGdldE1hcmtkb3duVmlldyhsZWFmKTtcblx0aWYgKCFmaWxlKSB7XG5cdFx0dGhyb3cgbmV3IEVycm9yKFwiVW5leHBlY3RlZCBtaXNzaW5nIGZpbGVcIik7XG5cdH1cblx0cmV0dXJuIGZpbGUubmFtZTtcbn1cblxuZnVuY3Rpb24gZmluZE1hdGNoUG9zaXRpb25zKGxpbmU6IHN0cmluZywgcmVnZXg6IFJlZ0V4cCkge1xuXHRsZXQgbWF0Y2g7XG5cdGNvbnN0IHBvc2l0aW9ucyA9IFtdO1xuXHR3aGlsZSAoKG1hdGNoID0gcmVnZXguZXhlYyhsaW5lKSkgIT09IG51bGwpIHtcblx0XHRwb3NpdGlvbnMucHVzaCh7XG5cdFx0XHRtYXRjaDogbWF0Y2hbMF0sXG5cdFx0XHRzdGFydDogbWF0Y2guaW5kZXgsXG5cdFx0XHRlbmQ6IG1hdGNoLmluZGV4ICsgbWF0Y2hbMF0ubGVuZ3RoLFxuXHRcdH0pO1xuXHR9XG5cdHJldHVybiBwb3NpdGlvbnM7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUJhY2tsaW5rRGF0YShcblx0cmVmZXJlbmNpbmdGaWxlRGF0YTogc3RyaW5nLFxuXHRyZWZlcmVuY2luZ0ZpbGU6IFRGaWxlXG4pOiBCYWNrbGlua1tdIHtcblx0bGV0IGJhY2tsaW5rczogQmFja2xpbmtbXSA9IFtdO1xuXG5cdGxldCBtYXRjaGVzID0gWy4uLnJlZmVyZW5jaW5nRmlsZURhdGEubWF0Y2hBbGwoUkVGRVJFTkNFX1JFR0VYKV07XG5cdG1hdGNoZXMuZm9yRWFjaCgobWF0Y2gpID0+IHtcblx0XHRpZiAobWF0Y2hbMV0uc3BsaXQoXCI6XCIpLmxlbmd0aCAhPSA4KSByZXR1cm47XG5cdFx0bGV0IFtwcmVmaXgsIHRleHQsIHN1ZmZpeCwgZmlsZW5hbWUsIGZyb20sIHRvLCBwb3J0YWwsIHRvZ2dsZV0gPSBwcm9jZXNzVVJJKFxuXHRcdFx0bWF0Y2hbMV1cblx0XHQpO1xuXHRcdGNvbnN0IHJlZmVyZW5jZWRMb2NhdGlvbjogRG9jdW1lbnRMb2NhdGlvbiA9IHtcblx0XHRcdHByZWZpeCxcblx0XHRcdHRleHQsXG5cdFx0XHRzdWZmaXgsXG5cdFx0XHRmaWxlbmFtZSxcblx0XHRcdGZyb20sXG5cdFx0XHR0byxcblx0XHRcdHBvcnRhbCxcblx0XHRcdHRvZ2dsZSxcblx0XHR9O1xuXG5cdFx0bGV0IGluZGV4ID0gcmVmZXJlbmNpbmdGaWxlRGF0YS5pbmRleE9mKG1hdGNoWzBdKTtcblxuXHRcdGNvbnN0IHJlZmVyZW5jaW5nU3Vycm91bmRpbmdTdHJpbmdzID0gZ2V0UHJlZml4QW5kU3VmZml4KFxuXHRcdFx0cmVmZXJlbmNpbmdGaWxlRGF0YSxcblx0XHRcdGluZGV4LFxuXHRcdFx0aW5kZXggKyBtYXRjaFswXS5sZW5ndGhcblx0XHQpO1xuXG5cdFx0Y29uc3QgcmVmZXJlbmNpbmdMb2NhdGlvbjogRG9jdW1lbnRMb2NhdGlvbiA9IHtcblx0XHRcdC8vIHByZWZpeDogcmVmZXJlbmNpbmdGaWxlRGF0YS5zbGljZShpbmRleCAtIDI1LCBpbmRleCksXG5cdFx0XHRwcmVmaXg6IHJlZmVyZW5jaW5nU3Vycm91bmRpbmdTdHJpbmdzLnByZWZpeCxcblx0XHRcdHRleHQ6IHJlZmVyZW5jaW5nRmlsZURhdGEuc2xpY2UoaW5kZXgsIGluZGV4ICsgbWF0Y2hbMF0ubGVuZ3RoKSxcblx0XHRcdC8vIHN1ZmZpeDogcmVmZXJlbmNpbmdGaWxlRGF0YS5zbGljZShcblx0XHRcdC8vIFx0aW5kZXggKyBtYXRjaFswXS5sZW5ndGgsXG5cdFx0XHQvLyBcdGluZGV4ICsgbWF0Y2hbMF0ubGVuZ3RoICsgMjVcblx0XHRcdC8vICksXG5cdFx0XHRzdWZmaXg6IHJlZmVyZW5jaW5nU3Vycm91bmRpbmdTdHJpbmdzLnN1ZmZpeCxcblx0XHRcdGZpbGVuYW1lOiByZWZlcmVuY2luZ0ZpbGUucGF0aCxcblx0XHRcdGZyb206IG1hdGNoLmluZGV4ISwgLy8gVE9ETyBkbyB3ZWlyZCBzdHJpbmcgZm9ybWF0XG5cdFx0XHR0bzogbWF0Y2guaW5kZXghICsgbWF0Y2hbMF0ubGVuZ3RoLCAvLyBUT0RPIGRvIHdlaXJkIHN0cmluZyBmb3JtYXRcblx0XHRcdHBvcnRhbCxcblx0XHRcdHRvZ2dsZSxcblx0XHR9O1xuXG5cdFx0aWYgKHBvcnRhbCA9PSBcInBvcnRhbFwiKSB7XG5cdFx0XHQvLyBPUiBuby1wb3J0YWxcblxuXHRcdFx0Ly8gZ2V0IGFsbCB0aGUgdGV4dCBmcm9tIHRoZSBzdGFydCBvZiB0aGUgbGluZSB0byB0aGUgZW5kIG9mIHRoZSBsaW5lXG5cdFx0XHRjb25zdCBnZXRMaW5lVGV4dCA9ICh0ZXh0OiBzdHJpbmcsIGluZGV4OiBudW1iZXIpOiBzdHJpbmcgPT4ge1xuXHRcdFx0XHRjb25zdCBzdGFydE9mTGluZSA9IHRleHQubGFzdEluZGV4T2YoXCJcXG5cIiwgaW5kZXggLSAxKSArIDE7XG5cdFx0XHRcdGNvbnN0IGVuZE9mTGluZSA9IHRleHQuaW5kZXhPZihcIlxcblwiLCBpbmRleCk7XG5cdFx0XHRcdHJldHVybiB0ZXh0LnNsaWNlKFxuXHRcdFx0XHRcdHN0YXJ0T2ZMaW5lLFxuXHRcdFx0XHRcdGVuZE9mTGluZSAhPT0gLTEgPyBlbmRPZkxpbmUgOiB1bmRlZmluZWRcblx0XHRcdFx0KTtcblx0XHRcdH07XG5cblx0XHRcdGxldCBsaW5lID0gZ2V0TGluZVRleHQocmVmZXJlbmNpbmdGaWxlRGF0YSwgaW5kZXgpO1xuXHRcdFx0bGV0IG1hdGNoUG9zaXRpb25zID0gZmluZE1hdGNoUG9zaXRpb25zKFxuXHRcdFx0XHRsaW5lLFxuXHRcdFx0XHRuZXcgUmVnRXhwKFJFRkVSRU5DRV9SRUdFWClcblx0XHRcdCk7XG5cblx0XHRcdGxldCBtYXRjaEluZGV4ID0gMDtcblx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgbWF0Y2hQb3NpdGlvbnMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0aWYgKG1hdGNoUG9zaXRpb25zW2ldLm1hdGNoID09IG1hdGNoWzBdKSB7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0bWF0Y2hJbmRleCArPSBtYXRjaFBvc2l0aW9uc1tpXS5lbmQgLSBtYXRjaFBvc2l0aW9uc1tpXS5zdGFydCAtIDE7IC8vIC0xIGJlY2F1c2UgdGhlIGxpbmUgaXMgcmVwbGFjZWQgYnkgYSBzaW5nbGUgY2hhcmFjdGVyXG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0bGV0IHBvcnRhbFRleHQgPSBsaW5lLnJlcGxhY2UobmV3IFJlZ0V4cChSRUZFUkVOQ0VfUkVHRVgsIFwiZ1wiKSwgXCJcdTIxOTdcIik7XG5cdFx0XHRsZXQgcG9ydGFsVGV4dFNsaWNlID0gcG9ydGFsVGV4dC5zbGljZSgwLCBQT1JUQUxfVEVYVF9TTElDRV9TSVpFKTtcblxuXHRcdFx0bGV0IHBvcnRhbFRleHRJbmRleCA9IGxpbmUuaW5kZXhPZihtYXRjaFswXSkgLSBtYXRjaEluZGV4O1xuXG5cdFx0XHQvLyBnZXR0aW5nIHRoZSBwb3J0YWwgdGV4dCBzZWxlY3Rpb24gYXJvdW5kIHRoZSByZWZlcmVuY2Vcblx0XHRcdHBvcnRhbFRleHRTbGljZSA9IFwiXHUyMTk3XCI7XG5cblx0XHRcdGxldCBzdGFydFBvcnRhbFRleHQgPSBwb3J0YWxUZXh0LnN1YnN0cmluZyhcblx0XHRcdFx0TWF0aC5tYXgocG9ydGFsVGV4dEluZGV4IC0gMjUsIDApLFxuXHRcdFx0XHRwb3J0YWxUZXh0SW5kZXhcblx0XHRcdCk7XG5cdFx0XHRpZiAoXG5cdFx0XHRcdHBvcnRhbFRleHQuc3Vic3RyaW5nKE1hdGgubWF4KHBvcnRhbFRleHRJbmRleCAtIDI1LCAwKSwgcG9ydGFsVGV4dEluZGV4KVxuXHRcdFx0XHRcdC5sZW5ndGggPiAwICYmXG5cdFx0XHRcdHBvcnRhbFRleHRJbmRleCAtIDI1ID4gMFxuXHRcdFx0KVxuXHRcdFx0XHRzdGFydFBvcnRhbFRleHQgPSBcIi4uLlwiICsgc3RhcnRQb3J0YWxUZXh0O1xuXG5cdFx0XHRsZXQgZW5kUG9ydGFsVGV4dCA9IHBvcnRhbFRleHQuc3Vic3RyaW5nKFxuXHRcdFx0XHRwb3J0YWxUZXh0SW5kZXggKyAxLFxuXHRcdFx0XHRNYXRoLm1heChwb3J0YWxUZXh0SW5kZXggKyAyNSwgcG9ydGFsVGV4dC5sZW5ndGgpXG5cdFx0XHQpO1xuXHRcdFx0aWYgKFxuXHRcdFx0XHRwb3J0YWxUZXh0LnN1YnN0cmluZyhcblx0XHRcdFx0XHRwb3J0YWxUZXh0SW5kZXggKyAxLFxuXHRcdFx0XHRcdE1hdGgubWF4KHBvcnRhbFRleHRJbmRleCArIDI1LCBwb3J0YWxUZXh0Lmxlbmd0aClcblx0XHRcdFx0KS5sZW5ndGggPiAwICYmXG5cdFx0XHRcdHBvcnRhbFRleHRJbmRleCArIDI1IDwgcG9ydGFsVGV4dC5sZW5ndGhcblx0XHRcdClcblx0XHRcdFx0ZW5kUG9ydGFsVGV4dCA9IGVuZFBvcnRhbFRleHQgKyBcIi4uLlwiO1xuXG5cdFx0XHRiYWNrbGlua3MucHVzaCh7XG5cdFx0XHRcdHJlZmVyZW5jZWRMb2NhdGlvbixcblx0XHRcdFx0cmVmZXJlbmNpbmdMb2NhdGlvbixcblx0XHRcdFx0ZGF0YVN0cmluZzogbWF0Y2hbMV0sXG5cdFx0XHRcdHBvcnRhbFRleHQ6XG5cdFx0XHRcdFx0ZW5jb2RlVVJJQ29tcG9uZW50U3RyaW5nKHN0YXJ0UG9ydGFsVGV4dCkgK1xuXHRcdFx0XHRcdFwiOlwiICtcblx0XHRcdFx0XHRwb3J0YWxUZXh0U2xpY2UgK1xuXHRcdFx0XHRcdFwiOlwiICtcblx0XHRcdFx0XHRlbmNvZGVVUklDb21wb25lbnRTdHJpbmcoZW5kUG9ydGFsVGV4dCksXG5cdFx0XHR9KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0YmFja2xpbmtzLnB1c2goe1xuXHRcdFx0XHRyZWZlcmVuY2VkTG9jYXRpb24sXG5cdFx0XHRcdHJlZmVyZW5jaW5nTG9jYXRpb24sXG5cdFx0XHRcdGRhdGFTdHJpbmc6IG1hdGNoWzFdLFxuXHRcdFx0fSk7XG5cdFx0fVxuXHR9KTtcblx0cmV0dXJuIGJhY2tsaW5rcztcbn1cblxuLy8gbGV0IGRlYm91bmNlVGltZXI6IE5vZGVKUy5UaW1lb3V0O1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdlbmVyYXRlQmFja2xpbmtzKCkge1xuXHQvLyBjbGVhclRpbWVvdXQoZGVib3VuY2VUaW1lcik7XG5cdC8vIGRlYm91bmNlVGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHtcblx0Y29uc29sZS5sb2coXCJnZW5lcmF0aW5nIHJlZmVyZW5jZXNcIik7XG5cdGxldCBiYWNrbGlua3M6IEJhY2tsaW5rW10gPSBbXTtcblx0bGV0IG1hcmtkb3duRmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XG5cblx0YXdhaXQgUHJvbWlzZS5hbGwoXG5cdFx0bWFya2Rvd25GaWxlcy5tYXAoKGZpbGU6IFRGaWxlKSA9PiB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpKVxuXHQpLnRoZW4oKGZpbGVzKSA9PiB7XG5cdFx0Y29uc3QgemlwcGVkQXJyYXkgPSBtYXJrZG93bkZpbGVzLm1hcCgoZmlsZTogVEZpbGUsIGluZGV4OiBudW1iZXIpID0+ICh7XG5cdFx0XHRtYXJrZG93bkZpbGU6IGZpbGUsXG5cdFx0XHRmaWxlRGF0YTogZmlsZXNbaW5kZXhdLFxuXHRcdH0pKTtcblxuXHRcdHppcHBlZEFycmF5LmZvckVhY2goKGZpbGU6IHsgbWFya2Rvd25GaWxlOiBURmlsZTsgZmlsZURhdGE6IHN0cmluZyB9KSA9PiB7XG5cdFx0XHRsZXQgZmlsZUJhY2tsaW5rcyA9IGNyZWF0ZUJhY2tsaW5rRGF0YShmaWxlLmZpbGVEYXRhLCBmaWxlLm1hcmtkb3duRmlsZSk7XG5cdFx0XHR1cGRhdGVCYWNrbGlua3MoZmlsZUJhY2tsaW5rcyk7XG5cblx0XHRcdGJhY2tsaW5rcy5wdXNoKC4uLmZpbGVCYWNrbGlua3MpO1xuXHRcdH0pO1xuXHR9KTtcblx0Ly8gfSwgMTAwKTtcbn1cblxuLy8gU2hvdWxkIG9ubHkgcmVjb21wdXRlIGZvciB0aGUgcGFydGljdWxhciBwYWdlIGJlaW5nIG9wZW5lZCBvciBpbnRlcmFjdGVkIHdpdGhcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZWNvbXB1dGVSZWZlcmVuY2VzRm9yUGFnZSgpOiBQcm9taXNlPEJhY2tsaW5rW10+IHtcblx0bGV0IHJlZmVyZW5jZXM6IEJhY2tsaW5rW10gPSBbXTtcblx0bGV0IG1hcmtkb3duRmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XG5cblx0bGV0IHByb21pc2VzID0gbWFya2Rvd25GaWxlcy5tYXAoKGZpbGU6IFRGaWxlKSA9PiB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpKTtcblxuXHRsZXQgZmlsZXMgPSBhd2FpdCBQcm9taXNlLmFsbChwcm9taXNlcyk7XG5cdGNvbnN0IHppcHBlZEFycmF5ID0gbWFya2Rvd25GaWxlcy5tYXAoKGZpbGU6IFRGaWxlLCBpbmRleDogbnVtYmVyKSA9PiAoe1xuXHRcdG1hcmtkb3duRmlsZTogZmlsZSxcblx0XHRmaWxlRGF0YTogZmlsZXNbaW5kZXhdLFxuXHR9KSk7XG5cdHppcHBlZEFycmF5LmZvckVhY2goKGZpbGU6IHsgbWFya2Rvd25GaWxlOiBURmlsZTsgZmlsZURhdGE6IHN0cmluZyB9KSA9PiB7XG5cdFx0bGV0IGZpbGVCYWNrbGlua3MgPSBjcmVhdGVCYWNrbGlua0RhdGEoZmlsZS5maWxlRGF0YSwgZmlsZS5tYXJrZG93bkZpbGUpO1xuXHRcdHVwZGF0ZUJhY2tsaW5rcyhmaWxlQmFja2xpbmtzKTtcblxuXHRcdHJlZmVyZW5jZXMucHVzaCguLi5maWxlQmFja2xpbmtzKTtcblx0fSk7XG5cdHJldHVybiByZWZlcmVuY2VzO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gb3BlbkJhY2tsaW5rUmVmZXJlbmNlKGV2OiBNb3VzZUV2ZW50KSB7XG5cdGxldCBjdXJzb3IgPSBnZXRDdXJzb3IoKTtcblx0bGV0IGhvdmVyID0gZ2V0QmFja2xpbmtIb3ZlcigpO1xuXHRsZXQgbGVhZiA9IGdldFRoYXQoKS53b3Jrc3BhY2UuZ2V0TGVhZkJ5SWQoaG92ZXIubGVhZklkKTtcblxuXHQvLyBAdHMtaWdub3JlXG5cdGxldCBjb250YWluZXIgPSBsZWFmLmNvbnRhaW5lckVsO1xuXHRpZiAoIWNvbnRhaW5lcikgdGhyb3cgbmV3IEVycm9yKFwiQ29udGFpbmVyIG5vdCBmb3VuZFwiKTtcblx0Y29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCIudmlldy1jb250ZW50XCIpLnN0eWxlLmJveFNoYWRvdyA9IFwibm9uZVwiO1xuXG5cdGlmIChcblx0XHRjdXJzb3IgJiZcblx0XHRob3ZlciAmJlxuXHRcdGN1cnNvci5kYXRhU3RyaW5nICYmXG5cdFx0aG92ZXIuZGF0YVN0cmluZyAmJlxuXHRcdGN1cnNvci5kYXRhU3RyaW5nID09IGhvdmVyLmRhdGFTdHJpbmdcblx0KSB7XG5cdFx0dXBkYXRlQ3Vyc29yKHtcblx0XHRcdHRlbXA6IGZhbHNlLFxuXHRcdFx0Y3Vyc29yVmlld3BvcnQ6IG51bGwsXG5cdFx0XHRwZWVrOiBmYWxzZSxcblx0XHR9KTtcblx0fVxuXHR1cGRhdGVCYWNrbGlua0hvdmVyKHtcblx0XHR0ZW1wOiBmYWxzZSxcblx0XHRjdXJzb3JWaWV3cG9ydDogbnVsbCxcblx0XHRwZWVrOiBmYWxzZSxcblx0fSk7XG5cblx0aGFuZGxlUmVtb3ZlSG92ZXJlZEN1cnNvcihBQ1RJT05fVFlQRS5DVVJTT1IpO1xuXG5cdHJlc2V0Q3Vyc29yKCk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBvcGVuUmVmZXJlbmNlKGV2OiBNb3VzZUV2ZW50KSB7XG5cdGxldCBjdXJzb3IgPSBnZXRDdXJzb3IoKTtcblx0bGV0IGhvdmVyID0gZ2V0SG92ZXIoKTtcblx0bGV0IGxlYWYgPSBnZXRUaGF0KCkud29ya3NwYWNlLmdldExlYWZCeUlkKGhvdmVyLmxlYWZJZCk7XG5cblx0Ly8gQHRzLWlnbm9yZVxuXHRsZXQgY29udGFpbmVyID0gbGVhZi5jb250YWluZXJFbDtcblx0aWYgKCFjb250YWluZXIpIHRocm93IG5ldyBFcnJvcihcIkNvbnRhaW5lciBub3QgZm91bmRcIik7XG5cdGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiLnZpZXctY29udGVudFwiKS5zdHlsZS5ib3hTaGFkb3cgPSBcIm5vbmVcIjtcblxuXHRpZiAoXG5cdFx0Y3Vyc29yICYmXG5cdFx0aG92ZXIgJiZcblx0XHRjdXJzb3IuZGF0YVN0cmluZyAmJlxuXHRcdGhvdmVyLmRhdGFTdHJpbmcgJiZcblx0XHRjdXJzb3IuZGF0YVN0cmluZyA9PSBob3Zlci5kYXRhU3RyaW5nXG5cdCkge1xuXHRcdHVwZGF0ZUN1cnNvcih7XG5cdFx0XHR0ZW1wOiBmYWxzZSxcblx0XHRcdGN1cnNvclZpZXdwb3J0OiBudWxsLFxuXHRcdFx0cGVlazogZmFsc2UsXG5cdFx0fSk7XG5cdH1cblx0dXBkYXRlSG92ZXIoe1xuXHRcdHRlbXA6IGZhbHNlLFxuXHRcdGN1cnNvclZpZXdwb3J0OiBudWxsLFxuXHRcdHBlZWs6IGZhbHNlLFxuXHR9KTtcblxuXHRoYW5kbGVSZW1vdmVIb3ZlcmVkQ3Vyc29yKEFDVElPTl9UWVBFLkNVUlNPUik7XG5cblx0cmVzZXRDdXJzb3IoKTtcbn1cbiIsICIvLyBVbmlxdWUgSUQgY3JlYXRpb24gcmVxdWlyZXMgYSBoaWdoIHF1YWxpdHkgcmFuZG9tICMgZ2VuZXJhdG9yLiBJbiB0aGUgYnJvd3NlciB3ZSB0aGVyZWZvcmVcbi8vIHJlcXVpcmUgdGhlIGNyeXB0byBBUEkgYW5kIGRvIG5vdCBzdXBwb3J0IGJ1aWx0LWluIGZhbGxiYWNrIHRvIGxvd2VyIHF1YWxpdHkgcmFuZG9tIG51bWJlclxuLy8gZ2VuZXJhdG9ycyAobGlrZSBNYXRoLnJhbmRvbSgpKS5cbmxldCBnZXRSYW5kb21WYWx1ZXM7XG5jb25zdCBybmRzOCA9IG5ldyBVaW50OEFycmF5KDE2KTtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHJuZygpIHtcbiAgLy8gbGF6eSBsb2FkIHNvIHRoYXQgZW52aXJvbm1lbnRzIHRoYXQgbmVlZCB0byBwb2x5ZmlsbCBoYXZlIGEgY2hhbmNlIHRvIGRvIHNvXG4gIGlmICghZ2V0UmFuZG9tVmFsdWVzKSB7XG4gICAgLy8gZ2V0UmFuZG9tVmFsdWVzIG5lZWRzIHRvIGJlIGludm9rZWQgaW4gYSBjb250ZXh0IHdoZXJlIFwidGhpc1wiIGlzIGEgQ3J5cHRvIGltcGxlbWVudGF0aW9uLlxuICAgIGdldFJhbmRvbVZhbHVlcyA9IHR5cGVvZiBjcnlwdG8gIT09ICd1bmRlZmluZWQnICYmIGNyeXB0by5nZXRSYW5kb21WYWx1ZXMgJiYgY3J5cHRvLmdldFJhbmRvbVZhbHVlcy5iaW5kKGNyeXB0byk7XG5cbiAgICBpZiAoIWdldFJhbmRvbVZhbHVlcykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKCkgbm90IHN1cHBvcnRlZC4gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS91dWlkanMvdXVpZCNnZXRyYW5kb212YWx1ZXMtbm90LXN1cHBvcnRlZCcpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBnZXRSYW5kb21WYWx1ZXMocm5kczgpO1xufSIsICJleHBvcnQgZGVmYXVsdCAvXig/OlswLTlhLWZdezh9LVswLTlhLWZdezR9LVsxLTVdWzAtOWEtZl17M30tWzg5YWJdWzAtOWEtZl17M30tWzAtOWEtZl17MTJ9fDAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCkkL2k7IiwgImltcG9ydCBSRUdFWCBmcm9tICcuL3JlZ2V4LmpzJztcblxuZnVuY3Rpb24gdmFsaWRhdGUodXVpZCkge1xuICByZXR1cm4gdHlwZW9mIHV1aWQgPT09ICdzdHJpbmcnICYmIFJFR0VYLnRlc3QodXVpZCk7XG59XG5cbmV4cG9ydCBkZWZhdWx0IHZhbGlkYXRlOyIsICJpbXBvcnQgdmFsaWRhdGUgZnJvbSAnLi92YWxpZGF0ZS5qcyc7XG4vKipcbiAqIENvbnZlcnQgYXJyYXkgb2YgMTYgYnl0ZSB2YWx1ZXMgdG8gVVVJRCBzdHJpbmcgZm9ybWF0IG9mIHRoZSBmb3JtOlxuICogWFhYWFhYWFgtWFhYWC1YWFhYLVhYWFgtWFhYWFhYWFhYWFhYXG4gKi9cblxuY29uc3QgYnl0ZVRvSGV4ID0gW107XG5cbmZvciAobGV0IGkgPSAwOyBpIDwgMjU2OyArK2kpIHtcbiAgYnl0ZVRvSGV4LnB1c2goKGkgKyAweDEwMCkudG9TdHJpbmcoMTYpLnNsaWNlKDEpKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVuc2FmZVN0cmluZ2lmeShhcnIsIG9mZnNldCA9IDApIHtcbiAgLy8gTm90ZTogQmUgY2FyZWZ1bCBlZGl0aW5nIHRoaXMgY29kZSEgIEl0J3MgYmVlbiB0dW5lZCBmb3IgcGVyZm9ybWFuY2VcbiAgLy8gYW5kIHdvcmtzIGluIHdheXMgeW91IG1heSBub3QgZXhwZWN0LiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3V1aWRqcy91dWlkL3B1bGwvNDM0XG4gIHJldHVybiBieXRlVG9IZXhbYXJyW29mZnNldCArIDBdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMV1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAyXV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDNdXSArICctJyArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgNF1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA1XV0gKyAnLScgKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDZdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgN11dICsgJy0nICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA4XV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDldXSArICctJyArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTBdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTFdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTJdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTNdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTRdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTVdXTtcbn1cblxuZnVuY3Rpb24gc3RyaW5naWZ5KGFyciwgb2Zmc2V0ID0gMCkge1xuICBjb25zdCB1dWlkID0gdW5zYWZlU3RyaW5naWZ5KGFyciwgb2Zmc2V0KTsgLy8gQ29uc2lzdGVuY3kgY2hlY2sgZm9yIHZhbGlkIFVVSUQuICBJZiB0aGlzIHRocm93cywgaXQncyBsaWtlbHkgZHVlIHRvIG9uZVxuICAvLyBvZiB0aGUgZm9sbG93aW5nOlxuICAvLyAtIE9uZSBvciBtb3JlIGlucHV0IGFycmF5IHZhbHVlcyBkb24ndCBtYXAgdG8gYSBoZXggb2N0ZXQgKGxlYWRpbmcgdG9cbiAgLy8gXCJ1bmRlZmluZWRcIiBpbiB0aGUgdXVpZClcbiAgLy8gLSBJbnZhbGlkIGlucHV0IHZhbHVlcyBmb3IgdGhlIFJGQyBgdmVyc2lvbmAgb3IgYHZhcmlhbnRgIGZpZWxkc1xuXG4gIGlmICghdmFsaWRhdGUodXVpZCkpIHtcbiAgICB0aHJvdyBUeXBlRXJyb3IoJ1N0cmluZ2lmaWVkIFVVSUQgaXMgaW52YWxpZCcpO1xuICB9XG5cbiAgcmV0dXJuIHV1aWQ7XG59XG5cbmV4cG9ydCBkZWZhdWx0IHN0cmluZ2lmeTsiLCAiaW1wb3J0IHZhbGlkYXRlIGZyb20gJy4vdmFsaWRhdGUuanMnO1xuXG5mdW5jdGlvbiBwYXJzZSh1dWlkKSB7XG4gIGlmICghdmFsaWRhdGUodXVpZCkpIHtcbiAgICB0aHJvdyBUeXBlRXJyb3IoJ0ludmFsaWQgVVVJRCcpO1xuICB9XG5cbiAgbGV0IHY7XG4gIGNvbnN0IGFyciA9IG5ldyBVaW50OEFycmF5KDE2KTsgLy8gUGFyc2UgIyMjIyMjIyMtLi4uLi0uLi4uLS4uLi4tLi4uLi4uLi4uLi4uXG5cbiAgYXJyWzBdID0gKHYgPSBwYXJzZUludCh1dWlkLnNsaWNlKDAsIDgpLCAxNikpID4+PiAyNDtcbiAgYXJyWzFdID0gdiA+Pj4gMTYgJiAweGZmO1xuICBhcnJbMl0gPSB2ID4+PiA4ICYgMHhmZjtcbiAgYXJyWzNdID0gdiAmIDB4ZmY7IC8vIFBhcnNlIC4uLi4uLi4uLSMjIyMtLi4uLi0uLi4uLS4uLi4uLi4uLi4uLlxuXG4gIGFycls0XSA9ICh2ID0gcGFyc2VJbnQodXVpZC5zbGljZSg5LCAxMyksIDE2KSkgPj4+IDg7XG4gIGFycls1XSA9IHYgJiAweGZmOyAvLyBQYXJzZSAuLi4uLi4uLi0uLi4uLSMjIyMtLi4uLi0uLi4uLi4uLi4uLi5cblxuICBhcnJbNl0gPSAodiA9IHBhcnNlSW50KHV1aWQuc2xpY2UoMTQsIDE4KSwgMTYpKSA+Pj4gODtcbiAgYXJyWzddID0gdiAmIDB4ZmY7IC8vIFBhcnNlIC4uLi4uLi4uLS4uLi4tLi4uLi0jIyMjLS4uLi4uLi4uLi4uLlxuXG4gIGFycls4XSA9ICh2ID0gcGFyc2VJbnQodXVpZC5zbGljZSgxOSwgMjMpLCAxNikpID4+PiA4O1xuICBhcnJbOV0gPSB2ICYgMHhmZjsgLy8gUGFyc2UgLi4uLi4uLi4tLi4uLi0uLi4uLS4uLi4tIyMjIyMjIyMjIyMjXG4gIC8vIChVc2UgXCIvXCIgdG8gYXZvaWQgMzItYml0IHRydW5jYXRpb24gd2hlbiBiaXQtc2hpZnRpbmcgaGlnaC1vcmRlciBieXRlcylcblxuICBhcnJbMTBdID0gKHYgPSBwYXJzZUludCh1dWlkLnNsaWNlKDI0LCAzNiksIDE2KSkgLyAweDEwMDAwMDAwMDAwICYgMHhmZjtcbiAgYXJyWzExXSA9IHYgLyAweDEwMDAwMDAwMCAmIDB4ZmY7XG4gIGFyclsxMl0gPSB2ID4+PiAyNCAmIDB4ZmY7XG4gIGFyclsxM10gPSB2ID4+PiAxNiAmIDB4ZmY7XG4gIGFyclsxNF0gPSB2ID4+PiA4ICYgMHhmZjtcbiAgYXJyWzE1XSA9IHYgJiAweGZmO1xuICByZXR1cm4gYXJyO1xufVxuXG5leHBvcnQgZGVmYXVsdCBwYXJzZTsiLCAiaW1wb3J0IHsgdW5zYWZlU3RyaW5naWZ5IH0gZnJvbSAnLi9zdHJpbmdpZnkuanMnO1xuaW1wb3J0IHBhcnNlIGZyb20gJy4vcGFyc2UuanMnO1xuXG5mdW5jdGlvbiBzdHJpbmdUb0J5dGVzKHN0cikge1xuICBzdHIgPSB1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoc3RyKSk7IC8vIFVURjggZXNjYXBlXG5cbiAgY29uc3QgYnl0ZXMgPSBbXTtcblxuICBmb3IgKGxldCBpID0gMDsgaSA8IHN0ci5sZW5ndGg7ICsraSkge1xuICAgIGJ5dGVzLnB1c2goc3RyLmNoYXJDb2RlQXQoaSkpO1xuICB9XG5cbiAgcmV0dXJuIGJ5dGVzO1xufVxuXG5leHBvcnQgY29uc3QgRE5TID0gJzZiYTdiODEwLTlkYWQtMTFkMS04MGI0LTAwYzA0ZmQ0MzBjOCc7XG5leHBvcnQgY29uc3QgVVJMID0gJzZiYTdiODExLTlkYWQtMTFkMS04MGI0LTAwYzA0ZmQ0MzBjOCc7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiB2MzUobmFtZSwgdmVyc2lvbiwgaGFzaGZ1bmMpIHtcbiAgZnVuY3Rpb24gZ2VuZXJhdGVVVUlEKHZhbHVlLCBuYW1lc3BhY2UsIGJ1Ziwgb2Zmc2V0KSB7XG4gICAgdmFyIF9uYW1lc3BhY2U7XG5cbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykge1xuICAgICAgdmFsdWUgPSBzdHJpbmdUb0J5dGVzKHZhbHVlKTtcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIG5hbWVzcGFjZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgIG5hbWVzcGFjZSA9IHBhcnNlKG5hbWVzcGFjZSk7XG4gICAgfVxuXG4gICAgaWYgKCgoX25hbWVzcGFjZSA9IG5hbWVzcGFjZSkgPT09IG51bGwgfHwgX25hbWVzcGFjZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX25hbWVzcGFjZS5sZW5ndGgpICE9PSAxNikge1xuICAgICAgdGhyb3cgVHlwZUVycm9yKCdOYW1lc3BhY2UgbXVzdCBiZSBhcnJheS1saWtlICgxNiBpdGVyYWJsZSBpbnRlZ2VyIHZhbHVlcywgMC0yNTUpJyk7XG4gICAgfSAvLyBDb21wdXRlIGhhc2ggb2YgbmFtZXNwYWNlIGFuZCB2YWx1ZSwgUGVyIDQuM1xuICAgIC8vIEZ1dHVyZTogVXNlIHNwcmVhZCBzeW50YXggd2hlbiBzdXBwb3J0ZWQgb24gYWxsIHBsYXRmb3JtcywgZS5nLiBgYnl0ZXMgPVxuICAgIC8vIGhhc2hmdW5jKFsuLi5uYW1lc3BhY2UsIC4uLiB2YWx1ZV0pYFxuXG5cbiAgICBsZXQgYnl0ZXMgPSBuZXcgVWludDhBcnJheSgxNiArIHZhbHVlLmxlbmd0aCk7XG4gICAgYnl0ZXMuc2V0KG5hbWVzcGFjZSk7XG4gICAgYnl0ZXMuc2V0KHZhbHVlLCBuYW1lc3BhY2UubGVuZ3RoKTtcbiAgICBieXRlcyA9IGhhc2hmdW5jKGJ5dGVzKTtcbiAgICBieXRlc1s2XSA9IGJ5dGVzWzZdICYgMHgwZiB8IHZlcnNpb247XG4gICAgYnl0ZXNbOF0gPSBieXRlc1s4XSAmIDB4M2YgfCAweDgwO1xuXG4gICAgaWYgKGJ1Zikge1xuICAgICAgb2Zmc2V0ID0gb2Zmc2V0IHx8IDA7XG5cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTY7ICsraSkge1xuICAgICAgICBidWZbb2Zmc2V0ICsgaV0gPSBieXRlc1tpXTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGJ1ZjtcbiAgICB9XG5cbiAgICByZXR1cm4gdW5zYWZlU3RyaW5naWZ5KGJ5dGVzKTtcbiAgfSAvLyBGdW5jdGlvbiNuYW1lIGlzIG5vdCBzZXR0YWJsZSBvbiBzb21lIHBsYXRmb3JtcyAoIzI3MClcblxuXG4gIHRyeSB7XG4gICAgZ2VuZXJhdGVVVUlELm5hbWUgPSBuYW1lOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tZW1wdHlcbiAgfSBjYXRjaCAoZXJyKSB7fSAvLyBGb3IgQ29tbW9uSlMgZGVmYXVsdCBleHBvcnQgc3VwcG9ydFxuXG5cbiAgZ2VuZXJhdGVVVUlELkROUyA9IEROUztcbiAgZ2VuZXJhdGVVVUlELlVSTCA9IFVSTDtcbiAgcmV0dXJuIGdlbmVyYXRlVVVJRDtcbn0iLCAiY29uc3QgcmFuZG9tVVVJRCA9IHR5cGVvZiBjcnlwdG8gIT09ICd1bmRlZmluZWQnICYmIGNyeXB0by5yYW5kb21VVUlEICYmIGNyeXB0by5yYW5kb21VVUlELmJpbmQoY3J5cHRvKTtcbmV4cG9ydCBkZWZhdWx0IHtcbiAgcmFuZG9tVVVJRFxufTsiLCAiaW1wb3J0IG5hdGl2ZSBmcm9tICcuL25hdGl2ZS5qcyc7XG5pbXBvcnQgcm5nIGZyb20gJy4vcm5nLmpzJztcbmltcG9ydCB7IHVuc2FmZVN0cmluZ2lmeSB9IGZyb20gJy4vc3RyaW5naWZ5LmpzJztcblxuZnVuY3Rpb24gdjQob3B0aW9ucywgYnVmLCBvZmZzZXQpIHtcbiAgaWYgKG5hdGl2ZS5yYW5kb21VVUlEICYmICFidWYgJiYgIW9wdGlvbnMpIHtcbiAgICByZXR1cm4gbmF0aXZlLnJhbmRvbVVVSUQoKTtcbiAgfVxuXG4gIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICBjb25zdCBybmRzID0gb3B0aW9ucy5yYW5kb20gfHwgKG9wdGlvbnMucm5nIHx8IHJuZykoKTsgLy8gUGVyIDQuNCwgc2V0IGJpdHMgZm9yIHZlcnNpb24gYW5kIGBjbG9ja19zZXFfaGlfYW5kX3Jlc2VydmVkYFxuXG4gIHJuZHNbNl0gPSBybmRzWzZdICYgMHgwZiB8IDB4NDA7XG4gIHJuZHNbOF0gPSBybmRzWzhdICYgMHgzZiB8IDB4ODA7IC8vIENvcHkgYnl0ZXMgdG8gYnVmZmVyLCBpZiBwcm92aWRlZFxuXG4gIGlmIChidWYpIHtcbiAgICBvZmZzZXQgPSBvZmZzZXQgfHwgMDtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTY7ICsraSkge1xuICAgICAgYnVmW29mZnNldCArIGldID0gcm5kc1tpXTtcbiAgICB9XG5cbiAgICByZXR1cm4gYnVmO1xuICB9XG5cbiAgcmV0dXJuIHVuc2FmZVN0cmluZ2lmeShybmRzKTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgdjQ7IiwgIi8vIEFkYXB0ZWQgZnJvbSBDaHJpcyBWZW5lc3MnIFNIQTEgY29kZSBhdFxuLy8gaHR0cDovL3d3dy5tb3ZhYmxlLXR5cGUuY28udWsvc2NyaXB0cy9zaGExLmh0bWxcbmZ1bmN0aW9uIGYocywgeCwgeSwgeikge1xuICBzd2l0Y2ggKHMpIHtcbiAgICBjYXNlIDA6XG4gICAgICByZXR1cm4geCAmIHkgXiB+eCAmIHo7XG5cbiAgICBjYXNlIDE6XG4gICAgICByZXR1cm4geCBeIHkgXiB6O1xuXG4gICAgY2FzZSAyOlxuICAgICAgcmV0dXJuIHggJiB5IF4geCAmIHogXiB5ICYgejtcblxuICAgIGNhc2UgMzpcbiAgICAgIHJldHVybiB4IF4geSBeIHo7XG4gIH1cbn1cblxuZnVuY3Rpb24gUk9UTCh4LCBuKSB7XG4gIHJldHVybiB4IDw8IG4gfCB4ID4+PiAzMiAtIG47XG59XG5cbmZ1bmN0aW9uIHNoYTEoYnl0ZXMpIHtcbiAgY29uc3QgSyA9IFsweDVhODI3OTk5LCAweDZlZDllYmExLCAweDhmMWJiY2RjLCAweGNhNjJjMWQ2XTtcbiAgY29uc3QgSCA9IFsweDY3NDUyMzAxLCAweGVmY2RhYjg5LCAweDk4YmFkY2ZlLCAweDEwMzI1NDc2LCAweGMzZDJlMWYwXTtcblxuICBpZiAodHlwZW9mIGJ5dGVzID09PSAnc3RyaW5nJykge1xuICAgIGNvbnN0IG1zZyA9IHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChieXRlcykpOyAvLyBVVEY4IGVzY2FwZVxuXG4gICAgYnl0ZXMgPSBbXTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbXNnLmxlbmd0aDsgKytpKSB7XG4gICAgICBieXRlcy5wdXNoKG1zZy5jaGFyQ29kZUF0KGkpKTtcbiAgICB9XG4gIH0gZWxzZSBpZiAoIUFycmF5LmlzQXJyYXkoYnl0ZXMpKSB7XG4gICAgLy8gQ29udmVydCBBcnJheS1saWtlIHRvIEFycmF5XG4gICAgYnl0ZXMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChieXRlcyk7XG4gIH1cblxuICBieXRlcy5wdXNoKDB4ODApO1xuICBjb25zdCBsID0gYnl0ZXMubGVuZ3RoIC8gNCArIDI7XG4gIGNvbnN0IE4gPSBNYXRoLmNlaWwobCAvIDE2KTtcbiAgY29uc3QgTSA9IG5ldyBBcnJheShOKTtcblxuICBmb3IgKGxldCBpID0gMDsgaSA8IE47ICsraSkge1xuICAgIGNvbnN0IGFyciA9IG5ldyBVaW50MzJBcnJheSgxNik7XG5cbiAgICBmb3IgKGxldCBqID0gMDsgaiA8IDE2OyArK2opIHtcbiAgICAgIGFycltqXSA9IGJ5dGVzW2kgKiA2NCArIGogKiA0XSA8PCAyNCB8IGJ5dGVzW2kgKiA2NCArIGogKiA0ICsgMV0gPDwgMTYgfCBieXRlc1tpICogNjQgKyBqICogNCArIDJdIDw8IDggfCBieXRlc1tpICogNjQgKyBqICogNCArIDNdO1xuICAgIH1cblxuICAgIE1baV0gPSBhcnI7XG4gIH1cblxuICBNW04gLSAxXVsxNF0gPSAoYnl0ZXMubGVuZ3RoIC0gMSkgKiA4IC8gTWF0aC5wb3coMiwgMzIpO1xuICBNW04gLSAxXVsxNF0gPSBNYXRoLmZsb29yKE1bTiAtIDFdWzE0XSk7XG4gIE1bTiAtIDFdWzE1XSA9IChieXRlcy5sZW5ndGggLSAxKSAqIDggJiAweGZmZmZmZmZmO1xuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgTjsgKytpKSB7XG4gICAgY29uc3QgVyA9IG5ldyBVaW50MzJBcnJheSg4MCk7XG5cbiAgICBmb3IgKGxldCB0ID0gMDsgdCA8IDE2OyArK3QpIHtcbiAgICAgIFdbdF0gPSBNW2ldW3RdO1xuICAgIH1cblxuICAgIGZvciAobGV0IHQgPSAxNjsgdCA8IDgwOyArK3QpIHtcbiAgICAgIFdbdF0gPSBST1RMKFdbdCAtIDNdIF4gV1t0IC0gOF0gXiBXW3QgLSAxNF0gXiBXW3QgLSAxNl0sIDEpO1xuICAgIH1cblxuICAgIGxldCBhID0gSFswXTtcbiAgICBsZXQgYiA9IEhbMV07XG4gICAgbGV0IGMgPSBIWzJdO1xuICAgIGxldCBkID0gSFszXTtcbiAgICBsZXQgZSA9IEhbNF07XG5cbiAgICBmb3IgKGxldCB0ID0gMDsgdCA8IDgwOyArK3QpIHtcbiAgICAgIGNvbnN0IHMgPSBNYXRoLmZsb29yKHQgLyAyMCk7XG4gICAgICBjb25zdCBUID0gUk9UTChhLCA1KSArIGYocywgYiwgYywgZCkgKyBlICsgS1tzXSArIFdbdF0gPj4+IDA7XG4gICAgICBlID0gZDtcbiAgICAgIGQgPSBjO1xuICAgICAgYyA9IFJPVEwoYiwgMzApID4+PiAwO1xuICAgICAgYiA9IGE7XG4gICAgICBhID0gVDtcbiAgICB9XG5cbiAgICBIWzBdID0gSFswXSArIGEgPj4+IDA7XG4gICAgSFsxXSA9IEhbMV0gKyBiID4+PiAwO1xuICAgIEhbMl0gPSBIWzJdICsgYyA+Pj4gMDtcbiAgICBIWzNdID0gSFszXSArIGQgPj4+IDA7XG4gICAgSFs0XSA9IEhbNF0gKyBlID4+PiAwO1xuICB9XG5cbiAgcmV0dXJuIFtIWzBdID4+IDI0ICYgMHhmZiwgSFswXSA+PiAxNiAmIDB4ZmYsIEhbMF0gPj4gOCAmIDB4ZmYsIEhbMF0gJiAweGZmLCBIWzFdID4+IDI0ICYgMHhmZiwgSFsxXSA+PiAxNiAmIDB4ZmYsIEhbMV0gPj4gOCAmIDB4ZmYsIEhbMV0gJiAweGZmLCBIWzJdID4+IDI0ICYgMHhmZiwgSFsyXSA+PiAxNiAmIDB4ZmYsIEhbMl0gPj4gOCAmIDB4ZmYsIEhbMl0gJiAweGZmLCBIWzNdID4+IDI0ICYgMHhmZiwgSFszXSA+PiAxNiAmIDB4ZmYsIEhbM10gPj4gOCAmIDB4ZmYsIEhbM10gJiAweGZmLCBIWzRdID4+IDI0ICYgMHhmZiwgSFs0XSA+PiAxNiAmIDB4ZmYsIEhbNF0gPj4gOCAmIDB4ZmYsIEhbNF0gJiAweGZmXTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgc2hhMTsiLCAiaW1wb3J0IHYzNSBmcm9tICcuL3YzNS5qcyc7XG5pbXBvcnQgc2hhMSBmcm9tICcuL3NoYTEuanMnO1xuY29uc3QgdjUgPSB2MzUoJ3Y1JywgMHg1MCwgc2hhMSk7XG5leHBvcnQgZGVmYXVsdCB2NTsiLCAiaW1wb3J0IHsgTWFya2Rvd25WaWV3LCBUZXh0RmlsZVZpZXcsIFZpZXcgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IFJFRkVSRU5DRV9SRUdFWCwgQUNUSU9OX1RZUEUsIFNWR19IT1ZFUl9DT0xPUiB9IGZyb20gXCIuL2NvbnN0YW50c1wiO1xuaW1wb3J0IHsgc3RhcnRSZWZlcmVuY2VFZmZlY3QsIGVuZFJlZmVyZW5jZUN1cnNvckVmZmVjdCB9IGZyb20gXCIuL2VmZmVjdHNcIjtcbmltcG9ydCB7XG5cdGdldEhvdmVyZWRDdXJzb3IsXG5cdHVwZGF0ZUhvdmVyZWRDdXJzb3IsXG5cdHJlbW92ZUhvdmVyZWRDdXJzb3IsXG5cdGdldEhvdmVyLFxufSBmcm9tIFwiLi9zdGF0ZVwiO1xuaW1wb3J0IHsgdXBkYXRlSG92ZXJlZEN1cnNvckNvbG9yIH0gZnJvbSBcIi4vcmVmZXJlbmNlc1wiO1xuXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VFZGl0b3JQb3NpdGlvbihwb3NpdGlvblN0cmluZzogc3RyaW5nKSB7XG5cdGxldCBbbGluZSwgY2hdID0gcG9zaXRpb25TdHJpbmcuc3BsaXQoXCIsXCIpO1xuXHRyZXR1cm4geyBsaW5lOiBwYXJzZUludChsaW5lKSwgY2g6IHBhcnNlSW50KGNoKSB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZW5jb2RlVVJJQ29tcG9uZW50U3RyaW5nKHN0cjogc3RyaW5nKTogc3RyaW5nIHtcblx0cmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChzdHIpLnJlcGxhY2UoL1s6KCldL2csIGZ1bmN0aW9uIChjKSB7XG5cdFx0cmV0dXJuIFwiJVwiICsgYy5jaGFyQ29kZUF0KDApLnRvU3RyaW5nKDE2KTtcblx0fSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkZWNvZGVVUklDb21wb25lbnRTdHJpbmcoc3RyOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRyZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KFxuXHRcdHN0ci5yZXBsYWNlKC8lM0EvZywgXCI6XCIpLnJlcGxhY2UoLyUyOC9nLCBcIihcIikucmVwbGFjZSgvJTI5L2csIFwiKVwiKVxuXHQpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcHJvY2Vzc1VSSShcblx0ZGF0YVN0cmluZzogc3RyaW5nXG4pOiBbXG5cdHByZWZpeDogc3RyaW5nLFxuXHR0ZXh0OiBzdHJpbmcsXG5cdHN1ZmZpeDogc3RyaW5nLFxuXHRmaWxlOiBzdHJpbmcsXG5cdGZyb206IG51bWJlcixcblx0dG86IG51bWJlcixcblx0cG9ydGFsOiBzdHJpbmcsXG5cdHRvZ2dsZTogc3RyaW5nXG5dIHtcblx0bGV0IFtwcmVmaXgsIHRleHQsIHN1ZmZpeCwgZmlsZSwgZnJvbSwgdG8sIHBvcnRhbCwgdG9nZ2xlXSA9XG5cdFx0ZGF0YVN0cmluZy5zcGxpdChcIjpcIik7XG5cdHByZWZpeCA9IGRlY29kZVVSSUNvbXBvbmVudFN0cmluZyhwcmVmaXgpO1xuXHR0ZXh0ID0gZGVjb2RlVVJJQ29tcG9uZW50U3RyaW5nKHRleHQpO1xuXHRzdWZmaXggPSBkZWNvZGVVUklDb21wb25lbnRTdHJpbmcoc3VmZml4KTtcblx0ZmlsZSA9IGRlY29kZVVSSUNvbXBvbmVudFN0cmluZyhmaWxlKTtcblx0ZnJvbSA9IGRlY29kZVVSSUNvbXBvbmVudFN0cmluZyhmcm9tKTtcblx0dG8gPSBkZWNvZGVVUklDb21wb25lbnRTdHJpbmcodG8pO1xuXHRpZiAocG9ydGFsKSBwb3J0YWwgPSBkZWNvZGVVUklDb21wb25lbnRTdHJpbmcocG9ydGFsKTtcblx0dG9nZ2xlID0gZGVjb2RlVVJJQ29tcG9uZW50U3RyaW5nKHRvZ2dsZSk7XG5cblx0cmV0dXJuIFtcblx0XHRwcmVmaXgsXG5cdFx0dGV4dCxcblx0XHRzdWZmaXgsXG5cdFx0ZmlsZSxcblx0XHRwYXJzZUludChmcm9tKSxcblx0XHRwYXJzZUludCh0byksXG5cdFx0cG9ydGFsLFxuXHRcdHRvZ2dsZSxcblx0XTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFByZWZpeEFuZFN1ZmZpeChkb2N1bWVudDogc3RyaW5nLCBmcm9tOiBudW1iZXIsIHRvOiBudW1iZXIpIHtcblx0bGV0IHByZWZpeCA9IGRvY3VtZW50XG5cdFx0LnNsaWNlKGZyb20gLSAyNSwgZnJvbSlcblx0XHQuc3BsaXQoXCJcXG5cIilcblx0XHQuc2xpY2UoLTEpWzBdO1xuXHQvLyAuc2xpY2UoZnJvbSAtIDI1ID4gMCA/IGZyb20gLSAyNSA6IDAsIGZyb20pXG5cblx0bGV0IHN1ZmZpeCA9IGRvY3VtZW50LnNsaWNlKHRvLCB0byArIDI1KS5zcGxpdChcIlxcblwiKVswXTtcblx0cmV0dXJuIHsgcHJlZml4LCBzdWZmaXggfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGZpbmRUZXh0UG9zaXRpb25zKFxuXHR0ZXh0OiBzdHJpbmcsXG5cdHNlYXJjaFRlcm06IHN0cmluZyxcblx0cHJlZml4OiBzdHJpbmcgPSBcIlwiLFxuXHRzdWZmaXg6IHN0cmluZyA9IFwiXCJcbikge1xuXHRsZXQgcm9sbGluZ0luZGV4ID0gMDtcblxuXHRjb25zdCBsaW5lcyA9IHRleHQuc3BsaXQoXCJcXG5cIikubWFwKChsaW5lOiBzdHJpbmcsIGk6IG51bWJlcikgPT4ge1xuXHRcdGxldCBkYXRhID0geyBsaW5lLCBpbmRleDogcm9sbGluZ0luZGV4LCBsZW5ndGg6IGxpbmUubGVuZ3RoICsgMSwgaSB9O1xuXHRcdHJvbGxpbmdJbmRleCArPSBkYXRhLmxlbmd0aDtcblx0XHRyZXR1cm4gZGF0YTtcblx0fSk7XG5cblx0aWYgKHRleHQuaW5jbHVkZXMocHJlZml4ICsgc2VhcmNoVGVybSArIHN1ZmZpeCkpIHtcblx0XHRsZXQgbWF0Y2hJbmRleCA9IHRleHQuaW5kZXhPZihwcmVmaXggKyBzZWFyY2hUZXJtICsgc3VmZml4KTtcblx0XHRsZXQgc3RhcnRJbmRleCA9XG5cdFx0XHRsaW5lcy5maW5kSW5kZXgoKGxpbmU6IGFueSkgPT4gbGluZS5pbmRleCA+IG1hdGNoSW5kZXggKyBwcmVmaXgubGVuZ3RoKSAtXG5cdFx0XHQxO1xuXHRcdGxldCBlbmRJbmRleCA9XG5cdFx0XHRsaW5lcy5maW5kSW5kZXgoXG5cdFx0XHRcdChsaW5lOiBhbnkpID0+XG5cdFx0XHRcdFx0bGluZS5pbmRleCA+IG1hdGNoSW5kZXggKyBwcmVmaXgubGVuZ3RoICsgc2VhcmNoVGVybS5sZW5ndGhcblx0XHRcdCkgLSAxO1xuXG5cdFx0aWYgKHN0YXJ0SW5kZXggPT0gLTIpIHN0YXJ0SW5kZXggPSBsaW5lcy5sZW5ndGggLSAxO1xuXHRcdGlmIChlbmRJbmRleCA9PSAtMikgZW5kSW5kZXggPSBsaW5lcy5sZW5ndGggLSAxO1xuXG5cdFx0cmV0dXJuIHtcblx0XHRcdHJhbmdlU3RhcnQ6IHtcblx0XHRcdFx0bGluZTogc3RhcnRJbmRleCxcblx0XHRcdFx0Y2g6IG1hdGNoSW5kZXggKyBwcmVmaXgubGVuZ3RoIC0gbGluZXNbc3RhcnRJbmRleF0uaW5kZXgsXG5cdFx0XHR9LFxuXHRcdFx0cmFuZ2VFbmQ6IHtcblx0XHRcdFx0bGluZTogZW5kSW5kZXgsXG5cdFx0XHRcdGNoOlxuXHRcdFx0XHRcdG1hdGNoSW5kZXggK1xuXHRcdFx0XHRcdHByZWZpeC5sZW5ndGggK1xuXHRcdFx0XHRcdHNlYXJjaFRlcm0ubGVuZ3RoIC1cblx0XHRcdFx0XHRsaW5lc1tlbmRJbmRleF0uaW5kZXgsXG5cdFx0XHR9LFxuXHRcdFx0bGluZXMsXG5cdFx0fTtcblx0fVxuXHRyZXR1cm4gbnVsbDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGxpc3RJdGVtTGVuZ3RoKGxpbmU6IHN0cmluZykge1xuXHQvLyBNYXRjaGVzIGxpbmVzIHRoYXQgc3RhcnQgd2l0aCBhIGJ1bGxldCAoZWl0aGVyIC0sICosIG9yICsgZm9sbG93ZWQgYnkgYSBzcGFjZSlcblx0Y29uc3QgYnVsbGV0UmVnZXggPSAvXihcXHMqWy0qK11cXHMrKS87XG5cblx0Ly8gTWF0Y2hlcyBsaW5lcyB0aGF0IHN0YXJ0IHdpdGggYSBudW1iZXIgZm9sbG93ZWQgYnkgYSBkb3QgYW5kIGEgc3BhY2UgKGxpa2UgXCIxLiBcIilcblx0Y29uc3QgbnVtYmVyUmVnZXggPSAvXihcXHMqXFxkK1xcLlxccyspLztcblxuXHRsZXQgbWF0Y2ggPSBsaW5lLm1hdGNoKGJ1bGxldFJlZ2V4KSB8fCBsaW5lLm1hdGNoKG51bWJlclJlZ2V4KTtcblx0cmV0dXJuIG1hdGNoID8gbWF0Y2hbMF0ubGVuZ3RoIDogMDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNoZWNrQ3Vyc29yUG9zaXRpb25BdERhdGFzdHJpbmcoZXZ0OiBFdmVudCk6IHtcblx0bWF0Y2hlZDogYm9vbGVhbjtcblx0c3BhbjogSFRNTFNwYW5FbGVtZW50IHwgdW5kZWZpbmVkO1xufSB7XG5cdGNvbnN0IGFjdGl2ZVZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuXHRjb25zdCBjdXJzb3JGcm9tID0gYWN0aXZlVmlldz8uZWRpdG9yLmdldEN1cnNvcihcImZyb21cIik7XG5cdGNvbnN0IGN1cnNvclRvID0gYWN0aXZlVmlldz8uZWRpdG9yLmdldEN1cnNvcihcInRvXCIpO1xuXG5cdGxldCBtYXRjaGVkID0gZmFsc2U7XG5cdGxldCBtYXRjaFNwYW46IEhUTUxTcGFuRWxlbWVudCB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZDtcblx0aWYgKFxuXHRcdGN1cnNvckZyb20gJiZcblx0XHRjdXJzb3JUbyAmJlxuXHRcdGN1cnNvckZyb20uY2ggPT0gY3Vyc29yVG8uY2ggJiZcblx0XHRjdXJzb3JGcm9tLmxpbmUgPT0gY3Vyc29yVG8ubGluZVxuXHRcdC8vICYmY3Vyc29yRnJvbS5jaCAtIDEgPj0gLTFcblx0KSB7XG5cdFx0Y29uc3QgbGluZVRleHQgPSBhY3RpdmVWaWV3Py5lZGl0b3IuZ2V0TGluZShjdXJzb3JGcm9tLmxpbmUpO1xuXG5cdFx0Ly8gZnJvbSBwb3NzaWJsZSByZWdleCBtYXRjaGVzIGluIGxpbmVUZXh0XG5cdFx0aWYgKGxpbmVUZXh0KSB7XG5cdFx0XHRjb25zdCBtYXRjaGVzID0gWy4uLmxpbmVUZXh0Lm1hdGNoQWxsKFJFRkVSRU5DRV9SRUdFWCldO1xuXHRcdFx0bWF0Y2hlcy5mb3JFYWNoKChtYXRjaCkgPT4ge1xuXHRcdFx0XHRpZiAobWF0Y2guaW5kZXg/LnRvU3RyaW5nKCkpIHtcblx0XHRcdFx0XHRjb25zdCBzdGFydDogbnVtYmVyID0gbWF0Y2guaW5kZXg7XG5cdFx0XHRcdFx0Y29uc3QgZW5kOiBudW1iZXIgPSBzdGFydCArIG1hdGNoWzBdLmxlbmd0aDtcblx0XHRcdFx0XHRpZiAoZW5kID09IGN1cnNvclRvLmNoICYmIGV2dC50YXJnZXQpIHtcblx0XHRcdFx0XHRcdGNvbnN0IGRhdGFTdHJpbmcgPSBtYXRjaFsxXTtcblx0XHRcdFx0XHRcdC8vIGdldCB0aGUgaHRtbCBlbGVtZW50IGF0IHRoZSBtYXRjaCBsb2NhdGlvblxuXHRcdFx0XHRcdFx0bGV0IGNoZWNrQ29udGFpbmVyID0gZXZ0LnRhcmdldCBpbnN0YW5jZW9mIEVsZW1lbnQ7XG5cdFx0XHRcdFx0XHRpZiAoIWNoZWNrQ29udGFpbmVyKVxuXHRcdFx0XHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoXCJFbGVtZW50IG5vdCBpbnN0YW5jZSBvZiBFbGVtZW50XCIpO1xuXHRcdFx0XHRcdFx0bGV0IGNvbnRhaW5lciA9IGV2dC50YXJnZXQgYXMgRWxlbWVudDtcblxuXHRcdFx0XHRcdFx0Ly8gbGV0IGFjdGl2ZUxpbmU7XG5cdFx0XHRcdFx0XHQvLyBpZiAoY29udGFpbmVyLmNsYXNzTGlzdC5jb250YWlucyhcImNtLWFjdGl2ZVwiKSkge1xuXHRcdFx0XHRcdFx0Ly8gXHRhY3RpdmVMaW5lID0gY29udGFpbmVyO1xuXHRcdFx0XHRcdFx0Ly8gfVxuXHRcdFx0XHRcdFx0Ly8gLy8gZWxzZSBpZiAoY29udGFpbmVyLmNsb3Nlc3QoXCIuY20tYWN0aXZlXCIpKSB7XG5cdFx0XHRcdFx0XHQvLyAvLyBcdGFjdGl2ZUxpbmUgPSBjb250YWluZXIuY2xvc2VzdChcIi5jbS1hY3RpdmVcIik7XG5cdFx0XHRcdFx0XHQvLyAvLyB9XG5cdFx0XHRcdFx0XHQvLyBlbHNlIHtcblx0XHRcdFx0XHRcdC8vIFx0YWN0aXZlTGluZSA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiLmNtLWFjdGl2ZVwiKTtcblx0XHRcdFx0XHRcdC8vIH1cblx0XHRcdFx0XHRcdC8vIGlmICghYWN0aXZlTGluZSkgdGhyb3cgbmV3IEVycm9yKFwiRWxlbWVudCBub3QgaW5zdGFuY2Ugb2YgRWxlbWVudFwiKTtcblx0XHRcdFx0XHRcdC8vIGZpbmQgaHRtbCBzcGFuIGVsZW1lbnQgaW4gdGFyZ2V0IHRoYXQgaGFzIGEgZGF0YSBhdHRyaWJ1dGUgZXF1YWwgdG8gY29udGVudHNcblx0XHRcdFx0XHRcdGxldCBzcGFuID0gY29udGFpbmVyO1xuXHRcdFx0XHRcdFx0aWYgKCFzcGFuLmdldEF0dHJpYnV0ZShcImRhdGFcIikpXG5cdFx0XHRcdFx0XHRcdHNwYW4gPSBjb250YWluZXIucXVlcnlTZWxlY3Rvcihcblx0XHRcdFx0XHRcdFx0XHRgc3BhbltkYXRhPVwiJHtkYXRhU3RyaW5nfVwiXWBcblx0XHRcdFx0XHRcdFx0KSBhcyBIVE1MU3BhbkVsZW1lbnQ7XG5cblx0XHRcdFx0XHRcdGlmIChzcGFuICYmIHNwYW4gaW5zdGFuY2VvZiBIVE1MU3BhbkVsZW1lbnQpIHtcblx0XHRcdFx0XHRcdFx0Ly8gY29uc29sZS5sb2coXCJGb3VuZCBzcGFuIGVsZW1lbnQ6XCIsIHNwYW4pO1xuXHRcdFx0XHRcdFx0XHQvLyBEbyBzb21ldGhpbmcgd2l0aCB0aGUgc3BhbiBlbGVtZW50XG5cdFx0XHRcdFx0XHRcdG1hdGNoZWQgPSB0cnVlO1xuXG5cdFx0XHRcdFx0XHRcdG1hdGNoU3BhbiA9IHNwYW47XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHQvLyBjb25zb2xlLmxvZyhcIlNwYW4gZWxlbWVudCBub3QgZm91bmRcIik7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHR9XG5cdH1cblx0cmV0dXJuIHsgbWF0Y2hlZCwgc3BhbjogbWF0Y2hTcGFuIH07XG59XG5cbi8vIFJlbW92ZSBhbiBleGlzdG1haW5pbmcgaGlnbGlnaHRlZCByZWZlcmVuY2VcbmV4cG9ydCBmdW5jdGlvbiBoYW5kbGVSZW1vdmVIb3ZlcmVkQ3Vyc29yKHVzZXI6IHN0cmluZykge1xuXHRpZiAoZ2V0SG92ZXJlZEN1cnNvcigpKSB7XG5cdFx0Ly8gY3Vyc29ycyBub3QgYXNzb2NpYXRlZCB3aXRoIHRoZSB1c2VyIGFjdGlvblxuXHRcdGxldCBub25DdXJzb3JzID0gZ2V0SG92ZXJlZEN1cnNvcigpXG5cdFx0XHQuZmlsdGVyKChlbGVtZW50OiBhbnkpID0+IHtcblx0XHRcdFx0cmV0dXJuIGVsZW1lbnQudXNlciAhPT0gdXNlcjtcblx0XHRcdH0pXG5cdFx0XHQubWFwKChlbGVtZW50OiBhbnkpID0+IGVsZW1lbnQuY3Vyc29yLmNsb3Nlc3QoXCJzcGFuXCIpKTtcblxuXHRcdC8vIHdoaXRlIGJhY2tncm91bmQgaWYgY3Vyc29ycyBhcmUgbm90IGFzc29jaWF0ZWQgd2l0aCB0aGUgdXNlciBhY3Rpb25cblx0XHRnZXRIb3ZlcmVkQ3Vyc29yKClcblx0XHRcdC5maWx0ZXIoKGVsZW1lbnQ6IGFueSkgPT4gZWxlbWVudC51c2VyID09PSB1c2VyKVxuXHRcdFx0LmZvckVhY2goKGVsZW1lbnQ6IGFueSkgPT4ge1xuXHRcdFx0XHRpZiAoIW5vbkN1cnNvcnMuaW5jbHVkZXMoZWxlbWVudC5jdXJzb3IuY2xvc2VzdChcInNwYW5cIikpKSB7XG5cdFx0XHRcdFx0bGV0IHN2ZyA9IGVsZW1lbnQuY3Vyc29yO1xuXHRcdFx0XHRcdGlmICghc3ZnKSB0aHJvdyBuZXcgRXJyb3IoXCJTVkcgbm90IGZvdW5kXCIpO1xuXHRcdFx0XHRcdGlmIChzdmcuY2xhc3NMaXN0LmNvbnRhaW5zKFwicmVmZXJlbmNlLWljb25cIikpXG5cdFx0XHRcdFx0XHRzdmcuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCJ3aGl0ZVwiO1xuXHRcdFx0XHRcdGVsc2Uge1xuXHRcdFx0XHRcdFx0c3ZnLnNldEF0dHJpYnV0ZShcImZpbGxcIiwgXCJ3aGl0ZVwiKTtcblx0XHRcdFx0XHRcdHN2Zy5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIlwiO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRlbGVtZW50LmN1cnNvci5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIndoaXRlXCI7XG5cdFx0XHRcdFx0Ly8gZWxlbWVudC5jdXJzb3Iuc3R5bGUuYm94U2hhZG93ID0gXCJub25lXCI7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0cmVtb3ZlSG92ZXJlZEN1cnNvcih1c2VyKTtcblx0fVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY2hlY2tGb2N1c0N1cnNvcihldnQ6IEV2ZW50KSB7XG5cdGxldCB7IG1hdGNoZWQsIHNwYW4gfSA9IGNoZWNrQ3Vyc29yUG9zaXRpb25BdERhdGFzdHJpbmcoZXZ0KTtcblxuXHRpZiAobWF0Y2hlZCAmJiBzcGFuKSB7XG5cdFx0YXdhaXQgZW5kUmVmZXJlbmNlQ3Vyc29yRWZmZWN0KCk7IC8vIHRoaXMgdGFrZXMgMTAwbXMgdG8gY2xvc2UgZXhpc3RpbmcgcGVlayB0YWJcblx0XHRoYW5kbGVSZW1vdmVIb3ZlcmVkQ3Vyc29yKEFDVElPTl9UWVBFLkNVUlNPUik7XG5cdFx0dXBkYXRlSG92ZXJlZEN1cnNvckNvbG9yKHNwYW4sIEFDVElPTl9UWVBFLkNVUlNPUik7XG5cdFx0YXdhaXQgc3RhcnRSZWZlcmVuY2VFZmZlY3Qoc3BhbiwgQUNUSU9OX1RZUEUuQ1VSU09SKTtcblx0fSBlbHNlIHtcblx0XHRhd2FpdCBlbmRSZWZlcmVuY2VDdXJzb3JFZmZlY3QoKTtcblx0XHRoYW5kbGVSZW1vdmVIb3ZlcmVkQ3Vyc29yKEFDVElPTl9UWVBFLkNVUlNPUik7XG5cdH1cbn1cbiIsICJpbXBvcnQge1xuXHRUQWJzdHJhY3RGaWxlLFxuXHRURmlsZSxcblx0V29ya3NwYWNlLFxuXHRXb3Jrc3BhY2VMZWFmLFxuXHRXb3Jrc3BhY2VSb290LFxuXHRXb3Jrc3BhY2VTcGxpdCxcblx0V29ya3NwYWNlVGFicyxcbn0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBnZXRUaGF0IH0gZnJvbSBcIi4vc3RhdGVcIjtcbmltcG9ydCB7IGdldENvbnRhaW5lckVsZW1lbnQgfSBmcm9tIFwiLi9yZWZlcmVuY2VzXCI7XG5cbmZ1bmN0aW9uIGNvbGxlY3RMZWF2ZXNCeVRhYihcblx0c3BsaXQ6IFdvcmtzcGFjZVNwbGl0LFxuXHRyZXN1bHQ6IFtXb3Jrc3BhY2VMZWFmW11dIHwgW10gPSBbXVxuKSB7XG5cdC8vIEB0cy1pZ25vcmVcblx0Y29uc3QgdHlwZSA9IHNwbGl0LnR5cGU7XG5cdGlmICghdHlwZSkgdGhyb3cgbmV3IEVycm9yKFwiU3BsaXQgdHlwZSBub3QgZm91bmRcIik7XG5cblx0aWYgKHR5cGUgPT0gXCJ0YWJzXCIgfHwgdHlwZSA9PSBcInNwbGl0XCIpIHtcblx0XHQvLyBAdHMtaWdub3JlXG5cdFx0Y29uc3QgY2hpbGRyZW4gPSBzcGxpdC5jaGlsZHJlbjtcblx0XHRpZiAoIWNoaWxkcmVuKSB0aHJvdyBuZXcgRXJyb3IoXCJTcGxpdCBjaGlsZHJlbiBub3QgZm91bmRcIik7XG5cblx0XHRpZiAoY2hpbGRyZW4pIHtcblx0XHRcdGZvciAoY29uc3QgY2hpbGQgb2YgY2hpbGRyZW4pIHtcblx0XHRcdFx0bGV0IGVtcHR5TGlzdDogV29ya3NwYWNlTGVhZltdID0gW107XG5cblx0XHRcdFx0Y29sbGVjdExlYXZlc0J5VGFiKGNoaWxkLCByZXN1bHQpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHQvLyByZXN1bHQucHVzaChbXSk7XG5cdFx0Ly8gY29sbGVjdExlYXZlc0J5VGFiKGNoaWxkcmVuLCByZXN1bHQpO1xuXHR9IGVsc2UgaWYgKHR5cGUgPT0gXCJsZWFmXCIpIHtcblx0XHQvLyBAdHMtaWdub3JlXG5cdFx0Y29uc3QgcGFyZW50U3BsaXRJZCA9IHNwbGl0LnBhcmVudC5pZDtcblx0XHRpZiAoIXBhcmVudFNwbGl0SWQpIHRocm93IG5ldyBFcnJvcihcIlNwbGl0IHBhcmVudCBpZCBub3QgZm91bmRcIik7XG5cblx0XHQvLyBmaW5kIGFycmF5IGluZGV4IGZvciBzcGxpdCB3aXRoIGlkIHBhcmVudFNwbGl0SWRcblx0XHRsZXQgaWR4ID0gcmVzdWx0LmZpbmRJbmRleCgodGFiOiBXb3Jrc3BhY2VMZWFmW10pID0+IHtcblx0XHRcdC8vIEB0cy1pZ25vcmVcblx0XHRcdGNvbnN0IHRhYklkID0gdGFiWzBdLnBhcmVudC5pZDtcblx0XHRcdHJldHVybiB0YWJJZCA9PSBwYXJlbnRTcGxpdElkO1xuXHRcdH0pO1xuXHRcdGlmIChpZHggPT0gLTEpIHtcblx0XHRcdC8vIEB0cy1pZ25vcmVcblx0XHRcdHJlc3VsdC5wdXNoKFtzcGxpdCBhcyBXb3Jrc3BhY2VMZWFmXSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJlc3VsdFtpZHhdLnB1c2goc3BsaXQgYXMgV29ya3NwYWNlTGVhZik7XG5cdFx0fVxuXHR9XG5cblx0Ly8gaWYgKGNoaWxkcmVuKSB7XG5cdC8vIFx0Zm9yIChjb25zdCBjaGlsZCBvZiBjaGlsZHJlbikge1xuXHQvLyBcdFx0Y29sbGVjdExlYXZlc0J5VGFiKGNoaWxkLCByZXN1bHQpO1xuXHQvLyBcdH1cblx0Ly8gfVxuXHRyZXR1cm4gcmVzdWx0O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY29sbGVjdExlYXZlc0J5VGFiSGVscGVyKCkge1xuXHRjb25zdCB7IHdvcmtzcGFjZSB9ID0gZ2V0VGhhdCgpO1xuXHRjb25zdCBjdXJyTGVhZjogV29ya3NwYWNlTGVhZiA9IHdvcmtzcGFjZS5nZXRMZWFmKCk7XG5cdC8vIGNvbnN0IHJvb3RTcGxpdCA9IGZpbmRSb290U3BsaXQoY3VyckxlYWYpO1xuXHRjb25zdCByb290U3BsaXQ6IFdvcmtzcGFjZVNwbGl0ID0gY3VyckxlYWYuZ2V0Um9vdCgpO1xuXHRyZXR1cm4gY29sbGVjdExlYXZlc0J5VGFiKHJvb3RTcGxpdCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDdXJyZW50VGFiSW5kZXgobGVhdmVzQnlUYWI6IGFueVtdLCBzcGFuOiBIVE1MU3BhbkVsZW1lbnQpIHtcblx0bGV0IHdvcmtzcGFjZVRhYiA9IHNwYW4uY2xvc2VzdChcIi53b3Jrc3BhY2UtdGFic1wiKTtcblx0bGV0IGN1cnJUYWJJZHggPSBsZWF2ZXNCeVRhYi5maW5kSW5kZXgoKHRhYjogV29ya3NwYWNlTGVhZltdKSA9PiB7XG5cdFx0Y29uc3QgbGVhZlRhYiA9IHRhYlswXS52aWV3LmNvbnRhaW5lckVsLmNsb3Nlc3QoXCIud29ya3NwYWNlLXRhYnNcIik7XG5cdFx0cmV0dXJuIGxlYWZUYWIgPT0gd29ya3NwYWNlVGFiO1xuXHR9KTtcblx0cmV0dXJuIGN1cnJUYWJJZHg7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRBZGphY2VudFRhYnMoXG5cdGxlYXZlc0J5VGFiOiBhbnlbXSxcblx0Y3VyclRhYklkeDogbnVtYmVyLFxuXHRmaWxlOiBzdHJpbmdcbikge1xuXHRsZXQgcmlnaHRBZGphY2VudFRhYjogYW55W10gPSBbXTtcblx0bGV0IGxlZnRBZGphY2VudFRhYjogYW55W10gPSBbXTtcblx0bGV0IGFkamFjZW50VGFiczogYW55W10gPSBbXTtcblxuXHRpZiAobGVhdmVzQnlUYWJbY3VyclRhYklkeCArIDFdKSB7XG5cdFx0cmlnaHRBZGphY2VudFRhYiA9IGxlYXZlc0J5VGFiW2N1cnJUYWJJZHggKyAxXTtcblx0XHRhZGphY2VudFRhYnMgPSBbLi4uYWRqYWNlbnRUYWJzLCAuLi5yaWdodEFkamFjZW50VGFiXTtcblx0fVxuXHRpZiAobGVhdmVzQnlUYWJbY3VyclRhYklkeCAtIDFdKSB7XG5cdFx0bGVmdEFkamFjZW50VGFiID0gbGVhdmVzQnlUYWJbY3VyclRhYklkeCAtIDFdO1xuXHRcdGFkamFjZW50VGFicyA9IFsuLi5hZGphY2VudFRhYnMsIC4uLmxlZnRBZGphY2VudFRhYl07XG5cdH1cblxuXHRsZXQgaW5kZXggPSBhZGphY2VudFRhYnMuZmluZEluZGV4KFxuXHRcdCh4OiBXb3Jrc3BhY2VMZWFmKSA9PiB4LmdldFZpZXdTdGF0ZSgpLnN0YXRlLmZpbGUgPT0gZmlsZVxuXHQpO1xuXHRyZXR1cm4geyBhZGphY2VudFRhYnMsIHJpZ2h0QWRqYWNlbnRUYWIsIGxlZnRBZGphY2VudFRhYiwgaW5kZXggfTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIG9wZW5GaWxlSW5BZGphY2VudFRhYihcblx0bGVhdmVzQnlUYWI6IGFueVtdLFxuXHRjdXJyVGFiSWR4OiBudW1iZXIsXG5cdGZpbGU6IHN0cmluZyxcblx0dHlwZT86IHN0cmluZ1xuKSB7XG5cdGxldCB7IGFkamFjZW50VGFicywgcmlnaHRBZGphY2VudFRhYiwgbGVmdEFkamFjZW50VGFiIH0gPSBnZXRBZGphY2VudFRhYnMoXG5cdFx0bGVhdmVzQnlUYWIsXG5cdFx0Y3VyclRhYklkeCxcblx0XHRmaWxlXG5cdCk7XG5cblx0bGV0IGFsbFRhYk5hbWVzID0gbGVhdmVzQnlUYWIubWFwKCh0YWI6IFdvcmtzcGFjZUxlYWZbXSkgPT5cblx0XHR0YWIubWFwKCh4OiBXb3Jrc3BhY2VMZWFmKSA9PiB4LmdldFZpZXdTdGF0ZSgpLnN0YXRlLmZpbGUpXG5cdCk7XG5cdGxldCByaWdodEFkamFjZW50VGFiTmFtZXMgPSByaWdodEFkamFjZW50VGFiLm1hcChcblx0XHQoeDogV29ya3NwYWNlTGVhZikgPT4geC5nZXRWaWV3U3RhdGUoKS5zdGF0ZS5maWxlXG5cdCk7XG5cdGxldCBsZWZ0QWRqYWNlbnRUYWJOYW1lcyA9IGxlZnRBZGphY2VudFRhYi5tYXAoXG5cdFx0KHg6IFdvcmtzcGFjZUxlYWYpID0+IHguZ2V0Vmlld1N0YXRlKCkuc3RhdGUuZmlsZVxuXHQpO1xuXHRjb25zdCB7IHdvcmtzcGFjZSB9ID0gZ2V0VGhhdCgpO1xuXHRpZiAoXG5cdFx0YWxsVGFiTmFtZXNcblx0XHRcdC5maWx0ZXIoKHYsIGkpID0+IGkgIT0gY3VyclRhYklkeClcblx0XHRcdC5mbGF0KClcblx0XHRcdC5pbmNsdWRlcyhmaWxlKSAmJlxuXHRcdCFyaWdodEFkamFjZW50VGFiTmFtZXMuaW5jbHVkZXMoZmlsZSkgJiZcblx0XHQhbGVmdEFkamFjZW50VGFiTmFtZXMuaW5jbHVkZXMoZmlsZSlcblx0KSB7XG5cdFx0Ly8gZmlsZSBleGlzdHMsIG5vdCBhZGphY2VudCBsZWZ0IG9yIHJpZ2h0IHRhYlxuXHRcdGxldCBjdXJyZW50VGFiTmFtZXM6IGFueVtdID0gW107XG5cdFx0bGV0IGN1cnJlbnRUYWI6IGFueVtdID0gW107XG5cdFx0YWxsVGFiTmFtZXMuZm9yRWFjaCgodGFiTmFtZXMsIGkpID0+IHtcblx0XHRcdGlmIChcblx0XHRcdFx0dGFiTmFtZXMgIT0gcmlnaHRBZGphY2VudFRhYk5hbWVzICYmXG5cdFx0XHRcdHRhYk5hbWVzICE9IGxlZnRBZGphY2VudFRhYk5hbWVzICYmXG5cdFx0XHRcdGN1cnJUYWJJZHggIT0gaVxuXHRcdFx0KSB7XG5cdFx0XHRcdGlmICh0YWJOYW1lcy5pbmNsdWRlcyhmaWxlKSkge1xuXHRcdFx0XHRcdGN1cnJlbnRUYWJOYW1lcyA9IHRhYk5hbWVzO1xuXHRcdFx0XHRcdGN1cnJlbnRUYWIgPSBsZWF2ZXNCeVRhYltpXTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0Y29uc3Qgb3JpZ2luYWxMZWFmID0gY3VycmVudFRhYi5maWx0ZXIoXG5cdFx0XHQodCkgPT4gdC5jb250YWluZXJFbC5zdHlsZS5kaXNwbGF5ICE9IFwibm9uZVwiXG5cdFx0KVswXTtcblx0XHRsZXQgbGVhZiA9IGN1cnJlbnRUYWJbY3VycmVudFRhYk5hbWVzLmluZGV4T2YoZmlsZSldO1xuXHRcdHdvcmtzcGFjZS5yZXZlYWxMZWFmKGxlYWYpO1xuXG5cdFx0Y29uc29sZS5sb2coXCJvcGVuIGZpbGUgbmV3IHRhYlwiKTtcblxuXHRcdGNvbnNvbGUubG9nKGxlYWYpO1xuXHRcdGNvbnNvbGUubG9nKG9yaWdpbmFsTGVhZik7XG5cblx0XHRyZXR1cm4geyBuZXdMZWFmOiBsZWFmLCB0ZW1wOiBmYWxzZSwgb3JpZ2luYWxMZWFmIH07XG5cdH0gZWxzZSBpZiAocmlnaHRBZGphY2VudFRhYk5hbWVzLmluY2x1ZGVzKGZpbGUpKSB7XG5cdFx0Ly8gZmlsZSBleGlzdHMgaW4gcmlnaHQgdGFiXG5cdFx0Y29uc3Qgb3JpZ2luYWxMZWFmID0gcmlnaHRBZGphY2VudFRhYi5maWx0ZXIoXG5cdFx0XHQodCkgPT4gdC5jb250YWluZXJFbC5zdHlsZS5kaXNwbGF5ICE9IFwibm9uZVwiXG5cdFx0KVswXTtcblx0XHRsZXQgbGVhZiA9IHJpZ2h0QWRqYWNlbnRUYWJbcmlnaHRBZGphY2VudFRhYk5hbWVzLmluZGV4T2YoZmlsZSldO1xuXHRcdHdvcmtzcGFjZS5yZXZlYWxMZWFmKGxlYWYpO1xuXG5cdFx0Y29uc29sZS5sb2coXCJvcGVuIGV4aXN0aW5nIGZpbGUgcmlnaHQgdGFiXCIpO1xuXHRcdC8vIGNvbnN0IG9yaWdpbmFsTGVhZiA9IGxlYXZlc0J5VGFiW2N1cnJUYWJJZHhdLmZpbHRlcihcblx0XHQvLyBcdCh0OiBXb3Jrc3BhY2VMZWFmKSA9PiBnZXRDb250YWluZXJFbGVtZW50KHQpLnN0eWxlLmRpc3BsYXkgIT0gXCJub25lXCJcblx0XHQvLyApWzBdO1xuXG5cdFx0Y29uc29sZS5sb2cobGVhZik7XG5cdFx0Y29uc29sZS5sb2cob3JpZ2luYWxMZWFmKTtcblxuXHRcdHJldHVybiB7IG5ld0xlYWY6IGxlYWYsIHRlbXA6IGZhbHNlLCBvcmlnaW5hbExlYWYgfTtcblx0fSBlbHNlIGlmIChsZWZ0QWRqYWNlbnRUYWJOYW1lcy5pbmNsdWRlcyhmaWxlKSkge1xuXHRcdC8vIGZpbGUgZXhpc3RzIGluIGxlZnQgdGFiXG5cdFx0Y29uc3Qgb3JpZ2luYWxMZWFmID0gbGVmdEFkamFjZW50VGFiLmZpbHRlcihcblx0XHRcdCh0KSA9PiB0LmNvbnRhaW5lckVsLnN0eWxlLmRpc3BsYXkgIT0gXCJub25lXCJcblx0XHQpWzBdO1xuXG5cdFx0bGV0IGxlYWYgPSBsZWZ0QWRqYWNlbnRUYWJbbGVmdEFkamFjZW50VGFiTmFtZXMuaW5kZXhPZihmaWxlKV07XG5cdFx0d29ya3NwYWNlLnJldmVhbExlYWYobGVhZik7XG5cblx0XHRjb25zb2xlLmxvZyhcIm9wZW4gZXhpc3RpbmcgZmlsZSBsZWZ0IHRhYlwiKTtcblxuXHRcdC8vIGNvbnN0IG9yaWdpbmFsTGVhZiA9IGxlYXZlc0J5VGFiW2N1cnJUYWJJZHhdLmZpbHRlcihcblx0XHQvLyBcdCh0OiBXb3Jrc3BhY2VMZWFmKSA9PiBnZXRDb250YWluZXJFbGVtZW50KHQpLnN0eWxlLmRpc3BsYXkgIT0gXCJub25lXCJcblx0XHQvLyApWzBdO1xuXG5cdFx0Y29uc29sZS5sb2cobGVhZik7XG5cdFx0Y29uc29sZS5sb2cob3JpZ2luYWxMZWFmKTtcblxuXHRcdHJldHVybiB7IG5ld0xlYWY6IGxlYWYsIHRlbXA6IGZhbHNlLCBvcmlnaW5hbExlYWYgfTtcblx0fSBlbHNlIGlmIChyaWdodEFkamFjZW50VGFiLmxlbmd0aCA+IDApIHtcblx0XHQvLyB0aGVyZSBleGlzdHMgYSByaWdodCB0YWJcblx0XHRjb25zdCBvcmlnaW5hbExlYWYgPSByaWdodEFkamFjZW50VGFiLmZpbHRlcihcblx0XHRcdCh0KSA9PiB0LmNvbnRhaW5lckVsLnN0eWxlLmRpc3BsYXkgIT0gXCJub25lXCJcblx0XHQpWzBdO1xuXG5cdFx0bGV0IGN1cnJMZWFmID0gd29ya3NwYWNlLmdldExlYWYoKTtcblx0XHR3b3Jrc3BhY2Uuc2V0QWN0aXZlTGVhZihvcmlnaW5hbExlYWYpO1xuXHRcdGxldCBuZXdMZWFmID0gd29ya3NwYWNlLmdldExlYWYodHJ1ZSk7XG5cdFx0YXdhaXQgb3BlbkZpbGVJbkxlYWYobmV3TGVhZiwgZmlsZSk7XG5cdFx0d29ya3NwYWNlLnJldmVhbExlYWYobmV3TGVhZik7XG5cdFx0d29ya3NwYWNlLnNldEFjdGl2ZUxlYWYoY3VyckxlYWYpO1xuXG5cdFx0Y29uc29sZS5sb2coXCJvcGVuIG5ldyBmaWxlIHJpZ2h0IHRhYlwiKTtcblx0XHRjb25zb2xlLmxvZyhuZXdMZWFmKTtcblx0XHRjb25zb2xlLmxvZyhvcmlnaW5hbExlYWYpO1xuXG5cdFx0cmV0dXJuIHsgbmV3TGVhZiwgdGVtcDogdHJ1ZSwgb3JpZ2luYWxMZWFmIH07XG5cdH0gZWxzZSBpZiAobGVmdEFkamFjZW50VGFiLmxlbmd0aCA+IDApIHtcblx0XHQvLyB0aGVyZSBleGlzdHMgYSBsZWZ0IHRhYlxuXHRcdGNvbnN0IG9yaWdpbmFsTGVhZiA9IGxlZnRBZGphY2VudFRhYi5maWx0ZXIoXG5cdFx0XHQodCkgPT4gdC5jb250YWluZXJFbC5zdHlsZS5kaXNwbGF5ICE9IFwibm9uZVwiXG5cdFx0KVswXTtcblxuXHRcdGxldCBjdXJyTGVhZiA9IHdvcmtzcGFjZS5nZXRMZWFmKCk7IC8vIGdldCBjdXJyZW50IGFjdGl2ZSBsZWFmXG5cdFx0d29ya3NwYWNlLnNldEFjdGl2ZUxlYWYob3JpZ2luYWxMZWFmKTsgLy8gZ2V0IHRoZSBsZWFmIGluIGFkamFjZW50IHRhYlxuXHRcdGxldCBuZXdMZWFmID0gd29ya3NwYWNlLmdldExlYWYodHJ1ZSk7IC8vIGNyZWF0ZSBhIG5ldyBsZWFmXG5cdFx0YXdhaXQgb3BlbkZpbGVJbkxlYWYobmV3TGVhZiwgZmlsZSk7IC8vIGxvYWQgZmlsZSBpbnRvIG5ldyBsZWFmXG5cdFx0d29ya3NwYWNlLnJldmVhbExlYWYobmV3TGVhZik7IC8vIHJldmVhbCBuZXcgbGVhZlxuXHRcdHdvcmtzcGFjZS5zZXRBY3RpdmVMZWFmKGN1cnJMZWFmKTsgLy8gc2V0IGFjdGl2ZSBsZWFmIGJhY2sgdG8gb3JpZ2luYWxcblxuXHRcdGNvbnNvbGUubG9nKFwib3BlbiBuZXcgZmlsZSBsZWZ0IHRhYlwiKTtcblx0XHRjb25zb2xlLmxvZyhuZXdMZWFmKTtcblx0XHRjb25zb2xlLmxvZyhvcmlnaW5hbExlYWYpO1xuXG5cdFx0cmV0dXJuIHsgbmV3TGVhZiwgdGVtcDogdHJ1ZSwgb3JpZ2luYWxMZWFmIH07XG5cdH0gZWxzZSB7XG5cdFx0Ly8gbm8gYWRqYWNlbnQgdGFic1xuXHRcdGNvbnN0IGN1cnJMZWFmID0gd29ya3NwYWNlLmdldExlYWYoKTtcblx0XHRsZXQgbmV3TGVhZiA9IHdvcmtzcGFjZS5jcmVhdGVMZWFmQnlTcGxpdChjdXJyTGVhZik7XG5cdFx0YXdhaXQgb3BlbkZpbGVJbkxlYWYobmV3TGVhZiwgZmlsZSk7XG5cblx0XHRjb25zb2xlLmxvZyhcIm9wZW4gbmV3IGZpbGUgbGVmdCB0YWJcIik7XG5cdFx0Y29uc29sZS5sb2cobmV3TGVhZik7XG5cdFx0Y29uc29sZS5sb2coY3VyckxlYWYpO1xuXG5cdFx0cmV0dXJuIHsgbmV3TGVhZiwgdGVtcDogdHJ1ZSwgb3JpZ2luYWxMZWFmOiBjdXJyTGVhZiB9O1xuXHR9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBvcGVuRmlsZUluTGVhZihsZWFmOiBXb3Jrc3BhY2VMZWFmLCBmaWxlOiBzdHJpbmcpIHtcblx0bGV0IHRhcmdldEZpbGU6IFRBYnN0cmFjdEZpbGUgfCBudWxsID1cblx0XHRnZXRUaGF0KCkudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGUpO1xuXHRpZiAodGFyZ2V0RmlsZSAmJiB0YXJnZXRGaWxlIGluc3RhbmNlb2YgVEZpbGUpXG5cdFx0YXdhaXQgbGVhZi5vcGVuRmlsZSh0YXJnZXRGaWxlLCB7IGFjdGl2ZTogZmFsc2UgfSk7XG59XG4iLCAiaW1wb3J0IHtcblx0c3RhdGUsXG5cdHVwZGF0ZUN1cnNvcixcblx0dXBkYXRlSG92ZXIsXG5cdGdldEN1cnNvcixcblx0Z2V0SG92ZXIsXG5cdHJlc2V0SG92ZXIsXG5cdHJlc2V0Q3Vyc29yLFxuXHRnZXRUaGF0LFxuXHRnZXRCYWNrbGlua0hvdmVyLFxuXHR1cGRhdGVCYWNrbGlua0hvdmVyLFxuXHRyZXNldEJhY2tsaW5rSG92ZXIsXG5cdHVwZGF0ZUhvdmVyZWRDdXJzb3IsXG59IGZyb20gXCIuL3N0YXRlXCI7XG5pbXBvcnQgeyBBQ1RJT05fVFlQRSwgUkVGRVJFTkNFX1JFR0VYIH0gZnJvbSBcIi4vY29uc3RhbnRzXCI7XG5pbXBvcnQge1xuXHRjb2xsZWN0TGVhdmVzQnlUYWJIZWxwZXIsXG5cdGdldEN1cnJlbnRUYWJJbmRleCxcblx0b3BlbkZpbGVJbkFkamFjZW50VGFiLFxufSBmcm9tIFwiLi93b3Jrc3BhY2VcIjtcbmltcG9ydCB7IHByb2Nlc3NVUkksIGZpbmRUZXh0UG9zaXRpb25zIH0gZnJvbSBcIi4vdXRpbHNcIjtcbmltcG9ydCB7IE1hcmtkb3duVmlldywgV29ya3NwYWNlLCBXb3Jrc3BhY2VMZWFmIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQge1xuXHRkZWZhdWx0SGlnaGxpZ2h0U2VsZWN0aW9uLFxuXHRoaWdobGlnaHRTZWxlY3Rpb24sXG5cdHJlbW92ZUhpZ2hsaWdodCxcblx0cmVtb3ZlSGlnaGxpZ2h0cyxcbn0gZnJvbSBcIi4vbWFya1wiO1xuaW1wb3J0IHsgRWRpdG9yVmlldyB9IGZyb20gXCJAY29kZW1pcnJvci92aWV3XCI7XG5pbXBvcnQge1xuXHRnZXRCYWNrbGlua0NvbnRhaW5lcixcblx0Z2V0Q29udGFpbmVyRWxlbWVudCxcblx0Z2V0TWFya2Rvd25WaWV3LFxufSBmcm9tIFwiLi9yZWZlcmVuY2VzXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRFZGl0b3JWaWV3KGxlYWY6IFdvcmtzcGFjZUxlYWYpIHtcblx0aWYgKCFsZWFmKSByZXR1cm4gbnVsbDtcblx0Y29uc3QgdmlldyA9IGxlYWYudmlldztcblxuXHQvLyBAdHMtaWdub3JlXG5cdGNvbnN0IGVkaXRvciA9IHZpZXcuc291cmNlTW9kZT8uY21FZGl0b3I7XG5cblx0Ly8gJ2VkaXRvcicgaGVyZSBpcyBhbiBpbnN0YW5jZSBvZiAnRWRpdG9yJywgYW4gYWJzdHJhY3Rpb24gb3ZlciBDTTUgYW5kIENNNi5cblx0Ly8gQ2hlY2tpbmcgZm9yICdDb2RlTWlycm9yJyB3b3VsZCBpbmRpY2F0ZSBDTTUuXG5cdGlmICghZWRpdG9yLkNvZGVNaXJyb3IgJiYgZWRpdG9yLmNtIGluc3RhbmNlb2YgRWRpdG9yVmlldykge1xuXHRcdC8vIFlvdSBub3cgaGF2ZSBhY2Nlc3MgdG8gdGhlIENvZGVNaXJyb3IgNiBFZGl0b3JWaWV3IGluc3RhbmNlLlxuXHRcdGNvbnN0IGVkaXRvclZpZXcgPSBlZGl0b3IuY207XG5cblx0XHRyZXR1cm4gZWRpdG9yVmlldztcblxuXHRcdC8vIFlvdSBjYW4gbm93IHVzZSB0aGUgQ29kZU1pcnJvciA2IEFQSSB3aXRoIGBlZGl0b3JWaWV3YC5cblx0fVxuXHRyZXR1cm4gbnVsbDtcbn1cblxuZnVuY3Rpb24gY2hlY2tTcGFuRWxlbWVudEV4aXN0cyhcblx0c3BhbjogSFRNTFNwYW5FbGVtZW50LFxuXHRjb250YWluZXJFbDogSFRNTEVsZW1lbnRcbik6IGJvb2xlYW4ge1xuXHRjb25zdCBzcGFuRWxlbWVudHMgPSBjb250YWluZXJFbC5nZXRFbGVtZW50c0J5VGFnTmFtZShcInNwYW5cIik7XG5cdGZvciAobGV0IGkgPSAwOyBpIDwgc3BhbkVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7XG5cdFx0aWYgKHNwYW5FbGVtZW50c1tpXSA9PT0gc3Bhbikge1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXHR9XG5cdHJldHVybiBmYWxzZTtcbn1cblxuZnVuY3Rpb24gcGFyc2VDU1NTdHJpbmcoY3NzOiBzdHJpbmcpIHtcblx0Ly8gVXNlIGEgcmVndWxhciBleHByZXNzaW9uIHRvIG1hdGNoIGtleS12YWx1ZSBwYWlycyBpbiB0aGUgQ1NTIHN0cmluZ1xuXHRjb25zdCBjc3NQcm9wZXJ0aWVzUmVnZXggPSAvKFtcXHctXSspXFxzKjpcXHMqKFteO10rKVxccyo7Py9nO1xuXG5cdC8vIEluaXRpYWxpemUgYW4gZW1wdHkgb2JqZWN0IHRvIHN0b3JlIHRoZSBDU1MgcHJvcGVydGllc1xuXHRsZXQgY3NzUHJvcGVydGllc09iamVjdDogYW55ID0ge307XG5cblx0Ly8gSXRlcmF0ZSBvdmVyIGFsbCBrZXktdmFsdWUgcGFpcnMgZm91bmQgYnkgdGhlIHJlZ2V4XG5cdGxldCBtYXRjaDtcblx0d2hpbGUgKChtYXRjaCA9IGNzc1Byb3BlcnRpZXNSZWdleC5leGVjKGNzcykpICE9PSBudWxsKSB7XG5cdFx0Ly8gbWF0Y2hbMV0gaXMgdGhlIGtleVxuXHRcdC8vIG1hdGNoWzJdIGlzIHRoZSB2YWx1ZVxuXHRcdGNzc1Byb3BlcnRpZXNPYmplY3RbbWF0Y2hbMV1dID0gbWF0Y2hbMl07XG5cdH1cblxuXHRyZXR1cm4gY3NzUHJvcGVydGllc09iamVjdDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRlbGF5KG1pbGxpc2Vjb25kczogYW55KSB7XG5cdHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuXHRcdHNldFRpbWVvdXQocmVzb2x2ZSwgbWlsbGlzZWNvbmRzKTtcblx0fSk7XG59XG5cbmZ1bmN0aW9uIHRlbXBEaXJlY3Rpb25JbmRpY2F0b3IoXG5cdGxlYWY6IGFueSxcblx0dGV4dDogc3RyaW5nLFxuXHRwcmVmaXg6IHN0cmluZyxcblx0c3VmZml4OiBzdHJpbmcsXG5cdGRhdGFTdHJpbmc6IHN0cmluZyxcblx0aXNTYW1lOiBib29sZWFuLFxuXHR1c2VyPzogc3RyaW5nXG4pIHtcblx0aWYgKHVzZXIgPT09IEFDVElPTl9UWVBFLkJBQ0tMSU5LKSB7XG5cdFx0Ly8gT2ghIElcdTIwMTlkIGNvbXBhcmUgdGhlIGJib3ggb2YgdGhlIHJhbmdlXG5cdFx0Ly8gKHdoaWNoIEkga25vdyB5b3UgZmluZCBpbiB0aGUgbWFyayBsYXlvdXQgcm91dGluZSlcblx0XHQvLyB0byB0aGUgc2Nyb2xsVG9wICsgaW5uZXJIZWlnaHRcblx0XHRjb25zdCBlZGl0b3IgPSBnZXRNYXJrZG93blZpZXcobGVhZikuZWRpdG9yO1xuXHRcdGNvbnN0IGJhY2tsaW5rQ29udGFpbmVyID0gZ2V0QmFja2xpbmtDb250YWluZXIoZWRpdG9yKTtcblxuXHRcdGNvbnN0IHdpbmRvd0hlaWdodCA9IGxlYWYudmlldy5jb250YWluZXJFbFxuXHRcdFx0LnF1ZXJ5U2VsZWN0b3IoXCIuY20tc2Nyb2xsZXJcIilcblx0XHRcdC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHQ7XG5cdFx0Y29uc3Qgc2Nyb2xsVG9wID1cblx0XHRcdGxlYWYudmlldy5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKFwiLmNtLXNjcm9sbGVyXCIpLnNjcm9sbFRvcDtcblx0XHRjb25zdCBzY3JvbGxCb3R0b20gPSBzY3JvbGxUb3AgKyB3aW5kb3dIZWlnaHQ7XG5cblx0XHQvLyBHZXQgdGhlIGVsZW1lbnRzIHRoYXQgYXJlIGJldHdlZW4gdGhlIHRvcCBhbmQgYm90dG9tIG9mIHRoZSBzY3JlZW5cblx0XHQvLyBAdHMtaWdub3JlXG5cdFx0bGV0IGNvbnRhaW5lciA9IGVkaXRvci5jb250YWluZXJFbDtcblx0XHRsZXQgY29udGVudCA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiLmNtLWNvbnRlbnRcIik7XG5cdFx0bGV0IHJlZmVyZW5jZXMgPSBjb250ZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucmVmZXJlbmNlLWRhdGEtc3BhblwiKTtcblxuXHRcdGxldCB2aXNpYmxlRWxlbWVudHM6IEhUTUxFbGVtZW50W10gPSBbXTtcblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHJlZmVyZW5jZXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdGxldCBiYm94ID0gcmVmZXJlbmNlc1tpXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblx0XHRcdGlmIChiYm94LnRvcCA+PSBzY3JvbGxUb3AgJiYgYmJveC5ib3R0b20gPD0gc2Nyb2xsQm90dG9tKSB7XG5cdFx0XHRcdHZpc2libGVFbGVtZW50cy5wdXNoKHJlZmVyZW5jZXNbaV0pO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGxldCBkYXRhU3RyaW5ncyA9IHZpc2libGVFbGVtZW50cy5tYXAoKGVsOiBIVE1MRWxlbWVudCkgPT5cblx0XHRcdGVsLmdldEF0dHJpYnV0ZShcImRhdGFcIilcblx0XHQpO1xuXG5cdFx0bGV0IHN0YXJ0VG9wID0gbGVhZi52aWV3LmVkaXRvci5nZXRTY3JvbGxJbmZvKCkudG9wO1xuXG5cdFx0aWYgKCFkYXRhU3RyaW5ncy5pbmNsdWRlcyhkYXRhU3RyaW5nKSkge1xuXHRcdFx0bGV0IHBvc2l0aW9ucyA9IGZpbmRUZXh0UG9zaXRpb25zKFxuXHRcdFx0XHRsZWFmLnZpZXcuZGF0YSxcblx0XHRcdFx0dGV4dCxcblx0XHRcdFx0cHJlZml4LnNsaWNlKDAsIHByZWZpeC5sZW5ndGggLSAxKSxcblx0XHRcdFx0c3VmZml4LnNsaWNlKDEsIHN1ZmZpeC5sZW5ndGgpXG5cdFx0XHQpO1xuXHRcdFx0aWYgKCFwb3NpdGlvbnMpIHRocm93IG5ldyBFcnJvcihcIlBvc2l0aW9ucyBub3QgZm91bmRcIik7XG5cdFx0XHRsZXQgcmFuZ2VTdGFydCA9IHBvc2l0aW9ucy5yYW5nZVN0YXJ0O1xuXHRcdFx0bGV0IHJhbmdlRW5kID0gcG9zaXRpb25zLnJhbmdlRW5kO1xuXG5cdFx0XHRsZWFmLnZpZXcuZWRpdG9yLnNjcm9sbEludG9WaWV3KFxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0ZnJvbTogT2JqZWN0LmFzc2lnbihyYW5nZVN0YXJ0LCB7IGNoOiAwIH0pLFxuXHRcdFx0XHRcdHRvOiBPYmplY3QuYXNzaWduKHJhbmdlRW5kLCB7IGNoOiAwIH0pLFxuXHRcdFx0XHR9LFxuXHRcdFx0XHR0cnVlXG5cdFx0XHQpO1xuXHRcdH1cblxuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0Ly8gaWYgKHRlbXApIHJldHVybjtcblx0XHRcdGxldCBlbmRUb3AgPSBsZWFmLnZpZXcuZWRpdG9yLmdldFNjcm9sbEluZm8oKS50b3A7XG5cdFx0XHRjb25zb2xlLmxvZyhlbmRUb3ApO1xuXG5cdFx0XHRsZXQgY29udGFpbmVyID0gbGVhZi5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKFwiLnZpZXctY29udGVudFwiKTtcblx0XHRcdGNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKFwibm8tc2hhZG93XCIpO1xuXHRcdFx0Y29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoXCJuZXctc2hhZG93XCIpO1xuXHRcdFx0Y29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoXCJ0b3Atc2hhZG93XCIpO1xuXHRcdFx0Y29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoXCJib3R0b20tc2hhZG93XCIpO1xuXG5cdFx0XHRpZiAoc3RhcnRUb3AgPT09IGVuZFRvcCAmJiBpc1NhbWUpIHtcblx0XHRcdFx0Y29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJuby1zaGFkb3dcIik7XG5cdFx0XHR9IGVsc2UgaWYgKHN0YXJ0VG9wID09PSBlbmRUb3AgJiYgIWlzU2FtZSkge1xuXHRcdFx0XHRjb250YWluZXIuY2xhc3NMaXN0LmFkZChcIm5ldy1zaGFkb3dcIik7XG5cdFx0XHR9IGVsc2UgaWYgKHN0YXJ0VG9wIDwgZW5kVG9wKSB7XG5cdFx0XHRcdC8vIHNob3cgbWFyayBhYm92ZVxuXHRcdFx0XHRjb250YWluZXIuY2xhc3NMaXN0LmFkZChcInRvcC1zaGFkb3dcIik7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBzaG93IG1hcmsgYmVsb3dcblx0XHRcdFx0Y29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJib3R0b20tc2hhZG93XCIpO1xuXHRcdFx0fVxuXHRcdH0sIDI1KTtcblxuXHRcdHJldHVybjtcblx0fVxuXG5cdC8vIE9oISBJXHUyMDE5ZCBjb21wYXJlIHRoZSBiYm94IG9mIHRoZSByYW5nZVxuXHQvLyAod2hpY2ggSSBrbm93IHlvdSBmaW5kIGluIHRoZSBtYXJrIGxheW91dCByb3V0aW5lKVxuXHQvLyB0byB0aGUgc2Nyb2xsVG9wICsgaW5uZXJIZWlnaHRcblx0Y29uc3QgZWRpdG9yID0gZ2V0TWFya2Rvd25WaWV3KGxlYWYpLmVkaXRvcjtcblx0Y29uc3QgYmFja2xpbmtDb250YWluZXIgPSBnZXRCYWNrbGlua0NvbnRhaW5lcihlZGl0b3IpO1xuXG5cdGNvbnN0IHdpbmRvd0hlaWdodCA9IGxlYWYudmlldy5jb250YWluZXJFbFxuXHRcdC5xdWVyeVNlbGVjdG9yKFwiLmNtLXNjcm9sbGVyXCIpXG5cdFx0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmhlaWdodDtcblx0Y29uc3Qgc2Nyb2xsVG9wID1cblx0XHRsZWFmLnZpZXcuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvcihcIi5jbS1zY3JvbGxlclwiKS5zY3JvbGxUb3A7XG5cdGNvbnN0IHNjcm9sbEJvdHRvbSA9IHNjcm9sbFRvcCArIHdpbmRvd0hlaWdodDtcblxuXHQvLyBHZXQgdGhlIGVsZW1lbnRzIHRoYXQgYXJlIGJldHdlZW4gdGhlIHRvcCBhbmQgYm90dG9tIG9mIHRoZSBzY3JlZW5cblx0bGV0IHZpc2libGVFbGVtZW50czogc3RyaW5nW10gPSBbXTtcblx0Zm9yIChsZXQgaSA9IDA7IGkgPCBiYWNrbGlua0NvbnRhaW5lci5jaGlsZHJlbi5sZW5ndGg7IGkrKykge1xuXHRcdGxldCBzdHlsZSA9IGJhY2tsaW5rQ29udGFpbmVyLmNoaWxkcmVuW2ldLmdldEF0dHJpYnV0ZShcInN0eWxlXCIpO1xuXHRcdGlmIChzdHlsZSA9PSBudWxsKSBjb250aW51ZTtcblx0XHRsZXQgY3NzUHJvcGVydGllcyA9IHBhcnNlQ1NTU3RyaW5nKHN0eWxlKTtcblx0XHRsZXQgdG9wID0gcGFyc2VGbG9hdChjc3NQcm9wZXJ0aWVzW1widG9wXCJdLnJlcGxhY2UoXCJweFwiLCBcIlwiKSk7XG5cdFx0aWYgKHRvcCA9PSBudWxsKSBjb250aW51ZTtcblxuXHRcdGlmIChcblx0XHRcdHNjcm9sbFRvcCA8PSB0b3AgJiZcblx0XHRcdHRvcCA8PSBzY3JvbGxCb3R0b20gJiZcblx0XHRcdGJhY2tsaW5rQ29udGFpbmVyLmNoaWxkcmVuW2ldXG5cdFx0KSB7XG5cdFx0XHRsZXQgcmVmZXJlbmNlID0gYmFja2xpbmtDb250YWluZXIuY2hpbGRyZW5baV0uZ2V0QXR0cmlidXRlKFwicmVmZXJlbmNlXCIpO1xuXHRcdFx0aWYgKHJlZmVyZW5jZSkge1xuXHRcdFx0XHR2aXNpYmxlRWxlbWVudHMucHVzaChKU09OLnBhcnNlKHJlZmVyZW5jZSkuZGF0YVN0cmluZyk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0Y29uc29sZS5sb2coIXZpc2libGVFbGVtZW50cy5pbmNsdWRlcyhkYXRhU3RyaW5nKSk7XG5cdC8vIGlmICghdmlzaWJsZUVsZW1lbnRzLmluY2x1ZGVzKGRhdGFTdHJpbmcpKSB7XG5cdGxldCBzdGFydFRvcCA9IGxlYWYudmlldy5lZGl0b3IuZ2V0U2Nyb2xsSW5mbygpLnRvcDtcblxuXHRsZXQgcG9zaXRpb25zID0gZmluZFRleHRQb3NpdGlvbnMoXG5cdFx0bGVhZi52aWV3LmRhdGEsXG5cdFx0dGV4dCxcblx0XHRwcmVmaXguc2xpY2UoMCwgcHJlZml4Lmxlbmd0aCAtIDEpLFxuXHRcdHN1ZmZpeC5zbGljZSgxLCBzdWZmaXgubGVuZ3RoKVxuXHQpO1xuXHRpZiAoIXBvc2l0aW9ucykgdGhyb3cgbmV3IEVycm9yKFwiUG9zaXRpb25zIG5vdCBmb3VuZFwiKTtcblx0bGV0IHJhbmdlU3RhcnQgPSBwb3NpdGlvbnMucmFuZ2VTdGFydDtcblx0bGV0IHJhbmdlRW5kID0gcG9zaXRpb25zLnJhbmdlRW5kO1xuXG5cdGxlYWYudmlldy5lZGl0b3Iuc2Nyb2xsSW50b1ZpZXcoXG5cdFx0e1xuXHRcdFx0ZnJvbTogT2JqZWN0LmFzc2lnbihyYW5nZVN0YXJ0LCB7IGNoOiAwIH0pLFxuXHRcdFx0dG86IE9iamVjdC5hc3NpZ24ocmFuZ2VFbmQsIHsgY2g6IDAgfSksXG5cdFx0fSxcblx0XHR0cnVlXG5cdCk7XG5cdGNvbnNvbGUubG9nKHN0YXJ0VG9wKTtcblx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0Ly8gaWYgKHRlbXApIHJldHVybjtcblx0XHRsZXQgZW5kVG9wID0gbGVhZi52aWV3LmVkaXRvci5nZXRTY3JvbGxJbmZvKCkudG9wO1xuXHRcdGNvbnNvbGUubG9nKGVuZFRvcCk7XG5cblx0XHRsZXQgY29udGFpbmVyID0gbGVhZi5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKFwiLnZpZXctY29udGVudFwiKTtcblx0XHRjb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZShcIm5vLXNoYWRvd1wiKTtcblx0XHRjb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZShcIm5ldy1zaGFkb3dcIik7XG5cdFx0Y29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoXCJ0b3Atc2hhZG93XCIpO1xuXHRcdGNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKFwiYm90dG9tLXNoYWRvd1wiKTtcblxuXHRcdGlmIChzdGFydFRvcCA9PT0gZW5kVG9wICYmIGlzU2FtZSkge1xuXHRcdFx0Y29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJuby1zaGFkb3dcIik7XG5cdFx0fSBlbHNlIGlmIChzdGFydFRvcCA9PT0gZW5kVG9wICYmICFpc1NhbWUpIHtcblx0XHRcdGNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwibmV3LXNoYWRvd1wiKTtcblx0XHR9IGVsc2UgaWYgKHN0YXJ0VG9wIDwgZW5kVG9wKSB7XG5cdFx0XHQvLyBzaG93IG1hcmsgYWJvdmVcblx0XHRcdGNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwidG9wLXNoYWRvd1wiKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gc2hvdyBtYXJrIGJlbG93XG5cdFx0XHRjb250YWluZXIuY2xhc3NMaXN0LmFkZChcImJvdHRvbS1zaGFkb3dcIik7XG5cdFx0fVxuXHR9LCAyNSk7XG5cdC8vIH1cbn1cblxuZnVuY3Rpb24gZW5kRWZmZWN0UmVtb3ZlSGlnaGxpZ2h0cyhcblx0d29ya3NwYWNlOiBXb3Jrc3BhY2UsXG5cdGxlYWZJZDogc3RyaW5nLFxuXHR1dWlkOiBzdHJpbmcsXG5cdGJhY2tsaW5rVVVJRD86IHN0cmluZ1xuKSB7XG5cdGNvbnN0IHdvcmtzcGFjZUNvbnRhaW5lciA9IHdvcmtzcGFjZS5jb250YWluZXJFbDtcblx0Y29uc3Qgc3BhbiA9IHdvcmtzcGFjZUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiLlwiICsgdXVpZCk7XG5cblx0c3Bhbj8ucGFyZW50RWxlbWVudFxuXHRcdD8ucXVlcnlTZWxlY3RvcihcIi5yZWZlcmVuY2Utc3BhblwiKVxuXHRcdD8uY2xhc3NMaXN0LnJlbW92ZShcInJlZmVyZW5jZS1zcGFuLXNlbGVjdGVkXCIpO1xuXHQvLyBmaXJzdFNwYW5QYXJ0Py5jbGFzc0xpc3QucmVtb3ZlKHV1aWQpO1xuXHRzcGFuPy5jbGFzc0xpc3QucmVtb3ZlKFwicmVmZXJlbmNlLWRhdGEtc3Bhbi1zZWxlY3RlZFwiKTtcblxuXHRpZiAoYmFja2xpbmtVVUlEKSB7XG5cdFx0Y29uc3QgYmFja2xpbmtTcGFuID0gd29ya3NwYWNlQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCIuXCIgKyBiYWNrbGlua1VVSUQpO1xuXG5cdFx0YmFja2xpbmtTcGFuPy5wYXJlbnRFbGVtZW50XG5cdFx0XHQ/LnF1ZXJ5U2VsZWN0b3IoXCIucmVmZXJlbmNlLXNwYW5cIilcblx0XHRcdD8uY2xhc3NMaXN0LnJlbW92ZShcInJlZmVyZW5jZS1zcGFuLXNlbGVjdGVkXCIpO1xuXHRcdGJhY2tsaW5rU3Bhbj8uY2xhc3NMaXN0LnJlbW92ZShcInJlZmVyZW5jZS1kYXRhLXNwYW4tc2VsZWN0ZWRcIik7XG5cdH1cblxuXHRsZXQgdGFyZ2V0TGVhZiA9IHdvcmtzcGFjZS5nZXRMZWFmQnlJZChsZWFmSWQpO1xuXHRpZiAoIXRhcmdldExlYWYpIHtcblx0XHRyZXNldEN1cnNvcigpO1xuXHRcdHRocm93IG5ldyBFcnJvcihcIlRhcmdldCBsZWFmIG5vdCBmb3VuZFwiKTtcblx0fVxuXG5cdC8vIHJlbW92ZSBib3ggc2hhZG93cyBpZiBhbnlcblx0bGV0IGNvbnRhaW5lciA9XG5cdFx0Z2V0Q29udGFpbmVyRWxlbWVudCh0YXJnZXRMZWFmKT8ucXVlcnlTZWxlY3RvcihcIi52aWV3LWNvbnRlbnRcIik7XG5cblx0aWYgKGNvbnRhaW5lcikge1xuXHRcdGNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKFwibm8tc2hhZG93XCIpO1xuXHRcdGNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKFwibmV3LXNoYWRvd1wiKTtcblx0XHRjb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZShcInRvcC1zaGFkb3dcIik7XG5cdFx0Y29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoXCJib3R0b20tc2hhZG93XCIpO1xuXHR9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzdGFydEJhY2tsaW5rRWZmZWN0KHNwYW46IEhUTUxTcGFuRWxlbWVudCkge1xuXHRsZXQgc291cmNlID0gZ2V0QmFja2xpbmtIb3ZlcigpO1xuXHRsZXQgZGVzdGluYXRpb24gPSBnZXRDdXJzb3IoKTtcblx0bGV0IHVwZGF0ZVN0YXRlID0gdXBkYXRlQmFja2xpbmtIb3ZlcjtcblxuXHQvLyBNdXRleCwgcHJldmVudCBjb25jdXJyZW50IGFjY2VzcyB0byBmb2xsb3dpbmcgc2VjdGlvbiBvZiBjb2RlXG5cdGlmIChzb3VyY2UgIT0gbnVsbCkgcmV0dXJuO1xuXHR1cGRhdGVTdGF0ZSh7XG5cdFx0dHlwZTogYCR7QUNUSU9OX1RZUEUuQkFDS0xJTkt9LXN0YXJ0YCxcblx0fSk7XG5cblx0aWYgKCFzcGFuKSByZXR1cm47XG5cblx0Ly8gVG9nZ2xlIGhvdmVyIHN0YXRlXG5cdGxldCB1dWlkID0gQXJyYXkuZnJvbShzcGFuLmNsYXNzTGlzdCkuZmlsdGVyKChlbCkgPT4gZWwuaW5jbHVkZXMoXCJ1dWlkXCIpKVswXTtcblx0c3Bhbi5wYXJlbnRFbGVtZW50XG5cdFx0Py5xdWVyeVNlbGVjdG9yKFwiLnJlZmVyZW5jZS1zcGFuXCIpXG5cdFx0Py5jbGFzc0xpc3QuYWRkKFwicmVmZXJlbmNlLXNwYW4tc2VsZWN0ZWRcIik7XG5cblx0c3Bhbi5jbGFzc0xpc3QuYWRkKFwicmVmZXJlbmNlLWRhdGEtc3Bhbi1zZWxlY3RlZFwiKTtcblxuXHR1cGRhdGVTdGF0ZSh7XG5cdFx0dXVpZCxcblx0fSk7XG5cblx0Y29uc3QgcmVmZXJlbmNlRGF0YSA9IHNwYW4uZ2V0QXR0cmlidXRlKFwicmVmZXJlbmNlXCIpO1xuXHRpZiAoIXJlZmVyZW5jZURhdGEpIHRocm93IG5ldyBFcnJvcihcIlJlZmVyZW5jZSBkYXRhIG5vdCBmb3VuZFwiKTtcblxuXHRjb25zdCBiYWNrbGluayA9IEpTT04ucGFyc2UocmVmZXJlbmNlRGF0YSk7XG5cdGNvbnN0IGRhdGFTdHJpbmcgPSBiYWNrbGluay5kYXRhU3RyaW5nO1xuXG5cdC8vIENoZWNrIGlmIHRoZSBjdXJzb3IgaXMgYWxyZWFkeSBvbiB0aGUgc2FtZSByZWZlcmVuY2Vcblx0aWYgKGRlc3RpbmF0aW9uICE9IG51bGwgJiYgZGVzdGluYXRpb24uZGF0YVN0cmluZyA9PSBkYXRhU3RyaW5nKSB7XG5cdFx0dXBkYXRlU3RhdGUoZGVzdGluYXRpb24pO1xuXHRcdHJldHVybjtcblx0fVxuXG5cdGxldCBbcHJlZml4LCB0ZXh0LCBzdWZmaXgsIGZpbGUsIGZyb20sIHRvXSA9IHByb2Nlc3NVUkkoZGF0YVN0cmluZyk7XG5cblx0Ly8gZ2V0IGJhY2tsaW5rIGxlYWZcblx0bGV0IGxlYXZlc0J5VGFiID0gY29sbGVjdExlYXZlc0J5VGFiSGVscGVyKCk7XG5cblx0bGV0IGN1cnJUYWJJZHggPSBnZXRDdXJyZW50VGFiSW5kZXgobGVhdmVzQnlUYWIsIHNwYW4pO1xuXG5cdGxldCBiYWNrbGlua0xlYWYgPSBsZWF2ZXNCeVRhYltjdXJyVGFiSWR4XS5maWx0ZXIoKGxlYWY6IFdvcmtzcGFjZUxlYWYpID0+IHtcblx0XHRsZXQgY29udGFpbmVyRWwgPSBnZXRDb250YWluZXJFbGVtZW50KGxlYWYpO1xuXHRcdGNvbnN0IGV4aXN0cyA9IGNoZWNrU3BhbkVsZW1lbnRFeGlzdHMoc3BhbiwgY29udGFpbmVyRWwpO1xuXHRcdHJldHVybiBleGlzdHM7XG5cdH0pWzBdO1xuXG5cdC8vIEB0cy1pZ25vcmVcblx0bGV0IGJhY2tsaW5rTGVhZklEID0gYmFja2xpbmtMZWFmLmlkO1xuXHRpZiAoIWJhY2tsaW5rTGVhZklEKSB0aHJvdyBuZXcgRXJyb3IoXCJMZWFmIGlkIG5vdCBmb3VuZFwiKTtcblxuXHRpZiAoYmFja2xpbmtMZWFmICYmIGJhY2tsaW5rTGVhZi52aWV3IGluc3RhbmNlb2YgTWFya2Rvd25WaWV3KSB7XG5cdFx0Y29uc3QgZWRpdG9yVmlldzogRWRpdG9yVmlldyA9IGdldEVkaXRvclZpZXcoYmFja2xpbmtMZWFmKTtcblx0XHRpZiAoIWVkaXRvclZpZXcpIHRocm93IG5ldyBFcnJvcihcIkVkaXRvciB2aWV3IG5vdCBmb3VuZFwiKTtcblx0XHRjb25zdCB2aWV3cG9ydCA9IGJhY2tsaW5rTGVhZi52aWV3LmVkaXRvci5nZXRTY3JvbGxJbmZvKCk7XG5cblx0XHRyZW1vdmVIaWdobGlnaHQoZWRpdG9yVmlldywgZnJvbSwgdG8pO1xuXHRcdGhpZ2hsaWdodFNlbGVjdGlvbihlZGl0b3JWaWV3LCBmcm9tLCB0byk7XG5cdFx0Ly8gbGV0IHBvc2l0aW9ucyA9IGZpbmRUZXh0UG9zaXRpb25zKFxuXHRcdC8vIFx0YmFja2xpbmtMZWFmLnZpZXcuZGF0YSxcblx0XHQvLyBcdHRleHQsXG5cdFx0Ly8gXHRwcmVmaXguc2xpY2UoMCwgcHJlZml4Lmxlbmd0aCAtIDEpLFxuXHRcdC8vIFx0c3VmZml4LnNsaWNlKDEsIHN1ZmZpeC5sZW5ndGgpXG5cdFx0Ly8gKTtcblx0XHQvLyBpZiAoIXBvc2l0aW9ucykgdGhyb3cgbmV3IEVycm9yKFwiUG9zaXRpb25zIG5vdCBmb3VuZFwiKTtcblxuXHRcdHVwZGF0ZVN0YXRlKHtcblx0XHRcdGRhdGFTdHJpbmcsXG5cdFx0XHRvcmlnaW5hbFRvcDogZWRpdG9yVmlldy5kb2N1bWVudFRvcCxcblx0XHRcdGJhY2tsaW5rTGVhZklkOiBiYWNrbGlua0xlYWZJRCxcblx0XHR9KTtcblx0fVxuXG5cdGxldCByZWZlcmVuY2luZ0ZpbGUgPSBiYWNrbGluay5yZWZlcmVuY2luZ0xvY2F0aW9uLmZpbGVuYW1lO1xuXG5cdC8vIGlmIChjdXJyVGFiSWR4ICE9IC0xKSB7XG5cdC8vICYmIGN1cnJUYWIgIT0gLTEpIHtcblx0Ly8gLy8gQ2hlY2sgYWRqYWNlbnQgdGFicyBmb3IgZmlsZSBhbmQgb3BlbiBmaWxlIGlmIG5lZWRlZFxuXHRjb25zdCB7IG5ld0xlYWYsIHRlbXAsIG9yaWdpbmFsTGVhZiB9ID0gYXdhaXQgb3BlbkZpbGVJbkFkamFjZW50VGFiKFxuXHRcdGxlYXZlc0J5VGFiLFxuXHRcdGN1cnJUYWJJZHgsXG5cdFx0cmVmZXJlbmNpbmdGaWxlXG5cdCk7XG5cblx0Ly8gQHRzLWlnbm9yZVxuXHRsZXQgaWQgPSBuZXdMZWFmLmlkO1xuXHRpZiAoIWlkKSB0aHJvdyBuZXcgRXJyb3IoXCJMZWFmIGlkIG5vdCBmb3VuZFwiKTtcblx0dXBkYXRlU3RhdGUoe1xuXHRcdGxlYWZJZDogaWQsXG5cdFx0dGVtcCxcblx0XHRwZWVrOiB0cnVlLFxuXHR9KTtcblxuXHRjb25zdCBvcmlnaW5hbExlYWZJZCA9IG9yaWdpbmFsTGVhZi5pZDtcblxuXHRjb25zdCBtYXRjaGVzID0gW1xuXHRcdC4uLmJhY2tsaW5rLnJlZmVyZW5jaW5nTG9jYXRpb24udGV4dC5tYXRjaEFsbChSRUZFUkVOQ0VfUkVHRVgpLFxuXHRdO1xuXHRpZiAobWF0Y2hlcy5sZW5ndGggPT0gMCkgdGhyb3cgbmV3IEVycm9yKFwiTWF0Y2hlcyBub3QgZm91bmRcIik7XG5cdC8vIFRoaXMgb25lIHN3aXRjaCwgdGhpcyBvbmUgZG9lcyB0aGUgY29ycmVjdCBzY3JvbGxcblx0Ly8gdGVtcERpcmVjdGlvbkluZGljYXRvcihuZXdMZWFmLCB0ZXh0LCBwcmVmaXgsIHN1ZmZpeCwgZGF0YVN0cmluZyk7XG5cblx0Ly8gVGhpcyBvbmUgZG9lcyB0aGUgY29ycmVjdCBncmFiYmluZyBvZiBzcGFuIGVsZW1lbnRzXG5cdHRlbXBEaXJlY3Rpb25JbmRpY2F0b3IoXG5cdFx0bmV3TGVhZixcblx0XHRiYWNrbGluay5yZWZlcmVuY2luZ0xvY2F0aW9uLnRleHQsXG5cdFx0YmFja2xpbmsucmVmZXJlbmNpbmdMb2NhdGlvbi5wcmVmaXggKyBcIi1cIixcblx0XHRcIi1cIiArIGJhY2tsaW5rLnJlZmVyZW5jaW5nTG9jYXRpb24uc3VmZml4LFxuXHRcdG1hdGNoZXNbMF1bMV0sXG5cdFx0aWQgPT09IG9yaWdpbmFsTGVhZklkLFxuXHRcdEFDVElPTl9UWVBFLkJBQ0tMSU5LXG5cdCk7XG5cblx0Y29uc3QgY3Vyc29yVmlld3BvcnQgPSBuZXdMZWFmLnZpZXcuZWRpdG9yLmdldFNjcm9sbEluZm8oKTtcblxuXHR1cGRhdGVTdGF0ZSh7XG5cdFx0Y3Vyc29yVmlld3BvcnQsXG5cdH0pO1xuXG5cdGxldCBiYWNrbGlua1NwYW46IEhUTUxTcGFuRWxlbWVudCA9IG5ld0xlYWYuY29udGFpbmVyRWwucXVlcnlTZWxlY3Rvcihcblx0XHRgc3BhbltkYXRhPVwiJHtiYWNrbGluay5kYXRhU3RyaW5nfVwiXWBcblx0KTtcblxuXHQvLyBDYW4ndCBndWFyYW50ZWUgdGhhdCB0aGlzIHdpbGwgYmUgdmlzaWJsZS5cblx0aWYgKGJhY2tsaW5rU3Bhbikge1xuXHRcdGxldCBiYWNrbGlua1VVSUQgPSBBcnJheS5mcm9tKGJhY2tsaW5rU3Bhbi5jbGFzc0xpc3QpLmZpbHRlcigoZWwpID0+XG5cdFx0XHRlbC5pbmNsdWRlcyhcInV1aWRcIilcblx0XHQpWzBdO1xuXHRcdGJhY2tsaW5rU3Bhbi5wYXJlbnRFbGVtZW50XG5cdFx0XHQ/LnF1ZXJ5U2VsZWN0b3IoXCIucmVmZXJlbmNlLXNwYW5cIilcblx0XHRcdD8uY2xhc3NMaXN0LmFkZChcInJlZmVyZW5jZS1zcGFuLXNlbGVjdGVkXCIpO1xuXG5cdFx0YmFja2xpbmtTcGFuLmNsYXNzTGlzdC5hZGQoXCJyZWZlcmVuY2UtZGF0YS1zcGFuLXNlbGVjdGVkXCIpO1xuXG5cdFx0dXBkYXRlU3RhdGUoe1xuXHRcdFx0YmFja2xpbmtVVUlELFxuXHRcdH0pO1xuXHR9XG5cblx0Ly8gQHRzLWlnbm9yZVxuXHRpZiAob3JpZ2luYWxMZWFmSWQpIHtcblx0XHR1cGRhdGVTdGF0ZSh7XG5cdFx0XHRvcmlnaW5hbExlYWZJZCxcblx0XHR9KTtcblx0fVxuXG5cdHJldHVybjtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHN0YXJ0UmVmZXJlbmNlRWZmZWN0KFxuXHRzcGFuOiBIVE1MU3BhbkVsZW1lbnQgfCBudWxsIHwgdW5kZWZpbmVkLFxuXHR0eXBlOiBzdHJpbmdcbikge1xuXHRsZXQgc291cmNlID0gdHlwZSA9PSBBQ1RJT05fVFlQRS5NT1VTRSA/IGdldEhvdmVyKCkgOiBnZXRDdXJzb3IoKTtcblx0bGV0IGRlc3RpbmF0aW9uID0gdHlwZSA9PSBBQ1RJT05fVFlQRS5NT1VTRSA/IGdldEN1cnNvcigpIDogZ2V0SG92ZXIoKTtcblx0bGV0IHVwZGF0ZVN0YXRlID0gdHlwZSA9PSBBQ1RJT05fVFlQRS5NT1VTRSA/IHVwZGF0ZUhvdmVyIDogdXBkYXRlQ3Vyc29yO1xuXG5cdC8vIE11dGV4LCBwcmV2ZW50IGNvbmN1cnJlbnQgYWNjZXNzIHRvIGZvbGxvd2luZyBzZWN0aW9uIG9mIGNvZGVcblx0aWYgKHNvdXJjZSAhPSBudWxsKSB7XG5cdFx0aWYgKEFDVElPTl9UWVBFLkNVUlNPUiA9PSB0eXBlKSB7XG5cdFx0XHQvLyBpZiB0aGVyZSB3YXMgYW5vdGhlciBjdXJzb3IgZWZmZWN0LCBlbmQgaXQgYW5kIHN0YXJ0IGEgbmV3IG9uZVxuXHRcdFx0YXdhaXQgZW5kUmVmZXJlbmNlQ3Vyc29yRWZmZWN0KCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdH1cblx0dXBkYXRlU3RhdGUoe1xuXHRcdHR5cGU6IGAke3R5cGV9LXN0YXJ0YCxcblx0fSk7XG5cblx0aWYgKCFzcGFuKSByZXR1cm47XG5cblx0Ly8gY29sb3IgdGhlIHNwYW5cblx0bGV0IHV1aWQgPSBBcnJheS5mcm9tKHNwYW4uY2xhc3NMaXN0KS5maWx0ZXIoKGVsKSA9PiBlbC5pbmNsdWRlcyhcInV1aWRcIikpWzBdO1xuXHRzcGFuLnBhcmVudEVsZW1lbnRcblx0XHQ/LnF1ZXJ5U2VsZWN0b3IoXCIucmVmZXJlbmNlLXNwYW5cIilcblx0XHQ/LmNsYXNzTGlzdC5hZGQoXCJyZWZlcmVuY2Utc3Bhbi1zZWxlY3RlZFwiKTtcblxuXHRzcGFuLmNsYXNzTGlzdC5hZGQoXCJyZWZlcmVuY2UtZGF0YS1zcGFuLXNlbGVjdGVkXCIpO1xuXG5cdHVwZGF0ZVN0YXRlKHtcblx0XHR1dWlkLFxuXHR9KTtcblxuXHRjb25zdCBkYXRhU3RyaW5nID0gc3Bhbi5nZXRBdHRyaWJ1dGUoXCJkYXRhXCIpO1xuXHRpZiAoIWRhdGFTdHJpbmcpIHRocm93IG5ldyBFcnJvcihcIkRhdGEgc3RyaW5nIG5vdCBmb3VuZFwiKTtcblxuXHRpZiAoXG5cdFx0ZGVzdGluYXRpb24gIT0gbnVsbCAmJlxuXHRcdGRlc3RpbmF0aW9uLmRhdGFTdHJpbmcgPT0gZGF0YVN0cmluZyAmJlxuXHRcdEFDVElPTl9UWVBFLkNVUlNPUiAhPSB0eXBlXG5cdCkge1xuXHRcdHVwZGF0ZUhvdmVyKGRlc3RpbmF0aW9uKTtcblx0XHRyZXR1cm47XG5cdH1cblxuXHRsZXQgW3ByZWZpeCwgdGV4dCwgc3VmZml4LCBmaWxlLCBmcm9tLCB0b10gPSBwcm9jZXNzVVJJKGRhdGFTdHJpbmcpO1xuXG5cdGxldCBsZWF2ZXNCeVRhYiA9IGNvbGxlY3RMZWF2ZXNCeVRhYkhlbHBlcigpO1xuXG5cdGxldCBjdXJyVGFiSWR4ID0gZ2V0Q3VycmVudFRhYkluZGV4KGxlYXZlc0J5VGFiLCBzcGFuKTtcblxuXHRsZXQgY3VyckxlYWYgPSBnZXRUaGF0KCkud29ya3NwYWNlLmdldExlYWYoKTtcblxuXHQvLyBAdHMtaWdub3JlXG5cdGxldCBjdXJyTGVhZklEID0gY3VyckxlYWYuaWQ7XG5cdGlmICghY3VyckxlYWZJRCkgdGhyb3cgbmV3IEVycm9yKFwiY3VyckxlYWZJRCBpZCBub3QgZm91bmRcIik7XG5cblx0Y29uc3QgeyBuZXdMZWFmLCB0ZW1wLCBvcmlnaW5hbExlYWYgfSA9IGF3YWl0IG9wZW5GaWxlSW5BZGphY2VudFRhYihcblx0XHRsZWF2ZXNCeVRhYixcblx0XHRjdXJyVGFiSWR4LFxuXHRcdGZpbGUsXG5cdFx0dHlwZVxuXHQpO1xuXG5cdC8vIEB0cy1pZ25vcmVcblx0bGV0IGlkID0gbmV3TGVhZi5pZDtcblx0aWYgKCFpZCkgdGhyb3cgbmV3IEVycm9yKFwiTGVhZiBpZCBub3QgZm91bmRcIik7XG5cdHVwZGF0ZVN0YXRlKHtcblx0XHRsZWFmSWQ6IGlkLFxuXHRcdHRlbXAsXG5cdFx0cGVlazogdHJ1ZSxcblx0fSk7XG5cblx0Ly8gQHRzLWlnbm9yZVxuXHRjb25zdCBvcmlnaW5hbExlYWZJZCA9IG9yaWdpbmFsTGVhZi5pZDtcblxuXHRjb25zb2xlLmxvZyhuZXdMZWFmICYmIG5ld0xlYWYudmlldyBpbnN0YW5jZW9mIE1hcmtkb3duVmlldyk7XG5cdGlmIChuZXdMZWFmICYmIG5ld0xlYWYudmlldyBpbnN0YW5jZW9mIE1hcmtkb3duVmlldykge1xuXHRcdGNvbnN0IGVkaXRvclZpZXc6IEVkaXRvclZpZXcgPSBnZXRFZGl0b3JWaWV3KG5ld0xlYWYpO1xuXHRcdGlmICghZWRpdG9yVmlldykgdGhyb3cgbmV3IEVycm9yKFwiRWRpdG9yIHZpZXcgbm90IGZvdW5kXCIpO1xuXHRcdGNvbnN0IHZpZXdwb3J0ID0gbmV3TGVhZi52aWV3LmVkaXRvci5nZXRTY3JvbGxJbmZvKCk7XG5cblx0XHRyZW1vdmVIaWdobGlnaHQoZWRpdG9yVmlldywgZnJvbSwgdG8pO1xuXHRcdGhpZ2hsaWdodFNlbGVjdGlvbihlZGl0b3JWaWV3LCBmcm9tLCB0byk7XG5cblx0XHRjb25zb2xlLmxvZyhcImxlYXZlcyBhcmUgZXF1YWxcIiArIGlkID09PSBvcmlnaW5hbExlYWZJZCk7XG5cdFx0dGVtcERpcmVjdGlvbkluZGljYXRvcihcblx0XHRcdG5ld0xlYWYsXG5cdFx0XHR0ZXh0LFxuXHRcdFx0cHJlZml4LFxuXHRcdFx0c3VmZml4LFxuXHRcdFx0ZGF0YVN0cmluZyxcblx0XHRcdGlkID09PSBvcmlnaW5hbExlYWZJZFxuXHRcdCk7XG5cblx0XHRjb25zdCBjdXJzb3JWaWV3cG9ydCA9IG5ld0xlYWYudmlldy5lZGl0b3IuZ2V0U2Nyb2xsSW5mbygpO1xuXG5cdFx0dXBkYXRlU3RhdGUoe1xuXHRcdFx0ZGF0YVN0cmluZyxcblx0XHRcdG9yaWdpbmFsVG9wOiBlZGl0b3JWaWV3LmRvY3VtZW50VG9wLFxuXHRcdFx0Ly8gb3JpZ2luYWxMZWFmSWQ6IGN1cnJMZWFmSUQsXG5cdFx0XHRjdXJzb3JWaWV3cG9ydCxcblx0XHR9KTtcblx0fVxuXG5cdGlmIChvcmlnaW5hbExlYWZJZCkge1xuXHRcdHVwZGF0ZVN0YXRlKHtcblx0XHRcdG9yaWdpbmFsTGVhZklkLFxuXHRcdH0pO1xuXHR9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBlbmRSZWZlcmVuY2VDdXJzb3JFZmZlY3QoKSB7XG5cdGlmICghZ2V0Q3Vyc29yKCkgfHwgT2JqZWN0LmtleXMoZ2V0Q3Vyc29yKCkpLmxlbmd0aCA9PSAwKSB7XG5cdFx0Ly8gRW5kIG11dGV4IGxvY2tcblx0XHRyZXNldEN1cnNvcigpO1xuXHRcdHJldHVybjtcblx0fVxuXG5cdGNvbnN0IHtcblx0XHRkYXRhU3RyaW5nLFxuXHRcdGxlYWZJZCxcblx0XHRvcmlnaW5hbExlYWZJZCxcblx0XHR0ZW1wLFxuXHRcdGN1cnNvclZpZXdwb3J0LFxuXHRcdHBlZWssXG5cdFx0dXVpZCxcblx0fSA9IGdldEN1cnNvcigpO1xuXHRyZXNldEN1cnNvcigpO1xuXG5cdGlmIChnZXRIb3ZlcigpICE9IG51bGwgJiYgZ2V0SG92ZXIoKS5kYXRhU3RyaW5nID09IGRhdGFTdHJpbmcpIHtcblx0XHQvLyBFbmQgbXV0ZXggbG9ja1xuXHRcdHJlc2V0Q3Vyc29yKCk7XG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0Y29uc3QgeyB3b3Jrc3BhY2UgfSA9IGdldFRoYXQoKTtcblx0bGV0IHRhcmdldExlYWYgPSB3b3Jrc3BhY2UuZ2V0TGVhZkJ5SWQobGVhZklkKTtcblx0ZW5kRWZmZWN0UmVtb3ZlSGlnaGxpZ2h0cyh3b3Jrc3BhY2UsIGxlYWZJZCwgdXVpZCk7XG5cblx0Y29uc3QgYWN0aXZlTGVhZiA9IGdldFRoYXQoKS53b3Jrc3BhY2UuZ2V0TGVhZigpO1xuXHQvLyBAdHMtaWdub3JlIGlkXG5cdGNvbnN0IGFjdGl2ZUxlYWZJZCA9IGFjdGl2ZUxlYWYuaWQ7XG5cblx0bGV0IGVkaXRvclZpZXcgPSBnZXRFZGl0b3JWaWV3KHRhcmdldExlYWYpO1xuXG5cdGxldCBbcHJlZml4LCB0ZXh0LCBzdWZmaXgsIGZpbGUsIGZyb20sIHRvXSA9IHByb2Nlc3NVUkkoZGF0YVN0cmluZyk7XG5cdHJlbW92ZUhpZ2hsaWdodChlZGl0b3JWaWV3LCBmcm9tLCB0byk7XG5cdGRlZmF1bHRIaWdobGlnaHRTZWxlY3Rpb24oZWRpdG9yVmlldywgZnJvbSwgdG8pO1xuXG5cdC8vIHJlbW92ZUhpZ2hsaWdodHMoZWRpdG9yVmlldyk7XG5cblx0aWYgKGFjdGl2ZUxlYWZJZCA9PT0gbGVhZklkKSB7XG5cdFx0cmVzZXRDdXJzb3IoKTtcblx0XHRsZXQgY29udGFpbmVyRWw6IEhUTUxFbGVtZW50ID0gZ2V0Q29udGFpbmVyRWxlbWVudCh0YXJnZXRMZWFmKTtcblx0XHRpZiAoY29udGFpbmVyRWwgIT0gbnVsbCkge1xuXHRcdFx0Ly8gQHRzLWlnbm9yZVxuXHRcdFx0Y29udGFpbmVyRWwucXVlcnlTZWxlY3RvcihcIi52aWV3LWNvbnRlbnRcIik/LnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiXCIpO1xuXHRcdH1cblx0XHRyZXR1cm47XG5cdH1cblxuXHRpZiAoY3Vyc29yVmlld3BvcnQgJiYgdGFyZ2V0TGVhZiAmJiB0YXJnZXRMZWFmLnZpZXcgaW5zdGFuY2VvZiBNYXJrZG93blZpZXcpIHtcblx0XHRjb25zdCB2aWV3OiBNYXJrZG93blZpZXcgPSB0YXJnZXRMZWFmLnZpZXc7XG5cdFx0dmlldy5lZGl0b3Iuc2Nyb2xsVG8oMCwgY3Vyc29yVmlld3BvcnQudG9wKTtcblxuXHRcdC8vIGNvbnN0IHJlc3VsdCA9IGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG5cdFx0Ly8gXHRjb25zdCBzY3JvbGxpbmcgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG5cdFx0Ly8gXHRcdGNvbnN0IHNjcm9sbEFtb3VudCA9IDQwO1xuXHRcdC8vIFx0XHRjb25zdCBjdXJyZW50U2Nyb2xsID0gdmlldy5lZGl0b3IuZ2V0U2Nyb2xsSW5mbygpLnRvcDtcblx0XHQvLyBcdFx0aWYgKGN1cnJlbnRTY3JvbGwgPT0gY3Vyc29yVmlld3BvcnQudG9wKSB7XG5cdFx0Ly8gXHRcdFx0Y2xlYXJJbnRlcnZhbChzY3JvbGxpbmcpO1xuXHRcdC8vIFx0XHR9IGVsc2UgaWYgKGN1cnJlbnRTY3JvbGwgPiBjdXJzb3JWaWV3cG9ydC50b3ApIHtcblx0XHQvLyBcdFx0XHRpZiAoY3VycmVudFNjcm9sbCAtIHNjcm9sbEFtb3VudCA8IGN1cnNvclZpZXdwb3J0LnRvcCkge1xuXHRcdC8vIFx0XHRcdFx0dmlldy5lZGl0b3Iuc2Nyb2xsVG8oMCwgY3Vyc29yVmlld3BvcnQudG9wKTtcblx0XHQvLyBcdFx0XHRcdGNsZWFySW50ZXJ2YWwoc2Nyb2xsaW5nKTtcblx0XHQvLyBcdFx0XHRcdHJlc29sdmUoXCJkb25lXCIpO1xuXHRcdC8vIFx0XHRcdH0gZWxzZSB7XG5cdFx0Ly8gXHRcdFx0XHR2aWV3LmVkaXRvci5zY3JvbGxUbygwLCBjdXJyZW50U2Nyb2xsIC0gc2Nyb2xsQW1vdW50KTtcblx0XHQvLyBcdFx0XHR9XG5cdFx0Ly8gXHRcdH0gZWxzZSBpZiAoY3VycmVudFNjcm9sbCA8IGN1cnNvclZpZXdwb3J0LnRvcCkge1xuXHRcdC8vIFx0XHRcdGlmIChjdXJyZW50U2Nyb2xsICsgc2Nyb2xsQW1vdW50ID4gY3Vyc29yVmlld3BvcnQudG9wKSB7XG5cdFx0Ly8gXHRcdFx0XHR2aWV3LmVkaXRvci5zY3JvbGxUbygwLCBjdXJzb3JWaWV3cG9ydC50b3ApO1xuXHRcdC8vIFx0XHRcdFx0Y2xlYXJJbnRlcnZhbChzY3JvbGxpbmcpO1xuXHRcdC8vIFx0XHRcdFx0cmVzb2x2ZShcImRvbmVcIik7XG5cdFx0Ly8gXHRcdFx0fSBlbHNlIHtcblx0XHQvLyBcdFx0XHRcdHZpZXcuZWRpdG9yLnNjcm9sbFRvKDAsIGN1cnJlbnRTY3JvbGwgKyBzY3JvbGxBbW91bnQpO1xuXHRcdC8vIFx0XHRcdH1cblx0XHQvLyBcdFx0fVxuXHRcdC8vIFx0fSwgMTApO1xuXHRcdC8vIH0pO1xuXG5cdFx0Ly8gdmlldy5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKFwiLmNtLXNjcm9sbGVyXCIpPy5zY3JvbGxUbyh7XG5cdFx0Ly8gXHR0b3A6IGN1cnNvclZpZXdwb3J0LnRvcCxcblx0XHQvLyBcdGJlaGF2aW9yOiBcInNtb290aFwiLFxuXHRcdC8vIH0pO1xuXG5cdFx0Ly8gaWYgdGhlIGhvdmVyIGlzIGFjdGl2ZSwgaGlnaGxpZ2h0IHRoZSBzZWxlY3Rpb25cblx0XHRpZiAoZ2V0SG92ZXIoKSAhPSBudWxsKSB7XG5cdFx0XHRjb25zdCB7IGRhdGFTdHJpbmcsIGN1cnNvclZpZXdwb3J0LCBsZWFmSWQsIG9yaWdpbmFsTGVhZklkIH0gPSBnZXRIb3ZlcigpO1xuXHRcdFx0bGV0IFtwcmVmaXgsIHRleHQsIHN1ZmZpeCwgZmlsZSwgZnJvbSwgdG9dID0gcHJvY2Vzc1VSSShkYXRhU3RyaW5nKTtcblx0XHRcdGNvbnN0IGN1cnNvckxlYWYgPSB3b3Jrc3BhY2UuZ2V0TGVhZkJ5SWQobGVhZklkKTtcblx0XHRcdHdvcmtzcGFjZS5yZXZlYWxMZWFmKGN1cnNvckxlYWYpO1xuXHRcdFx0Y29uc3QgZWRpdG9yVmlldzogRWRpdG9yVmlldyA9IGdldEVkaXRvclZpZXcoY3Vyc29yTGVhZik7XG5cdFx0XHRoaWdobGlnaHRTZWxlY3Rpb24oZWRpdG9yVmlldywgZnJvbSwgdG8pO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRsZXQgY29udGFpbmVyRWw6IEhUTUxFbGVtZW50ID0gZ2V0Q29udGFpbmVyRWxlbWVudCh0YXJnZXRMZWFmKTtcblx0XHRcdGlmIChjb250YWluZXJFbCAhPSBudWxsKSB7XG5cdFx0XHRcdC8vIEB0cy1pZ25vcmVcblx0XHRcdFx0Y29udGFpbmVyRWwucXVlcnlTZWxlY3RvcihcIi52aWV3LWNvbnRlbnRcIik/LnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiXCIpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdGlmICh0ZW1wICYmIHRhcmdldExlYWYpIHtcblx0XHR0YXJnZXRMZWFmLmRldGFjaCgpO1xuXHR9XG5cblx0aWYgKHBlZWspIHtcblx0XHRsZXQgb3JpZ2luYWxMZWFmID0gd29ya3NwYWNlLmdldExlYWZCeUlkKG9yaWdpbmFsTGVhZklkKTtcblx0XHRpZiAoIW9yaWdpbmFsTGVhZikgdGhyb3cgbmV3IEVycm9yKFwiT3JpZ2luYWwgbGVhZiBub3QgZm91bmRcIik7XG5cblx0XHR3b3Jrc3BhY2UucmV2ZWFsTGVhZihvcmlnaW5hbExlYWYpO1xuXHR9XG5cblx0Ly8gaWYgKCF0ZW1wKSB7XG5cdC8vIFx0bGV0IG9yaWdpbmFsTGVhZiA9IHdvcmtzcGFjZS5nZXRMZWFmQnlJZChvcmlnaW5hbExlYWZJZCk7XG5cdC8vIFx0aWYgKCFvcmlnaW5hbExlYWYpIHRocm93IG5ldyBFcnJvcihcIk9yaWdpbmFsIGxlYWYgbm90IGZvdW5kXCIpO1xuXG5cdC8vIFx0d29ya3NwYWNlLnJldmVhbExlYWYob3JpZ2luYWxMZWFmKTtcblx0Ly8gfVxuXHQvLyBFbmQgbXV0ZXggbG9ja1xuXHRyZXNldEN1cnNvcigpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZW5kUmVmZXJlbmNlSG92ZXJFZmZlY3QoKSB7XG5cdGlmICghZ2V0SG92ZXIoKSB8fCBPYmplY3Qua2V5cyhnZXRIb3ZlcigpKS5sZW5ndGggPT0gMCkge1xuXHRcdC8vIEVuZCBtdXRleCBsb2NrXG5cdFx0cmVzZXRIb3ZlcigpO1xuXHRcdHJldHVybjtcblx0fVxuXG5cdGxldCB7IGRhdGFTdHJpbmcsIGxlYWZJZCwgb3JpZ2luYWxMZWFmSWQsIHRlbXAsIGN1cnNvclZpZXdwb3J0LCBwZWVrLCB1dWlkIH0gPVxuXHRcdGdldEhvdmVyKCk7XG5cdHJlc2V0SG92ZXIoKTtcblxuXHRpZiAoZ2V0Q3Vyc29yKCkgIT0gbnVsbCAmJiBnZXRDdXJzb3IoKS5kYXRhU3RyaW5nID09IGRhdGFTdHJpbmcpIHtcblx0XHQvLyBjb25zb2xlLmxvZyhcImN1cnNvciByZXNldFwiKTtcblx0XHQvLyBFbmQgbXV0ZXggbG9ja1xuXHRcdHJlc2V0SG92ZXIoKTtcblx0XHRyZXR1cm47XG5cdH1cblxuXHRjb25zdCB7IHdvcmtzcGFjZSB9ID0gZ2V0VGhhdCgpO1xuXHRsZXQgdGFyZ2V0TGVhZiA9IHdvcmtzcGFjZS5nZXRMZWFmQnlJZChsZWFmSWQpO1xuXHRlbmRFZmZlY3RSZW1vdmVIaWdobGlnaHRzKHdvcmtzcGFjZSwgbGVhZklkLCB1dWlkKTtcblxuXHRsZXQgZWRpdG9yVmlldyA9IGdldEVkaXRvclZpZXcodGFyZ2V0TGVhZik7XG5cblx0bGV0IFtwcmVmaXgsIHRleHQsIHN1ZmZpeCwgZmlsZSwgZnJvbSwgdG9dID0gcHJvY2Vzc1VSSShkYXRhU3RyaW5nKTtcblx0cmVtb3ZlSGlnaGxpZ2h0KGVkaXRvclZpZXcsIGZyb20sIHRvKTtcblx0ZGVmYXVsdEhpZ2hsaWdodFNlbGVjdGlvbihlZGl0b3JWaWV3LCBmcm9tLCB0byk7XG5cblx0Ly8gcmVtb3ZlSGlnaGxpZ2h0cyhlZGl0b3JWaWV3KTtcblxuXHRpZiAoY3Vyc29yVmlld3BvcnQgJiYgdGFyZ2V0TGVhZiAmJiB0YXJnZXRMZWFmLnZpZXcgaW5zdGFuY2VvZiBNYXJrZG93blZpZXcpIHtcblx0XHRjb25zdCB2aWV3OiBNYXJrZG93blZpZXcgPSB0YXJnZXRMZWFmLnZpZXc7XG5cdFx0dmlldy5lZGl0b3Iuc2Nyb2xsVG8oMCwgY3Vyc29yVmlld3BvcnQudG9wKTtcblxuXHRcdC8vIGlmIHRoZSBjdXJzb3IgaXMgYWN0aXZlLCBoaWdobGlnaHQgdGhlIHNlbGVjdGlvblxuXHRcdGlmIChnZXRDdXJzb3IoKSAhPSBudWxsICYmIGdldEN1cnNvcigpLmRhdGFTdHJpbmcpIHtcblx0XHRcdGNvbnN0IHsgZGF0YVN0cmluZywgY3Vyc29yVmlld3BvcnQsIGxlYWZJZCwgb3JpZ2luYWxMZWFmSWQgfSA9XG5cdFx0XHRcdGdldEN1cnNvcigpO1xuXHRcdFx0bGV0IFtwcmVmaXgsIHRleHQsIHN1ZmZpeCwgZmlsZSwgZnJvbSwgdG8sIHBvcnRhbCwgdG9nZ2xlXSA9XG5cdFx0XHRcdHByb2Nlc3NVUkkoZGF0YVN0cmluZyk7XG5cdFx0XHRjb25zdCBjdXJzb3JMZWFmID0gd29ya3NwYWNlLmdldExlYWZCeUlkKGxlYWZJZCk7XG5cdFx0XHR3b3Jrc3BhY2UucmV2ZWFsTGVhZihjdXJzb3JMZWFmKTtcblx0XHRcdGNvbnN0IGVkaXRvclZpZXc6IEVkaXRvclZpZXcgPSBnZXRFZGl0b3JWaWV3KGN1cnNvckxlYWYpO1xuXHRcdFx0aWYgKCFlZGl0b3JWaWV3KSB0aHJvdyBuZXcgRXJyb3IoXCJFZGl0b3IgdmlldyBub3QgZm91bmRcIik7XG5cblx0XHRcdGhpZ2hsaWdodFNlbGVjdGlvbihlZGl0b3JWaWV3LCBmcm9tLCB0byk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGxldCBjb250YWluZXJFbDogSFRNTEVsZW1lbnQgPSBnZXRDb250YWluZXJFbGVtZW50KHRhcmdldExlYWYpO1xuXHRcdFx0aWYgKGNvbnRhaW5lckVsICE9IG51bGwpIHtcblx0XHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdFx0Ly8gQHRzLWlnbm9yZVxuXHRcdFx0XHRcdGNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoXCIudmlldy1jb250ZW50XCIpPy5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcIlwiKTtcblx0XHRcdFx0fSwgNTApO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdGlmICh0ZW1wICYmIHRhcmdldExlYWYpIHtcblx0XHR0YXJnZXRMZWFmLmRldGFjaCgpO1xuXG5cdFx0bGV0IG9yaWdpbmFsTGVhZiA9IHdvcmtzcGFjZS5nZXRMZWFmQnlJZChvcmlnaW5hbExlYWZJZCk7XG5cdFx0aWYgKCFvcmlnaW5hbExlYWYpIHRocm93IG5ldyBFcnJvcihcIk9yaWdpbmFsIGxlYWYgbm90IGZvdW5kXCIpO1xuXG5cdFx0d29ya3NwYWNlLnJldmVhbExlYWYob3JpZ2luYWxMZWFmKTtcblx0fVxuXG5cdGlmIChwZWVrKSB7XG5cdFx0bGV0IG9yaWdpbmFsTGVhZiA9IHdvcmtzcGFjZS5nZXRMZWFmQnlJZChvcmlnaW5hbExlYWZJZCk7XG5cdFx0aWYgKCFvcmlnaW5hbExlYWYpIHtcblx0XHRcdHJlc2V0SG92ZXIoKTtcblx0XHRcdHRocm93IG5ldyBFcnJvcihcIk9yaWdpbmFsIGxlYWYgbm90IGZvdW5kXCIpO1xuXHRcdH1cblxuXHRcdHdvcmtzcGFjZS5yZXZlYWxMZWFmKG9yaWdpbmFsTGVhZik7XG5cdH1cblx0Ly8gaWYgKCF0ZW1wKSB7XG5cdC8vIFx0bGV0IG9yaWdpbmFsTGVhZiA9IHdvcmtzcGFjZS5nZXRMZWFmQnlJZChvcmlnaW5hbExlYWZJZCk7XG5cdC8vIFx0aWYgKCFvcmlnaW5hbExlYWYpIHRocm93IG5ldyBFcnJvcihcIk9yaWdpbmFsIGxlYWYgbm90IGZvdW5kXCIpO1xuXG5cdC8vIFx0d29ya3NwYWNlLnJldmVhbExlYWYob3JpZ2luYWxMZWFmKTtcblx0Ly8gfVxuXG5cdC8vIEVuZCBtdXRleCBsb2NrXG5cdHJlc2V0SG92ZXIoKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGVuZEJhY2tsaW5rSG92ZXJFZmZlY3QoKSB7XG5cdGlmICghZ2V0QmFja2xpbmtIb3ZlcigpIHx8IE9iamVjdC5rZXlzKGdldEJhY2tsaW5rSG92ZXIoKSkubGVuZ3RoID09IDApIHtcblx0XHQvLyBFbmQgbXV0ZXggbG9ja1xuXHRcdHJlc2V0QmFja2xpbmtIb3ZlcigpO1xuXHRcdHJldHVybjtcblx0fVxuXG5cdGNvbnN0IHtcblx0XHRkYXRhU3RyaW5nLFxuXHRcdGxlYWZJZCxcblx0XHRvcmlnaW5hbExlYWZJZCxcblx0XHRiYWNrbGlua0xlYWZJZCxcblx0XHR0ZW1wLFxuXHRcdGN1cnNvclZpZXdwb3J0LFxuXHRcdHBlZWssXG5cdFx0dXVpZCxcblx0XHRiYWNrbGlua1VVSUQsXG5cdH0gPSBnZXRCYWNrbGlua0hvdmVyKCk7XG5cdHJlc2V0QmFja2xpbmtIb3ZlcigpO1xuXG5cdGlmIChnZXRDdXJzb3IoKSAhPSBudWxsICYmIGdldEN1cnNvcigpLmRhdGFTdHJpbmcgPT0gZGF0YVN0cmluZykge1xuXHRcdC8vIEVuZCBtdXRleCBsb2NrXG5cdFx0cmVzZXRCYWNrbGlua0hvdmVyKCk7XG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0Y29uc3QgeyB3b3Jrc3BhY2UgfSA9IGdldFRoYXQoKTtcblx0bGV0IHRhcmdldExlYWYgPSB3b3Jrc3BhY2UuZ2V0TGVhZkJ5SWQobGVhZklkKTtcblx0ZW5kRWZmZWN0UmVtb3ZlSGlnaGxpZ2h0cyh3b3Jrc3BhY2UsIGxlYWZJZCwgdXVpZCwgYmFja2xpbmtVVUlEKTtcblxuXHRpZiAoY3Vyc29yVmlld3BvcnQgJiYgdGFyZ2V0TGVhZiAmJiB0YXJnZXRMZWFmLnZpZXcgaW5zdGFuY2VvZiBNYXJrZG93blZpZXcpIHtcblx0XHRjb25zdCB2aWV3OiBNYXJrZG93blZpZXcgPSB0YXJnZXRMZWFmLnZpZXc7XG5cdFx0dmlldy5lZGl0b3Iuc2Nyb2xsVG8oMCwgY3Vyc29yVmlld3BvcnQudG9wKTtcblx0fVxuXG5cdGxldCBjb250YWluZXJFbDogSFRNTEVsZW1lbnQgPSBnZXRDb250YWluZXJFbGVtZW50KHRhcmdldExlYWYpO1xuXHRpZiAoY29udGFpbmVyRWwgIT0gbnVsbCkge1xuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0Ly8gQHRzLWlnbm9yZVxuXHRcdFx0Y29udGFpbmVyRWwucXVlcnlTZWxlY3RvcihcIi52aWV3LWNvbnRlbnRcIik/LnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiXCIpO1xuXHRcdH0sIDUwKTtcblx0fVxuXG5cdGxldCBlZGl0b3JWaWV3OiBFZGl0b3JWaWV3ID0gZ2V0RWRpdG9yVmlldyh0YXJnZXRMZWFmKTtcblxuXHRsZXQgW3ByZWZpeCwgdGV4dCwgc3VmZml4LCBmaWxlLCBmcm9tLCB0b10gPSBwcm9jZXNzVVJJKGRhdGFTdHJpbmcpO1xuXHQvLyByZW1vdmVIaWdobGlnaHQoZWRpdG9yVmlldywgZnJvbSwgdG8pO1xuXHQvLyByZW1vdmVIaWdobGlnaHRzKGVkaXRvclZpZXcpO1xuXG5cdC8vIGJhY2tsaW5rIGVmZmVjdFxuXHRjb25zdCBvcmlnaW5hbExlYWYgPSB3b3Jrc3BhY2UuZ2V0TGVhZkJ5SWQoYmFja2xpbmtMZWFmSWQpO1xuXHRpZiAoIW9yaWdpbmFsTGVhZikge1xuXHRcdHJlc2V0QmFja2xpbmtIb3ZlcigpO1xuXHRcdHRocm93IG5ldyBFcnJvcihcIk9yaWdpbmFsIGxlYWYgbm90IGZvdW5kXCIpO1xuXHR9XG5cdGxldCBvcmlnaW5hbEVkaXRvclZpZXc6IEVkaXRvclZpZXcgPSBnZXRFZGl0b3JWaWV3KG9yaWdpbmFsTGVhZik7XG5cblx0cmVtb3ZlSGlnaGxpZ2h0KG9yaWdpbmFsRWRpdG9yVmlldywgZnJvbSwgdG8pO1xuXHRkZWZhdWx0SGlnaGxpZ2h0U2VsZWN0aW9uKG9yaWdpbmFsRWRpdG9yVmlldywgZnJvbSwgdG8pO1xuXG5cdC8vIHJlbW92ZUhpZ2hsaWdodHMob3JpZ2luYWxFZGl0b3JWaWV3KTtcblxuXHRpZiAoZ2V0Q3Vyc29yKCkgIT0gbnVsbCAmJiBnZXRDdXJzb3IoKS5kYXRhU3RyaW5nKSB7XG5cdFx0Y29uc3QgeyBkYXRhU3RyaW5nLCBjdXJzb3JWaWV3cG9ydCwgbGVhZklkLCBvcmlnaW5hbExlYWZJZCB9ID0gZ2V0Q3Vyc29yKCk7XG5cdFx0bGV0IFtwcmVmaXgsIHRleHQsIHN1ZmZpeCwgZmlsZSwgZnJvbSwgdG9dID0gcHJvY2Vzc1VSSShkYXRhU3RyaW5nKTtcblx0XHRjb25zdCBjdXJzb3JMZWFmID0gd29ya3NwYWNlLmdldExlYWZCeUlkKGxlYWZJZCk7XG5cdFx0d29ya3NwYWNlLnJldmVhbExlYWYoY3Vyc29yTGVhZik7XG5cblx0XHRjb25zdCBlZGl0b3JWaWV3OiBFZGl0b3JWaWV3ID0gZ2V0RWRpdG9yVmlldyhjdXJzb3JMZWFmKTtcblx0XHRoaWdobGlnaHRTZWxlY3Rpb24oZWRpdG9yVmlldywgZnJvbSwgdG8pO1xuXHR9XG5cblx0aWYgKHRlbXAgJiYgdGFyZ2V0TGVhZikge1xuXHRcdHRhcmdldExlYWYuZGV0YWNoKCk7XG5cdH1cblxuXHRpZiAocGVlaykge1xuXHRcdGxldCBvcmlnaW5hbExlYWYgPSB3b3Jrc3BhY2UuZ2V0TGVhZkJ5SWQob3JpZ2luYWxMZWFmSWQpO1xuXHRcdGlmICghb3JpZ2luYWxMZWFmKSB7XG5cdFx0XHRyZXNldEJhY2tsaW5rSG92ZXIoKTtcblx0XHRcdHRocm93IG5ldyBFcnJvcihcIk9yaWdpbmFsIGxlYWYgbm90IGZvdW5kXCIpO1xuXHRcdH1cblxuXHRcdHdvcmtzcGFjZS5yZXZlYWxMZWFmKG9yaWdpbmFsTGVhZik7XG5cdH1cblxuXHQvLyBpZiAodGVtcCkge1xuXHQvLyBcdHRhcmdldExlYWYuZGV0YWNoKCk7XG5cdC8vIFx0Ly8gc2V0VGltZW91dCgoKSA9PiB7XG5cdC8vIFx0Ly8gXHR0YXJnZXRMZWFmLmRldGFjaCgpO1xuXHQvLyBcdC8vIH0sIDEwMCk7XG5cdC8vIH0gZWxzZSB7XG5cdC8vIFx0Ly8gaWYgdGhlIGN1cnNvciBpcyBhY3RpdmUsIGhpZ2hsaWdodCB0aGUgc2VsZWN0aW9uXG5cdC8vIH1cblxuXHQvLyBFbmQgbXV0ZXggbG9ja1xuXHRyZXNldEJhY2tsaW5rSG92ZXIoKTtcbn1cbiIsICJpbXBvcnQgeyBFZGl0b3JWaWV3LCBEZWNvcmF0aW9uLCBEZWNvcmF0aW9uU2V0IH0gZnJvbSBcIkBjb2RlbWlycm9yL3ZpZXdcIjtcbmltcG9ydCB7IFN0YXRlRmllbGQsIFN0YXRlRWZmZWN0IH0gZnJvbSBcIkBjb2RlbWlycm9yL3N0YXRlXCI7XG5pbXBvcnQgeyBTVkdfSE9WRVJfQ09MT1IgfSBmcm9tIFwiLi9jb25zdGFudHNcIjtcblxuY29uc3QgYWRkSGlnaGxpZ2h0ID0gU3RhdGVFZmZlY3QuZGVmaW5lPHsgZnJvbTogbnVtYmVyOyB0bzogbnVtYmVyIH0+KHtcblx0bWFwOiAoeyBmcm9tLCB0byB9LCBjaGFuZ2UpID0+ICh7XG5cdFx0ZnJvbTogY2hhbmdlLm1hcFBvcyhmcm9tKSxcblx0XHR0bzogY2hhbmdlLm1hcFBvcyh0byksXG5cdH0pLFxufSk7XG5cbmNvbnN0IGFkZERlZmF1bHRIaWdobGlnaHQgPSBTdGF0ZUVmZmVjdC5kZWZpbmU8eyBmcm9tOiBudW1iZXI7IHRvOiBudW1iZXIgfT4oe1xuXHRtYXA6ICh7IGZyb20sIHRvIH0sIGNoYW5nZSkgPT4gKHtcblx0XHRmcm9tOiBjaGFuZ2UubWFwUG9zKGZyb20pLFxuXHRcdHRvOiBjaGFuZ2UubWFwUG9zKHRvKSxcblx0fSksXG59KTtcblxuY29uc3QgcmVzZXRIaWdobGlnaHQgPSBTdGF0ZUVmZmVjdC5kZWZpbmU8eyBmcm9tOiBudW1iZXI7IHRvOiBudW1iZXIgfT4oe1xuXHRtYXA6ICh7IGZyb20sIHRvIH0sIGNoYW5nZSkgPT4gKHtcblx0XHRmcm9tOiBjaGFuZ2UubWFwUG9zKGZyb20pLFxuXHRcdHRvOiBjaGFuZ2UubWFwUG9zKHRvKSxcblx0fSksXG59KTtcblxuY29uc3QgaGlnaGxpZ2h0RmllbGQgPSBTdGF0ZUZpZWxkLmRlZmluZTxEZWNvcmF0aW9uU2V0Pih7XG5cdGNyZWF0ZSgpIHtcblx0XHRyZXR1cm4gRGVjb3JhdGlvbi5ub25lO1xuXHR9LFxuXHR1cGRhdGUoaGlnbGlnaHRzLCB0cikge1xuXHRcdGhpZ2xpZ2h0cyA9IGhpZ2xpZ2h0cy5tYXAodHIuY2hhbmdlcyk7XG5cdFx0Zm9yIChsZXQgZSBvZiB0ci5lZmZlY3RzKVxuXHRcdFx0aWYgKGUuaXMoYWRkRGVmYXVsdEhpZ2hsaWdodCkpIHtcblx0XHRcdFx0aGlnbGlnaHRzID0gaGlnbGlnaHRzLnVwZGF0ZSh7XG5cdFx0XHRcdFx0YWRkOiBbZGVmYXVsdEhpZ2hsaWdodE1hcmsucmFuZ2UoZS52YWx1ZS5mcm9tLCBlLnZhbHVlLnRvKV0sXG5cdFx0XHRcdH0pO1xuXHRcdFx0fSBlbHNlIGlmIChlLmlzKGFkZEhpZ2hsaWdodCkpIHtcblx0XHRcdFx0aGlnbGlnaHRzID0gaGlnbGlnaHRzLnVwZGF0ZSh7XG5cdFx0XHRcdFx0YWRkOiBbaGlnaGxpZ2h0TWFyay5yYW5nZShlLnZhbHVlLmZyb20sIGUudmFsdWUudG8pXSxcblx0XHRcdFx0fSk7XG5cdFx0XHR9IGVsc2UgaWYgKGUuaXMocmVzZXRIaWdobGlnaHQpKSB7XG5cdFx0XHRcdGhpZ2xpZ2h0cyA9IGhpZ2xpZ2h0cy51cGRhdGUoe1xuXHRcdFx0XHRcdGZpbHRlcjogKGZyb20sIHRvKSA9PiB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gIShmcm9tID09PSBlLnZhbHVlLmZyb20gJiYgdG8gPT09IGUudmFsdWUudG8pO1xuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdHJldHVybiBoaWdsaWdodHM7XG5cdH0sXG5cdHByb3ZpZGU6IChmKSA9PiBFZGl0b3JWaWV3LmRlY29yYXRpb25zLmZyb20oZiksXG59KTtcblxuY29uc3QgaGlnaGxpZ2h0TWFyayA9IERlY29yYXRpb24ubWFyayh7IGNsYXNzOiBcImhpZ2hsaWdodFwiIH0pO1xuY29uc3QgZGVmYXVsdEhpZ2hsaWdodE1hcmsgPSBEZWNvcmF0aW9uLm1hcmsoeyBjbGFzczogXCJkZWZhdWx0LWhpZ2hsaWdodFwiIH0pO1xuY29uc3QgdGhlbWUgPSBFZGl0b3JWaWV3LmJhc2VUaGVtZSh7fSk7XG5jb25zdCBoaWdobGlnaHRUaGVtZSA9IEVkaXRvclZpZXcuYmFzZVRoZW1lKHtcblx0XCIuaGlnaGxpZ2h0XCI6IHtcblx0XHRcImJhY2tncm91bmQtY29sb3JcIjpcblx0XHRcdFwiaHNsKGNhbGModmFyKC0tYWNjZW50LWgpIC0gMyksIGNhbGModmFyKC0tYWNjZW50LXMpICogMS4wMiksIGNhbGModmFyKC0tYWNjZW50LWwpICogMS4zKSlcIixcblx0XHRjb2xvcjogXCJibGFja1wiLFxuXHR9LFxufSk7XG4vLyBjb25zdCBkZWZhdWx0SGlnaGxpZ2h0VGhlbWUgPSBFZGl0b3JWaWV3LmJhc2VUaGVtZSh7XG4vLyBcdFwiLmhpZ2hsaWdodFwiOiB7XG4vLyBcdFx0XCJiYWNrZ3JvdW5kLWNvbG9yXCI6XG4vLyBcdFx0XHRcImhzbChjYWxjKHZhcigtLWFjY2VudC1oKSAtIDMpLCBjYWxjKHZhcigtLWFjY2VudC1zKSAqIDEuMDIpLCBjYWxjKHZhcigtLWFjY2VudC1sKSAqIDEuNDMpKVwiLFxuLy8gXHRcdGNvbG9yOiBcImJsYWNrXCIsXG4vLyBcdH0sXG4vLyB9KTtcbmNvbnN0IGRlZmF1bHRIaWdobGlnaHRUaGVtZSA9IEVkaXRvclZpZXcuYmFzZVRoZW1lKHtcblx0XCIuZGVmYXVsdC1oaWdobGlnaHRcIjoge1xuXHRcdFwiYmFja2dyb3VuZC1jb2xvclwiOlxuXHRcdFx0XCJoc2woY2FsYyh2YXIoLS1hY2NlbnQtaCkgLSAzKSwgY2FsYyh2YXIoLS1hY2NlbnQtcykgKiAxLjAyKSwgY2FsYyh2YXIoLS1hY2NlbnQtbCkgKiAxLjQzKSlcIixcblx0XHRjb2xvcjogXCJibGFja1wiLFxuXHR9LFxufSk7XG5cbmV4cG9ydCBmdW5jdGlvbiBoaWdobGlnaHRTZWxlY3Rpb24odmlldzogRWRpdG9yVmlldywgZnJvbTogbnVtYmVyLCB0bzogbnVtYmVyKSB7XG5cdGxldCBlZmZlY3RzOiBTdGF0ZUVmZmVjdDx1bmtub3duPltdID0gW2FkZEhpZ2hsaWdodC5vZih7IGZyb20sIHRvIH0pXTtcblxuXHRpZiAoIWVmZmVjdHMubGVuZ3RoKSByZXR1cm4gZmFsc2U7XG5cblx0aWYgKCF2aWV3LnN0YXRlLmZpZWxkKGhpZ2hsaWdodEZpZWxkLCBmYWxzZSkpXG5cdFx0ZWZmZWN0cy5wdXNoKFN0YXRlRWZmZWN0LmFwcGVuZENvbmZpZy5vZihbaGlnaGxpZ2h0RmllbGQsIHRoZW1lXSkpO1xuXG5cdHZpZXcuZGlzcGF0Y2goeyBlZmZlY3RzIH0pO1xuXHRyZXR1cm4gdHJ1ZTtcbn1cblxuLy8gaGF2ZSBhIGZ1bmN0aW9uIHRoYXQgYWRkcyBzdWJ0bGUgaGlnaGxpZ2h0cyB0byBzdGF0ZVxuZXhwb3J0IGZ1bmN0aW9uIGRlZmF1bHRIaWdobGlnaHRTZWxlY3Rpb24oXG5cdHZpZXc6IEVkaXRvclZpZXcsXG5cdGZyb206IG51bWJlcixcblx0dG86IG51bWJlclxuKSB7XG5cdGxldCBlZmZlY3RzOiBTdGF0ZUVmZmVjdDx1bmtub3duPltdID0gW2FkZERlZmF1bHRIaWdobGlnaHQub2YoeyBmcm9tLCB0byB9KV07XG5cblx0aWYgKCFlZmZlY3RzLmxlbmd0aCkgcmV0dXJuIGZhbHNlO1xuXG5cdC8vIGxldCBmaWx0ZXJlZEVmZmVjdHM6IFN0YXRlRWZmZWN0PHVua25vd24+W10gPSB2aWV3LnN0YXRlLnNlbGVjdGlvbi5yYW5nZXNcblx0Ly8gXHQuZmlsdGVyKFxuXHQvLyBcdFx0KHsgZnJvbSwgdG8gfSkgPT4gIWVmZmVjdHMuaW5jbHVkZXMoYWRkRGVmYXVsdEhpZ2hsaWdodC5vZih7IGZyb20sIHRvIH0pKVxuXHQvLyBcdClcblx0Ly8gXHQubWFwKCh7IGZyb20sIHRvIH0pID0+IGFkZERlZmF1bHRIaWdobGlnaHQub2YoeyBmcm9tLCB0byB9KSk7XG5cblx0Ly8gZWZmZWN0cyA9IFsuLi5lZmZlY3RzLCAuLi5maWx0ZXJlZEVmZmVjdHNdO1xuXG5cdGlmICghdmlldy5zdGF0ZS5maWVsZChoaWdobGlnaHRGaWVsZCwgZmFsc2UpKVxuXHRcdGVmZmVjdHMucHVzaChTdGF0ZUVmZmVjdC5hcHBlbmRDb25maWcub2YoW2hpZ2hsaWdodEZpZWxkLCB0aGVtZV0pKTtcblxuXHR2aWV3LmRpc3BhdGNoKHsgZWZmZWN0cyB9KTtcblxuXHRyZXR1cm4gdHJ1ZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZUhpZ2hsaWdodCh2aWV3OiBFZGl0b3JWaWV3LCBmcm9tOiBudW1iZXIsIHRvOiBudW1iZXIpIHtcblx0bGV0IGVmZmVjdHM6IFN0YXRlRWZmZWN0PHVua25vd24+W10gPSBbcmVzZXRIaWdobGlnaHQub2YoeyBmcm9tLCB0byB9KV07XG5cblx0aWYgKCFlZmZlY3RzLmxlbmd0aCkgcmV0dXJuIGZhbHNlO1xuXG5cdHZpZXcuZGlzcGF0Y2goeyBlZmZlY3RzIH0pO1xuXHRyZXR1cm4gdHJ1ZTtcbn1cblxuLy8gdXBkYXRlIHJlbW92ZSBoaWdobGlnaHRzIHNvIHRoYXRcbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVIaWdobGlnaHRzKHZpZXc6IEVkaXRvclZpZXcpIHtcblx0aWYgKCF2aWV3KSByZXR1cm47XG5cblx0bGV0IGVmZmVjdHM6IFN0YXRlRWZmZWN0PHVua25vd24+W10gPSB2aWV3LnN0YXRlLnNlbGVjdGlvbi5yYW5nZXMubWFwKFxuXHRcdCh7IGZyb20sIHRvIH0pID0+IHJlc2V0SGlnaGxpZ2h0Lm9mKHsgZnJvbSwgdG8gfSlcblx0KTtcblx0aWYgKGVmZmVjdHMubGVuZ3RoKSB7XG5cdFx0dmlldy5kaXNwYXRjaCh7IGVmZmVjdHMgfSk7XG5cdFx0cmV0dXJuIHRydWU7XG5cdH1cblx0cmV0dXJuIGZhbHNlO1xufVxuXG4vLyBJIHdhbnQgdG8gYWRkIGEgYnVuY2ggb2YgaGlnaGxpZ2h0cyB0byB0aGUgc3RhdGUgdGhhdCB1c2Ugc29tZSBsaWdodGVyIGhpZ2hsaWdodCB0aGVtZVxuLy8gQW5kIHRoZW4gcmVtb3ZlIHRoZW0gYW5kIHVwZGF0ZSB0aGUgaGlnaGxpZ2h0cyBvbiBlYWNoIGdlbmVyYXRpb24gb2YgYmFja2xpbmtNYXJrUG9zaXRpb25zXG4iLCAiaW1wb3J0IHsgUGx1Z2luLCBNYXJrZG93blZpZXcsIEVkaXRvciB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHtcblx0cHJvY2Vzc1VSSSxcblx0cGFyc2VFZGl0b3JQb3NpdGlvbixcblx0ZW5jb2RlVVJJQ29tcG9uZW50U3RyaW5nLFxuXHRnZXRQcmVmaXhBbmRTdWZmaXgsXG59IGZyb20gXCIuL3V0aWxzXCI7XG5cbi8vIFtcdTIxOTddKHVybjpBbHNvLTogaG9wZWZ1bGx5IGZpeCB0aGUgbXVsdGktbGluZSByZWZlcmVuY2U6LSUwQS0gVVJOczoxMS0yMyBUb2RvLm1kKVxuLy8gW1x1MjE5N10odXJuOlBSRUZJWC06VEVYVDotU1VGRklYOkZJTEU6U1RBUlRJTkRFWDpFTkRJTkRFWClcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVDbGlwYm9hcmQoXG5cdHRvZ2dsZTogYm9vbGVhbiA9IGZhbHNlLFxuXHRvbmx5OiBib29sZWFuID0gZmFsc2Vcbikge1xuXHRjb25zdCB2aWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcblx0Ly8gTWFrZSBzdXJlIHRoZSB1c2VyIGlzIGVkaXRpbmcgYSBNYXJrZG93biBmaWxlLlxuXHRpZiAodmlldykge1xuXHRcdGxldCBzZWxlY3Rpb24gPSB2aWV3LmVkaXRvci5nZXRTZWxlY3Rpb24oKTtcblx0XHRpZiAodmlldy5maWxlKSB7XG5cdFx0XHRjb25zdCB0ZXh0ID0gdmlldy5kYXRhO1xuXHRcdFx0Y29uc3QgZnJvbSA9IHZpZXcuZWRpdG9yLnBvc1RvT2Zmc2V0KHZpZXcuZWRpdG9yLmdldEN1cnNvcihcImZyb21cIikpO1xuXHRcdFx0Y29uc3QgdG8gPSB2aWV3LmVkaXRvci5wb3NUb09mZnNldCh2aWV3LmVkaXRvci5nZXRDdXJzb3IoXCJ0b1wiKSk7XG5cdFx0XHRjb25zdCB7IHByZWZpeCwgc3VmZml4IH0gPSBnZXRQcmVmaXhBbmRTdWZmaXgodGV4dCwgZnJvbSwgdG8pO1xuXHRcdFx0bGV0IHJlZmVyZW5jZSA9IGBbXHUyMTk3XSh1cm46JHtlbmNvZGVVUklDb21wb25lbnRTdHJpbmcoXG5cdFx0XHRcdHByZWZpeFxuXHRcdFx0KX0tOiR7ZW5jb2RlVVJJQ29tcG9uZW50U3RyaW5nKHNlbGVjdGlvbil9Oi0ke2VuY29kZVVSSUNvbXBvbmVudFN0cmluZyhcblx0XHRcdFx0c3VmZml4XG5cdFx0XHQpfToke2VuY29kZVVSSUNvbXBvbmVudFN0cmluZyh2aWV3LmZpbGUucGF0aCl9OiR7ZnJvbX06JHt0b306JHtcblx0XHRcdFx0Ly8gb25seSA/IFwicG9ydGFsXCIgOiBcIm5vLXBvcnRhbFwiXG5cdFx0XHRcdFwicG9ydGFsXCJcblx0XHRcdH06JHt0b2dnbGUgPyBcInRcIiA6IFwiZlwifSlgO1xuXG5cdFx0XHQvLyBXcml0ZSB0aGUgc2VsZWN0ZWQgdGV4dCB0byB0aGUgY2xpcGJvYXJkXG5cdFx0XHRhd2FpdCBuYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dChyZWZlcmVuY2UpO1xuXHRcdH1cblx0fVxufVxuIl0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFB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LElBQUksR0FBRyxJQUFJLElBQUksRUFBRSxHQUFHO0FBQzNCLFVBQUksQ0FBQyxJQUFJLE1BQU0sSUFBSSxLQUFLLElBQUksQ0FBQyxLQUFLLEtBQUssTUFBTSxJQUFJLEtBQUssSUFBSSxJQUFJLENBQUMsS0FBSyxLQUFLLE1BQU0sSUFBSSxLQUFLLElBQUksSUFBSSxDQUFDLEtBQUssSUFBSSxNQUFNLElBQUksS0FBSyxJQUFJLElBQUksQ0FBQztBQUFBLElBQ3BJO0FBRUEsTUFBRSxDQUFDLElBQUk7QUFBQSxFQUNUO0FBRUEsSUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLEtBQUssTUFBTSxTQUFTLEtBQUssSUFBSSxLQUFLLElBQUksR0FBRyxFQUFFO0FBQ3RELElBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRSxJQUFJLEtBQUssTUFBTSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQztBQUN0QyxJQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsS0FBSyxNQUFNLFNBQVMsS0FBSyxJQUFJO0FBRXhDLFdBQVMsSUFBSSxHQUFHLElBQUksR0FBRyxFQUFFLEdBQUc7QUFDMUIsVUFBTSxJQUFJLElBQUksWUFBWSxFQUFFO0FBRTVCLGFBQVMsSUFBSSxHQUFHLElBQUksSUFBSSxFQUFFLEdBQUc7QUFDM0IsUUFBRSxDQUFDLElBQUksRUFBRSxDQUFDLEVBQUUsQ0FBQztBQUFBLElBQ2Y7QUFFQSxhQUFTLElBQUksSUFBSSxJQUFJLElBQUksRUFBRSxHQUFHO0FBQzVCLFFBQUUsQ0FBQyxJQUFJLEtBQUssRUFBRSxJQUFJLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsR0FBRyxDQUFDO0FBQUEsSUFDNUQ7QUFFQSxRQUFJLElBQUksRUFBRSxDQUFDO0FBQ1gsUUFBSSxJQUFJLEVBQUUsQ0FBQztBQUNYLFFBQUksSUFBSSxFQUFFLENBQUM7QUFDWCxRQUFJLElBQUksRUFBRSxDQUFDO0FBQ1gsUUFBSSxJQUFJLEVBQUUsQ0FBQztBQUVY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UUFBUTtBQUM5QyxrQkFBTSxTQUFTLGdCQUFnQixVQUFVLEVBQUU7QUFDM0Msa0JBQU0sYUFBYSx3QkFBd0IsTUFBTTtBQUVqRCxrQkFBTSxtQkFBbUIsU0FBUyxNQUFNLFlBQVksR0FBRztBQUN2RCxvQkFBUSxJQUFJLElBQUk7QUFDaEIsZ0JBQUksQ0FBQyxLQUFLLFVBQVUsU0FBUyx1QkFBdUIsR0FBRztBQUN0RCxtQkFBSyxVQUFVLElBQUksdUJBQXVCO0FBQUEsWUFHM0M7QUFDQSxpQkFBSyxVQUFVLE9BQU8sdUJBQXVCO0FBQUEsVUFPOUM7QUFBQSxRQUNELE9BQU87QUFDTixjQUFJLHdCQUFPLHdCQUF3QjtBQW9CbkMscUJBQVcsUUFBUSxPQUFPO0FBQ3pCLGdCQUFJLGlCQUFnQixVQUFLLGtCQUFMLG1CQUFvQjtBQUFBLGNBQ3ZDO0FBQUE7QUFFRCxnQkFBSSxVQUFVLCtDQUFlLGFBQWE7QUFDMUMsa0JBQU0sYUFBYSxLQUFLLElBQUksVUFBVSxRQUFRO0FBQzlDLGtCQUFNLFNBQVMsZ0JBQWdCLFVBQVUsRUFBRTtBQUMzQyxrQkFBTSxhQUFhLHdCQUF3QixNQUFNO0FBRWpELGtCQUFNLG1CQUFtQixTQUFTLE1BQU0sWUFBWSxHQUFHO0FBQ3ZELG9CQUFRLElBQUksSUFBSTtBQUdoQixnQkFBSSxLQUFLLFVBQVUsU0FBUyx1QkFBdUIsR0FBRztBQUNyRCxtQkFBSyxVQUFVLE9BQU8sdUJBQXVCO0FBQUEsWUFHOUM7QUFHQSxpQkFBSyxVQUFVLElBQUksdUJBQXVCO0FBQUEsVUFNM0M7QUFBQSxRQUNEO0FBQUEsTUFDRDtBQUFBLElBQ0QsQ0FBQztBQUFBLEVBa0RGO0FBQUEsRUFFQSxXQUFXO0FBQUEsRUFBQztBQUNiOyIsCiAgIm5hbWVzIjogWyJoYW5kbGVNb3ZlbWVudEVmZmVjdHMiLCAiaW1wb3J0X29ic2lkaWFuIiwgInRoYXQiLCAiaW1wb3J0X3ZpZXciLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X3ZpZXciLCAiaW1wb3J0X3N0YXRlIiwgImYiLCAiaW1wb3J0X3ZpZXciLCAiZWRpdG9yIiwgImJhY2tsaW5rQ29udGFpbmVyIiwgIndpbmRvd0hlaWdodCIsICJzY3JvbGxUb3AiLCAic2Nyb2xsQm90dG9tIiwgInZpc2libGVFbGVtZW50cyIsICJzdGFydFRvcCIsICJwb3NpdGlvbnMiLCAicmFuZ2VTdGFydCIsICJyYW5nZUVuZCIsICJjb250YWluZXIiLCAiZGF0YVN0cmluZyIsICJjdXJzb3JWaWV3cG9ydCIsICJsZWFmSWQiLCAib3JpZ2luYWxMZWFmSWQiLCAicHJlZml4IiwgInRleHQiLCAic3VmZml4IiwgImZpbGUiLCAiZnJvbSIsICJ0byIsICJlZGl0b3JWaWV3IiwgIm9yaWdpbmFsTGVhZiIsICJkb2N1bWVudCIsICJzdmciLCAiYmFja2xpbmtzIiwgImJhY2tsaW5rcyIsICJ0ZXh0IiwgImluZGV4IiwgInJlZmVyZW5jZSIsICJwYXJ0cyIsICJsaW5lUmVmZXJlbmNlcyIsICJsaW5lUmVmZXJlbmNlc0RhdGEiLCAibGVhZiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X3ZpZXciLCAiYmFja2xpbmtzIiwgImhhbmRsZU1vdmVtZW50RWZmZWN0cyIsICJsZWF2ZXMiXQp9Cg==
