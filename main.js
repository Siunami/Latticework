/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => ReferencePlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian6 = require("obsidian");

// src/state.ts
var import_state = require("@codemirror/state");
var that = import_state.StateField.define({
  create() {
    return null;
  },
  update(value, tr) {
    if (tr["annotations"].length == 2 && tr["annotations"][0].value.type == "that") {
      return tr["annotations"][0].value.that.app;
    }
    return value;
  }
});
var hoveredCursor = import_state.StateField.define({
  create() {
    return null;
  },
  update(value, tr) {
    if (tr["annotations"].length == 2 && tr["annotations"][0].value.type == "hoveredCursor") {
      if (value)
        return [
          ...value.filter(
            (cursor) => cursor.user != tr["annotations"][0].value.user
          ),
          {
            cursor: tr["annotations"][0].value.cursor,
            user: tr["annotations"][0].value.user
          }
        ];
      return [
        {
          cursor: tr["annotations"][0].value.cursor,
          user: tr["annotations"][0].value.user
        }
      ];
    } else if (tr["annotations"].length == 2 && tr["annotations"][0].value.type == "removeHoveredCursor") {
      if (value)
        return value.filter(
          (cursor) => cursor.user != tr["annotations"][0].value.user
        );
      return value;
    }
    return value;
  }
});
var backlinks = import_state.StateField.define({
  create() {
    return [];
  },
  update(value, tr) {
    if (tr.effects.length > 0) {
      try {
        let data = JSON.parse(
          tr.effects[0].value
        );
        if (data.type == "backlink") {
          if (data.backlinks.length == 0)
            return value;
          let referencingLocation = data.backlinks[0]["referencingLocation"]["filename"];
          let filteredValues = value.filter(
            (backlink) => backlink.referencingLocation.filename != referencingLocation
          );
          return [...filteredValues, ...data.backlinks];
        }
        return value;
      } catch (e) {
        console.log(e);
        return value;
      }
    }
    return value;
  }
});
var hoverElement = import_state.StateField.define({
  create() {
    return null;
  },
  update(value, tr) {
    if (tr.effects.length > 0) {
      try {
        let data = JSON.parse(tr.effects[0].value);
        if (data.type == "hover-start") {
          return Object.assign({}, data);
        } else if (data.type == "hover") {
          if (value)
            return Object.assign(value, data);
          return data;
        } else if (data.type == "hover-off") {
          return null;
        }
        return value;
      } catch (e) {
        console.log(e);
        return value;
      }
    }
    return value;
  }
});
var backlinkHoverElement = import_state.StateField.define({
  create() {
    return null;
  },
  update(value, tr) {
    if (tr.effects.length > 0) {
      try {
        let data = JSON.parse(tr.effects[0].value);
        if (data.type == "backlink-start") {
          return Object.assign({}, data);
        } else if (data.type == "backlink-update") {
          if (value)
            return Object.assign(value, data);
          return data;
        } else if (data.type == "backlink-off") {
          return null;
        }
        return value;
      } catch (e) {
        console.log(e);
        return value;
      }
    }
    return value;
  }
});
var cursorElement = import_state.StateField.define({
  create() {
    return null;
  },
  update(value, tr) {
    if (tr.effects.length > 0) {
      try {
        let data = JSON.parse(tr.effects[0].value);
        if (data.type == "cursor-start") {
          return {};
        } else if (data.type == "cursor") {
          if (value)
            return Object.assign(value, data);
          return data;
        } else if (data.type == "cursor-off") {
          return null;
        }
        return value;
      } catch (e) {
        console.log(e);
        return value;
      }
    }
    return value;
  }
});
var editorChange = import_state.StateField.define({
  create() {
    return null;
  },
  update(value, tr) {
    if (tr.effects.length > 0) {
      try {
        let data = JSON.parse(tr.effects[0].value);
        if (data.type == "sync") {
          return value;
        }
        return value;
      } catch (e) {
        console.log(e);
        return value;
      }
    }
    return value;
  }
});
var thatAnnotation = import_state.Annotation.define();
var hoveredCursorAnnotation = import_state.Annotation.define();
var hoverEffect = import_state.StateEffect.define();
var backlinkHoverEffect = import_state.StateEffect.define();
var cursorEffect = import_state.StateEffect.define();
var backlinkEffect = import_state.StateEffect.define();
var state = import_state.EditorState.create({
  extensions: [
    that,
    hoveredCursor,
    backlinks,
    hoverElement,
    backlinkHoverElement,
    cursorElement,
    editorChange
  ]
});
function getThat() {
  return state.field(that);
}
function updateThat(that2) {
  state = state.update({
    annotations: thatAnnotation.of({
      type: "that",
      that: that2
    })
  }).state;
}
function getHoveredCursor() {
  return state.field(hoveredCursor);
}
function updateHoveredCursor(cursor, user) {
  state = state.update({
    annotations: hoveredCursorAnnotation.of({
      type: "hoveredCursor",
      cursor,
      user
    })
  }).state;
}
function removeHoveredCursor(user) {
  state = state.update({
    annotations: hoveredCursorAnnotation.of({
      type: "removeHoveredCursor",
      user
    })
  }).state;
}
function getHover() {
  return state.field(hoverElement);
}
function updateHover(value) {
  state = state.update({
    effects: hoverEffect.of(
      JSON.stringify(Object.assign(value, { type: "hover" }))
    )
  }).state;
}
function resetHover() {
  state = state.update({
    effects: hoverEffect.of(
      JSON.stringify({
        type: "hover-off"
      })
    )
  }).state;
}
function getBacklinkHover() {
  return state.field(backlinkHoverElement);
}
function updateBacklinkHover(value) {
  state = state.update({
    effects: backlinkHoverEffect.of(
      JSON.stringify(Object.assign(value, { type: "backlink-update" }))
    )
  }).state;
}
function resetBacklinkHover() {
  state = state.update({
    effects: backlinkHoverEffect.of(
      JSON.stringify({
        type: "backlink-off"
      })
    )
  }).state;
}
function getCursor() {
  return state.field(cursorElement);
}
function updateCursor(value) {
  state = state.update({
    effects: cursorEffect.of(
      JSON.stringify(Object.assign(value, { type: "cursor" }))
    )
  }).state;
}
function resetCursor() {
  state = state.update({
    effects: cursorEffect.of(
      JSON.stringify({
        type: "cursor-off"
      })
    )
  }).state;
}
function updateBacklinks(value) {
  state = state.update({
    effects: backlinkEffect.of(
      JSON.stringify(Object.assign({ backlinks: value }, { type: "backlink" }))
    )
  }).state;
}

// src/widget/highlightWidget.ts
var import_view = require("@codemirror/view");

// src/constants.ts
var REFERENCE_REGEX = /\[\u2197\]\(urn:([^)]*)\)/g;
var ACTION_TYPE = {
  MOUSE: "mouse",
  CURSOR: "cursor",
  BACKLINK: "backlink"
};
var SVG_HOVER_COLOR = "rgb(187, 215, 230)";
var REFERENCE_ICON_HEIGHT = 20;
var PORTAL_TEXT_SLICE_SIZE = 100;

// src/widget/highlightWidget.ts
var HighlighterWidget = class extends import_view.WidgetType {
  constructor(name, view) {
    super();
    this.name = name;
    this.view = view;
  }
  eq(other) {
    return this.name === other.name;
  }
  toDOM() {
    const span = document.createElement("fragment");
    span.textContent = this.name;
    span.style.backgroundColor = SVG_HOVER_COLOR;
    span.style.color = "black";
    return span;
  }
};
var highlighterDecoration = (match, view) => import_view.Decoration.replace({
  widget: new HighlighterWidget(match[1], view)
});
var highlightMatcher = new import_view.MatchDecorator({
  regexp: /\+\+\+(.*?)\+\+\+/g,
  decoration: (match, view, pos) => {
    return highlighterDecoration(match, view);
  }
});
var highlights = import_view.ViewPlugin.fromClass(
  class {
    constructor(view) {
      this.highlights = highlightMatcher.createDeco(view);
    }
    update(update) {
      this.highlights = highlightMatcher.updateDeco(update, this.highlights);
    }
    destroy() {
      this.highlights = import_view.Decoration.none;
    }
  },
  {
    decorations: (instance) => instance.highlights,
    provide: (plugin) => import_view.EditorView.atomicRanges.of((view) => {
      var _a;
      return ((_a = view.plugin(plugin)) == null ? void 0 : _a.highlights) || import_view.Decoration.none;
    })
  }
);

// src/widget/referenceWidget.ts
var import_view4 = require("@codemirror/view");

// src/references.ts
var import_obsidian4 = require("obsidian");

// node_modules/uuid/dist/esm-browser/rng.js
var getRandomValues;
var rnds8 = new Uint8Array(16);
function rng() {
  if (!getRandomValues) {
    getRandomValues = typeof crypto !== "undefined" && crypto.getRandomValues && crypto.getRandomValues.bind(crypto);
    if (!getRandomValues) {
      throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");
    }
  }
  return getRandomValues(rnds8);
}

// node_modules/uuid/dist/esm-browser/regex.js
var regex_default = /^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;

// node_modules/uuid/dist/esm-browser/validate.js
function validate(uuid) {
  return typeof uuid === "string" && regex_default.test(uuid);
}
var validate_default = validate;

// node_modules/uuid/dist/esm-browser/stringify.js
var byteToHex = [];
for (let i = 0; i < 256; ++i) {
  byteToHex.push((i + 256).toString(16).slice(1));
}
function unsafeStringify(arr, offset = 0) {
  return byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + "-" + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + "-" + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + "-" + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + "-" + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]];
}

// node_modules/uuid/dist/esm-browser/parse.js
function parse(uuid) {
  if (!validate_default(uuid)) {
    throw TypeError("Invalid UUID");
  }
  let v;
  const arr = new Uint8Array(16);
  arr[0] = (v = parseInt(uuid.slice(0, 8), 16)) >>> 24;
  arr[1] = v >>> 16 & 255;
  arr[2] = v >>> 8 & 255;
  arr[3] = v & 255;
  arr[4] = (v = parseInt(uuid.slice(9, 13), 16)) >>> 8;
  arr[5] = v & 255;
  arr[6] = (v = parseInt(uuid.slice(14, 18), 16)) >>> 8;
  arr[7] = v & 255;
  arr[8] = (v = parseInt(uuid.slice(19, 23), 16)) >>> 8;
  arr[9] = v & 255;
  arr[10] = (v = parseInt(uuid.slice(24, 36), 16)) / 1099511627776 & 255;
  arr[11] = v / 4294967296 & 255;
  arr[12] = v >>> 24 & 255;
  arr[13] = v >>> 16 & 255;
  arr[14] = v >>> 8 & 255;
  arr[15] = v & 255;
  return arr;
}
var parse_default = parse;

// node_modules/uuid/dist/esm-browser/v35.js
function stringToBytes(str) {
  str = unescape(encodeURIComponent(str));
  const bytes = [];
  for (let i = 0; i < str.length; ++i) {
    bytes.push(str.charCodeAt(i));
  }
  return bytes;
}
var DNS = "6ba7b810-9dad-11d1-80b4-00c04fd430c8";
var URL = "6ba7b811-9dad-11d1-80b4-00c04fd430c8";
function v35(name, version, hashfunc) {
  function generateUUID(value, namespace, buf, offset) {
    var _namespace;
    if (typeof value === "string") {
      value = stringToBytes(value);
    }
    if (typeof namespace === "string") {
      namespace = parse_default(namespace);
    }
    if (((_namespace = namespace) === null || _namespace === void 0 ? void 0 : _namespace.length) !== 16) {
      throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");
    }
    let bytes = new Uint8Array(16 + value.length);
    bytes.set(namespace);
    bytes.set(value, namespace.length);
    bytes = hashfunc(bytes);
    bytes[6] = bytes[6] & 15 | version;
    bytes[8] = bytes[8] & 63 | 128;
    if (buf) {
      offset = offset || 0;
      for (let i = 0; i < 16; ++i) {
        buf[offset + i] = bytes[i];
      }
      return buf;
    }
    return unsafeStringify(bytes);
  }
  try {
    generateUUID.name = name;
  } catch (err) {
  }
  generateUUID.DNS = DNS;
  generateUUID.URL = URL;
  return generateUUID;
}

// node_modules/uuid/dist/esm-browser/native.js
var randomUUID = typeof crypto !== "undefined" && crypto.randomUUID && crypto.randomUUID.bind(crypto);
var native_default = {
  randomUUID
};

// node_modules/uuid/dist/esm-browser/v4.js
function v4(options, buf, offset) {
  if (native_default.randomUUID && !buf && !options) {
    return native_default.randomUUID();
  }
  options = options || {};
  const rnds = options.random || (options.rng || rng)();
  rnds[6] = rnds[6] & 15 | 64;
  rnds[8] = rnds[8] & 63 | 128;
  if (buf) {
    offset = offset || 0;
    for (let i = 0; i < 16; ++i) {
      buf[offset + i] = rnds[i];
    }
    return buf;
  }
  return unsafeStringify(rnds);
}
var v4_default = v4;

// node_modules/uuid/dist/esm-browser/sha1.js
function f(s, x, y, z) {
  switch (s) {
    case 0:
      return x & y ^ ~x & z;
    case 1:
      return x ^ y ^ z;
    case 2:
      return x & y ^ x & z ^ y & z;
    case 3:
      return x ^ y ^ z;
  }
}
function ROTL(x, n) {
  return x << n | x >>> 32 - n;
}
function sha1(bytes) {
  const K = [1518500249, 1859775393, 2400959708, 3395469782];
  const H = [1732584193, 4023233417, 2562383102, 271733878, 3285377520];
  if (typeof bytes === "string") {
    const msg = unescape(encodeURIComponent(bytes));
    bytes = [];
    for (let i = 0; i < msg.length; ++i) {
      bytes.push(msg.charCodeAt(i));
    }
  } else if (!Array.isArray(bytes)) {
    bytes = Array.prototype.slice.call(bytes);
  }
  bytes.push(128);
  const l = bytes.length / 4 + 2;
  const N = Math.ceil(l / 16);
  const M = new Array(N);
  for (let i = 0; i < N; ++i) {
    const arr = new Uint32Array(16);
    for (let j = 0; j < 16; ++j) {
      arr[j] = bytes[i * 64 + j * 4] << 24 | bytes[i * 64 + j * 4 + 1] << 16 | bytes[i * 64 + j * 4 + 2] << 8 | bytes[i * 64 + j * 4 + 3];
    }
    M[i] = arr;
  }
  M[N - 1][14] = (bytes.length - 1) * 8 / Math.pow(2, 32);
  M[N - 1][14] = Math.floor(M[N - 1][14]);
  M[N - 1][15] = (bytes.length - 1) * 8 & 4294967295;
  for (let i = 0; i < N; ++i) {
    const W = new Uint32Array(80);
    for (let t = 0; t < 16; ++t) {
      W[t] = M[i][t];
    }
    for (let t = 16; t < 80; ++t) {
      W[t] = ROTL(W[t - 3] ^ W[t - 8] ^ W[t - 14] ^ W[t - 16], 1);
    }
    let a = H[0];
    let b = H[1];
    let c = H[2];
    let d = H[3];
    let e = H[4];
    for (let t = 0; t < 80; ++t) {
      const s = Math.floor(t / 20);
      const T = ROTL(a, 5) + f(s, b, c, d) + e + K[s] + W[t] >>> 0;
      e = d;
      d = c;
      c = ROTL(b, 30) >>> 0;
      b = a;
      a = T;
    }
    H[0] = H[0] + a >>> 0;
    H[1] = H[1] + b >>> 0;
    H[2] = H[2] + c >>> 0;
    H[3] = H[3] + d >>> 0;
    H[4] = H[4] + e >>> 0;
  }
  return [H[0] >> 24 & 255, H[0] >> 16 & 255, H[0] >> 8 & 255, H[0] & 255, H[1] >> 24 & 255, H[1] >> 16 & 255, H[1] >> 8 & 255, H[1] & 255, H[2] >> 24 & 255, H[2] >> 16 & 255, H[2] >> 8 & 255, H[2] & 255, H[3] >> 24 & 255, H[3] >> 16 & 255, H[3] >> 8 & 255, H[3] & 255, H[4] >> 24 & 255, H[4] >> 16 & 255, H[4] >> 8 & 255, H[4] & 255];
}
var sha1_default = sha1;

// node_modules/uuid/dist/esm-browser/v5.js
var v5 = v35("v5", 80, sha1_default);
var v5_default = v5;

// src/utils.ts
var import_obsidian3 = require("obsidian");

// src/workspace.ts
var import_obsidian = require("obsidian");
function collectLeavesByTab(split, result = []) {
  const type = split.type;
  if (!type)
    throw new Error("Split type not found");
  if (type == "tabs" || type == "split") {
    const children = split.children;
    if (!children)
      throw new Error("Split children not found");
    if (children) {
      for (const child of children) {
        let emptyList = [];
        collectLeavesByTab(child, result);
      }
    }
  } else if (type == "leaf") {
    const parentSplitId = split.parent.id;
    if (!parentSplitId)
      throw new Error("Split parent id not found");
    let idx = result.findIndex((tab) => {
      const tabId = tab[0].parent.id;
      return tabId == parentSplitId;
    });
    if (idx == -1) {
      result.push([split]);
    } else {
      result[idx].push(split);
    }
  }
  return result;
}
function collectLeavesByTabHelper() {
  const { workspace } = getThat();
  const currLeaf = workspace.getLeaf();
  const rootSplit = currLeaf.getRoot();
  return collectLeavesByTab(rootSplit);
}
function getCurrentTabIndex(leavesByTab, span) {
  let workspaceTab = span.closest(".workspace-tabs");
  let currTabIdx = leavesByTab.findIndex((tab) => {
    const leafTab = tab[0].view.containerEl.closest(".workspace-tabs");
    return leafTab == workspaceTab;
  });
  return currTabIdx;
}
function getAdjacentTabs(leavesByTab, currTabIdx, file) {
  let rightAdjacentTab = [];
  let leftAdjacentTab = [];
  let adjacentTabs = [];
  if (leavesByTab[currTabIdx + 1]) {
    rightAdjacentTab = leavesByTab[currTabIdx + 1];
    adjacentTabs = [...adjacentTabs, ...rightAdjacentTab];
  }
  if (leavesByTab[currTabIdx - 1]) {
    leftAdjacentTab = leavesByTab[currTabIdx - 1];
    adjacentTabs = [...adjacentTabs, ...leftAdjacentTab];
  }
  let index = adjacentTabs.findIndex(
    (x) => x.getViewState().state.file == file
  );
  return { adjacentTabs, rightAdjacentTab, leftAdjacentTab, index };
}
async function openFileInAdjacentTab(leavesByTab, currTabIdx, file, type) {
  let { adjacentTabs, rightAdjacentTab, leftAdjacentTab } = getAdjacentTabs(
    leavesByTab,
    currTabIdx,
    file
  );
  let allTabNames = leavesByTab.map(
    (tab) => tab.map((x) => x.getViewState().state.file)
  );
  let rightAdjacentTabNames = rightAdjacentTab.map(
    (x) => x.getViewState().state.file
  );
  let leftAdjacentTabNames = leftAdjacentTab.map(
    (x) => x.getViewState().state.file
  );
  const { workspace } = getThat();
  if (allTabNames.filter((v, i) => i != currTabIdx).flat().includes(file) && !rightAdjacentTabNames.includes(file) && !leftAdjacentTabNames.includes(file)) {
    let currentTabNames = [];
    let currentTab = [];
    allTabNames.forEach((tabNames, i) => {
      if (tabNames != rightAdjacentTabNames && tabNames != leftAdjacentTabNames && currTabIdx != i) {
        if (tabNames.includes(file)) {
          currentTabNames = tabNames;
          currentTab = leavesByTab[i];
        }
      }
    });
    const originalLeaf = currentTab.filter(
      (t) => t.containerEl.style.display != "none"
    )[0];
    let leaf = currentTab[currentTabNames.indexOf(file)];
    workspace.revealLeaf(leaf);
    return { newLeaf: leaf, temp: false, originalLeaf };
  } else if (rightAdjacentTabNames.includes(file)) {
    const originalLeaf = rightAdjacentTab.filter(
      (t) => t.containerEl.style.display != "none"
    )[0];
    let leaf = rightAdjacentTab[rightAdjacentTabNames.indexOf(file)];
    workspace.revealLeaf(leaf);
    return { newLeaf: leaf, temp: false, originalLeaf };
  } else if (leftAdjacentTabNames.includes(file)) {
    const originalLeaf = leftAdjacentTab.filter(
      (t) => t.containerEl.style.display != "none"
    )[0];
    let leaf = leftAdjacentTab[leftAdjacentTabNames.indexOf(file)];
    workspace.revealLeaf(leaf);
    return { newLeaf: leaf, temp: false, originalLeaf };
  } else if (rightAdjacentTab.length > 0) {
    const originalLeaf = rightAdjacentTab.filter(
      (t) => t.containerEl.style.display != "none"
    )[0];
    let currLeaf = workspace.getLeaf();
    workspace.setActiveLeaf(originalLeaf);
    let newLeaf = workspace.getLeaf(true);
    await openFileInLeaf(newLeaf, file);
    workspace.revealLeaf(newLeaf);
    workspace.setActiveLeaf(currLeaf);
    return { newLeaf, temp: true, originalLeaf };
  } else if (leftAdjacentTab.length > 0) {
    const originalLeaf = leftAdjacentTab.filter(
      (t) => t.containerEl.style.display != "none"
    )[0];
    let currLeaf = workspace.getLeaf();
    workspace.setActiveLeaf(originalLeaf);
    let newLeaf = workspace.getLeaf(true);
    await openFileInLeaf(newLeaf, file);
    workspace.revealLeaf(newLeaf);
    workspace.setActiveLeaf(currLeaf);
    return { newLeaf, temp: true, originalLeaf };
  } else {
    const currLeaf = workspace.getLeaf();
    let newLeaf = workspace.createLeafBySplit(currLeaf);
    await openFileInLeaf(newLeaf, file);
    return { newLeaf, temp: true };
  }
}
async function openFileInLeaf(leaf, file) {
  let targetFile = getThat().vault.getAbstractFileByPath(file);
  if (targetFile && targetFile instanceof import_obsidian.TFile)
    await leaf.openFile(targetFile, { active: false });
}

// src/effects.ts
var import_obsidian2 = require("obsidian");

// src/mark.ts
var import_view2 = require("@codemirror/view");
var import_state3 = require("@codemirror/state");
var addHighlight = import_state3.StateEffect.define({
  map: ({ from, to }, change) => ({
    from: change.mapPos(from),
    to: change.mapPos(to)
  })
});
var resetHighlight = import_state3.StateEffect.define({
  map: ({ from, to }, change) => ({
    from: change.mapPos(from),
    to: change.mapPos(to)
  })
});
var highlightField = import_state3.StateField.define({
  create() {
    return import_view2.Decoration.none;
  },
  update(higlights, tr) {
    higlights = higlights.map(tr.changes);
    for (let e of tr.effects)
      if (e.is(addHighlight)) {
        higlights = higlights.update({
          add: [highlightMark.range(e.value.from, e.value.to)]
        });
      } else if (e.is(resetHighlight)) {
        higlights = higlights.update({ filter: (from, to) => false });
      }
    return higlights;
  },
  provide: (f2) => import_view2.EditorView.decorations.from(f2)
});
var highlightMark = import_view2.Decoration.mark({ class: "highlight" });
var highlightTheme = import_view2.EditorView.baseTheme({
  ".highlight": {
    "background-color": "white",
    color: "black"
  }
});
var defaultHighlightTheme = import_view2.EditorView.baseTheme({
  ".default-highlight": {
    "background-color": SVG_HOVER_COLOR,
    color: "black"
  }
});
function highlightSelection(view, from, to) {
  let effects = [addHighlight.of({ from, to })];
  if (!effects.length)
    return false;
  if (!view.state.field(highlightField, false))
    effects.push(import_state3.StateEffect.appendConfig.of([highlightField, highlightTheme]));
  view.dispatch({ effects });
  return true;
}
function removeHighlights(view) {
  if (!view)
    return;
  let effects = view.state.selection.ranges.map(
    ({ from, to }) => resetHighlight.of({ from, to })
  );
  if (effects.length) {
    view.dispatch({ effects });
    return true;
  }
  return false;
}

// src/effects.ts
var import_view3 = require("@codemirror/view");
function getEditorView(leaf) {
  var _a;
  if (!leaf)
    return null;
  const view = leaf.view;
  const editor = (_a = view.sourceMode) == null ? void 0 : _a.cmEditor;
  if (!editor.CodeMirror && editor.cm instanceof import_view3.EditorView) {
    const editorView = editor.cm;
    return editorView;
  }
  return null;
}
function checkSpanElementExists(span, containerEl) {
  const spanElements = containerEl.getElementsByTagName("span");
  for (let i = 0; i < spanElements.length; i++) {
    if (spanElements[i] === span) {
      return true;
    }
  }
  return false;
}
function parseCSSString(css) {
  const cssPropertiesRegex = /([\w-]+)\s*:\s*([^;]+)\s*;?/g;
  let cssPropertiesObject = {};
  let match;
  while ((match = cssPropertiesRegex.exec(css)) !== null) {
    cssPropertiesObject[match[1]] = match[2];
  }
  return cssPropertiesObject;
}
function tempDirectionIndicator(leaf, text, prefix, suffix, dataString, isSame, user) {
  let positions = findTextPositions(
    leaf.view.data,
    text,
    prefix.slice(0, prefix.length - 1),
    suffix.slice(1, suffix.length)
  );
  if (!positions)
    throw new Error("Positions not found");
  let rangeStart = positions.rangeStart;
  let rangeEnd = positions.rangeEnd;
  if (user === ACTION_TYPE.BACKLINK) {
    let startTop = leaf.view.editor.getScrollInfo().top;
    leaf.view.editor.scrollIntoView(
      {
        from: Object.assign(rangeStart, { ch: 0 }),
        to: Object.assign(rangeEnd, { ch: 0 })
      },
      true
    );
    setTimeout(() => {
      let endTop = leaf.view.editor.getScrollInfo().top;
      if (startTop === endTop && isSame) {
        leaf.containerEl.querySelector(".view-content").style.boxShadow = "none";
      } else if (startTop === endTop || !isSame) {
        leaf.containerEl.querySelector(".view-content").style.boxShadow = "inset 0px 0px 10px 10px rgba(248, 255, 255)";
      } else if (startTop < endTop) {
        leaf.containerEl.querySelector(".view-content").style.boxShadow = "inset 0px 20px 20px 0px rgba(248, 255, 255)";
      } else {
        leaf.containerEl.querySelector(".view-content").style.boxShadow = "inset 0px -30px 20px 0px rgba(248, 255, 255)";
      }
    }, 10);
    return;
  }
  const editor = getMarkdownView(leaf).editor;
  const backlinkContainer = getBacklinkContainer(editor);
  const windowHeight = leaf.view.containerEl.querySelector(".cm-scroller").getBoundingClientRect().height;
  const scrollTop = leaf.view.containerEl.querySelector(".cm-scroller").scrollTop;
  const scrollBottom = scrollTop + windowHeight;
  let visibleElements = [];
  for (let i = 0; i < backlinkContainer.children.length; i++) {
    let style = backlinkContainer.children[i].getAttribute("style");
    if (style == null)
      continue;
    let cssProperties = parseCSSString(style);
    let top = parseFloat(cssProperties["top"].replace("px", ""));
    if (top == null)
      continue;
    if (scrollTop <= top && top <= scrollBottom && backlinkContainer.children[i]) {
      let reference = backlinkContainer.children[i].getAttribute("reference");
      if (reference) {
        visibleElements.push(JSON.parse(reference).dataString);
      }
    }
  }
  if (!visibleElements.includes(dataString)) {
    let startTop = leaf.view.editor.getScrollInfo().top;
    leaf.view.editor.scrollIntoView(
      {
        from: Object.assign(rangeStart, { ch: 0 }),
        to: Object.assign(rangeEnd, { ch: 0 })
      },
      true
    );
    setTimeout(() => {
      let endTop = leaf.view.editor.getScrollInfo().top;
      if (startTop == endTop && isSame) {
        leaf.containerEl.querySelector(".view-content").style.boxShadow = "inset 0px 20px 20px 0px rgba(248, 255, 255, 0)";
      } else if (startTop === endTop || !isSame) {
        leaf.containerEl.querySelector(".view-content").style.boxShadow = "inset 0px 0px 10px 10px rgba(248, 255, 255)";
      } else if (startTop < endTop) {
        leaf.containerEl.querySelector(".view-content").style.boxShadow = "inset 0px 20px 20px 0px rgba(248, 255, 255)";
      } else {
        leaf.containerEl.querySelector(".view-content").style.boxShadow = "inset 0px -30px 20px 0px rgba(248, 255, 255)";
      }
    }, 10);
  }
}
async function startBacklinkEffect(span) {
  var _a, _b, _c, _d;
  let source = getBacklinkHover();
  let destination = getCursor();
  let updateState = updateBacklinkHover;
  if (source != null)
    return;
  updateState({
    type: `${ACTION_TYPE.BACKLINK}-start`
  });
  if (!span)
    return;
  let uuid = Array.from(span.classList).filter((el) => el.includes("uuid"))[0];
  (_b = (_a = span.parentElement) == null ? void 0 : _a.querySelector(".reference-span")) == null ? void 0 : _b.classList.add("reference-span-selected");
  span.classList.add("reference-data-span-selected");
  updateState({
    uuid
    // uuid2,
  });
  const referenceData = span.getAttribute("reference");
  if (!referenceData)
    throw new Error("Reference data not found");
  const backlink = JSON.parse(referenceData);
  const dataString = backlink.dataString;
  if (destination != null && destination.dataString == dataString) {
    updateState(destination);
    return;
  }
  let [prefix, text, suffix, file, from, to] = processURI(dataString);
  let leavesByTab = collectLeavesByTabHelper();
  let currTabIdx = getCurrentTabIndex(leavesByTab, span);
  let backlinkLeaf = leavesByTab[currTabIdx].filter((leaf) => {
    let containerEl = getContainerElement(leaf);
    const exists = checkSpanElementExists(span, containerEl);
    return exists;
  })[0];
  let backlinkLeafID = backlinkLeaf.id;
  if (!backlinkLeafID)
    throw new Error("Leaf id not found");
  if (backlinkLeaf && backlinkLeaf.view instanceof import_obsidian2.MarkdownView) {
    const editorView = getEditorView(backlinkLeaf);
    if (!editorView)
      throw new Error("Editor view not found");
    const viewport = backlinkLeaf.view.editor.getScrollInfo();
    highlightSelection(editorView, from, to);
    updateState({
      dataString,
      originalTop: editorView.documentTop,
      backlinkLeafId: backlinkLeafID
    });
  }
  let referencingFile = backlink.referencingLocation.filename;
  const { newLeaf, temp, originalLeaf } = await openFileInAdjacentTab(
    leavesByTab,
    currTabIdx,
    referencingFile
  );
  let id = newLeaf.id;
  if (!id)
    throw new Error("Leaf id not found");
  updateState({
    leafId: id,
    temp,
    peek: true
  });
  const originalLeafId = originalLeaf.id;
  const matches = [
    ...backlink.referencingLocation.text.matchAll(REFERENCE_REGEX)
  ];
  if (matches.length == 0)
    throw new Error("Matches not found");
  tempDirectionIndicator(
    newLeaf,
    backlink.referencingLocation.text,
    backlink.referencingLocation.prefix + "-",
    "-" + backlink.referencingLocation.suffix,
    matches[0][1],
    id === originalLeafId,
    ACTION_TYPE.BACKLINK
  );
  const cursorViewport = newLeaf.view.editor.getScrollInfo();
  updateState({
    cursorViewport
  });
  let backlinkSpan = newLeaf.containerEl.querySelector(
    `span[data="${backlink.dataString}"]`
  );
  if (backlinkSpan) {
    let backlinkUUID = Array.from(backlinkSpan.classList).filter(
      (el) => el.includes("uuid")
    )[0];
    (_d = (_c = backlinkSpan.parentElement) == null ? void 0 : _c.querySelector(".reference-span")) == null ? void 0 : _d.classList.add("reference-span-selected");
    backlinkSpan.classList.add("reference-data-span-selected");
    updateState({
      backlinkUUID
      // backlinkUUID2,
    });
  }
  if (id === originalLeafId) {
    newLeaf.containerEl.querySelector(".view-content").style.boxShadow = "none";
  }
  if (originalLeafId) {
    updateState({
      originalLeafId
    });
  }
  return;
}
async function startReferenceEffect(span, type) {
  var _a, _b;
  let source = type == ACTION_TYPE.MOUSE ? getHover() : getCursor();
  let destination = type == ACTION_TYPE.MOUSE ? getCursor() : getHover();
  let updateState = type == ACTION_TYPE.MOUSE ? updateHover : updateCursor;
  if (source != null) {
    if (ACTION_TYPE.CURSOR == type) {
      await endReferenceCursorEffect();
    } else {
      return;
    }
  }
  updateState({
    type: `${type}-start`
  });
  if (!span)
    return;
  let uuid = Array.from(span.classList).filter((el) => el.includes("uuid"))[0];
  (_b = (_a = span.parentElement) == null ? void 0 : _a.querySelector(".reference-span")) == null ? void 0 : _b.classList.add("reference-span-selected");
  span.classList.add("reference-data-span-selected");
  updateState({
    uuid
    // uuid2,
  });
  const dataString = span.getAttribute("data");
  if (!dataString)
    throw new Error("Data string not found");
  if (destination != null && destination.dataString == dataString && ACTION_TYPE.CURSOR != type) {
    updateHover(destination);
    return;
  }
  let [prefix, text, suffix, file, from, to] = processURI(dataString);
  let leavesByTab = collectLeavesByTabHelper();
  let currTabIdx = getCurrentTabIndex(leavesByTab, span);
  let currLeaf = getThat().workspace.getLeaf();
  let currLeafID = currLeaf.id;
  if (!currLeafID)
    throw new Error("currLeafID id not found");
  const { newLeaf, temp, originalLeaf } = await openFileInAdjacentTab(
    leavesByTab,
    currTabIdx,
    file,
    type
  );
  let id = newLeaf.id;
  if (!id)
    throw new Error("Leaf id not found");
  updateState({
    leafId: id,
    temp,
    peek: true
  });
  const originalLeafId = originalLeaf.id;
  if (newLeaf && newLeaf.view instanceof import_obsidian2.MarkdownView) {
    const editorView = getEditorView(newLeaf);
    if (!editorView)
      throw new Error("Editor view not found");
    const viewport = newLeaf.view.editor.getScrollInfo();
    highlightSelection(editorView, from, to);
    tempDirectionIndicator(
      newLeaf,
      text,
      prefix,
      suffix,
      dataString,
      id === originalLeafId
    );
    const cursorViewport = newLeaf.view.editor.getScrollInfo();
    updateState({
      dataString,
      originalTop: editorView.documentTop,
      // originalLeafId: currLeafID,
      cursorViewport
    });
  }
  if (id != originalLeafId && (newLeaf.containerEl.querySelector(".view-content").style.boxShadow == "none" || newLeaf.containerEl.querySelector(".view-content").style.boxShadow == "")) {
    newLeaf.containerEl.querySelector(".view-content").style.boxShadow = "inset 0px 0px 10px 10px rgba(248, 255, 255)";
  }
  if (originalLeafId) {
    updateState({
      originalLeafId
    });
  }
}
async function endReferenceCursorEffect() {
  var _a, _b, _c, _d;
  if (!getCursor() || Object.keys(getCursor()).length == 0) {
    resetCursor();
    return;
  }
  const {
    dataString,
    leafId,
    originalLeafId,
    temp,
    cursorViewport,
    peek,
    uuid
  } = getCursor();
  resetCursor();
  if (getHover() != null && getHover().dataString == dataString) {
    resetCursor();
    return;
  }
  const { workspace } = getThat();
  const workspaceContainer = workspace.containerEl;
  const span = workspaceContainer.querySelector("." + uuid);
  (_b = (_a = span == null ? void 0 : span.parentElement) == null ? void 0 : _a.querySelector(".reference-span")) == null ? void 0 : _b.classList.remove("reference-span-selected");
  span == null ? void 0 : span.classList.remove("reference-data-span-selected");
  let targetLeaf = workspace.getLeafById(leafId);
  if (!targetLeaf) {
    resetCursor();
    throw new Error("Target leaf not found");
  }
  const activeLeaf = getThat().workspace.getLeaf();
  const activeLeafId = activeLeaf.id;
  let editorView = getEditorView(targetLeaf);
  removeHighlights(editorView);
  if (activeLeafId === leafId) {
    resetCursor();
    let containerEl = getContainerElement(targetLeaf);
    if (containerEl != null) {
      (_c = containerEl.querySelector(".view-content")) == null ? void 0 : _c.setAttribute("style", "");
    }
    return;
  }
  if (cursorViewport && targetLeaf && targetLeaf.view instanceof import_obsidian2.MarkdownView) {
    const view = targetLeaf.view;
    view.editor.scrollTo(0, cursorViewport.top);
    if (getHover() != null) {
      const { dataString: dataString2, cursorViewport: cursorViewport2, leafId: leafId2, originalLeafId: originalLeafId2 } = getHover();
      let [prefix, text, suffix, file, from, to] = processURI(dataString2);
      const cursorLeaf = workspace.getLeafById(leafId2);
      workspace.revealLeaf(cursorLeaf);
      const editorView2 = getEditorView(cursorLeaf);
      highlightSelection(editorView2, from, to);
    } else {
      let containerEl = getContainerElement(targetLeaf);
      if (containerEl != null) {
        (_d = containerEl.querySelector(".view-content")) == null ? void 0 : _d.setAttribute("style", "");
      }
    }
  }
  if (temp && targetLeaf) {
    targetLeaf.detach();
  }
  if (peek) {
    let originalLeaf = workspace.getLeafById(originalLeafId);
    if (!originalLeaf)
      throw new Error("Original leaf not found");
    workspace.revealLeaf(originalLeaf);
  }
  resetCursor();
}
async function endReferenceHoverEffect() {
  var _a, _b;
  if (!getHover() || Object.keys(getHover()).length == 0) {
    resetHover();
    return;
  }
  let { dataString, leafId, originalLeafId, temp, cursorViewport, peek, uuid } = getHover();
  resetHover();
  if (getCursor() != null && getCursor().dataString == dataString) {
    resetHover();
    return;
  }
  const { workspace } = getThat();
  let targetLeaf = workspace.getLeafById(leafId);
  if (!targetLeaf) {
    resetHover();
    throw new Error("Target leaf not found");
  }
  const workspaceContainer = workspace.containerEl;
  const span = workspaceContainer.querySelector("." + uuid);
  (_b = (_a = span == null ? void 0 : span.parentElement) == null ? void 0 : _a.querySelector(".reference-span")) == null ? void 0 : _b.classList.remove("reference-span-selected");
  span == null ? void 0 : span.classList.remove("reference-data-span-selected");
  const activeLeaf = getThat().workspace.getLeaf();
  let editorView = getEditorView(targetLeaf);
  removeHighlights(editorView);
  if (cursorViewport && targetLeaf && targetLeaf.view instanceof import_obsidian2.MarkdownView) {
    const view = targetLeaf.view;
    view.editor.scrollTo(0, cursorViewport.top);
    if (getCursor() != null && getCursor().dataString) {
      const { dataString: dataString2, cursorViewport: cursorViewport2, leafId: leafId2, originalLeafId: originalLeafId2 } = getCursor();
      let [prefix, text, suffix, file, from, to, portal, toggle] = processURI(dataString2);
      const cursorLeaf = workspace.getLeafById(leafId2);
      workspace.revealLeaf(cursorLeaf);
      const editorView2 = getEditorView(cursorLeaf);
      if (!editorView2)
        throw new Error("Editor view not found");
      highlightSelection(editorView2, from, to);
    } else {
      let containerEl = getContainerElement(targetLeaf);
      if (containerEl != null) {
        setTimeout(() => {
          var _a2;
          (_a2 = containerEl.querySelector(".view-content")) == null ? void 0 : _a2.setAttribute("style", "");
        }, 50);
      }
    }
  }
  if (temp && targetLeaf) {
    targetLeaf.detach();
    let originalLeaf = workspace.getLeafById(originalLeafId);
    if (!originalLeaf)
      throw new Error("Original leaf not found");
    workspace.revealLeaf(originalLeaf);
  }
  if (peek) {
    let originalLeaf = workspace.getLeafById(originalLeafId);
    if (!originalLeaf) {
      resetHover();
      throw new Error("Original leaf not found");
    }
    workspace.revealLeaf(originalLeaf);
  }
  resetHover();
}
async function endBacklinkHoverEffect() {
  var _a, _b, _c, _d;
  if (!getBacklinkHover() || Object.keys(getBacklinkHover()).length == 0) {
    resetBacklinkHover();
    return;
  }
  const {
    dataString,
    leafId,
    originalLeafId,
    backlinkLeafId,
    temp,
    cursorViewport,
    peek,
    uuid,
    backlinkUUID
  } = getBacklinkHover();
  resetBacklinkHover();
  if (getCursor() != null && getCursor().dataString == dataString) {
    resetBacklinkHover();
    return;
  }
  const { workspace } = getThat();
  let targetLeaf = workspace.getLeafById(leafId);
  if (!targetLeaf) {
    resetBacklinkHover();
    throw new Error("Target leaf not found");
  }
  const workspaceContainer = workspace.containerEl;
  const span = workspaceContainer.querySelector("." + uuid);
  (_b = (_a = span == null ? void 0 : span.parentElement) == null ? void 0 : _a.querySelector(".reference-span")) == null ? void 0 : _b.classList.remove("reference-span-selected");
  span == null ? void 0 : span.classList.remove("reference-data-span-selected");
  const backlinkSpan = workspaceContainer.querySelector("." + backlinkUUID);
  (_d = (_c = backlinkSpan == null ? void 0 : backlinkSpan.parentElement) == null ? void 0 : _c.querySelector(".reference-span")) == null ? void 0 : _d.classList.remove("reference-span-selected");
  backlinkSpan == null ? void 0 : backlinkSpan.classList.remove("reference-data-span-selected");
  if (cursorViewport && targetLeaf && targetLeaf.view instanceof import_obsidian2.MarkdownView) {
    const view = targetLeaf.view;
    view.editor.scrollTo(0, cursorViewport.top);
  }
  let containerEl = getContainerElement(targetLeaf);
  if (containerEl != null) {
    setTimeout(() => {
      var _a2;
      (_a2 = containerEl.querySelector(".view-content")) == null ? void 0 : _a2.setAttribute("style", "");
    }, 50);
  }
  let editorView = getEditorView(targetLeaf);
  removeHighlights(editorView);
  const originalLeaf = workspace.getLeafById(backlinkLeafId);
  if (!originalLeaf) {
    resetBacklinkHover();
    throw new Error("Original leaf not found");
  }
  let originalEditorView = getEditorView(originalLeaf);
  removeHighlights(originalEditorView);
  if (getCursor() != null && getCursor().dataString) {
    const { dataString: dataString2, cursorViewport: cursorViewport2, leafId: leafId2, originalLeafId: originalLeafId2 } = getCursor();
    let [prefix, text, suffix, file, from, to] = processURI(dataString2);
    const cursorLeaf = workspace.getLeafById(leafId2);
    workspace.revealLeaf(cursorLeaf);
    const editorView2 = getEditorView(cursorLeaf);
    highlightSelection(editorView2, from, to);
  }
  if (temp && targetLeaf) {
    targetLeaf.detach();
  }
  if (peek) {
    let originalLeaf2 = workspace.getLeafById(originalLeafId);
    if (!originalLeaf2) {
      resetBacklinkHover();
      throw new Error("Original leaf not found");
    }
    workspace.revealLeaf(originalLeaf2);
  }
  resetBacklinkHover();
}

// src/utils.ts
function encodeURIComponentString(str) {
  return encodeURIComponent(str).replace(/[:()]/g, function(c) {
    return "%" + c.charCodeAt(0).toString(16);
  });
}
function decodeURIComponentString(str) {
  return decodeURIComponent(
    str.replace(/%3A/g, ":").replace(/%28/g, "(").replace(/%29/g, ")")
  );
}
function processURI(dataString) {
  let [prefix, text, suffix, file, from, to, portal, toggle] = dataString.split(":");
  prefix = decodeURIComponentString(prefix);
  text = decodeURIComponentString(text);
  suffix = decodeURIComponentString(suffix);
  file = decodeURIComponentString(file);
  from = decodeURIComponentString(from);
  to = decodeURIComponentString(to);
  if (portal)
    portal = decodeURIComponentString(portal);
  toggle = decodeURIComponentString(toggle);
  return [
    prefix,
    text,
    suffix,
    file,
    parseInt(from),
    parseInt(to),
    portal,
    toggle
  ];
}
function getPrefixAndSuffix(document2, from, to) {
  let prefix = document2.slice(from - 25, from).split("\n").slice(-1)[0];
  let suffix = document2.slice(to, to + 25).split("\n")[0];
  return { prefix, suffix };
}
function findTextPositions(text, searchTerm, prefix = "", suffix = "") {
  let rollingIndex = 0;
  const lines = text.split("\n").map((line, i) => {
    let data = { line, index: rollingIndex, length: line.length + 1, i };
    rollingIndex += data.length;
    return data;
  });
  if (text.includes(prefix + searchTerm + suffix)) {
    let matchIndex = text.indexOf(prefix + searchTerm + suffix);
    let startIndex = lines.findIndex((line) => line.index > matchIndex + prefix.length) - 1;
    let endIndex = lines.findIndex(
      (line) => line.index > matchIndex + prefix.length + searchTerm.length
    ) - 1;
    if (startIndex == -2)
      startIndex = lines.length - 1;
    if (endIndex == -2)
      endIndex = lines.length - 1;
    return {
      rangeStart: {
        line: startIndex,
        ch: matchIndex + prefix.length - lines[startIndex].index
      },
      rangeEnd: {
        line: endIndex,
        ch: matchIndex + prefix.length + searchTerm.length - lines[endIndex].index
      },
      lines
    };
  }
  return null;
}
function checkCursorPositionAtDatastring(evt) {
  const activeView = this.app.workspace.getActiveViewOfType(import_obsidian3.MarkdownView);
  const cursorFrom = activeView == null ? void 0 : activeView.editor.getCursor("from");
  const cursorTo = activeView == null ? void 0 : activeView.editor.getCursor("to");
  let matched = false;
  let matchSpan = void 0;
  if (cursorFrom && cursorTo && cursorFrom.ch == cursorTo.ch && cursorFrom.line == cursorTo.line) {
    const lineText = activeView == null ? void 0 : activeView.editor.getLine(cursorFrom.line);
    if (lineText) {
      const matches = [...lineText.matchAll(REFERENCE_REGEX)];
      matches.forEach((match) => {
        var _a;
        if ((_a = match.index) == null ? void 0 : _a.toString()) {
          const start = match.index;
          const end = start + match[0].length;
          if (end == cursorTo.ch && evt.target) {
            const dataString = match[1];
            let checkContainer = evt.target instanceof Element;
            if (!checkContainer)
              throw new Error("Element not instance of Element");
            let container = evt.target;
            let span = container;
            if (!span.getAttribute("data"))
              span = container.querySelector(
                `span[data="${dataString}"]`
              );
            if (span && span instanceof HTMLSpanElement) {
              matched = true;
              matchSpan = span;
            } else {
            }
          }
        }
      });
    }
  }
  return { matched, span: matchSpan };
}
function handleRemoveHoveredCursor(user) {
  if (getHoveredCursor()) {
    let nonCursors = getHoveredCursor().filter((element) => {
      return element.user !== user;
    }).map((element) => element.cursor.closest("span"));
    getHoveredCursor().filter((element) => element.user === user).forEach((element) => {
      if (!nonCursors.includes(element.cursor.closest("span"))) {
        let svg = element.cursor;
        if (!svg)
          throw new Error("SVG not found");
        if (svg.classList.contains("reference-icon"))
          svg.style.backgroundColor = "white";
        else {
          svg.setAttribute("fill", "white");
          svg.style.backgroundColor = "";
        }
        element.cursor.style.backgroundColor = "white";
      }
    });
    removeHoveredCursor(user);
  }
}
async function checkFocusCursor(evt) {
  let { matched, span } = checkCursorPositionAtDatastring(evt);
  console.log(matched);
  console.log(span);
  if (matched && span) {
    await endReferenceCursorEffect();
    handleRemoveHoveredCursor(ACTION_TYPE.CURSOR);
    updateHoveredCursorColor(span, ACTION_TYPE.CURSOR);
    await startReferenceEffect(span, ACTION_TYPE.CURSOR);
  } else {
    await endReferenceCursorEffect();
    handleRemoveHoveredCursor(ACTION_TYPE.CURSOR);
  }
}

// src/references.ts
function createReferenceIcon(portalText = null) {
  const span = document.createElement("span");
  span.style.cursor = "pointer";
  span.classList.add("reference-data-span");
  span.classList.add("uuid-" + v4_default());
  const height = REFERENCE_ICON_HEIGHT;
  const width = height * 0.9;
  if (portalText == null) {
    const svg2 = document.createElementNS("http://www.w3.org/2000/svg", "svg");
    return { span, svg: svg2 };
  }
  const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
  if (portalText != "inline reference widget |*|") {
    let portal = document.createElement("div");
    portal.classList.add("portal");
    portalText.split(":").forEach((text, index) => {
      if (index === 0 || index === 2)
        portal.innerHTML += decodeURIComponentString(text);
      else if (index === 1) {
        portal.innerHTML += `<span class="text-accent";>${text}</span>`;
      }
    });
    portal.style.userSelect = "none";
    portal.style.pointerEvents = "none";
    span.appendChild(portal);
  }
  return { span, svg };
}
function updateHoveredCursorColor(span, user) {
  const svg = span.querySelector("svg");
  const portal = span.querySelector(".portal");
  if (span && svg && !portal) {
    handleRemoveHoveredCursor(user);
    if (svg.classList.contains("reference-icon"))
      svg.style.backgroundColor = SVG_HOVER_COLOR;
    else {
      span = span.querySelector("span");
      span.style.backgroundColor = SVG_HOVER_COLOR;
    }
    updateHoveredCursor(svg, user);
  }
}
function getCodeMirrorEditorView(editor) {
  return editor.cm;
}
function getContainerElement(editorOrLeaf) {
  return editorOrLeaf.containerEl;
}
function getBacklinkID(backlink) {
  const jsonString = JSON.stringify(backlink);
  const id = v5_default(jsonString, "fb813ebb-1b53-4306-aa9c-655627447f0b");
  return `backlink-${id}`;
}
function getBacklinkContainer(editor) {
  const containerEl = getContainerElement(editor);
  const referenceMarkContainerID = "referenceMarkContainer";
  const container = containerEl.querySelector(`#${referenceMarkContainerID}`);
  if (container) {
    return container;
  } else {
    const newContainer = document.createElement("div");
    newContainer.id = referenceMarkContainerID;
    containerEl.querySelector(".cm-scroller").appendChild(newContainer);
    return newContainer;
  }
}
function getLeafBBoxElements(leaf) {
  const title = getContainerElement(leaf).querySelector(".inline-title");
  if (!title) {
    throw new Error("Missing title");
  }
  const titleBbox = title.getBoundingClientRect();
  const line = getContainerElement(leaf).querySelector(".cm-line");
  if (!line) {
    throw new Error("Document has no lines");
  }
  const lineBbox = line.getBoundingClientRect();
  return { titleBbox, lineBbox };
}
function updateBacklinkMarkPosition(leaf, backlinksToLeaf, showPortals) {
  const editor = getMarkdownView(leaf).editor;
  const backlinkContainer = getBacklinkContainer(editor);
  let backlinks2 = [];
  for (let i = 0; i < backlinkContainer.children.length; i++) {
    backlinks2.push(backlinkContainer.children.item(i));
  }
  let backlinkIds = backlinksToLeaf.map((x) => getBacklinkID(x));
  backlinks2.map((x) => x.id).forEach((id) => {
    if (!backlinkIds.includes(id)) {
      let element = document.getElementById(id);
      if (element)
        element.remove();
    }
  });
  const { titleBbox, lineBbox } = getLeafBBoxElements(leaf);
  let referenceMarkers = backlinksToLeaf.map((backlink) => {
    const { from } = backlink.referencedLocation;
    const bbox = getCodeMirrorEditorView(editor).coordsAtPos(from);
    if (!bbox)
      return;
    let referenceMarker = backlinkContainer.querySelector(
      `#${getBacklinkID(backlink)}`
    );
    if (referenceMarker === null) {
      referenceMarker = createBacklinkMark(backlink);
      backlinkContainer.appendChild(referenceMarker);
    }
    if (bbox) {
      referenceMarker.style.position = "absolute";
      referenceMarker.setAttribute("top", bbox.top.toString());
      referenceMarker.style.top = bbox.top - titleBbox.top + 32 + "px";
      referenceMarker.style.left = lineBbox.width + 40 + "px";
    }
    return referenceMarker;
  });
  let lastYBottom = -Infinity;
  let margin = 4;
  referenceMarkers.sort(
    (a, b) => parseInt(a.getAttribute("top")) - parseInt(b.getAttribute("top"))
  ).forEach((marker) => {
    if (!marker)
      return;
    const portal = marker.querySelector(".portal");
    const svg = marker.querySelector("svg");
    if (showPortals) {
      if (portal) {
        portal.style.display = "inline";
        marker.classList.add("backlink-span");
      }
    } else {
      if (portal) {
        portal.style.display = "none";
      }
      marker.classList.remove("backlink-span");
    }
    let top = parseInt(marker.getAttribute("top"));
    top = Math.max(top, lastYBottom + margin);
    lastYBottom = top + marker.getBoundingClientRect().height + margin;
    marker.setAttribute("top", top.toString());
    marker.style.top = top - titleBbox.top + 32 + "px";
    marker.style.left = lineBbox.width + 40 + "px";
  });
}
var debounceTimer;
async function updateBacklinkMarkPositions() {
  clearTimeout(debounceTimer);
  debounceTimer = setTimeout(() => {
    const leaves = getThat().workspace.getLeavesOfType(
      "markdown"
    );
    setTimeout(async () => {
      const allBacklinks = await recomputeReferencesForPage();
      leaves.forEach((leaf) => {
        const backlinksToLeaf = allBacklinks.filter(
          // @ts-ignore
          (b) => b.referencedLocation.filename == leaf.view.file.path
        );
        const showPortals = getContainerElement(leaf).innerWidth > 900;
        updateBacklinkMarkPosition(leaf, backlinksToLeaf, showPortals);
      });
    }, 500);
  }, 100);
}
function createBacklinkMark(backlink) {
  let { span, svg } = createReferenceIcon(backlink.portalText);
  span.classList.add("backlink-data-span");
  const portal = span.querySelector(".portal");
  span.style.position = "absolute";
  span.id = getBacklinkID(backlink);
  span.setAttribute("reference", JSON.stringify(backlink));
  const resizeObserver = new ResizeObserver((entries) => {
    if (portal && portal.style.display != "none") {
      span.classList.add("backlink-portal-open");
    } else {
      span.classList.remove("backlink-portal-open");
    }
  });
  resizeObserver.observe(span);
  span.addEventListener("click", openBacklinkReference);
  return span;
}
async function addReferencesToLeaf(leaf) {
  const markdownView = getMarkdownView(leaf);
  let workspaceTabs = markdownView.containerEl.closest(".workspace-tabs");
  if (!workspaceTabs) {
    throw new Error("Missing workspace tabs");
  }
  await updateBacklinkMarkPositions();
  getContainerElement(markdownView.editor).querySelector(".cm-scroller").addEventListener("scroll", async () => {
    await updateBacklinkMarkPositions();
  });
  let resizeObserver = new ResizeObserver(async () => {
    await updateBacklinkMarkPositions();
  });
  resizeObserver.observe(workspaceTabs);
}
function getMarkdownView(leaf) {
  if (!(leaf.view instanceof import_obsidian4.MarkdownView)) {
    throw new Error("Unexpected non-markdown view");
  }
  return leaf.view;
}
function findMatchPositions(line, regex) {
  let match;
  const positions = [];
  while ((match = regex.exec(line)) !== null) {
    positions.push({
      match: match[0],
      start: match.index,
      end: match.index + match[0].length
    });
  }
  return positions;
}
function createBacklinkData(referencingFileData, referencingFile) {
  let backlinks2 = [];
  let matches = [...referencingFileData.matchAll(REFERENCE_REGEX)];
  matches.forEach((match) => {
    if (match[1].split(":").length != 8)
      return;
    let [prefix, text, suffix, filename, from, to, portal, toggle] = processURI(
      match[1]
    );
    const referencedLocation = {
      prefix,
      text,
      suffix,
      filename,
      from,
      to,
      portal,
      toggle
    };
    let index = referencingFileData.indexOf(match[0]);
    const referencingSurroundingStrings = getPrefixAndSuffix(
      referencingFileData,
      index,
      index + match[0].length
    );
    const referencingLocation = {
      // prefix: referencingFileData.slice(index - 25, index),
      prefix: referencingSurroundingStrings.prefix,
      text: referencingFileData.slice(index, index + match[0].length),
      // suffix: referencingFileData.slice(
      // 	index + match[0].length,
      // 	index + match[0].length + 25
      // ),
      suffix: referencingSurroundingStrings.suffix,
      filename: referencingFile.path,
      from: match.index,
      // TODO do weird string format
      to: match.index + match[0].length,
      // TODO do weird string format
      portal,
      toggle
    };
    if (portal == "portal") {
      const getLineText = (text2, index2) => {
        const startOfLine = text2.lastIndexOf("\n", index2 - 1) + 1;
        const endOfLine = text2.indexOf("\n", index2);
        return text2.slice(
          startOfLine,
          endOfLine !== -1 ? endOfLine : void 0
        );
      };
      let line = getLineText(referencingFileData, index);
      let matchPositions = findMatchPositions(
        line,
        new RegExp(REFERENCE_REGEX)
      );
      let matchIndex = 0;
      for (let i = 0; i < matchPositions.length; i++) {
        if (matchPositions[i].match == match[0]) {
          break;
        } else {
          matchIndex += matchPositions[i].end - matchPositions[i].start - 1;
        }
      }
      let portalText = line.replace(new RegExp(REFERENCE_REGEX, "g"), "\u2197");
      let portalTextSlice = portalText.slice(0, PORTAL_TEXT_SLICE_SIZE);
      let portalTextIndex = line.indexOf(match[0]) - matchIndex;
      portalTextSlice = "\u2197";
      let startPortalText = portalText.substring(
        Math.max(portalTextIndex - 25, 0),
        portalTextIndex
      );
      if (portalText.substring(Math.max(portalTextIndex - 25, 0), portalTextIndex).length > 0 && portalTextIndex - 25 > 0)
        startPortalText = "..." + startPortalText;
      let endPortalText = portalText.substring(
        portalTextIndex + 1,
        Math.max(portalTextIndex + 25, portalText.length)
      );
      if (portalText.substring(
        portalTextIndex + 1,
        Math.max(portalTextIndex + 25, portalText.length)
      ).length > 0 && portalTextIndex + 25 < portalText.length)
        endPortalText = endPortalText + "...";
      backlinks2.push({
        referencedLocation,
        referencingLocation,
        dataString: match[1],
        portalText: encodeURIComponentString(startPortalText) + ":" + portalTextSlice + ":" + encodeURIComponentString(endPortalText)
      });
    } else {
      backlinks2.push({
        referencedLocation,
        referencingLocation,
        dataString: match[1]
      });
    }
  });
  return backlinks2;
}
function generateBacklinks() {
  console.log("generating references");
  let backlinks2 = [];
  let markdownFiles = this.app.vault.getMarkdownFiles();
  Promise.all(
    markdownFiles.map((file) => this.app.vault.read(file))
  ).then((files) => {
    const zippedArray = markdownFiles.map((file, index) => ({
      markdownFile: file,
      fileData: files[index]
    }));
    zippedArray.forEach((file) => {
      let fileBacklinks = createBacklinkData(file.fileData, file.markdownFile);
      updateBacklinks(fileBacklinks);
      backlinks2.push(...fileBacklinks);
    });
    const leaves = this.app.workspace.getLeavesOfType("markdown");
    leaves.forEach(async (leaf) => {
      await addReferencesToLeaf(leaf);
    });
  });
}
async function recomputeReferencesForPage() {
  let references = [];
  let markdownFiles = this.app.vault.getMarkdownFiles();
  let promises = markdownFiles.map((file) => this.app.vault.read(file));
  let files = await Promise.all(promises);
  const zippedArray = markdownFiles.map((file, index) => ({
    markdownFile: file,
    fileData: files[index]
  }));
  zippedArray.forEach((file) => {
    let fileBacklinks = createBacklinkData(file.fileData, file.markdownFile);
    updateBacklinks(fileBacklinks);
    references.push(...fileBacklinks);
  });
  return references;
}
async function openBacklinkReference(ev) {
  let cursor = getCursor();
  let hover = getBacklinkHover();
  let leaf = getThat().workspace.getLeafById(hover.leafId);
  let container = leaf.containerEl;
  if (!container)
    throw new Error("Container not found");
  container.querySelector(".view-content").style.boxShadow = "none";
  if (cursor && hover && cursor.dataString && hover.dataString && cursor.dataString == hover.dataString) {
    updateCursor({
      temp: false,
      cursorViewport: null,
      peek: false
    });
  }
  updateBacklinkHover({
    temp: false,
    cursorViewport: null,
    peek: false
  });
  handleRemoveHoveredCursor(ACTION_TYPE.CURSOR);
  resetCursor();
}
async function openReference(ev) {
  let cursor = getCursor();
  let hover = getHover();
  let leaf = getThat().workspace.getLeafById(hover.leafId);
  let container = leaf.containerEl;
  if (!container)
    throw new Error("Container not found");
  container.querySelector(".view-content").style.boxShadow = "none";
  if (cursor && hover && cursor.dataString && hover.dataString && cursor.dataString == hover.dataString) {
    updateCursor({
      temp: false,
      cursorViewport: null,
      peek: false
    });
  }
  updateHover({
    temp: false,
    cursorViewport: null,
    peek: false
  });
  handleRemoveHoveredCursor(ACTION_TYPE.CURSOR);
  resetCursor();
}

// src/widget/referenceWidget.ts
function processLine(line) {
  let lineCopy = line == null ? void 0 : line.cloneNode(true);
  lineCopy == null ? void 0 : lineCopy.querySelectorAll(".reference-span").forEach((span) => {
    span.innerHTML = "\u2197";
  });
  return lineCopy;
}
async function serializeReference(content, referenceSpan, view) {
  const [prefix, text, suffix, file, from, to, portal, toggle = "f"] = content[1].split(":");
  referenceSpan.classList.toggle("reference-span-hidden");
  let newToggle = referenceSpan.classList.contains("reference-span-hidden") ? "f" : "t";
  let reference = `[\u2197](urn:${prefix}:${text}:${suffix}:${file}:${from}:${to}:${portal}:${newToggle})`;
  let lines = view.contentDOM.querySelectorAll(".cm-line");
  let activeLineIndex;
  let seenActive = false;
  lines.forEach((line, i) => {
    if (seenActive)
      return;
    if (line.classList.contains("cm-active")) {
      seenActive = true;
      activeLineIndex = i;
    }
  });
  if (activeLineIndex === void 0)
    return;
  let activeLine = lines[activeLineIndex];
  let activeLineCopy = processLine(activeLine);
  let parts = activeLineCopy.innerText.split("\u2197");
  let lineReferences = activeLine == null ? void 0 : activeLine.querySelectorAll(".reference-data-span");
  let lineReferencesData = Array.from(lineReferences || []).map(
    (span) => "[\u2197](urn:" + span.getAttribute("data") + ")"
  );
  if (content && content[1]) {
    let index = lineReferencesData.indexOf(content[0]);
    if (index == -1)
      throw new Error("Reference not found");
    let startText = [
      ...parts.slice(0, index + 1),
      ...lineReferencesData.slice(0, index)
    ];
    let prevLineCharCount = Array.from(lines).slice(0, activeLineIndex).reduce((acc, line) => {
      let processedLine = processLine(line);
      let parts2 = processedLine.innerText.split("\u2197");
      let lineReferences2 = line == null ? void 0 : line.querySelectorAll(".reference-data-span");
      let lineReferencesData2 = Array.from(lineReferences2 || []).map(
        (span) => "[\u2197](urn:" + span.getAttribute("data") + ")"
      );
      let allSerializedText = [...parts2, ...lineReferencesData2].join("") + "\n";
      return allSerializedText.length + acc;
    }, 0);
    let from2 = prevLineCharCount + startText.join("").length;
    let to2 = from2 + reference.length;
    const transaction = view.state.update({
      changes: { from: from2, to: to2, insert: content[0] }
    });
    view.dispatch(transaction);
    await updateBacklinkMarkPositions();
  }
}
var ReferenceWidget = class extends import_view4.WidgetType {
  constructor(name, view, pos) {
    super();
    this.name = name;
    this.view = view;
    this.pos = pos;
  }
  eq(other) {
    return this.name === other.name;
  }
  async updateName(name, from, to) {
    this.name = name;
  }
  getView() {
    return this.view;
  }
  toDOM() {
    const regex = /\[↗\]\(urn:([^)]*)\)/g;
    let content = regex.exec(this.name);
    if (!content)
      throw new Error("Invalid reference");
    const [prefix, text, suffix, file, from, to, portal, toggle = "f"] = content[1].split(":");
    const { span, svg } = createReferenceIcon(
      portal == "portal" ? "inline reference widget |*|" : null
    );
    if (content)
      span.setAttribute("data", content[1]);
    const containerSpan = document.createElement("span");
    containerSpan.classList.add("reference-container-span");
    const referenceSpan = document.createElement("span");
    referenceSpan.classList.add("reference-span");
    referenceSpan.innerHTML = decodeURIComponentString(text);
    referenceSpan.classList.toggle("reference-span-hidden", toggle === "f");
    containerSpan.appendChild(referenceSpan);
    containerSpan.appendChild(span);
    containerSpan.addEventListener("click", async (ev) => {
      if (ev.metaKey || ev.ctrlKey) {
        await serializeReference(content, referenceSpan, this.view);
        if (content)
          this.name = content[0];
      } else {
        openReference(ev);
      }
    });
    return containerSpan;
  }
};
var referenceDecoration = (match, view, pos) => {
  let decoration = import_view4.Decoration.replace({
    widget: new ReferenceWidget(match[0], view, pos)
  });
  return decoration;
};
var referenceMatcher = new import_view4.MatchDecorator({
  // regexp: /\[\u2197\]\(urn:[\s\S^\)]*\)/g,
  // regexp: /\[\u2197\]\(urn:([^:]*:){5,6}[^:]*\)/g,
  // regexp: /\[\u2197\]\(urn:([^:]*:){6}[^:)]*\)/g,
  regexp: /\[\u2197\]\(urn:([^:]*:){7}[^:)]*\)/g,
  decoration: (match, view, pos) => {
    return referenceDecoration(match, view, pos);
  }
});
var referenceResources = import_view4.ViewPlugin.fromClass(
  class {
    constructor(view) {
      this.referenceResources = referenceMatcher.createDeco(view);
    }
    update(update) {
      this.referenceResources = referenceMatcher.updateDeco(
        update,
        this.referenceResources
      );
    }
    destroy() {
      this.referenceResources = import_view4.Decoration.none;
    }
  },
  {
    decorations: (instance) => instance.referenceResources,
    provide: (plugin) => import_view4.EditorView.atomicRanges.of((view) => {
      var _a;
      return ((_a = view.plugin(plugin)) == null ? void 0 : _a.referenceResources) || import_view4.Decoration.none;
    })
  }
);

// src/clipboard.ts
var import_obsidian5 = require("obsidian");
async function updateClipboard(toggle = false, only = false) {
  const view = this.app.workspace.getActiveViewOfType(import_obsidian5.MarkdownView);
  if (view) {
    let selection = view.editor.getSelection();
    if (view.file) {
      const text = view.data;
      const from = view.editor.posToOffset(view.editor.getCursor("from"));
      const to = view.editor.posToOffset(view.editor.getCursor("to"));
      const { prefix, suffix } = getPrefixAndSuffix(text, from, to);
      let reference = `[\u2197](urn:${encodeURIComponentString(
        prefix
      )}-:${encodeURIComponentString(selection)}:-${encodeURIComponentString(
        suffix
      )}:${encodeURIComponentString(view.file.path)}:${from}:${to}:${// only ? "portal" : "no-portal"
      "portal"}:${toggle ? "t" : "f"})`;
      await navigator.clipboard.writeText(reference);
    }
  }
}

// src/main.ts
var import_view5 = require("@codemirror/view");
var ReferencePlugin = class extends import_obsidian6.Plugin {
  onload() {
    setTimeout(() => {
      generateBacklinks();
      this.registerEvent(
        this.app.workspace.on("active-leaf-change", async (ev) => {
          try {
            const activeView = this.app.workspace.getActiveViewOfType(import_obsidian6.MarkdownView);
            if ((activeView == null ? void 0 : activeView.leaf) != null) {
              await addReferencesToLeaf(activeView.leaf);
            }
          } catch (e) {
            console.log(e);
          }
        })
      );
    }, 4e3);
    updateThat(this);
    this.registerEditorExtension([
      highlights,
      referenceResources,
      import_view5.EditorView.updateListener.of(function(e) {
        if (Math.abs(e.changes.desc.newLength - e.changes.desc.length) > 1) {
          updateBacklinkMarkPositions();
        }
      })
    ]);
    this.registerDomEvent(document, "mousemove", async (evt) => {
      if (evt.metaKey || evt.ctrlKey)
        return;
      console.log("hover");
      console.log(getHover());
      console.log("backlink hover");
      console.log(getBacklinkHover());
      console.log("cursor");
      console.log(getCursor());
      let span;
      if (evt.target && (evt.target instanceof HTMLSpanElement || evt.target instanceof SVGElement || evt.target instanceof SVGPathElement)) {
        span = evt.target;
        while (!(span instanceof HTMLSpanElement) && span.parentElement != null) {
          span = span.parentElement;
        }
      }
      if (span && span instanceof HTMLSpanElement && (span == null ? void 0 : span.parentElement) && (span == null ? void 0 : span.parentElement.classList.contains("reference-container-span"))) {
        console.log("start hover reference effect");
        if (getHover() != null)
          return;
        if (!span.getAttribute("data")) {
          span = span.parentElement;
          span = span.querySelector(".reference-data-span");
          if (!span)
            throw new Error("Span element not found");
        }
        updateHoveredCursorColor(span, ACTION_TYPE.MOUSE);
        startReferenceEffect(span, ACTION_TYPE.MOUSE);
      } else if (span && span instanceof HTMLSpanElement && span.getAttribute("reference")) {
        console.log("start hover backlink effect");
        if (getBacklinkHover() != null)
          return;
        startBacklinkEffect(span);
      } else if (getHover() != null) {
        console.log("end hover reference effect");
        const requiredKeys = [
          "dataString",
          "leafId",
          "originalLeafId",
          "temp",
          "cursorViewport",
          "peek",
          "uuid"
        ];
        const allKeysPresent = () => requiredKeys.every((key) => key in getHover());
        while (!allKeysPresent()) {
          await new Promise((resolve) => setTimeout(resolve, 50));
        }
        await endReferenceHoverEffect();
        handleRemoveHoveredCursor(ACTION_TYPE.MOUSE);
      } else if (getBacklinkHover() != null) {
        console.log("end hover backlink effect");
        const requiredKeys = [
          "dataString",
          "leafId",
          "originalLeafId",
          "backlinkLeafId",
          "temp",
          "cursorViewport",
          "peek",
          "uuid",
          "backlinkUUID"
        ];
        const allKeysPresent = () => requiredKeys.every((key) => key in getBacklinkHover());
        while (!allKeysPresent()) {
          await new Promise((resolve) => setTimeout(resolve, 50));
        }
        console.log("start end backlink effect!!!!!");
        await endBacklinkHoverEffect();
      } else {
      }
    });
    this.registerDomEvent(document, "click", async (evt) => {
      console.log("click");
      await checkFocusCursor(evt);
      updateBacklinkMarkPositions();
    });
    this.registerDomEvent(document, "keyup", async (evt) => {
      if (evt.metaKey || evt.ctrlKey)
        return;
      await checkFocusCursor(evt);
      updateBacklinkMarkPositions();
    });
    this.registerDomEvent(document, "keydown", async (evt) => {
      if (evt.key == "\xC7" && evt.metaKey && evt.shiftKey && evt.altKey) {
        updateClipboard(false);
        new import_obsidian6.Notice("Copied reference to clipboard");
      } else if (evt.key == "c" && evt.metaKey && evt.shiftKey) {
        updateClipboard(true);
        new import_obsidian6.Notice("Copied reference to clipboard");
      } else if (evt.key == "s" && evt.metaKey && evt.shiftKey) {
        let target = evt.target;
        let children = Array.from(target.children);
        let currentLine = children.filter(
          (child) => child.classList.contains("cm-active")
        )[0];
        const spans = Array.from(
          currentLine.querySelectorAll(".reference-span")
        );
        if (spans.every(
          (span) => span.classList.contains("reference-span-hidden")
        ) || !spans.every(
          (span) => span.classList.contains("reference-span-hidden")
        ) && spans.reduce((acc, span) => {
          if (acc)
            return acc;
          return span.classList.contains("reference-span-hidden");
        }, false)) {
          spans.forEach((span) => {
            span.classList.toggle("reference-span-hidden", false);
          });
          new import_obsidian6.Notice("Toggle annotations on");
        } else {
          spans.forEach((span) => {
            spans.forEach((span2) => {
              span2.classList.toggle("reference-span-hidden", true);
            });
          });
          new import_obsidian6.Notice("Toggle annotations off");
        }
      }
    });
  }
  onunload() {
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL3N0YXRlLnRzIiwgInNyYy93aWRnZXQvaGlnaGxpZ2h0V2lkZ2V0LnRzIiwgInNyYy9jb25zdGFudHMudHMiLCAic3JjL3dpZGdldC9yZWZlcmVuY2VXaWRnZXQudHMiLCAic3JjL3JlZmVyZW5jZXMudHMiLCAibm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci9ybmcuanMiLCAibm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci9yZWdleC5qcyIsICJub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS1icm93c2VyL3ZhbGlkYXRlLmpzIiwgIm5vZGVfbW9kdWxlcy91dWlkL2Rpc3QvZXNtLWJyb3dzZXIvc3RyaW5naWZ5LmpzIiwgIm5vZGVfbW9kdWxlcy91dWlkL2Rpc3QvZXNtLWJyb3dzZXIvcGFyc2UuanMiLCAibm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci92MzUuanMiLCAibm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci9uYXRpdmUuanMiLCAibm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci92NC5qcyIsICJub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS1icm93c2VyL3NoYTEuanMiLCAibm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci92NS5qcyIsICJzcmMvdXRpbHMudHMiLCAic3JjL3dvcmtzcGFjZS50cyIsICJzcmMvZWZmZWN0cy50cyIsICJzcmMvbWFyay50cyIsICJzcmMvY2xpcGJvYXJkLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBQbHVnaW4sIE1hcmtkb3duVmlldywgTm90aWNlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5cbmltcG9ydCB7XG5cdHVwZGF0ZVRoYXQsXG5cdGdldEhvdmVyLFxuXHRnZXRCYWNrbGlua3MsXG5cdGdldEJhY2tsaW5rSG92ZXIsXG5cdGdldFRoYXQsXG5cdGdldEN1cnNvcixcbn0gZnJvbSBcIi4vc3RhdGVcIjtcbmltcG9ydCB7IGhpZ2hsaWdodHMsIHJlZmVyZW5jZVJlc291cmNlcyB9IGZyb20gXCIuL3dpZGdldFwiO1xuaW1wb3J0IHsgdXBkYXRlQ2xpcGJvYXJkIH0gZnJvbSBcIi4vY2xpcGJvYXJkXCI7XG5pbXBvcnQge1xuXHRnZW5lcmF0ZUJhY2tsaW5rcyxcblx0YWRkUmVmZXJlbmNlc1RvTGVhZixcblx0dXBkYXRlQmFja2xpbmtNYXJrUG9zaXRpb25zLFxuXHR1cGRhdGVIb3ZlcmVkQ3Vyc29yQ29sb3IsXG59IGZyb20gXCIuL3JlZmVyZW5jZXNcIjtcbmltcG9ydCB7XG5cdHN0YXJ0UmVmZXJlbmNlRWZmZWN0LFxuXHRlbmRSZWZlcmVuY2VIb3ZlckVmZmVjdCxcblx0c3RhcnRCYWNrbGlua0VmZmVjdCxcblx0ZW5kQmFja2xpbmtIb3ZlckVmZmVjdCxcblx0ZW5kUmVmZXJlbmNlQ3Vyc29yRWZmZWN0LFxufSBmcm9tIFwiLi9lZmZlY3RzXCI7XG5pbXBvcnQgeyBjaGVja0ZvY3VzQ3Vyc29yLCBoYW5kbGVSZW1vdmVIb3ZlcmVkQ3Vyc29yIH0gZnJvbSBcIi4vdXRpbHNcIjtcbmltcG9ydCB7IEFDVElPTl9UWVBFIH0gZnJvbSBcIi4vY29uc3RhbnRzXCI7XG5pbXBvcnQgeyBFZGl0b3JWaWV3IH0gZnJvbSBcIkBjb2RlbWlycm9yL3ZpZXdcIjtcbmltcG9ydCB7IHNlcmlhbGl6ZVJlZmVyZW5jZSB9IGZyb20gXCIuL3dpZGdldC9yZWZlcmVuY2VXaWRnZXRcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUmVmZXJlbmNlUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcblx0b25sb2FkKCkge1xuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0Z2VuZXJhdGVCYWNrbGlua3MoKTtcblx0XHRcdHRoaXMucmVnaXN0ZXJFdmVudChcblx0XHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLm9uKFwiYWN0aXZlLWxlYWYtY2hhbmdlXCIsIGFzeW5jIChldikgPT4ge1xuXHRcdFx0XHRcdC8vIGNvbnNvbGUubG9nKFwiYWN0aXZlLWxlYWYtY2hhbmdlZDpcIik7XG5cdFx0XHRcdFx0Ly8gVGhpcyBzaG91bGQgY3JlYXRlIHJlZmVyZW5jZU1hcmtlcnMgaWYgdGhleSBkb24ndCBleGlzdCBhbmQgdXBkYXRlXG5cdFx0XHRcdFx0Ly8gZWxzZSB1cGRhdGUgb25seVxuXG5cdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdGNvbnN0IGFjdGl2ZVZpZXcgPVxuXHRcdFx0XHRcdFx0XHR0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuXHRcdFx0XHRcdFx0aWYgKGFjdGl2ZVZpZXc/LmxlYWYgIT0gbnVsbCkge1xuXHRcdFx0XHRcdFx0XHRhd2FpdCBhZGRSZWZlcmVuY2VzVG9MZWFmKGFjdGl2ZVZpZXcubGVhZik7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coZSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KVxuXHRcdFx0KTtcblx0XHR9LCA0MDAwKTtcblxuXHRcdHVwZGF0ZVRoYXQodGhpcyk7XG5cblx0XHR0aGlzLnJlZ2lzdGVyRWRpdG9yRXh0ZW5zaW9uKFtcblx0XHRcdGhpZ2hsaWdodHMsXG5cdFx0XHRyZWZlcmVuY2VSZXNvdXJjZXMsXG5cdFx0XHRFZGl0b3JWaWV3LnVwZGF0ZUxpc3RlbmVyLm9mKGZ1bmN0aW9uIChlKSB7XG5cdFx0XHRcdGlmIChNYXRoLmFicyhlLmNoYW5nZXMuZGVzYy5uZXdMZW5ndGggLSBlLmNoYW5nZXMuZGVzYy5sZW5ndGgpID4gMSkge1xuXHRcdFx0XHRcdHVwZGF0ZUJhY2tsaW5rTWFya1Bvc2l0aW9ucygpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KSxcblx0XHRdKTtcblxuXHRcdHRoaXMucmVnaXN0ZXJEb21FdmVudChkb2N1bWVudCwgXCJtb3VzZW1vdmVcIiwgYXN5bmMgKGV2dCkgPT4ge1xuXHRcdFx0aWYgKGV2dC5tZXRhS2V5IHx8IGV2dC5jdHJsS2V5KSByZXR1cm47XG5cblx0XHRcdGNvbnNvbGUubG9nKFwiaG92ZXJcIik7XG5cdFx0XHRjb25zb2xlLmxvZyhnZXRIb3ZlcigpKTtcblxuXHRcdFx0Y29uc29sZS5sb2coXCJiYWNrbGluayBob3ZlclwiKTtcblx0XHRcdGNvbnNvbGUubG9nKGdldEJhY2tsaW5rSG92ZXIoKSk7XG5cblx0XHRcdGNvbnNvbGUubG9nKFwiY3Vyc29yXCIpO1xuXHRcdFx0Y29uc29sZS5sb2coZ2V0Q3Vyc29yKCkpO1xuXG5cdFx0XHRsZXQgc3Bhbjtcblx0XHRcdGlmIChcblx0XHRcdFx0ZXZ0LnRhcmdldCAmJlxuXHRcdFx0XHQoZXZ0LnRhcmdldCBpbnN0YW5jZW9mIEhUTUxTcGFuRWxlbWVudCB8fFxuXHRcdFx0XHRcdGV2dC50YXJnZXQgaW5zdGFuY2VvZiBTVkdFbGVtZW50IHx8XG5cdFx0XHRcdFx0ZXZ0LnRhcmdldCBpbnN0YW5jZW9mIFNWR1BhdGhFbGVtZW50KVxuXHRcdFx0KSB7XG5cdFx0XHRcdC8vIElmIGVsZW1lbnQgaXMgc3ZnLCBmaW5kIHRoZSBjb250YWluaW5nIHBhcmVudCBzcGFuXG5cdFx0XHRcdHNwYW4gPSBldnQudGFyZ2V0O1xuXG5cdFx0XHRcdHdoaWxlIChcblx0XHRcdFx0XHQhKHNwYW4gaW5zdGFuY2VvZiBIVE1MU3BhbkVsZW1lbnQpICYmXG5cdFx0XHRcdFx0c3Bhbi5wYXJlbnRFbGVtZW50ICE9IG51bGxcblx0XHRcdFx0KSB7XG5cdFx0XHRcdFx0c3BhbiA9IHNwYW4ucGFyZW50RWxlbWVudDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRpZiAoXG5cdFx0XHRcdHNwYW4gJiZcblx0XHRcdFx0c3BhbiBpbnN0YW5jZW9mIEhUTUxTcGFuRWxlbWVudCAmJlxuXHRcdFx0XHRzcGFuPy5wYXJlbnRFbGVtZW50ICYmXG5cdFx0XHRcdHNwYW4/LnBhcmVudEVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicmVmZXJlbmNlLWNvbnRhaW5lci1zcGFuXCIpXG5cdFx0XHQpIHtcblx0XHRcdFx0Y29uc29sZS5sb2coXCJzdGFydCBob3ZlciByZWZlcmVuY2UgZWZmZWN0XCIpO1xuXHRcdFx0XHRpZiAoZ2V0SG92ZXIoKSAhPSBudWxsKSByZXR1cm47XG5cblx0XHRcdFx0aWYgKCFzcGFuLmdldEF0dHJpYnV0ZShcImRhdGFcIikpIHtcblx0XHRcdFx0XHRzcGFuID0gc3Bhbi5wYXJlbnRFbGVtZW50O1xuXHRcdFx0XHRcdHNwYW4gPSBzcGFuLnF1ZXJ5U2VsZWN0b3IoXCIucmVmZXJlbmNlLWRhdGEtc3BhblwiKSBhcyBIVE1MU3BhbkVsZW1lbnQ7XG5cdFx0XHRcdFx0aWYgKCFzcGFuKSB0aHJvdyBuZXcgRXJyb3IoXCJTcGFuIGVsZW1lbnQgbm90IGZvdW5kXCIpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0dXBkYXRlSG92ZXJlZEN1cnNvckNvbG9yKHNwYW4sIEFDVElPTl9UWVBFLk1PVVNFKTtcblx0XHRcdFx0c3RhcnRSZWZlcmVuY2VFZmZlY3Qoc3BhbiwgQUNUSU9OX1RZUEUuTU9VU0UpO1xuXHRcdFx0fSBlbHNlIGlmIChcblx0XHRcdFx0c3BhbiAmJlxuXHRcdFx0XHRzcGFuIGluc3RhbmNlb2YgSFRNTFNwYW5FbGVtZW50ICYmXG5cdFx0XHRcdHNwYW4uZ2V0QXR0cmlidXRlKFwicmVmZXJlbmNlXCIpXG5cdFx0XHQpIHtcblx0XHRcdFx0Y29uc29sZS5sb2coXCJzdGFydCBob3ZlciBiYWNrbGluayBlZmZlY3RcIik7XG5cdFx0XHRcdGlmIChnZXRCYWNrbGlua0hvdmVyKCkgIT0gbnVsbCkgcmV0dXJuO1xuXG5cdFx0XHRcdHN0YXJ0QmFja2xpbmtFZmZlY3Qoc3Bhbik7XG5cdFx0XHR9IGVsc2UgaWYgKGdldEhvdmVyKCkgIT0gbnVsbCkge1xuXHRcdFx0XHRjb25zb2xlLmxvZyhcImVuZCBob3ZlciByZWZlcmVuY2UgZWZmZWN0XCIpO1xuXG5cdFx0XHRcdC8vIERlZmluZSB0aGUga2V5cyB5b3UncmUgd2FpdGluZyBmb3Jcblx0XHRcdFx0Y29uc3QgcmVxdWlyZWRLZXlzID0gW1xuXHRcdFx0XHRcdFwiZGF0YVN0cmluZ1wiLFxuXHRcdFx0XHRcdFwibGVhZklkXCIsXG5cdFx0XHRcdFx0XCJvcmlnaW5hbExlYWZJZFwiLFxuXHRcdFx0XHRcdFwidGVtcFwiLFxuXHRcdFx0XHRcdFwiY3Vyc29yVmlld3BvcnRcIixcblx0XHRcdFx0XHRcInBlZWtcIixcblx0XHRcdFx0XHRcInV1aWRcIixcblx0XHRcdFx0XTtcblxuXHRcdFx0XHQvLyBGdW5jdGlvbiB0byBjaGVjayBpZiBhbGwgcmVxdWlyZWQga2V5cyBhcmUgcHJlc2VudFxuXHRcdFx0XHRjb25zdCBhbGxLZXlzUHJlc2VudCA9ICgpID0+XG5cdFx0XHRcdFx0cmVxdWlyZWRLZXlzLmV2ZXJ5KChrZXkpID0+IGtleSBpbiBnZXRIb3ZlcigpKTtcblxuXHRcdFx0XHQvLyBXYWl0IHVudGlsIGFsbCBrZXlzIGFyZSBwcmVzZW50XG5cdFx0XHRcdHdoaWxlICghYWxsS2V5c1ByZXNlbnQoKSkge1xuXHRcdFx0XHRcdGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDUwKSk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRhd2FpdCBlbmRSZWZlcmVuY2VIb3ZlckVmZmVjdCgpO1xuXHRcdFx0XHRoYW5kbGVSZW1vdmVIb3ZlcmVkQ3Vyc29yKEFDVElPTl9UWVBFLk1PVVNFKTtcblx0XHRcdH0gZWxzZSBpZiAoZ2V0QmFja2xpbmtIb3ZlcigpICE9IG51bGwpIHtcblx0XHRcdFx0Y29uc29sZS5sb2coXCJlbmQgaG92ZXIgYmFja2xpbmsgZWZmZWN0XCIpO1xuXG5cdFx0XHRcdC8vIERlZmluZSB0aGUga2V5cyB5b3UncmUgd2FpdGluZyBmb3Jcblx0XHRcdFx0Y29uc3QgcmVxdWlyZWRLZXlzID0gW1xuXHRcdFx0XHRcdFwiZGF0YVN0cmluZ1wiLFxuXHRcdFx0XHRcdFwibGVhZklkXCIsXG5cdFx0XHRcdFx0XCJvcmlnaW5hbExlYWZJZFwiLFxuXHRcdFx0XHRcdFwiYmFja2xpbmtMZWFmSWRcIixcblx0XHRcdFx0XHRcInRlbXBcIixcblx0XHRcdFx0XHRcImN1cnNvclZpZXdwb3J0XCIsXG5cdFx0XHRcdFx0XCJwZWVrXCIsXG5cdFx0XHRcdFx0XCJ1dWlkXCIsXG5cdFx0XHRcdFx0XCJiYWNrbGlua1VVSURcIixcblx0XHRcdFx0XTtcblxuXHRcdFx0XHQvLyBGdW5jdGlvbiB0byBjaGVjayBpZiBhbGwgcmVxdWlyZWQga2V5cyBhcmUgcHJlc2VudFxuXHRcdFx0XHRjb25zdCBhbGxLZXlzUHJlc2VudCA9ICgpID0+XG5cdFx0XHRcdFx0cmVxdWlyZWRLZXlzLmV2ZXJ5KChrZXkpID0+IGtleSBpbiBnZXRCYWNrbGlua0hvdmVyKCkpO1xuXG5cdFx0XHRcdC8vIFdhaXQgdW50aWwgYWxsIGtleXMgYXJlIHByZXNlbnRcblx0XHRcdFx0d2hpbGUgKCFhbGxLZXlzUHJlc2VudCgpKSB7XG5cdFx0XHRcdFx0YXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgNTApKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGNvbnNvbGUubG9nKFwic3RhcnQgZW5kIGJhY2tsaW5rIGVmZmVjdCEhISEhXCIpO1xuXG5cdFx0XHRcdGF3YWl0IGVuZEJhY2tsaW5rSG92ZXJFZmZlY3QoKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHR9XG5cdFx0XHQvLyBlbHNlIHtcblx0XHRcdC8vIFx0Ly8gY29uc29sZS5sb2coXCJlbmQgaG92ZXIgcmVmZXJlbmNlIGVmZmVjdFwiKTtcblx0XHRcdC8vIFx0ZW5kUmVmZXJlbmNlSG92ZXJFZmZlY3QoKTtcblx0XHRcdC8vIFx0aGFuZGxlUmVtb3ZlSG92ZXJlZEN1cnNvcihBQ1RJT05fVFlQRS5NT1VTRSk7XG5cdFx0XHQvLyB9XG5cdFx0fSk7XG5cblx0XHQvLyBvbiBzZWxlY3Rpb24gY2hhbmdlcywgZXZlbnQgb3ZlciBjbGljayBhbmQga2V5ZG93blxuXG5cdFx0dGhpcy5yZWdpc3RlckRvbUV2ZW50KGRvY3VtZW50LCBcImNsaWNrXCIsIGFzeW5jIChldnQpID0+IHtcblx0XHRcdGNvbnNvbGUubG9nKFwiY2xpY2tcIik7XG5cdFx0XHRhd2FpdCBjaGVja0ZvY3VzQ3Vyc29yKGV2dCk7XG5cdFx0XHR1cGRhdGVCYWNrbGlua01hcmtQb3NpdGlvbnMoKTtcblxuXHRcdFx0Ly8gaWYgKGV2dC5tZXRhS2V5IHx8IGV2dC5jdHJsS2V5KSByZXR1cm47XG5cdFx0XHQvLyBhd2FpdCBlbmRSZWZlcmVuY2VDdXJzb3JFZmZlY3QoKTtcblx0XHR9KTtcblxuXHRcdHRoaXMucmVnaXN0ZXJEb21FdmVudChkb2N1bWVudCwgXCJrZXl1cFwiLCBhc3luYyAoZXZ0KSA9PiB7XG5cdFx0XHRpZiAoZXZ0Lm1ldGFLZXkgfHwgZXZ0LmN0cmxLZXkpIHJldHVybjtcblxuXHRcdFx0Ly8gY29uc29sZS5sb2coXCJrZXl1cFwiKTtcblx0XHRcdGF3YWl0IGNoZWNrRm9jdXNDdXJzb3IoZXZ0KTtcblx0XHRcdHVwZGF0ZUJhY2tsaW5rTWFya1Bvc2l0aW9ucygpO1xuXHRcdFx0Ly8gdXBkYXRlQmFja2xpbmtNYXJrUG9zaXRpb25zKCk7XG5cdFx0fSk7XG5cblx0XHR0aGlzLnJlZ2lzdGVyRG9tRXZlbnQoZG9jdW1lbnQsIFwia2V5ZG93blwiLCBhc3luYyAoZXZ0KSA9PiB7XG5cdFx0XHQvLyBjb25zb2xlLmxvZyhcImtleWRvd25cIik7XG5cblx0XHRcdGlmIChldnQua2V5ID09IFwiXHUwMEM3XCIgJiYgZXZ0Lm1ldGFLZXkgJiYgZXZ0LnNoaWZ0S2V5ICYmIGV2dC5hbHRLZXkpIHtcblx0XHRcdFx0Ly8gY29uc29sZS5sb2coXCJjXCIpO1xuXHRcdFx0XHR1cGRhdGVDbGlwYm9hcmQoZmFsc2UpO1xuXHRcdFx0XHRuZXcgTm90aWNlKFwiQ29waWVkIHJlZmVyZW5jZSB0byBjbGlwYm9hcmRcIik7XG5cdFx0XHR9IGVsc2UgaWYgKGV2dC5rZXkgPT0gXCJjXCIgJiYgZXZ0Lm1ldGFLZXkgJiYgZXZ0LnNoaWZ0S2V5KSB7XG5cdFx0XHRcdC8vIGNvbnNvbGUubG9nKFwiclwiKTtcblx0XHRcdFx0dXBkYXRlQ2xpcGJvYXJkKHRydWUpO1xuXHRcdFx0XHRuZXcgTm90aWNlKFwiQ29waWVkIHJlZmVyZW5jZSB0byBjbGlwYm9hcmRcIik7XG5cdFx0XHR9IGVsc2UgaWYgKGV2dC5rZXkgPT0gXCJzXCIgJiYgZXZ0Lm1ldGFLZXkgJiYgZXZ0LnNoaWZ0S2V5KSB7XG5cdFx0XHRcdGxldCB0YXJnZXQgPSBldnQudGFyZ2V0IGFzIEhUTUxFbGVtZW50O1xuXHRcdFx0XHRsZXQgY2hpbGRyZW4gPSBBcnJheS5mcm9tKHRhcmdldC5jaGlsZHJlbik7XG5cdFx0XHRcdGxldCBjdXJyZW50TGluZSA9IGNoaWxkcmVuLmZpbHRlcigoY2hpbGQpID0+XG5cdFx0XHRcdFx0Y2hpbGQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiY20tYWN0aXZlXCIpXG5cdFx0XHRcdClbMF07XG5cblx0XHRcdFx0Y29uc3Qgc3BhbnMgPSBBcnJheS5mcm9tPEhUTUxTcGFuRWxlbWVudD4oXG5cdFx0XHRcdFx0Y3VycmVudExpbmUucXVlcnlTZWxlY3RvckFsbChcIi5yZWZlcmVuY2Utc3BhblwiKVxuXHRcdFx0XHQpO1xuXG5cdFx0XHRcdGlmIChcblx0XHRcdFx0XHRzcGFucy5ldmVyeSgoc3BhbikgPT5cblx0XHRcdFx0XHRcdHNwYW4uY2xhc3NMaXN0LmNvbnRhaW5zKFwicmVmZXJlbmNlLXNwYW4taGlkZGVuXCIpXG5cdFx0XHRcdFx0KSB8fFxuXHRcdFx0XHRcdCghc3BhbnMuZXZlcnkoKHNwYW4pID0+XG5cdFx0XHRcdFx0XHRzcGFuLmNsYXNzTGlzdC5jb250YWlucyhcInJlZmVyZW5jZS1zcGFuLWhpZGRlblwiKVxuXHRcdFx0XHRcdCkgJiZcblx0XHRcdFx0XHRcdHNwYW5zLnJlZHVjZSgoYWNjLCBzcGFuKSA9PiB7XG5cdFx0XHRcdFx0XHRcdGlmIChhY2MpIHJldHVybiBhY2M7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBzcGFuLmNsYXNzTGlzdC5jb250YWlucyhcInJlZmVyZW5jZS1zcGFuLWhpZGRlblwiKTtcblx0XHRcdFx0XHRcdH0sIGZhbHNlKSlcblx0XHRcdFx0KSB7XG5cdFx0XHRcdFx0c3BhbnMuZm9yRWFjaCgoc3BhbikgPT4ge1xuXHRcdFx0XHRcdFx0c3Bhbi5jbGFzc0xpc3QudG9nZ2xlKFwicmVmZXJlbmNlLXNwYW4taGlkZGVuXCIsIGZhbHNlKTtcblx0XHRcdFx0XHRcdC8vIFdhbnQgdG8gc2VyaWFsaXplIHJlZmVyZW5jZXMgYXQgc29tZSBwb2ludFxuXHRcdFx0XHRcdFx0Ly8gY29uc29sZS5sb2coc3Bhbik7XG5cdFx0XHRcdFx0XHQvLyBnZXRUaGF0KCkud29ya3NwYWNlLmdldExlYWYoKS52aWV3O1xuXG5cdFx0XHRcdFx0XHQvLyBzZXJpYWxpemVSZWZlcmVuY2Uoc3Bhbilcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRuZXcgTm90aWNlKFwiVG9nZ2xlIGFubm90YXRpb25zIG9uXCIpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHNwYW5zLmZvckVhY2goKHNwYW46IEhUTUxTcGFuRWxlbWVudCkgPT4ge1xuXHRcdFx0XHRcdFx0c3BhbnMuZm9yRWFjaCgoc3BhbikgPT4ge1xuXHRcdFx0XHRcdFx0XHRzcGFuLmNsYXNzTGlzdC50b2dnbGUoXCJyZWZlcmVuY2Utc3Bhbi1oaWRkZW5cIiwgdHJ1ZSk7XG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRuZXcgTm90aWNlKFwiVG9nZ2xlIGFubm90YXRpb25zIG9mZlwiKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0Ly8gZ2V0VGhhdCgpLndvcmtzcGFjZS5vbihcImVkaXRvci1jaGFuZ2VcIiwgKGV2KSA9PiB7XG5cdFx0Ly8gXHRjb25zb2xlLmxvZyhldik7XG5cdFx0Ly8gfSk7XG5cblx0XHQvLyB0aGlzLnJlZ2lzdGVyRXZlbnQoXG5cdFx0Ly8gXHR0aGlzLmFwcC53b3Jrc3BhY2Uub24oXCJ3aW5kb3ctY2xvc2VcIiwgKGV2KSA9PiB7XG5cdFx0Ly8gXHRcdGNvbnNvbGUubG9nKFwid2luZG93IGNsb3NlZDpcIik7XG5cdFx0Ly8gXHRcdGNvbnNvbGUubG9nKGV2KTtcblx0XHQvLyBcdH0pXG5cdFx0Ly8gKTtcblxuXHRcdC8vIHRoaXMucmVnaXN0ZXJFdmVudChcblx0XHQvLyBcdHRoaXMuYXBwLndvcmtzcGFjZS5vbihcImVkaXRvci1kcm9wXCIsIChldikgPT4ge1xuXHRcdC8vIFx0XHRjb25zb2xlLmxvZyhcIkVkaXRvciBkcm9wcGVkOlwiKTtcblx0XHQvLyBcdFx0Y29uc29sZS5sb2coZXYpO1xuXHRcdC8vIFx0fSlcblx0XHQvLyApO1xuXG5cdFx0Ly8gdGhpcy5yZWdpc3RlckV2ZW50KFxuXHRcdC8vIFx0dGhpcy5hcHAud29ya3NwYWNlLm9uKFwid2luZG93LW9wZW5cIiwgKGV2KSA9PiB7XG5cdFx0Ly8gXHRcdGNvbnNvbGUubG9nKFwid2luZG93IG9wZW5lZDpcIik7XG5cdFx0Ly8gXHRcdC8vIGNvbnNvbGUubG9nKGV2KTtcblx0XHQvLyBcdH0pXG5cdFx0Ly8gKTtcblxuXHRcdC8vIHRoaXMucmVnaXN0ZXJFdmVudChcblx0XHQvLyBcdHRoaXMuYXBwLndvcmtzcGFjZS5vbihcInJlc2l6ZVwiLCAoKSA9PiB7XG5cdFx0Ly8gXHRcdGNvbnNvbGUubG9nKFwicmVzaXplXCIpO1xuXHRcdC8vIFx0fSlcblx0XHQvLyApO1xuXG5cdFx0Ly8gdGhpcy5yZWdpc3RlckV2ZW50KFxuXHRcdC8vIFx0dGhpcy5hcHAud29ya3NwYWNlLm9uKFwiZmlsZS1vcGVuXCIsIChldikgPT4ge1xuXHRcdC8vIFx0XHRjb25zb2xlLmxvZyhcImZpbGUgb3BlbmVkOlwiKTtcblx0XHQvLyBcdFx0Ly8gY29uc29sZS5sb2coZXYpO1xuXHRcdC8vIFx0XHQvLyBjb25zb2xlLmxvZyhnZXRSZWZlcmVuY2VzKCkpO1xuXG5cdFx0Ly8gXHRcdGxldCBjdXJyZW50TGVhZjogYW55ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYWYoKTtcblxuXHRcdC8vIFx0XHQvLyBjaGVjayBpdCByZWZlcmVuY2VzIGhhdmUgYWxyZWFkeSBiZWVuIGNyZWF0ZWQsIGVsc2UgY3JlYXRlIHJlZmVyZW5jZXNcblx0XHQvLyBcdH0pXG5cdFx0Ly8gKTtcblxuXHRcdC8vIHRoaXMucmVnaXN0ZXJFdmVudChcblx0XHQvLyBcdHRoaXMuYXBwLndvcmtzcGFjZS5vbihcImxheW91dC1jaGFuZ2VcIiwgKCkgPT4ge1xuXHRcdC8vIFx0XHRjb25zb2xlLmxvZyhcImxheW91dC1jaGFuZ2VkOlwiKTtcblx0XHQvLyBcdH0pXG5cdFx0Ly8gKTtcblx0fVxuXG5cdG9udW5sb2FkKCkge31cbn1cbiIsICJpbXBvcnQge1xuXHRFZGl0b3JTdGF0ZSxcblx0U3RhdGVGaWVsZCxcblx0QW5ub3RhdGlvbixcblx0U3RhdGVFZmZlY3QsXG59IGZyb20gXCJAY29kZW1pcnJvci9zdGF0ZVwiO1xuaW1wb3J0IHsgQmFja2xpbmsgfSBmcm9tIFwiLi90eXBlc1wiO1xuaW1wb3J0IHsgdXBkYXRlQmFja2xpbmtNYXJrUG9zaXRpb25zIH0gZnJvbSBcIi4vcmVmZXJlbmNlc1wiO1xuaW1wb3J0IHsgQXBwIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5cbmV4cG9ydCBsZXQgdGhhdCA9IFN0YXRlRmllbGQuZGVmaW5lPEFwcCB8IG51bGw+KHtcblx0Y3JlYXRlKCkge1xuXHRcdHJldHVybiBudWxsO1xuXHR9LFxuXHR1cGRhdGUodmFsdWUsIHRyOiBhbnkpIHtcblx0XHRpZiAoXG5cdFx0XHR0cltcImFubm90YXRpb25zXCJdLmxlbmd0aCA9PSAyICYmXG5cdFx0XHR0cltcImFubm90YXRpb25zXCJdWzBdLnZhbHVlLnR5cGUgPT0gXCJ0aGF0XCJcblx0XHQpIHtcblx0XHRcdHJldHVybiB0cltcImFubm90YXRpb25zXCJdWzBdLnZhbHVlLnRoYXQuYXBwO1xuXHRcdH1cblx0XHRyZXR1cm4gdmFsdWU7XG5cdH0sXG59KTtcblxuZXhwb3J0IGxldCBob3ZlcmVkQ3Vyc29yID0gU3RhdGVGaWVsZC5kZWZpbmU8YW55Pih7XG5cdGNyZWF0ZSgpIHtcblx0XHRyZXR1cm4gbnVsbDtcblx0fSxcblx0dXBkYXRlKHZhbHVlLCB0cjogYW55KSB7XG5cdFx0aWYgKFxuXHRcdFx0dHJbXCJhbm5vdGF0aW9uc1wiXS5sZW5ndGggPT0gMiAmJlxuXHRcdFx0dHJbXCJhbm5vdGF0aW9uc1wiXVswXS52YWx1ZS50eXBlID09IFwiaG92ZXJlZEN1cnNvclwiXG5cdFx0KSB7XG5cdFx0XHRpZiAodmFsdWUpXG5cdFx0XHRcdHJldHVybiBbXG5cdFx0XHRcdFx0Li4udmFsdWUuZmlsdGVyKFxuXHRcdFx0XHRcdFx0KGN1cnNvcjogYW55KSA9PiBjdXJzb3IudXNlciAhPSB0cltcImFubm90YXRpb25zXCJdWzBdLnZhbHVlLnVzZXJcblx0XHRcdFx0XHQpLFxuXHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdGN1cnNvcjogdHJbXCJhbm5vdGF0aW9uc1wiXVswXS52YWx1ZS5jdXJzb3IsXG5cdFx0XHRcdFx0XHR1c2VyOiB0cltcImFubm90YXRpb25zXCJdWzBdLnZhbHVlLnVzZXIsXG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XTtcblx0XHRcdHJldHVybiBbXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRjdXJzb3I6IHRyW1wiYW5ub3RhdGlvbnNcIl1bMF0udmFsdWUuY3Vyc29yLFxuXHRcdFx0XHRcdHVzZXI6IHRyW1wiYW5ub3RhdGlvbnNcIl1bMF0udmFsdWUudXNlcixcblx0XHRcdFx0fSxcblx0XHRcdF07XG5cdFx0fSBlbHNlIGlmIChcblx0XHRcdHRyW1wiYW5ub3RhdGlvbnNcIl0ubGVuZ3RoID09IDIgJiZcblx0XHRcdHRyW1wiYW5ub3RhdGlvbnNcIl1bMF0udmFsdWUudHlwZSA9PSBcInJlbW92ZUhvdmVyZWRDdXJzb3JcIlxuXHRcdCkge1xuXHRcdFx0aWYgKHZhbHVlKVxuXHRcdFx0XHRyZXR1cm4gdmFsdWUuZmlsdGVyKFxuXHRcdFx0XHRcdChjdXJzb3I6IGFueSkgPT4gY3Vyc29yLnVzZXIgIT0gdHJbXCJhbm5vdGF0aW9uc1wiXVswXS52YWx1ZS51c2VyXG5cdFx0XHRcdCk7XG5cdFx0XHRyZXR1cm4gdmFsdWU7XG5cdFx0fVxuXHRcdHJldHVybiB2YWx1ZTtcblx0fSxcbn0pO1xuXG5leHBvcnQgbGV0IGJhY2tsaW5rcyA9IFN0YXRlRmllbGQuZGVmaW5lPEJhY2tsaW5rW10+KHtcblx0Y3JlYXRlKCkge1xuXHRcdHJldHVybiBbXTtcblx0fSxcblx0dXBkYXRlKHZhbHVlLCB0cikge1xuXHRcdC8qXG5cdFx0XHRJICB3YW50IHRvIGdldCB0aGUgY3VycmVudCBhY3RpdmVMZWFmIGFuZCByZWNvbXB1dGUgdGhlIHJlZmVyZW5jZXNcblx0XHRcdG1lcmdlIHRoaXMgaW50byB0aGUgcmVmZXJlbmNlcyBmaWVsZFxuXHRcdCovXG5cblx0XHRpZiAodHIuZWZmZWN0cy5sZW5ndGggPiAwKSB7XG5cdFx0XHR0cnkge1xuXHRcdFx0XHRsZXQgZGF0YTogeyB0eXBlOiBzdHJpbmc7IGJhY2tsaW5rczogQmFja2xpbmtbXSB9ID0gSlNPTi5wYXJzZShcblx0XHRcdFx0XHR0ci5lZmZlY3RzWzBdLnZhbHVlXG5cdFx0XHRcdCk7XG5cdFx0XHRcdGlmIChkYXRhLnR5cGUgPT0gXCJiYWNrbGlua1wiKSB7XG5cdFx0XHRcdFx0aWYgKGRhdGEuYmFja2xpbmtzLmxlbmd0aCA9PSAwKSByZXR1cm4gdmFsdWU7XG5cdFx0XHRcdFx0bGV0IHJlZmVyZW5jaW5nTG9jYXRpb24gPVxuXHRcdFx0XHRcdFx0ZGF0YS5iYWNrbGlua3NbMF1bXCJyZWZlcmVuY2luZ0xvY2F0aW9uXCJdW1wiZmlsZW5hbWVcIl07XG5cdFx0XHRcdFx0bGV0IGZpbHRlcmVkVmFsdWVzID0gdmFsdWUuZmlsdGVyKFxuXHRcdFx0XHRcdFx0KGJhY2tsaW5rKSA9PlxuXHRcdFx0XHRcdFx0XHRiYWNrbGluay5yZWZlcmVuY2luZ0xvY2F0aW9uLmZpbGVuYW1lICE9IHJlZmVyZW5jaW5nTG9jYXRpb25cblx0XHRcdFx0XHQpO1xuXHRcdFx0XHRcdHJldHVybiBbLi4uZmlsdGVyZWRWYWx1ZXMsIC4uLmRhdGEuYmFja2xpbmtzXTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gdmFsdWU7XG5cdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKGUpO1xuXHRcdFx0XHRyZXR1cm4gdmFsdWU7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiB2YWx1ZTtcblx0fSxcbn0pO1xuXG5leHBvcnQgbGV0IGhvdmVyRWxlbWVudCA9IFN0YXRlRmllbGQuZGVmaW5lPG9iamVjdCB8IG51bGw+KHtcblx0Y3JlYXRlKCkge1xuXHRcdHJldHVybiBudWxsO1xuXHR9LFxuXHR1cGRhdGUodmFsdWUsIHRyKSB7XG5cdFx0aWYgKHRyLmVmZmVjdHMubGVuZ3RoID4gMCkge1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0bGV0IGRhdGEgPSBKU09OLnBhcnNlKHRyLmVmZmVjdHNbMF0udmFsdWUpO1xuXHRcdFx0XHRpZiAoZGF0YS50eXBlID09IFwiaG92ZXItc3RhcnRcIikge1xuXHRcdFx0XHRcdHJldHVybiBPYmplY3QuYXNzaWduKHt9LCBkYXRhKTtcblx0XHRcdFx0fSBlbHNlIGlmIChkYXRhLnR5cGUgPT0gXCJob3ZlclwiKSB7XG5cdFx0XHRcdFx0aWYgKHZhbHVlKSByZXR1cm4gT2JqZWN0LmFzc2lnbih2YWx1ZSwgZGF0YSk7XG5cdFx0XHRcdFx0cmV0dXJuIGRhdGE7XG5cdFx0XHRcdH0gZWxzZSBpZiAoZGF0YS50eXBlID09IFwiaG92ZXItb2ZmXCIpIHtcblx0XHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gdmFsdWU7XG5cdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKGUpO1xuXHRcdFx0XHRyZXR1cm4gdmFsdWU7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiB2YWx1ZTtcblx0fSxcbn0pO1xuXG5leHBvcnQgbGV0IGJhY2tsaW5rSG92ZXJFbGVtZW50ID0gU3RhdGVGaWVsZC5kZWZpbmU8b2JqZWN0IHwgbnVsbD4oe1xuXHRjcmVhdGUoKSB7XG5cdFx0cmV0dXJuIG51bGw7XG5cdH0sXG5cdHVwZGF0ZSh2YWx1ZSwgdHIpIHtcblx0XHRpZiAodHIuZWZmZWN0cy5sZW5ndGggPiAwKSB7XG5cdFx0XHR0cnkge1xuXHRcdFx0XHRsZXQgZGF0YSA9IEpTT04ucGFyc2UodHIuZWZmZWN0c1swXS52YWx1ZSk7XG5cdFx0XHRcdGlmIChkYXRhLnR5cGUgPT0gXCJiYWNrbGluay1zdGFydFwiKSB7XG5cdFx0XHRcdFx0cmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIGRhdGEpO1xuXHRcdFx0XHR9IGVsc2UgaWYgKGRhdGEudHlwZSA9PSBcImJhY2tsaW5rLXVwZGF0ZVwiKSB7XG5cdFx0XHRcdFx0aWYgKHZhbHVlKSByZXR1cm4gT2JqZWN0LmFzc2lnbih2YWx1ZSwgZGF0YSk7XG5cdFx0XHRcdFx0cmV0dXJuIGRhdGE7XG5cdFx0XHRcdH0gZWxzZSBpZiAoZGF0YS50eXBlID09IFwiYmFja2xpbmstb2ZmXCIpIHtcblx0XHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gdmFsdWU7XG5cdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKGUpO1xuXHRcdFx0XHRyZXR1cm4gdmFsdWU7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiB2YWx1ZTtcblx0fSxcbn0pO1xuXG5leHBvcnQgbGV0IGN1cnNvckVsZW1lbnQgPSBTdGF0ZUZpZWxkLmRlZmluZTxvYmplY3QgfCBudWxsPih7XG5cdGNyZWF0ZSgpIHtcblx0XHRyZXR1cm4gbnVsbDtcblx0fSxcblx0dXBkYXRlKHZhbHVlLCB0cikge1xuXHRcdGlmICh0ci5lZmZlY3RzLmxlbmd0aCA+IDApIHtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdGxldCBkYXRhID0gSlNPTi5wYXJzZSh0ci5lZmZlY3RzWzBdLnZhbHVlKTtcblx0XHRcdFx0aWYgKGRhdGEudHlwZSA9PSBcImN1cnNvci1zdGFydFwiKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHt9O1xuXHRcdFx0XHR9IGVsc2UgaWYgKGRhdGEudHlwZSA9PSBcImN1cnNvclwiKSB7XG5cdFx0XHRcdFx0aWYgKHZhbHVlKSByZXR1cm4gT2JqZWN0LmFzc2lnbih2YWx1ZSwgZGF0YSk7XG5cdFx0XHRcdFx0cmV0dXJuIGRhdGE7XG5cdFx0XHRcdH0gZWxzZSBpZiAoZGF0YS50eXBlID09IFwiY3Vyc29yLW9mZlwiKSB7XG5cdFx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIHZhbHVlO1xuXHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRjb25zb2xlLmxvZyhlKTtcblx0XHRcdFx0cmV0dXJuIHZhbHVlO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gdmFsdWU7XG5cdH0sXG59KTtcblxuZXhwb3J0IGxldCBlZGl0b3JDaGFuZ2UgPSBTdGF0ZUZpZWxkLmRlZmluZTxudWxsPih7XG5cdGNyZWF0ZSgpIHtcblx0XHRyZXR1cm4gbnVsbDtcblx0fSxcblx0dXBkYXRlKHZhbHVlLCB0cikge1xuXHRcdGlmICh0ci5lZmZlY3RzLmxlbmd0aCA+IDApIHtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdGxldCBkYXRhID0gSlNPTi5wYXJzZSh0ci5lZmZlY3RzWzBdLnZhbHVlKTtcblx0XHRcdFx0aWYgKGRhdGEudHlwZSA9PSBcInN5bmNcIikge1xuXHRcdFx0XHRcdC8vIHVwZGF0ZUJhY2tsaW5rTWFya1Bvc2l0aW9ucygpO1xuXHRcdFx0XHRcdHJldHVybiB2YWx1ZTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gdmFsdWU7XG5cdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKGUpO1xuXHRcdFx0XHRyZXR1cm4gdmFsdWU7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiB2YWx1ZTtcblx0fSxcbn0pO1xuXG5leHBvcnQgY29uc3QgdGhhdEFubm90YXRpb24gPSBBbm5vdGF0aW9uLmRlZmluZTxhbnk+KCk7XG5leHBvcnQgY29uc3QgaG92ZXJlZEN1cnNvckFubm90YXRpb24gPSBBbm5vdGF0aW9uLmRlZmluZTxhbnk+KCk7XG5leHBvcnQgY29uc3QgaG92ZXJFZmZlY3QgPSBTdGF0ZUVmZmVjdC5kZWZpbmU8c3RyaW5nPigpO1xuZXhwb3J0IGNvbnN0IGJhY2tsaW5rSG92ZXJFZmZlY3QgPSBTdGF0ZUVmZmVjdC5kZWZpbmU8c3RyaW5nPigpO1xuZXhwb3J0IGNvbnN0IGN1cnNvckVmZmVjdCA9IFN0YXRlRWZmZWN0LmRlZmluZTxzdHJpbmc+KCk7XG5leHBvcnQgY29uc3QgYmFja2xpbmtFZmZlY3QgPSBTdGF0ZUVmZmVjdC5kZWZpbmU8c3RyaW5nPigpO1xuXG5leHBvcnQgbGV0IHN0YXRlOiBhbnkgPSBFZGl0b3JTdGF0ZS5jcmVhdGUoe1xuXHRleHRlbnNpb25zOiBbXG5cdFx0dGhhdCxcblx0XHRob3ZlcmVkQ3Vyc29yLFxuXHRcdGJhY2tsaW5rcyxcblx0XHRob3ZlckVsZW1lbnQsXG5cdFx0YmFja2xpbmtIb3ZlckVsZW1lbnQsXG5cdFx0Y3Vyc29yRWxlbWVudCxcblx0XHRlZGl0b3JDaGFuZ2UsXG5cdF0sXG59KTtcblxuZXhwb3J0IGZ1bmN0aW9uIHN5bmNCYWNrbGlua3MoKSB7XG5cdHN0YXRlID0gc3RhdGUudXBkYXRlKHtcblx0XHRlZmZlY3RzOiBiYWNrbGlua0VmZmVjdC5vZihKU09OLnN0cmluZ2lmeSh7IHR5cGU6IFwic3luY1wiIH0pKSxcblx0fSkuc3RhdGU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRUaGF0KCk6IEFwcCB7XG5cdHJldHVybiBzdGF0ZS5maWVsZCh0aGF0KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZVRoYXQodGhhdDogYW55KSB7XG5cdHN0YXRlID0gc3RhdGUudXBkYXRlKHtcblx0XHRhbm5vdGF0aW9uczogdGhhdEFubm90YXRpb24ub2Yoe1xuXHRcdFx0dHlwZTogXCJ0aGF0XCIsXG5cdFx0XHR0aGF0LFxuXHRcdH0pLFxuXHR9KS5zdGF0ZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEhvdmVyZWRDdXJzb3IoKSB7XG5cdHJldHVybiBzdGF0ZS5maWVsZChob3ZlcmVkQ3Vyc29yKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZUhvdmVyZWRDdXJzb3IoY3Vyc29yOiBIVE1MT3JTVkdFbGVtZW50LCB1c2VyOiBzdHJpbmcpIHtcblx0c3RhdGUgPSBzdGF0ZS51cGRhdGUoe1xuXHRcdGFubm90YXRpb25zOiBob3ZlcmVkQ3Vyc29yQW5ub3RhdGlvbi5vZih7XG5cdFx0XHR0eXBlOiBcImhvdmVyZWRDdXJzb3JcIixcblx0XHRcdGN1cnNvcixcblx0XHRcdHVzZXIsXG5cdFx0fSksXG5cdH0pLnN0YXRlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlSG92ZXJlZEN1cnNvcih1c2VyOiBzdHJpbmcpIHtcblx0c3RhdGUgPSBzdGF0ZS51cGRhdGUoe1xuXHRcdGFubm90YXRpb25zOiBob3ZlcmVkQ3Vyc29yQW5ub3RhdGlvbi5vZih7XG5cdFx0XHR0eXBlOiBcInJlbW92ZUhvdmVyZWRDdXJzb3JcIixcblx0XHRcdHVzZXIsXG5cdFx0fSksXG5cdH0pLnN0YXRlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0SG92ZXIoKSB7XG5cdHJldHVybiBzdGF0ZS5maWVsZChob3ZlckVsZW1lbnQpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlSG92ZXIodmFsdWU6IG9iamVjdCkge1xuXHRzdGF0ZSA9IHN0YXRlLnVwZGF0ZSh7XG5cdFx0ZWZmZWN0czogaG92ZXJFZmZlY3Qub2YoXG5cdFx0XHRKU09OLnN0cmluZ2lmeShPYmplY3QuYXNzaWduKHZhbHVlLCB7IHR5cGU6IFwiaG92ZXJcIiB9KSlcblx0XHQpLFxuXHR9KS5zdGF0ZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlc2V0SG92ZXIoKSB7XG5cdHN0YXRlID0gc3RhdGUudXBkYXRlKHtcblx0XHRlZmZlY3RzOiBob3ZlckVmZmVjdC5vZihcblx0XHRcdEpTT04uc3RyaW5naWZ5KHtcblx0XHRcdFx0dHlwZTogXCJob3Zlci1vZmZcIixcblx0XHRcdH0pXG5cdFx0KSxcblx0fSkuc3RhdGU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRCYWNrbGlua0hvdmVyKCkge1xuXHRyZXR1cm4gc3RhdGUuZmllbGQoYmFja2xpbmtIb3ZlckVsZW1lbnQpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlQmFja2xpbmtIb3Zlcih2YWx1ZTogb2JqZWN0KSB7XG5cdHN0YXRlID0gc3RhdGUudXBkYXRlKHtcblx0XHRlZmZlY3RzOiBiYWNrbGlua0hvdmVyRWZmZWN0Lm9mKFxuXHRcdFx0SlNPTi5zdHJpbmdpZnkoT2JqZWN0LmFzc2lnbih2YWx1ZSwgeyB0eXBlOiBcImJhY2tsaW5rLXVwZGF0ZVwiIH0pKVxuXHRcdCksXG5cdH0pLnN0YXRlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVzZXRCYWNrbGlua0hvdmVyKCkge1xuXHRzdGF0ZSA9IHN0YXRlLnVwZGF0ZSh7XG5cdFx0ZWZmZWN0czogYmFja2xpbmtIb3ZlckVmZmVjdC5vZihcblx0XHRcdEpTT04uc3RyaW5naWZ5KHtcblx0XHRcdFx0dHlwZTogXCJiYWNrbGluay1vZmZcIixcblx0XHRcdH0pXG5cdFx0KSxcblx0fSkuc3RhdGU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDdXJzb3IoKSB7XG5cdHJldHVybiBzdGF0ZS5maWVsZChjdXJzb3JFbGVtZW50KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZUN1cnNvcih2YWx1ZTogb2JqZWN0KSB7XG5cdHN0YXRlID0gc3RhdGUudXBkYXRlKHtcblx0XHRlZmZlY3RzOiBjdXJzb3JFZmZlY3Qub2YoXG5cdFx0XHRKU09OLnN0cmluZ2lmeShPYmplY3QuYXNzaWduKHZhbHVlLCB7IHR5cGU6IFwiY3Vyc29yXCIgfSkpXG5cdFx0KSxcblx0fSkuc3RhdGU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZXNldEN1cnNvcigpIHtcblx0c3RhdGUgPSBzdGF0ZS51cGRhdGUoe1xuXHRcdGVmZmVjdHM6IGN1cnNvckVmZmVjdC5vZihcblx0XHRcdEpTT04uc3RyaW5naWZ5KHtcblx0XHRcdFx0dHlwZTogXCJjdXJzb3Itb2ZmXCIsXG5cdFx0XHR9KVxuXHRcdCksXG5cdH0pLnN0YXRlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0QmFja2xpbmtzKCk6IEJhY2tsaW5rW10ge1xuXHRyZXR1cm4gc3RhdGUuZmllbGQoYmFja2xpbmtzKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZUJhY2tsaW5rcyh2YWx1ZTogQmFja2xpbmtbXSkge1xuXHRzdGF0ZSA9IHN0YXRlLnVwZGF0ZSh7XG5cdFx0ZWZmZWN0czogYmFja2xpbmtFZmZlY3Qub2YoXG5cdFx0XHRKU09OLnN0cmluZ2lmeShPYmplY3QuYXNzaWduKHsgYmFja2xpbmtzOiB2YWx1ZSB9LCB7IHR5cGU6IFwiYmFja2xpbmtcIiB9KSlcblx0XHQpLFxuXHR9KS5zdGF0ZTtcbn1cbiIsICJpbXBvcnQge1xuXHRFZGl0b3JWaWV3LFxuXHRXaWRnZXRUeXBlLFxuXHREZWNvcmF0aW9uLFxuXHREZWNvcmF0aW9uU2V0LFxuXHRWaWV3UGx1Z2luLFxuXHRWaWV3VXBkYXRlLFxuXHRNYXRjaERlY29yYXRvcixcblx0Z3V0dGVyLFxuXHRHdXR0ZXJNYXJrZXIsXG59IGZyb20gXCJAY29kZW1pcnJvci92aWV3XCI7XG5pbXBvcnQgeyBTVkdfSE9WRVJfQ09MT1IgfSBmcm9tIFwiLi4vY29uc3RhbnRzXCI7XG5cbi8qIGhpZ2hsaWdodCAqL1xuY2xhc3MgSGlnaGxpZ2h0ZXJXaWRnZXQgZXh0ZW5kcyBXaWRnZXRUeXBlIHtcblx0Y29uc3RydWN0b3IocHJpdmF0ZSBuYW1lOiBzdHJpbmcsIHByaXZhdGUgdmlldzogRWRpdG9yVmlldykge1xuXHRcdHN1cGVyKCk7XG5cdH1cblxuXHRlcShvdGhlcjogSGlnaGxpZ2h0ZXJXaWRnZXQpIHtcblx0XHRyZXR1cm4gdGhpcy5uYW1lID09PSBvdGhlci5uYW1lO1xuXHR9XG5cblx0dG9ET00oKSB7XG5cdFx0Y29uc3Qgc3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJmcmFnbWVudFwiKTtcblx0XHRzcGFuLnRleHRDb250ZW50ID0gdGhpcy5uYW1lO1xuXHRcdHNwYW4uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gU1ZHX0hPVkVSX0NPTE9SO1xuXHRcdHNwYW4uc3R5bGUuY29sb3IgPSBcImJsYWNrXCI7XG5cblx0XHRyZXR1cm4gc3Bhbjtcblx0fVxufVxuXG5jb25zdCBoaWdobGlnaHRlckRlY29yYXRpb24gPSAobWF0Y2g6IFJlZ0V4cEV4ZWNBcnJheSwgdmlldzogRWRpdG9yVmlldykgPT5cblx0RGVjb3JhdGlvbi5yZXBsYWNlKHtcblx0XHR3aWRnZXQ6IG5ldyBIaWdobGlnaHRlcldpZGdldChtYXRjaFsxXSwgdmlldyksXG5cdH0pO1xuXG5jb25zdCBoaWdobGlnaHRNYXRjaGVyID0gbmV3IE1hdGNoRGVjb3JhdG9yKHtcblx0cmVnZXhwOiAvXFwrXFwrXFwrKC4qPylcXCtcXCtcXCsvZyxcblx0ZGVjb3JhdGlvbjogKG1hdGNoLCB2aWV3LCBwb3MpID0+IHtcblx0XHRyZXR1cm4gaGlnaGxpZ2h0ZXJEZWNvcmF0aW9uKG1hdGNoLCB2aWV3KTtcblx0fSxcbn0pO1xuXG5leHBvcnQgY29uc3QgaGlnaGxpZ2h0cyA9IFZpZXdQbHVnaW4uZnJvbUNsYXNzKFxuXHRjbGFzcyB7XG5cdFx0aGlnaGxpZ2h0czogRGVjb3JhdGlvblNldDtcblx0XHRjb25zdHJ1Y3Rvcih2aWV3OiBFZGl0b3JWaWV3KSB7XG5cdFx0XHR0aGlzLmhpZ2hsaWdodHMgPSBoaWdobGlnaHRNYXRjaGVyLmNyZWF0ZURlY28odmlldyk7XG5cdFx0fVxuXHRcdHVwZGF0ZSh1cGRhdGU6IFZpZXdVcGRhdGUpIHtcblx0XHRcdHRoaXMuaGlnaGxpZ2h0cyA9IGhpZ2hsaWdodE1hdGNoZXIudXBkYXRlRGVjbyh1cGRhdGUsIHRoaXMuaGlnaGxpZ2h0cyk7XG5cdFx0fVxuXHRcdGRlc3Ryb3koKSB7XG5cdFx0XHR0aGlzLmhpZ2hsaWdodHMgPSBEZWNvcmF0aW9uLm5vbmU7XG5cdFx0fVxuXHR9LFxuXHR7XG5cdFx0ZGVjb3JhdGlvbnM6IChpbnN0YW5jZSkgPT4gaW5zdGFuY2UuaGlnaGxpZ2h0cyxcblx0XHRwcm92aWRlOiAocGx1Z2luKSA9PlxuXHRcdFx0RWRpdG9yVmlldy5hdG9taWNSYW5nZXMub2YoKHZpZXcpID0+IHtcblx0XHRcdFx0cmV0dXJuIHZpZXcucGx1Z2luKHBsdWdpbik/LmhpZ2hsaWdodHMgfHwgRGVjb3JhdGlvbi5ub25lO1xuXHRcdFx0fSksXG5cdH1cbik7XG4iLCAiZXhwb3J0IGxldCBSRUZFUkVOQ0VfUkVHRVggPSAvXFxbXFx1MjE5N1xcXVxcKHVybjooW14pXSopXFwpL2c7XG5cbmV4cG9ydCBsZXQgQUNUSU9OX1RZUEUgPSB7XG5cdE1PVVNFOiBcIm1vdXNlXCIsXG5cdENVUlNPUjogXCJjdXJzb3JcIixcblx0QkFDS0xJTks6IFwiYmFja2xpbmtcIixcbn07XG5cbmV4cG9ydCBsZXQgU1ZHX0hPVkVSX0NPTE9SID0gXCJyZ2IoMTg3LCAyMTUsIDIzMClcIjtcbmV4cG9ydCBsZXQgU1ZHX0hPVkVSX0NPTE9SX0xJR0hUID0gXCJyZ2IoMTg3LCAyMTUsIDIzMCwgMC41KVwiO1xuZXhwb3J0IGxldCBTVkdfQ09MT1IgPSBcInJnYigyMTUsIDIzNSwgMClcIjtcblxuZXhwb3J0IGNvbnN0IFJFRkVSRU5DRV9JQ09OX0hFSUdIVCA9IDIwO1xuXG5leHBvcnQgY29uc3QgUE9SVEFMX1RFWFRfU0xJQ0VfU0laRSA9IDEwMDtcbiIsICJpbXBvcnQge1xuXHRFZGl0b3JWaWV3LFxuXHRXaWRnZXRUeXBlLFxuXHREZWNvcmF0aW9uLFxuXHREZWNvcmF0aW9uU2V0LFxuXHRWaWV3UGx1Z2luLFxuXHRWaWV3VXBkYXRlLFxuXHRNYXRjaERlY29yYXRvcixcblx0Z3V0dGVyLFxuXHRHdXR0ZXJNYXJrZXIsXG59IGZyb20gXCJAY29kZW1pcnJvci92aWV3XCI7XG5cbmltcG9ydCB7XG5cdG9wZW5SZWZlcmVuY2UsXG5cdGNyZWF0ZVJlZmVyZW5jZUljb24sXG5cdHVwZGF0ZUJhY2tsaW5rTWFya1Bvc2l0aW9ucyxcbn0gZnJvbSBcIi4uL3JlZmVyZW5jZXNcIjtcbmltcG9ydCB7IGRlY29kZVVSSUNvbXBvbmVudFN0cmluZywgZW5jb2RlVVJJQ29tcG9uZW50U3RyaW5nIH0gZnJvbSBcInNyYy91dGlsc1wiO1xuaW1wb3J0IHsgZ2V0VGhhdCB9IGZyb20gXCJzcmMvc3RhdGVcIjtcbmltcG9ydCB7IEVkaXRvciwgTWFya2Rvd25WaWV3IH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5cbmZ1bmN0aW9uIHByb2Nlc3NMaW5lKGxpbmU6IEVsZW1lbnQpIHtcblx0bGV0IGxpbmVDb3B5ID0gbGluZT8uY2xvbmVOb2RlKHRydWUpIGFzIEhUTUxFbGVtZW50O1xuXHRsaW5lQ29weT8ucXVlcnlTZWxlY3RvckFsbChcIi5yZWZlcmVuY2Utc3BhblwiKS5mb3JFYWNoKChzcGFuKSA9PiB7XG5cdFx0c3Bhbi5pbm5lckhUTUwgPSBcIlx1MjE5N1wiO1xuXHR9KTtcblxuXHRyZXR1cm4gbGluZUNvcHk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzZXJpYWxpemVSZWZlcmVuY2UoXG5cdGNvbnRlbnQ6IGFueSxcblx0cmVmZXJlbmNlU3BhbjogRWxlbWVudCxcblx0dmlldzogRWRpdG9yVmlld1xuKSB7XG5cdGNvbnN0IFtwcmVmaXgsIHRleHQsIHN1ZmZpeCwgZmlsZSwgZnJvbSwgdG8sIHBvcnRhbCwgdG9nZ2xlID0gXCJmXCJdID1cblx0XHRjb250ZW50WzFdLnNwbGl0KFwiOlwiKTtcblx0Ly8gU2VyaWFsaXplIHRoZSB0b2dnbGUgc3RhdGUgZm9yIHJlZmVyZW5jZSBpbnRvIGZpbGVcblx0Ly8gS05PV04gRVJST1IuIGNvbnRlbnRET00gb25seSByZXR1cm5zIHBhcnRpYWwgZmlsZSBmb3IgZWZmaWNpZW5jeSBvbiBsYXJnZSBkb2N1bWVudHMuIFNvIHdpbGwgbG9zZSBzZXJpYWxpemF0aW9uIGluIHRoaXMgY2FzZS5cblx0cmVmZXJlbmNlU3Bhbi5jbGFzc0xpc3QudG9nZ2xlKFwicmVmZXJlbmNlLXNwYW4taGlkZGVuXCIpO1xuXG5cdGxldCBuZXdUb2dnbGUgPSByZWZlcmVuY2VTcGFuLmNsYXNzTGlzdC5jb250YWlucyhcInJlZmVyZW5jZS1zcGFuLWhpZGRlblwiKVxuXHRcdD8gXCJmXCJcblx0XHQ6IFwidFwiO1xuXHRsZXQgcmVmZXJlbmNlID0gYFtcdTIxOTddKHVybjoke3ByZWZpeH06JHt0ZXh0fToke3N1ZmZpeH06JHtmaWxlfToke2Zyb219OiR7dG99OiR7cG9ydGFsfToke25ld1RvZ2dsZX0pYDtcblxuXHRsZXQgbGluZXMgPSB2aWV3LmNvbnRlbnRET00ucXVlcnlTZWxlY3RvckFsbChcIi5jbS1saW5lXCIpO1xuXG5cdC8vIGdldCB0aGUgaW5kZXggb2YgdGhlIGFjdGl2ZUxpbmVcblx0bGV0IGFjdGl2ZUxpbmVJbmRleDtcblx0bGV0IHNlZW5BY3RpdmUgPSBmYWxzZTtcblx0bGluZXMuZm9yRWFjaCgobGluZSwgaSkgPT4ge1xuXHRcdGlmIChzZWVuQWN0aXZlKSByZXR1cm47XG5cdFx0aWYgKGxpbmUuY2xhc3NMaXN0LmNvbnRhaW5zKFwiY20tYWN0aXZlXCIpKSB7XG5cdFx0XHRzZWVuQWN0aXZlID0gdHJ1ZTtcblx0XHRcdGFjdGl2ZUxpbmVJbmRleCA9IGk7XG5cdFx0fVxuXHR9KTtcblxuXHQvLyBjb25zdCBlZGl0b3I6IEVkaXRvciB8IHVuZGVmaW5lZCA9XG5cdC8vIFx0Z2V0VGhhdCgpLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk/LmVkaXRvcjtcblx0Ly8gaWYgKCFlZGl0b3IpIHJldHVybjtcblx0Ly8gY29uc3QgY3Vyc29yID0gZWRpdG9yLmdldEN1cnNvcigpO1xuXHQvLyBjb25zb2xlLmxvZyhjdXJzb3IpO1xuXHQvLyBjb25zb2xlLmxvZyhhY3RpdmVMaW5lSW5kZXgpO1xuXG5cdGlmIChhY3RpdmVMaW5lSW5kZXggPT09IHVuZGVmaW5lZCkgcmV0dXJuO1xuXHRsZXQgYWN0aXZlTGluZSA9IGxpbmVzW2FjdGl2ZUxpbmVJbmRleF07XG5cdC8vIG1ha2UgY29weSBvZiBhY3RpdmVMaW5lIGVsZW1lbnRcblx0bGV0IGFjdGl2ZUxpbmVDb3B5ID0gcHJvY2Vzc0xpbmUoYWN0aXZlTGluZSk7XG5cdC8vIG5vbi1yZWZlcmVuY2VkIHBhcnRzIG9mIHRoZSB0ZXh0XG5cdGxldCBwYXJ0cyA9IGFjdGl2ZUxpbmVDb3B5LmlubmVyVGV4dC5zcGxpdChcIlx1MjE5N1wiKTtcblxuXHQvLyBnZXQgYWxsIHJlZmVyZW5jZXNcblx0bGV0IGxpbmVSZWZlcmVuY2VzID0gYWN0aXZlTGluZT8ucXVlcnlTZWxlY3RvckFsbChcIi5yZWZlcmVuY2UtZGF0YS1zcGFuXCIpO1xuXG5cdC8vIGdldCB0aGUgZnVsbCBzZXJpYWxpemVkIHZlcnNpb24gZm9yIHRoZXNlIHJlZmVyZW5jZXNcblx0bGV0IGxpbmVSZWZlcmVuY2VzRGF0YSA9IEFycmF5LmZyb20obGluZVJlZmVyZW5jZXMgfHwgW10pLm1hcChcblx0XHQoc3BhbikgPT4gXCJbXHUyMTk3XSh1cm46XCIgKyBzcGFuLmdldEF0dHJpYnV0ZShcImRhdGFcIikgKyBcIilcIlxuXHQpO1xuXHRpZiAoY29udGVudCAmJiBjb250ZW50WzFdKSB7XG5cdFx0Ly8gaWRlbnRpZnkgd2hpY2ggcmVmZXJlbmNlIGlzIGJlaW5nIHRvZ2dsZWRcblx0XHRsZXQgaW5kZXggPSBsaW5lUmVmZXJlbmNlc0RhdGEuaW5kZXhPZihjb250ZW50WzBdKTtcblx0XHRpZiAoaW5kZXggPT0gLTEpIHRocm93IG5ldyBFcnJvcihcIlJlZmVyZW5jZSBub3QgZm91bmRcIik7XG5cblx0XHQvLyBnZXQgdGhlIHRleHQgYmVmb3JlIHRoZSByZWZlcmVuY2Vcblx0XHRsZXQgc3RhcnRUZXh0ID0gW1xuXHRcdFx0Li4ucGFydHMuc2xpY2UoMCwgaW5kZXggKyAxKSxcblx0XHRcdC4uLmxpbmVSZWZlcmVuY2VzRGF0YS5zbGljZSgwLCBpbmRleCksXG5cdFx0XTtcblxuXHRcdC8vIGdldCBhbGwgdGhlIHByaW9yIGxpbmVzIHRvIGFjdGl2ZSBsaW5lIGFuZCB0aGUgbGVuZ3RoIG9mIHRoZSB0ZXh0XG5cdFx0bGV0IHByZXZMaW5lQ2hhckNvdW50ID0gQXJyYXkuZnJvbShsaW5lcylcblx0XHRcdC5zbGljZSgwLCBhY3RpdmVMaW5lSW5kZXgpXG5cdFx0XHQucmVkdWNlKChhY2MsIGxpbmUpID0+IHtcblx0XHRcdFx0bGV0IHByb2Nlc3NlZExpbmUgPSBwcm9jZXNzTGluZShsaW5lKTtcblx0XHRcdFx0bGV0IHBhcnRzID0gcHJvY2Vzc2VkTGluZS5pbm5lclRleHQuc3BsaXQoXCJcdTIxOTdcIik7XG5cblx0XHRcdFx0bGV0IGxpbmVSZWZlcmVuY2VzID0gbGluZT8ucXVlcnlTZWxlY3RvckFsbChcIi5yZWZlcmVuY2UtZGF0YS1zcGFuXCIpO1xuXHRcdFx0XHRsZXQgbGluZVJlZmVyZW5jZXNEYXRhID0gQXJyYXkuZnJvbShsaW5lUmVmZXJlbmNlcyB8fCBbXSkubWFwKFxuXHRcdFx0XHRcdChzcGFuKSA9PiBcIltcdTIxOTddKHVybjpcIiArIHNwYW4uZ2V0QXR0cmlidXRlKFwiZGF0YVwiKSArIFwiKVwiXG5cdFx0XHRcdCk7XG5cdFx0XHRcdGxldCBhbGxTZXJpYWxpemVkVGV4dCA9XG5cdFx0XHRcdFx0Wy4uLnBhcnRzLCAuLi5saW5lUmVmZXJlbmNlc0RhdGFdLmpvaW4oXCJcIikgKyBcIlxcblwiO1xuXHRcdFx0XHRyZXR1cm4gYWxsU2VyaWFsaXplZFRleHQubGVuZ3RoICsgYWNjO1xuXHRcdFx0fSwgMCk7XG5cblx0XHQvLyBzZXQgcmFuZ2UgdG8gcmVwbGFjZSB3aXRoIG5ldyByZWZlcmVuY2Ugc2VyaWFsaXphdGlvblxuXHRcdGxldCBmcm9tID0gcHJldkxpbmVDaGFyQ291bnQgKyBzdGFydFRleHQuam9pbihcIlwiKS5sZW5ndGg7XG5cdFx0bGV0IHRvID0gZnJvbSArIHJlZmVyZW5jZS5sZW5ndGg7XG5cblx0XHRjb25zdCB0cmFuc2FjdGlvbiA9IHZpZXcuc3RhdGUudXBkYXRlKHtcblx0XHRcdGNoYW5nZXM6IHsgZnJvbSwgdG8sIGluc2VydDogY29udGVudFswXSB9LFxuXHRcdH0pO1xuXHRcdHZpZXcuZGlzcGF0Y2godHJhbnNhY3Rpb24pO1xuXHRcdGF3YWl0IHVwZGF0ZUJhY2tsaW5rTWFya1Bvc2l0aW9ucygpO1xuXG5cdFx0Ly8gYXdhaXQgdGhpcy51cGRhdGVOYW1lKHJlZmVyZW5jZSwgZnJvbSwgdG8pO1xuXHR9XG59XG5cbi8qIG5ldyBwbGFjZWhvbGRlciAqL1xuY2xhc3MgUmVmZXJlbmNlV2lkZ2V0IGV4dGVuZHMgV2lkZ2V0VHlwZSB7XG5cdGNvbnN0cnVjdG9yKFxuXHRcdHByaXZhdGUgbmFtZTogc3RyaW5nLFxuXHRcdHByaXZhdGUgdmlldzogRWRpdG9yVmlldyxcblx0XHRwcml2YXRlIHBvczogbnVtYmVyXG5cdCkge1xuXHRcdHN1cGVyKCk7XG5cdH1cblxuXHRlcShvdGhlcjogUmVmZXJlbmNlV2lkZ2V0KSB7XG5cdFx0cmV0dXJuIHRoaXMubmFtZSA9PT0gb3RoZXIubmFtZTtcblx0fVxuXG5cdGFzeW5jIHVwZGF0ZU5hbWUobmFtZTogc3RyaW5nLCBmcm9tOiBudW1iZXIsIHRvOiBudW1iZXIpIHtcblx0XHQvLyBjb25zdCB0cmFuc2FjdGlvbiA9IHRoaXMudmlldy5zdGF0ZS51cGRhdGUoe1xuXHRcdC8vIFx0Y2hhbmdlczogeyBmcm9tLCB0bywgaW5zZXJ0OiBuYW1lIH0sXG5cdFx0Ly8gfSk7XG5cdFx0Ly8gdGhpcy52aWV3LmRpc3BhdGNoKHRyYW5zYWN0aW9uKTtcblx0XHQvLyBhd2FpdCB1cGRhdGVCYWNrbGlua01hcmtQb3NpdGlvbnMoKTtcblx0XHR0aGlzLm5hbWUgPSBuYW1lO1xuXHR9XG5cblx0Z2V0VmlldygpIHtcblx0XHRyZXR1cm4gdGhpcy52aWV3O1xuXHR9XG5cblx0dG9ET00oKSB7XG5cdFx0Y29uc3QgcmVnZXggPSAvXFxbXHUyMTk3XFxdXFwodXJuOihbXildKilcXCkvZztcblx0XHRsZXQgY29udGVudCA9IHJlZ2V4LmV4ZWModGhpcy5uYW1lKTtcblx0XHRpZiAoIWNvbnRlbnQpIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgcmVmZXJlbmNlXCIpO1xuXG5cdFx0Y29uc3QgW3ByZWZpeCwgdGV4dCwgc3VmZml4LCBmaWxlLCBmcm9tLCB0bywgcG9ydGFsLCB0b2dnbGUgPSBcImZcIl0gPVxuXHRcdFx0Y29udGVudFsxXS5zcGxpdChcIjpcIik7XG5cblx0XHQvLyBoaWdobGlnaHREZWZhdWx0U2VsZWN0aW9uKHRoaXMudmlldywgcGFyc2VGbG9hdChmcm9tKSwgcGFyc2VGbG9hdCh0bykpO1xuXG5cdFx0Y29uc3QgeyBzcGFuLCBzdmcgfSA9IGNyZWF0ZVJlZmVyZW5jZUljb24oXG5cdFx0XHRwb3J0YWwgPT0gXCJwb3J0YWxcIiA/IFwiaW5saW5lIHJlZmVyZW5jZSB3aWRnZXQgfCp8XCIgOiBudWxsXG5cdFx0KTtcblxuXHRcdGlmIChjb250ZW50KSBzcGFuLnNldEF0dHJpYnV0ZShcImRhdGFcIiwgY29udGVudFsxXSk7XG5cblx0XHRjb25zdCBjb250YWluZXJTcGFuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XG5cdFx0Y29udGFpbmVyU3Bhbi5jbGFzc0xpc3QuYWRkKFwicmVmZXJlbmNlLWNvbnRhaW5lci1zcGFuXCIpO1xuXHRcdGNvbnN0IHJlZmVyZW5jZVNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTtcblx0XHQvLyBhZGQgY2xhc3Ncblx0XHRyZWZlcmVuY2VTcGFuLmNsYXNzTGlzdC5hZGQoXCJyZWZlcmVuY2Utc3BhblwiKTtcblxuXHRcdHJlZmVyZW5jZVNwYW4uaW5uZXJIVE1MID0gZGVjb2RlVVJJQ29tcG9uZW50U3RyaW5nKHRleHQpO1xuXHRcdHJlZmVyZW5jZVNwYW4uY2xhc3NMaXN0LnRvZ2dsZShcInJlZmVyZW5jZS1zcGFuLWhpZGRlblwiLCB0b2dnbGUgPT09IFwiZlwiKTtcblxuXHRcdGNvbnRhaW5lclNwYW4uYXBwZW5kQ2hpbGQocmVmZXJlbmNlU3Bhbik7XG5cdFx0Y29udGFpbmVyU3Bhbi5hcHBlbmRDaGlsZChzcGFuKTtcblxuXHRcdGNvbnRhaW5lclNwYW4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGFzeW5jIChldikgPT4ge1xuXHRcdFx0aWYgKGV2Lm1ldGFLZXkgfHwgZXYuY3RybEtleSkge1xuXHRcdFx0XHRhd2FpdCBzZXJpYWxpemVSZWZlcmVuY2UoY29udGVudCwgcmVmZXJlbmNlU3BhbiwgdGhpcy52aWV3KTtcblx0XHRcdFx0aWYgKGNvbnRlbnQpIHRoaXMubmFtZSA9IGNvbnRlbnRbMF07XG5cblx0XHRcdFx0Ly8gLy8gU2VyaWFsaXplIHRoZSB0b2dnbGUgc3RhdGUgZm9yIHJlZmVyZW5jZSBpbnRvIGZpbGVcblx0XHRcdFx0Ly8gLy8gS05PV04gRVJST1IuIGNvbnRlbnRET00gb25seSByZXR1cm5zIHBhcnRpYWwgZmlsZSBmb3IgZWZmaWNpZW5jeSBvbiBsYXJnZSBkb2N1bWVudHMuIFNvIHdpbGwgbG9zZSBzZXJpYWxpemF0aW9uIGluIHRoaXMgY2FzZS5cblx0XHRcdFx0Ly8gcmVmZXJlbmNlU3Bhbi5jbGFzc0xpc3QudG9nZ2xlKFwicmVmZXJlbmNlLXNwYW4taGlkZGVuXCIpO1xuXG5cdFx0XHRcdC8vIGxldCBuZXdUb2dnbGUgPSByZWZlcmVuY2VTcGFuLmNsYXNzTGlzdC5jb250YWlucyhcblx0XHRcdFx0Ly8gXHRcInJlZmVyZW5jZS1zcGFuLWhpZGRlblwiXG5cdFx0XHRcdC8vIClcblx0XHRcdFx0Ly8gXHQ/IFwiZlwiXG5cdFx0XHRcdC8vIFx0OiBcInRcIjtcblx0XHRcdFx0Ly8gbGV0IHJlZmVyZW5jZSA9IGBbXHUyMTk3XSh1cm46JHtwcmVmaXh9OiR7dGV4dH06JHtzdWZmaXh9OiR7ZmlsZX06JHtmcm9tfToke3RvfToke3BvcnRhbH06JHtuZXdUb2dnbGV9KWA7XG5cblx0XHRcdFx0Ly8gbGV0IGxpbmVzID0gdGhpcy5nZXRWaWV3KCkuY29udGVudERPTS5xdWVyeVNlbGVjdG9yQWxsKFwiLmNtLWxpbmVcIik7XG5cblx0XHRcdFx0Ly8gLy8gZ2V0IHRoZSBpbmRleCBvZiB0aGUgYWN0aXZlTGluZVxuXHRcdFx0XHQvLyBsZXQgYWN0aXZlTGluZUluZGV4O1xuXHRcdFx0XHQvLyBsZXQgc2VlbkFjdGl2ZSA9IGZhbHNlO1xuXHRcdFx0XHQvLyBsaW5lcy5mb3JFYWNoKChsaW5lLCBpKSA9PiB7XG5cdFx0XHRcdC8vIFx0aWYgKHNlZW5BY3RpdmUpIHJldHVybjtcblx0XHRcdFx0Ly8gXHRpZiAobGluZS5jbGFzc0xpc3QuY29udGFpbnMoXCJjbS1hY3RpdmVcIikpIHtcblx0XHRcdFx0Ly8gXHRcdHNlZW5BY3RpdmUgPSB0cnVlO1xuXHRcdFx0XHQvLyBcdFx0YWN0aXZlTGluZUluZGV4ID0gaTtcblx0XHRcdFx0Ly8gXHR9XG5cdFx0XHRcdC8vIH0pO1xuXG5cdFx0XHRcdC8vIC8vIGNvbnN0IGVkaXRvcjogRWRpdG9yIHwgdW5kZWZpbmVkID1cblx0XHRcdFx0Ly8gLy8gXHRnZXRUaGF0KCkud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KT8uZWRpdG9yO1xuXHRcdFx0XHQvLyAvLyBpZiAoIWVkaXRvcikgcmV0dXJuO1xuXHRcdFx0XHQvLyAvLyBjb25zdCBjdXJzb3IgPSBlZGl0b3IuZ2V0Q3Vyc29yKCk7XG5cdFx0XHRcdC8vIC8vIGNvbnNvbGUubG9nKGN1cnNvcik7XG5cdFx0XHRcdC8vIC8vIGNvbnNvbGUubG9nKGFjdGl2ZUxpbmVJbmRleCk7XG5cblx0XHRcdFx0Ly8gaWYgKGFjdGl2ZUxpbmVJbmRleCA9PT0gdW5kZWZpbmVkKSByZXR1cm47XG5cdFx0XHRcdC8vIGxldCBhY3RpdmVMaW5lID0gbGluZXNbYWN0aXZlTGluZUluZGV4XTtcblx0XHRcdFx0Ly8gLy8gbWFrZSBjb3B5IG9mIGFjdGl2ZUxpbmUgZWxlbWVudFxuXHRcdFx0XHQvLyBsZXQgYWN0aXZlTGluZUNvcHkgPSBwcm9jZXNzTGluZShhY3RpdmVMaW5lKTtcblx0XHRcdFx0Ly8gLy8gbm9uLXJlZmVyZW5jZWQgcGFydHMgb2YgdGhlIHRleHRcblx0XHRcdFx0Ly8gbGV0IHBhcnRzID0gYWN0aXZlTGluZUNvcHkuaW5uZXJUZXh0LnNwbGl0KFwiXHUyMTk3XCIpO1xuXG5cdFx0XHRcdC8vIC8vIGdldCBhbGwgcmVmZXJlbmNlc1xuXHRcdFx0XHQvLyBsZXQgbGluZVJlZmVyZW5jZXMgPSBhY3RpdmVMaW5lPy5xdWVyeVNlbGVjdG9yQWxsKFxuXHRcdFx0XHQvLyBcdFwiLnJlZmVyZW5jZS1kYXRhLXNwYW5cIlxuXHRcdFx0XHQvLyApO1xuXG5cdFx0XHRcdC8vIC8vIGdldCB0aGUgZnVsbCBzZXJpYWxpemVkIHZlcnNpb24gZm9yIHRoZXNlIHJlZmVyZW5jZXNcblx0XHRcdFx0Ly8gbGV0IGxpbmVSZWZlcmVuY2VzRGF0YSA9IEFycmF5LmZyb20obGluZVJlZmVyZW5jZXMgfHwgW10pLm1hcChcblx0XHRcdFx0Ly8gXHQoc3BhbikgPT4gXCJbXHUyMTk3XSh1cm46XCIgKyBzcGFuLmdldEF0dHJpYnV0ZShcImRhdGFcIikgKyBcIilcIlxuXHRcdFx0XHQvLyApO1xuXHRcdFx0XHQvLyBpZiAoY29udGVudCAmJiBjb250ZW50WzFdKSB7XG5cdFx0XHRcdC8vIFx0Ly8gaWRlbnRpZnkgd2hpY2ggcmVmZXJlbmNlIGlzIGJlaW5nIHRvZ2dsZWRcblx0XHRcdFx0Ly8gXHRsZXQgaW5kZXggPSBsaW5lUmVmZXJlbmNlc0RhdGEuaW5kZXhPZihjb250ZW50WzBdKTtcblx0XHRcdFx0Ly8gXHRpZiAoaW5kZXggPT0gLTEpIHRocm93IG5ldyBFcnJvcihcIlJlZmVyZW5jZSBub3QgZm91bmRcIik7XG5cblx0XHRcdFx0Ly8gXHQvLyBnZXQgdGhlIHRleHQgYmVmb3JlIHRoZSByZWZlcmVuY2Vcblx0XHRcdFx0Ly8gXHRsZXQgc3RhcnRUZXh0ID0gW1xuXHRcdFx0XHQvLyBcdFx0Li4ucGFydHMuc2xpY2UoMCwgaW5kZXggKyAxKSxcblx0XHRcdFx0Ly8gXHRcdC4uLmxpbmVSZWZlcmVuY2VzRGF0YS5zbGljZSgwLCBpbmRleCksXG5cdFx0XHRcdC8vIFx0XTtcblxuXHRcdFx0XHQvLyBcdC8vIGdldCBhbGwgdGhlIHByaW9yIGxpbmVzIHRvIGFjdGl2ZSBsaW5lIGFuZCB0aGUgbGVuZ3RoIG9mIHRoZSB0ZXh0XG5cdFx0XHRcdC8vIFx0bGV0IHByZXZMaW5lQ2hhckNvdW50ID0gQXJyYXkuZnJvbShsaW5lcylcblx0XHRcdFx0Ly8gXHRcdC5zbGljZSgwLCBhY3RpdmVMaW5lSW5kZXgpXG5cdFx0XHRcdC8vIFx0XHQucmVkdWNlKChhY2MsIGxpbmUpID0+IHtcblx0XHRcdFx0Ly8gXHRcdFx0bGV0IHByb2Nlc3NlZExpbmUgPSBwcm9jZXNzTGluZShsaW5lKTtcblx0XHRcdFx0Ly8gXHRcdFx0bGV0IHBhcnRzID0gcHJvY2Vzc2VkTGluZS5pbm5lclRleHQuc3BsaXQoXCJcdTIxOTdcIik7XG5cblx0XHRcdFx0Ly8gXHRcdFx0bGV0IGxpbmVSZWZlcmVuY2VzID0gbGluZT8ucXVlcnlTZWxlY3RvckFsbChcblx0XHRcdFx0Ly8gXHRcdFx0XHRcIi5yZWZlcmVuY2UtZGF0YS1zcGFuXCJcblx0XHRcdFx0Ly8gXHRcdFx0KTtcblx0XHRcdFx0Ly8gXHRcdFx0bGV0IGxpbmVSZWZlcmVuY2VzRGF0YSA9IEFycmF5LmZyb20obGluZVJlZmVyZW5jZXMgfHwgW10pLm1hcChcblx0XHRcdFx0Ly8gXHRcdFx0XHQoc3BhbikgPT4gXCJbXHUyMTk3XSh1cm46XCIgKyBzcGFuLmdldEF0dHJpYnV0ZShcImRhdGFcIikgKyBcIilcIlxuXHRcdFx0XHQvLyBcdFx0XHQpO1xuXHRcdFx0XHQvLyBcdFx0XHRsZXQgYWxsU2VyaWFsaXplZFRleHQgPVxuXHRcdFx0XHQvLyBcdFx0XHRcdFsuLi5wYXJ0cywgLi4ubGluZVJlZmVyZW5jZXNEYXRhXS5qb2luKFwiXCIpICsgXCJcXG5cIjtcblx0XHRcdFx0Ly8gXHRcdFx0cmV0dXJuIGFsbFNlcmlhbGl6ZWRUZXh0Lmxlbmd0aCArIGFjYztcblx0XHRcdFx0Ly8gXHRcdH0sIDApO1xuXG5cdFx0XHRcdC8vIFx0Ly8gc2V0IHJhbmdlIHRvIHJlcGxhY2Ugd2l0aCBuZXcgcmVmZXJlbmNlIHNlcmlhbGl6YXRpb25cblx0XHRcdFx0Ly8gXHRsZXQgZnJvbSA9IHByZXZMaW5lQ2hhckNvdW50ICsgc3RhcnRUZXh0LmpvaW4oXCJcIikubGVuZ3RoO1xuXHRcdFx0XHQvLyBcdGxldCB0byA9IGZyb20gKyByZWZlcmVuY2UubGVuZ3RoO1xuXG5cdFx0XHRcdC8vIFx0YXdhaXQgdGhpcy51cGRhdGVOYW1lKHJlZmVyZW5jZSwgZnJvbSwgdG8pO1xuXHRcdFx0XHQvLyB9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRvcGVuUmVmZXJlbmNlKGV2KTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHJldHVybiBjb250YWluZXJTcGFuO1xuXHR9XG59XG5cbmNvbnN0IHJlZmVyZW5jZURlY29yYXRpb24gPSAoXG5cdG1hdGNoOiBSZWdFeHBFeGVjQXJyYXksXG5cdHZpZXc6IEVkaXRvclZpZXcsXG5cdHBvczogbnVtYmVyXG4pID0+IHtcblx0bGV0IGRlY29yYXRpb24gPSBEZWNvcmF0aW9uLnJlcGxhY2Uoe1xuXHRcdHdpZGdldDogbmV3IFJlZmVyZW5jZVdpZGdldChtYXRjaFswXSwgdmlldywgcG9zKSxcblx0fSk7XG5cdHJldHVybiBkZWNvcmF0aW9uO1xufTtcblxuY29uc3QgcmVmZXJlbmNlTWF0Y2hlciA9IG5ldyBNYXRjaERlY29yYXRvcih7XG5cdC8vIHJlZ2V4cDogL1xcW1xcdTIxOTdcXF1cXCh1cm46W1xcc1xcU15cXCldKlxcKS9nLFxuXHQvLyByZWdleHA6IC9cXFtcXHUyMTk3XFxdXFwodXJuOihbXjpdKjopezUsNn1bXjpdKlxcKS9nLFxuXHQvLyByZWdleHA6IC9cXFtcXHUyMTk3XFxdXFwodXJuOihbXjpdKjopezZ9W146KV0qXFwpL2csXG5cdHJlZ2V4cDogL1xcW1xcdTIxOTdcXF1cXCh1cm46KFteOl0qOil7N31bXjopXSpcXCkvZyxcblx0ZGVjb3JhdGlvbjogKG1hdGNoLCB2aWV3LCBwb3MpID0+IHtcblx0XHRyZXR1cm4gcmVmZXJlbmNlRGVjb3JhdGlvbihtYXRjaCwgdmlldywgcG9zKTtcblx0fSxcbn0pO1xuXG5leHBvcnQgY29uc3QgcmVmZXJlbmNlUmVzb3VyY2VzID0gVmlld1BsdWdpbi5mcm9tQ2xhc3MoXG5cdGNsYXNzIHtcblx0XHRyZWZlcmVuY2VSZXNvdXJjZXM6IERlY29yYXRpb25TZXQ7XG5cdFx0Y29uc3RydWN0b3IodmlldzogRWRpdG9yVmlldykge1xuXHRcdFx0dGhpcy5yZWZlcmVuY2VSZXNvdXJjZXMgPSByZWZlcmVuY2VNYXRjaGVyLmNyZWF0ZURlY28odmlldyk7XG5cdFx0fVxuXHRcdHVwZGF0ZSh1cGRhdGU6IFZpZXdVcGRhdGUpIHtcblx0XHRcdHRoaXMucmVmZXJlbmNlUmVzb3VyY2VzID0gcmVmZXJlbmNlTWF0Y2hlci51cGRhdGVEZWNvKFxuXHRcdFx0XHR1cGRhdGUsXG5cdFx0XHRcdHRoaXMucmVmZXJlbmNlUmVzb3VyY2VzXG5cdFx0XHQpO1xuXHRcdH1cblx0XHRkZXN0cm95KCkge1xuXHRcdFx0dGhpcy5yZWZlcmVuY2VSZXNvdXJjZXMgPSBEZWNvcmF0aW9uLm5vbmU7XG5cdFx0fVxuXHR9LFxuXHR7XG5cdFx0ZGVjb3JhdGlvbnM6IChpbnN0YW5jZSkgPT4gaW5zdGFuY2UucmVmZXJlbmNlUmVzb3VyY2VzLFxuXHRcdHByb3ZpZGU6IChwbHVnaW4pID0+XG5cdFx0XHRFZGl0b3JWaWV3LmF0b21pY1Jhbmdlcy5vZigodmlldykgPT4ge1xuXHRcdFx0XHRyZXR1cm4gdmlldy5wbHVnaW4ocGx1Z2luKT8ucmVmZXJlbmNlUmVzb3VyY2VzIHx8IERlY29yYXRpb24ubm9uZTtcblx0XHRcdH0pLFxuXHR9XG4pO1xuIiwgImltcG9ydCB7IEVkaXRvciwgVEZpbGUsIFdvcmtzcGFjZUxlYWYsIE1hcmtkb3duVmlldyB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgRWRpdG9yVmlldywgc2Nyb2xsUGFzdEVuZCB9IGZyb20gXCJAY29kZW1pcnJvci92aWV3XCI7XG5pbXBvcnQgeyB2NSBhcyB1dWlkdjUgfSBmcm9tIFwidXVpZFwiO1xuXG5pbXBvcnQge1xuXHRzdGF0ZSxcblx0dXBkYXRlSG92ZXIsXG5cdGdldFRoYXQsXG5cdGdldEJhY2tsaW5rcyxcblx0dXBkYXRlQmFja2xpbmtzLFxuXHR1cGRhdGVDdXJzb3IsXG5cdGdldEN1cnNvcixcblx0Z2V0SG92ZXIsXG5cdHJlc2V0Q3Vyc29yLFxuXHR1cGRhdGVIb3ZlcmVkQ3Vyc29yLFxuXHR1cGRhdGVCYWNrbGlua0hvdmVyLFxuXHRnZXRCYWNrbGlua0hvdmVyLFxufSBmcm9tIFwiLi9zdGF0ZVwiO1xuaW1wb3J0IHtcblx0cHJvY2Vzc1VSSSxcblx0Z2V0UHJlZml4QW5kU3VmZml4LFxuXHRoYW5kbGVSZW1vdmVIb3ZlcmVkQ3Vyc29yLFxuXHRlbmNvZGVVUklDb21wb25lbnRTdHJpbmcsXG5cdGRlY29kZVVSSUNvbXBvbmVudFN0cmluZyxcbn0gZnJvbSBcIi4vdXRpbHNcIjtcbmltcG9ydCB7XG5cdEFDVElPTl9UWVBFLFxuXHRQT1JUQUxfVEVYVF9TTElDRV9TSVpFLFxuXHRSRUZFUkVOQ0VfSUNPTl9IRUlHSFQsXG5cdFJFRkVSRU5DRV9SRUdFWCxcblx0U1ZHX0hPVkVSX0NPTE9SLFxufSBmcm9tIFwiLi9jb25zdGFudHNcIjtcbmltcG9ydCB7IERvY3VtZW50TG9jYXRpb24sIEJhY2tsaW5rIH0gZnJvbSBcIi4vdHlwZXNcIjtcbmltcG9ydCB7IHY0IGFzIHV1aWR2NCB9IGZyb20gXCJ1dWlkXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVSZWZlcmVuY2VJY29uKHBvcnRhbFRleHQ6IHN0cmluZyB8IG51bGwgPSBudWxsKToge1xuXHRzcGFuOiBIVE1MU3BhbkVsZW1lbnQ7XG5cdHN2ZzogU1ZHRWxlbWVudDtcbn0ge1xuXHRjb25zdCBzcGFuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XG5cdHNwYW4uc3R5bGUuY3Vyc29yID0gXCJwb2ludGVyXCI7XG5cdHNwYW4uY2xhc3NMaXN0LmFkZChcInJlZmVyZW5jZS1kYXRhLXNwYW5cIik7XG5cdHNwYW4uY2xhc3NMaXN0LmFkZChcInV1aWQtXCIgKyB1dWlkdjQoKSk7XG5cblx0Y29uc3QgaGVpZ2h0ID0gUkVGRVJFTkNFX0lDT05fSEVJR0hUO1xuXHRjb25zdCB3aWR0aCA9IGhlaWdodCAqIDAuOTtcblxuXHRpZiAocG9ydGFsVGV4dCA9PSBudWxsKSB7XG5cdFx0Y29uc3Qgc3ZnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiwgXCJzdmdcIik7XG5cdFx0Ly8gc3ZnLnNldEF0dHJpYnV0ZShcIndpZHRoXCIsIGAke3dpZHRofWApO1xuXHRcdC8vIHN2Zy5zZXRBdHRyaWJ1dGUoXCJoZWlnaHRcIiwgYCR7aGVpZ2h0fWApO1xuXHRcdC8vIHN2Zy5zZXRBdHRyaWJ1dGUoXCJ2aWV3Qm94XCIsIGAwIDAgJHt3aWR0aH0gJHtoZWlnaHR9YCk7XG5cdFx0Ly8gc3ZnLnNldEF0dHJpYnV0ZShcImZpbGxcIiwgXCJ3aGl0ZVwiKTtcblx0XHQvLyBzdmcuc2V0QXR0cmlidXRlKFwieG1sbnNcIiwgXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiKTtcblx0XHQvLyBzdmcuc3R5bGUuYm9yZGVyID0gXCIzcHggc29saWQgZ3JleVwiO1xuXHRcdC8vIHN2Zy5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIndoaXRlXCI7XG5cdFx0Ly8gc3ZnLnN0eWxlLmJvcmRlclJhZGl1cyA9IFwiM3B4XCI7XG5cdFx0Ly8gc3ZnLnN0eWxlLmN1cnNvciA9IFwicG9pbnRlclwiO1xuXHRcdC8vIHN2Zy5jbGFzc0xpc3QuYWRkKFwicmVmZXJlbmNlLWljb25cIik7XG5cblx0XHQvLyBjb25zdCBsaW5lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiwgXCJsaW5lXCIpO1xuXHRcdC8vIGxpbmUuc2V0QXR0cmlidXRlKFwieDFcIiwgXCIzXCIpO1xuXHRcdC8vIGxpbmUuc2V0QXR0cmlidXRlKFwieTFcIiwgYCR7KGhlaWdodCAtIDMpIC8gM31gKTtcblx0XHQvLyBsaW5lLnNldEF0dHJpYnV0ZShcIngyXCIsIFwiMTJcIik7XG5cdFx0Ly8gbGluZS5zZXRBdHRyaWJ1dGUoXCJ5MlwiLCBgJHsoaGVpZ2h0IC0gMykgLyAzfWApO1xuXHRcdC8vIGxpbmUuc2V0QXR0cmlidXRlKFwic3Ryb2tlLXdpZHRoXCIsIFwiMlwiKTsgLy8gU2V0IHRoZSBzdHJva2Ugd2VpZ2h0IHRvIDFcblx0XHQvLyBsaW5lLnNldEF0dHJpYnV0ZShcInN0cm9rZVwiLCBcImdyZXlcIik7IC8vIFNldCB0aGUgc3Ryb2tlIGNvbG9yIHRvIGJsYWNrXG5cblx0XHQvLyBzdmcuYXBwZW5kQ2hpbGQobGluZSk7XG5cblx0XHQvLyBjb25zdCBsaW5lMiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyhcblx0XHQvLyBcdFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIixcblx0XHQvLyBcdFwibGluZVwiXG5cdFx0Ly8gKTtcblx0XHQvLyBsaW5lMi5zZXRBdHRyaWJ1dGUoXCJ4MVwiLCBcIjNcIik7XG5cdFx0Ly8gbGluZTIuc2V0QXR0cmlidXRlKFwieTFcIiwgYCR7KChoZWlnaHQgLSAzKSAvIDMpICogMn1gKTtcblx0XHQvLyBsaW5lMi5zZXRBdHRyaWJ1dGUoXCJ4MlwiLCBcIjE1XCIpO1xuXHRcdC8vIGxpbmUyLnNldEF0dHJpYnV0ZShcInkyXCIsIGAkeygoaGVpZ2h0IC0gMykgLyAzKSAqIDJ9YCk7XG5cdFx0Ly8gbGluZTIuc2V0QXR0cmlidXRlKFwic3Ryb2tlLXdpZHRoXCIsIFwiMlwiKTsgLy8gU2V0IHRoZSBzdHJva2Ugd2VpZ2h0IHRvIDFcblx0XHQvLyBsaW5lMi5zZXRBdHRyaWJ1dGUoXCJzdHJva2VcIiwgXCJncmV5XCIpOyAvLyBTZXQgdGhlIHN0cm9rZSBjb2xvciB0byBibGFja1xuXG5cdFx0Ly8gc3ZnLmFwcGVuZENoaWxkKGxpbmUyKTtcblxuXHRcdC8vIGNvbnN0IGxpbmUzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKFxuXHRcdC8vIFx0XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiLFxuXHRcdC8vIFx0XCJsaW5lXCJcblx0XHQvLyApO1xuXHRcdC8vIGxpbmUzLnNldEF0dHJpYnV0ZShcIngxXCIsIFwiM1wiKTtcblx0XHQvLyBsaW5lMy5zZXRBdHRyaWJ1dGUoXCJ5MVwiLCBgJHsoKGhlaWdodCAtIDMpIC8gMykgKiAzfWApO1xuXHRcdC8vIGxpbmUzLnNldEF0dHJpYnV0ZShcIngyXCIsIFwiMTBcIik7XG5cdFx0Ly8gbGluZTMuc2V0QXR0cmlidXRlKFwieTJcIiwgYCR7KChoZWlnaHQgLSAzKSAvIDMpICogM31gKTtcblx0XHQvLyBsaW5lMy5zZXRBdHRyaWJ1dGUoXCJzdHJva2Utd2lkdGhcIiwgXCIyXCIpOyAvLyBTZXQgdGhlIHN0cm9rZSB3ZWlnaHQgdG8gMVxuXHRcdC8vIGxpbmUzLnNldEF0dHJpYnV0ZShcInN0cm9rZVwiLCBcImdyZXlcIik7IC8vIFNldCB0aGUgc3Ryb2tlIGNvbG9yIHRvIGJsYWNrXG5cblx0XHQvLyBzdmcuYXBwZW5kQ2hpbGQobGluZTMpO1xuXG5cdFx0Ly8gc3Bhbi5hcHBlbmRDaGlsZChzdmcpO1xuXHRcdHJldHVybiB7IHNwYW46IHNwYW4sIHN2ZyB9O1xuXHR9XG5cblx0Y29uc3Qgc3ZnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiwgXCJzdmdcIik7XG5cdC8vIHN2Zy5zZXRBdHRyaWJ1dGUoXCJ3aWR0aFwiLCBgJHt3aWR0aH1gKTtcblx0Ly8gc3ZnLnNldEF0dHJpYnV0ZShcImhlaWdodFwiLCBgJHtoZWlnaHR9YCk7XG5cdC8vIHN2Zy5zZXRBdHRyaWJ1dGUoXCJ2aWV3Qm94XCIsIGAwIDAgJHt3aWR0aH0gJHtoZWlnaHR9YCk7XG5cdC8vIHN2Zy5zZXRBdHRyaWJ1dGUoXCJmaWxsXCIsIFwid2hpdGVcIik7XG5cdC8vIHN2Zy5zZXRBdHRyaWJ1dGUoXCJ4bWxuc1wiLCBcImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIpO1xuXHQvLyAvLyBzdmcuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCJ3aGl0ZVwiO1xuXHQvLyBzdmcuY2xhc3NMaXN0LmFkZChcInBvcnRhbC1pY29uXCIpO1xuXG5cdC8vIC8vIDxwYXRoIGQ9XCJNNCA2SDEzTTQgMTBIMTRNMy45OTY0MyAxLjAwMDM3QzcuMDg1MyAwLjk5OTkyMyAxMS4xNjE4IDAuOTk5ODgxIDE0LjAwNDMgMS4wMDAyNUMxNS42NjAzIDEuMDAwNDYgMTcgMi4zNDMxNSAxNyAzLjk5OTIzVjExLjM2MDFDMTcgMTIuOTk1MSAxNS42OTA5IDE0LjMyNzYgMTQuMDU2MyAxNC4zNTgyTDcuMzQzMDEgMTQuNDg0MkM2Ljc5MTY4IDE0LjQ5NDUgNi4yNTM4NyAxNC42NTY2IDUuNzg4NjYgMTQuOTUyN0wyLjUzNjg4IDE3LjAyMkMxLjg3MTE1IDE3LjQ0NTYgMSAxNi45Njc0IDEgMTYuMTc4M1YzLjk5OTkzQzEgMi4zNDM1MSAyLjM0MDAxIDEuMDAwNiAzLjk5NjQzIDEuMDAwMzdaXCIgc3Ryb2tlPVwiYmxhY2tcIiBzdHJva2Utd2lkdGg9XCIyXCIvPlxuXHQvLyBjb25zdCBwYXRoID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiwgXCJwYXRoXCIpO1xuXHQvLyBwYXRoLnNldEF0dHJpYnV0ZShcblx0Ly8gXHRcImRcIixcblx0Ly8gXHRcIk00IDZIMTNNNCAxMEgxNE0zLjk5NjQzIDEuMDAwMzdDNy4wODUzIDAuOTk5OTIzIDExLjE2MTggMC45OTk4ODEgMTQuMDA0MyAxLjAwMDI1QzE1LjY2MDMgMS4wMDA0NiAxNyAyLjM0MzE1IDE3IDMuOTk5MjNWMTEuMzYwMUMxNyAxMi45OTUxIDE1LjY5MDkgMTQuMzI3NiAxNC4wNTYzIDE0LjM1ODJMNy4zNDMwMSAxNC40ODQyQzYuNzkxNjggMTQuNDk0NSA2LjI1Mzg3IDE0LjY1NjYgNS43ODg2NiAxNC45NTI3TDIuNTM2ODggMTcuMDIyQzEuODcxMTUgMTcuNDQ1NiAxIDE2Ljk2NzQgMSAxNi4xNzgzVjMuOTk5OTNDMSAyLjM0MzUxIDIuMzQwMDEgMS4wMDA2IDMuOTk2NDMgMS4wMDAzN1pcIlxuXHQvLyApO1xuXHQvLyBwYXRoLnNldEF0dHJpYnV0ZShcInN0cm9rZVwiLCBcImdyYXlcIik7XG5cdC8vIHBhdGguc2V0QXR0cmlidXRlKFwic3Ryb2tlLXdpZHRoXCIsIFwiMlwiKTtcblxuXHQvLyBzcGFuLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiXCI7XG5cblx0Ly8gc3ZnLmFwcGVuZENoaWxkKHBhdGgpO1xuXG5cdC8vIHNwYW4uYXBwZW5kQ2hpbGQoc3ZnKTtcblxuXHRpZiAocG9ydGFsVGV4dCAhPSBcImlubGluZSByZWZlcmVuY2Ugd2lkZ2V0IHwqfFwiKSB7XG5cdFx0bGV0IHBvcnRhbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0Ly8gcG9ydGFsLnN0eWxlLmNvbG9yID0gXCJibGFja1wiO1xuXHRcdHBvcnRhbC5jbGFzc0xpc3QuYWRkKFwicG9ydGFsXCIpO1xuXG5cdFx0cG9ydGFsVGV4dC5zcGxpdChcIjpcIikuZm9yRWFjaCgodGV4dCwgaW5kZXgpID0+IHtcblx0XHRcdGlmIChpbmRleCA9PT0gMCB8fCBpbmRleCA9PT0gMilcblx0XHRcdFx0cG9ydGFsLmlubmVySFRNTCArPSBkZWNvZGVVUklDb21wb25lbnRTdHJpbmcodGV4dCk7XG5cdFx0XHRlbHNlIGlmIChpbmRleCA9PT0gMSkge1xuXHRcdFx0XHRwb3J0YWwuaW5uZXJIVE1MICs9IGA8c3BhbiBjbGFzcz1cInRleHQtYWNjZW50XCI7PiR7dGV4dH08L3NwYW4+YDtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdC8vIHNwYW4uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCJ3aGl0ZVwiO1xuXHRcdHBvcnRhbC5zdHlsZS51c2VyU2VsZWN0ID0gXCJub25lXCI7XG5cdFx0cG9ydGFsLnN0eWxlLnBvaW50ZXJFdmVudHMgPSBcIm5vbmVcIjtcblx0XHRzcGFuLmFwcGVuZENoaWxkKHBvcnRhbCk7XG5cdH1cblxuXHRyZXR1cm4geyBzcGFuOiBzcGFuLCBzdmcgfTtcblxuXHQvLyBsZXQgbmV3U3BhbjogSFRNTFNwYW5FbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XG5cdC8vIG5ld1NwYW4uaW5uZXJIVE1MID0gXCJcdUQ4M0RcdURDQzRcIjtcblx0Ly8gbmV3U3Bhbi5zdHlsZS5jdXJzb3IgPSBcInBvaW50ZXJcIjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZUhvdmVyZWRDdXJzb3JDb2xvcihzcGFuOiBIVE1MU3BhbkVsZW1lbnQsIHVzZXI6IHN0cmluZykge1xuXHQvLyByZW1vdmUgZXhpc3RpbmcgY3Vyc29yc1xuXHRjb25zdCBzdmcgPSBzcGFuLnF1ZXJ5U2VsZWN0b3IoXCJzdmdcIik7XG5cdGNvbnN0IHBvcnRhbDogSFRNTEVsZW1lbnQgfCBudWxsID0gc3Bhbi5xdWVyeVNlbGVjdG9yKFwiLnBvcnRhbFwiKTtcblxuXHRpZiAoc3BhbiAmJiBzdmcgJiYgIXBvcnRhbCkge1xuXHRcdGhhbmRsZVJlbW92ZUhvdmVyZWRDdXJzb3IodXNlcik7IC8vIHJlbW92ZSBhbnkgZXhpc3RpbmcgaG92ZXJlZCByZWZlcmVuY2UgaWNvblxuXHRcdGlmIChzdmcuY2xhc3NMaXN0LmNvbnRhaW5zKFwicmVmZXJlbmNlLWljb25cIikpXG5cdFx0XHRzdmcuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gU1ZHX0hPVkVSX0NPTE9SO1xuXHRcdGVsc2Uge1xuXHRcdFx0Ly8gc3ZnLnNldEF0dHJpYnV0ZShcImZpbGxcIiwgU1ZHX0hPVkVSX0NPTE9SKTtcblx0XHRcdHNwYW4gPSBzcGFuLnF1ZXJ5U2VsZWN0b3IoXCJzcGFuXCIpIGFzIEhUTUxTcGFuRWxlbWVudDtcblx0XHRcdHNwYW4uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gU1ZHX0hPVkVSX0NPTE9SO1xuXHRcdH1cblxuXHRcdHVwZGF0ZUhvdmVyZWRDdXJzb3Ioc3ZnLCB1c2VyKTsgLy8gYWRkIHRoZSBjdXJyZW50bHkgaG92ZXJlZCByZWZlcmVuY2UgaWNvblxuXHR9XG59XG5cbmZ1bmN0aW9uIGdldENvZGVNaXJyb3JFZGl0b3JWaWV3KGVkaXRvcjogRWRpdG9yKTogRWRpdG9yVmlldyB7XG5cdC8vIEB0cy1pZ25vcmUgdGhpcyB0eXBlIGlzIG1pc3NpbmcuLi4gYnV0IHRoZSBPYnNpZGlhbiBkb2NzIHRlbGwgdXMgdG8gZG8gaXQgdGhpcyB3YXk/P1xuXHRyZXR1cm4gZWRpdG9yLmNtIGFzIEVkaXRvclZpZXc7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDb250YWluZXJFbGVtZW50KFxuXHRlZGl0b3JPckxlYWY6IEVkaXRvciB8IFdvcmtzcGFjZUxlYWZcbik6IEhUTUxFbGVtZW50IHtcblx0Ly8gQHRzLWlnbm9yZSBUT0RPOiBmaW5kIGEgYmV0dGVyIHdheSB0byBhY2Nlc3MgdGhpcy4uLiBFWFRSRU1FTFkgU0tFVENIWVxuXHRyZXR1cm4gZWRpdG9yT3JMZWFmLmNvbnRhaW5lckVsO1xufVxuXG5mdW5jdGlvbiBnZXRCYWNrbGlua0lEKGJhY2tsaW5rOiBCYWNrbGluayk6IHN0cmluZyB7XG5cdGNvbnN0IGpzb25TdHJpbmcgPSBKU09OLnN0cmluZ2lmeShiYWNrbGluayk7XG5cdGNvbnN0IGlkID0gdXVpZHY1KGpzb25TdHJpbmcsIFwiZmI4MTNlYmItMWI1My00MzA2LWFhOWMtNjU1NjI3NDQ3ZjBiXCIpO1xuXHRyZXR1cm4gYGJhY2tsaW5rLSR7aWR9YDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEJhY2tsaW5rQ29udGFpbmVyKGVkaXRvcjogRWRpdG9yKTogSFRNTEVsZW1lbnQge1xuXHRjb25zdCBjb250YWluZXJFbDogSFRNTEVsZW1lbnQgPSBnZXRDb250YWluZXJFbGVtZW50KGVkaXRvcik7XG5cdGNvbnN0IHJlZmVyZW5jZU1hcmtDb250YWluZXJJRCA9IFwicmVmZXJlbmNlTWFya0NvbnRhaW5lclwiO1xuXHRjb25zdCBjb250YWluZXIgPSBjb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKGAjJHtyZWZlcmVuY2VNYXJrQ29udGFpbmVySUR9YCk7XG5cdGlmIChjb250YWluZXIpIHtcblx0XHRyZXR1cm4gY29udGFpbmVyIGFzIEhUTUxFbGVtZW50O1xuXHR9IGVsc2Uge1xuXHRcdGNvbnN0IG5ld0NvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0bmV3Q29udGFpbmVyLmlkID0gcmVmZXJlbmNlTWFya0NvbnRhaW5lcklEO1xuXHRcdGNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoXCIuY20tc2Nyb2xsZXJcIikhLmFwcGVuZENoaWxkKG5ld0NvbnRhaW5lcik7XG5cdFx0cmV0dXJuIG5ld0NvbnRhaW5lcjtcblx0fVxufVxuXG5mdW5jdGlvbiBnZXRSZWZlcmVuY2VNYXJrcyhlZGl0b3I6IEVkaXRvcik6IEhUTUxFbGVtZW50W10ge1xuXHRjb25zdCBjb250YWluZXIgPSBnZXRCYWNrbGlua0NvbnRhaW5lcihlZGl0b3IpO1xuXHRjb25zdCBlbGVtZW50czogSFRNTEVsZW1lbnRbXSA9IFtdO1xuXHRmb3IgKGxldCBpID0gMDsgaSA8IGNvbnRhaW5lci5jaGlsZHJlbi5sZW5ndGg7IGkrKykge1xuXHRcdGVsZW1lbnRzLnB1c2goY29udGFpbmVyLmNoaWxkcmVuLml0ZW0oaSkgYXMgSFRNTEVsZW1lbnQpO1xuXHR9XG5cdHJldHVybiBlbGVtZW50cztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldExlYWZCQm94RWxlbWVudHMobGVhZjogV29ya3NwYWNlTGVhZikge1xuXHRjb25zdCB0aXRsZSA9IGdldENvbnRhaW5lckVsZW1lbnQobGVhZikucXVlcnlTZWxlY3RvcihcIi5pbmxpbmUtdGl0bGVcIik7XG5cdGlmICghdGl0bGUpIHtcblx0XHR0aHJvdyBuZXcgRXJyb3IoXCJNaXNzaW5nIHRpdGxlXCIpO1xuXHR9XG5cdGNvbnN0IHRpdGxlQmJveCA9IHRpdGxlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXHRjb25zdCBsaW5lID0gZ2V0Q29udGFpbmVyRWxlbWVudChsZWFmKS5xdWVyeVNlbGVjdG9yKFwiLmNtLWxpbmVcIik7XG5cdGlmICghbGluZSkge1xuXHRcdHRocm93IG5ldyBFcnJvcihcIkRvY3VtZW50IGhhcyBubyBsaW5lc1wiKTtcblx0fVxuXHRjb25zdCBsaW5lQmJveCA9IGxpbmUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cblx0cmV0dXJuIHsgdGl0bGVCYm94LCBsaW5lQmJveCB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlQmFja2xpbmtNYXJrUG9zaXRpb24oXG5cdGxlYWY6IFdvcmtzcGFjZUxlYWYsXG5cdGJhY2tsaW5rc1RvTGVhZjogQmFja2xpbmtbXSxcblx0c2hvd1BvcnRhbHM6IGJvb2xlYW5cbikge1xuXHRjb25zdCBlZGl0b3IgPSBnZXRNYXJrZG93blZpZXcobGVhZikuZWRpdG9yO1xuXHRjb25zdCBiYWNrbGlua0NvbnRhaW5lciA9IGdldEJhY2tsaW5rQ29udGFpbmVyKGVkaXRvcik7XG5cblx0bGV0IGJhY2tsaW5rcyA9IFtdO1xuXHRmb3IgKGxldCBpID0gMDsgaSA8IGJhY2tsaW5rQ29udGFpbmVyLmNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG5cdFx0YmFja2xpbmtzLnB1c2goYmFja2xpbmtDb250YWluZXIuY2hpbGRyZW4uaXRlbShpKSBhcyBIVE1MRWxlbWVudCk7XG5cdH1cblx0bGV0IGJhY2tsaW5rSWRzOiBzdHJpbmdbXSA9IGJhY2tsaW5rc1RvTGVhZi5tYXAoKHgpID0+IGdldEJhY2tsaW5rSUQoeCkpO1xuXG5cdGJhY2tsaW5rc1xuXHRcdC5tYXAoKHg6IEhUTUxTcGFuRWxlbWVudCkgPT4geC5pZClcblx0XHQuZm9yRWFjaCgoaWQpID0+IHtcblx0XHRcdGlmICghYmFja2xpbmtJZHMuaW5jbHVkZXMoaWQpKSB7XG5cdFx0XHRcdGxldCBlbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpO1xuXHRcdFx0XHRpZiAoZWxlbWVudCkgZWxlbWVudC5yZW1vdmUoKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRjb25zdCB7IHRpdGxlQmJveCwgbGluZUJib3ggfSA9IGdldExlYWZCQm94RWxlbWVudHMobGVhZik7XG5cblx0Ly8gQ3JlYXRlIHRoZSBpbml0aWFsIGJhY2tsaW5rIG1hcmsgaWYgbmVjZXNzYXJ5IGFuZCBwb3NpdGlvbiBpdCBpbiB0aGUgY29ycmVjdCB2ZXJ0aWNhbCBwb3NpdGlvblxuXHRsZXQgcmVmZXJlbmNlTWFya2VycyA9IGJhY2tsaW5rc1RvTGVhZi5tYXAoKGJhY2tsaW5rKSA9PiB7XG5cdFx0Y29uc3QgeyBmcm9tIH0gPSBiYWNrbGluay5yZWZlcmVuY2VkTG9jYXRpb247XG5cblx0XHRjb25zdCBiYm94ID0gZ2V0Q29kZU1pcnJvckVkaXRvclZpZXcoZWRpdG9yKS5jb29yZHNBdFBvcyhmcm9tKTtcblx0XHRpZiAoIWJib3gpIHJldHVybjtcblxuXHRcdGxldCByZWZlcmVuY2VNYXJrZXIgPSBiYWNrbGlua0NvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFxuXHRcdFx0YCMke2dldEJhY2tsaW5rSUQoYmFja2xpbmspfWBcblx0XHQpIGFzIEhUTUxFbGVtZW50IHwgbnVsbDtcblxuXHRcdGlmIChyZWZlcmVuY2VNYXJrZXIgPT09IG51bGwpIHtcblx0XHRcdHJlZmVyZW5jZU1hcmtlciA9IGNyZWF0ZUJhY2tsaW5rTWFyayhiYWNrbGluayk7XG5cdFx0XHRiYWNrbGlua0NvbnRhaW5lci5hcHBlbmRDaGlsZChyZWZlcmVuY2VNYXJrZXIpO1xuXHRcdH1cblxuXHRcdGlmIChiYm94KSB7XG5cdFx0XHRyZWZlcmVuY2VNYXJrZXIuc3R5bGUucG9zaXRpb24gPSBcImFic29sdXRlXCI7XG5cblx0XHRcdHJlZmVyZW5jZU1hcmtlci5zZXRBdHRyaWJ1dGUoXCJ0b3BcIiwgYmJveC50b3AudG9TdHJpbmcoKSk7XG5cdFx0XHRyZWZlcmVuY2VNYXJrZXIuc3R5bGUudG9wID0gYmJveC50b3AgLSB0aXRsZUJib3gudG9wICsgMzIgKyBcInB4XCI7XG5cdFx0XHRyZWZlcmVuY2VNYXJrZXIuc3R5bGUubGVmdCA9IGxpbmVCYm94LndpZHRoICsgNDAgKyBcInB4XCI7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHJlZmVyZW5jZU1hcmtlcjtcblx0fSk7XG5cblx0Ly8gTm93IGFjY291bnQgZm9yIHBvc3NpYmxlIHBvc2l0aW9uIG92ZXJsYXBzIGFuZCBzaGlmdCBkb3dud2FyZHNcblx0Ly8gYWxzbyBjb25zaWRlciB3aGV0aGVyIHRoZSBwb3J0YWxzIHNob3VsZCBiZSBzaG93biBvciBub3QuXG5cdGxldCBsYXN0WUJvdHRvbSA9IC1JbmZpbml0eTsgLy8gZm9yIGxhcmdlIGRvY3VtZW50cyBcdUQ4M0RcdURFMDFcblx0bGV0IG1hcmdpbiA9IDQ7XG5cdHJlZmVyZW5jZU1hcmtlcnNcblx0XHQuc29ydChcblx0XHRcdChhLCBiKSA9PlxuXHRcdFx0XHRwYXJzZUludChhIS5nZXRBdHRyaWJ1dGUoXCJ0b3BcIikhKSAtIHBhcnNlSW50KGIhLmdldEF0dHJpYnV0ZShcInRvcFwiKSEpXG5cdFx0KVxuXHRcdC5mb3JFYWNoKChtYXJrZXIpID0+IHtcblx0XHRcdGlmICghbWFya2VyKSByZXR1cm47XG5cdFx0XHQvLyB0b2dnbGUgcG9ydGFsc1xuXHRcdFx0Y29uc3QgcG9ydGFsOiBIVE1MRWxlbWVudCB8IG51bGwgPSBtYXJrZXIucXVlcnlTZWxlY3RvcihcIi5wb3J0YWxcIik7XG5cdFx0XHRjb25zdCBzdmcgPSBtYXJrZXIucXVlcnlTZWxlY3RvcihcInN2Z1wiKTtcblxuXHRcdFx0aWYgKHNob3dQb3J0YWxzKSB7XG5cdFx0XHRcdC8vIGlmIChzdmcgJiYgIXBvcnRhbCkgc3ZnLnN0eWxlLmRpc3BsYXkgPSBcImlubGluZVwiO1xuXHRcdFx0XHQvLyBlbHNlIGlmIChzdmcpIHN2Zy5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG5cblx0XHRcdFx0aWYgKHBvcnRhbCkge1xuXHRcdFx0XHRcdHBvcnRhbC5zdHlsZS5kaXNwbGF5ID0gXCJpbmxpbmVcIjtcblx0XHRcdFx0XHRtYXJrZXIuY2xhc3NMaXN0LmFkZChcImJhY2tsaW5rLXNwYW5cIik7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIGlmIChzdmcpIHN2Zy5zdHlsZS5kaXNwbGF5ID0gXCJpbmxpbmVcIjtcblx0XHRcdFx0aWYgKHBvcnRhbCkge1xuXHRcdFx0XHRcdHBvcnRhbC5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG5cdFx0XHRcdH1cblx0XHRcdFx0bWFya2VyLmNsYXNzTGlzdC5yZW1vdmUoXCJiYWNrbGluay1zcGFuXCIpO1xuXHRcdFx0fVxuXHRcdFx0Ly8gZ2V0IHBvc2l0aW9uaW5nXG5cdFx0XHRsZXQgdG9wID0gcGFyc2VJbnQobWFya2VyIS5nZXRBdHRyaWJ1dGUoXCJ0b3BcIikhKTtcblx0XHRcdHRvcCA9IE1hdGgubWF4KHRvcCwgbGFzdFlCb3R0b20gKyBtYXJnaW4pO1xuXHRcdFx0bGFzdFlCb3R0b20gPSB0b3AgKyBtYXJrZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0ICsgbWFyZ2luO1xuXHRcdFx0bWFya2VyLnNldEF0dHJpYnV0ZShcInRvcFwiLCB0b3AudG9TdHJpbmcoKSk7XG5cdFx0XHRtYXJrZXIuc3R5bGUudG9wID0gdG9wIC0gdGl0bGVCYm94LnRvcCArIDMyICsgXCJweFwiO1xuXHRcdFx0bWFya2VyLnN0eWxlLmxlZnQgPSBsaW5lQmJveC53aWR0aCArIDQwICsgXCJweFwiO1xuXHRcdH0pO1xufVxuXG5sZXQgZGVib3VuY2VUaW1lcjogTm9kZUpTLlRpbWVvdXQ7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVCYWNrbGlua01hcmtQb3NpdGlvbnMoKSB7XG5cdGNsZWFyVGltZW91dChkZWJvdW5jZVRpbWVyKTtcblx0ZGVib3VuY2VUaW1lciA9IHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdGNvbnN0IGxlYXZlcyA9IGdldFRoYXQoKS53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFxuXHRcdFx0XCJtYXJrZG93blwiXG5cdFx0KSBhcyBXb3Jrc3BhY2VMZWFmW107XG5cblx0XHRzZXRUaW1lb3V0KGFzeW5jICgpID0+IHtcblx0XHRcdGNvbnN0IGFsbEJhY2tsaW5rczogQmFja2xpbmtbXSA9IGF3YWl0IHJlY29tcHV0ZVJlZmVyZW5jZXNGb3JQYWdlKCk7XG5cblx0XHRcdGxlYXZlcy5mb3JFYWNoKChsZWFmKSA9PiB7XG5cdFx0XHRcdGNvbnN0IGJhY2tsaW5rc1RvTGVhZiA9IGFsbEJhY2tsaW5rcy5maWx0ZXIoXG5cdFx0XHRcdFx0Ly8gQHRzLWlnbm9yZVxuXHRcdFx0XHRcdChiKSA9PiBiLnJlZmVyZW5jZWRMb2NhdGlvbi5maWxlbmFtZSA9PSBsZWFmLnZpZXcuZmlsZS5wYXRoXG5cdFx0XHRcdCk7XG5cdFx0XHRcdC8vIHdpZHRoIDkwMCwgc2hvdyB0aGUgcmVmZXJlbmNlXG5cdFx0XHRcdGNvbnN0IHNob3dQb3J0YWxzID0gZ2V0Q29udGFpbmVyRWxlbWVudChsZWFmKS5pbm5lcldpZHRoID4gOTAwO1xuXHRcdFx0XHR1cGRhdGVCYWNrbGlua01hcmtQb3NpdGlvbihsZWFmLCBiYWNrbGlua3NUb0xlYWYsIHNob3dQb3J0YWxzKTtcblx0XHRcdH0pO1xuXHRcdH0sIDUwMCk7XG5cdH0sIDEwMCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVCYWNrbGlua01hcmsoYmFja2xpbms6IEJhY2tsaW5rKTogSFRNTEVsZW1lbnQge1xuXHRsZXQgeyBzcGFuLCBzdmcgfSA9IGNyZWF0ZVJlZmVyZW5jZUljb24oYmFja2xpbmsucG9ydGFsVGV4dCk7XG5cdHNwYW4uY2xhc3NMaXN0LmFkZChcImJhY2tsaW5rLWRhdGEtc3BhblwiKTtcblxuXHRjb25zdCBwb3J0YWw6IEhUTUxFbGVtZW50IHwgbnVsbCA9IHNwYW4ucXVlcnlTZWxlY3RvcihcIi5wb3J0YWxcIik7XG5cblx0c3Bhbi5zdHlsZS5wb3NpdGlvbiA9IFwiYWJzb2x1dGVcIjtcblxuXHRzcGFuLmlkID0gZ2V0QmFja2xpbmtJRChiYWNrbGluayk7XG5cdHNwYW4uc2V0QXR0cmlidXRlKFwicmVmZXJlbmNlXCIsIEpTT04uc3RyaW5naWZ5KGJhY2tsaW5rKSk7XG5cblx0Y29uc3QgcmVzaXplT2JzZXJ2ZXIgPSBuZXcgUmVzaXplT2JzZXJ2ZXIoKGVudHJpZXMpID0+IHtcblx0XHRpZiAocG9ydGFsICYmIHBvcnRhbC5zdHlsZS5kaXNwbGF5ICE9IFwibm9uZVwiKSB7XG5cdFx0XHQvLyBzcGFuLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwid2hpdGVcIjtcblx0XHRcdHNwYW4uY2xhc3NMaXN0LmFkZChcImJhY2tsaW5rLXBvcnRhbC1vcGVuXCIpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBzcGFuLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiXCI7XG5cdFx0XHRzcGFuLmNsYXNzTGlzdC5yZW1vdmUoXCJiYWNrbGluay1wb3J0YWwtb3BlblwiKTtcblx0XHR9XG5cdH0pO1xuXG5cdC8vIFN0YXJ0IG9ic2VydmluZyBhbiBlbGVtZW50XG5cdHJlc2l6ZU9ic2VydmVyLm9ic2VydmUoc3Bhbik7XG5cblx0c3Bhbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgb3BlbkJhY2tsaW5rUmVmZXJlbmNlKTtcblxuXHRyZXR1cm4gc3Bhbjtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGFkZFJlZmVyZW5jZXNUb0xlYWYobGVhZjogV29ya3NwYWNlTGVhZikge1xuXHRjb25zdCBtYXJrZG93blZpZXcgPSBnZXRNYXJrZG93blZpZXcobGVhZik7XG5cdGxldCB3b3Jrc3BhY2VUYWJzID0gbWFya2Rvd25WaWV3LmNvbnRhaW5lckVsLmNsb3Nlc3QoXCIud29ya3NwYWNlLXRhYnNcIik7XG5cdGlmICghd29ya3NwYWNlVGFicykge1xuXHRcdHRocm93IG5ldyBFcnJvcihcIk1pc3Npbmcgd29ya3NwYWNlIHRhYnNcIik7XG5cdH1cblxuXHRhd2FpdCB1cGRhdGVCYWNrbGlua01hcmtQb3NpdGlvbnMoKTtcblxuXHRnZXRDb250YWluZXJFbGVtZW50KG1hcmtkb3duVmlldy5lZGl0b3IpXG5cdFx0LnF1ZXJ5U2VsZWN0b3IoXCIuY20tc2Nyb2xsZXJcIikhXG5cdFx0LmFkZEV2ZW50TGlzdGVuZXIoXCJzY3JvbGxcIiwgYXN5bmMgKCkgPT4ge1xuXHRcdFx0YXdhaXQgdXBkYXRlQmFja2xpbmtNYXJrUG9zaXRpb25zKCk7XG5cdFx0fSk7XG5cblx0bGV0IHJlc2l6ZU9ic2VydmVyID0gbmV3IFJlc2l6ZU9ic2VydmVyKGFzeW5jICgpID0+IHtcblx0XHRhd2FpdCB1cGRhdGVCYWNrbGlua01hcmtQb3NpdGlvbnMoKTtcblx0fSk7XG5cblx0cmVzaXplT2JzZXJ2ZXIub2JzZXJ2ZSh3b3Jrc3BhY2VUYWJzKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldE1hcmtkb3duVmlldyhsZWFmOiBXb3Jrc3BhY2VMZWFmKTogTWFya2Rvd25WaWV3IHtcblx0aWYgKCEobGVhZi52aWV3IGluc3RhbmNlb2YgTWFya2Rvd25WaWV3KSkge1xuXHRcdHRocm93IG5ldyBFcnJvcihcIlVuZXhwZWN0ZWQgbm9uLW1hcmtkb3duIHZpZXdcIik7XG5cdH1cblx0cmV0dXJuIGxlYWYudmlldyBhcyBNYXJrZG93blZpZXc7XG59XG5cbmZ1bmN0aW9uIGdldEZpbGVuYW1lKGxlYWY6IFdvcmtzcGFjZUxlYWYpOiBzdHJpbmcge1xuXHRjb25zdCB7IGZpbGUgfSA9IGdldE1hcmtkb3duVmlldyhsZWFmKTtcblx0aWYgKCFmaWxlKSB7XG5cdFx0dGhyb3cgbmV3IEVycm9yKFwiVW5leHBlY3RlZCBtaXNzaW5nIGZpbGVcIik7XG5cdH1cblx0cmV0dXJuIGZpbGUubmFtZTtcbn1cblxuZnVuY3Rpb24gZmluZE1hdGNoUG9zaXRpb25zKGxpbmU6IHN0cmluZywgcmVnZXg6IFJlZ0V4cCkge1xuXHRsZXQgbWF0Y2g7XG5cdGNvbnN0IHBvc2l0aW9ucyA9IFtdO1xuXHR3aGlsZSAoKG1hdGNoID0gcmVnZXguZXhlYyhsaW5lKSkgIT09IG51bGwpIHtcblx0XHRwb3NpdGlvbnMucHVzaCh7XG5cdFx0XHRtYXRjaDogbWF0Y2hbMF0sXG5cdFx0XHRzdGFydDogbWF0Y2guaW5kZXgsXG5cdFx0XHRlbmQ6IG1hdGNoLmluZGV4ICsgbWF0Y2hbMF0ubGVuZ3RoLFxuXHRcdH0pO1xuXHR9XG5cdHJldHVybiBwb3NpdGlvbnM7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUJhY2tsaW5rRGF0YShcblx0cmVmZXJlbmNpbmdGaWxlRGF0YTogc3RyaW5nLFxuXHRyZWZlcmVuY2luZ0ZpbGU6IFRGaWxlXG4pOiBCYWNrbGlua1tdIHtcblx0bGV0IGJhY2tsaW5rczogQmFja2xpbmtbXSA9IFtdO1xuXG5cdGxldCBtYXRjaGVzID0gWy4uLnJlZmVyZW5jaW5nRmlsZURhdGEubWF0Y2hBbGwoUkVGRVJFTkNFX1JFR0VYKV07XG5cdG1hdGNoZXMuZm9yRWFjaCgobWF0Y2gpID0+IHtcblx0XHRpZiAobWF0Y2hbMV0uc3BsaXQoXCI6XCIpLmxlbmd0aCAhPSA4KSByZXR1cm47XG5cdFx0bGV0IFtwcmVmaXgsIHRleHQsIHN1ZmZpeCwgZmlsZW5hbWUsIGZyb20sIHRvLCBwb3J0YWwsIHRvZ2dsZV0gPSBwcm9jZXNzVVJJKFxuXHRcdFx0bWF0Y2hbMV1cblx0XHQpO1xuXHRcdGNvbnN0IHJlZmVyZW5jZWRMb2NhdGlvbjogRG9jdW1lbnRMb2NhdGlvbiA9IHtcblx0XHRcdHByZWZpeCxcblx0XHRcdHRleHQsXG5cdFx0XHRzdWZmaXgsXG5cdFx0XHRmaWxlbmFtZSxcblx0XHRcdGZyb20sXG5cdFx0XHR0byxcblx0XHRcdHBvcnRhbCxcblx0XHRcdHRvZ2dsZSxcblx0XHR9O1xuXG5cdFx0bGV0IGluZGV4ID0gcmVmZXJlbmNpbmdGaWxlRGF0YS5pbmRleE9mKG1hdGNoWzBdKTtcblxuXHRcdGNvbnN0IHJlZmVyZW5jaW5nU3Vycm91bmRpbmdTdHJpbmdzID0gZ2V0UHJlZml4QW5kU3VmZml4KFxuXHRcdFx0cmVmZXJlbmNpbmdGaWxlRGF0YSxcblx0XHRcdGluZGV4LFxuXHRcdFx0aW5kZXggKyBtYXRjaFswXS5sZW5ndGhcblx0XHQpO1xuXG5cdFx0Y29uc3QgcmVmZXJlbmNpbmdMb2NhdGlvbjogRG9jdW1lbnRMb2NhdGlvbiA9IHtcblx0XHRcdC8vIHByZWZpeDogcmVmZXJlbmNpbmdGaWxlRGF0YS5zbGljZShpbmRleCAtIDI1LCBpbmRleCksXG5cdFx0XHRwcmVmaXg6IHJlZmVyZW5jaW5nU3Vycm91bmRpbmdTdHJpbmdzLnByZWZpeCxcblx0XHRcdHRleHQ6IHJlZmVyZW5jaW5nRmlsZURhdGEuc2xpY2UoaW5kZXgsIGluZGV4ICsgbWF0Y2hbMF0ubGVuZ3RoKSxcblx0XHRcdC8vIHN1ZmZpeDogcmVmZXJlbmNpbmdGaWxlRGF0YS5zbGljZShcblx0XHRcdC8vIFx0aW5kZXggKyBtYXRjaFswXS5sZW5ndGgsXG5cdFx0XHQvLyBcdGluZGV4ICsgbWF0Y2hbMF0ubGVuZ3RoICsgMjVcblx0XHRcdC8vICksXG5cdFx0XHRzdWZmaXg6IHJlZmVyZW5jaW5nU3Vycm91bmRpbmdTdHJpbmdzLnN1ZmZpeCxcblx0XHRcdGZpbGVuYW1lOiByZWZlcmVuY2luZ0ZpbGUucGF0aCxcblx0XHRcdGZyb206IG1hdGNoLmluZGV4ISwgLy8gVE9ETyBkbyB3ZWlyZCBzdHJpbmcgZm9ybWF0XG5cdFx0XHR0bzogbWF0Y2guaW5kZXghICsgbWF0Y2hbMF0ubGVuZ3RoLCAvLyBUT0RPIGRvIHdlaXJkIHN0cmluZyBmb3JtYXRcblx0XHRcdHBvcnRhbCxcblx0XHRcdHRvZ2dsZSxcblx0XHR9O1xuXG5cdFx0aWYgKHBvcnRhbCA9PSBcInBvcnRhbFwiKSB7XG5cdFx0XHQvLyBPUiBuby1wb3J0YWxcblxuXHRcdFx0Ly8gZ2V0IGFsbCB0aGUgdGV4dCBmcm9tIHRoZSBzdGFydCBvZiB0aGUgbGluZSB0byB0aGUgZW5kIG9mIHRoZSBsaW5lXG5cdFx0XHRjb25zdCBnZXRMaW5lVGV4dCA9ICh0ZXh0OiBzdHJpbmcsIGluZGV4OiBudW1iZXIpOiBzdHJpbmcgPT4ge1xuXHRcdFx0XHRjb25zdCBzdGFydE9mTGluZSA9IHRleHQubGFzdEluZGV4T2YoXCJcXG5cIiwgaW5kZXggLSAxKSArIDE7XG5cdFx0XHRcdGNvbnN0IGVuZE9mTGluZSA9IHRleHQuaW5kZXhPZihcIlxcblwiLCBpbmRleCk7XG5cdFx0XHRcdHJldHVybiB0ZXh0LnNsaWNlKFxuXHRcdFx0XHRcdHN0YXJ0T2ZMaW5lLFxuXHRcdFx0XHRcdGVuZE9mTGluZSAhPT0gLTEgPyBlbmRPZkxpbmUgOiB1bmRlZmluZWRcblx0XHRcdFx0KTtcblx0XHRcdH07XG5cblx0XHRcdGxldCBsaW5lID0gZ2V0TGluZVRleHQocmVmZXJlbmNpbmdGaWxlRGF0YSwgaW5kZXgpO1xuXHRcdFx0bGV0IG1hdGNoUG9zaXRpb25zID0gZmluZE1hdGNoUG9zaXRpb25zKFxuXHRcdFx0XHRsaW5lLFxuXHRcdFx0XHRuZXcgUmVnRXhwKFJFRkVSRU5DRV9SRUdFWClcblx0XHRcdCk7XG5cblx0XHRcdGxldCBtYXRjaEluZGV4ID0gMDtcblx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgbWF0Y2hQb3NpdGlvbnMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0aWYgKG1hdGNoUG9zaXRpb25zW2ldLm1hdGNoID09IG1hdGNoWzBdKSB7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0bWF0Y2hJbmRleCArPSBtYXRjaFBvc2l0aW9uc1tpXS5lbmQgLSBtYXRjaFBvc2l0aW9uc1tpXS5zdGFydCAtIDE7IC8vIC0xIGJlY2F1c2UgdGhlIGxpbmUgaXMgcmVwbGFjZWQgYnkgYSBzaW5nbGUgY2hhcmFjdGVyXG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0bGV0IHBvcnRhbFRleHQgPSBsaW5lLnJlcGxhY2UobmV3IFJlZ0V4cChSRUZFUkVOQ0VfUkVHRVgsIFwiZ1wiKSwgXCJcdTIxOTdcIik7XG5cdFx0XHRsZXQgcG9ydGFsVGV4dFNsaWNlID0gcG9ydGFsVGV4dC5zbGljZSgwLCBQT1JUQUxfVEVYVF9TTElDRV9TSVpFKTtcblxuXHRcdFx0bGV0IHBvcnRhbFRleHRJbmRleCA9IGxpbmUuaW5kZXhPZihtYXRjaFswXSkgLSBtYXRjaEluZGV4O1xuXG5cdFx0XHQvLyBnZXR0aW5nIHRoZSBwb3J0YWwgdGV4dCBzZWxlY3Rpb24gYXJvdW5kIHRoZSByZWZlcmVuY2Vcblx0XHRcdHBvcnRhbFRleHRTbGljZSA9IFwiXHUyMTk3XCI7XG5cblx0XHRcdGxldCBzdGFydFBvcnRhbFRleHQgPSBwb3J0YWxUZXh0LnN1YnN0cmluZyhcblx0XHRcdFx0TWF0aC5tYXgocG9ydGFsVGV4dEluZGV4IC0gMjUsIDApLFxuXHRcdFx0XHRwb3J0YWxUZXh0SW5kZXhcblx0XHRcdCk7XG5cdFx0XHRpZiAoXG5cdFx0XHRcdHBvcnRhbFRleHQuc3Vic3RyaW5nKE1hdGgubWF4KHBvcnRhbFRleHRJbmRleCAtIDI1LCAwKSwgcG9ydGFsVGV4dEluZGV4KVxuXHRcdFx0XHRcdC5sZW5ndGggPiAwICYmXG5cdFx0XHRcdHBvcnRhbFRleHRJbmRleCAtIDI1ID4gMFxuXHRcdFx0KVxuXHRcdFx0XHRzdGFydFBvcnRhbFRleHQgPSBcIi4uLlwiICsgc3RhcnRQb3J0YWxUZXh0O1xuXG5cdFx0XHRsZXQgZW5kUG9ydGFsVGV4dCA9IHBvcnRhbFRleHQuc3Vic3RyaW5nKFxuXHRcdFx0XHRwb3J0YWxUZXh0SW5kZXggKyAxLFxuXHRcdFx0XHRNYXRoLm1heChwb3J0YWxUZXh0SW5kZXggKyAyNSwgcG9ydGFsVGV4dC5sZW5ndGgpXG5cdFx0XHQpO1xuXHRcdFx0aWYgKFxuXHRcdFx0XHRwb3J0YWxUZXh0LnN1YnN0cmluZyhcblx0XHRcdFx0XHRwb3J0YWxUZXh0SW5kZXggKyAxLFxuXHRcdFx0XHRcdE1hdGgubWF4KHBvcnRhbFRleHRJbmRleCArIDI1LCBwb3J0YWxUZXh0Lmxlbmd0aClcblx0XHRcdFx0KS5sZW5ndGggPiAwICYmXG5cdFx0XHRcdHBvcnRhbFRleHRJbmRleCArIDI1IDwgcG9ydGFsVGV4dC5sZW5ndGhcblx0XHRcdClcblx0XHRcdFx0ZW5kUG9ydGFsVGV4dCA9IGVuZFBvcnRhbFRleHQgKyBcIi4uLlwiO1xuXG5cdFx0XHRiYWNrbGlua3MucHVzaCh7XG5cdFx0XHRcdHJlZmVyZW5jZWRMb2NhdGlvbixcblx0XHRcdFx0cmVmZXJlbmNpbmdMb2NhdGlvbixcblx0XHRcdFx0ZGF0YVN0cmluZzogbWF0Y2hbMV0sXG5cdFx0XHRcdHBvcnRhbFRleHQ6XG5cdFx0XHRcdFx0ZW5jb2RlVVJJQ29tcG9uZW50U3RyaW5nKHN0YXJ0UG9ydGFsVGV4dCkgK1xuXHRcdFx0XHRcdFwiOlwiICtcblx0XHRcdFx0XHRwb3J0YWxUZXh0U2xpY2UgK1xuXHRcdFx0XHRcdFwiOlwiICtcblx0XHRcdFx0XHRlbmNvZGVVUklDb21wb25lbnRTdHJpbmcoZW5kUG9ydGFsVGV4dCksXG5cdFx0XHR9KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0YmFja2xpbmtzLnB1c2goe1xuXHRcdFx0XHRyZWZlcmVuY2VkTG9jYXRpb24sXG5cdFx0XHRcdHJlZmVyZW5jaW5nTG9jYXRpb24sXG5cdFx0XHRcdGRhdGFTdHJpbmc6IG1hdGNoWzFdLFxuXHRcdFx0fSk7XG5cdFx0fVxuXHR9KTtcblx0cmV0dXJuIGJhY2tsaW5rcztcbn1cblxuLy8gbGV0IGRlYm91bmNlVGltZXI6IE5vZGVKUy5UaW1lb3V0O1xuZXhwb3J0IGZ1bmN0aW9uIGdlbmVyYXRlQmFja2xpbmtzKCkge1xuXHQvLyBjbGVhclRpbWVvdXQoZGVib3VuY2VUaW1lcik7XG5cdC8vIGRlYm91bmNlVGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHtcblx0Y29uc29sZS5sb2coXCJnZW5lcmF0aW5nIHJlZmVyZW5jZXNcIik7XG5cdGxldCBiYWNrbGlua3M6IEJhY2tsaW5rW10gPSBbXTtcblx0bGV0IG1hcmtkb3duRmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XG5cblx0UHJvbWlzZS5hbGwoXG5cdFx0bWFya2Rvd25GaWxlcy5tYXAoKGZpbGU6IFRGaWxlKSA9PiB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpKVxuXHQpLnRoZW4oKGZpbGVzKSA9PiB7XG5cdFx0Y29uc3QgemlwcGVkQXJyYXkgPSBtYXJrZG93bkZpbGVzLm1hcCgoZmlsZTogVEZpbGUsIGluZGV4OiBudW1iZXIpID0+ICh7XG5cdFx0XHRtYXJrZG93bkZpbGU6IGZpbGUsXG5cdFx0XHRmaWxlRGF0YTogZmlsZXNbaW5kZXhdLFxuXHRcdH0pKTtcblxuXHRcdHppcHBlZEFycmF5LmZvckVhY2goKGZpbGU6IHsgbWFya2Rvd25GaWxlOiBURmlsZTsgZmlsZURhdGE6IHN0cmluZyB9KSA9PiB7XG5cdFx0XHRsZXQgZmlsZUJhY2tsaW5rcyA9IGNyZWF0ZUJhY2tsaW5rRGF0YShmaWxlLmZpbGVEYXRhLCBmaWxlLm1hcmtkb3duRmlsZSk7XG5cdFx0XHR1cGRhdGVCYWNrbGlua3MoZmlsZUJhY2tsaW5rcyk7XG5cblx0XHRcdGJhY2tsaW5rcy5wdXNoKC4uLmZpbGVCYWNrbGlua3MpO1xuXHRcdH0pO1xuXG5cdFx0Y29uc3QgbGVhdmVzID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZShcIm1hcmtkb3duXCIpO1xuXG5cdFx0bGVhdmVzLmZvckVhY2goYXN5bmMgKGxlYWY6IFdvcmtzcGFjZUxlYWYpID0+IHtcblx0XHRcdGF3YWl0IGFkZFJlZmVyZW5jZXNUb0xlYWYobGVhZik7XG5cdFx0fSk7XG5cdH0pO1xuXHQvLyB9LCAxMDApO1xufVxuXG4vLyBTaG91bGQgb25seSByZWNvbXB1dGUgZm9yIHRoZSBwYXJ0aWN1bGFyIHBhZ2UgYmVpbmcgb3BlbmVkIG9yIGludGVyYWN0ZWQgd2l0aFxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlY29tcHV0ZVJlZmVyZW5jZXNGb3JQYWdlKCk6IFByb21pc2U8QmFja2xpbmtbXT4ge1xuXHRsZXQgcmVmZXJlbmNlczogQmFja2xpbmtbXSA9IFtdO1xuXHRsZXQgbWFya2Rvd25GaWxlcyA9IHRoaXMuYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKTtcblxuXHRsZXQgcHJvbWlzZXMgPSBtYXJrZG93bkZpbGVzLm1hcCgoZmlsZTogVEZpbGUpID0+IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSkpO1xuXG5cdGxldCBmaWxlcyA9IGF3YWl0IFByb21pc2UuYWxsKHByb21pc2VzKTtcblx0Y29uc3QgemlwcGVkQXJyYXkgPSBtYXJrZG93bkZpbGVzLm1hcCgoZmlsZTogVEZpbGUsIGluZGV4OiBudW1iZXIpID0+ICh7XG5cdFx0bWFya2Rvd25GaWxlOiBmaWxlLFxuXHRcdGZpbGVEYXRhOiBmaWxlc1tpbmRleF0sXG5cdH0pKTtcblx0emlwcGVkQXJyYXkuZm9yRWFjaCgoZmlsZTogeyBtYXJrZG93bkZpbGU6IFRGaWxlOyBmaWxlRGF0YTogc3RyaW5nIH0pID0+IHtcblx0XHRsZXQgZmlsZUJhY2tsaW5rcyA9IGNyZWF0ZUJhY2tsaW5rRGF0YShmaWxlLmZpbGVEYXRhLCBmaWxlLm1hcmtkb3duRmlsZSk7XG5cdFx0dXBkYXRlQmFja2xpbmtzKGZpbGVCYWNrbGlua3MpO1xuXG5cdFx0cmVmZXJlbmNlcy5wdXNoKC4uLmZpbGVCYWNrbGlua3MpO1xuXHR9KTtcblx0cmV0dXJuIHJlZmVyZW5jZXM7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBvcGVuQmFja2xpbmtSZWZlcmVuY2UoZXY6IE1vdXNlRXZlbnQpIHtcblx0bGV0IGN1cnNvciA9IGdldEN1cnNvcigpO1xuXHRsZXQgaG92ZXIgPSBnZXRCYWNrbGlua0hvdmVyKCk7XG5cdGxldCBsZWFmID0gZ2V0VGhhdCgpLndvcmtzcGFjZS5nZXRMZWFmQnlJZChob3Zlci5sZWFmSWQpO1xuXG5cdC8vIEB0cy1pZ25vcmVcblx0bGV0IGNvbnRhaW5lciA9IGxlYWYuY29udGFpbmVyRWw7XG5cdGlmICghY29udGFpbmVyKSB0aHJvdyBuZXcgRXJyb3IoXCJDb250YWluZXIgbm90IGZvdW5kXCIpO1xuXHRjb250YWluZXIucXVlcnlTZWxlY3RvcihcIi52aWV3LWNvbnRlbnRcIikuc3R5bGUuYm94U2hhZG93ID0gXCJub25lXCI7XG5cblx0aWYgKFxuXHRcdGN1cnNvciAmJlxuXHRcdGhvdmVyICYmXG5cdFx0Y3Vyc29yLmRhdGFTdHJpbmcgJiZcblx0XHRob3Zlci5kYXRhU3RyaW5nICYmXG5cdFx0Y3Vyc29yLmRhdGFTdHJpbmcgPT0gaG92ZXIuZGF0YVN0cmluZ1xuXHQpIHtcblx0XHR1cGRhdGVDdXJzb3Ioe1xuXHRcdFx0dGVtcDogZmFsc2UsXG5cdFx0XHRjdXJzb3JWaWV3cG9ydDogbnVsbCxcblx0XHRcdHBlZWs6IGZhbHNlLFxuXHRcdH0pO1xuXHR9XG5cdHVwZGF0ZUJhY2tsaW5rSG92ZXIoe1xuXHRcdHRlbXA6IGZhbHNlLFxuXHRcdGN1cnNvclZpZXdwb3J0OiBudWxsLFxuXHRcdHBlZWs6IGZhbHNlLFxuXHR9KTtcblxuXHRoYW5kbGVSZW1vdmVIb3ZlcmVkQ3Vyc29yKEFDVElPTl9UWVBFLkNVUlNPUik7XG5cblx0cmVzZXRDdXJzb3IoKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIG9wZW5SZWZlcmVuY2UoZXY6IE1vdXNlRXZlbnQpIHtcblx0bGV0IGN1cnNvciA9IGdldEN1cnNvcigpO1xuXHRsZXQgaG92ZXIgPSBnZXRIb3ZlcigpO1xuXHRsZXQgbGVhZiA9IGdldFRoYXQoKS53b3Jrc3BhY2UuZ2V0TGVhZkJ5SWQoaG92ZXIubGVhZklkKTtcblxuXHQvLyBAdHMtaWdub3JlXG5cdGxldCBjb250YWluZXIgPSBsZWFmLmNvbnRhaW5lckVsO1xuXHRpZiAoIWNvbnRhaW5lcikgdGhyb3cgbmV3IEVycm9yKFwiQ29udGFpbmVyIG5vdCBmb3VuZFwiKTtcblx0Y29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCIudmlldy1jb250ZW50XCIpLnN0eWxlLmJveFNoYWRvdyA9IFwibm9uZVwiO1xuXG5cdGlmIChcblx0XHRjdXJzb3IgJiZcblx0XHRob3ZlciAmJlxuXHRcdGN1cnNvci5kYXRhU3RyaW5nICYmXG5cdFx0aG92ZXIuZGF0YVN0cmluZyAmJlxuXHRcdGN1cnNvci5kYXRhU3RyaW5nID09IGhvdmVyLmRhdGFTdHJpbmdcblx0KSB7XG5cdFx0dXBkYXRlQ3Vyc29yKHtcblx0XHRcdHRlbXA6IGZhbHNlLFxuXHRcdFx0Y3Vyc29yVmlld3BvcnQ6IG51bGwsXG5cdFx0XHRwZWVrOiBmYWxzZSxcblx0XHR9KTtcblx0fVxuXHR1cGRhdGVIb3Zlcih7XG5cdFx0dGVtcDogZmFsc2UsXG5cdFx0Y3Vyc29yVmlld3BvcnQ6IG51bGwsXG5cdFx0cGVlazogZmFsc2UsXG5cdH0pO1xuXG5cdGhhbmRsZVJlbW92ZUhvdmVyZWRDdXJzb3IoQUNUSU9OX1RZUEUuQ1VSU09SKTtcblxuXHRyZXNldEN1cnNvcigpO1xufVxuIiwgIi8vIFVuaXF1ZSBJRCBjcmVhdGlvbiByZXF1aXJlcyBhIGhpZ2ggcXVhbGl0eSByYW5kb20gIyBnZW5lcmF0b3IuIEluIHRoZSBicm93c2VyIHdlIHRoZXJlZm9yZVxuLy8gcmVxdWlyZSB0aGUgY3J5cHRvIEFQSSBhbmQgZG8gbm90IHN1cHBvcnQgYnVpbHQtaW4gZmFsbGJhY2sgdG8gbG93ZXIgcXVhbGl0eSByYW5kb20gbnVtYmVyXG4vLyBnZW5lcmF0b3JzIChsaWtlIE1hdGgucmFuZG9tKCkpLlxubGV0IGdldFJhbmRvbVZhbHVlcztcbmNvbnN0IHJuZHM4ID0gbmV3IFVpbnQ4QXJyYXkoMTYpO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gcm5nKCkge1xuICAvLyBsYXp5IGxvYWQgc28gdGhhdCBlbnZpcm9ubWVudHMgdGhhdCBuZWVkIHRvIHBvbHlmaWxsIGhhdmUgYSBjaGFuY2UgdG8gZG8gc29cbiAgaWYgKCFnZXRSYW5kb21WYWx1ZXMpIHtcbiAgICAvLyBnZXRSYW5kb21WYWx1ZXMgbmVlZHMgdG8gYmUgaW52b2tlZCBpbiBhIGNvbnRleHQgd2hlcmUgXCJ0aGlzXCIgaXMgYSBDcnlwdG8gaW1wbGVtZW50YXRpb24uXG4gICAgZ2V0UmFuZG9tVmFsdWVzID0gdHlwZW9mIGNyeXB0byAhPT0gJ3VuZGVmaW5lZCcgJiYgY3J5cHRvLmdldFJhbmRvbVZhbHVlcyAmJiBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzLmJpbmQoY3J5cHRvKTtcblxuICAgIGlmICghZ2V0UmFuZG9tVmFsdWVzKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ2NyeXB0by5nZXRSYW5kb21WYWx1ZXMoKSBub3Qgc3VwcG9ydGVkLiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3V1aWRqcy91dWlkI2dldHJhbmRvbXZhbHVlcy1ub3Qtc3VwcG9ydGVkJyk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGdldFJhbmRvbVZhbHVlcyhybmRzOCk7XG59IiwgImV4cG9ydCBkZWZhdWx0IC9eKD86WzAtOWEtZl17OH0tWzAtOWEtZl17NH0tWzEtNV1bMC05YS1mXXszfS1bODlhYl1bMC05YS1mXXszfS1bMC05YS1mXXsxMn18MDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwKSQvaTsiLCAiaW1wb3J0IFJFR0VYIGZyb20gJy4vcmVnZXguanMnO1xuXG5mdW5jdGlvbiB2YWxpZGF0ZSh1dWlkKSB7XG4gIHJldHVybiB0eXBlb2YgdXVpZCA9PT0gJ3N0cmluZycgJiYgUkVHRVgudGVzdCh1dWlkKTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgdmFsaWRhdGU7IiwgImltcG9ydCB2YWxpZGF0ZSBmcm9tICcuL3ZhbGlkYXRlLmpzJztcbi8qKlxuICogQ29udmVydCBhcnJheSBvZiAxNiBieXRlIHZhbHVlcyB0byBVVUlEIHN0cmluZyBmb3JtYXQgb2YgdGhlIGZvcm06XG4gKiBYWFhYWFhYWC1YWFhYLVhYWFgtWFhYWC1YWFhYWFhYWFhYWFhcbiAqL1xuXG5jb25zdCBieXRlVG9IZXggPSBbXTtcblxuZm9yIChsZXQgaSA9IDA7IGkgPCAyNTY7ICsraSkge1xuICBieXRlVG9IZXgucHVzaCgoaSArIDB4MTAwKS50b1N0cmluZygxNikuc2xpY2UoMSkpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdW5zYWZlU3RyaW5naWZ5KGFyciwgb2Zmc2V0ID0gMCkge1xuICAvLyBOb3RlOiBCZSBjYXJlZnVsIGVkaXRpbmcgdGhpcyBjb2RlISAgSXQncyBiZWVuIHR1bmVkIGZvciBwZXJmb3JtYW5jZVxuICAvLyBhbmQgd29ya3MgaW4gd2F5cyB5b3UgbWF5IG5vdCBleHBlY3QuIFNlZSBodHRwczovL2dpdGh1Yi5jb20vdXVpZGpzL3V1aWQvcHVsbC80MzRcbiAgcmV0dXJuIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMF1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxXV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDJdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgM11dICsgJy0nICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA0XV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDVdXSArICctJyArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgNl1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA3XV0gKyAnLScgKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDhdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgOV1dICsgJy0nICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxMF1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxMV1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxMl1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxM11dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxNF1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxNV1dO1xufVxuXG5mdW5jdGlvbiBzdHJpbmdpZnkoYXJyLCBvZmZzZXQgPSAwKSB7XG4gIGNvbnN0IHV1aWQgPSB1bnNhZmVTdHJpbmdpZnkoYXJyLCBvZmZzZXQpOyAvLyBDb25zaXN0ZW5jeSBjaGVjayBmb3IgdmFsaWQgVVVJRC4gIElmIHRoaXMgdGhyb3dzLCBpdCdzIGxpa2VseSBkdWUgdG8gb25lXG4gIC8vIG9mIHRoZSBmb2xsb3dpbmc6XG4gIC8vIC0gT25lIG9yIG1vcmUgaW5wdXQgYXJyYXkgdmFsdWVzIGRvbid0IG1hcCB0byBhIGhleCBvY3RldCAobGVhZGluZyB0b1xuICAvLyBcInVuZGVmaW5lZFwiIGluIHRoZSB1dWlkKVxuICAvLyAtIEludmFsaWQgaW5wdXQgdmFsdWVzIGZvciB0aGUgUkZDIGB2ZXJzaW9uYCBvciBgdmFyaWFudGAgZmllbGRzXG5cbiAgaWYgKCF2YWxpZGF0ZSh1dWlkKSkge1xuICAgIHRocm93IFR5cGVFcnJvcignU3RyaW5naWZpZWQgVVVJRCBpcyBpbnZhbGlkJyk7XG4gIH1cblxuICByZXR1cm4gdXVpZDtcbn1cblxuZXhwb3J0IGRlZmF1bHQgc3RyaW5naWZ5OyIsICJpbXBvcnQgdmFsaWRhdGUgZnJvbSAnLi92YWxpZGF0ZS5qcyc7XG5cbmZ1bmN0aW9uIHBhcnNlKHV1aWQpIHtcbiAgaWYgKCF2YWxpZGF0ZSh1dWlkKSkge1xuICAgIHRocm93IFR5cGVFcnJvcignSW52YWxpZCBVVUlEJyk7XG4gIH1cblxuICBsZXQgdjtcbiAgY29uc3QgYXJyID0gbmV3IFVpbnQ4QXJyYXkoMTYpOyAvLyBQYXJzZSAjIyMjIyMjIy0uLi4uLS4uLi4tLi4uLi0uLi4uLi4uLi4uLi5cblxuICBhcnJbMF0gPSAodiA9IHBhcnNlSW50KHV1aWQuc2xpY2UoMCwgOCksIDE2KSkgPj4+IDI0O1xuICBhcnJbMV0gPSB2ID4+PiAxNiAmIDB4ZmY7XG4gIGFyclsyXSA9IHYgPj4+IDggJiAweGZmO1xuICBhcnJbM10gPSB2ICYgMHhmZjsgLy8gUGFyc2UgLi4uLi4uLi4tIyMjIy0uLi4uLS4uLi4tLi4uLi4uLi4uLi4uXG5cbiAgYXJyWzRdID0gKHYgPSBwYXJzZUludCh1dWlkLnNsaWNlKDksIDEzKSwgMTYpKSA+Pj4gODtcbiAgYXJyWzVdID0gdiAmIDB4ZmY7IC8vIFBhcnNlIC4uLi4uLi4uLS4uLi4tIyMjIy0uLi4uLS4uLi4uLi4uLi4uLlxuXG4gIGFycls2XSA9ICh2ID0gcGFyc2VJbnQodXVpZC5zbGljZSgxNCwgMTgpLCAxNikpID4+PiA4O1xuICBhcnJbN10gPSB2ICYgMHhmZjsgLy8gUGFyc2UgLi4uLi4uLi4tLi4uLi0uLi4uLSMjIyMtLi4uLi4uLi4uLi4uXG5cbiAgYXJyWzhdID0gKHYgPSBwYXJzZUludCh1dWlkLnNsaWNlKDE5LCAyMyksIDE2KSkgPj4+IDg7XG4gIGFycls5XSA9IHYgJiAweGZmOyAvLyBQYXJzZSAuLi4uLi4uLi0uLi4uLS4uLi4tLi4uLi0jIyMjIyMjIyMjIyNcbiAgLy8gKFVzZSBcIi9cIiB0byBhdm9pZCAzMi1iaXQgdHJ1bmNhdGlvbiB3aGVuIGJpdC1zaGlmdGluZyBoaWdoLW9yZGVyIGJ5dGVzKVxuXG4gIGFyclsxMF0gPSAodiA9IHBhcnNlSW50KHV1aWQuc2xpY2UoMjQsIDM2KSwgMTYpKSAvIDB4MTAwMDAwMDAwMDAgJiAweGZmO1xuICBhcnJbMTFdID0gdiAvIDB4MTAwMDAwMDAwICYgMHhmZjtcbiAgYXJyWzEyXSA9IHYgPj4+IDI0ICYgMHhmZjtcbiAgYXJyWzEzXSA9IHYgPj4+IDE2ICYgMHhmZjtcbiAgYXJyWzE0XSA9IHYgPj4+IDggJiAweGZmO1xuICBhcnJbMTVdID0gdiAmIDB4ZmY7XG4gIHJldHVybiBhcnI7XG59XG5cbmV4cG9ydCBkZWZhdWx0IHBhcnNlOyIsICJpbXBvcnQgeyB1bnNhZmVTdHJpbmdpZnkgfSBmcm9tICcuL3N0cmluZ2lmeS5qcyc7XG5pbXBvcnQgcGFyc2UgZnJvbSAnLi9wYXJzZS5qcyc7XG5cbmZ1bmN0aW9uIHN0cmluZ1RvQnl0ZXMoc3RyKSB7XG4gIHN0ciA9IHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChzdHIpKTsgLy8gVVRGOCBlc2NhcGVcblxuICBjb25zdCBieXRlcyA9IFtdO1xuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgKytpKSB7XG4gICAgYnl0ZXMucHVzaChzdHIuY2hhckNvZGVBdChpKSk7XG4gIH1cblxuICByZXR1cm4gYnl0ZXM7XG59XG5cbmV4cG9ydCBjb25zdCBETlMgPSAnNmJhN2I4MTAtOWRhZC0xMWQxLTgwYjQtMDBjMDRmZDQzMGM4JztcbmV4cG9ydCBjb25zdCBVUkwgPSAnNmJhN2I4MTEtOWRhZC0xMWQxLTgwYjQtMDBjMDRmZDQzMGM4JztcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHYzNShuYW1lLCB2ZXJzaW9uLCBoYXNoZnVuYykge1xuICBmdW5jdGlvbiBnZW5lcmF0ZVVVSUQodmFsdWUsIG5hbWVzcGFjZSwgYnVmLCBvZmZzZXQpIHtcbiAgICB2YXIgX25hbWVzcGFjZTtcblxuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICB2YWx1ZSA9IHN0cmluZ1RvQnl0ZXModmFsdWUpO1xuICAgIH1cblxuICAgIGlmICh0eXBlb2YgbmFtZXNwYWNlID09PSAnc3RyaW5nJykge1xuICAgICAgbmFtZXNwYWNlID0gcGFyc2UobmFtZXNwYWNlKTtcbiAgICB9XG5cbiAgICBpZiAoKChfbmFtZXNwYWNlID0gbmFtZXNwYWNlKSA9PT0gbnVsbCB8fCBfbmFtZXNwYWNlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfbmFtZXNwYWNlLmxlbmd0aCkgIT09IDE2KSB7XG4gICAgICB0aHJvdyBUeXBlRXJyb3IoJ05hbWVzcGFjZSBtdXN0IGJlIGFycmF5LWxpa2UgKDE2IGl0ZXJhYmxlIGludGVnZXIgdmFsdWVzLCAwLTI1NSknKTtcbiAgICB9IC8vIENvbXB1dGUgaGFzaCBvZiBuYW1lc3BhY2UgYW5kIHZhbHVlLCBQZXIgNC4zXG4gICAgLy8gRnV0dXJlOiBVc2Ugc3ByZWFkIHN5bnRheCB3aGVuIHN1cHBvcnRlZCBvbiBhbGwgcGxhdGZvcm1zLCBlLmcuIGBieXRlcyA9XG4gICAgLy8gaGFzaGZ1bmMoWy4uLm5hbWVzcGFjZSwgLi4uIHZhbHVlXSlgXG5cblxuICAgIGxldCBieXRlcyA9IG5ldyBVaW50OEFycmF5KDE2ICsgdmFsdWUubGVuZ3RoKTtcbiAgICBieXRlcy5zZXQobmFtZXNwYWNlKTtcbiAgICBieXRlcy5zZXQodmFsdWUsIG5hbWVzcGFjZS5sZW5ndGgpO1xuICAgIGJ5dGVzID0gaGFzaGZ1bmMoYnl0ZXMpO1xuICAgIGJ5dGVzWzZdID0gYnl0ZXNbNl0gJiAweDBmIHwgdmVyc2lvbjtcbiAgICBieXRlc1s4XSA9IGJ5dGVzWzhdICYgMHgzZiB8IDB4ODA7XG5cbiAgICBpZiAoYnVmKSB7XG4gICAgICBvZmZzZXQgPSBvZmZzZXQgfHwgMDtcblxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxNjsgKytpKSB7XG4gICAgICAgIGJ1ZltvZmZzZXQgKyBpXSA9IGJ5dGVzW2ldO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gYnVmO1xuICAgIH1cblxuICAgIHJldHVybiB1bnNhZmVTdHJpbmdpZnkoYnl0ZXMpO1xuICB9IC8vIEZ1bmN0aW9uI25hbWUgaXMgbm90IHNldHRhYmxlIG9uIHNvbWUgcGxhdGZvcm1zICgjMjcwKVxuXG5cbiAgdHJ5IHtcbiAgICBnZW5lcmF0ZVVVSUQubmFtZSA9IG5hbWU7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1lbXB0eVxuICB9IGNhdGNoIChlcnIpIHt9IC8vIEZvciBDb21tb25KUyBkZWZhdWx0IGV4cG9ydCBzdXBwb3J0XG5cblxuICBnZW5lcmF0ZVVVSUQuRE5TID0gRE5TO1xuICBnZW5lcmF0ZVVVSUQuVVJMID0gVVJMO1xuICByZXR1cm4gZ2VuZXJhdGVVVUlEO1xufSIsICJjb25zdCByYW5kb21VVUlEID0gdHlwZW9mIGNyeXB0byAhPT0gJ3VuZGVmaW5lZCcgJiYgY3J5cHRvLnJhbmRvbVVVSUQgJiYgY3J5cHRvLnJhbmRvbVVVSUQuYmluZChjcnlwdG8pO1xuZXhwb3J0IGRlZmF1bHQge1xuICByYW5kb21VVUlEXG59OyIsICJpbXBvcnQgbmF0aXZlIGZyb20gJy4vbmF0aXZlLmpzJztcbmltcG9ydCBybmcgZnJvbSAnLi9ybmcuanMnO1xuaW1wb3J0IHsgdW5zYWZlU3RyaW5naWZ5IH0gZnJvbSAnLi9zdHJpbmdpZnkuanMnO1xuXG5mdW5jdGlvbiB2NChvcHRpb25zLCBidWYsIG9mZnNldCkge1xuICBpZiAobmF0aXZlLnJhbmRvbVVVSUQgJiYgIWJ1ZiAmJiAhb3B0aW9ucykge1xuICAgIHJldHVybiBuYXRpdmUucmFuZG9tVVVJRCgpO1xuICB9XG5cbiAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gIGNvbnN0IHJuZHMgPSBvcHRpb25zLnJhbmRvbSB8fCAob3B0aW9ucy5ybmcgfHwgcm5nKSgpOyAvLyBQZXIgNC40LCBzZXQgYml0cyBmb3IgdmVyc2lvbiBhbmQgYGNsb2NrX3NlcV9oaV9hbmRfcmVzZXJ2ZWRgXG5cbiAgcm5kc1s2XSA9IHJuZHNbNl0gJiAweDBmIHwgMHg0MDtcbiAgcm5kc1s4XSA9IHJuZHNbOF0gJiAweDNmIHwgMHg4MDsgLy8gQ29weSBieXRlcyB0byBidWZmZXIsIGlmIHByb3ZpZGVkXG5cbiAgaWYgKGJ1Zikge1xuICAgIG9mZnNldCA9IG9mZnNldCB8fCAwO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxNjsgKytpKSB7XG4gICAgICBidWZbb2Zmc2V0ICsgaV0gPSBybmRzW2ldO1xuICAgIH1cblxuICAgIHJldHVybiBidWY7XG4gIH1cblxuICByZXR1cm4gdW5zYWZlU3RyaW5naWZ5KHJuZHMpO1xufVxuXG5leHBvcnQgZGVmYXVsdCB2NDsiLCAiLy8gQWRhcHRlZCBmcm9tIENocmlzIFZlbmVzcycgU0hBMSBjb2RlIGF0XG4vLyBodHRwOi8vd3d3Lm1vdmFibGUtdHlwZS5jby51ay9zY3JpcHRzL3NoYTEuaHRtbFxuZnVuY3Rpb24gZihzLCB4LCB5LCB6KSB7XG4gIHN3aXRjaCAocykge1xuICAgIGNhc2UgMDpcbiAgICAgIHJldHVybiB4ICYgeSBeIH54ICYgejtcblxuICAgIGNhc2UgMTpcbiAgICAgIHJldHVybiB4IF4geSBeIHo7XG5cbiAgICBjYXNlIDI6XG4gICAgICByZXR1cm4geCAmIHkgXiB4ICYgeiBeIHkgJiB6O1xuXG4gICAgY2FzZSAzOlxuICAgICAgcmV0dXJuIHggXiB5IF4gejtcbiAgfVxufVxuXG5mdW5jdGlvbiBST1RMKHgsIG4pIHtcbiAgcmV0dXJuIHggPDwgbiB8IHggPj4+IDMyIC0gbjtcbn1cblxuZnVuY3Rpb24gc2hhMShieXRlcykge1xuICBjb25zdCBLID0gWzB4NWE4Mjc5OTksIDB4NmVkOWViYTEsIDB4OGYxYmJjZGMsIDB4Y2E2MmMxZDZdO1xuICBjb25zdCBIID0gWzB4Njc0NTIzMDEsIDB4ZWZjZGFiODksIDB4OThiYWRjZmUsIDB4MTAzMjU0NzYsIDB4YzNkMmUxZjBdO1xuXG4gIGlmICh0eXBlb2YgYnl0ZXMgPT09ICdzdHJpbmcnKSB7XG4gICAgY29uc3QgbXNnID0gdW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KGJ5dGVzKSk7IC8vIFVURjggZXNjYXBlXG5cbiAgICBieXRlcyA9IFtdO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtc2cubGVuZ3RoOyArK2kpIHtcbiAgICAgIGJ5dGVzLnB1c2gobXNnLmNoYXJDb2RlQXQoaSkpO1xuICAgIH1cbiAgfSBlbHNlIGlmICghQXJyYXkuaXNBcnJheShieXRlcykpIHtcbiAgICAvLyBDb252ZXJ0IEFycmF5LWxpa2UgdG8gQXJyYXlcbiAgICBieXRlcyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGJ5dGVzKTtcbiAgfVxuXG4gIGJ5dGVzLnB1c2goMHg4MCk7XG4gIGNvbnN0IGwgPSBieXRlcy5sZW5ndGggLyA0ICsgMjtcbiAgY29uc3QgTiA9IE1hdGguY2VpbChsIC8gMTYpO1xuICBjb25zdCBNID0gbmV3IEFycmF5KE4pO1xuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgTjsgKytpKSB7XG4gICAgY29uc3QgYXJyID0gbmV3IFVpbnQzMkFycmF5KDE2KTtcblxuICAgIGZvciAobGV0IGogPSAwOyBqIDwgMTY7ICsraikge1xuICAgICAgYXJyW2pdID0gYnl0ZXNbaSAqIDY0ICsgaiAqIDRdIDw8IDI0IHwgYnl0ZXNbaSAqIDY0ICsgaiAqIDQgKyAxXSA8PCAxNiB8IGJ5dGVzW2kgKiA2NCArIGogKiA0ICsgMl0gPDwgOCB8IGJ5dGVzW2kgKiA2NCArIGogKiA0ICsgM107XG4gICAgfVxuXG4gICAgTVtpXSA9IGFycjtcbiAgfVxuXG4gIE1bTiAtIDFdWzE0XSA9IChieXRlcy5sZW5ndGggLSAxKSAqIDggLyBNYXRoLnBvdygyLCAzMik7XG4gIE1bTiAtIDFdWzE0XSA9IE1hdGguZmxvb3IoTVtOIC0gMV1bMTRdKTtcbiAgTVtOIC0gMV1bMTVdID0gKGJ5dGVzLmxlbmd0aCAtIDEpICogOCAmIDB4ZmZmZmZmZmY7XG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBOOyArK2kpIHtcbiAgICBjb25zdCBXID0gbmV3IFVpbnQzMkFycmF5KDgwKTtcblxuICAgIGZvciAobGV0IHQgPSAwOyB0IDwgMTY7ICsrdCkge1xuICAgICAgV1t0XSA9IE1baV1bdF07XG4gICAgfVxuXG4gICAgZm9yIChsZXQgdCA9IDE2OyB0IDwgODA7ICsrdCkge1xuICAgICAgV1t0XSA9IFJPVEwoV1t0IC0gM10gXiBXW3QgLSA4XSBeIFdbdCAtIDE0XSBeIFdbdCAtIDE2XSwgMSk7XG4gICAgfVxuXG4gICAgbGV0IGEgPSBIWzBdO1xuICAgIGxldCBiID0gSFsxXTtcbiAgICBsZXQgYyA9IEhbMl07XG4gICAgbGV0IGQgPSBIWzNdO1xuICAgIGxldCBlID0gSFs0XTtcblxuICAgIGZvciAobGV0IHQgPSAwOyB0IDwgODA7ICsrdCkge1xuICAgICAgY29uc3QgcyA9IE1hdGguZmxvb3IodCAvIDIwKTtcbiAgICAgIGNvbnN0IFQgPSBST1RMKGEsIDUpICsgZihzLCBiLCBjLCBkKSArIGUgKyBLW3NdICsgV1t0XSA+Pj4gMDtcbiAgICAgIGUgPSBkO1xuICAgICAgZCA9IGM7XG4gICAgICBjID0gUk9UTChiLCAzMCkgPj4+IDA7XG4gICAgICBiID0gYTtcbiAgICAgIGEgPSBUO1xuICAgIH1cblxuICAgIEhbMF0gPSBIWzBdICsgYSA+Pj4gMDtcbiAgICBIWzFdID0gSFsxXSArIGIgPj4+IDA7XG4gICAgSFsyXSA9IEhbMl0gKyBjID4+PiAwO1xuICAgIEhbM10gPSBIWzNdICsgZCA+Pj4gMDtcbiAgICBIWzRdID0gSFs0XSArIGUgPj4+IDA7XG4gIH1cblxuICByZXR1cm4gW0hbMF0gPj4gMjQgJiAweGZmLCBIWzBdID4+IDE2ICYgMHhmZiwgSFswXSA+PiA4ICYgMHhmZiwgSFswXSAmIDB4ZmYsIEhbMV0gPj4gMjQgJiAweGZmLCBIWzFdID4+IDE2ICYgMHhmZiwgSFsxXSA+PiA4ICYgMHhmZiwgSFsxXSAmIDB4ZmYsIEhbMl0gPj4gMjQgJiAweGZmLCBIWzJdID4+IDE2ICYgMHhmZiwgSFsyXSA+PiA4ICYgMHhmZiwgSFsyXSAmIDB4ZmYsIEhbM10gPj4gMjQgJiAweGZmLCBIWzNdID4+IDE2ICYgMHhmZiwgSFszXSA+PiA4ICYgMHhmZiwgSFszXSAmIDB4ZmYsIEhbNF0gPj4gMjQgJiAweGZmLCBIWzRdID4+IDE2ICYgMHhmZiwgSFs0XSA+PiA4ICYgMHhmZiwgSFs0XSAmIDB4ZmZdO1xufVxuXG5leHBvcnQgZGVmYXVsdCBzaGExOyIsICJpbXBvcnQgdjM1IGZyb20gJy4vdjM1LmpzJztcbmltcG9ydCBzaGExIGZyb20gJy4vc2hhMS5qcyc7XG5jb25zdCB2NSA9IHYzNSgndjUnLCAweDUwLCBzaGExKTtcbmV4cG9ydCBkZWZhdWx0IHY1OyIsICJpbXBvcnQgeyBNYXJrZG93blZpZXcsIFRleHRGaWxlVmlldywgVmlldyB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgUkVGRVJFTkNFX1JFR0VYLCBBQ1RJT05fVFlQRSwgU1ZHX0hPVkVSX0NPTE9SIH0gZnJvbSBcIi4vY29uc3RhbnRzXCI7XG5pbXBvcnQgeyBzdGFydFJlZmVyZW5jZUVmZmVjdCwgZW5kUmVmZXJlbmNlQ3Vyc29yRWZmZWN0IH0gZnJvbSBcIi4vZWZmZWN0c1wiO1xuaW1wb3J0IHtcblx0Z2V0SG92ZXJlZEN1cnNvcixcblx0dXBkYXRlSG92ZXJlZEN1cnNvcixcblx0cmVtb3ZlSG92ZXJlZEN1cnNvcixcblx0Z2V0SG92ZXIsXG59IGZyb20gXCIuL3N0YXRlXCI7XG5pbXBvcnQgeyB1cGRhdGVIb3ZlcmVkQ3Vyc29yQ29sb3IgfSBmcm9tIFwiLi9yZWZlcmVuY2VzXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZUVkaXRvclBvc2l0aW9uKHBvc2l0aW9uU3RyaW5nOiBzdHJpbmcpIHtcblx0bGV0IFtsaW5lLCBjaF0gPSBwb3NpdGlvblN0cmluZy5zcGxpdChcIixcIik7XG5cdHJldHVybiB7IGxpbmU6IHBhcnNlSW50KGxpbmUpLCBjaDogcGFyc2VJbnQoY2gpIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBlbmNvZGVVUklDb21wb25lbnRTdHJpbmcoc3RyOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRyZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KHN0cikucmVwbGFjZSgvWzooKV0vZywgZnVuY3Rpb24gKGMpIHtcblx0XHRyZXR1cm4gXCIlXCIgKyBjLmNoYXJDb2RlQXQoMCkudG9TdHJpbmcoMTYpO1xuXHR9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRlY29kZVVSSUNvbXBvbmVudFN0cmluZyhzdHI6IHN0cmluZyk6IHN0cmluZyB7XG5cdHJldHVybiBkZWNvZGVVUklDb21wb25lbnQoXG5cdFx0c3RyLnJlcGxhY2UoLyUzQS9nLCBcIjpcIikucmVwbGFjZSgvJTI4L2csIFwiKFwiKS5yZXBsYWNlKC8lMjkvZywgXCIpXCIpXG5cdCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwcm9jZXNzVVJJKFxuXHRkYXRhU3RyaW5nOiBzdHJpbmdcbik6IFtcblx0cHJlZml4OiBzdHJpbmcsXG5cdHRleHQ6IHN0cmluZyxcblx0c3VmZml4OiBzdHJpbmcsXG5cdGZpbGU6IHN0cmluZyxcblx0ZnJvbTogbnVtYmVyLFxuXHR0bzogbnVtYmVyLFxuXHRwb3J0YWw6IHN0cmluZyxcblx0dG9nZ2xlOiBzdHJpbmdcbl0ge1xuXHRsZXQgW3ByZWZpeCwgdGV4dCwgc3VmZml4LCBmaWxlLCBmcm9tLCB0bywgcG9ydGFsLCB0b2dnbGVdID1cblx0XHRkYXRhU3RyaW5nLnNwbGl0KFwiOlwiKTtcblx0cHJlZml4ID0gZGVjb2RlVVJJQ29tcG9uZW50U3RyaW5nKHByZWZpeCk7XG5cdHRleHQgPSBkZWNvZGVVUklDb21wb25lbnRTdHJpbmcodGV4dCk7XG5cdHN1ZmZpeCA9IGRlY29kZVVSSUNvbXBvbmVudFN0cmluZyhzdWZmaXgpO1xuXHRmaWxlID0gZGVjb2RlVVJJQ29tcG9uZW50U3RyaW5nKGZpbGUpO1xuXHRmcm9tID0gZGVjb2RlVVJJQ29tcG9uZW50U3RyaW5nKGZyb20pO1xuXHR0byA9IGRlY29kZVVSSUNvbXBvbmVudFN0cmluZyh0byk7XG5cdGlmIChwb3J0YWwpIHBvcnRhbCA9IGRlY29kZVVSSUNvbXBvbmVudFN0cmluZyhwb3J0YWwpO1xuXHR0b2dnbGUgPSBkZWNvZGVVUklDb21wb25lbnRTdHJpbmcodG9nZ2xlKTtcblxuXHRyZXR1cm4gW1xuXHRcdHByZWZpeCxcblx0XHR0ZXh0LFxuXHRcdHN1ZmZpeCxcblx0XHRmaWxlLFxuXHRcdHBhcnNlSW50KGZyb20pLFxuXHRcdHBhcnNlSW50KHRvKSxcblx0XHRwb3J0YWwsXG5cdFx0dG9nZ2xlLFxuXHRdO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0UHJlZml4QW5kU3VmZml4KGRvY3VtZW50OiBzdHJpbmcsIGZyb206IG51bWJlciwgdG86IG51bWJlcikge1xuXHRsZXQgcHJlZml4ID0gZG9jdW1lbnRcblx0XHQuc2xpY2UoZnJvbSAtIDI1LCBmcm9tKVxuXHRcdC5zcGxpdChcIlxcblwiKVxuXHRcdC5zbGljZSgtMSlbMF07XG5cdC8vIC5zbGljZShmcm9tIC0gMjUgPiAwID8gZnJvbSAtIDI1IDogMCwgZnJvbSlcblxuXHRsZXQgc3VmZml4ID0gZG9jdW1lbnQuc2xpY2UodG8sIHRvICsgMjUpLnNwbGl0KFwiXFxuXCIpWzBdO1xuXHRyZXR1cm4geyBwcmVmaXgsIHN1ZmZpeCB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZmluZFRleHRQb3NpdGlvbnMoXG5cdHRleHQ6IHN0cmluZyxcblx0c2VhcmNoVGVybTogc3RyaW5nLFxuXHRwcmVmaXg6IHN0cmluZyA9IFwiXCIsXG5cdHN1ZmZpeDogc3RyaW5nID0gXCJcIlxuKSB7XG5cdGxldCByb2xsaW5nSW5kZXggPSAwO1xuXG5cdGNvbnN0IGxpbmVzID0gdGV4dC5zcGxpdChcIlxcblwiKS5tYXAoKGxpbmU6IHN0cmluZywgaTogbnVtYmVyKSA9PiB7XG5cdFx0bGV0IGRhdGEgPSB7IGxpbmUsIGluZGV4OiByb2xsaW5nSW5kZXgsIGxlbmd0aDogbGluZS5sZW5ndGggKyAxLCBpIH07XG5cdFx0cm9sbGluZ0luZGV4ICs9IGRhdGEubGVuZ3RoO1xuXHRcdHJldHVybiBkYXRhO1xuXHR9KTtcblxuXHRpZiAodGV4dC5pbmNsdWRlcyhwcmVmaXggKyBzZWFyY2hUZXJtICsgc3VmZml4KSkge1xuXHRcdGxldCBtYXRjaEluZGV4ID0gdGV4dC5pbmRleE9mKHByZWZpeCArIHNlYXJjaFRlcm0gKyBzdWZmaXgpO1xuXHRcdGxldCBzdGFydEluZGV4ID1cblx0XHRcdGxpbmVzLmZpbmRJbmRleCgobGluZTogYW55KSA9PiBsaW5lLmluZGV4ID4gbWF0Y2hJbmRleCArIHByZWZpeC5sZW5ndGgpIC1cblx0XHRcdDE7XG5cdFx0bGV0IGVuZEluZGV4ID1cblx0XHRcdGxpbmVzLmZpbmRJbmRleChcblx0XHRcdFx0KGxpbmU6IGFueSkgPT5cblx0XHRcdFx0XHRsaW5lLmluZGV4ID4gbWF0Y2hJbmRleCArIHByZWZpeC5sZW5ndGggKyBzZWFyY2hUZXJtLmxlbmd0aFxuXHRcdFx0KSAtIDE7XG5cblx0XHRpZiAoc3RhcnRJbmRleCA9PSAtMikgc3RhcnRJbmRleCA9IGxpbmVzLmxlbmd0aCAtIDE7XG5cdFx0aWYgKGVuZEluZGV4ID09IC0yKSBlbmRJbmRleCA9IGxpbmVzLmxlbmd0aCAtIDE7XG5cblx0XHRyZXR1cm4ge1xuXHRcdFx0cmFuZ2VTdGFydDoge1xuXHRcdFx0XHRsaW5lOiBzdGFydEluZGV4LFxuXHRcdFx0XHRjaDogbWF0Y2hJbmRleCArIHByZWZpeC5sZW5ndGggLSBsaW5lc1tzdGFydEluZGV4XS5pbmRleCxcblx0XHRcdH0sXG5cdFx0XHRyYW5nZUVuZDoge1xuXHRcdFx0XHRsaW5lOiBlbmRJbmRleCxcblx0XHRcdFx0Y2g6XG5cdFx0XHRcdFx0bWF0Y2hJbmRleCArXG5cdFx0XHRcdFx0cHJlZml4Lmxlbmd0aCArXG5cdFx0XHRcdFx0c2VhcmNoVGVybS5sZW5ndGggLVxuXHRcdFx0XHRcdGxpbmVzW2VuZEluZGV4XS5pbmRleCxcblx0XHRcdH0sXG5cdFx0XHRsaW5lcyxcblx0XHR9O1xuXHR9XG5cdHJldHVybiBudWxsO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbGlzdEl0ZW1MZW5ndGgobGluZTogc3RyaW5nKSB7XG5cdC8vIE1hdGNoZXMgbGluZXMgdGhhdCBzdGFydCB3aXRoIGEgYnVsbGV0IChlaXRoZXIgLSwgKiwgb3IgKyBmb2xsb3dlZCBieSBhIHNwYWNlKVxuXHRjb25zdCBidWxsZXRSZWdleCA9IC9eKFxccypbLSorXVxccyspLztcblxuXHQvLyBNYXRjaGVzIGxpbmVzIHRoYXQgc3RhcnQgd2l0aCBhIG51bWJlciBmb2xsb3dlZCBieSBhIGRvdCBhbmQgYSBzcGFjZSAobGlrZSBcIjEuIFwiKVxuXHRjb25zdCBudW1iZXJSZWdleCA9IC9eKFxccypcXGQrXFwuXFxzKykvO1xuXG5cdGxldCBtYXRjaCA9IGxpbmUubWF0Y2goYnVsbGV0UmVnZXgpIHx8IGxpbmUubWF0Y2gobnVtYmVyUmVnZXgpO1xuXHRyZXR1cm4gbWF0Y2ggPyBtYXRjaFswXS5sZW5ndGggOiAwO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY2hlY2tDdXJzb3JQb3NpdGlvbkF0RGF0YXN0cmluZyhldnQ6IEV2ZW50KToge1xuXHRtYXRjaGVkOiBib29sZWFuO1xuXHRzcGFuOiBIVE1MU3BhbkVsZW1lbnQgfCB1bmRlZmluZWQ7XG59IHtcblx0Y29uc3QgYWN0aXZlVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG5cdGNvbnN0IGN1cnNvckZyb20gPSBhY3RpdmVWaWV3Py5lZGl0b3IuZ2V0Q3Vyc29yKFwiZnJvbVwiKTtcblx0Y29uc3QgY3Vyc29yVG8gPSBhY3RpdmVWaWV3Py5lZGl0b3IuZ2V0Q3Vyc29yKFwidG9cIik7XG5cblx0bGV0IG1hdGNoZWQgPSBmYWxzZTtcblx0bGV0IG1hdGNoU3BhbjogSFRNTFNwYW5FbGVtZW50IHwgdW5kZWZpbmVkID0gdW5kZWZpbmVkO1xuXHRpZiAoXG5cdFx0Y3Vyc29yRnJvbSAmJlxuXHRcdGN1cnNvclRvICYmXG5cdFx0Y3Vyc29yRnJvbS5jaCA9PSBjdXJzb3JUby5jaCAmJlxuXHRcdGN1cnNvckZyb20ubGluZSA9PSBjdXJzb3JUby5saW5lXG5cdFx0Ly8gJiZjdXJzb3JGcm9tLmNoIC0gMSA+PSAtMVxuXHQpIHtcblx0XHRjb25zdCBsaW5lVGV4dCA9IGFjdGl2ZVZpZXc/LmVkaXRvci5nZXRMaW5lKGN1cnNvckZyb20ubGluZSk7XG5cblx0XHQvLyBmcm9tIHBvc3NpYmxlIHJlZ2V4IG1hdGNoZXMgaW4gbGluZVRleHRcblx0XHRpZiAobGluZVRleHQpIHtcblx0XHRcdGNvbnN0IG1hdGNoZXMgPSBbLi4ubGluZVRleHQubWF0Y2hBbGwoUkVGRVJFTkNFX1JFR0VYKV07XG5cdFx0XHRtYXRjaGVzLmZvckVhY2goKG1hdGNoKSA9PiB7XG5cdFx0XHRcdGlmIChtYXRjaC5pbmRleD8udG9TdHJpbmcoKSkge1xuXHRcdFx0XHRcdGNvbnN0IHN0YXJ0OiBudW1iZXIgPSBtYXRjaC5pbmRleDtcblx0XHRcdFx0XHRjb25zdCBlbmQ6IG51bWJlciA9IHN0YXJ0ICsgbWF0Y2hbMF0ubGVuZ3RoO1xuXHRcdFx0XHRcdGlmIChlbmQgPT0gY3Vyc29yVG8uY2ggJiYgZXZ0LnRhcmdldCkge1xuXHRcdFx0XHRcdFx0Y29uc3QgZGF0YVN0cmluZyA9IG1hdGNoWzFdO1xuXHRcdFx0XHRcdFx0Ly8gZ2V0IHRoZSBodG1sIGVsZW1lbnQgYXQgdGhlIG1hdGNoIGxvY2F0aW9uXG5cdFx0XHRcdFx0XHRsZXQgY2hlY2tDb250YWluZXIgPSBldnQudGFyZ2V0IGluc3RhbmNlb2YgRWxlbWVudDtcblx0XHRcdFx0XHRcdGlmICghY2hlY2tDb250YWluZXIpXG5cdFx0XHRcdFx0XHRcdHRocm93IG5ldyBFcnJvcihcIkVsZW1lbnQgbm90IGluc3RhbmNlIG9mIEVsZW1lbnRcIik7XG5cdFx0XHRcdFx0XHRsZXQgY29udGFpbmVyID0gZXZ0LnRhcmdldCBhcyBFbGVtZW50O1xuXG5cdFx0XHRcdFx0XHQvLyBsZXQgYWN0aXZlTGluZTtcblx0XHRcdFx0XHRcdC8vIGlmIChjb250YWluZXIuY2xhc3NMaXN0LmNvbnRhaW5zKFwiY20tYWN0aXZlXCIpKSB7XG5cdFx0XHRcdFx0XHQvLyBcdGFjdGl2ZUxpbmUgPSBjb250YWluZXI7XG5cdFx0XHRcdFx0XHQvLyB9XG5cdFx0XHRcdFx0XHQvLyAvLyBlbHNlIGlmIChjb250YWluZXIuY2xvc2VzdChcIi5jbS1hY3RpdmVcIikpIHtcblx0XHRcdFx0XHRcdC8vIC8vIFx0YWN0aXZlTGluZSA9IGNvbnRhaW5lci5jbG9zZXN0KFwiLmNtLWFjdGl2ZVwiKTtcblx0XHRcdFx0XHRcdC8vIC8vIH1cblx0XHRcdFx0XHRcdC8vIGVsc2Uge1xuXHRcdFx0XHRcdFx0Ly8gXHRhY3RpdmVMaW5lID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCIuY20tYWN0aXZlXCIpO1xuXHRcdFx0XHRcdFx0Ly8gfVxuXHRcdFx0XHRcdFx0Ly8gaWYgKCFhY3RpdmVMaW5lKSB0aHJvdyBuZXcgRXJyb3IoXCJFbGVtZW50IG5vdCBpbnN0YW5jZSBvZiBFbGVtZW50XCIpO1xuXHRcdFx0XHRcdFx0Ly8gZmluZCBodG1sIHNwYW4gZWxlbWVudCBpbiB0YXJnZXQgdGhhdCBoYXMgYSBkYXRhIGF0dHJpYnV0ZSBlcXVhbCB0byBjb250ZW50c1xuXHRcdFx0XHRcdFx0bGV0IHNwYW4gPSBjb250YWluZXI7XG5cdFx0XHRcdFx0XHRpZiAoIXNwYW4uZ2V0QXR0cmlidXRlKFwiZGF0YVwiKSlcblx0XHRcdFx0XHRcdFx0c3BhbiA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFxuXHRcdFx0XHRcdFx0XHRcdGBzcGFuW2RhdGE9XCIke2RhdGFTdHJpbmd9XCJdYFxuXHRcdFx0XHRcdFx0XHQpIGFzIEhUTUxTcGFuRWxlbWVudDtcblxuXHRcdFx0XHRcdFx0aWYgKHNwYW4gJiYgc3BhbiBpbnN0YW5jZW9mIEhUTUxTcGFuRWxlbWVudCkge1xuXHRcdFx0XHRcdFx0XHQvLyBjb25zb2xlLmxvZyhcIkZvdW5kIHNwYW4gZWxlbWVudDpcIiwgc3Bhbik7XG5cdFx0XHRcdFx0XHRcdC8vIERvIHNvbWV0aGluZyB3aXRoIHRoZSBzcGFuIGVsZW1lbnRcblx0XHRcdFx0XHRcdFx0bWF0Y2hlZCA9IHRydWU7XG5cblx0XHRcdFx0XHRcdFx0bWF0Y2hTcGFuID0gc3Bhbjtcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdC8vIGNvbnNvbGUubG9nKFwiU3BhbiBlbGVtZW50IG5vdCBmb3VuZFwiKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH1cblx0fVxuXHRyZXR1cm4geyBtYXRjaGVkLCBzcGFuOiBtYXRjaFNwYW4gfTtcbn1cblxuLy8gUmVtb3ZlIGFuIGV4aXN0bWFpbmluZyBoaWdsaWdodGVkIHJlZmVyZW5jZVxuZXhwb3J0IGZ1bmN0aW9uIGhhbmRsZVJlbW92ZUhvdmVyZWRDdXJzb3IodXNlcjogc3RyaW5nKSB7XG5cdGlmIChnZXRIb3ZlcmVkQ3Vyc29yKCkpIHtcblx0XHQvLyBjdXJzb3JzIG5vdCBhc3NvY2lhdGVkIHdpdGggdGhlIHVzZXIgYWN0aW9uXG5cdFx0bGV0IG5vbkN1cnNvcnMgPSBnZXRIb3ZlcmVkQ3Vyc29yKClcblx0XHRcdC5maWx0ZXIoKGVsZW1lbnQ6IGFueSkgPT4ge1xuXHRcdFx0XHRyZXR1cm4gZWxlbWVudC51c2VyICE9PSB1c2VyO1xuXHRcdFx0fSlcblx0XHRcdC5tYXAoKGVsZW1lbnQ6IGFueSkgPT4gZWxlbWVudC5jdXJzb3IuY2xvc2VzdChcInNwYW5cIikpO1xuXG5cdFx0Ly8gd2hpdGUgYmFja2dyb3VuZCBpZiBjdXJzb3JzIGFyZSBub3QgYXNzb2NpYXRlZCB3aXRoIHRoZSB1c2VyIGFjdGlvblxuXHRcdGdldEhvdmVyZWRDdXJzb3IoKVxuXHRcdFx0LmZpbHRlcigoZWxlbWVudDogYW55KSA9PiBlbGVtZW50LnVzZXIgPT09IHVzZXIpXG5cdFx0XHQuZm9yRWFjaCgoZWxlbWVudDogYW55KSA9PiB7XG5cdFx0XHRcdGlmICghbm9uQ3Vyc29ycy5pbmNsdWRlcyhlbGVtZW50LmN1cnNvci5jbG9zZXN0KFwic3BhblwiKSkpIHtcblx0XHRcdFx0XHRsZXQgc3ZnID0gZWxlbWVudC5jdXJzb3I7XG5cdFx0XHRcdFx0aWYgKCFzdmcpIHRocm93IG5ldyBFcnJvcihcIlNWRyBub3QgZm91bmRcIik7XG5cdFx0XHRcdFx0aWYgKHN2Zy5jbGFzc0xpc3QuY29udGFpbnMoXCJyZWZlcmVuY2UtaWNvblwiKSlcblx0XHRcdFx0XHRcdHN2Zy5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIndoaXRlXCI7XG5cdFx0XHRcdFx0ZWxzZSB7XG5cdFx0XHRcdFx0XHRzdmcuc2V0QXR0cmlidXRlKFwiZmlsbFwiLCBcIndoaXRlXCIpO1xuXHRcdFx0XHRcdFx0c3ZnLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiXCI7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGVsZW1lbnQuY3Vyc29yLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwid2hpdGVcIjtcblx0XHRcdFx0XHQvLyBlbGVtZW50LmN1cnNvci5zdHlsZS5ib3hTaGFkb3cgPSBcIm5vbmVcIjtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cblx0XHRyZW1vdmVIb3ZlcmVkQ3Vyc29yKHVzZXIpO1xuXHR9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjaGVja0ZvY3VzQ3Vyc29yKGV2dDogRXZlbnQpIHtcblx0bGV0IHsgbWF0Y2hlZCwgc3BhbiB9ID0gY2hlY2tDdXJzb3JQb3NpdGlvbkF0RGF0YXN0cmluZyhldnQpO1xuXG5cdGNvbnNvbGUubG9nKG1hdGNoZWQpO1xuXHRjb25zb2xlLmxvZyhzcGFuKTtcblxuXHRpZiAobWF0Y2hlZCAmJiBzcGFuKSB7XG5cdFx0YXdhaXQgZW5kUmVmZXJlbmNlQ3Vyc29yRWZmZWN0KCk7IC8vIHRoaXMgdGFrZXMgMTAwbXMgdG8gY2xvc2UgZXhpc3RpbmcgcGVlayB0YWJcblx0XHRoYW5kbGVSZW1vdmVIb3ZlcmVkQ3Vyc29yKEFDVElPTl9UWVBFLkNVUlNPUik7XG5cdFx0dXBkYXRlSG92ZXJlZEN1cnNvckNvbG9yKHNwYW4sIEFDVElPTl9UWVBFLkNVUlNPUik7XG5cdFx0YXdhaXQgc3RhcnRSZWZlcmVuY2VFZmZlY3Qoc3BhbiwgQUNUSU9OX1RZUEUuQ1VSU09SKTtcblx0fSBlbHNlIHtcblx0XHRhd2FpdCBlbmRSZWZlcmVuY2VDdXJzb3JFZmZlY3QoKTtcblx0XHRoYW5kbGVSZW1vdmVIb3ZlcmVkQ3Vyc29yKEFDVElPTl9UWVBFLkNVUlNPUik7XG5cdH1cbn1cbiIsICJpbXBvcnQge1xuXHRUQWJzdHJhY3RGaWxlLFxuXHRURmlsZSxcblx0V29ya3NwYWNlLFxuXHRXb3Jrc3BhY2VMZWFmLFxuXHRXb3Jrc3BhY2VSb290LFxuXHRXb3Jrc3BhY2VTcGxpdCxcblx0V29ya3NwYWNlVGFicyxcbn0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBnZXRUaGF0IH0gZnJvbSBcIi4vc3RhdGVcIjtcblxuZnVuY3Rpb24gY29sbGVjdExlYXZlc0J5VGFiKFxuXHRzcGxpdDogV29ya3NwYWNlU3BsaXQsXG5cdHJlc3VsdDogW1dvcmtzcGFjZUxlYWZbXV0gfCBbXSA9IFtdXG4pIHtcblx0Ly8gQHRzLWlnbm9yZVxuXHRjb25zdCB0eXBlID0gc3BsaXQudHlwZTtcblx0aWYgKCF0eXBlKSB0aHJvdyBuZXcgRXJyb3IoXCJTcGxpdCB0eXBlIG5vdCBmb3VuZFwiKTtcblxuXHRpZiAodHlwZSA9PSBcInRhYnNcIiB8fCB0eXBlID09IFwic3BsaXRcIikge1xuXHRcdC8vIEB0cy1pZ25vcmVcblx0XHRjb25zdCBjaGlsZHJlbiA9IHNwbGl0LmNoaWxkcmVuO1xuXHRcdGlmICghY2hpbGRyZW4pIHRocm93IG5ldyBFcnJvcihcIlNwbGl0IGNoaWxkcmVuIG5vdCBmb3VuZFwiKTtcblxuXHRcdGlmIChjaGlsZHJlbikge1xuXHRcdFx0Zm9yIChjb25zdCBjaGlsZCBvZiBjaGlsZHJlbikge1xuXHRcdFx0XHRsZXQgZW1wdHlMaXN0OiBXb3Jrc3BhY2VMZWFmW10gPSBbXTtcblxuXHRcdFx0XHRjb2xsZWN0TGVhdmVzQnlUYWIoY2hpbGQsIHJlc3VsdCk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdC8vIHJlc3VsdC5wdXNoKFtdKTtcblx0XHQvLyBjb2xsZWN0TGVhdmVzQnlUYWIoY2hpbGRyZW4sIHJlc3VsdCk7XG5cdH0gZWxzZSBpZiAodHlwZSA9PSBcImxlYWZcIikge1xuXHRcdC8vIEB0cy1pZ25vcmVcblx0XHRjb25zdCBwYXJlbnRTcGxpdElkID0gc3BsaXQucGFyZW50LmlkO1xuXHRcdGlmICghcGFyZW50U3BsaXRJZCkgdGhyb3cgbmV3IEVycm9yKFwiU3BsaXQgcGFyZW50IGlkIG5vdCBmb3VuZFwiKTtcblxuXHRcdC8vIGZpbmQgYXJyYXkgaW5kZXggZm9yIHNwbGl0IHdpdGggaWQgcGFyZW50U3BsaXRJZFxuXHRcdGxldCBpZHggPSByZXN1bHQuZmluZEluZGV4KCh0YWI6IFdvcmtzcGFjZUxlYWZbXSkgPT4ge1xuXHRcdFx0Ly8gQHRzLWlnbm9yZVxuXHRcdFx0Y29uc3QgdGFiSWQgPSB0YWJbMF0ucGFyZW50LmlkO1xuXHRcdFx0cmV0dXJuIHRhYklkID09IHBhcmVudFNwbGl0SWQ7XG5cdFx0fSk7XG5cdFx0aWYgKGlkeCA9PSAtMSkge1xuXHRcdFx0Ly8gQHRzLWlnbm9yZVxuXHRcdFx0cmVzdWx0LnB1c2goW3NwbGl0IGFzIFdvcmtzcGFjZUxlYWZdKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0cmVzdWx0W2lkeF0ucHVzaChzcGxpdCBhcyBXb3Jrc3BhY2VMZWFmKTtcblx0XHR9XG5cdH1cblxuXHQvLyBpZiAoY2hpbGRyZW4pIHtcblx0Ly8gXHRmb3IgKGNvbnN0IGNoaWxkIG9mIGNoaWxkcmVuKSB7XG5cdC8vIFx0XHRjb2xsZWN0TGVhdmVzQnlUYWIoY2hpbGQsIHJlc3VsdCk7XG5cdC8vIFx0fVxuXHQvLyB9XG5cdHJldHVybiByZXN1bHQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjb2xsZWN0TGVhdmVzQnlUYWJIZWxwZXIoKSB7XG5cdGNvbnN0IHsgd29ya3NwYWNlIH0gPSBnZXRUaGF0KCk7XG5cdGNvbnN0IGN1cnJMZWFmOiBXb3Jrc3BhY2VMZWFmID0gd29ya3NwYWNlLmdldExlYWYoKTtcblx0Ly8gY29uc3Qgcm9vdFNwbGl0ID0gZmluZFJvb3RTcGxpdChjdXJyTGVhZik7XG5cdGNvbnN0IHJvb3RTcGxpdDogV29ya3NwYWNlU3BsaXQgPSBjdXJyTGVhZi5nZXRSb290KCk7XG5cdHJldHVybiBjb2xsZWN0TGVhdmVzQnlUYWIocm9vdFNwbGl0KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEN1cnJlbnRUYWJJbmRleChsZWF2ZXNCeVRhYjogYW55W10sIHNwYW46IEhUTUxTcGFuRWxlbWVudCkge1xuXHRsZXQgd29ya3NwYWNlVGFiID0gc3Bhbi5jbG9zZXN0KFwiLndvcmtzcGFjZS10YWJzXCIpO1xuXHRsZXQgY3VyclRhYklkeCA9IGxlYXZlc0J5VGFiLmZpbmRJbmRleCgodGFiOiBXb3Jrc3BhY2VMZWFmW10pID0+IHtcblx0XHRjb25zdCBsZWFmVGFiID0gdGFiWzBdLnZpZXcuY29udGFpbmVyRWwuY2xvc2VzdChcIi53b3Jrc3BhY2UtdGFic1wiKTtcblx0XHRyZXR1cm4gbGVhZlRhYiA9PSB3b3Jrc3BhY2VUYWI7XG5cdH0pO1xuXHRyZXR1cm4gY3VyclRhYklkeDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEFkamFjZW50VGFicyhcblx0bGVhdmVzQnlUYWI6IGFueVtdLFxuXHRjdXJyVGFiSWR4OiBudW1iZXIsXG5cdGZpbGU6IHN0cmluZ1xuKSB7XG5cdGxldCByaWdodEFkamFjZW50VGFiOiBhbnlbXSA9IFtdO1xuXHRsZXQgbGVmdEFkamFjZW50VGFiOiBhbnlbXSA9IFtdO1xuXHRsZXQgYWRqYWNlbnRUYWJzOiBhbnlbXSA9IFtdO1xuXG5cdGlmIChsZWF2ZXNCeVRhYltjdXJyVGFiSWR4ICsgMV0pIHtcblx0XHRyaWdodEFkamFjZW50VGFiID0gbGVhdmVzQnlUYWJbY3VyclRhYklkeCArIDFdO1xuXHRcdGFkamFjZW50VGFicyA9IFsuLi5hZGphY2VudFRhYnMsIC4uLnJpZ2h0QWRqYWNlbnRUYWJdO1xuXHR9XG5cdGlmIChsZWF2ZXNCeVRhYltjdXJyVGFiSWR4IC0gMV0pIHtcblx0XHRsZWZ0QWRqYWNlbnRUYWIgPSBsZWF2ZXNCeVRhYltjdXJyVGFiSWR4IC0gMV07XG5cdFx0YWRqYWNlbnRUYWJzID0gWy4uLmFkamFjZW50VGFicywgLi4ubGVmdEFkamFjZW50VGFiXTtcblx0fVxuXG5cdGxldCBpbmRleCA9IGFkamFjZW50VGFicy5maW5kSW5kZXgoXG5cdFx0KHg6IFdvcmtzcGFjZUxlYWYpID0+IHguZ2V0Vmlld1N0YXRlKCkuc3RhdGUuZmlsZSA9PSBmaWxlXG5cdCk7XG5cdHJldHVybiB7IGFkamFjZW50VGFicywgcmlnaHRBZGphY2VudFRhYiwgbGVmdEFkamFjZW50VGFiLCBpbmRleCB9O1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gb3BlbkZpbGVJbkFkamFjZW50VGFiKFxuXHRsZWF2ZXNCeVRhYjogYW55W10sXG5cdGN1cnJUYWJJZHg6IG51bWJlcixcblx0ZmlsZTogc3RyaW5nLFxuXHR0eXBlPzogc3RyaW5nXG4pIHtcblx0bGV0IHsgYWRqYWNlbnRUYWJzLCByaWdodEFkamFjZW50VGFiLCBsZWZ0QWRqYWNlbnRUYWIgfSA9IGdldEFkamFjZW50VGFicyhcblx0XHRsZWF2ZXNCeVRhYixcblx0XHRjdXJyVGFiSWR4LFxuXHRcdGZpbGVcblx0KTtcblxuXHRsZXQgYWxsVGFiTmFtZXMgPSBsZWF2ZXNCeVRhYi5tYXAoKHRhYjogV29ya3NwYWNlTGVhZltdKSA9PlxuXHRcdHRhYi5tYXAoKHg6IFdvcmtzcGFjZUxlYWYpID0+IHguZ2V0Vmlld1N0YXRlKCkuc3RhdGUuZmlsZSlcblx0KTtcblx0bGV0IHJpZ2h0QWRqYWNlbnRUYWJOYW1lcyA9IHJpZ2h0QWRqYWNlbnRUYWIubWFwKFxuXHRcdCh4OiBXb3Jrc3BhY2VMZWFmKSA9PiB4LmdldFZpZXdTdGF0ZSgpLnN0YXRlLmZpbGVcblx0KTtcblx0bGV0IGxlZnRBZGphY2VudFRhYk5hbWVzID0gbGVmdEFkamFjZW50VGFiLm1hcChcblx0XHQoeDogV29ya3NwYWNlTGVhZikgPT4geC5nZXRWaWV3U3RhdGUoKS5zdGF0ZS5maWxlXG5cdCk7XG5cdGNvbnN0IHsgd29ya3NwYWNlIH0gPSBnZXRUaGF0KCk7XG5cdGlmIChcblx0XHRhbGxUYWJOYW1lc1xuXHRcdFx0LmZpbHRlcigodiwgaSkgPT4gaSAhPSBjdXJyVGFiSWR4KVxuXHRcdFx0LmZsYXQoKVxuXHRcdFx0LmluY2x1ZGVzKGZpbGUpICYmXG5cdFx0IXJpZ2h0QWRqYWNlbnRUYWJOYW1lcy5pbmNsdWRlcyhmaWxlKSAmJlxuXHRcdCFsZWZ0QWRqYWNlbnRUYWJOYW1lcy5pbmNsdWRlcyhmaWxlKVxuXHQpIHtcblx0XHQvLyBmaWxlIGV4aXN0cywgbm90IGFkamFjZW50IGxlZnQgb3IgcmlnaHQgdGFiXG5cdFx0bGV0IGN1cnJlbnRUYWJOYW1lczogYW55W10gPSBbXTtcblx0XHRsZXQgY3VycmVudFRhYjogYW55W10gPSBbXTtcblx0XHRhbGxUYWJOYW1lcy5mb3JFYWNoKCh0YWJOYW1lcywgaSkgPT4ge1xuXHRcdFx0aWYgKFxuXHRcdFx0XHR0YWJOYW1lcyAhPSByaWdodEFkamFjZW50VGFiTmFtZXMgJiZcblx0XHRcdFx0dGFiTmFtZXMgIT0gbGVmdEFkamFjZW50VGFiTmFtZXMgJiZcblx0XHRcdFx0Y3VyclRhYklkeCAhPSBpXG5cdFx0XHQpIHtcblx0XHRcdFx0aWYgKHRhYk5hbWVzLmluY2x1ZGVzKGZpbGUpKSB7XG5cdFx0XHRcdFx0Y3VycmVudFRhYk5hbWVzID0gdGFiTmFtZXM7XG5cdFx0XHRcdFx0Y3VycmVudFRhYiA9IGxlYXZlc0J5VGFiW2ldO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRjb25zdCBvcmlnaW5hbExlYWYgPSBjdXJyZW50VGFiLmZpbHRlcihcblx0XHRcdCh0KSA9PiB0LmNvbnRhaW5lckVsLnN0eWxlLmRpc3BsYXkgIT0gXCJub25lXCJcblx0XHQpWzBdO1xuXHRcdGxldCBsZWFmID0gY3VycmVudFRhYltjdXJyZW50VGFiTmFtZXMuaW5kZXhPZihmaWxlKV07XG5cdFx0d29ya3NwYWNlLnJldmVhbExlYWYobGVhZik7XG5cblx0XHRyZXR1cm4geyBuZXdMZWFmOiBsZWFmLCB0ZW1wOiBmYWxzZSwgb3JpZ2luYWxMZWFmIH07XG5cdH0gZWxzZSBpZiAocmlnaHRBZGphY2VudFRhYk5hbWVzLmluY2x1ZGVzKGZpbGUpKSB7XG5cdFx0Ly8gZmlsZSBleGlzdHMgaW4gcmlnaHQgdGFiXG5cdFx0Y29uc3Qgb3JpZ2luYWxMZWFmID0gcmlnaHRBZGphY2VudFRhYi5maWx0ZXIoXG5cdFx0XHQodCkgPT4gdC5jb250YWluZXJFbC5zdHlsZS5kaXNwbGF5ICE9IFwibm9uZVwiXG5cdFx0KVswXTtcblx0XHRsZXQgbGVhZiA9IHJpZ2h0QWRqYWNlbnRUYWJbcmlnaHRBZGphY2VudFRhYk5hbWVzLmluZGV4T2YoZmlsZSldO1xuXHRcdHdvcmtzcGFjZS5yZXZlYWxMZWFmKGxlYWYpO1xuXHRcdHJldHVybiB7IG5ld0xlYWY6IGxlYWYsIHRlbXA6IGZhbHNlLCBvcmlnaW5hbExlYWYgfTtcblx0fSBlbHNlIGlmIChsZWZ0QWRqYWNlbnRUYWJOYW1lcy5pbmNsdWRlcyhmaWxlKSkge1xuXHRcdC8vIGZpbGUgZXhpc3RzIGluIGxlZnQgdGFiXG5cdFx0Y29uc3Qgb3JpZ2luYWxMZWFmID0gbGVmdEFkamFjZW50VGFiLmZpbHRlcihcblx0XHRcdCh0KSA9PiB0LmNvbnRhaW5lckVsLnN0eWxlLmRpc3BsYXkgIT0gXCJub25lXCJcblx0XHQpWzBdO1xuXG5cdFx0bGV0IGxlYWYgPSBsZWZ0QWRqYWNlbnRUYWJbbGVmdEFkamFjZW50VGFiTmFtZXMuaW5kZXhPZihmaWxlKV07XG5cdFx0d29ya3NwYWNlLnJldmVhbExlYWYobGVhZik7XG5cdFx0cmV0dXJuIHsgbmV3TGVhZjogbGVhZiwgdGVtcDogZmFsc2UsIG9yaWdpbmFsTGVhZiB9O1xuXHR9IGVsc2UgaWYgKHJpZ2h0QWRqYWNlbnRUYWIubGVuZ3RoID4gMCkge1xuXHRcdC8vIHRoZXJlIGV4aXN0cyBhIHJpZ2h0IHRhYlxuXHRcdGNvbnN0IG9yaWdpbmFsTGVhZiA9IHJpZ2h0QWRqYWNlbnRUYWIuZmlsdGVyKFxuXHRcdFx0KHQpID0+IHQuY29udGFpbmVyRWwuc3R5bGUuZGlzcGxheSAhPSBcIm5vbmVcIlxuXHRcdClbMF07XG5cblx0XHRsZXQgY3VyckxlYWYgPSB3b3Jrc3BhY2UuZ2V0TGVhZigpO1xuXHRcdHdvcmtzcGFjZS5zZXRBY3RpdmVMZWFmKG9yaWdpbmFsTGVhZik7XG5cdFx0bGV0IG5ld0xlYWYgPSB3b3Jrc3BhY2UuZ2V0TGVhZih0cnVlKTtcblx0XHRhd2FpdCBvcGVuRmlsZUluTGVhZihuZXdMZWFmLCBmaWxlKTtcblx0XHR3b3Jrc3BhY2UucmV2ZWFsTGVhZihuZXdMZWFmKTtcblx0XHR3b3Jrc3BhY2Uuc2V0QWN0aXZlTGVhZihjdXJyTGVhZik7XG5cdFx0cmV0dXJuIHsgbmV3TGVhZiwgdGVtcDogdHJ1ZSwgb3JpZ2luYWxMZWFmIH07XG5cdH0gZWxzZSBpZiAobGVmdEFkamFjZW50VGFiLmxlbmd0aCA+IDApIHtcblx0XHQvLyB0aGVyZSBleGlzdHMgYSBsZWZ0IHRhYlxuXHRcdGNvbnN0IG9yaWdpbmFsTGVhZiA9IGxlZnRBZGphY2VudFRhYi5maWx0ZXIoXG5cdFx0XHQodCkgPT4gdC5jb250YWluZXJFbC5zdHlsZS5kaXNwbGF5ICE9IFwibm9uZVwiXG5cdFx0KVswXTtcblxuXHRcdGxldCBjdXJyTGVhZiA9IHdvcmtzcGFjZS5nZXRMZWFmKCk7IC8vIGdldCBjdXJyZW50IGFjdGl2ZSBsZWFmXG5cdFx0d29ya3NwYWNlLnNldEFjdGl2ZUxlYWYob3JpZ2luYWxMZWFmKTsgLy8gZ2V0IHRoZSBsZWFmIGluIGFkamFjZW50IHRhYlxuXHRcdGxldCBuZXdMZWFmID0gd29ya3NwYWNlLmdldExlYWYodHJ1ZSk7IC8vIGNyZWF0ZSBhIG5ldyBsZWFmXG5cdFx0YXdhaXQgb3BlbkZpbGVJbkxlYWYobmV3TGVhZiwgZmlsZSk7IC8vIGxvYWQgZmlsZSBpbnRvIG5ldyBsZWFmXG5cdFx0d29ya3NwYWNlLnJldmVhbExlYWYobmV3TGVhZik7IC8vIHJldmVhbCBuZXcgbGVhZlxuXHRcdHdvcmtzcGFjZS5zZXRBY3RpdmVMZWFmKGN1cnJMZWFmKTsgLy8gc2V0IGFjdGl2ZSBsZWFmIGJhY2sgdG8gb3JpZ2luYWxcblx0XHRyZXR1cm4geyBuZXdMZWFmLCB0ZW1wOiB0cnVlLCBvcmlnaW5hbExlYWYgfTtcblx0fSBlbHNlIHtcblx0XHQvLyBubyBhZGphY2VudCB0YWJzXG5cdFx0Y29uc3QgY3VyckxlYWYgPSB3b3Jrc3BhY2UuZ2V0TGVhZigpO1xuXHRcdGxldCBuZXdMZWFmID0gd29ya3NwYWNlLmNyZWF0ZUxlYWZCeVNwbGl0KGN1cnJMZWFmKTtcblx0XHRhd2FpdCBvcGVuRmlsZUluTGVhZihuZXdMZWFmLCBmaWxlKTtcblx0XHRyZXR1cm4geyBuZXdMZWFmLCB0ZW1wOiB0cnVlIH07XG5cdH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIG9wZW5GaWxlSW5MZWFmKGxlYWY6IFdvcmtzcGFjZUxlYWYsIGZpbGU6IHN0cmluZykge1xuXHRsZXQgdGFyZ2V0RmlsZTogVEFic3RyYWN0RmlsZSB8IG51bGwgPVxuXHRcdGdldFRoYXQoKS52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZSk7XG5cdGlmICh0YXJnZXRGaWxlICYmIHRhcmdldEZpbGUgaW5zdGFuY2VvZiBURmlsZSlcblx0XHRhd2FpdCBsZWFmLm9wZW5GaWxlKHRhcmdldEZpbGUsIHsgYWN0aXZlOiBmYWxzZSB9KTtcbn1cbiIsICJpbXBvcnQge1xuXHRzdGF0ZSxcblx0dXBkYXRlQ3Vyc29yLFxuXHR1cGRhdGVIb3Zlcixcblx0Z2V0Q3Vyc29yLFxuXHRnZXRIb3Zlcixcblx0cmVzZXRIb3Zlcixcblx0cmVzZXRDdXJzb3IsXG5cdGdldFRoYXQsXG5cdGdldEJhY2tsaW5rSG92ZXIsXG5cdHVwZGF0ZUJhY2tsaW5rSG92ZXIsXG5cdHJlc2V0QmFja2xpbmtIb3Zlcixcblx0dXBkYXRlSG92ZXJlZEN1cnNvcixcbn0gZnJvbSBcIi4vc3RhdGVcIjtcbmltcG9ydCB7IEFDVElPTl9UWVBFLCBSRUZFUkVOQ0VfUkVHRVggfSBmcm9tIFwiLi9jb25zdGFudHNcIjtcbmltcG9ydCB7XG5cdGNvbGxlY3RMZWF2ZXNCeVRhYkhlbHBlcixcblx0Z2V0Q3VycmVudFRhYkluZGV4LFxuXHRvcGVuRmlsZUluQWRqYWNlbnRUYWIsXG59IGZyb20gXCIuL3dvcmtzcGFjZVwiO1xuaW1wb3J0IHsgcHJvY2Vzc1VSSSwgZmluZFRleHRQb3NpdGlvbnMgfSBmcm9tIFwiLi91dGlsc1wiO1xuaW1wb3J0IHsgTWFya2Rvd25WaWV3LCBXb3Jrc3BhY2VMZWFmIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBoaWdobGlnaHRTZWxlY3Rpb24sIHJlbW92ZUhpZ2hsaWdodHMgfSBmcm9tIFwiLi9tYXJrXCI7XG5pbXBvcnQgeyBFZGl0b3JWaWV3IH0gZnJvbSBcIkBjb2RlbWlycm9yL3ZpZXdcIjtcbmltcG9ydCB7XG5cdGdldEJhY2tsaW5rQ29udGFpbmVyLFxuXHRnZXRDb250YWluZXJFbGVtZW50LFxuXHRnZXRNYXJrZG93blZpZXcsXG59IGZyb20gXCIuL3JlZmVyZW5jZXNcIjtcblxuZnVuY3Rpb24gZ2V0RWRpdG9yVmlldyhsZWFmOiBXb3Jrc3BhY2VMZWFmKSB7XG5cdGlmICghbGVhZikgcmV0dXJuIG51bGw7XG5cdGNvbnN0IHZpZXcgPSBsZWFmLnZpZXc7XG5cblx0Ly8gQHRzLWlnbm9yZVxuXHRjb25zdCBlZGl0b3IgPSB2aWV3LnNvdXJjZU1vZGU/LmNtRWRpdG9yO1xuXG5cdC8vICdlZGl0b3InIGhlcmUgaXMgYW4gaW5zdGFuY2Ugb2YgJ0VkaXRvcicsIGFuIGFic3RyYWN0aW9uIG92ZXIgQ001IGFuZCBDTTYuXG5cdC8vIENoZWNraW5nIGZvciAnQ29kZU1pcnJvcicgd291bGQgaW5kaWNhdGUgQ001LlxuXHRpZiAoIWVkaXRvci5Db2RlTWlycm9yICYmIGVkaXRvci5jbSBpbnN0YW5jZW9mIEVkaXRvclZpZXcpIHtcblx0XHQvLyBZb3Ugbm93IGhhdmUgYWNjZXNzIHRvIHRoZSBDb2RlTWlycm9yIDYgRWRpdG9yVmlldyBpbnN0YW5jZS5cblx0XHRjb25zdCBlZGl0b3JWaWV3ID0gZWRpdG9yLmNtO1xuXG5cdFx0cmV0dXJuIGVkaXRvclZpZXc7XG5cblx0XHQvLyBZb3UgY2FuIG5vdyB1c2UgdGhlIENvZGVNaXJyb3IgNiBBUEkgd2l0aCBgZWRpdG9yVmlld2AuXG5cdH1cblx0cmV0dXJuIG51bGw7XG59XG5cbmZ1bmN0aW9uIGNoZWNrU3BhbkVsZW1lbnRFeGlzdHMoXG5cdHNwYW46IEhUTUxTcGFuRWxlbWVudCxcblx0Y29udGFpbmVyRWw6IEhUTUxFbGVtZW50XG4pOiBib29sZWFuIHtcblx0Y29uc3Qgc3BhbkVsZW1lbnRzID0gY29udGFpbmVyRWwuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJzcGFuXCIpO1xuXHRmb3IgKGxldCBpID0gMDsgaSA8IHNwYW5FbGVtZW50cy5sZW5ndGg7IGkrKykge1xuXHRcdGlmIChzcGFuRWxlbWVudHNbaV0gPT09IHNwYW4pIHtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblx0fVxuXHRyZXR1cm4gZmFsc2U7XG59XG5cbmZ1bmN0aW9uIHBhcnNlQ1NTU3RyaW5nKGNzczogc3RyaW5nKSB7XG5cdC8vIFVzZSBhIHJlZ3VsYXIgZXhwcmVzc2lvbiB0byBtYXRjaCBrZXktdmFsdWUgcGFpcnMgaW4gdGhlIENTUyBzdHJpbmdcblx0Y29uc3QgY3NzUHJvcGVydGllc1JlZ2V4ID0gLyhbXFx3LV0rKVxccyo6XFxzKihbXjtdKylcXHMqOz8vZztcblxuXHQvLyBJbml0aWFsaXplIGFuIGVtcHR5IG9iamVjdCB0byBzdG9yZSB0aGUgQ1NTIHByb3BlcnRpZXNcblx0bGV0IGNzc1Byb3BlcnRpZXNPYmplY3Q6IGFueSA9IHt9O1xuXG5cdC8vIEl0ZXJhdGUgb3ZlciBhbGwga2V5LXZhbHVlIHBhaXJzIGZvdW5kIGJ5IHRoZSByZWdleFxuXHRsZXQgbWF0Y2g7XG5cdHdoaWxlICgobWF0Y2ggPSBjc3NQcm9wZXJ0aWVzUmVnZXguZXhlYyhjc3MpKSAhPT0gbnVsbCkge1xuXHRcdC8vIG1hdGNoWzFdIGlzIHRoZSBrZXlcblx0XHQvLyBtYXRjaFsyXSBpcyB0aGUgdmFsdWVcblx0XHRjc3NQcm9wZXJ0aWVzT2JqZWN0W21hdGNoWzFdXSA9IG1hdGNoWzJdO1xuXHR9XG5cblx0cmV0dXJuIGNzc1Byb3BlcnRpZXNPYmplY3Q7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkZWxheShtaWxsaXNlY29uZHM6IGFueSkge1xuXHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcblx0XHRzZXRUaW1lb3V0KHJlc29sdmUsIG1pbGxpc2Vjb25kcyk7XG5cdH0pO1xufVxuXG5mdW5jdGlvbiB0ZW1wRGlyZWN0aW9uSW5kaWNhdG9yKFxuXHRsZWFmOiBhbnksXG5cdHRleHQ6IHN0cmluZyxcblx0cHJlZml4OiBzdHJpbmcsXG5cdHN1ZmZpeDogc3RyaW5nLFxuXHRkYXRhU3RyaW5nOiBzdHJpbmcsXG5cdGlzU2FtZTogYm9vbGVhbixcblx0dXNlcj86IHN0cmluZ1xuKSB7XG5cdGxldCBwb3NpdGlvbnMgPSBmaW5kVGV4dFBvc2l0aW9ucyhcblx0XHRsZWFmLnZpZXcuZGF0YSxcblx0XHR0ZXh0LFxuXHRcdHByZWZpeC5zbGljZSgwLCBwcmVmaXgubGVuZ3RoIC0gMSksXG5cdFx0c3VmZml4LnNsaWNlKDEsIHN1ZmZpeC5sZW5ndGgpXG5cdCk7XG5cdGlmICghcG9zaXRpb25zKSB0aHJvdyBuZXcgRXJyb3IoXCJQb3NpdGlvbnMgbm90IGZvdW5kXCIpO1xuXHRsZXQgcmFuZ2VTdGFydCA9IHBvc2l0aW9ucy5yYW5nZVN0YXJ0O1xuXHRsZXQgcmFuZ2VFbmQgPSBwb3NpdGlvbnMucmFuZ2VFbmQ7XG5cblx0aWYgKHVzZXIgPT09IEFDVElPTl9UWVBFLkJBQ0tMSU5LKSB7XG5cdFx0bGV0IHN0YXJ0VG9wID0gbGVhZi52aWV3LmVkaXRvci5nZXRTY3JvbGxJbmZvKCkudG9wO1xuXG5cdFx0bGVhZi52aWV3LmVkaXRvci5zY3JvbGxJbnRvVmlldyhcblx0XHRcdHtcblx0XHRcdFx0ZnJvbTogT2JqZWN0LmFzc2lnbihyYW5nZVN0YXJ0LCB7IGNoOiAwIH0pLFxuXHRcdFx0XHR0bzogT2JqZWN0LmFzc2lnbihyYW5nZUVuZCwgeyBjaDogMCB9KSxcblx0XHRcdH0sXG5cdFx0XHR0cnVlXG5cdFx0KTtcblx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdC8vIGlmICh0ZW1wKSByZXR1cm47XG5cdFx0XHRsZXQgZW5kVG9wID0gbGVhZi52aWV3LmVkaXRvci5nZXRTY3JvbGxJbmZvKCkudG9wO1xuXHRcdFx0aWYgKHN0YXJ0VG9wID09PSBlbmRUb3AgJiYgaXNTYW1lKSB7XG5cdFx0XHRcdGxlYWYuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvcihcIi52aWV3LWNvbnRlbnRcIikuc3R5bGUuYm94U2hhZG93ID1cblx0XHRcdFx0XHRcIm5vbmVcIjtcblx0XHRcdH0gZWxzZSBpZiAoc3RhcnRUb3AgPT09IGVuZFRvcCB8fCAhaXNTYW1lKSB7XG5cdFx0XHRcdGxlYWYuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvcihcIi52aWV3LWNvbnRlbnRcIikuc3R5bGUuYm94U2hhZG93ID1cblx0XHRcdFx0XHRcImluc2V0IDBweCAwcHggMTBweCAxMHB4IHJnYmEoMjQ4LCAyNTUsIDI1NSlcIjtcblx0XHRcdH0gZWxzZSBpZiAoc3RhcnRUb3AgPCBlbmRUb3ApIHtcblx0XHRcdFx0Ly8gc2hvdyBtYXJrIGFib3ZlXG5cdFx0XHRcdC8vIG5ld0xlYWYuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvcihcIi52aWV3LWNvbnRlbnRcIikuc3R5bGUuYm94U2hhZG93ID1cblx0XHRcdFx0Ly8gXHRcImluc2V0IDBweCAwcHggMTBweCAxMHB4IHJnYmEoMjQ4LCAyNTUsIDI1NSlcIjtcblx0XHRcdFx0bGVhZi5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKFwiLnZpZXctY29udGVudFwiKS5zdHlsZS5ib3hTaGFkb3cgPVxuXHRcdFx0XHRcdFwiaW5zZXQgMHB4IDIwcHggMjBweCAwcHggcmdiYSgyNDgsIDI1NSwgMjU1KVwiO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gc2hvdyBtYXJrIGJlbG93XG5cdFx0XHRcdGxlYWYuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvcihcIi52aWV3LWNvbnRlbnRcIikuc3R5bGUuYm94U2hhZG93ID1cblx0XHRcdFx0XHRcImluc2V0IDBweCAtMzBweCAyMHB4IDBweCByZ2JhKDI0OCwgMjU1LCAyNTUpXCI7XG5cdFx0XHR9XG5cdFx0fSwgMTApO1xuXG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0Ly8gT2ghIElcdTIwMTlkIGNvbXBhcmUgdGhlIGJib3ggb2YgdGhlIHJhbmdlXG5cdC8vICh3aGljaCBJIGtub3cgeW91IGZpbmQgaW4gdGhlIG1hcmsgbGF5b3V0IHJvdXRpbmUpXG5cdC8vIHRvIHRoZSBzY3JvbGxUb3AgKyBpbm5lckhlaWdodFxuXHRjb25zdCBlZGl0b3IgPSBnZXRNYXJrZG93blZpZXcobGVhZikuZWRpdG9yO1xuXHRjb25zdCBiYWNrbGlua0NvbnRhaW5lciA9IGdldEJhY2tsaW5rQ29udGFpbmVyKGVkaXRvcik7XG5cblx0Y29uc3Qgd2luZG93SGVpZ2h0ID0gbGVhZi52aWV3LmNvbnRhaW5lckVsXG5cdFx0LnF1ZXJ5U2VsZWN0b3IoXCIuY20tc2Nyb2xsZXJcIilcblx0XHQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0O1xuXHRjb25zdCBzY3JvbGxUb3AgPVxuXHRcdGxlYWYudmlldy5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKFwiLmNtLXNjcm9sbGVyXCIpLnNjcm9sbFRvcDtcblx0Y29uc3Qgc2Nyb2xsQm90dG9tID0gc2Nyb2xsVG9wICsgd2luZG93SGVpZ2h0O1xuXG5cdGxldCB2aXNpYmxlRWxlbWVudHM6IHN0cmluZ1tdID0gW107XG5cdGZvciAobGV0IGkgPSAwOyBpIDwgYmFja2xpbmtDb250YWluZXIuY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcblx0XHRsZXQgc3R5bGUgPSBiYWNrbGlua0NvbnRhaW5lci5jaGlsZHJlbltpXS5nZXRBdHRyaWJ1dGUoXCJzdHlsZVwiKTtcblx0XHRpZiAoc3R5bGUgPT0gbnVsbCkgY29udGludWU7XG5cdFx0bGV0IGNzc1Byb3BlcnRpZXMgPSBwYXJzZUNTU1N0cmluZyhzdHlsZSk7XG5cdFx0bGV0IHRvcCA9IHBhcnNlRmxvYXQoY3NzUHJvcGVydGllc1tcInRvcFwiXS5yZXBsYWNlKFwicHhcIiwgXCJcIikpO1xuXHRcdGlmICh0b3AgPT0gbnVsbCkgY29udGludWU7XG5cblx0XHRpZiAoXG5cdFx0XHRzY3JvbGxUb3AgPD0gdG9wICYmXG5cdFx0XHR0b3AgPD0gc2Nyb2xsQm90dG9tICYmXG5cdFx0XHRiYWNrbGlua0NvbnRhaW5lci5jaGlsZHJlbltpXVxuXHRcdCkge1xuXHRcdFx0bGV0IHJlZmVyZW5jZSA9IGJhY2tsaW5rQ29udGFpbmVyLmNoaWxkcmVuW2ldLmdldEF0dHJpYnV0ZShcInJlZmVyZW5jZVwiKTtcblx0XHRcdGlmIChyZWZlcmVuY2UpIHtcblx0XHRcdFx0dmlzaWJsZUVsZW1lbnRzLnB1c2goSlNPTi5wYXJzZShyZWZlcmVuY2UpLmRhdGFTdHJpbmcpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdGlmICghdmlzaWJsZUVsZW1lbnRzLmluY2x1ZGVzKGRhdGFTdHJpbmcpKSB7XG5cdFx0bGV0IHN0YXJ0VG9wID0gbGVhZi52aWV3LmVkaXRvci5nZXRTY3JvbGxJbmZvKCkudG9wO1xuXG5cdFx0bGVhZi52aWV3LmVkaXRvci5zY3JvbGxJbnRvVmlldyhcblx0XHRcdHtcblx0XHRcdFx0ZnJvbTogT2JqZWN0LmFzc2lnbihyYW5nZVN0YXJ0LCB7IGNoOiAwIH0pLFxuXHRcdFx0XHR0bzogT2JqZWN0LmFzc2lnbihyYW5nZUVuZCwgeyBjaDogMCB9KSxcblx0XHRcdH0sXG5cdFx0XHR0cnVlXG5cdFx0KTtcblx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdC8vIGlmICh0ZW1wKSByZXR1cm47XG5cdFx0XHRsZXQgZW5kVG9wID0gbGVhZi52aWV3LmVkaXRvci5nZXRTY3JvbGxJbmZvKCkudG9wO1xuXHRcdFx0aWYgKHN0YXJ0VG9wID09IGVuZFRvcCAmJiBpc1NhbWUpIHtcblx0XHRcdFx0bGVhZi5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKFwiLnZpZXctY29udGVudFwiKS5zdHlsZS5ib3hTaGFkb3cgPVxuXHRcdFx0XHRcdFwiaW5zZXQgMHB4IDIwcHggMjBweCAwcHggcmdiYSgyNDgsIDI1NSwgMjU1LCAwKVwiO1xuXHRcdFx0fSBlbHNlIGlmIChzdGFydFRvcCA9PT0gZW5kVG9wIHx8ICFpc1NhbWUpIHtcblx0XHRcdFx0bGVhZi5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKFwiLnZpZXctY29udGVudFwiKS5zdHlsZS5ib3hTaGFkb3cgPVxuXHRcdFx0XHRcdFwiaW5zZXQgMHB4IDBweCAxMHB4IDEwcHggcmdiYSgyNDgsIDI1NSwgMjU1KVwiO1xuXHRcdFx0fSBlbHNlIGlmIChzdGFydFRvcCA8IGVuZFRvcCkge1xuXHRcdFx0XHQvLyBzaG93IG1hcmsgYWJvdmVcblx0XHRcdFx0Ly8gbmV3TGVhZi5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKFwiLnZpZXctY29udGVudFwiKS5zdHlsZS5ib3hTaGFkb3cgPVxuXHRcdFx0XHQvLyBcdFwiaW5zZXQgMHB4IDBweCAxMHB4IDEwcHggcmdiYSgyNDgsIDI1NSwgMjU1KVwiO1xuXHRcdFx0XHRsZWFmLmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoXCIudmlldy1jb250ZW50XCIpLnN0eWxlLmJveFNoYWRvdyA9XG5cdFx0XHRcdFx0XCJpbnNldCAwcHggMjBweCAyMHB4IDBweCByZ2JhKDI0OCwgMjU1LCAyNTUpXCI7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBzaG93IG1hcmsgYmVsb3dcblx0XHRcdFx0bGVhZi5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKFwiLnZpZXctY29udGVudFwiKS5zdHlsZS5ib3hTaGFkb3cgPVxuXHRcdFx0XHRcdFwiaW5zZXQgMHB4IC0zMHB4IDIwcHggMHB4IHJnYmEoMjQ4LCAyNTUsIDI1NSlcIjtcblx0XHRcdH1cblx0XHR9LCAxMCk7XG5cdH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHN0YXJ0QmFja2xpbmtFZmZlY3Qoc3BhbjogSFRNTFNwYW5FbGVtZW50KSB7XG5cdGxldCBzb3VyY2UgPSBnZXRCYWNrbGlua0hvdmVyKCk7XG5cdGxldCBkZXN0aW5hdGlvbiA9IGdldEN1cnNvcigpO1xuXHRsZXQgdXBkYXRlU3RhdGUgPSB1cGRhdGVCYWNrbGlua0hvdmVyO1xuXG5cdC8vIE11dGV4LCBwcmV2ZW50IGNvbmN1cnJlbnQgYWNjZXNzIHRvIGZvbGxvd2luZyBzZWN0aW9uIG9mIGNvZGVcblx0aWYgKHNvdXJjZSAhPSBudWxsKSByZXR1cm47XG5cdHVwZGF0ZVN0YXRlKHtcblx0XHR0eXBlOiBgJHtBQ1RJT05fVFlQRS5CQUNLTElOS30tc3RhcnRgLFxuXHR9KTtcblxuXHRpZiAoIXNwYW4pIHJldHVybjtcblx0Ly8gY29uc3QgdXVpZCA9IHV1aWR2NCgpO1xuXHQvLyBjb25zdCB1dWlkMiA9IHV1aWR2NCgpO1xuXHQvLyBjb25zb2xlLmxvZyhzcGFuKTtcblx0bGV0IHV1aWQgPSBBcnJheS5mcm9tKHNwYW4uY2xhc3NMaXN0KS5maWx0ZXIoKGVsKSA9PiBlbC5pbmNsdWRlcyhcInV1aWRcIikpWzBdO1xuXHRzcGFuLnBhcmVudEVsZW1lbnRcblx0XHQ/LnF1ZXJ5U2VsZWN0b3IoXCIucmVmZXJlbmNlLXNwYW5cIilcblx0XHQ/LmNsYXNzTGlzdC5hZGQoXCJyZWZlcmVuY2Utc3Bhbi1zZWxlY3RlZFwiKTtcblx0Ly8gc3Bhbi5wYXJlbnRFbGVtZW50XG5cdC8vIFx0Py5xdWVyeVNlbGVjdG9yKFwiLnJlZmVyZW5jZS1zcGFuXCIpXG5cdC8vIFx0Py5jbGFzc0xpc3QuYWRkKFwidXVpZC1cIiArIHV1aWQpO1xuXG5cdHNwYW4uY2xhc3NMaXN0LmFkZChcInJlZmVyZW5jZS1kYXRhLXNwYW4tc2VsZWN0ZWRcIik7XG5cdC8vIHNwYW4uY2xhc3NMaXN0LmFkZChcInV1aWQtXCIgKyB1dWlkMik7XG5cblx0dXBkYXRlU3RhdGUoe1xuXHRcdHV1aWQsXG5cdFx0Ly8gdXVpZDIsXG5cdH0pO1xuXG5cdGNvbnN0IHJlZmVyZW5jZURhdGEgPSBzcGFuLmdldEF0dHJpYnV0ZShcInJlZmVyZW5jZVwiKTtcblx0aWYgKCFyZWZlcmVuY2VEYXRhKSB0aHJvdyBuZXcgRXJyb3IoXCJSZWZlcmVuY2UgZGF0YSBub3QgZm91bmRcIik7XG5cblx0Y29uc3QgYmFja2xpbmsgPSBKU09OLnBhcnNlKHJlZmVyZW5jZURhdGEpO1xuXHRjb25zdCBkYXRhU3RyaW5nID0gYmFja2xpbmsuZGF0YVN0cmluZztcblxuXHRpZiAoZGVzdGluYXRpb24gIT0gbnVsbCAmJiBkZXN0aW5hdGlvbi5kYXRhU3RyaW5nID09IGRhdGFTdHJpbmcpIHtcblx0XHR1cGRhdGVTdGF0ZShkZXN0aW5hdGlvbik7XG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0bGV0IFtwcmVmaXgsIHRleHQsIHN1ZmZpeCwgZmlsZSwgZnJvbSwgdG9dID0gcHJvY2Vzc1VSSShkYXRhU3RyaW5nKTtcblxuXHRsZXQgbGVhdmVzQnlUYWIgPSBjb2xsZWN0TGVhdmVzQnlUYWJIZWxwZXIoKTtcblxuXHRsZXQgY3VyclRhYklkeCA9IGdldEN1cnJlbnRUYWJJbmRleChsZWF2ZXNCeVRhYiwgc3Bhbik7XG5cblx0bGV0IGJhY2tsaW5rTGVhZiA9IGxlYXZlc0J5VGFiW2N1cnJUYWJJZHhdLmZpbHRlcigobGVhZjogV29ya3NwYWNlTGVhZikgPT4ge1xuXHRcdGxldCBjb250YWluZXJFbCA9IGdldENvbnRhaW5lckVsZW1lbnQobGVhZik7XG5cdFx0Y29uc3QgZXhpc3RzID0gY2hlY2tTcGFuRWxlbWVudEV4aXN0cyhzcGFuLCBjb250YWluZXJFbCk7XG5cdFx0cmV0dXJuIGV4aXN0cztcblx0fSlbMF07XG5cblx0Ly8gQHRzLWlnbm9yZVxuXHRsZXQgYmFja2xpbmtMZWFmSUQgPSBiYWNrbGlua0xlYWYuaWQ7XG5cdGlmICghYmFja2xpbmtMZWFmSUQpIHRocm93IG5ldyBFcnJvcihcIkxlYWYgaWQgbm90IGZvdW5kXCIpO1xuXG5cdGlmIChiYWNrbGlua0xlYWYgJiYgYmFja2xpbmtMZWFmLnZpZXcgaW5zdGFuY2VvZiBNYXJrZG93blZpZXcpIHtcblx0XHRjb25zdCBlZGl0b3JWaWV3OiBFZGl0b3JWaWV3ID0gZ2V0RWRpdG9yVmlldyhiYWNrbGlua0xlYWYpO1xuXHRcdGlmICghZWRpdG9yVmlldykgdGhyb3cgbmV3IEVycm9yKFwiRWRpdG9yIHZpZXcgbm90IGZvdW5kXCIpO1xuXHRcdGNvbnN0IHZpZXdwb3J0ID0gYmFja2xpbmtMZWFmLnZpZXcuZWRpdG9yLmdldFNjcm9sbEluZm8oKTtcblxuXHRcdGhpZ2hsaWdodFNlbGVjdGlvbihlZGl0b3JWaWV3LCBmcm9tLCB0byk7XG5cdFx0Ly8gbGV0IHBvc2l0aW9ucyA9IGZpbmRUZXh0UG9zaXRpb25zKFxuXHRcdC8vIFx0YmFja2xpbmtMZWFmLnZpZXcuZGF0YSxcblx0XHQvLyBcdHRleHQsXG5cdFx0Ly8gXHRwcmVmaXguc2xpY2UoMCwgcHJlZml4Lmxlbmd0aCAtIDEpLFxuXHRcdC8vIFx0c3VmZml4LnNsaWNlKDEsIHN1ZmZpeC5sZW5ndGgpXG5cdFx0Ly8gKTtcblx0XHQvLyBpZiAoIXBvc2l0aW9ucykgdGhyb3cgbmV3IEVycm9yKFwiUG9zaXRpb25zIG5vdCBmb3VuZFwiKTtcblxuXHRcdHVwZGF0ZVN0YXRlKHtcblx0XHRcdGRhdGFTdHJpbmcsXG5cdFx0XHRvcmlnaW5hbFRvcDogZWRpdG9yVmlldy5kb2N1bWVudFRvcCxcblx0XHRcdGJhY2tsaW5rTGVhZklkOiBiYWNrbGlua0xlYWZJRCxcblx0XHR9KTtcblx0fVxuXG5cdGxldCByZWZlcmVuY2luZ0ZpbGUgPSBiYWNrbGluay5yZWZlcmVuY2luZ0xvY2F0aW9uLmZpbGVuYW1lO1xuXG5cdC8vIGlmIChjdXJyVGFiSWR4ICE9IC0xKSB7XG5cdC8vICYmIGN1cnJUYWIgIT0gLTEpIHtcblx0Ly8gLy8gQ2hlY2sgYWRqYWNlbnQgdGFicyBmb3IgZmlsZSBhbmQgb3BlbiBmaWxlIGlmIG5lZWRlZFxuXHRjb25zdCB7IG5ld0xlYWYsIHRlbXAsIG9yaWdpbmFsTGVhZiB9ID0gYXdhaXQgb3BlbkZpbGVJbkFkamFjZW50VGFiKFxuXHRcdGxlYXZlc0J5VGFiLFxuXHRcdGN1cnJUYWJJZHgsXG5cdFx0cmVmZXJlbmNpbmdGaWxlXG5cdCk7XG5cblx0Ly8gQHRzLWlnbm9yZVxuXHRsZXQgaWQgPSBuZXdMZWFmLmlkO1xuXHRpZiAoIWlkKSB0aHJvdyBuZXcgRXJyb3IoXCJMZWFmIGlkIG5vdCBmb3VuZFwiKTtcblx0dXBkYXRlU3RhdGUoe1xuXHRcdGxlYWZJZDogaWQsXG5cdFx0dGVtcCxcblx0XHRwZWVrOiB0cnVlLFxuXHR9KTtcblxuXHRjb25zdCBvcmlnaW5hbExlYWZJZCA9IG9yaWdpbmFsTGVhZi5pZDtcblxuXHRjb25zdCBtYXRjaGVzID0gW1xuXHRcdC4uLmJhY2tsaW5rLnJlZmVyZW5jaW5nTG9jYXRpb24udGV4dC5tYXRjaEFsbChSRUZFUkVOQ0VfUkVHRVgpLFxuXHRdO1xuXHRpZiAobWF0Y2hlcy5sZW5ndGggPT0gMCkgdGhyb3cgbmV3IEVycm9yKFwiTWF0Y2hlcyBub3QgZm91bmRcIik7XG5cdC8vIFRoaXMgb25lIHN3aXRjaCwgdGhpcyBvbmUgZG9lcyB0aGUgY29ycmVjdCBzY3JvbGxcblx0Ly8gdGVtcERpcmVjdGlvbkluZGljYXRvcihuZXdMZWFmLCB0ZXh0LCBwcmVmaXgsIHN1ZmZpeCwgZGF0YVN0cmluZyk7XG5cblx0Ly8gVGhpcyBvbmUgZG9lcyB0aGUgY29ycmVjdCBncmFiYmluZyBvZiBzcGFuIGVsZW1lbnRzXG5cdHRlbXBEaXJlY3Rpb25JbmRpY2F0b3IoXG5cdFx0bmV3TGVhZixcblx0XHRiYWNrbGluay5yZWZlcmVuY2luZ0xvY2F0aW9uLnRleHQsXG5cdFx0YmFja2xpbmsucmVmZXJlbmNpbmdMb2NhdGlvbi5wcmVmaXggKyBcIi1cIixcblx0XHRcIi1cIiArIGJhY2tsaW5rLnJlZmVyZW5jaW5nTG9jYXRpb24uc3VmZml4LFxuXHRcdG1hdGNoZXNbMF1bMV0sXG5cdFx0aWQgPT09IG9yaWdpbmFsTGVhZklkLFxuXHRcdEFDVElPTl9UWVBFLkJBQ0tMSU5LXG5cdCk7XG5cblx0Y29uc3QgY3Vyc29yVmlld3BvcnQgPSBuZXdMZWFmLnZpZXcuZWRpdG9yLmdldFNjcm9sbEluZm8oKTtcblxuXHR1cGRhdGVTdGF0ZSh7XG5cdFx0Y3Vyc29yVmlld3BvcnQsXG5cdH0pO1xuXG5cdGxldCBiYWNrbGlua1NwYW46IEhUTUxTcGFuRWxlbWVudCA9IG5ld0xlYWYuY29udGFpbmVyRWwucXVlcnlTZWxlY3Rvcihcblx0XHRgc3BhbltkYXRhPVwiJHtiYWNrbGluay5kYXRhU3RyaW5nfVwiXWBcblx0KTtcblxuXHQvLyBDYW4ndCBndWFyYW50ZWUgdGhhdCB0aGlzIHdpbGwgYmUgdmlzaWJsZS5cblx0aWYgKGJhY2tsaW5rU3Bhbikge1xuXHRcdC8vIGJhY2tsaW5rU3Bhbi5jbGFzc0xpc3QuYWRkKFwicmVmZXJlbmNlLWRhdGEtc3Bhbi1ob3ZlcmVkXCIpO1xuXHRcdC8vIGJhY2tsaW5rU3Bhbi5jbGFzc0xpc3QuYWRkKFwicmVmZXJlbmNlLXNwYW4tc2VsZWN0ZWRcIik7XG5cdFx0Ly8gY29uc3QgYmFja2xpbmtVVUlEID0gdXVpZHY0KCk7XG5cdFx0Ly8gY29uc3QgYmFja2xpbmtVVUlEMiA9IHV1aWR2NCgpO1xuXHRcdGxldCBiYWNrbGlua1VVSUQgPSBBcnJheS5mcm9tKGJhY2tsaW5rU3Bhbi5jbGFzc0xpc3QpLmZpbHRlcigoZWwpID0+XG5cdFx0XHRlbC5pbmNsdWRlcyhcInV1aWRcIilcblx0XHQpWzBdO1xuXHRcdGJhY2tsaW5rU3Bhbi5wYXJlbnRFbGVtZW50XG5cdFx0XHQ/LnF1ZXJ5U2VsZWN0b3IoXCIucmVmZXJlbmNlLXNwYW5cIilcblx0XHRcdD8uY2xhc3NMaXN0LmFkZChcInJlZmVyZW5jZS1zcGFuLXNlbGVjdGVkXCIpO1xuXHRcdC8vIGJhY2tsaW5rU3Bhbi5wYXJlbnRFbGVtZW50XG5cdFx0Ly8gXHQ/LnF1ZXJ5U2VsZWN0b3IoXCIucmVmZXJlbmNlLXNwYW5cIilcblx0XHQvLyBcdD8uY2xhc3NMaXN0LmFkZChcInV1aWQtXCIgKyBiYWNrbGlua1VVSUQpO1xuXG5cdFx0YmFja2xpbmtTcGFuLmNsYXNzTGlzdC5hZGQoXCJyZWZlcmVuY2UtZGF0YS1zcGFuLXNlbGVjdGVkXCIpO1xuXHRcdC8vIGJhY2tsaW5rU3Bhbi5jbGFzc0xpc3QuYWRkKFwidXVpZC1cIiArIGJhY2tsaW5rVVVJRDIpO1xuXG5cdFx0dXBkYXRlU3RhdGUoe1xuXHRcdFx0YmFja2xpbmtVVUlELFxuXHRcdFx0Ly8gYmFja2xpbmtVVUlEMixcblx0XHR9KTtcblx0fVxuXG5cdGlmIChcblx0XHRpZCA9PT0gb3JpZ2luYWxMZWFmSWRcblx0XHQvLyAmJlxuXHRcdC8vIChuZXdMZWFmLmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoXCIudmlldy1jb250ZW50XCIpLnN0eWxlLmJveFNoYWRvdyA9PVxuXHRcdC8vIFx0XCJub25lXCIgfHxcblx0XHQvLyBcdG5ld0xlYWYuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvcihcIi52aWV3LWNvbnRlbnRcIikuc3R5bGUuYm94U2hhZG93ID09IFwiXCIpXG5cdCkge1xuXHRcdG5ld0xlYWYuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvcihcIi52aWV3LWNvbnRlbnRcIikuc3R5bGUuYm94U2hhZG93ID0gXCJub25lXCI7XG5cdH1cblxuXHQvLyBAdHMtaWdub3JlXG5cdGlmIChvcmlnaW5hbExlYWZJZCkge1xuXHRcdHVwZGF0ZVN0YXRlKHtcblx0XHRcdG9yaWdpbmFsTGVhZklkLFxuXHRcdH0pO1xuXHR9XG5cblx0cmV0dXJuO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc3RhcnRSZWZlcmVuY2VFZmZlY3QoXG5cdHNwYW46IEhUTUxTcGFuRWxlbWVudCB8IG51bGwgfCB1bmRlZmluZWQsXG5cdHR5cGU6IHN0cmluZ1xuKSB7XG5cdGxldCBzb3VyY2UgPSB0eXBlID09IEFDVElPTl9UWVBFLk1PVVNFID8gZ2V0SG92ZXIoKSA6IGdldEN1cnNvcigpO1xuXHRsZXQgZGVzdGluYXRpb24gPSB0eXBlID09IEFDVElPTl9UWVBFLk1PVVNFID8gZ2V0Q3Vyc29yKCkgOiBnZXRIb3ZlcigpO1xuXHRsZXQgdXBkYXRlU3RhdGUgPSB0eXBlID09IEFDVElPTl9UWVBFLk1PVVNFID8gdXBkYXRlSG92ZXIgOiB1cGRhdGVDdXJzb3I7XG5cblx0Ly8gTXV0ZXgsIHByZXZlbnQgY29uY3VycmVudCBhY2Nlc3MgdG8gZm9sbG93aW5nIHNlY3Rpb24gb2YgY29kZVxuXHRpZiAoc291cmNlICE9IG51bGwpIHtcblx0XHRpZiAoQUNUSU9OX1RZUEUuQ1VSU09SID09IHR5cGUpIHtcblx0XHRcdGF3YWl0IGVuZFJlZmVyZW5jZUN1cnNvckVmZmVjdCgpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHR9XG5cdHVwZGF0ZVN0YXRlKHtcblx0XHR0eXBlOiBgJHt0eXBlfS1zdGFydGAsXG5cdH0pO1xuXG5cdGlmICghc3BhbikgcmV0dXJuO1xuXHQvLyBjb25zdCB1dWlkID0gdXVpZHY0KCk7XG5cdC8vIGNvbnN0IHV1aWQyID0gdXVpZHY0KCk7XG5cdC8vIHNwYW4ucGFyZW50RWxlbWVudFxuXHQvLyBcdD8ucXVlcnlTZWxlY3RvcihcIi5yZWZlcmVuY2Utc3BhblwiKVxuXHQvLyBcdD8uY2xhc3NMaXN0LmFkZChcInJlZmVyZW5jZS1zcGFuLXNlbGVjdGVkXCIpO1xuXHQvLyBzcGFuLnBhcmVudEVsZW1lbnRcblx0Ly8gXHQ/LnF1ZXJ5U2VsZWN0b3IoXCIucmVmZXJlbmNlLXNwYW5cIilcblx0Ly8gXHQ/LmNsYXNzTGlzdC5hZGQoXCJ1dWlkLVwiICsgdXVpZCk7XG5cblx0Ly8gc3Bhbi5jbGFzc0xpc3QuYWRkKFwicmVmZXJlbmNlLWRhdGEtc3Bhbi1zZWxlY3RlZFwiKTtcblx0Ly8gc3Bhbi5jbGFzc0xpc3QuYWRkKFwidXVpZC1cIiArIHV1aWQyKTtcblxuXHQvLyB1cGRhdGVTdGF0ZSh7XG5cdC8vIFx0dXVpZCxcblx0Ly8gXHR1dWlkMixcblx0Ly8gfSk7XG5cdGxldCB1dWlkID0gQXJyYXkuZnJvbShzcGFuLmNsYXNzTGlzdCkuZmlsdGVyKChlbCkgPT4gZWwuaW5jbHVkZXMoXCJ1dWlkXCIpKVswXTtcblx0c3Bhbi5wYXJlbnRFbGVtZW50XG5cdFx0Py5xdWVyeVNlbGVjdG9yKFwiLnJlZmVyZW5jZS1zcGFuXCIpXG5cdFx0Py5jbGFzc0xpc3QuYWRkKFwicmVmZXJlbmNlLXNwYW4tc2VsZWN0ZWRcIik7XG5cdC8vIHNwYW4ucGFyZW50RWxlbWVudFxuXHQvLyBcdD8ucXVlcnlTZWxlY3RvcihcIi5yZWZlcmVuY2Utc3BhblwiKVxuXHQvLyBcdD8uY2xhc3NMaXN0LmFkZChcInV1aWQtXCIgKyB1dWlkKTtcblxuXHRzcGFuLmNsYXNzTGlzdC5hZGQoXCJyZWZlcmVuY2UtZGF0YS1zcGFuLXNlbGVjdGVkXCIpO1xuXHQvLyBzcGFuLmNsYXNzTGlzdC5hZGQoXCJ1dWlkLVwiICsgdXVpZDIpO1xuXG5cdHVwZGF0ZVN0YXRlKHtcblx0XHR1dWlkLFxuXHRcdC8vIHV1aWQyLFxuXHR9KTtcblxuXHRjb25zdCBkYXRhU3RyaW5nID0gc3Bhbi5nZXRBdHRyaWJ1dGUoXCJkYXRhXCIpO1xuXHRpZiAoIWRhdGFTdHJpbmcpIHRocm93IG5ldyBFcnJvcihcIkRhdGEgc3RyaW5nIG5vdCBmb3VuZFwiKTtcblxuXHRpZiAoZGVzdGluYXRpb24gIT0gbnVsbCAmJiBkZXN0aW5hdGlvbi5kYXRhU3RyaW5nID09IGRhdGFTdHJpbmcgJiYgQUNUSU9OX1RZUEUuQ1VSU09SICE9IHR5cGUpIHtcblx0XHR1cGRhdGVIb3ZlcihkZXN0aW5hdGlvbik7XG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0bGV0IFtwcmVmaXgsIHRleHQsIHN1ZmZpeCwgZmlsZSwgZnJvbSwgdG9dID0gcHJvY2Vzc1VSSShkYXRhU3RyaW5nKTtcblxuXHRsZXQgbGVhdmVzQnlUYWIgPSBjb2xsZWN0TGVhdmVzQnlUYWJIZWxwZXIoKTtcblxuXHRsZXQgY3VyclRhYklkeCA9IGdldEN1cnJlbnRUYWJJbmRleChsZWF2ZXNCeVRhYiwgc3Bhbik7XG5cblx0bGV0IGN1cnJMZWFmID0gZ2V0VGhhdCgpLndvcmtzcGFjZS5nZXRMZWFmKCk7XG5cblx0Ly8gQHRzLWlnbm9yZVxuXHRsZXQgY3VyckxlYWZJRCA9IGN1cnJMZWFmLmlkO1xuXHRpZiAoIWN1cnJMZWFmSUQpIHRocm93IG5ldyBFcnJvcihcImN1cnJMZWFmSUQgaWQgbm90IGZvdW5kXCIpO1xuXG5cdGNvbnN0IHsgbmV3TGVhZiwgdGVtcCwgb3JpZ2luYWxMZWFmIH0gPSBhd2FpdCBvcGVuRmlsZUluQWRqYWNlbnRUYWIoXG5cdFx0bGVhdmVzQnlUYWIsXG5cdFx0Y3VyclRhYklkeCxcblx0XHRmaWxlLFxuXHRcdHR5cGVcblx0KTtcblx0Ly8gaWYgKCFuZXdMZWFmKSB7XG5cdC8vIFx0cmVzZXRTdGF0ZSgpO1xuXHQvLyBcdHJldHVybjtcblx0Ly8gfVxuXHQvLyBhd2FpdCBkZWxheSg1MCk7IC8vIGVuc3VyZSBuZXcgbGVhZiBoYXMgb3BlbmVkIGNvbXBsZXRlbHkgYmVmb3JlIGRvaW5nIGNoZWNrcyBiZWxvd1xuXG5cdC8vIEB0cy1pZ25vcmVcblx0bGV0IGlkID0gbmV3TGVhZi5pZDtcblx0aWYgKCFpZCkgdGhyb3cgbmV3IEVycm9yKFwiTGVhZiBpZCBub3QgZm91bmRcIik7XG5cdHVwZGF0ZVN0YXRlKHtcblx0XHRsZWFmSWQ6IGlkLFxuXHRcdHRlbXAsXG5cdFx0cGVlazogdHJ1ZSxcblx0fSk7XG5cblx0Ly8gQHRzLWlnbm9yZVxuXHRjb25zdCBvcmlnaW5hbExlYWZJZCA9IG9yaWdpbmFsTGVhZi5pZDtcblxuXHRpZiAobmV3TGVhZiAmJiBuZXdMZWFmLnZpZXcgaW5zdGFuY2VvZiBNYXJrZG93blZpZXcpIHtcblx0XHRjb25zdCBlZGl0b3JWaWV3OiBFZGl0b3JWaWV3ID0gZ2V0RWRpdG9yVmlldyhuZXdMZWFmKTtcblx0XHRpZiAoIWVkaXRvclZpZXcpIHRocm93IG5ldyBFcnJvcihcIkVkaXRvciB2aWV3IG5vdCBmb3VuZFwiKTtcblx0XHRjb25zdCB2aWV3cG9ydCA9IG5ld0xlYWYudmlldy5lZGl0b3IuZ2V0U2Nyb2xsSW5mbygpO1xuXG5cdFx0aGlnaGxpZ2h0U2VsZWN0aW9uKGVkaXRvclZpZXcsIGZyb20sIHRvKTtcblxuXHRcdHRlbXBEaXJlY3Rpb25JbmRpY2F0b3IoXG5cdFx0XHRuZXdMZWFmLFxuXHRcdFx0dGV4dCxcblx0XHRcdHByZWZpeCxcblx0XHRcdHN1ZmZpeCxcblx0XHRcdGRhdGFTdHJpbmcsXG5cdFx0XHRpZCA9PT0gb3JpZ2luYWxMZWFmSWRcblx0XHQpO1xuXG5cdFx0Y29uc3QgY3Vyc29yVmlld3BvcnQgPSBuZXdMZWFmLnZpZXcuZWRpdG9yLmdldFNjcm9sbEluZm8oKTtcblxuXHRcdHVwZGF0ZVN0YXRlKHtcblx0XHRcdGRhdGFTdHJpbmcsXG5cdFx0XHRvcmlnaW5hbFRvcDogZWRpdG9yVmlldy5kb2N1bWVudFRvcCxcblx0XHRcdC8vIG9yaWdpbmFsTGVhZklkOiBjdXJyTGVhZklELFxuXHRcdFx0Y3Vyc29yVmlld3BvcnQsXG5cdFx0fSk7XG5cdH1cblxuXHRpZiAoXG5cdFx0aWQgIT0gb3JpZ2luYWxMZWFmSWQgJiZcblx0XHQobmV3TGVhZi5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKFwiLnZpZXctY29udGVudFwiKS5zdHlsZS5ib3hTaGFkb3cgPT1cblx0XHRcdFwibm9uZVwiIHx8XG5cdFx0XHRuZXdMZWFmLmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoXCIudmlldy1jb250ZW50XCIpLnN0eWxlLmJveFNoYWRvdyA9PSBcIlwiKVxuXHQpIHtcblx0XHRuZXdMZWFmLmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoXCIudmlldy1jb250ZW50XCIpLnN0eWxlLmJveFNoYWRvdyA9XG5cdFx0XHRcImluc2V0IDBweCAwcHggMTBweCAxMHB4IHJnYmEoMjQ4LCAyNTUsIDI1NSlcIjtcblx0fVxuXG5cdGlmIChvcmlnaW5hbExlYWZJZCkge1xuXHRcdHVwZGF0ZVN0YXRlKHtcblx0XHRcdG9yaWdpbmFsTGVhZklkLFxuXHRcdH0pO1xuXHR9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBlbmRSZWZlcmVuY2VDdXJzb3JFZmZlY3QoKSB7XG5cdGlmICghZ2V0Q3Vyc29yKCkgfHwgT2JqZWN0LmtleXMoZ2V0Q3Vyc29yKCkpLmxlbmd0aCA9PSAwKSB7XG5cdFx0Ly8gRW5kIG11dGV4IGxvY2tcblx0XHRyZXNldEN1cnNvcigpO1xuXHRcdHJldHVybjtcblx0fVxuXG5cdGNvbnN0IHtcblx0XHRkYXRhU3RyaW5nLFxuXHRcdGxlYWZJZCxcblx0XHRvcmlnaW5hbExlYWZJZCxcblx0XHR0ZW1wLFxuXHRcdGN1cnNvclZpZXdwb3J0LFxuXHRcdHBlZWssXG5cdFx0dXVpZCxcblx0fSA9IGdldEN1cnNvcigpO1xuXHRyZXNldEN1cnNvcigpO1xuXG5cdGlmIChnZXRIb3ZlcigpICE9IG51bGwgJiYgZ2V0SG92ZXIoKS5kYXRhU3RyaW5nID09IGRhdGFTdHJpbmcpIHtcblx0XHQvLyBFbmQgbXV0ZXggbG9ja1xuXHRcdHJlc2V0Q3Vyc29yKCk7XG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0Y29uc3QgeyB3b3Jrc3BhY2UgfSA9IGdldFRoYXQoKTtcblx0Y29uc3Qgd29ya3NwYWNlQ29udGFpbmVyID0gd29ya3NwYWNlLmNvbnRhaW5lckVsO1xuXHRjb25zdCBzcGFuID0gd29ya3NwYWNlQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCIuXCIgKyB1dWlkKTtcblxuXHRzcGFuPy5wYXJlbnRFbGVtZW50XG5cdFx0Py5xdWVyeVNlbGVjdG9yKFwiLnJlZmVyZW5jZS1zcGFuXCIpXG5cdFx0Py5jbGFzc0xpc3QucmVtb3ZlKFwicmVmZXJlbmNlLXNwYW4tc2VsZWN0ZWRcIik7XG5cdC8vIGZpcnN0U3BhblBhcnQ/LmNsYXNzTGlzdC5yZW1vdmUodXVpZCk7XG5cdHNwYW4/LmNsYXNzTGlzdC5yZW1vdmUoXCJyZWZlcmVuY2UtZGF0YS1zcGFuLXNlbGVjdGVkXCIpO1xuXG5cdGxldCB0YXJnZXRMZWFmID0gd29ya3NwYWNlLmdldExlYWZCeUlkKGxlYWZJZCk7XG5cdGlmICghdGFyZ2V0TGVhZikge1xuXHRcdHJlc2V0Q3Vyc29yKCk7XG5cdFx0dGhyb3cgbmV3IEVycm9yKFwiVGFyZ2V0IGxlYWYgbm90IGZvdW5kXCIpO1xuXHR9XG5cblx0Y29uc3QgYWN0aXZlTGVhZiA9IGdldFRoYXQoKS53b3Jrc3BhY2UuZ2V0TGVhZigpO1xuXHQvLyBAdHMtaWdub3JlIGlkXG5cdGNvbnN0IGFjdGl2ZUxlYWZJZCA9IGFjdGl2ZUxlYWYuaWQ7XG5cblx0bGV0IGVkaXRvclZpZXcgPSBnZXRFZGl0b3JWaWV3KHRhcmdldExlYWYpO1xuXG5cdHJlbW92ZUhpZ2hsaWdodHMoZWRpdG9yVmlldyk7XG5cblx0aWYgKGFjdGl2ZUxlYWZJZCA9PT0gbGVhZklkKSB7XG5cdFx0cmVzZXRDdXJzb3IoKTtcblx0XHRsZXQgY29udGFpbmVyRWw6IEhUTUxFbGVtZW50ID0gZ2V0Q29udGFpbmVyRWxlbWVudCh0YXJnZXRMZWFmKTtcblx0XHRpZiAoY29udGFpbmVyRWwgIT0gbnVsbCkge1xuXHRcdFx0Ly8gQHRzLWlnbm9yZVxuXHRcdFx0Y29udGFpbmVyRWwucXVlcnlTZWxlY3RvcihcIi52aWV3LWNvbnRlbnRcIik/LnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiXCIpO1xuXHRcdH1cblx0XHRyZXR1cm47XG5cdH1cblxuXHRpZiAoY3Vyc29yVmlld3BvcnQgJiYgdGFyZ2V0TGVhZiAmJiB0YXJnZXRMZWFmLnZpZXcgaW5zdGFuY2VvZiBNYXJrZG93blZpZXcpIHtcblx0XHRjb25zdCB2aWV3OiBNYXJrZG93blZpZXcgPSB0YXJnZXRMZWFmLnZpZXc7XG5cdFx0dmlldy5lZGl0b3Iuc2Nyb2xsVG8oMCwgY3Vyc29yVmlld3BvcnQudG9wKTtcblxuXHRcdC8vIGNvbnN0IHJlc3VsdCA9IGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG5cdFx0Ly8gXHRjb25zdCBzY3JvbGxpbmcgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG5cdFx0Ly8gXHRcdGNvbnN0IHNjcm9sbEFtb3VudCA9IDQwO1xuXHRcdC8vIFx0XHRjb25zdCBjdXJyZW50U2Nyb2xsID0gdmlldy5lZGl0b3IuZ2V0U2Nyb2xsSW5mbygpLnRvcDtcblx0XHQvLyBcdFx0aWYgKGN1cnJlbnRTY3JvbGwgPT0gY3Vyc29yVmlld3BvcnQudG9wKSB7XG5cdFx0Ly8gXHRcdFx0Y2xlYXJJbnRlcnZhbChzY3JvbGxpbmcpO1xuXHRcdC8vIFx0XHR9IGVsc2UgaWYgKGN1cnJlbnRTY3JvbGwgPiBjdXJzb3JWaWV3cG9ydC50b3ApIHtcblx0XHQvLyBcdFx0XHRpZiAoY3VycmVudFNjcm9sbCAtIHNjcm9sbEFtb3VudCA8IGN1cnNvclZpZXdwb3J0LnRvcCkge1xuXHRcdC8vIFx0XHRcdFx0dmlldy5lZGl0b3Iuc2Nyb2xsVG8oMCwgY3Vyc29yVmlld3BvcnQudG9wKTtcblx0XHQvLyBcdFx0XHRcdGNsZWFySW50ZXJ2YWwoc2Nyb2xsaW5nKTtcblx0XHQvLyBcdFx0XHRcdHJlc29sdmUoXCJkb25lXCIpO1xuXHRcdC8vIFx0XHRcdH0gZWxzZSB7XG5cdFx0Ly8gXHRcdFx0XHR2aWV3LmVkaXRvci5zY3JvbGxUbygwLCBjdXJyZW50U2Nyb2xsIC0gc2Nyb2xsQW1vdW50KTtcblx0XHQvLyBcdFx0XHR9XG5cdFx0Ly8gXHRcdH0gZWxzZSBpZiAoY3VycmVudFNjcm9sbCA8IGN1cnNvclZpZXdwb3J0LnRvcCkge1xuXHRcdC8vIFx0XHRcdGlmIChjdXJyZW50U2Nyb2xsICsgc2Nyb2xsQW1vdW50ID4gY3Vyc29yVmlld3BvcnQudG9wKSB7XG5cdFx0Ly8gXHRcdFx0XHR2aWV3LmVkaXRvci5zY3JvbGxUbygwLCBjdXJzb3JWaWV3cG9ydC50b3ApO1xuXHRcdC8vIFx0XHRcdFx0Y2xlYXJJbnRlcnZhbChzY3JvbGxpbmcpO1xuXHRcdC8vIFx0XHRcdFx0cmVzb2x2ZShcImRvbmVcIik7XG5cdFx0Ly8gXHRcdFx0fSBlbHNlIHtcblx0XHQvLyBcdFx0XHRcdHZpZXcuZWRpdG9yLnNjcm9sbFRvKDAsIGN1cnJlbnRTY3JvbGwgKyBzY3JvbGxBbW91bnQpO1xuXHRcdC8vIFx0XHRcdH1cblx0XHQvLyBcdFx0fVxuXHRcdC8vIFx0fSwgMTApO1xuXHRcdC8vIH0pO1xuXG5cdFx0Ly8gdmlldy5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKFwiLmNtLXNjcm9sbGVyXCIpPy5zY3JvbGxUbyh7XG5cdFx0Ly8gXHR0b3A6IGN1cnNvclZpZXdwb3J0LnRvcCxcblx0XHQvLyBcdGJlaGF2aW9yOiBcInNtb290aFwiLFxuXHRcdC8vIH0pO1xuXG5cdFx0Ly8gaWYgdGhlIGhvdmVyIGlzIGFjdGl2ZSwgaGlnaGxpZ2h0IHRoZSBzZWxlY3Rpb25cblx0XHRpZiAoZ2V0SG92ZXIoKSAhPSBudWxsKSB7XG5cdFx0XHRjb25zdCB7IGRhdGFTdHJpbmcsIGN1cnNvclZpZXdwb3J0LCBsZWFmSWQsIG9yaWdpbmFsTGVhZklkIH0gPSBnZXRIb3ZlcigpO1xuXHRcdFx0bGV0IFtwcmVmaXgsIHRleHQsIHN1ZmZpeCwgZmlsZSwgZnJvbSwgdG9dID0gcHJvY2Vzc1VSSShkYXRhU3RyaW5nKTtcblx0XHRcdGNvbnN0IGN1cnNvckxlYWYgPSB3b3Jrc3BhY2UuZ2V0TGVhZkJ5SWQobGVhZklkKTtcblx0XHRcdHdvcmtzcGFjZS5yZXZlYWxMZWFmKGN1cnNvckxlYWYpO1xuXHRcdFx0Y29uc3QgZWRpdG9yVmlldzogRWRpdG9yVmlldyA9IGdldEVkaXRvclZpZXcoY3Vyc29yTGVhZik7XG5cdFx0XHRoaWdobGlnaHRTZWxlY3Rpb24oZWRpdG9yVmlldywgZnJvbSwgdG8pO1xuXHRcdFx0Ly8gdGVtcERpcmVjdGlvbkluZGljYXRvcihcblx0XHRcdC8vIFx0Y3Vyc29yTGVhZixcblx0XHRcdC8vIFx0dGV4dCxcblx0XHRcdC8vIFx0cHJlZml4LFxuXHRcdFx0Ly8gXHRzdWZmaXgsXG5cdFx0XHQvLyBcdHRlbXAsXG5cdFx0XHQvLyBcdGRhdGFTdHJpbmcsXG5cdFx0XHQvLyBcdEFDVElPTl9UWVBFLk1PVVNFXG5cdFx0XHQvLyApO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRsZXQgY29udGFpbmVyRWw6IEhUTUxFbGVtZW50ID0gZ2V0Q29udGFpbmVyRWxlbWVudCh0YXJnZXRMZWFmKTtcblx0XHRcdGlmIChjb250YWluZXJFbCAhPSBudWxsKSB7XG5cdFx0XHRcdC8vIEB0cy1pZ25vcmVcblx0XHRcdFx0Y29udGFpbmVyRWwucXVlcnlTZWxlY3RvcihcIi52aWV3LWNvbnRlbnRcIik/LnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiXCIpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdGlmICh0ZW1wICYmIHRhcmdldExlYWYpIHtcblx0XHR0YXJnZXRMZWFmLmRldGFjaCgpO1xuXHR9XG5cblx0aWYgKHBlZWspIHtcblx0XHRsZXQgb3JpZ2luYWxMZWFmID0gd29ya3NwYWNlLmdldExlYWZCeUlkKG9yaWdpbmFsTGVhZklkKTtcblx0XHRpZiAoIW9yaWdpbmFsTGVhZikgdGhyb3cgbmV3IEVycm9yKFwiT3JpZ2luYWwgbGVhZiBub3QgZm91bmRcIik7XG5cblx0XHR3b3Jrc3BhY2UucmV2ZWFsTGVhZihvcmlnaW5hbExlYWYpO1xuXHR9XG5cblx0Ly8gaWYgKCF0ZW1wKSB7XG5cdC8vIFx0bGV0IG9yaWdpbmFsTGVhZiA9IHdvcmtzcGFjZS5nZXRMZWFmQnlJZChvcmlnaW5hbExlYWZJZCk7XG5cdC8vIFx0aWYgKCFvcmlnaW5hbExlYWYpIHRocm93IG5ldyBFcnJvcihcIk9yaWdpbmFsIGxlYWYgbm90IGZvdW5kXCIpO1xuXG5cdC8vIFx0d29ya3NwYWNlLnJldmVhbExlYWYob3JpZ2luYWxMZWFmKTtcblx0Ly8gfVxuXHQvLyBFbmQgbXV0ZXggbG9ja1xuXHRyZXNldEN1cnNvcigpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZW5kUmVmZXJlbmNlSG92ZXJFZmZlY3QoKSB7XG5cdGlmICghZ2V0SG92ZXIoKSB8fCBPYmplY3Qua2V5cyhnZXRIb3ZlcigpKS5sZW5ndGggPT0gMCkge1xuXHRcdC8vIEVuZCBtdXRleCBsb2NrXG5cdFx0cmVzZXRIb3ZlcigpO1xuXHRcdHJldHVybjtcblx0fVxuXG5cdGxldCB7IGRhdGFTdHJpbmcsIGxlYWZJZCwgb3JpZ2luYWxMZWFmSWQsIHRlbXAsIGN1cnNvclZpZXdwb3J0LCBwZWVrLCB1dWlkIH0gPVxuXHRcdGdldEhvdmVyKCk7XG5cdHJlc2V0SG92ZXIoKTtcblxuXHRpZiAoZ2V0Q3Vyc29yKCkgIT0gbnVsbCAmJiBnZXRDdXJzb3IoKS5kYXRhU3RyaW5nID09IGRhdGFTdHJpbmcpIHtcblx0XHQvLyBjb25zb2xlLmxvZyhcImN1cnNvciByZXNldFwiKTtcblx0XHQvLyBFbmQgbXV0ZXggbG9ja1xuXHRcdHJlc2V0SG92ZXIoKTtcblx0XHRyZXR1cm47XG5cdH1cblxuXHRjb25zdCB7IHdvcmtzcGFjZSB9ID0gZ2V0VGhhdCgpO1xuXG5cdGxldCB0YXJnZXRMZWFmID0gd29ya3NwYWNlLmdldExlYWZCeUlkKGxlYWZJZCk7XG5cdGlmICghdGFyZ2V0TGVhZikge1xuXHRcdHJlc2V0SG92ZXIoKTtcblx0XHR0aHJvdyBuZXcgRXJyb3IoXCJUYXJnZXQgbGVhZiBub3QgZm91bmRcIik7XG5cdH1cblxuXHRjb25zdCB3b3Jrc3BhY2VDb250YWluZXIgPSB3b3Jrc3BhY2UuY29udGFpbmVyRWw7XG5cdGNvbnN0IHNwYW4gPSB3b3Jrc3BhY2VDb250YWluZXIucXVlcnlTZWxlY3RvcihcIi5cIiArIHV1aWQpO1xuXG5cdHNwYW4/LnBhcmVudEVsZW1lbnRcblx0XHQ/LnF1ZXJ5U2VsZWN0b3IoXCIucmVmZXJlbmNlLXNwYW5cIilcblx0XHQ/LmNsYXNzTGlzdC5yZW1vdmUoXCJyZWZlcmVuY2Utc3Bhbi1zZWxlY3RlZFwiKTtcblx0Ly8gZmlyc3RTcGFuUGFydD8uY2xhc3NMaXN0LnJlbW92ZSh1dWlkKTtcblx0c3Bhbj8uY2xhc3NMaXN0LnJlbW92ZShcInJlZmVyZW5jZS1kYXRhLXNwYW4tc2VsZWN0ZWRcIik7XG5cdC8vIGNvbnN0IGZpcnN0U3BhblBhcnQgPSB3b3Jrc3BhY2VDb250YWluZXIucXVlcnlTZWxlY3RvcihcIi5cIiArIFwidXVpZC1cIiArIHV1aWQpO1xuXHQvLyBmaXJzdFNwYW5QYXJ0Py5jbGFzc0xpc3QucmVtb3ZlKFwicmVmZXJlbmNlLXNwYW4tc2VsZWN0ZWRcIik7XG5cdC8vIGZpcnN0U3BhblBhcnQ/LmNsYXNzTGlzdC5yZW1vdmUodXVpZCk7XG5cblx0Ly8gY29uc3Qgc2Vjb25kU3BhblBhcnQgPSB3b3Jrc3BhY2VDb250YWluZXIucXVlcnlTZWxlY3Rvcihcblx0Ly8gXHRcIi5cIiArIFwidXVpZC1cIiArIHV1aWQyXG5cdC8vICk7XG5cdC8vIHNlY29uZFNwYW5QYXJ0Py5jbGFzc0xpc3QucmVtb3ZlKFwicmVmZXJlbmNlLWRhdGEtc3Bhbi1zZWxlY3RlZFwiKTtcblx0Ly8gc2Vjb25kU3BhblBhcnQ/LmNsYXNzTGlzdC5yZW1vdmUoXCJ1dWlkLVwiICsgdXVpZDIpO1xuXG5cdGNvbnN0IGFjdGl2ZUxlYWYgPSBnZXRUaGF0KCkud29ya3NwYWNlLmdldExlYWYoKTtcblx0Ly8gQHRzLWlnbm9yZSBpZFxuXG5cdGxldCBlZGl0b3JWaWV3ID0gZ2V0RWRpdG9yVmlldyh0YXJnZXRMZWFmKTtcblxuXHRyZW1vdmVIaWdobGlnaHRzKGVkaXRvclZpZXcpO1xuXG5cdGlmIChjdXJzb3JWaWV3cG9ydCAmJiB0YXJnZXRMZWFmICYmIHRhcmdldExlYWYudmlldyBpbnN0YW5jZW9mIE1hcmtkb3duVmlldykge1xuXHRcdGNvbnN0IHZpZXc6IE1hcmtkb3duVmlldyA9IHRhcmdldExlYWYudmlldztcblx0XHR2aWV3LmVkaXRvci5zY3JvbGxUbygwLCBjdXJzb3JWaWV3cG9ydC50b3ApO1xuXG5cdFx0Ly8gY29uc3QgY3VycmVudFNjcm9sbCA9IHZpZXcuZWRpdG9yLmdldFNjcm9sbEluZm8oKS50b3A7XG5cdFx0Ly8gY29uc3QgcmVzdWx0ID0gYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcblx0XHQvLyBcdGNvbnN0IHNjcm9sbGluZyA9IHNldEludGVydmFsKCgpID0+IHtcblx0XHQvLyBcdFx0Y29uc3Qgc2Nyb2xsQW1vdW50ID0gNDA7XG5cdFx0Ly8gXHRcdGNvbnN0IGN1cnJlbnRTY3JvbGwgPSB2aWV3LmVkaXRvci5nZXRTY3JvbGxJbmZvKCkudG9wO1xuXHRcdC8vIFx0XHRpZiAoY3VycmVudFNjcm9sbCA9PSBjdXJzb3JWaWV3cG9ydC50b3ApIHtcblx0XHQvLyBcdFx0XHRjbGVhckludGVydmFsKHNjcm9sbGluZyk7XG5cdFx0Ly8gXHRcdH0gZWxzZSBpZiAoY3VycmVudFNjcm9sbCA+IGN1cnNvclZpZXdwb3J0LnRvcCkge1xuXHRcdC8vIFx0XHRcdGlmIChjdXJyZW50U2Nyb2xsIC0gc2Nyb2xsQW1vdW50IDwgY3Vyc29yVmlld3BvcnQudG9wKSB7XG5cdFx0Ly8gXHRcdFx0XHR2aWV3LmVkaXRvci5zY3JvbGxUbygwLCBjdXJzb3JWaWV3cG9ydC50b3ApO1xuXHRcdC8vIFx0XHRcdFx0Y2xlYXJJbnRlcnZhbChzY3JvbGxpbmcpO1xuXHRcdC8vIFx0XHRcdFx0cmVzb2x2ZShcImRvbmVcIik7XG5cdFx0Ly8gXHRcdFx0fSBlbHNlIHtcblx0XHQvLyBcdFx0XHRcdHZpZXcuZWRpdG9yLnNjcm9sbFRvKDAsIGN1cnJlbnRTY3JvbGwgLSBzY3JvbGxBbW91bnQpO1xuXHRcdC8vIFx0XHRcdH1cblx0XHQvLyBcdFx0fSBlbHNlIGlmIChjdXJyZW50U2Nyb2xsIDwgY3Vyc29yVmlld3BvcnQudG9wKSB7XG5cdFx0Ly8gXHRcdFx0aWYgKGN1cnJlbnRTY3JvbGwgKyBzY3JvbGxBbW91bnQgPiBjdXJzb3JWaWV3cG9ydC50b3ApIHtcblx0XHQvLyBcdFx0XHRcdHZpZXcuZWRpdG9yLnNjcm9sbFRvKDAsIGN1cnNvclZpZXdwb3J0LnRvcCk7XG5cdFx0Ly8gXHRcdFx0XHRjbGVhckludGVydmFsKHNjcm9sbGluZyk7XG5cdFx0Ly8gXHRcdFx0XHRyZXNvbHZlKFwiZG9uZVwiKTtcblx0XHQvLyBcdFx0XHR9IGVsc2Uge1xuXHRcdC8vIFx0XHRcdFx0dmlldy5lZGl0b3Iuc2Nyb2xsVG8oMCwgY3VycmVudFNjcm9sbCArIHNjcm9sbEFtb3VudCk7XG5cdFx0Ly8gXHRcdFx0fVxuXHRcdC8vIFx0XHR9XG5cdFx0Ly8gXHR9LCAxMCk7XG5cdFx0Ly8gfSk7XG5cblx0XHQvLyB2aWV3LmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoXCIuY20tc2Nyb2xsZXJcIik/LnNjcm9sbFRvKHtcblx0XHQvLyBcdHRvcDogY3Vyc29yVmlld3BvcnQudG9wLFxuXHRcdC8vIFx0YmVoYXZpb3I6IFwic21vb3RoXCIsXG5cdFx0Ly8gfSk7XG5cblx0XHQvLyBpZiB0aGUgY3Vyc29yIGlzIGFjdGl2ZSwgaGlnaGxpZ2h0IHRoZSBzZWxlY3Rpb25cblx0XHRpZiAoZ2V0Q3Vyc29yKCkgIT0gbnVsbCAmJiBnZXRDdXJzb3IoKS5kYXRhU3RyaW5nKSB7XG5cdFx0XHRjb25zdCB7IGRhdGFTdHJpbmcsIGN1cnNvclZpZXdwb3J0LCBsZWFmSWQsIG9yaWdpbmFsTGVhZklkIH0gPVxuXHRcdFx0XHRnZXRDdXJzb3IoKTtcblx0XHRcdGxldCBbcHJlZml4LCB0ZXh0LCBzdWZmaXgsIGZpbGUsIGZyb20sIHRvLCBwb3J0YWwsIHRvZ2dsZV0gPVxuXHRcdFx0XHRwcm9jZXNzVVJJKGRhdGFTdHJpbmcpO1xuXHRcdFx0Y29uc3QgY3Vyc29yTGVhZiA9IHdvcmtzcGFjZS5nZXRMZWFmQnlJZChsZWFmSWQpO1xuXHRcdFx0d29ya3NwYWNlLnJldmVhbExlYWYoY3Vyc29yTGVhZik7XG5cdFx0XHRjb25zdCBlZGl0b3JWaWV3OiBFZGl0b3JWaWV3ID0gZ2V0RWRpdG9yVmlldyhjdXJzb3JMZWFmKTtcblx0XHRcdGlmICghZWRpdG9yVmlldykgdGhyb3cgbmV3IEVycm9yKFwiRWRpdG9yIHZpZXcgbm90IGZvdW5kXCIpO1xuXG5cdFx0XHRoaWdobGlnaHRTZWxlY3Rpb24oZWRpdG9yVmlldywgZnJvbSwgdG8pO1xuXHRcdFx0Ly8gdGVtcERpcmVjdGlvbkluZGljYXRvcihcblx0XHRcdC8vIFx0Y3Vyc29yTGVhZixcblx0XHRcdC8vIFx0dGV4dCxcblx0XHRcdC8vIFx0cHJlZml4LFxuXHRcdFx0Ly8gXHRzdWZmaXgsXG5cdFx0XHQvLyBcdHRlbXAsXG5cdFx0XHQvLyBcdGRhdGFTdHJpbmdcblx0XHRcdC8vICk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGxldCBjb250YWluZXJFbDogSFRNTEVsZW1lbnQgPSBnZXRDb250YWluZXJFbGVtZW50KHRhcmdldExlYWYpO1xuXHRcdFx0aWYgKGNvbnRhaW5lckVsICE9IG51bGwpIHtcblx0XHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdFx0Ly8gQHRzLWlnbm9yZVxuXHRcdFx0XHRcdGNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoXCIudmlldy1jb250ZW50XCIpPy5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcIlwiKTtcblx0XHRcdFx0fSwgNTApO1xuXHRcdFx0fVxuXHRcdH1cblx0XHQvLyBUb2dnbGluZyB2aXN1YWwgaG92ZXIgc3RhdGVcblx0XHQvLyBsZXQgYWN0aXZlQ29udGFpbmVyRWw6IEhUTUxFbGVtZW50ID0gZ2V0Q29udGFpbmVyRWxlbWVudChhY3RpdmVMZWFmKTtcblxuXHRcdC8vIGlmIChhY3RpdmVDb250YWluZXJFbCAhPSBudWxsKSB7XG5cdFx0Ly8gXHRhY3RpdmVDb250YWluZXJFbFxuXHRcdC8vIFx0XHQucXVlcnlTZWxlY3RvcihcIi5yZWZlcmVuY2Utc3Bhbi1zZWxlY3RlZFwiKVxuXHRcdC8vIFx0XHQ/LmNsYXNzTGlzdC5yZW1vdmUoXCJyZWZlcmVuY2Utc3Bhbi1zZWxlY3RlZFwiKTtcblxuXHRcdC8vIFx0YWN0aXZlQ29udGFpbmVyRWxcblx0XHQvLyBcdFx0LnF1ZXJ5U2VsZWN0b3IoXCIucmVmZXJlbmNlLWRhdGEtc3Bhbi1zZWxlY3RlZFwiKVxuXHRcdC8vIFx0XHQ/LmNsYXNzTGlzdC5yZW1vdmUoXCJyZWZlcmVuY2UtZGF0YS1zcGFuLXNlbGVjdGVkXCIpO1xuXHRcdC8vIH1cblx0fVxuXG5cdGlmICh0ZW1wICYmIHRhcmdldExlYWYpIHtcblx0XHR0YXJnZXRMZWFmLmRldGFjaCgpO1xuXG5cdFx0bGV0IG9yaWdpbmFsTGVhZiA9IHdvcmtzcGFjZS5nZXRMZWFmQnlJZChvcmlnaW5hbExlYWZJZCk7XG5cdFx0aWYgKCFvcmlnaW5hbExlYWYpIHRocm93IG5ldyBFcnJvcihcIk9yaWdpbmFsIGxlYWYgbm90IGZvdW5kXCIpO1xuXG5cdFx0d29ya3NwYWNlLnJldmVhbExlYWYob3JpZ2luYWxMZWFmKTtcblx0fVxuXG5cdGlmIChwZWVrKSB7XG5cdFx0bGV0IG9yaWdpbmFsTGVhZiA9IHdvcmtzcGFjZS5nZXRMZWFmQnlJZChvcmlnaW5hbExlYWZJZCk7XG5cdFx0aWYgKCFvcmlnaW5hbExlYWYpIHtcblx0XHRcdHJlc2V0SG92ZXIoKTtcblx0XHRcdHRocm93IG5ldyBFcnJvcihcIk9yaWdpbmFsIGxlYWYgbm90IGZvdW5kXCIpO1xuXHRcdH1cblxuXHRcdHdvcmtzcGFjZS5yZXZlYWxMZWFmKG9yaWdpbmFsTGVhZik7XG5cdH1cblx0Ly8gaWYgKCF0ZW1wKSB7XG5cdC8vIFx0bGV0IG9yaWdpbmFsTGVhZiA9IHdvcmtzcGFjZS5nZXRMZWFmQnlJZChvcmlnaW5hbExlYWZJZCk7XG5cdC8vIFx0aWYgKCFvcmlnaW5hbExlYWYpIHRocm93IG5ldyBFcnJvcihcIk9yaWdpbmFsIGxlYWYgbm90IGZvdW5kXCIpO1xuXG5cdC8vIFx0d29ya3NwYWNlLnJldmVhbExlYWYob3JpZ2luYWxMZWFmKTtcblx0Ly8gfVxuXG5cdC8vIEVuZCBtdXRleCBsb2NrXG5cdHJlc2V0SG92ZXIoKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGVuZEJhY2tsaW5rSG92ZXJFZmZlY3QoKSB7XG5cdGlmICghZ2V0QmFja2xpbmtIb3ZlcigpIHx8IE9iamVjdC5rZXlzKGdldEJhY2tsaW5rSG92ZXIoKSkubGVuZ3RoID09IDApIHtcblx0XHQvLyBFbmQgbXV0ZXggbG9ja1xuXHRcdHJlc2V0QmFja2xpbmtIb3ZlcigpO1xuXHRcdHJldHVybjtcblx0fVxuXG5cdGNvbnN0IHtcblx0XHRkYXRhU3RyaW5nLFxuXHRcdGxlYWZJZCxcblx0XHRvcmlnaW5hbExlYWZJZCxcblx0XHRiYWNrbGlua0xlYWZJZCxcblx0XHR0ZW1wLFxuXHRcdGN1cnNvclZpZXdwb3J0LFxuXHRcdHBlZWssXG5cdFx0dXVpZCxcblx0XHRiYWNrbGlua1VVSUQsXG5cdH0gPSBnZXRCYWNrbGlua0hvdmVyKCk7XG5cdHJlc2V0QmFja2xpbmtIb3ZlcigpO1xuXG5cdGlmIChnZXRDdXJzb3IoKSAhPSBudWxsICYmIGdldEN1cnNvcigpLmRhdGFTdHJpbmcgPT0gZGF0YVN0cmluZykge1xuXHRcdC8vIEVuZCBtdXRleCBsb2NrXG5cdFx0cmVzZXRCYWNrbGlua0hvdmVyKCk7XG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0Y29uc3QgeyB3b3Jrc3BhY2UgfSA9IGdldFRoYXQoKTtcblx0bGV0IHRhcmdldExlYWYgPSB3b3Jrc3BhY2UuZ2V0TGVhZkJ5SWQobGVhZklkKTtcblx0aWYgKCF0YXJnZXRMZWFmKSB7XG5cdFx0cmVzZXRCYWNrbGlua0hvdmVyKCk7XG5cdFx0dGhyb3cgbmV3IEVycm9yKFwiVGFyZ2V0IGxlYWYgbm90IGZvdW5kXCIpO1xuXHR9XG5cblx0Ly8gUmVtb3ZlIGFsbCBoaWdobGlnaHRzXG5cdGNvbnN0IHdvcmtzcGFjZUNvbnRhaW5lciA9IHdvcmtzcGFjZS5jb250YWluZXJFbDtcblx0Y29uc3Qgc3BhbiA9IHdvcmtzcGFjZUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiLlwiICsgdXVpZCk7XG5cblx0c3Bhbj8ucGFyZW50RWxlbWVudFxuXHRcdD8ucXVlcnlTZWxlY3RvcihcIi5yZWZlcmVuY2Utc3BhblwiKVxuXHRcdD8uY2xhc3NMaXN0LnJlbW92ZShcInJlZmVyZW5jZS1zcGFuLXNlbGVjdGVkXCIpO1xuXHQvLyBmaXJzdFNwYW5QYXJ0Py5jbGFzc0xpc3QucmVtb3ZlKHV1aWQpO1xuXHRzcGFuPy5jbGFzc0xpc3QucmVtb3ZlKFwicmVmZXJlbmNlLWRhdGEtc3Bhbi1zZWxlY3RlZFwiKTtcblxuXHQvLyBjb25zdCBzZWNvbmRTcGFuUGFydCA9IHdvcmtzcGFjZUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFxuXHQvLyBcdFwiLlwiICsgXCJ1dWlkLVwiICsgdXVpZDJcblx0Ly8gKTtcblx0Ly8gc2Vjb25kU3BhblBhcnQ/LmNsYXNzTGlzdC5yZW1vdmUoXCJyZWZlcmVuY2UtZGF0YS1zcGFuLXNlbGVjdGVkXCIpO1xuXHQvLyBzZWNvbmRTcGFuUGFydD8uY2xhc3NMaXN0LnJlbW92ZShcInV1aWQtXCIgKyB1dWlkMik7XG5cblx0Ly8gY29uc3QgZmlyc3RCYWNrbGlua1NwYW5QYXJ0ID0gd29ya3NwYWNlQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXG5cdC8vIFx0XCIuXCIgKyBcInV1aWQtXCIgKyBiYWNrbGlua1VVSURcblx0Ly8gKTtcblx0Ly8gY29uc29sZS5sb2coZmlyc3RCYWNrbGlua1NwYW5QYXJ0KTtcblx0Ly8gZmlyc3RCYWNrbGlua1NwYW5QYXJ0Py5jbGFzc0xpc3QucmVtb3ZlKFwicmVmZXJlbmNlLXNwYW4tc2VsZWN0ZWRcIik7XG5cdC8vIGZpcnN0QmFja2xpbmtTcGFuUGFydD8uY2xhc3NMaXN0LnJlbW92ZShiYWNrbGlua1VVSUQpO1xuXG5cdC8vIGNvbnN0IHNlY29uZEJhY2tsaW5rU3BhblBhcnQgPSB3b3Jrc3BhY2VDb250YWluZXIucXVlcnlTZWxlY3Rvcihcblx0Ly8gXHRcIi5cIiArIFwidXVpZC1cIiArIGJhY2tsaW5rVVVJRDJcblx0Ly8gKTtcblx0Ly8gc2Vjb25kQmFja2xpbmtTcGFuUGFydD8uY2xhc3NMaXN0LnJlbW92ZShcInJlZmVyZW5jZS1kYXRhLXNwYW4tc2VsZWN0ZWRcIik7XG5cdC8vIHNlY29uZEJhY2tsaW5rU3BhblBhcnQ/LmNsYXNzTGlzdC5yZW1vdmUoXCJ1dWlkLVwiICsgYmFja2xpbmtVVUlEMik7XG5cblx0Y29uc3QgYmFja2xpbmtTcGFuID0gd29ya3NwYWNlQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCIuXCIgKyBiYWNrbGlua1VVSUQpO1xuXG5cdGJhY2tsaW5rU3Bhbj8ucGFyZW50RWxlbWVudFxuXHRcdD8ucXVlcnlTZWxlY3RvcihcIi5yZWZlcmVuY2Utc3BhblwiKVxuXHRcdD8uY2xhc3NMaXN0LnJlbW92ZShcInJlZmVyZW5jZS1zcGFuLXNlbGVjdGVkXCIpO1xuXHRiYWNrbGlua1NwYW4/LmNsYXNzTGlzdC5yZW1vdmUoXCJyZWZlcmVuY2UtZGF0YS1zcGFuLXNlbGVjdGVkXCIpO1xuXG5cdGlmIChjdXJzb3JWaWV3cG9ydCAmJiB0YXJnZXRMZWFmICYmIHRhcmdldExlYWYudmlldyBpbnN0YW5jZW9mIE1hcmtkb3duVmlldykge1xuXHRcdGNvbnN0IHZpZXc6IE1hcmtkb3duVmlldyA9IHRhcmdldExlYWYudmlldztcblx0XHR2aWV3LmVkaXRvci5zY3JvbGxUbygwLCBjdXJzb3JWaWV3cG9ydC50b3ApO1xuXHR9XG5cblx0bGV0IGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCA9IGdldENvbnRhaW5lckVsZW1lbnQodGFyZ2V0TGVhZik7XG5cdGlmIChjb250YWluZXJFbCAhPSBudWxsKSB7XG5cdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHQvLyBAdHMtaWdub3JlXG5cdFx0XHRjb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKFwiLnZpZXctY29udGVudFwiKT8uc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJcIik7XG5cdFx0fSwgNTApO1xuXHR9XG5cblx0bGV0IGVkaXRvclZpZXc6IEVkaXRvclZpZXcgPSBnZXRFZGl0b3JWaWV3KHRhcmdldExlYWYpO1xuXG5cdHJlbW92ZUhpZ2hsaWdodHMoZWRpdG9yVmlldyk7XG5cblx0Ly8gYmFja2xpbmsgZWZmZWN0XG5cdGNvbnN0IG9yaWdpbmFsTGVhZiA9IHdvcmtzcGFjZS5nZXRMZWFmQnlJZChiYWNrbGlua0xlYWZJZCk7XG5cdGlmICghb3JpZ2luYWxMZWFmKSB7XG5cdFx0cmVzZXRCYWNrbGlua0hvdmVyKCk7XG5cdFx0dGhyb3cgbmV3IEVycm9yKFwiT3JpZ2luYWwgbGVhZiBub3QgZm91bmRcIik7XG5cdH1cblx0bGV0IG9yaWdpbmFsRWRpdG9yVmlldzogRWRpdG9yVmlldyA9IGdldEVkaXRvclZpZXcob3JpZ2luYWxMZWFmKTtcblxuXHRyZW1vdmVIaWdobGlnaHRzKG9yaWdpbmFsRWRpdG9yVmlldyk7XG5cblx0aWYgKGdldEN1cnNvcigpICE9IG51bGwgJiYgZ2V0Q3Vyc29yKCkuZGF0YVN0cmluZykge1xuXHRcdGNvbnN0IHsgZGF0YVN0cmluZywgY3Vyc29yVmlld3BvcnQsIGxlYWZJZCwgb3JpZ2luYWxMZWFmSWQgfSA9IGdldEN1cnNvcigpO1xuXHRcdGxldCBbcHJlZml4LCB0ZXh0LCBzdWZmaXgsIGZpbGUsIGZyb20sIHRvXSA9IHByb2Nlc3NVUkkoZGF0YVN0cmluZyk7XG5cdFx0Y29uc3QgY3Vyc29yTGVhZiA9IHdvcmtzcGFjZS5nZXRMZWFmQnlJZChsZWFmSWQpO1xuXHRcdHdvcmtzcGFjZS5yZXZlYWxMZWFmKGN1cnNvckxlYWYpO1xuXG5cdFx0Y29uc3QgZWRpdG9yVmlldzogRWRpdG9yVmlldyA9IGdldEVkaXRvclZpZXcoY3Vyc29yTGVhZik7XG5cdFx0aGlnaGxpZ2h0U2VsZWN0aW9uKGVkaXRvclZpZXcsIGZyb20sIHRvKTtcblx0fVxuXG5cdGlmICh0ZW1wICYmIHRhcmdldExlYWYpIHtcblx0XHR0YXJnZXRMZWFmLmRldGFjaCgpO1xuXHR9XG5cblx0aWYgKHBlZWspIHtcblx0XHRsZXQgb3JpZ2luYWxMZWFmID0gd29ya3NwYWNlLmdldExlYWZCeUlkKG9yaWdpbmFsTGVhZklkKTtcblx0XHRpZiAoIW9yaWdpbmFsTGVhZikge1xuXHRcdFx0cmVzZXRCYWNrbGlua0hvdmVyKCk7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoXCJPcmlnaW5hbCBsZWFmIG5vdCBmb3VuZFwiKTtcblx0XHR9XG5cblx0XHR3b3Jrc3BhY2UucmV2ZWFsTGVhZihvcmlnaW5hbExlYWYpO1xuXHR9XG5cblx0Ly8gaWYgKHRlbXApIHtcblx0Ly8gXHR0YXJnZXRMZWFmLmRldGFjaCgpO1xuXHQvLyBcdC8vIHNldFRpbWVvdXQoKCkgPT4ge1xuXHQvLyBcdC8vIFx0dGFyZ2V0TGVhZi5kZXRhY2goKTtcblx0Ly8gXHQvLyB9LCAxMDApO1xuXHQvLyB9IGVsc2Uge1xuXHQvLyBcdC8vIGlmIHRoZSBjdXJzb3IgaXMgYWN0aXZlLCBoaWdobGlnaHQgdGhlIHNlbGVjdGlvblxuXHQvLyB9XG5cblx0Ly8gRW5kIG11dGV4IGxvY2tcblx0cmVzZXRCYWNrbGlua0hvdmVyKCk7XG59XG4iLCAiaW1wb3J0IHsgRWRpdG9yVmlldywgRGVjb3JhdGlvbiwgRGVjb3JhdGlvblNldCB9IGZyb20gXCJAY29kZW1pcnJvci92aWV3XCI7XG5pbXBvcnQgeyBTdGF0ZUZpZWxkLCBTdGF0ZUVmZmVjdCB9IGZyb20gXCJAY29kZW1pcnJvci9zdGF0ZVwiO1xuaW1wb3J0IHsgU1ZHX0hPVkVSX0NPTE9SIH0gZnJvbSBcIi4vY29uc3RhbnRzXCI7XG5cbmNvbnN0IGFkZEhpZ2hsaWdodCA9IFN0YXRlRWZmZWN0LmRlZmluZTx7IGZyb206IG51bWJlcjsgdG86IG51bWJlciB9Pih7XG5cdG1hcDogKHsgZnJvbSwgdG8gfSwgY2hhbmdlKSA9PiAoe1xuXHRcdGZyb206IGNoYW5nZS5tYXBQb3MoZnJvbSksXG5cdFx0dG86IGNoYW5nZS5tYXBQb3ModG8pLFxuXHR9KSxcbn0pO1xuXG5jb25zdCByZXNldEhpZ2hsaWdodCA9IFN0YXRlRWZmZWN0LmRlZmluZTx7IGZyb206IG51bWJlcjsgdG86IG51bWJlciB9Pih7XG5cdG1hcDogKHsgZnJvbSwgdG8gfSwgY2hhbmdlKSA9PiAoe1xuXHRcdGZyb206IGNoYW5nZS5tYXBQb3MoZnJvbSksXG5cdFx0dG86IGNoYW5nZS5tYXBQb3ModG8pLFxuXHR9KSxcbn0pO1xuXG5jb25zdCBoaWdobGlnaHRGaWVsZCA9IFN0YXRlRmllbGQuZGVmaW5lPERlY29yYXRpb25TZXQ+KHtcblx0Y3JlYXRlKCkge1xuXHRcdHJldHVybiBEZWNvcmF0aW9uLm5vbmU7XG5cdH0sXG5cdHVwZGF0ZShoaWdsaWdodHMsIHRyKSB7XG5cdFx0aGlnbGlnaHRzID0gaGlnbGlnaHRzLm1hcCh0ci5jaGFuZ2VzKTtcblx0XHRmb3IgKGxldCBlIG9mIHRyLmVmZmVjdHMpXG5cdFx0XHRpZiAoZS5pcyhhZGRIaWdobGlnaHQpKSB7XG5cdFx0XHRcdGhpZ2xpZ2h0cyA9IGhpZ2xpZ2h0cy51cGRhdGUoe1xuXHRcdFx0XHRcdGFkZDogW2hpZ2hsaWdodE1hcmsucmFuZ2UoZS52YWx1ZS5mcm9tLCBlLnZhbHVlLnRvKV0sXG5cdFx0XHRcdH0pO1xuXHRcdFx0fSBlbHNlIGlmIChlLmlzKHJlc2V0SGlnaGxpZ2h0KSkge1xuXHRcdFx0XHRoaWdsaWdodHMgPSBoaWdsaWdodHMudXBkYXRlKHsgZmlsdGVyOiAoZnJvbSwgdG8pID0+IGZhbHNlIH0pO1xuXHRcdFx0fVxuXHRcdHJldHVybiBoaWdsaWdodHM7XG5cdH0sXG5cdHByb3ZpZGU6IChmKSA9PiBFZGl0b3JWaWV3LmRlY29yYXRpb25zLmZyb20oZiksXG59KTtcblxuY29uc3QgaGlnaGxpZ2h0TWFyayA9IERlY29yYXRpb24ubWFyayh7IGNsYXNzOiBcImhpZ2hsaWdodFwiIH0pO1xuY29uc3QgaGlnaGxpZ2h0VGhlbWUgPSBFZGl0b3JWaWV3LmJhc2VUaGVtZSh7XG5cdFwiLmhpZ2hsaWdodFwiOiB7XG5cdFx0XCJiYWNrZ3JvdW5kLWNvbG9yXCI6IFwid2hpdGVcIixcblx0XHRjb2xvcjogXCJibGFja1wiLFxuXHR9LFxufSk7XG5jb25zdCBkZWZhdWx0SGlnaGxpZ2h0VGhlbWUgPSBFZGl0b3JWaWV3LmJhc2VUaGVtZSh7XG5cdFwiLmRlZmF1bHQtaGlnaGxpZ2h0XCI6IHtcblx0XHRcImJhY2tncm91bmQtY29sb3JcIjogU1ZHX0hPVkVSX0NPTE9SLFxuXHRcdGNvbG9yOiBcImJsYWNrXCIsXG5cdH0sXG59KTtcblxuZXhwb3J0IGZ1bmN0aW9uIGhpZ2hsaWdodFNlbGVjdGlvbih2aWV3OiBFZGl0b3JWaWV3LCBmcm9tOiBudW1iZXIsIHRvOiBudW1iZXIpIHtcblx0bGV0IGVmZmVjdHM6IFN0YXRlRWZmZWN0PHVua25vd24+W10gPSBbYWRkSGlnaGxpZ2h0Lm9mKHsgZnJvbSwgdG8gfSldO1xuXG5cdGlmICghZWZmZWN0cy5sZW5ndGgpIHJldHVybiBmYWxzZTtcblxuXHRpZiAoIXZpZXcuc3RhdGUuZmllbGQoaGlnaGxpZ2h0RmllbGQsIGZhbHNlKSlcblx0XHRlZmZlY3RzLnB1c2goU3RhdGVFZmZlY3QuYXBwZW5kQ29uZmlnLm9mKFtoaWdobGlnaHRGaWVsZCwgaGlnaGxpZ2h0VGhlbWVdKSk7XG5cblx0dmlldy5kaXNwYXRjaCh7IGVmZmVjdHMgfSk7XG5cdHJldHVybiB0cnVlO1xufVxuXG4vLyBoYXZlIGEgZnVuY3Rpb24gdGhhdCBhZGRzIHN1YnRsZSBoaWdobGlnaHRzIHRvIHN0YXRlXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVmYXVsdEhpZ2hsaWdodFNlbGVjdGlvbihcblx0dmlldzogRWRpdG9yVmlldyxcblx0ZnJvbTogbnVtYmVyLFxuXHR0bzogbnVtYmVyXG4pIHtcblx0bGV0IGVmZmVjdHM6IFN0YXRlRWZmZWN0PHVua25vd24+W10gPSBbYWRkSGlnaGxpZ2h0Lm9mKHsgZnJvbSwgdG8gfSldO1xuXG5cdGlmICghZWZmZWN0cy5sZW5ndGgpIHJldHVybiBmYWxzZTtcblxuXHRpZiAoIXZpZXcuc3RhdGUuZmllbGQoaGlnaGxpZ2h0RmllbGQsIGZhbHNlKSlcblx0XHRlZmZlY3RzLnB1c2goXG5cdFx0XHRTdGF0ZUVmZmVjdC5hcHBlbmRDb25maWcub2YoW2hpZ2hsaWdodEZpZWxkLCBkZWZhdWx0SGlnaGxpZ2h0VGhlbWVdKVxuXHRcdCk7XG5cblx0dmlldy5kaXNwYXRjaCh7IGVmZmVjdHMgfSk7XG5cblx0cmV0dXJuIHRydWU7XG59XG5cbi8vIHVwZGF0ZSByZW1vdmUgaGlnaGxpZ2h0cyBzbyB0aGF0XG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlSGlnaGxpZ2h0cyh2aWV3OiBFZGl0b3JWaWV3KSB7XG5cdGlmICghdmlldykgcmV0dXJuO1xuXG5cdGxldCBlZmZlY3RzOiBTdGF0ZUVmZmVjdDx1bmtub3duPltdID0gdmlldy5zdGF0ZS5zZWxlY3Rpb24ucmFuZ2VzLm1hcChcblx0XHQoeyBmcm9tLCB0byB9KSA9PiByZXNldEhpZ2hsaWdodC5vZih7IGZyb20sIHRvIH0pXG5cdCk7XG5cdGlmIChlZmZlY3RzLmxlbmd0aCkge1xuXHRcdHZpZXcuZGlzcGF0Y2goeyBlZmZlY3RzIH0pO1xuXHRcdHJldHVybiB0cnVlO1xuXHR9XG5cdHJldHVybiBmYWxzZTtcbn1cblxuLy8gSSB3YW50IHRvIGFkZCBhIGJ1bmNoIG9mIGhpZ2hsaWdodHMgdG8gdGhlIHN0YXRlIHRoYXQgdXNlIHNvbWUgbGlnaHRlciBoaWdobGlnaHQgdGhlbWVcbi8vIEFuZCB0aGVuIHJlbW92ZSB0aGVtIGFuZCB1cGRhdGUgdGhlIGhpZ2hsaWdodHMgb24gZWFjaCBnZW5lcmF0aW9uIG9mIGJhY2tsaW5rTWFya1Bvc2l0aW9uc1xuIiwgImltcG9ydCB7IFBsdWdpbiwgTWFya2Rvd25WaWV3LCBFZGl0b3IgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7XG5cdHByb2Nlc3NVUkksXG5cdHBhcnNlRWRpdG9yUG9zaXRpb24sXG5cdGVuY29kZVVSSUNvbXBvbmVudFN0cmluZyxcblx0Z2V0UHJlZml4QW5kU3VmZml4LFxufSBmcm9tIFwiLi91dGlsc1wiO1xuXG4vLyBbXHUyMTk3XSh1cm46QWxzby06IGhvcGVmdWxseSBmaXggdGhlIG11bHRpLWxpbmUgcmVmZXJlbmNlOi0lMEEtIFVSTnM6MTEtMjMgVG9kby5tZClcbi8vIFtcdTIxOTddKHVybjpQUkVGSVgtOlRFWFQ6LVNVRkZJWDpGSUxFOlNUQVJUSU5ERVg6RU5ESU5ERVgpXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlQ2xpcGJvYXJkKFxuXHR0b2dnbGU6IGJvb2xlYW4gPSBmYWxzZSxcblx0b25seTogYm9vbGVhbiA9IGZhbHNlXG4pIHtcblx0Y29uc3QgdmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG5cdC8vIE1ha2Ugc3VyZSB0aGUgdXNlciBpcyBlZGl0aW5nIGEgTWFya2Rvd24gZmlsZS5cblx0aWYgKHZpZXcpIHtcblx0XHRsZXQgc2VsZWN0aW9uID0gdmlldy5lZGl0b3IuZ2V0U2VsZWN0aW9uKCk7XG5cdFx0aWYgKHZpZXcuZmlsZSkge1xuXHRcdFx0Y29uc3QgdGV4dCA9IHZpZXcuZGF0YTtcblx0XHRcdGNvbnN0IGZyb20gPSB2aWV3LmVkaXRvci5wb3NUb09mZnNldCh2aWV3LmVkaXRvci5nZXRDdXJzb3IoXCJmcm9tXCIpKTtcblx0XHRcdGNvbnN0IHRvID0gdmlldy5lZGl0b3IucG9zVG9PZmZzZXQodmlldy5lZGl0b3IuZ2V0Q3Vyc29yKFwidG9cIikpO1xuXHRcdFx0Y29uc3QgeyBwcmVmaXgsIHN1ZmZpeCB9ID0gZ2V0UHJlZml4QW5kU3VmZml4KHRleHQsIGZyb20sIHRvKTtcblx0XHRcdGxldCByZWZlcmVuY2UgPSBgW1x1MjE5N10odXJuOiR7ZW5jb2RlVVJJQ29tcG9uZW50U3RyaW5nKFxuXHRcdFx0XHRwcmVmaXhcblx0XHRcdCl9LToke2VuY29kZVVSSUNvbXBvbmVudFN0cmluZyhzZWxlY3Rpb24pfTotJHtlbmNvZGVVUklDb21wb25lbnRTdHJpbmcoXG5cdFx0XHRcdHN1ZmZpeFxuXHRcdFx0KX06JHtlbmNvZGVVUklDb21wb25lbnRTdHJpbmcodmlldy5maWxlLnBhdGgpfToke2Zyb219OiR7dG99OiR7XG5cdFx0XHRcdC8vIG9ubHkgPyBcInBvcnRhbFwiIDogXCJuby1wb3J0YWxcIlxuXHRcdFx0XHRcInBvcnRhbFwiXG5cdFx0XHR9OiR7dG9nZ2xlID8gXCJ0XCIgOiBcImZcIn0pYDtcblxuXHRcdFx0Ly8gV3JpdGUgdGhlIHNlbGVjdGVkIHRleHQgdG8gdGhlIGNsaXBib2FyZFxuXHRcdFx0YXdhaXQgbmF2aWdhdG9yLmNsaXBib2FyZC53cml0ZVRleHQocmVmZXJlbmNlKTtcblx0XHR9XG5cdH1cbn1cbiJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxJQUFBQSxtQkFBNkM7OztBQ0E3QyxtQkFLTztBQUtBLElBQUksT0FBTyx3QkFBVyxPQUFtQjtBQUFBLEVBQy9DLFNBQVM7QUFDUixXQUFPO0FBQUEsRUFDUjtBQUFBLEVBQ0EsT0FBTyxPQUFPLElBQVM7QUFDdEIsUUFDQyxHQUFHLGFBQWEsRUFBRSxVQUFV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QUFLLElBQUksSUFBSSxDQUFDO0FBQUEsSUFDcEk7QUFFQSxNQUFFLENBQUMsSUFBSTtBQUFBLEVBQ1Q7QUFFQSxJQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsS0FBSyxNQUFNLFNBQVMsS0FBSyxJQUFJLEtBQUssSUFBSSxHQUFHLEVBQUU7QUFDdEQsSUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLElBQUksS0FBSyxNQUFNLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDO0FBQ3RDLElBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRSxLQUFLLE1BQU0sU0FBUyxLQUFLLElBQUk7QUFFeEMsV0FBUyxJQUFJLEdBQUcsSUFBSSxHQUFHLEVBQUUsR0FBRztBQUMxQixVQUFNLElBQUksSUFBSSxZQUFZLEVBQUU7QUFFNUIsYUFBUyxJQUFJLEdBQUcsSUFBSSxJQUFJLEVBQUUsR0FBRztBQUMzQixRQUFFLENBQUMsSUFBSSxFQUFFLENBQUMsRUFBRSxDQUFDO0FBQUEsSUFDZjtBQUVBLGFBQVMsSUFBSSxJQUFJLElBQUksSUFBSSxFQUFFLEdBQUc7QUFDNUIsUUFBRSxDQUFDLElBQUksS0FBSyxFQUFFLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxHQUFHLENBQUM7QUFBQSxJQUM1RDtBQUVBLFFBQUksSUFBSSxFQUFFLENBQUM7QUFDWCxRQUFJLElBQUksRUFBRSxDQUFDO0FBQ1gsUUFBSSxJQUFJLEVBQUUsQ0FBQztBQUNYLFFBQUksSUFBSSxFQUFFLENBQUM7QUFDWCxRQUFJLElBQUksRUFBRSxDQUFDO0FBRVgsYUFBUyxJQUFJLEdBQUcsSUFBSSxJQUFJLEVBQUUsR0FBRztBQUMzQixZQUFNLElBQUksS0FBSyxNQUFNLElBQUksRUFBRTtBQUMzQixZQUFNLElBQUksS0FBSyxHQUFHLENBQUMsSUFBSSxFQUFFLEdBQUcsR0FBRyxHQUFHLENBQUMsSUFBSSxJQUFJLEVBQUUsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxNQUFNO0FBQzNE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VUFBVSxTQUFTLFdBQVc7QUFBQSxRQUNyQyxFQUFFLENBQUM7QUFFSCxjQUFNLFFBQVEsTUFBTTtBQUFBLFVBQ25CLFlBQVksaUJBQWlCLGlCQUFpQjtBQUFBLFFBQy9DO0FBRUEsWUFDQyxNQUFNO0FBQUEsVUFBTSxDQUFDLFNBQ1osS0FBSyxVQUFVLFNBQVMsdUJBQXVCO0FBQUEsUUFDaEQsS0FDQyxDQUFDLE1BQU07QUFBQSxVQUFNLENBQUMsU0FDZCxLQUFLLFVBQVUsU0FBUyx1QkFBdUI7QUFBQSxRQUNoRCxLQUNDLE1BQU0sT0FBTyxDQUFDLEtBQUssU0FBUztBQUMzQixjQUFJO0FBQUssbUJBQU87QUFDaEIsaUJBQU8sS0FBSyxVQUFVLFNBQVMsdUJBQXVCO0FBQUEsUUFDdkQsR0FBRyxLQUFLLEdBQ1I7QUFDRCxnQkFBTSxRQUFRLENBQUMsU0FBUztBQUN2QixpQkFBSyxVQUFVLE9BQU8seUJBQXlCLEtBQUs7QUFBQSxVQU1yRCxDQUFDO0FBQ0QsY0FBSSx3QkFBTyx1QkFBdUI7QUFBQSxRQUNuQyxPQUFPO0FBQ04sZ0JBQU0sUUFBUSxDQUFDLFNBQTBCO0FBQ3hDLGtCQUFNLFFBQVEsQ0FBQ0MsVUFBUztBQUN2QixjQUFBQSxNQUFLLFVBQVUsT0FBTyx5QkFBeUIsSUFBSTtBQUFBLFlBQ3BELENBQUM7QUFBQSxVQUNGLENBQUM7QUFDRCxjQUFJLHdCQUFPLHdCQUF3QjtBQUFBLFFBQ3BDO0FBQUEsTUFDRDtBQUFBLElBQ0QsQ0FBQztBQUFBLEVBa0RGO0FBQUEsRUFFQSxXQUFXO0FBQUEsRUFBQztBQUNiOyIsCiAgIm5hbWVzIjogWyJpbXBvcnRfb2JzaWRpYW4iLCAidGhhdCIsICJpbXBvcnRfdmlldyIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfdmlldyIsICJpbXBvcnRfc3RhdGUiLCAiZiIsICJpbXBvcnRfdmlldyIsICJkYXRhU3RyaW5nIiwgImN1cnNvclZpZXdwb3J0IiwgImxlYWZJZCIsICJvcmlnaW5hbExlYWZJZCIsICJlZGl0b3JWaWV3IiwgIl9hIiwgIm9yaWdpbmFsTGVhZiIsICJkb2N1bWVudCIsICJzdmciLCAiYmFja2xpbmtzIiwgImJhY2tsaW5rcyIsICJ0ZXh0IiwgImluZGV4IiwgInBhcnRzIiwgImxpbmVSZWZlcmVuY2VzIiwgImxpbmVSZWZlcmVuY2VzRGF0YSIsICJmcm9tIiwgInRvIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfdmlldyIsICJzcGFuIl0KfQo=
