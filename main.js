/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => ReferencePlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian6 = require("obsidian");

// src/state.ts
var import_state6 = require("@codemirror/state");

// src/references.ts
var import_obsidian4 = require("obsidian");

// node_modules/uuid/dist/esm-browser/regex.js
var regex_default = /^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;

// node_modules/uuid/dist/esm-browser/validate.js
function validate(uuid) {
  return typeof uuid === "string" && regex_default.test(uuid);
}
var validate_default = validate;

// node_modules/uuid/dist/esm-browser/stringify.js
var byteToHex = [];
for (let i = 0; i < 256; ++i) {
  byteToHex.push((i + 256).toString(16).slice(1));
}
function unsafeStringify(arr, offset = 0) {
  return byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + "-" + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + "-" + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + "-" + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + "-" + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]];
}

// node_modules/uuid/dist/esm-browser/parse.js
function parse(uuid) {
  if (!validate_default(uuid)) {
    throw TypeError("Invalid UUID");
  }
  let v;
  const arr = new Uint8Array(16);
  arr[0] = (v = parseInt(uuid.slice(0, 8), 16)) >>> 24;
  arr[1] = v >>> 16 & 255;
  arr[2] = v >>> 8 & 255;
  arr[3] = v & 255;
  arr[4] = (v = parseInt(uuid.slice(9, 13), 16)) >>> 8;
  arr[5] = v & 255;
  arr[6] = (v = parseInt(uuid.slice(14, 18), 16)) >>> 8;
  arr[7] = v & 255;
  arr[8] = (v = parseInt(uuid.slice(19, 23), 16)) >>> 8;
  arr[9] = v & 255;
  arr[10] = (v = parseInt(uuid.slice(24, 36), 16)) / 1099511627776 & 255;
  arr[11] = v / 4294967296 & 255;
  arr[12] = v >>> 24 & 255;
  arr[13] = v >>> 16 & 255;
  arr[14] = v >>> 8 & 255;
  arr[15] = v & 255;
  return arr;
}
var parse_default = parse;

// node_modules/uuid/dist/esm-browser/v35.js
function stringToBytes(str) {
  str = unescape(encodeURIComponent(str));
  const bytes = [];
  for (let i = 0; i < str.length; ++i) {
    bytes.push(str.charCodeAt(i));
  }
  return bytes;
}
var DNS = "6ba7b810-9dad-11d1-80b4-00c04fd430c8";
var URL = "6ba7b811-9dad-11d1-80b4-00c04fd430c8";
function v35(name, version, hashfunc) {
  function generateUUID(value, namespace, buf, offset) {
    var _namespace;
    if (typeof value === "string") {
      value = stringToBytes(value);
    }
    if (typeof namespace === "string") {
      namespace = parse_default(namespace);
    }
    if (((_namespace = namespace) === null || _namespace === void 0 ? void 0 : _namespace.length) !== 16) {
      throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");
    }
    let bytes = new Uint8Array(16 + value.length);
    bytes.set(namespace);
    bytes.set(value, namespace.length);
    bytes = hashfunc(bytes);
    bytes[6] = bytes[6] & 15 | version;
    bytes[8] = bytes[8] & 63 | 128;
    if (buf) {
      offset = offset || 0;
      for (let i = 0; i < 16; ++i) {
        buf[offset + i] = bytes[i];
      }
      return buf;
    }
    return unsafeStringify(bytes);
  }
  try {
    generateUUID.name = name;
  } catch (err) {
  }
  generateUUID.DNS = DNS;
  generateUUID.URL = URL;
  return generateUUID;
}

// node_modules/uuid/dist/esm-browser/sha1.js
function f(s, x, y, z) {
  switch (s) {
    case 0:
      return x & y ^ ~x & z;
    case 1:
      return x ^ y ^ z;
    case 2:
      return x & y ^ x & z ^ y & z;
    case 3:
      return x ^ y ^ z;
  }
}
function ROTL(x, n) {
  return x << n | x >>> 32 - n;
}
function sha1(bytes) {
  const K = [1518500249, 1859775393, 2400959708, 3395469782];
  const H = [1732584193, 4023233417, 2562383102, 271733878, 3285377520];
  if (typeof bytes === "string") {
    const msg = unescape(encodeURIComponent(bytes));
    bytes = [];
    for (let i = 0; i < msg.length; ++i) {
      bytes.push(msg.charCodeAt(i));
    }
  } else if (!Array.isArray(bytes)) {
    bytes = Array.prototype.slice.call(bytes);
  }
  bytes.push(128);
  const l = bytes.length / 4 + 2;
  const N = Math.ceil(l / 16);
  const M = new Array(N);
  for (let i = 0; i < N; ++i) {
    const arr = new Uint32Array(16);
    for (let j = 0; j < 16; ++j) {
      arr[j] = bytes[i * 64 + j * 4] << 24 | bytes[i * 64 + j * 4 + 1] << 16 | bytes[i * 64 + j * 4 + 2] << 8 | bytes[i * 64 + j * 4 + 3];
    }
    M[i] = arr;
  }
  M[N - 1][14] = (bytes.length - 1) * 8 / Math.pow(2, 32);
  M[N - 1][14] = Math.floor(M[N - 1][14]);
  M[N - 1][15] = (bytes.length - 1) * 8 & 4294967295;
  for (let i = 0; i < N; ++i) {
    const W = new Uint32Array(80);
    for (let t = 0; t < 16; ++t) {
      W[t] = M[i][t];
    }
    for (let t = 16; t < 80; ++t) {
      W[t] = ROTL(W[t - 3] ^ W[t - 8] ^ W[t - 14] ^ W[t - 16], 1);
    }
    let a = H[0];
    let b = H[1];
    let c = H[2];
    let d = H[3];
    let e = H[4];
    for (let t = 0; t < 80; ++t) {
      const s = Math.floor(t / 20);
      const T = ROTL(a, 5) + f(s, b, c, d) + e + K[s] + W[t] >>> 0;
      e = d;
      d = c;
      c = ROTL(b, 30) >>> 0;
      b = a;
      a = T;
    }
    H[0] = H[0] + a >>> 0;
    H[1] = H[1] + b >>> 0;
    H[2] = H[2] + c >>> 0;
    H[3] = H[3] + d >>> 0;
    H[4] = H[4] + e >>> 0;
  }
  return [H[0] >> 24 & 255, H[0] >> 16 & 255, H[0] >> 8 & 255, H[0] & 255, H[1] >> 24 & 255, H[1] >> 16 & 255, H[1] >> 8 & 255, H[1] & 255, H[2] >> 24 & 255, H[2] >> 16 & 255, H[2] >> 8 & 255, H[2] & 255, H[3] >> 24 & 255, H[3] >> 16 & 255, H[3] >> 8 & 255, H[3] & 255, H[4] >> 24 & 255, H[4] >> 16 & 255, H[4] >> 8 & 255, H[4] & 255];
}
var sha1_default = sha1;

// node_modules/uuid/dist/esm-browser/v5.js
var v5 = v35("v5", 80, sha1_default);
var v5_default = v5;

// src/utils.ts
var import_obsidian3 = require("obsidian");

// src/constants.ts
var REFERENCE_REGEX = /\[\u2197\]\(urn:([^)]*)\)/g;
var ACTION_TYPE = {
  MOUSE: "mouse",
  CURSOR: "cursor",
  BACKLINK: "backlink"
};
var SVG_HOVER_COLOR = "rgb(187, 215, 230)";
var REFERENCE_ICON_HEIGHT = 20;
var PORTAL_TEXT_SLICE_SIZE = 100;

// src/workspace.ts
var import_obsidian = require("obsidian");
function collectLeavesByTab(split, result = []) {
  const type = split.type;
  if (!type)
    throw new Error("Split type not found");
  if (type == "tabs" || type == "split") {
    const children = split.children;
    if (!children)
      throw new Error("Split children not found");
    if (children) {
      for (const child of children) {
        let emptyList = [];
        collectLeavesByTab(child, result);
      }
    }
  } else if (type == "leaf") {
    const parentSplitId = split.parent.id;
    if (!parentSplitId)
      throw new Error("Split parent id not found");
    let idx = result.findIndex((tab) => {
      const tabId = tab[0].parent.id;
      return tabId == parentSplitId;
    });
    if (idx == -1) {
      result.push([split]);
    } else {
      result[idx].push(split);
    }
  }
  return result;
}
function collectLeavesByTabHelper() {
  const { workspace } = getThat();
  const currLeaf = workspace.getLeaf();
  const rootSplit = currLeaf.getRoot();
  return collectLeavesByTab(rootSplit);
}
function getCurrentTabIndex(leavesByTab, span) {
  let workspaceTab = span.closest(".workspace-tabs");
  let currTabIdx = leavesByTab.findIndex((tab) => {
    const leafTab = tab[0].view.containerEl.closest(".workspace-tabs");
    return leafTab == workspaceTab;
  });
  return currTabIdx;
}
function getAdjacentTabs(leavesByTab, currTabIdx, file) {
  let rightAdjacentTab = [];
  let leftAdjacentTab = [];
  let adjacentTabs = [];
  if (leavesByTab[currTabIdx + 1]) {
    rightAdjacentTab = leavesByTab[currTabIdx + 1];
    adjacentTabs = [...adjacentTabs, ...rightAdjacentTab];
  }
  if (leavesByTab[currTabIdx - 1]) {
    leftAdjacentTab = leavesByTab[currTabIdx - 1];
    adjacentTabs = [...adjacentTabs, ...leftAdjacentTab];
  }
  let index = adjacentTabs.findIndex(
    (x) => x.getViewState().state.file == file
  );
  return { adjacentTabs, rightAdjacentTab, leftAdjacentTab, index };
}
async function openFileInAdjacentTab(leavesByTab, currTabIdx, file, type) {
  let { adjacentTabs, rightAdjacentTab, leftAdjacentTab } = getAdjacentTabs(
    leavesByTab,
    currTabIdx,
    file
  );
  let allTabNames = leavesByTab.map(
    (tab) => tab.map((x) => x.getViewState().state.file)
  );
  let rightAdjacentTabNames = rightAdjacentTab.map(
    (x) => x.getViewState().state.file
  );
  let leftAdjacentTabNames = leftAdjacentTab.map(
    (x) => x.getViewState().state.file
  );
  const { workspace } = getThat();
  if (allTabNames.filter((v, i) => i != currTabIdx).flat().includes(file) && !rightAdjacentTabNames.includes(file) && !leftAdjacentTabNames.includes(file)) {
    let currentTabNames = [];
    let currentTab = [];
    allTabNames.forEach((tabNames, i) => {
      if (tabNames != rightAdjacentTabNames && tabNames != leftAdjacentTabNames && currTabIdx != i) {
        if (tabNames.includes(file)) {
          currentTabNames = tabNames;
          currentTab = leavesByTab[i];
        }
      }
    });
    const originalLeaf = currentTab.filter(
      (t) => t.containerEl.style.display != "none"
    )[0];
    let leaf = currentTab[currentTabNames.indexOf(file)];
    workspace.revealLeaf(leaf);
    return { newLeaf: leaf, temp: false, originalLeaf };
  } else if (rightAdjacentTabNames.includes(file)) {
    const originalLeaf = rightAdjacentTab.filter(
      (t) => t.containerEl.style.display != "none"
    )[0];
    let leaf = rightAdjacentTab[rightAdjacentTabNames.indexOf(file)];
    workspace.revealLeaf(leaf);
    return { newLeaf: leaf, temp: false, originalLeaf };
  } else if (leftAdjacentTabNames.includes(file)) {
    const originalLeaf = leftAdjacentTab.filter(
      (t) => t.containerEl.style.display != "none"
    )[0];
    let leaf = leftAdjacentTab[leftAdjacentTabNames.indexOf(file)];
    workspace.revealLeaf(leaf);
    return { newLeaf: leaf, temp: false, originalLeaf };
  } else if (rightAdjacentTab.length > 0) {
    const originalLeaf = rightAdjacentTab.filter(
      (t) => t.containerEl.style.display != "none"
    )[0];
    let currLeaf = workspace.getLeaf();
    workspace.setActiveLeaf(originalLeaf);
    let newLeaf = workspace.getLeaf(true);
    await openFileInLeaf(newLeaf, file);
    workspace.revealLeaf(newLeaf);
    workspace.setActiveLeaf(currLeaf);
    return { newLeaf, temp: true, originalLeaf };
  } else if (leftAdjacentTab.length > 0) {
    const originalLeaf = leftAdjacentTab.filter(
      (t) => t.containerEl.style.display != "none"
    )[0];
    let currLeaf = workspace.getLeaf();
    workspace.setActiveLeaf(originalLeaf);
    let newLeaf = workspace.getLeaf(true);
    await openFileInLeaf(newLeaf, file);
    workspace.revealLeaf(newLeaf);
    workspace.setActiveLeaf(currLeaf);
    return { newLeaf, temp: true, originalLeaf };
  } else {
    const currLeaf = workspace.getLeaf();
    let newLeaf = workspace.createLeafBySplit(currLeaf);
    await openFileInLeaf(newLeaf, file);
    return { newLeaf, temp: true };
  }
}
async function openFileInLeaf(leaf, file) {
  let targetFile = getThat().vault.getAbstractFileByPath(file);
  if (targetFile && targetFile instanceof import_obsidian.TFile)
    await leaf.openFile(targetFile, { active: false });
}

// src/effects.ts
var import_obsidian2 = require("obsidian");

// src/mark.ts
var import_view = require("@codemirror/view");
var import_state2 = require("@codemirror/state");
var addHighlight = import_state2.StateEffect.define({
  map: ({ from, to }, change) => ({
    from: change.mapPos(from),
    to: change.mapPos(to)
  })
});
var resetHighlight = import_state2.StateEffect.define({
  map: ({ from, to }, change) => ({
    from: change.mapPos(from),
    to: change.mapPos(to)
  })
});
var highlightField = import_state2.StateField.define({
  create() {
    return import_view.Decoration.none;
  },
  update(higlights, tr) {
    higlights = higlights.map(tr.changes);
    for (let e of tr.effects)
      if (e.is(addHighlight)) {
        higlights = higlights.update({
          add: [highlightMark.range(e.value.from, e.value.to)]
        });
      } else if (e.is(resetHighlight)) {
        higlights = higlights.update({ filter: (from, to) => false });
      }
    return higlights;
  },
  provide: (f2) => import_view.EditorView.decorations.from(f2)
});
var highlightMark = import_view.Decoration.mark({ class: "highlight" });
var highlightTheme = import_view.EditorView.baseTheme({
  ".highlight": {
    "background-color": "white",
    color: "black"
  }
});
var defaultHighlightTheme = import_view.EditorView.baseTheme({
  ".default-highlight": {
    "background-color": SVG_HOVER_COLOR,
    color: "black"
  }
});
function highlightSelection(view, from, to) {
  console.log("highlightSelection");
  let effects = [addHighlight.of({ from, to })];
  if (!effects.length)
    return false;
  if (!view.state.field(highlightField, false))
    effects.push(import_state2.StateEffect.appendConfig.of([highlightField, highlightTheme]));
  view.dispatch({ effects });
  return true;
}
function removeHighlights(view) {
  if (!view)
    return;
  let effects = view.state.selection.ranges.map(
    ({ from, to }) => resetHighlight.of({ from, to })
  );
  if (effects.length) {
    view.dispatch({ effects });
    return true;
  }
  return false;
}

// src/effects.ts
var import_view2 = require("@codemirror/view");
function getEditorView(leaf) {
  var _a;
  if (!leaf)
    return null;
  const view = leaf.view;
  const editor = (_a = view.sourceMode) == null ? void 0 : _a.cmEditor;
  if (!editor.CodeMirror && editor.cm instanceof import_view2.EditorView) {
    const editorView = editor.cm;
    return editorView;
  }
  return null;
}
function checkSpanElementExists(span, containerEl) {
  const spanElements = containerEl.getElementsByTagName("span");
  for (let i = 0; i < spanElements.length; i++) {
    if (spanElements[i] === span) {
      return true;
    }
  }
  return false;
}
function parseCSSString(css) {
  const cssPropertiesRegex = /([\w-]+)\s*:\s*([^;]+)\s*;?/g;
  let cssPropertiesObject = {};
  let match;
  while ((match = cssPropertiesRegex.exec(css)) !== null) {
    cssPropertiesObject[match[1]] = match[2];
  }
  return cssPropertiesObject;
}
function delay(milliseconds) {
  return new Promise((resolve) => {
    setTimeout(resolve, milliseconds);
  });
}
function tempDirectionIndicator(leaf, text, prefix, suffix, dataString, user, isSame) {
  let positions = findTextPositions(
    leaf.view.data,
    text,
    prefix.slice(0, prefix.length - 1),
    suffix.slice(1, suffix.length)
  );
  if (!positions)
    throw new Error("Positions not found");
  let rangeStart = positions.rangeStart;
  let rangeEnd = positions.rangeEnd;
  if (user === ACTION_TYPE.BACKLINK) {
    let startTop = leaf.view.editor.getScrollInfo().top;
    leaf.view.editor.scrollIntoView(
      {
        from: Object.assign(rangeStart, { ch: 0 }),
        to: Object.assign(rangeEnd, { ch: 0 })
      },
      true
    );
    setTimeout(() => {
      let endTop = leaf.view.editor.getScrollInfo().top;
      if (startTop === endTop && isSame) {
        leaf.containerEl.querySelector(".view-content").style.boxShadow = "none";
      } else if (startTop === endTop || !isSame) {
        leaf.containerEl.querySelector(".view-content").style.boxShadow = "inset 0px 0px 10px 10px rgba(248, 255, 255)";
      } else if (startTop < endTop) {
        leaf.containerEl.querySelector(".view-content").style.boxShadow = "inset 0px 20px 20px 0px rgba(248, 255, 255)";
      } else {
        leaf.containerEl.querySelector(".view-content").style.boxShadow = "inset 0px -30px 20px 0px rgba(248, 255, 255)";
      }
    }, 10);
    return;
  }
  const editor = getMarkdownView(leaf).editor;
  const backlinkContainer = getBacklinkContainer(editor);
  const windowHeight = leaf.view.containerEl.querySelector(".cm-scroller").getBoundingClientRect().height;
  const scrollTop = leaf.view.containerEl.querySelector(".cm-scroller").scrollTop;
  const scrollBottom = scrollTop + windowHeight;
  let visibleElements = [];
  for (let i = 0; i < backlinkContainer.children.length; i++) {
    let style = backlinkContainer.children[i].getAttribute("style");
    if (style == null)
      continue;
    let cssProperties = parseCSSString(style);
    let top = parseFloat(cssProperties["top"].replace("px", ""));
    if (top == null)
      continue;
    if (scrollTop <= top && top <= scrollBottom && backlinkContainer.children[i]) {
      let reference = backlinkContainer.children[i].getAttribute("reference");
      if (reference) {
        visibleElements.push(JSON.parse(reference).dataString);
      }
    }
  }
  if (!visibleElements.includes(dataString)) {
    let startTop = leaf.view.editor.getScrollInfo().top;
    leaf.view.editor.scrollIntoView(
      {
        from: rangeStart,
        to: rangeEnd
      },
      true
    );
    setTimeout(() => {
      let endTop = leaf.view.editor.getScrollInfo().top;
      if (startTop < endTop) {
        leaf.containerEl.querySelector(".view-content").style.boxShadow = "inset 0px 20px 20px 0px rgba(248, 255, 255)";
      } else {
        leaf.containerEl.querySelector(".view-content").style.boxShadow = "inset 0px -30px 20px 0px rgba(248, 255, 255)";
      }
    }, 10);
  }
}
async function startBacklinkEffect(span) {
  let source = getBacklinkHover();
  let destination = getCursor();
  let updateState = updateBacklinkHover;
  if (source != null)
    return;
  updateState({
    type: `${ACTION_TYPE.BACKLINK}-start`
  });
  const referenceData = span.getAttribute("reference");
  if (!referenceData)
    throw new Error("Reference data not found");
  const backlink = JSON.parse(referenceData);
  const dataString = backlink.dataString;
  if (destination != null && destination.dataString == dataString) {
    updateState(destination);
    return;
  }
  let [prefix, text, suffix, file, from, to] = processURI(dataString);
  let leavesByTab = collectLeavesByTabHelper();
  let currTabIdx = getCurrentTabIndex(leavesByTab, span);
  let backlinkLeaf = leavesByTab[currTabIdx].filter((leaf) => {
    let containerEl = getContainerElement(leaf);
    const exists = checkSpanElementExists(span, containerEl);
    return exists;
  })[0];
  let backlinkLeafID = backlinkLeaf.id;
  if (!backlinkLeafID)
    throw new Error("Leaf id not found");
  if (backlinkLeaf && backlinkLeaf.view instanceof import_obsidian2.MarkdownView) {
    const editorView = getEditorView(backlinkLeaf);
    if (!editorView)
      throw new Error("Editor view not found");
    const viewport = backlinkLeaf.view.editor.getScrollInfo();
    highlightSelection(editorView, from, to);
    updateState({
      dataString,
      originalTop: editorView.documentTop,
      backlinkLeafId: backlinkLeafID
    });
  }
  let referencingFile = backlink.referencingLocation.filename;
  const { newLeaf, temp, originalLeaf } = await openFileInAdjacentTab(
    leavesByTab,
    currTabIdx,
    referencingFile
  );
  let id = newLeaf.id;
  if (!id)
    throw new Error("Leaf id not found");
  updateState({
    leafId: id,
    temp,
    peek: true
  });
  const originalLeafId = originalLeaf.id;
  const matches = [
    ...backlink.referencingLocation.text.matchAll(REFERENCE_REGEX)
  ];
  if (matches.length == 0)
    throw new Error("Matches not found");
  tempDirectionIndicator(
    newLeaf,
    backlink.referencingLocation.text,
    backlink.referencingLocation.prefix + "-",
    "-" + backlink.referencingLocation.suffix,
    matches[0][1],
    ACTION_TYPE.BACKLINK,
    id === originalLeafId
  );
  const cursorViewport = newLeaf.view.editor.getScrollInfo();
  updateState({
    cursorViewport
  });
  let backlinkSpan = newLeaf.containerEl.querySelector(
    `span[data="${backlink.dataString}"]`
  );
  if (backlinkSpan) {
    const svgElement = backlinkSpan.querySelector("svg");
    if (svgElement) {
      svgElement.style.borderRadius = "5px";
      svgElement.style.boxShadow = `0px 0px 10px 10px ${SVG_HOVER_COLOR}`;
      updateHoveredCursor(svgElement, ACTION_TYPE.BACKLINK);
    }
  }
  if (id === originalLeafId) {
    newLeaf.containerEl.querySelector(".view-content").style.boxShadow = "none";
  }
  if (originalLeafId) {
    updateState({
      originalLeafId
    });
  }
  return;
}
async function startReferenceEffect(span, type) {
  let source = type == ACTION_TYPE.MOUSE ? getHover() : getCursor();
  let destination = type == ACTION_TYPE.MOUSE ? getCursor() : getHover();
  let updateState = type == ACTION_TYPE.MOUSE ? updateHover : updateCursor;
  if (source != null)
    return;
  updateState({
    type: `${type}-start`
  });
  const dataString = span.getAttribute("data");
  if (!dataString)
    return;
  if (destination != null && destination.dataString == dataString) {
    updateHover(destination);
    return;
  }
  let [prefix, text, suffix, file, from, to] = processURI(dataString);
  let leavesByTab = collectLeavesByTabHelper();
  let currTabIdx = getCurrentTabIndex(leavesByTab, span);
  let currLeaf = getThat().workspace.getLeaf();
  let currLeafID = currLeaf.id;
  if (!currLeafID)
    throw new Error("currLeafID id not found");
  const { newLeaf, temp, originalLeaf } = await openFileInAdjacentTab(
    leavesByTab,
    currTabIdx,
    file,
    type
  );
  await delay(50);
  let id = newLeaf.id;
  if (!id)
    throw new Error("Leaf id not found");
  updateState({
    leafId: id,
    temp,
    peek: true
  });
  if (newLeaf && newLeaf.view instanceof import_obsidian2.MarkdownView) {
    const editorView = getEditorView(newLeaf);
    if (!editorView)
      throw new Error("Editor view not found");
    const viewport = newLeaf.view.editor.getScrollInfo();
    highlightSelection(editorView, from, to);
    tempDirectionIndicator(newLeaf, text, prefix, suffix, dataString);
    const cursorViewport = newLeaf.view.editor.getScrollInfo();
    updateState({
      dataString,
      originalTop: editorView.documentTop,
      // originalLeafId: currLeafID,
      cursorViewport
    });
  }
  const originalLeafId = originalLeaf.id;
  if (id != originalLeafId && (newLeaf.containerEl.querySelector(".view-content").style.boxShadow == "none" || newLeaf.containerEl.querySelector(".view-content").style.boxShadow == "")) {
    newLeaf.containerEl.querySelector(".view-content").style.boxShadow = "inset 0px 0px 10px 10px rgba(248, 255, 255)";
  }
  if (originalLeafId) {
    updateState({
      originalLeafId
    });
  }
}
async function endReferenceCursorEffect() {
  var _a, _b;
  if (!getCursor() || Object.keys(getCursor()).length == 0) {
    resetCursor();
    return;
  }
  const { dataString, leafId, originalLeafId, temp, cursorViewport, peek } = getCursor();
  if (getHover() != null && getHover().dataString == dataString) {
    resetCursor();
    return;
  }
  const { workspace } = getThat();
  let targetLeaf = workspace.getLeafById(leafId);
  if (!targetLeaf) {
    resetHover();
    throw new Error("Target leaf not found");
  }
  const activeLeaf = getThat().workspace.getLeaf();
  const activeLeafId = activeLeaf.id;
  let editorView = getEditorView(targetLeaf);
  removeHighlights(editorView);
  if (activeLeafId === leafId) {
    resetCursor();
    let containerEl = getContainerElement(targetLeaf);
    if (containerEl != null) {
      (_a = containerEl.querySelector(".view-content")) == null ? void 0 : _a.setAttribute("style", "");
    }
    return;
  }
  if (cursorViewport && targetLeaf && targetLeaf.view instanceof import_obsidian2.MarkdownView) {
    const view = targetLeaf.view;
    view.editor.scrollTo(0, cursorViewport.top);
    if (getHover() != null) {
      const { dataString: dataString2, cursorViewport: cursorViewport2, leafId: leafId2, originalLeafId: originalLeafId2 } = getHover();
      let [prefix, text, suffix, file, from, to] = processURI(dataString2);
      const cursorLeaf = workspace.getLeafById(leafId2);
      workspace.revealLeaf(cursorLeaf);
      const editorView2 = getEditorView(cursorLeaf);
      highlightSelection(editorView2, from, to);
    } else {
      let containerEl = getContainerElement(targetLeaf);
      if (containerEl != null) {
        (_b = containerEl.querySelector(".view-content")) == null ? void 0 : _b.setAttribute("style", "");
      }
    }
  }
  if (temp && targetLeaf) {
    targetLeaf.detach();
  }
  if (peek) {
    let originalLeaf = workspace.getLeafById(originalLeafId);
    if (!originalLeaf)
      throw new Error("Original leaf not found");
    workspace.revealLeaf(originalLeaf);
  }
  resetCursor();
}
async function endReferenceHoverEffect() {
  var _a;
  if (!getHover() || Object.keys(getHover()).length == 0) {
    resetHover();
    return;
  }
  const { dataString, leafId, originalLeafId, temp, cursorViewport, peek } = getHover();
  if (getCursor() != null && getCursor().dataString == dataString) {
    resetHover();
    return;
  }
  const { workspace } = getThat();
  let targetLeaf = workspace.getLeafById(leafId);
  if (!targetLeaf) {
    resetHover();
    throw new Error("Target leaf not found");
  }
  let editorView = getEditorView(targetLeaf);
  removeHighlights(editorView);
  if (cursorViewport && targetLeaf && targetLeaf.view instanceof import_obsidian2.MarkdownView) {
    const view = targetLeaf.view;
    view.editor.scrollTo(0, cursorViewport.top);
    if (getCursor() != null) {
      const { dataString: dataString2, cursorViewport: cursorViewport2, leafId: leafId2, originalLeafId: originalLeafId2 } = getCursor();
      let [prefix, text, suffix, file, from, to] = processURI(dataString2);
      const cursorLeaf = workspace.getLeafById(leafId2);
      workspace.revealLeaf(cursorLeaf);
      const editorView2 = getEditorView(cursorLeaf);
      if (!editorView2)
        throw new Error("Editor view not found");
      highlightSelection(editorView2, from, to);
    } else {
      let containerEl = getContainerElement(targetLeaf);
      if (containerEl != null) {
        (_a = containerEl.querySelector(".view-content")) == null ? void 0 : _a.setAttribute("style", "");
      }
    }
  }
  if (temp && targetLeaf) {
    targetLeaf.detach();
    let originalLeaf = workspace.getLeafById(originalLeafId);
    if (!originalLeaf)
      throw new Error("Original leaf not found");
    workspace.revealLeaf(originalLeaf);
  }
  if (peek) {
    let originalLeaf = workspace.getLeafById(originalLeafId);
    if (!originalLeaf) {
      resetHover();
      throw new Error("Original leaf not found");
    }
    workspace.revealLeaf(originalLeaf);
  }
  resetHover();
}
async function endBacklinkHoverEffect() {
  var _a;
  if (!getBacklinkHover() || Object.keys(getBacklinkHover()).length == 0) {
    resetBacklinkHover();
    return;
  }
  const {
    dataString,
    leafId,
    originalLeafId,
    backlinkLeafId,
    temp,
    cursorViewport,
    originalTab,
    peek
  } = getBacklinkHover();
  if (getCursor() != null && getCursor().dataString == dataString) {
    resetBacklinkHover();
    return;
  }
  const { workspace } = getThat();
  let targetLeaf = workspace.getLeafById(leafId);
  if (!targetLeaf) {
    resetBacklinkHover();
    throw new Error("Target leaf not found");
  }
  if (cursorViewport && targetLeaf && targetLeaf.view instanceof import_obsidian2.MarkdownView) {
    const view = targetLeaf.view;
    view.editor.scrollTo(0, cursorViewport.top);
  }
  let containerEl = getContainerElement(targetLeaf);
  if (containerEl != null) {
    (_a = containerEl.querySelector(".view-content")) == null ? void 0 : _a.setAttribute("style", "");
  }
  let editorView = getEditorView(targetLeaf);
  removeHighlights(editorView);
  const originalLeaf = workspace.getLeafById(backlinkLeafId);
  if (!originalLeaf) {
    resetBacklinkHover();
    throw new Error("Original leaf not found");
  }
  let originalEditorView = getEditorView(originalLeaf);
  removeHighlights(originalEditorView);
  if (getCursor() != null) {
    const { dataString: dataString2, cursorViewport: cursorViewport2, leafId: leafId2, originalLeafId: originalLeafId2 } = getCursor();
    let [prefix, text, suffix, file, from, to] = processURI(dataString2);
    const cursorLeaf = workspace.getLeafById(leafId2);
    workspace.revealLeaf(cursorLeaf);
    const editorView2 = getEditorView(cursorLeaf);
    highlightSelection(editorView2, from, to);
  }
  if (temp && targetLeaf) {
    targetLeaf.detach();
  }
  if (peek) {
    let originalLeaf2 = workspace.getLeafById(originalLeafId);
    if (!originalLeaf2) {
      resetBacklinkHover();
      throw new Error("Original leaf not found");
    }
    workspace.revealLeaf(originalLeaf2);
  }
  resetBacklinkHover();
}

// src/utils.ts
function encodeURIComponentString(str) {
  return encodeURIComponent(str).replace(/[:()]/g, function(c) {
    return "%" + c.charCodeAt(0).toString(16);
  });
}
function decodeURIComponentString2(str) {
  return decodeURIComponent(
    str.replace(/%3A/g, ":").replace(/%28/g, "(").replace(/%29/g, ")")
  );
}
function processURI(dataString) {
  let [prefix, text, suffix, file, from, to, portal] = dataString.split(":");
  prefix = decodeURIComponentString2(prefix);
  text = decodeURIComponentString2(text);
  suffix = decodeURIComponentString2(suffix);
  file = decodeURIComponentString2(file);
  from = decodeURIComponentString2(from);
  to = decodeURIComponentString2(to);
  if (portal)
    portal = decodeURIComponentString2(portal);
  return [prefix, text, suffix, file, parseInt(from), parseInt(to), portal];
}
function getPrefixAndSuffix(document2, from, to) {
  let prefix = document2.slice(from - 25, from).split("\n").slice(-1)[0];
  let suffix = document2.slice(to, to + 25).split("\n")[0];
  return { prefix, suffix };
}
function findTextPositions(text, searchTerm, prefix = "", suffix = "") {
  let rollingIndex = 0;
  const lines = text.split("\n").map((line, i) => {
    let data = { line, index: rollingIndex, length: line.length + 1, i };
    rollingIndex += data.length;
    return data;
  });
  if (text.includes(prefix + searchTerm + suffix)) {
    let matchIndex = text.indexOf(prefix + searchTerm + suffix);
    let startIndex = lines.findIndex((line) => line.index > matchIndex + prefix.length) - 1;
    let endIndex = lines.findIndex(
      (line) => line.index > matchIndex + prefix.length + searchTerm.length
    ) - 1;
    if (startIndex == -2)
      startIndex = lines.length - 1;
    if (endIndex == -2)
      endIndex = lines.length - 1;
    return {
      rangeStart: {
        line: startIndex,
        ch: matchIndex + prefix.length - lines[startIndex].index
      },
      rangeEnd: {
        line: endIndex,
        ch: matchIndex + prefix.length + searchTerm.length - lines[endIndex].index
      },
      lines
    };
  }
  return null;
}
function checkCursorPositionAtDatastring(evt) {
  const activeView = this.app.workspace.getActiveViewOfType(import_obsidian3.MarkdownView);
  const cursorFrom = activeView == null ? void 0 : activeView.editor.getCursor("from");
  const cursorTo = activeView == null ? void 0 : activeView.editor.getCursor("to");
  let matched = false;
  let matchSpan = void 0;
  if (cursorFrom && cursorTo && cursorFrom.ch == cursorTo.ch && cursorFrom.line == cursorTo.line) {
    const lineText = activeView == null ? void 0 : activeView.editor.getLine(cursorFrom.line);
    if (lineText) {
      const matches = [...lineText.matchAll(REFERENCE_REGEX)];
      matches.forEach((match) => {
        var _a;
        if ((_a = match.index) == null ? void 0 : _a.toString()) {
          const start = match.index;
          const end = start + match[0].length;
          if (end == cursorTo.ch && evt.target) {
            const dataString = match[1];
            let checkContainer = evt.target instanceof Element;
            if (!checkContainer)
              throw new Error("Element not instance of Element");
            let container = evt.target;
            let activeLine;
            if (container.classList.contains("cm-active")) {
              activeLine = container;
            } else {
              activeLine = container.querySelector(".cm-active");
            }
            if (!activeLine)
              throw new Error("Element not instance of Element");
            let span = activeLine.querySelector(`span[data="${dataString}"]`);
            if (span && span instanceof HTMLSpanElement) {
              matched = true;
              matchSpan = span;
            } else {
            }
          }
        }
      });
    }
  }
  return { matched, span: matchSpan };
}
function handleRemoveHoveredCursor2(user) {
  if (getHoveredCursor()) {
    let nonCursors = getHoveredCursor().filter((element) => {
      return element.user !== user;
    }).map((element) => element.cursor.closest("span"));
    getHoveredCursor().filter((element) => element.user === user).forEach((element) => {
      if (!nonCursors.includes(element.cursor.closest("span"))) {
        let svg = element.cursor;
        if (!svg)
          throw new Error("SVG not found");
        if (svg.classList.contains("reference-icon"))
          svg.style.backgroundColor = "white";
        else {
          svg.setAttribute("fill", "white");
          svg.style.backgroundColor = "";
        }
        element.cursor.style.boxShadow = "none";
      }
    });
    removeHoveredCursor(user);
  }
}
function checkFocusCursor(evt) {
  let { matched, span } = checkCursorPositionAtDatastring(evt);
  if (matched && span) {
    updateHoveredCursorColor(span, ACTION_TYPE.CURSOR);
    endReferenceCursorEffect();
    startReferenceEffect(span, ACTION_TYPE.CURSOR);
  } else {
    endReferenceCursorEffect();
    handleRemoveHoveredCursor2(ACTION_TYPE.CURSOR);
  }
}

// src/references.ts
function createReferenceIcon(portalText = null) {
  const span = document.createElement("span");
  span.style.cursor = "pointer";
  const height = REFERENCE_ICON_HEIGHT;
  const width = height * 0.9;
  if (portalText == null) {
    const svg2 = document.createElementNS("http://www.w3.org/2000/svg", "svg");
    svg2.setAttribute("width", `${width}`);
    svg2.setAttribute("height", `${height}`);
    svg2.setAttribute("viewBox", `0 0 ${width} ${height}`);
    svg2.setAttribute("fill", "white");
    svg2.setAttribute("xmlns", "http://www.w3.org/2000/svg");
    svg2.style.border = "3px solid grey";
    svg2.style.backgroundColor = "white";
    svg2.style.borderRadius = "3px";
    svg2.style.cursor = "pointer";
    svg2.classList.add("reference-icon");
    const line = document.createElementNS("http://www.w3.org/2000/svg", "line");
    line.setAttribute("x1", "3");
    line.setAttribute("y1", `${(height - 3) / 3}`);
    line.setAttribute("x2", "12");
    line.setAttribute("y2", `${(height - 3) / 3}`);
    line.setAttribute("stroke-width", "2");
    line.setAttribute("stroke", "grey");
    svg2.appendChild(line);
    const line2 = document.createElementNS(
      "http://www.w3.org/2000/svg",
      "line"
    );
    line2.setAttribute("x1", "3");
    line2.setAttribute("y1", `${(height - 3) / 3 * 2}`);
    line2.setAttribute("x2", "15");
    line2.setAttribute("y2", `${(height - 3) / 3 * 2}`);
    line2.setAttribute("stroke-width", "2");
    line2.setAttribute("stroke", "grey");
    svg2.appendChild(line2);
    const line3 = document.createElementNS(
      "http://www.w3.org/2000/svg",
      "line"
    );
    line3.setAttribute("x1", "3");
    line3.setAttribute("y1", `${(height - 3) / 3 * 3}`);
    line3.setAttribute("x2", "10");
    line3.setAttribute("y2", `${(height - 3) / 3 * 3}`);
    line3.setAttribute("stroke-width", "2");
    line3.setAttribute("stroke", "grey");
    svg2.appendChild(line3);
    span.appendChild(svg2);
    return { span, svg: svg2 };
  }
  const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
  svg.setAttribute("width", `${width}`);
  svg.setAttribute("height", `${height}`);
  svg.setAttribute("viewBox", `0 0 ${width} ${height}`);
  svg.setAttribute("fill", "white");
  svg.setAttribute("xmlns", "http://www.w3.org/2000/svg");
  svg.classList.add("portal-icon");
  const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
  path.setAttribute(
    "d",
    "M4 6H13M4 10H14M3.99643 1.00037C7.0853 0.999923 11.1618 0.999881 14.0043 1.00025C15.6603 1.00046 17 2.34315 17 3.99923V11.3601C17 12.9951 15.6909 14.3276 14.0563 14.3582L7.34301 14.4842C6.79168 14.4945 6.25387 14.6566 5.78866 14.9527L2.53688 17.022C1.87115 17.4456 1 16.9674 1 16.1783V3.99993C1 2.34351 2.34001 1.0006 3.99643 1.00037Z"
  );
  path.setAttribute("stroke", "gray");
  path.setAttribute("stroke-width", "2");
  span.style.backgroundColor = "";
  svg.appendChild(path);
  span.appendChild(svg);
  if (portalText != "inline reference widget |*|") {
    let portal = document.createElement("div");
    portal.style.color = "black";
    portal.classList.add("portal");
    portal.innerHTML = portalText;
    portal.style.userSelect = "none";
    portal.style.pointerEvents = "none";
    span.appendChild(portal);
  }
  return { span, svg };
}
function updateHoveredCursorColor(span, user) {
  const svg = span.querySelector("svg");
  const portal = span.querySelector(".portal");
  if (svg && !portal) {
    handleRemoveHoveredCursor2(user);
    if (svg.classList.contains("reference-icon"))
      svg.style.backgroundColor = SVG_HOVER_COLOR;
    else
      svg.setAttribute("fill", SVG_HOVER_COLOR);
    updateHoveredCursor(svg, user);
  }
}
function getCodeMirrorEditorView(editor) {
  return editor.cm;
}
function getContainerElement(editorOrLeaf) {
  return editorOrLeaf.containerEl;
}
function getBacklinkID(backlink) {
  const jsonString = JSON.stringify(backlink);
  const id = v5_default(jsonString, "fb813ebb-1b53-4306-aa9c-655627447f0b");
  return `backlink-${id}`;
}
function getBacklinkContainer(editor) {
  const containerEl = getContainerElement(editor);
  const referenceMarkContainerID = "referenceMarkContainer";
  const container = containerEl.querySelector(`#${referenceMarkContainerID}`);
  if (container) {
    return container;
  } else {
    const newContainer = document.createElement("div");
    newContainer.id = referenceMarkContainerID;
    containerEl.querySelector(".cm-scroller").appendChild(newContainer);
    return newContainer;
  }
}
function getLeafBBoxElements2(leaf) {
  const title = getContainerElement(leaf).querySelector(".inline-title");
  if (!title) {
    throw new Error("Missing title");
  }
  const titleBbox = title.getBoundingClientRect();
  const line = getContainerElement(leaf).querySelector(".cm-line");
  if (!line) {
    throw new Error("Document has no lines");
  }
  const lineBbox = line.getBoundingClientRect();
  return { titleBbox, lineBbox };
}
function updateBacklinkMarkPosition2(leaf, backlinksToLeaf, showPortals) {
  const editor = getMarkdownView(leaf).editor;
  const backlinkContainer = getBacklinkContainer(editor);
  let backlinks2 = [];
  for (let i = 0; i < backlinkContainer.children.length; i++) {
    backlinks2.push(backlinkContainer.children.item(i));
  }
  let backlinkIds = backlinksToLeaf.map((x) => getBacklinkID(x));
  backlinks2.map((x) => x.id).forEach((id) => {
    if (!backlinkIds.includes(id)) {
      let element = document.getElementById(id);
      if (element)
        element.remove();
    }
  });
  const { titleBbox, lineBbox } = getLeafBBoxElements2(leaf);
  let referenceMarkers = backlinksToLeaf.map((backlink) => {
    const { from } = backlink.referencedLocation;
    const bbox = getCodeMirrorEditorView(editor).coordsAtPos(from);
    if (!bbox)
      return;
    let referenceMarker = backlinkContainer.querySelector(
      `#${getBacklinkID(backlink)}`
    );
    if (referenceMarker === null) {
      referenceMarker = createBacklinkMark(backlink);
      backlinkContainer.appendChild(referenceMarker);
    }
    if (bbox) {
      referenceMarker.style.position = "absolute";
      referenceMarker.setAttribute("top", bbox.top.toString());
      referenceMarker.style.top = bbox.top - titleBbox.top + 32 + "px";
      referenceMarker.style.left = lineBbox.width + 40 + "px";
    }
    return referenceMarker;
  });
  let lastYBottom = -Infinity;
  let margin = 4;
  referenceMarkers.sort(
    (a, b) => parseInt(a.getAttribute("top")) - parseInt(b.getAttribute("top"))
  ).forEach((marker) => {
    if (!marker)
      return;
    const portal = marker.querySelector(".portal");
    const svg = marker.querySelector("svg");
    if (showPortals) {
      if (svg && !portal)
        svg.style.display = "inline";
      else if (svg)
        svg.style.display = "none";
      if (portal) {
        portal.style.display = "inline";
        marker.style.border = "3px solid grey";
        marker.style.padding = "3px";
        marker.style.borderRadius = "3px";
      }
    } else {
      if (svg)
        svg.style.display = "inline";
      if (portal) {
        portal.style.display = "none";
        marker.style.border = "none";
        marker.style.padding = "0px";
        marker.style.borderRadius = "0px";
      }
    }
    let top = parseInt(marker.getAttribute("top"));
    top = Math.max(top, lastYBottom + margin);
    lastYBottom = top + marker.getBoundingClientRect().height + margin;
    marker.setAttribute("top", top.toString());
    marker.style.top = top - titleBbox.top + 32 + "px";
    marker.style.left = lineBbox.width + 40 + "px";
  });
}
async function updateBacklinkMarkPositions2() {
  const leaves = getThat().workspace.getLeavesOfType(
    "markdown"
  );
  setTimeout(async () => {
    const allBacklinks = await recomputeReferencesForPage();
    leaves.forEach((leaf) => {
      const backlinksToLeaf = allBacklinks.filter(
        // @ts-ignore
        (b) => b.referencedLocation.filename == leaf.view.file.path
      );
      const showPortals = getContainerElement(leaf).innerWidth > 900;
      updateBacklinkMarkPosition2(leaf, backlinksToLeaf, showPortals);
    });
  }, 500);
}
function createBacklinkMark(backlink) {
  let { span, svg } = createReferenceIcon(backlink.portalText);
  const portal = span.querySelector(".portal");
  span.style.position = "absolute";
  span.id = getBacklinkID(backlink);
  span.setAttribute("reference", JSON.stringify(backlink));
  span.addEventListener("mouseenter", async () => {
    if (portal && portal.style.display != "none") {
      span.style.backgroundColor = SVG_HOVER_COLOR;
    } else {
      span.style.backgroundColor = "";
      svg.setAttribute("fill", SVG_HOVER_COLOR);
    }
    updateHoveredCursorColor(span, ACTION_TYPE.BACKLINK);
  });
  span.addEventListener("mouseleave", async () => {
    if (portal && portal.style.display != "none") {
      span.style.backgroundColor = "white";
    } else {
      span.style.backgroundColor = "";
      if (portal) {
        svg.setAttribute("fill", "white");
      } else {
        svg.style.backgroundColor = "white";
      }
    }
    handleRemoveHoveredCursor2(ACTION_TYPE.BACKLINK);
  });
  const resizeObserver = new ResizeObserver((entries) => {
    if (portal && portal.style.display != "none") {
      span.style.backgroundColor = "white";
    } else {
      span.style.backgroundColor = "";
    }
  });
  resizeObserver.observe(span);
  span.addEventListener("click", openBacklinkReference);
  return span;
}
function addReferencesToLeaf(leaf) {
  const markdownView = getMarkdownView(leaf);
  let workspaceTabs = markdownView.containerEl.closest(".workspace-tabs");
  if (!workspaceTabs) {
    throw new Error("Missing workspace tabs");
  }
  updateBacklinkMarkPositions2();
  getContainerElement(markdownView.editor).querySelector(".cm-scroller").addEventListener("scroll", () => {
    updateBacklinkMarkPositions2();
  });
  let resizeObserver = new ResizeObserver(() => {
    updateBacklinkMarkPositions2();
  });
  resizeObserver.observe(workspaceTabs);
}
function getMarkdownView(leaf) {
  if (!(leaf.view instanceof import_obsidian4.MarkdownView)) {
    throw new Error("Unexpected non-markdown view");
  }
  return leaf.view;
}
function createBacklinkData(referencingFileData, referencingFile) {
  let backlinks2 = [];
  let matches = [...referencingFileData.matchAll(REFERENCE_REGEX)];
  matches.forEach((match) => {
    let [prefix, text, suffix, filename, from, to, portal] = processURI(
      match[1]
    );
    const referencedLocation = {
      prefix,
      text,
      suffix,
      filename,
      from,
      to
    };
    let index = referencingFileData.indexOf(match[0]);
    const referencingSurroundingStrings = getPrefixAndSuffix(
      referencingFileData,
      index,
      index + match[0].length
    );
    const referencingLocation = {
      // prefix: referencingFileData.slice(index - 25, index),
      prefix: referencingSurroundingStrings.prefix,
      text: referencingFileData.slice(index, index + match[0].length),
      // suffix: referencingFileData.slice(
      // 	index + match[0].length,
      // 	index + match[0].length + 25
      // ),
      suffix: referencingSurroundingStrings.suffix,
      filename: referencingFile.path,
      from: match.index,
      // TODO do weird string format
      to: match.index + match[0].length
      // TODO do weird string format
    };
    if (portal == "portal") {
      const getLineText = (text2, index2) => {
        const startOfLine = text2.lastIndexOf("\n", index2 - 1) + 1;
        const endOfLine = text2.indexOf("\n", index2);
        return text2.slice(
          startOfLine,
          endOfLine !== -1 ? endOfLine : void 0
        );
      };
      let line = getLineText(referencingFileData, index);
      let portalText = line.replace(new RegExp(REFERENCE_REGEX, "g"), "");
      let portalTextSlice = portalText.slice(0, PORTAL_TEXT_SLICE_SIZE);
      backlinks2.push({
        referencedLocation,
        referencingLocation,
        dataString: match[1],
        portalText: portalTextSlice
      });
    } else {
      backlinks2.push({
        referencedLocation,
        referencingLocation,
        dataString: match[1]
      });
    }
  });
  return backlinks2;
}
function generateBacklinks() {
  console.log("generating references");
  let backlinks2 = [];
  let markdownFiles = this.app.vault.getMarkdownFiles();
  Promise.all(
    markdownFiles.map((file) => this.app.vault.read(file))
  ).then((files) => {
    const zippedArray = markdownFiles.map((file, index) => ({
      markdownFile: file,
      fileData: files[index]
    }));
    zippedArray.forEach((file) => {
      let fileBacklinks = createBacklinkData(file.fileData, file.markdownFile);
      updateBacklinks(fileBacklinks);
      backlinks2.push(...fileBacklinks);
    });
    const leaves = this.app.workspace.getLeavesOfType("markdown");
    leaves.forEach((leaf) => {
      addReferencesToLeaf(leaf);
    });
  });
}
async function recomputeReferencesForPage() {
  const leaves = getThat().workspace.getLeavesOfType("markdown");
  let references = [];
  let markdownFiles = this.app.vault.getMarkdownFiles();
  let promises = markdownFiles.map((file) => this.app.vault.read(file));
  let files = await Promise.all(promises);
  const zippedArray = markdownFiles.map((file, index) => ({
    markdownFile: file,
    fileData: files[index]
  }));
  zippedArray.forEach((file) => {
    let fileBacklinks = createBacklinkData(file.fileData, file.markdownFile);
    updateBacklinks(fileBacklinks);
    references.push(...fileBacklinks);
  });
  return references;
}
async function openBacklinkReference(ev) {
  let cursor = getCursor();
  let hover = getBacklinkHover();
  let leaf = getThat().workspace.getLeafById(hover.leafId);
  let container = leaf.containerEl;
  if (!container)
    throw new Error("Container not found");
  container.querySelector(".view-content").style.boxShadow = "none";
  if (cursor && hover && cursor.dataString && hover.dataString && cursor.dataString == hover.dataString) {
    updateCursor({
      temp: false,
      cursorViewport: null,
      peek: false
    });
  }
  updateBacklinkHover({
    temp: false,
    cursorViewport: null,
    peek: false
  });
  handleRemoveHoveredCursor2(ACTION_TYPE.CURSOR);
  resetCursor();
}
async function openReference(ev) {
  let cursor = getCursor();
  let hover = getHover();
  let leaf = getThat().workspace.getLeafById(hover.leafId);
  let container = leaf.containerEl;
  if (!container)
    throw new Error("Container not found");
  container.querySelector(".view-content").style.boxShadow = "none";
  if (cursor && hover && cursor.dataString && hover.dataString && cursor.dataString == hover.dataString) {
    updateCursor({
      temp: false,
      cursorViewport: null,
      peek: false
    });
  }
  updateHover({
    temp: false,
    cursorViewport: null,
    peek: false
  });
  handleRemoveHoveredCursor2(ACTION_TYPE.CURSOR);
  resetCursor();
}

// src/state.ts
var that = import_state6.StateField.define({
  create() {
    return null;
  },
  update(value, tr) {
    if (tr["annotations"].length == 2 && tr["annotations"][0].value.type == "that") {
      return tr["annotations"][0].value.that.app;
    }
    return value;
  }
});
var hoveredCursor = import_state6.StateField.define({
  create() {
    return null;
  },
  update(value, tr) {
    if (tr["annotations"].length == 2 && tr["annotations"][0].value.type == "hoveredCursor") {
      if (value)
        return [
          ...value.filter(
            (cursor) => cursor.user != tr["annotations"][0].value.user
          ),
          {
            cursor: tr["annotations"][0].value.cursor,
            user: tr["annotations"][0].value.user
          }
        ];
      return [
        {
          cursor: tr["annotations"][0].value.cursor,
          user: tr["annotations"][0].value.user
        }
      ];
    } else if (tr["annotations"].length == 2 && tr["annotations"][0].value.type == "removeHoveredCursor") {
      if (value)
        return value.filter(
          (cursor) => cursor.user != tr["annotations"][0].value.user
        );
      return value;
    }
    return value;
  }
});
var backlinks = import_state6.StateField.define({
  create() {
    return [];
  },
  update(value, tr) {
    if (tr.effects.length > 0) {
      try {
        let data = JSON.parse(
          tr.effects[0].value
        );
        if (data.type == "backlink") {
          if (data.backlinks.length == 0)
            return value;
          let referencingLocation = data.backlinks[0]["referencingLocation"]["filename"];
          let filteredValues = value.filter(
            (backlink) => backlink.referencingLocation.filename != referencingLocation
          );
          return [...filteredValues, ...data.backlinks];
        }
        return value;
      } catch (e) {
        console.log(e);
        return value;
      }
    }
    return value;
  }
});
var hoverElement = import_state6.StateField.define({
  create() {
    return null;
  },
  update(value, tr) {
    if (tr.effects.length > 0) {
      try {
        let data = JSON.parse(tr.effects[0].value);
        if (data.type == "hover-start") {
          return Object.assign({}, data);
        } else if (data.type == "hover") {
          if (value)
            return Object.assign(value, data);
          return data;
        } else if (data.type == "hover-off") {
          return null;
        }
        return value;
      } catch (e) {
        console.log(e);
        return value;
      }
    }
    return value;
  }
});
var backlinkHoverElement = import_state6.StateField.define({
  create() {
    return null;
  },
  update(value, tr) {
    if (tr.effects.length > 0) {
      try {
        let data = JSON.parse(tr.effects[0].value);
        if (data.type == "backlink-start") {
          return Object.assign({}, data);
        } else if (data.type == "backlink-update") {
          if (value)
            return Object.assign(value, data);
          return data;
        } else if (data.type == "backlink-off") {
          return null;
        }
        return value;
      } catch (e) {
        console.log(e);
        return value;
      }
    }
    return value;
  }
});
var cursorElement = import_state6.StateField.define({
  create() {
    return null;
  },
  update(value, tr) {
    if (tr.effects.length > 0) {
      try {
        let data = JSON.parse(tr.effects[0].value);
        if (data.type == "cursor-start") {
          return {};
        } else if (data.type == "cursor") {
          if (value)
            return Object.assign(value, data);
          return data;
        } else if (data.type == "cursor-off") {
          return null;
        }
        return value;
      } catch (e) {
        console.log(e);
        return value;
      }
    }
    return value;
  }
});
var editorChange = import_state6.StateField.define({
  create() {
    return null;
  },
  update(value, tr) {
    if (tr.effects.length > 0) {
      try {
        let data = JSON.parse(tr.effects[0].value);
        if (data.type == "sync") {
          updateBacklinkMarkPositions2();
          return value;
        }
        return value;
      } catch (e) {
        console.log(e);
        return value;
      }
    }
    return value;
  }
});
var thatAnnotation = import_state6.Annotation.define();
var hoveredCursorAnnotation = import_state6.Annotation.define();
var hoverEffect = import_state6.StateEffect.define();
var backlinkHoverEffect = import_state6.StateEffect.define();
var cursorEffect = import_state6.StateEffect.define();
var backlinkEffect = import_state6.StateEffect.define();
var state3 = import_state6.EditorState.create({
  extensions: [
    that,
    hoveredCursor,
    backlinks,
    hoverElement,
    backlinkHoverElement,
    cursorElement,
    editorChange
  ]
});
function getThat() {
  return state3.field(that);
}
function updateThat(that2) {
  state3 = state3.update({
    annotations: thatAnnotation.of({
      type: "that",
      that: that2
    })
  }).state;
}
function getHoveredCursor() {
  return state3.field(hoveredCursor);
}
function updateHoveredCursor(cursor, user) {
  state3 = state3.update({
    annotations: hoveredCursorAnnotation.of({
      type: "hoveredCursor",
      cursor,
      user
    })
  }).state;
}
function removeHoveredCursor(user) {
  state3 = state3.update({
    annotations: hoveredCursorAnnotation.of({
      type: "removeHoveredCursor",
      user
    })
  }).state;
}
function getHover() {
  return state3.field(hoverElement);
}
function updateHover(value) {
  state3 = state3.update({
    effects: hoverEffect.of(
      JSON.stringify(Object.assign(value, { type: "hover" }))
    )
  }).state;
}
function resetHover() {
  state3 = state3.update({
    effects: hoverEffect.of(
      JSON.stringify({
        type: "hover-off"
      })
    )
  }).state;
}
function getBacklinkHover() {
  return state3.field(backlinkHoverElement);
}
function updateBacklinkHover(value) {
  state3 = state3.update({
    effects: backlinkHoverEffect.of(
      JSON.stringify(Object.assign(value, { type: "backlink-update" }))
    )
  }).state;
}
function resetBacklinkHover() {
  state3 = state3.update({
    effects: backlinkHoverEffect.of(
      JSON.stringify({
        type: "backlink-off"
      })
    )
  }).state;
}
function getCursor() {
  return state3.field(cursorElement);
}
function updateCursor(value) {
  state3 = state3.update({
    effects: cursorEffect.of(
      JSON.stringify(Object.assign(value, { type: "cursor" }))
    )
  }).state;
}
function resetCursor() {
  state3 = state3.update({
    effects: cursorEffect.of(
      JSON.stringify({
        type: "cursor-off"
      })
    )
  }).state;
}
function getBacklinks2() {
  return state3.field(backlinks);
}
function updateBacklinks(value) {
  state3 = state3.update({
    effects: backlinkEffect.of(
      JSON.stringify(Object.assign({ backlinks: value }, { type: "backlink" }))
    )
  }).state;
}

// src/widget/highlightWidget.ts
var import_view3 = require("@codemirror/view");
var HighlighterWidget = class extends import_view3.WidgetType {
  constructor(name, view) {
    super();
    this.name = name;
    this.view = view;
  }
  eq(other) {
    return this.name === other.name;
  }
  toDOM() {
    const span = document.createElement("fragment");
    span.textContent = this.name;
    span.style.backgroundColor = SVG_HOVER_COLOR;
    span.style.color = "black";
    return span;
  }
};
var highlighterDecoration = (match, view) => import_view3.Decoration.replace({
  widget: new HighlighterWidget(match[1], view)
});
var highlightMatcher = new import_view3.MatchDecorator({
  regexp: /\+\+\+(.*?)\+\+\+/g,
  decoration: (match, view, pos) => {
    return highlighterDecoration(match, view);
  }
});
var highlights = import_view3.ViewPlugin.fromClass(
  class {
    constructor(view) {
      this.highlights = highlightMatcher.createDeco(view);
    }
    update(update) {
      this.highlights = highlightMatcher.updateDeco(update, this.highlights);
    }
    destroy() {
      this.highlights = import_view3.Decoration.none;
    }
  },
  {
    decorations: (instance) => instance.highlights,
    provide: (plugin) => import_view3.EditorView.atomicRanges.of((view) => {
      var _a;
      return ((_a = view.plugin(plugin)) == null ? void 0 : _a.highlights) || import_view3.Decoration.none;
    })
  }
);

// src/widget/referenceWidget.ts
var import_view4 = require("@codemirror/view");
var ReferenceWidget = class extends import_view4.WidgetType {
  constructor(name, view, pos) {
    super();
    this.name = name;
    this.view = view;
    this.pos = pos;
  }
  eq(other) {
    return this.name === other.name;
  }
  updateName(name, portal) {
    const from = this.pos;
    const to = this.pos + name.length + (portal == "portal" ? 3 : -3);
    const transaction = this.view.state.update({
      changes: { from, to, insert: name }
    });
    this.view.dispatch(transaction);
    updateBacklinkMarkPositions2();
    this.name = name;
  }
  getView() {
    return this.view;
  }
  toDOM() {
    const regex = /\[\]\(urn:([^)]*)\)/g;
    let content = regex.exec(this.name);
    if (!content)
      throw new Error("Invalid reference");
    const [prefix, text, suffix, file, from, to, portal] = content[1].split(":");
    const { span, svg } = createReferenceIcon(
      portal == "portal" ? "inline reference widget |*|" : null
    );
    if (content)
      span.setAttribute("data", content[1]);
    const containerSpan = document.createElement("span");
    const referenceSpan = document.createElement("span");
    referenceSpan.innerHTML = decodeURIComponentString2(text);
    referenceSpan.style.border = "1px solid white";
    referenceSpan.style.borderRadius = "3px";
    if (portal == "no-portal")
      referenceSpan.style.display = "none";
    containerSpan.appendChild(referenceSpan);
    containerSpan.appendChild(span);
    span.addEventListener("click", (ev) => {
      if (ev.metaKey || ev.ctrlKey) {
        let newPortal = "";
        if (referenceSpan.style.display === "none") {
          referenceSpan.style.display = "inline";
          newPortal = "portal";
        } else {
          referenceSpan.style.display = "none";
          newPortal = "no-portal";
        }
        let reference = `[\u2197](urn:${prefix}:${text}:${suffix}:${file}:${from}:${to}:${newPortal})`;
        this.updateName(reference, newPortal);
      } else {
        openReference(ev);
      }
    });
    return containerSpan;
  }
};
var referenceDecoration = (match, view, pos) => {
  let decoration = import_view4.Decoration.replace({
    widget: new ReferenceWidget(match[0], view, pos)
  });
  return decoration;
};
var referenceMatcher = new import_view4.MatchDecorator({
  // regexp: /\[\u2197\]\(urn:[\s\S^\)]*\)/g,
  // regexp: /\[\u2197\]\(urn:([^:]*:){5,6}[^:]*\)/g,
  regexp: /\[\u2197\]\(urn:([^:]*:){6}[^:)]*\)/g,
  decoration: (match, view, pos) => {
    return referenceDecoration(match, view, pos);
  }
});
var referenceResources = import_view4.ViewPlugin.fromClass(
  class {
    constructor(view) {
      this.referenceResources = referenceMatcher.createDeco(view);
    }
    update(update) {
      this.referenceResources = referenceMatcher.updateDeco(
        update,
        this.referenceResources
      );
    }
    destroy() {
      this.referenceResources = import_view4.Decoration.none;
    }
  },
  {
    decorations: (instance) => instance.referenceResources,
    provide: (plugin) => import_view4.EditorView.atomicRanges.of((view) => {
      var _a;
      return ((_a = view.plugin(plugin)) == null ? void 0 : _a.referenceResources) || import_view4.Decoration.none;
    })
  }
);

// src/clipboard.ts
var import_obsidian5 = require("obsidian");
async function updateClipboard(only = false) {
  const view = this.app.workspace.getActiveViewOfType(import_obsidian5.MarkdownView);
  if (view) {
    let selection = view.editor.getSelection();
    if (view.file) {
      const text = view.data;
      const from = view.editor.posToOffset(view.editor.getCursor("from"));
      const to = view.editor.posToOffset(view.editor.getCursor("to"));
      const { prefix, suffix } = getPrefixAndSuffix(text, from, to);
      let reference = `[\u2197](urn:${encodeURIComponentString(
        prefix
      )}-:${encodeURIComponentString(selection)}:-${encodeURIComponentString(
        suffix
      )}:${encodeURIComponentString(view.file.path)}:${from}:${to}:${only ? "portal" : "no-portal"})`;
      await navigator.clipboard.writeText(reference);
    }
  }
}

// src/main.ts
var import_view5 = require("@codemirror/view");
var ReferencePlugin = class extends import_obsidian6.Plugin {
  onload() {
    setTimeout(() => {
      generateBacklinks();
      this.registerEvent(
        this.app.workspace.on("active-leaf-change", (ev) => {
          try {
            const activeView = this.app.workspace.getActiveViewOfType(import_obsidian6.MarkdownView);
            if ((activeView == null ? void 0 : activeView.leaf) != null) {
              addReferencesToLeaf(activeView.leaf);
            }
          } catch (e) {
            console.log(e);
          }
        })
      );
    }, 4e3);
    updateThat(this);
    this.registerEditorExtension([
      highlights,
      referenceResources,
      import_view5.EditorView.updateListener.of(function(e) {
        if (Math.abs(e.changes.desc.newLength - e.changes.desc.length) > 1) {
          updateBacklinkMarkPositions2();
        }
      })
    ]);
    this.registerDomEvent(document, "mousemove", async (evt) => {
      if (evt.metaKey || evt.ctrlKey)
        return;
      let span;
      let dataString;
      if (evt.target && (evt.target instanceof HTMLSpanElement || evt.target instanceof SVGElement || evt.target instanceof SVGPathElement)) {
        span = evt.target;
        while (!(span instanceof HTMLSpanElement) && span.parentElement != null) {
          span = span.parentElement;
        }
      }
      if (span && span instanceof HTMLSpanElement && span.getAttribute("data")) {
        updateHoveredCursorColor(span, ACTION_TYPE.MOUSE);
        startReferenceEffect(span, ACTION_TYPE.MOUSE);
      } else if (span && span instanceof HTMLSpanElement && span.getAttribute("reference")) {
        startBacklinkEffect(span);
      } else if (getHover() != null) {
        endReferenceHoverEffect();
        handleRemoveHoveredCursor2(ACTION_TYPE.MOUSE);
      } else if (getBacklinks2() != null) {
        endBacklinkHoverEffect();
      }
    });
    this.registerDomEvent(document, "click", async (evt) => {
      if (evt.metaKey || evt.ctrlKey)
        return;
      checkFocusCursor(evt);
      updateBacklinkMarkPositions2();
    });
    this.registerDomEvent(document, "keyup", async (evt) => {
      if (evt.metaKey || evt.ctrlKey)
        return;
      checkFocusCursor(evt);
      updateBacklinkMarkPositions2();
    });
    this.registerDomEvent(document, "keydown", async (evt) => {
      if (evt.key == "c" && evt.metaKey && evt.shiftKey) {
        updateClipboard();
        new import_obsidian6.Notice("Copied reference and text to clipboard");
      } else if (evt.key == "r" && evt.metaKey && evt.shiftKey) {
        updateClipboard(true);
        new import_obsidian6.Notice("Copied annotation to clipboard");
      } else if (evt.key == "e" && evt.metaKey && evt.shiftKey) {
        new import_obsidian6.Notice("New annotation");
      }
    });
  }
  onunload() {
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL3N0YXRlLnRzIiwgInNyYy9yZWZlcmVuY2VzLnRzIiwgIm5vZGVfbW9kdWxlcy91dWlkL2Rpc3QvZXNtLWJyb3dzZXIvcmVnZXguanMiLCAibm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci92YWxpZGF0ZS5qcyIsICJub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS1icm93c2VyL3N0cmluZ2lmeS5qcyIsICJub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS1icm93c2VyL3BhcnNlLmpzIiwgIm5vZGVfbW9kdWxlcy91dWlkL2Rpc3QvZXNtLWJyb3dzZXIvdjM1LmpzIiwgIm5vZGVfbW9kdWxlcy91dWlkL2Rpc3QvZXNtLWJyb3dzZXIvc2hhMS5qcyIsICJub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS1icm93c2VyL3Y1LmpzIiwgInNyYy91dGlscy50cyIsICJzcmMvY29uc3RhbnRzLnRzIiwgInNyYy93b3Jrc3BhY2UudHMiLCAic3JjL2VmZmVjdHMudHMiLCAic3JjL21hcmsudHMiLCAic3JjL3dpZGdldC9oaWdobGlnaHRXaWRnZXQudHMiLCAic3JjL3dpZGdldC9yZWZlcmVuY2VXaWRnZXQudHMiLCAic3JjL2NsaXBib2FyZC50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgUGx1Z2luLCBNYXJrZG93blZpZXcsIE5vdGljZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuXG5pbXBvcnQgeyB1cGRhdGVUaGF0LCBnZXRUaGF0LCBnZXRIb3ZlciwgZ2V0QmFja2xpbmtzIH0gZnJvbSBcIi4vc3RhdGVcIjtcbmltcG9ydCB7IGhpZ2hsaWdodHMsIHJlZmVyZW5jZVJlc291cmNlcyB9IGZyb20gXCIuL3dpZGdldFwiO1xuaW1wb3J0IHsgdXBkYXRlQ2xpcGJvYXJkIH0gZnJvbSBcIi4vY2xpcGJvYXJkXCI7XG5pbXBvcnQge1xuXHRnZW5lcmF0ZUJhY2tsaW5rcyxcblx0YWRkUmVmZXJlbmNlc1RvTGVhZixcblx0dXBkYXRlQmFja2xpbmtNYXJrUG9zaXRpb25zLFxuXHR1cGRhdGVIb3ZlcmVkQ3Vyc29yQ29sb3IsXG59IGZyb20gXCIuL3JlZmVyZW5jZXNcIjtcbmltcG9ydCB7XG5cdHN0YXJ0UmVmZXJlbmNlRWZmZWN0LFxuXHRlbmRSZWZlcmVuY2VIb3ZlckVmZmVjdCxcblx0c3RhcnRCYWNrbGlua0VmZmVjdCxcblx0ZW5kQmFja2xpbmtIb3ZlckVmZmVjdCxcbn0gZnJvbSBcIi4vZWZmZWN0c1wiO1xuaW1wb3J0IHsgY2hlY2tGb2N1c0N1cnNvciwgaGFuZGxlUmVtb3ZlSG92ZXJlZEN1cnNvciB9IGZyb20gXCIuL3V0aWxzXCI7XG5pbXBvcnQgeyBBQ1RJT05fVFlQRSwgU1ZHX0hPVkVSX0NPTE9SIH0gZnJvbSBcIi4vY29uc3RhbnRzXCI7XG5pbXBvcnQgeyBFZGl0b3JWaWV3LCBWaWV3VXBkYXRlIH0gZnJvbSBcIkBjb2RlbWlycm9yL3ZpZXdcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUmVmZXJlbmNlUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcblx0b25sb2FkKCkge1xuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0Z2VuZXJhdGVCYWNrbGlua3MoKTtcblx0XHRcdHRoaXMucmVnaXN0ZXJFdmVudChcblx0XHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLm9uKFwiYWN0aXZlLWxlYWYtY2hhbmdlXCIsIChldikgPT4ge1xuXHRcdFx0XHRcdC8vIGNvbnNvbGUubG9nKFwiYWN0aXZlLWxlYWYtY2hhbmdlZDpcIik7XG5cdFx0XHRcdFx0Ly8gVGhpcyBzaG91bGQgY3JlYXRlIHJlZmVyZW5jZU1hcmtlcnMgaWYgdGhleSBkb24ndCBleGlzdCBhbmQgdXBkYXRlXG5cdFx0XHRcdFx0Ly8gZWxzZSB1cGRhdGUgb25seVxuXG5cdFx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRcdGNvbnN0IGFjdGl2ZVZpZXcgPVxuXHRcdFx0XHRcdFx0XHR0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuXHRcdFx0XHRcdFx0aWYgKGFjdGl2ZVZpZXc/LmxlYWYgIT0gbnVsbCkge1xuXHRcdFx0XHRcdFx0XHRhZGRSZWZlcmVuY2VzVG9MZWFmKGFjdGl2ZVZpZXcubGVhZik7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coZSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KVxuXHRcdFx0KTtcblx0XHR9LCA0MDAwKTtcblxuXHRcdHVwZGF0ZVRoYXQodGhpcyk7XG5cblx0XHR0aGlzLnJlZ2lzdGVyRWRpdG9yRXh0ZW5zaW9uKFtcblx0XHRcdGhpZ2hsaWdodHMsXG5cdFx0XHRyZWZlcmVuY2VSZXNvdXJjZXMsXG5cdFx0XHRFZGl0b3JWaWV3LnVwZGF0ZUxpc3RlbmVyLm9mKGZ1bmN0aW9uIChlKSB7XG5cdFx0XHRcdGlmIChNYXRoLmFicyhlLmNoYW5nZXMuZGVzYy5uZXdMZW5ndGggLSBlLmNoYW5nZXMuZGVzYy5sZW5ndGgpID4gMSkge1xuXHRcdFx0XHRcdHVwZGF0ZUJhY2tsaW5rTWFya1Bvc2l0aW9ucygpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KSxcblx0XHRdKTtcblxuXHRcdHRoaXMucmVnaXN0ZXJEb21FdmVudChkb2N1bWVudCwgXCJtb3VzZW1vdmVcIiwgYXN5bmMgKGV2dCkgPT4ge1xuXHRcdFx0aWYgKGV2dC5tZXRhS2V5IHx8IGV2dC5jdHJsS2V5KSByZXR1cm47XG5cblx0XHRcdC8vIGNvbnN0IHNlbWlNb2RlID0gZXZ0Lm1ldGFLZXkgfHwgZXZ0LmN0cmxLZXk7XG5cdFx0XHRsZXQgc3Bhbjtcblx0XHRcdGxldCBkYXRhU3RyaW5nO1xuXHRcdFx0aWYgKFxuXHRcdFx0XHRldnQudGFyZ2V0ICYmXG5cdFx0XHRcdChldnQudGFyZ2V0IGluc3RhbmNlb2YgSFRNTFNwYW5FbGVtZW50IHx8XG5cdFx0XHRcdFx0ZXZ0LnRhcmdldCBpbnN0YW5jZW9mIFNWR0VsZW1lbnQgfHxcblx0XHRcdFx0XHRldnQudGFyZ2V0IGluc3RhbmNlb2YgU1ZHUGF0aEVsZW1lbnQpXG5cdFx0XHQpIHtcblx0XHRcdFx0Ly8gSWYgZWxlbWVudCBpcyBzdmcsIGZpbmQgdGhlIGNvbnRhaW5pbmcgcGFyZW50IHNwYW5cblx0XHRcdFx0c3BhbiA9IGV2dC50YXJnZXQ7XG5cblx0XHRcdFx0d2hpbGUgKFxuXHRcdFx0XHRcdCEoc3BhbiBpbnN0YW5jZW9mIEhUTUxTcGFuRWxlbWVudCkgJiZcblx0XHRcdFx0XHRzcGFuLnBhcmVudEVsZW1lbnQgIT0gbnVsbFxuXHRcdFx0XHQpIHtcblx0XHRcdFx0XHRzcGFuID0gc3Bhbi5wYXJlbnRFbGVtZW50O1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdGlmIChcblx0XHRcdFx0c3BhbiAmJlxuXHRcdFx0XHRzcGFuIGluc3RhbmNlb2YgSFRNTFNwYW5FbGVtZW50ICYmXG5cdFx0XHRcdHNwYW4uZ2V0QXR0cmlidXRlKFwiZGF0YVwiKVxuXHRcdFx0KSB7XG5cdFx0XHRcdC8vIGNvbnNvbGUubG9nKFwic3RhcnQgaG92ZXIgcmVmZXJlbmNlIGVmZmVjdFwiKTtcblx0XHRcdFx0dXBkYXRlSG92ZXJlZEN1cnNvckNvbG9yKHNwYW4sIEFDVElPTl9UWVBFLk1PVVNFKTtcblx0XHRcdFx0c3RhcnRSZWZlcmVuY2VFZmZlY3Qoc3BhbiwgQUNUSU9OX1RZUEUuTU9VU0UpO1xuXHRcdFx0fSBlbHNlIGlmIChcblx0XHRcdFx0c3BhbiAmJlxuXHRcdFx0XHRzcGFuIGluc3RhbmNlb2YgSFRNTFNwYW5FbGVtZW50ICYmXG5cdFx0XHRcdHNwYW4uZ2V0QXR0cmlidXRlKFwicmVmZXJlbmNlXCIpXG5cdFx0XHQpIHtcblx0XHRcdFx0Ly8gY29uc29sZS5sb2coXCJzdGFydCBiYWNrbGluayBlZmZlY3RcIik7XG5cdFx0XHRcdC8vIHVwZGF0ZUhvdmVyZWRDdXJzb3JDb2xvcihzcGFuLCBBQ1RJT05fVFlQRS5CQUNLTElOSyk7XG5cdFx0XHRcdHN0YXJ0QmFja2xpbmtFZmZlY3Qoc3Bhbik7XG5cdFx0XHR9IGVsc2UgaWYgKGdldEhvdmVyKCkgIT0gbnVsbCkge1xuXHRcdFx0XHQvLyBjb25zb2xlLmxvZyhcImVuZCBob3ZlciByZWZlcmVuY2UgZWZmZWN0XCIpO1xuXHRcdFx0XHRlbmRSZWZlcmVuY2VIb3ZlckVmZmVjdCgpO1xuXHRcdFx0XHRoYW5kbGVSZW1vdmVIb3ZlcmVkQ3Vyc29yKEFDVElPTl9UWVBFLk1PVVNFKTtcblx0XHRcdH0gZWxzZSBpZiAoZ2V0QmFja2xpbmtzKCkgIT0gbnVsbCkge1xuXHRcdFx0XHQvLyBjb25zb2xlLmxvZyhcImVuZCBiYWNrbGluayByZWZlcmVuY2UgZWZmZWN0XCIpO1xuXHRcdFx0XHRlbmRCYWNrbGlua0hvdmVyRWZmZWN0KCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHQvLyBvbiBzZWxlY3Rpb24gY2hhbmdlcywgZXZlbnQgb3ZlciBjbGljayBhbmQga2V5ZG93blxuXG5cdFx0dGhpcy5yZWdpc3RlckRvbUV2ZW50KGRvY3VtZW50LCBcImNsaWNrXCIsIGFzeW5jIChldnQpID0+IHtcblx0XHRcdGlmIChldnQubWV0YUtleSB8fCBldnQuY3RybEtleSkgcmV0dXJuO1xuXHRcdFx0Y2hlY2tGb2N1c0N1cnNvcihldnQpO1xuXHRcdFx0dXBkYXRlQmFja2xpbmtNYXJrUG9zaXRpb25zKCk7XG5cdFx0fSk7XG5cblx0XHR0aGlzLnJlZ2lzdGVyRG9tRXZlbnQoZG9jdW1lbnQsIFwia2V5dXBcIiwgYXN5bmMgKGV2dCkgPT4ge1xuXHRcdFx0aWYgKGV2dC5tZXRhS2V5IHx8IGV2dC5jdHJsS2V5KSByZXR1cm47XG5cblx0XHRcdC8vIGNvbnNvbGUubG9nKFwia2V5dXBcIik7XG5cdFx0XHRjaGVja0ZvY3VzQ3Vyc29yKGV2dCk7XG5cdFx0XHQvLyB1cGRhdGVCYWNrbGlua01hcmtQb3NpdGlvbnMoKTtcblx0XHRcdHVwZGF0ZUJhY2tsaW5rTWFya1Bvc2l0aW9ucygpO1xuXHRcdH0pO1xuXG5cdFx0dGhpcy5yZWdpc3RlckRvbUV2ZW50KGRvY3VtZW50LCBcImtleWRvd25cIiwgYXN5bmMgKGV2dCkgPT4ge1xuXHRcdFx0Ly8gY29uc29sZS5sb2coXCJrZXlkb3duXCIpO1xuXG5cdFx0XHRpZiAoZXZ0LmtleSA9PSBcImNcIiAmJiBldnQubWV0YUtleSAmJiBldnQuc2hpZnRLZXkpIHtcblx0XHRcdFx0Ly8gY29uc29sZS5sb2coXCJjXCIpO1xuXHRcdFx0XHR1cGRhdGVDbGlwYm9hcmQoKTtcblx0XHRcdFx0bmV3IE5vdGljZShcIkNvcGllZCByZWZlcmVuY2UgYW5kIHRleHQgdG8gY2xpcGJvYXJkXCIpO1xuXHRcdFx0fSBlbHNlIGlmIChldnQua2V5ID09IFwiclwiICYmIGV2dC5tZXRhS2V5ICYmIGV2dC5zaGlmdEtleSkge1xuXHRcdFx0XHQvLyBjb25zb2xlLmxvZyhcInJcIik7XG5cdFx0XHRcdHVwZGF0ZUNsaXBib2FyZCh0cnVlKTtcblx0XHRcdFx0bmV3IE5vdGljZShcIkNvcGllZCBhbm5vdGF0aW9uIHRvIGNsaXBib2FyZFwiKTtcblx0XHRcdH0gZWxzZSBpZiAoZXZ0LmtleSA9PSBcImVcIiAmJiBldnQubWV0YUtleSAmJiBldnQuc2hpZnRLZXkpIHtcblx0XHRcdFx0Ly8gZmluZCB0aGUgYW5ub3RhdGlvbnMgZmlsZVxuXHRcdFx0XHQvLyBpZiBpdCBkb2Vzbid0IGV4aXN0LCBjcmVhdGUgaXRcblx0XHRcdFx0Ly8gaWYgaXQgZXhpc3RzLCBvcGVuIGl0IGluIGFkamFjZW50IHBhbmVsXG5cdFx0XHRcdC8vIGFkZCBuZXcgYW5ub3RhdGlvblxuXG5cdFx0XHRcdG5ldyBOb3RpY2UoXCJOZXcgYW5ub3RhdGlvblwiKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdC8vIGdldFRoYXQoKS53b3Jrc3BhY2Uub24oXCJlZGl0b3ItY2hhbmdlXCIsIChldikgPT4ge1xuXHRcdC8vIFx0Y29uc29sZS5sb2coZXYpO1xuXHRcdC8vIH0pO1xuXG5cdFx0Ly8gdGhpcy5yZWdpc3RlckV2ZW50KFxuXHRcdC8vIFx0dGhpcy5hcHAud29ya3NwYWNlLm9uKFwid2luZG93LWNsb3NlXCIsIChldikgPT4ge1xuXHRcdC8vIFx0XHRjb25zb2xlLmxvZyhcIndpbmRvdyBjbG9zZWQ6XCIpO1xuXHRcdC8vIFx0XHRjb25zb2xlLmxvZyhldik7XG5cdFx0Ly8gXHR9KVxuXHRcdC8vICk7XG5cblx0XHQvLyB0aGlzLnJlZ2lzdGVyRXZlbnQoXG5cdFx0Ly8gXHR0aGlzLmFwcC53b3Jrc3BhY2Uub24oXCJlZGl0b3ItZHJvcFwiLCAoZXYpID0+IHtcblx0XHQvLyBcdFx0Y29uc29sZS5sb2coXCJFZGl0b3IgZHJvcHBlZDpcIik7XG5cdFx0Ly8gXHRcdGNvbnNvbGUubG9nKGV2KTtcblx0XHQvLyBcdH0pXG5cdFx0Ly8gKTtcblxuXHRcdC8vIHRoaXMucmVnaXN0ZXJFdmVudChcblx0XHQvLyBcdHRoaXMuYXBwLndvcmtzcGFjZS5vbihcIndpbmRvdy1vcGVuXCIsIChldikgPT4ge1xuXHRcdC8vIFx0XHRjb25zb2xlLmxvZyhcIndpbmRvdyBvcGVuZWQ6XCIpO1xuXHRcdC8vIFx0XHQvLyBjb25zb2xlLmxvZyhldik7XG5cdFx0Ly8gXHR9KVxuXHRcdC8vICk7XG5cblx0XHQvLyB0aGlzLnJlZ2lzdGVyRXZlbnQoXG5cdFx0Ly8gXHR0aGlzLmFwcC53b3Jrc3BhY2Uub24oXCJyZXNpemVcIiwgKCkgPT4ge1xuXHRcdC8vIFx0XHRjb25zb2xlLmxvZyhcInJlc2l6ZVwiKTtcblx0XHQvLyBcdH0pXG5cdFx0Ly8gKTtcblxuXHRcdC8vIHRoaXMucmVnaXN0ZXJFdmVudChcblx0XHQvLyBcdHRoaXMuYXBwLndvcmtzcGFjZS5vbihcImZpbGUtb3BlblwiLCAoZXYpID0+IHtcblx0XHQvLyBcdFx0Y29uc29sZS5sb2coXCJmaWxlIG9wZW5lZDpcIik7XG5cdFx0Ly8gXHRcdC8vIGNvbnNvbGUubG9nKGV2KTtcblx0XHQvLyBcdFx0Ly8gY29uc29sZS5sb2coZ2V0UmVmZXJlbmNlcygpKTtcblxuXHRcdC8vIFx0XHRsZXQgY3VycmVudExlYWY6IGFueSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWFmKCk7XG5cblx0XHQvLyBcdFx0Ly8gY2hlY2sgaXQgcmVmZXJlbmNlcyBoYXZlIGFscmVhZHkgYmVlbiBjcmVhdGVkLCBlbHNlIGNyZWF0ZSByZWZlcmVuY2VzXG5cdFx0Ly8gXHR9KVxuXHRcdC8vICk7XG5cblx0XHQvLyB0aGlzLnJlZ2lzdGVyRXZlbnQoXG5cdFx0Ly8gXHR0aGlzLmFwcC53b3Jrc3BhY2Uub24oXCJsYXlvdXQtY2hhbmdlXCIsICgpID0+IHtcblx0XHQvLyBcdFx0Y29uc29sZS5sb2coXCJsYXlvdXQtY2hhbmdlZDpcIik7XG5cdFx0Ly8gXHR9KVxuXHRcdC8vICk7XG5cdH1cblxuXHRvbnVubG9hZCgpIHt9XG59XG4iLCAiaW1wb3J0IHtcblx0RWRpdG9yU3RhdGUsXG5cdFN0YXRlRmllbGQsXG5cdEFubm90YXRpb24sXG5cdFN0YXRlRWZmZWN0LFxufSBmcm9tIFwiQGNvZGVtaXJyb3Ivc3RhdGVcIjtcbmltcG9ydCB7IEJhY2tsaW5rIH0gZnJvbSBcIi4vdHlwZXNcIjtcbmltcG9ydCB7IHVwZGF0ZUJhY2tsaW5rTWFya1Bvc2l0aW9ucyB9IGZyb20gXCIuL3JlZmVyZW5jZXNcIjtcbmltcG9ydCB7IEFwcCB9IGZyb20gXCJvYnNpZGlhblwiO1xuXG5leHBvcnQgbGV0IHRoYXQgPSBTdGF0ZUZpZWxkLmRlZmluZTxBcHAgfCBudWxsPih7XG5cdGNyZWF0ZSgpIHtcblx0XHRyZXR1cm4gbnVsbDtcblx0fSxcblx0dXBkYXRlKHZhbHVlLCB0cjogYW55KSB7XG5cdFx0aWYgKFxuXHRcdFx0dHJbXCJhbm5vdGF0aW9uc1wiXS5sZW5ndGggPT0gMiAmJlxuXHRcdFx0dHJbXCJhbm5vdGF0aW9uc1wiXVswXS52YWx1ZS50eXBlID09IFwidGhhdFwiXG5cdFx0KSB7XG5cdFx0XHRyZXR1cm4gdHJbXCJhbm5vdGF0aW9uc1wiXVswXS52YWx1ZS50aGF0LmFwcDtcblx0XHR9XG5cdFx0cmV0dXJuIHZhbHVlO1xuXHR9LFxufSk7XG5cbmV4cG9ydCBsZXQgaG92ZXJlZEN1cnNvciA9IFN0YXRlRmllbGQuZGVmaW5lPGFueT4oe1xuXHRjcmVhdGUoKSB7XG5cdFx0cmV0dXJuIG51bGw7XG5cdH0sXG5cdHVwZGF0ZSh2YWx1ZSwgdHI6IGFueSkge1xuXHRcdGlmIChcblx0XHRcdHRyW1wiYW5ub3RhdGlvbnNcIl0ubGVuZ3RoID09IDIgJiZcblx0XHRcdHRyW1wiYW5ub3RhdGlvbnNcIl1bMF0udmFsdWUudHlwZSA9PSBcImhvdmVyZWRDdXJzb3JcIlxuXHRcdCkge1xuXHRcdFx0aWYgKHZhbHVlKVxuXHRcdFx0XHRyZXR1cm4gW1xuXHRcdFx0XHRcdC4uLnZhbHVlLmZpbHRlcihcblx0XHRcdFx0XHRcdChjdXJzb3I6IGFueSkgPT4gY3Vyc29yLnVzZXIgIT0gdHJbXCJhbm5vdGF0aW9uc1wiXVswXS52YWx1ZS51c2VyXG5cdFx0XHRcdFx0KSxcblx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRjdXJzb3I6IHRyW1wiYW5ub3RhdGlvbnNcIl1bMF0udmFsdWUuY3Vyc29yLFxuXHRcdFx0XHRcdFx0dXNlcjogdHJbXCJhbm5vdGF0aW9uc1wiXVswXS52YWx1ZS51c2VyLFxuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdF07XG5cdFx0XHRyZXR1cm4gW1xuXHRcdFx0XHR7XG5cdFx0XHRcdFx0Y3Vyc29yOiB0cltcImFubm90YXRpb25zXCJdWzBdLnZhbHVlLmN1cnNvcixcblx0XHRcdFx0XHR1c2VyOiB0cltcImFubm90YXRpb25zXCJdWzBdLnZhbHVlLnVzZXIsXG5cdFx0XHRcdH0sXG5cdFx0XHRdO1xuXHRcdH0gZWxzZSBpZiAoXG5cdFx0XHR0cltcImFubm90YXRpb25zXCJdLmxlbmd0aCA9PSAyICYmXG5cdFx0XHR0cltcImFubm90YXRpb25zXCJdWzBdLnZhbHVlLnR5cGUgPT0gXCJyZW1vdmVIb3ZlcmVkQ3Vyc29yXCJcblx0XHQpIHtcblx0XHRcdGlmICh2YWx1ZSlcblx0XHRcdFx0cmV0dXJuIHZhbHVlLmZpbHRlcihcblx0XHRcdFx0XHQoY3Vyc29yOiBhbnkpID0+IGN1cnNvci51c2VyICE9IHRyW1wiYW5ub3RhdGlvbnNcIl1bMF0udmFsdWUudXNlclxuXHRcdFx0XHQpO1xuXHRcdFx0cmV0dXJuIHZhbHVlO1xuXHRcdH1cblx0XHRyZXR1cm4gdmFsdWU7XG5cdH0sXG59KTtcblxuZXhwb3J0IGxldCBiYWNrbGlua3MgPSBTdGF0ZUZpZWxkLmRlZmluZTxCYWNrbGlua1tdPih7XG5cdGNyZWF0ZSgpIHtcblx0XHRyZXR1cm4gW107XG5cdH0sXG5cdHVwZGF0ZSh2YWx1ZSwgdHIpIHtcblx0XHQvKlxuXHRcdFx0SSAgd2FudCB0byBnZXQgdGhlIGN1cnJlbnQgYWN0aXZlTGVhZiBhbmQgcmVjb21wdXRlIHRoZSByZWZlcmVuY2VzXG5cdFx0XHRtZXJnZSB0aGlzIGludG8gdGhlIHJlZmVyZW5jZXMgZmllbGRcblx0XHQqL1xuXG5cdFx0aWYgKHRyLmVmZmVjdHMubGVuZ3RoID4gMCkge1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0bGV0IGRhdGE6IHsgdHlwZTogc3RyaW5nOyBiYWNrbGlua3M6IEJhY2tsaW5rW10gfSA9IEpTT04ucGFyc2UoXG5cdFx0XHRcdFx0dHIuZWZmZWN0c1swXS52YWx1ZVxuXHRcdFx0XHQpO1xuXHRcdFx0XHRpZiAoZGF0YS50eXBlID09IFwiYmFja2xpbmtcIikge1xuXHRcdFx0XHRcdGlmIChkYXRhLmJhY2tsaW5rcy5sZW5ndGggPT0gMCkgcmV0dXJuIHZhbHVlO1xuXHRcdFx0XHRcdGxldCByZWZlcmVuY2luZ0xvY2F0aW9uID1cblx0XHRcdFx0XHRcdGRhdGEuYmFja2xpbmtzWzBdW1wicmVmZXJlbmNpbmdMb2NhdGlvblwiXVtcImZpbGVuYW1lXCJdO1xuXHRcdFx0XHRcdGxldCBmaWx0ZXJlZFZhbHVlcyA9IHZhbHVlLmZpbHRlcihcblx0XHRcdFx0XHRcdChiYWNrbGluaykgPT5cblx0XHRcdFx0XHRcdFx0YmFja2xpbmsucmVmZXJlbmNpbmdMb2NhdGlvbi5maWxlbmFtZSAhPSByZWZlcmVuY2luZ0xvY2F0aW9uXG5cdFx0XHRcdFx0KTtcblx0XHRcdFx0XHRyZXR1cm4gWy4uLmZpbHRlcmVkVmFsdWVzLCAuLi5kYXRhLmJhY2tsaW5rc107XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIHZhbHVlO1xuXHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRjb25zb2xlLmxvZyhlKTtcblx0XHRcdFx0cmV0dXJuIHZhbHVlO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gdmFsdWU7XG5cdH0sXG59KTtcblxuZXhwb3J0IGxldCBob3ZlckVsZW1lbnQgPSBTdGF0ZUZpZWxkLmRlZmluZTxvYmplY3QgfCBudWxsPih7XG5cdGNyZWF0ZSgpIHtcblx0XHRyZXR1cm4gbnVsbDtcblx0fSxcblx0dXBkYXRlKHZhbHVlLCB0cikge1xuXHRcdGlmICh0ci5lZmZlY3RzLmxlbmd0aCA+IDApIHtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdGxldCBkYXRhID0gSlNPTi5wYXJzZSh0ci5lZmZlY3RzWzBdLnZhbHVlKTtcblx0XHRcdFx0aWYgKGRhdGEudHlwZSA9PSBcImhvdmVyLXN0YXJ0XCIpIHtcblx0XHRcdFx0XHRyZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgZGF0YSk7XG5cdFx0XHRcdH0gZWxzZSBpZiAoZGF0YS50eXBlID09IFwiaG92ZXJcIikge1xuXHRcdFx0XHRcdGlmICh2YWx1ZSkgcmV0dXJuIE9iamVjdC5hc3NpZ24odmFsdWUsIGRhdGEpO1xuXHRcdFx0XHRcdHJldHVybiBkYXRhO1xuXHRcdFx0XHR9IGVsc2UgaWYgKGRhdGEudHlwZSA9PSBcImhvdmVyLW9mZlwiKSB7XG5cdFx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIHZhbHVlO1xuXHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRjb25zb2xlLmxvZyhlKTtcblx0XHRcdFx0cmV0dXJuIHZhbHVlO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gdmFsdWU7XG5cdH0sXG59KTtcblxuZXhwb3J0IGxldCBiYWNrbGlua0hvdmVyRWxlbWVudCA9IFN0YXRlRmllbGQuZGVmaW5lPG9iamVjdCB8IG51bGw+KHtcblx0Y3JlYXRlKCkge1xuXHRcdHJldHVybiBudWxsO1xuXHR9LFxuXHR1cGRhdGUodmFsdWUsIHRyKSB7XG5cdFx0aWYgKHRyLmVmZmVjdHMubGVuZ3RoID4gMCkge1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0bGV0IGRhdGEgPSBKU09OLnBhcnNlKHRyLmVmZmVjdHNbMF0udmFsdWUpO1xuXHRcdFx0XHRpZiAoZGF0YS50eXBlID09IFwiYmFja2xpbmstc3RhcnRcIikge1xuXHRcdFx0XHRcdHJldHVybiBPYmplY3QuYXNzaWduKHt9LCBkYXRhKTtcblx0XHRcdFx0fSBlbHNlIGlmIChkYXRhLnR5cGUgPT0gXCJiYWNrbGluay11cGRhdGVcIikge1xuXHRcdFx0XHRcdGlmICh2YWx1ZSkgcmV0dXJuIE9iamVjdC5hc3NpZ24odmFsdWUsIGRhdGEpO1xuXHRcdFx0XHRcdHJldHVybiBkYXRhO1xuXHRcdFx0XHR9IGVsc2UgaWYgKGRhdGEudHlwZSA9PSBcImJhY2tsaW5rLW9mZlwiKSB7XG5cdFx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIHZhbHVlO1xuXHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRjb25zb2xlLmxvZyhlKTtcblx0XHRcdFx0cmV0dXJuIHZhbHVlO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gdmFsdWU7XG5cdH0sXG59KTtcblxuZXhwb3J0IGxldCBjdXJzb3JFbGVtZW50ID0gU3RhdGVGaWVsZC5kZWZpbmU8b2JqZWN0IHwgbnVsbD4oe1xuXHRjcmVhdGUoKSB7XG5cdFx0cmV0dXJuIG51bGw7XG5cdH0sXG5cdHVwZGF0ZSh2YWx1ZSwgdHIpIHtcblx0XHRpZiAodHIuZWZmZWN0cy5sZW5ndGggPiAwKSB7XG5cdFx0XHR0cnkge1xuXHRcdFx0XHRsZXQgZGF0YSA9IEpTT04ucGFyc2UodHIuZWZmZWN0c1swXS52YWx1ZSk7XG5cdFx0XHRcdGlmIChkYXRhLnR5cGUgPT0gXCJjdXJzb3Itc3RhcnRcIikge1xuXHRcdFx0XHRcdHJldHVybiB7fTtcblx0XHRcdFx0fSBlbHNlIGlmIChkYXRhLnR5cGUgPT0gXCJjdXJzb3JcIikge1xuXHRcdFx0XHRcdGlmICh2YWx1ZSkgcmV0dXJuIE9iamVjdC5hc3NpZ24odmFsdWUsIGRhdGEpO1xuXHRcdFx0XHRcdHJldHVybiBkYXRhO1xuXHRcdFx0XHR9IGVsc2UgaWYgKGRhdGEudHlwZSA9PSBcImN1cnNvci1vZmZcIikge1xuXHRcdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiB2YWx1ZTtcblx0XHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdFx0Y29uc29sZS5sb2coZSk7XG5cdFx0XHRcdHJldHVybiB2YWx1ZTtcblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIHZhbHVlO1xuXHR9LFxufSk7XG5cbmV4cG9ydCBsZXQgZWRpdG9yQ2hhbmdlID0gU3RhdGVGaWVsZC5kZWZpbmU8bnVsbD4oe1xuXHRjcmVhdGUoKSB7XG5cdFx0cmV0dXJuIG51bGw7XG5cdH0sXG5cdHVwZGF0ZSh2YWx1ZSwgdHIpIHtcblx0XHRpZiAodHIuZWZmZWN0cy5sZW5ndGggPiAwKSB7XG5cdFx0XHR0cnkge1xuXHRcdFx0XHRsZXQgZGF0YSA9IEpTT04ucGFyc2UodHIuZWZmZWN0c1swXS52YWx1ZSk7XG5cdFx0XHRcdGlmIChkYXRhLnR5cGUgPT0gXCJzeW5jXCIpIHtcblx0XHRcdFx0XHR1cGRhdGVCYWNrbGlua01hcmtQb3NpdGlvbnMoKTtcblx0XHRcdFx0XHRyZXR1cm4gdmFsdWU7XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIHZhbHVlO1xuXHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRjb25zb2xlLmxvZyhlKTtcblx0XHRcdFx0cmV0dXJuIHZhbHVlO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gdmFsdWU7XG5cdH0sXG59KTtcblxuZXhwb3J0IGNvbnN0IHRoYXRBbm5vdGF0aW9uID0gQW5ub3RhdGlvbi5kZWZpbmU8YW55PigpO1xuZXhwb3J0IGNvbnN0IGhvdmVyZWRDdXJzb3JBbm5vdGF0aW9uID0gQW5ub3RhdGlvbi5kZWZpbmU8YW55PigpO1xuZXhwb3J0IGNvbnN0IGhvdmVyRWZmZWN0ID0gU3RhdGVFZmZlY3QuZGVmaW5lPHN0cmluZz4oKTtcbmV4cG9ydCBjb25zdCBiYWNrbGlua0hvdmVyRWZmZWN0ID0gU3RhdGVFZmZlY3QuZGVmaW5lPHN0cmluZz4oKTtcbmV4cG9ydCBjb25zdCBjdXJzb3JFZmZlY3QgPSBTdGF0ZUVmZmVjdC5kZWZpbmU8c3RyaW5nPigpO1xuZXhwb3J0IGNvbnN0IGJhY2tsaW5rRWZmZWN0ID0gU3RhdGVFZmZlY3QuZGVmaW5lPHN0cmluZz4oKTtcblxuZXhwb3J0IGxldCBzdGF0ZTogYW55ID0gRWRpdG9yU3RhdGUuY3JlYXRlKHtcblx0ZXh0ZW5zaW9uczogW1xuXHRcdHRoYXQsXG5cdFx0aG92ZXJlZEN1cnNvcixcblx0XHRiYWNrbGlua3MsXG5cdFx0aG92ZXJFbGVtZW50LFxuXHRcdGJhY2tsaW5rSG92ZXJFbGVtZW50LFxuXHRcdGN1cnNvckVsZW1lbnQsXG5cdFx0ZWRpdG9yQ2hhbmdlLFxuXHRdLFxufSk7XG5cbmV4cG9ydCBmdW5jdGlvbiBzeW5jQmFja2xpbmtzKCkge1xuXHRzdGF0ZSA9IHN0YXRlLnVwZGF0ZSh7XG5cdFx0ZWZmZWN0czogYmFja2xpbmtFZmZlY3Qub2YoSlNPTi5zdHJpbmdpZnkoeyB0eXBlOiBcInN5bmNcIiB9KSksXG5cdH0pLnN0YXRlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0VGhhdCgpOiBBcHAge1xuXHRyZXR1cm4gc3RhdGUuZmllbGQodGhhdCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVUaGF0KHRoYXQ6IGFueSkge1xuXHRzdGF0ZSA9IHN0YXRlLnVwZGF0ZSh7XG5cdFx0YW5ub3RhdGlvbnM6IHRoYXRBbm5vdGF0aW9uLm9mKHtcblx0XHRcdHR5cGU6IFwidGhhdFwiLFxuXHRcdFx0dGhhdCxcblx0XHR9KSxcblx0fSkuc3RhdGU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRIb3ZlcmVkQ3Vyc29yKCkge1xuXHRyZXR1cm4gc3RhdGUuZmllbGQoaG92ZXJlZEN1cnNvcik7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVIb3ZlcmVkQ3Vyc29yKGN1cnNvcjogSFRNTE9yU1ZHRWxlbWVudCwgdXNlcjogc3RyaW5nKSB7XG5cdHN0YXRlID0gc3RhdGUudXBkYXRlKHtcblx0XHRhbm5vdGF0aW9uczogaG92ZXJlZEN1cnNvckFubm90YXRpb24ub2Yoe1xuXHRcdFx0dHlwZTogXCJob3ZlcmVkQ3Vyc29yXCIsXG5cdFx0XHRjdXJzb3IsXG5cdFx0XHR1c2VyLFxuXHRcdH0pLFxuXHR9KS5zdGF0ZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZUhvdmVyZWRDdXJzb3IodXNlcjogc3RyaW5nKSB7XG5cdHN0YXRlID0gc3RhdGUudXBkYXRlKHtcblx0XHRhbm5vdGF0aW9uczogaG92ZXJlZEN1cnNvckFubm90YXRpb24ub2Yoe1xuXHRcdFx0dHlwZTogXCJyZW1vdmVIb3ZlcmVkQ3Vyc29yXCIsXG5cdFx0XHR1c2VyLFxuXHRcdH0pLFxuXHR9KS5zdGF0ZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEhvdmVyKCkge1xuXHRyZXR1cm4gc3RhdGUuZmllbGQoaG92ZXJFbGVtZW50KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZUhvdmVyKHZhbHVlOiBvYmplY3QpIHtcblx0c3RhdGUgPSBzdGF0ZS51cGRhdGUoe1xuXHRcdGVmZmVjdHM6IGhvdmVyRWZmZWN0Lm9mKFxuXHRcdFx0SlNPTi5zdHJpbmdpZnkoT2JqZWN0LmFzc2lnbih2YWx1ZSwgeyB0eXBlOiBcImhvdmVyXCIgfSkpXG5cdFx0KSxcblx0fSkuc3RhdGU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZXNldEhvdmVyKCkge1xuXHRzdGF0ZSA9IHN0YXRlLnVwZGF0ZSh7XG5cdFx0ZWZmZWN0czogaG92ZXJFZmZlY3Qub2YoXG5cdFx0XHRKU09OLnN0cmluZ2lmeSh7XG5cdFx0XHRcdHR5cGU6IFwiaG92ZXItb2ZmXCIsXG5cdFx0XHR9KVxuXHRcdCksXG5cdH0pLnN0YXRlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0QmFja2xpbmtIb3ZlcigpIHtcblx0cmV0dXJuIHN0YXRlLmZpZWxkKGJhY2tsaW5rSG92ZXJFbGVtZW50KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZUJhY2tsaW5rSG92ZXIodmFsdWU6IG9iamVjdCkge1xuXHRzdGF0ZSA9IHN0YXRlLnVwZGF0ZSh7XG5cdFx0ZWZmZWN0czogYmFja2xpbmtIb3ZlckVmZmVjdC5vZihcblx0XHRcdEpTT04uc3RyaW5naWZ5KE9iamVjdC5hc3NpZ24odmFsdWUsIHsgdHlwZTogXCJiYWNrbGluay11cGRhdGVcIiB9KSlcblx0XHQpLFxuXHR9KS5zdGF0ZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlc2V0QmFja2xpbmtIb3ZlcigpIHtcblx0c3RhdGUgPSBzdGF0ZS51cGRhdGUoe1xuXHRcdGVmZmVjdHM6IGJhY2tsaW5rSG92ZXJFZmZlY3Qub2YoXG5cdFx0XHRKU09OLnN0cmluZ2lmeSh7XG5cdFx0XHRcdHR5cGU6IFwiYmFja2xpbmstb2ZmXCIsXG5cdFx0XHR9KVxuXHRcdCksXG5cdH0pLnN0YXRlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q3Vyc29yKCkge1xuXHRyZXR1cm4gc3RhdGUuZmllbGQoY3Vyc29yRWxlbWVudCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVDdXJzb3IodmFsdWU6IG9iamVjdCkge1xuXHRzdGF0ZSA9IHN0YXRlLnVwZGF0ZSh7XG5cdFx0ZWZmZWN0czogY3Vyc29yRWZmZWN0Lm9mKFxuXHRcdFx0SlNPTi5zdHJpbmdpZnkoT2JqZWN0LmFzc2lnbih2YWx1ZSwgeyB0eXBlOiBcImN1cnNvclwiIH0pKVxuXHRcdCksXG5cdH0pLnN0YXRlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVzZXRDdXJzb3IoKSB7XG5cdHN0YXRlID0gc3RhdGUudXBkYXRlKHtcblx0XHRlZmZlY3RzOiBjdXJzb3JFZmZlY3Qub2YoXG5cdFx0XHRKU09OLnN0cmluZ2lmeSh7XG5cdFx0XHRcdHR5cGU6IFwiY3Vyc29yLW9mZlwiLFxuXHRcdFx0fSlcblx0XHQpLFxuXHR9KS5zdGF0ZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEJhY2tsaW5rcygpOiBCYWNrbGlua1tdIHtcblx0cmV0dXJuIHN0YXRlLmZpZWxkKGJhY2tsaW5rcyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVCYWNrbGlua3ModmFsdWU6IEJhY2tsaW5rW10pIHtcblx0c3RhdGUgPSBzdGF0ZS51cGRhdGUoe1xuXHRcdGVmZmVjdHM6IGJhY2tsaW5rRWZmZWN0Lm9mKFxuXHRcdFx0SlNPTi5zdHJpbmdpZnkoT2JqZWN0LmFzc2lnbih7IGJhY2tsaW5rczogdmFsdWUgfSwgeyB0eXBlOiBcImJhY2tsaW5rXCIgfSkpXG5cdFx0KSxcblx0fSkuc3RhdGU7XG59XG4iLCAiaW1wb3J0IHsgRWRpdG9yLCBURmlsZSwgV29ya3NwYWNlTGVhZiwgTWFya2Rvd25WaWV3IH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBFZGl0b3JWaWV3IH0gZnJvbSBcIkBjb2RlbWlycm9yL3ZpZXdcIjtcbmltcG9ydCB7IHY1IGFzIHV1aWR2NSB9IGZyb20gXCJ1dWlkXCI7XG5cbmltcG9ydCB7XG5cdHN0YXRlLFxuXHR1cGRhdGVIb3Zlcixcblx0Z2V0VGhhdCxcblx0Z2V0QmFja2xpbmtzLFxuXHR1cGRhdGVCYWNrbGlua3MsXG5cdHVwZGF0ZUN1cnNvcixcblx0Z2V0Q3Vyc29yLFxuXHRnZXRIb3Zlcixcblx0cmVzZXRDdXJzb3IsXG5cdHVwZGF0ZUhvdmVyZWRDdXJzb3IsXG5cdHVwZGF0ZUJhY2tsaW5rSG92ZXIsXG5cdGdldEJhY2tsaW5rSG92ZXIsXG59IGZyb20gXCIuL3N0YXRlXCI7XG5pbXBvcnQge1xuXHRwcm9jZXNzVVJJLFxuXHRnZXRQcmVmaXhBbmRTdWZmaXgsXG5cdGhhbmRsZVJlbW92ZUhvdmVyZWRDdXJzb3IsXG5cdGNoZWNrRm9jdXNDdXJzb3IsXG59IGZyb20gXCIuL3V0aWxzXCI7XG5pbXBvcnQge1xuXHRBQ1RJT05fVFlQRSxcblx0UE9SVEFMX1RFWFRfU0xJQ0VfU0laRSxcblx0UkVGRVJFTkNFX0lDT05fSEVJR0hULFxuXHRSRUZFUkVOQ0VfUkVHRVgsXG5cdFNWR19IT1ZFUl9DT0xPUixcblx0U1ZHX0hPVkVSX0NPTE9SX0xJR0hULFxufSBmcm9tIFwiLi9jb25zdGFudHNcIjtcbmltcG9ydCB7IGNvbGxlY3RMZWF2ZXNCeVRhYkhlbHBlciB9IGZyb20gXCIuL3dvcmtzcGFjZVwiO1xuaW1wb3J0IHsgRG9jdW1lbnRMb2NhdGlvbiwgQmFja2xpbmsgfSBmcm9tIFwiLi90eXBlc1wiO1xuaW1wb3J0IHsgZW5kUmVmZXJlbmNlQ3Vyc29yRWZmZWN0IH0gZnJvbSBcIi4vZWZmZWN0c1wiO1xuaW1wb3J0IHsgY3JlYXRlIH0gZnJvbSBcImRvbWFpblwiO1xuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlUmVmZXJlbmNlSWNvbihwb3J0YWxUZXh0OiBzdHJpbmcgfCBudWxsID0gbnVsbCk6IHtcblx0c3BhbjogSFRNTFNwYW5FbGVtZW50O1xuXHRzdmc6IFNWR0VsZW1lbnQ7XG59IHtcblx0Y29uc3Qgc3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO1xuXHRzcGFuLnN0eWxlLmN1cnNvciA9IFwicG9pbnRlclwiO1xuXG5cdGNvbnN0IGhlaWdodCA9IFJFRkVSRU5DRV9JQ09OX0hFSUdIVDtcblx0Y29uc3Qgd2lkdGggPSBoZWlnaHQgKiAwLjk7XG5cblx0aWYgKHBvcnRhbFRleHQgPT0gbnVsbCkge1xuXHRcdGNvbnN0IHN2ZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyhcImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIsIFwic3ZnXCIpO1xuXHRcdHN2Zy5zZXRBdHRyaWJ1dGUoXCJ3aWR0aFwiLCBgJHt3aWR0aH1gKTtcblx0XHRzdmcuc2V0QXR0cmlidXRlKFwiaGVpZ2h0XCIsIGAke2hlaWdodH1gKTtcblx0XHRzdmcuc2V0QXR0cmlidXRlKFwidmlld0JveFwiLCBgMCAwICR7d2lkdGh9ICR7aGVpZ2h0fWApO1xuXHRcdHN2Zy5zZXRBdHRyaWJ1dGUoXCJmaWxsXCIsIFwid2hpdGVcIik7XG5cdFx0c3ZnLnNldEF0dHJpYnV0ZShcInhtbG5zXCIsIFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIik7XG5cdFx0c3ZnLnN0eWxlLmJvcmRlciA9IFwiM3B4IHNvbGlkIGdyZXlcIjtcblx0XHRzdmcuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCJ3aGl0ZVwiO1xuXHRcdHN2Zy5zdHlsZS5ib3JkZXJSYWRpdXMgPSBcIjNweFwiO1xuXHRcdHN2Zy5zdHlsZS5jdXJzb3IgPSBcInBvaW50ZXJcIjtcblx0XHRzdmcuY2xhc3NMaXN0LmFkZChcInJlZmVyZW5jZS1pY29uXCIpO1xuXG5cdFx0Y29uc3QgbGluZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyhcImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIsIFwibGluZVwiKTtcblx0XHRsaW5lLnNldEF0dHJpYnV0ZShcIngxXCIsIFwiM1wiKTtcblx0XHRsaW5lLnNldEF0dHJpYnV0ZShcInkxXCIsIGAkeyhoZWlnaHQgLSAzKSAvIDN9YCk7XG5cdFx0bGluZS5zZXRBdHRyaWJ1dGUoXCJ4MlwiLCBcIjEyXCIpO1xuXHRcdGxpbmUuc2V0QXR0cmlidXRlKFwieTJcIiwgYCR7KGhlaWdodCAtIDMpIC8gM31gKTtcblx0XHRsaW5lLnNldEF0dHJpYnV0ZShcInN0cm9rZS13aWR0aFwiLCBcIjJcIik7IC8vIFNldCB0aGUgc3Ryb2tlIHdlaWdodCB0byAxXG5cdFx0bGluZS5zZXRBdHRyaWJ1dGUoXCJzdHJva2VcIiwgXCJncmV5XCIpOyAvLyBTZXQgdGhlIHN0cm9rZSBjb2xvciB0byBibGFja1xuXG5cdFx0c3ZnLmFwcGVuZENoaWxkKGxpbmUpO1xuXG5cdFx0Y29uc3QgbGluZTIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoXG5cdFx0XHRcImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIsXG5cdFx0XHRcImxpbmVcIlxuXHRcdCk7XG5cdFx0bGluZTIuc2V0QXR0cmlidXRlKFwieDFcIiwgXCIzXCIpO1xuXHRcdGxpbmUyLnNldEF0dHJpYnV0ZShcInkxXCIsIGAkeygoaGVpZ2h0IC0gMykgLyAzKSAqIDJ9YCk7XG5cdFx0bGluZTIuc2V0QXR0cmlidXRlKFwieDJcIiwgXCIxNVwiKTtcblx0XHRsaW5lMi5zZXRBdHRyaWJ1dGUoXCJ5MlwiLCBgJHsoKGhlaWdodCAtIDMpIC8gMykgKiAyfWApO1xuXHRcdGxpbmUyLnNldEF0dHJpYnV0ZShcInN0cm9rZS13aWR0aFwiLCBcIjJcIik7IC8vIFNldCB0aGUgc3Ryb2tlIHdlaWdodCB0byAxXG5cdFx0bGluZTIuc2V0QXR0cmlidXRlKFwic3Ryb2tlXCIsIFwiZ3JleVwiKTsgLy8gU2V0IHRoZSBzdHJva2UgY29sb3IgdG8gYmxhY2tcblxuXHRcdHN2Zy5hcHBlbmRDaGlsZChsaW5lMik7XG5cblx0XHRjb25zdCBsaW5lMyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyhcblx0XHRcdFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIixcblx0XHRcdFwibGluZVwiXG5cdFx0KTtcblx0XHRsaW5lMy5zZXRBdHRyaWJ1dGUoXCJ4MVwiLCBcIjNcIik7XG5cdFx0bGluZTMuc2V0QXR0cmlidXRlKFwieTFcIiwgYCR7KChoZWlnaHQgLSAzKSAvIDMpICogM31gKTtcblx0XHRsaW5lMy5zZXRBdHRyaWJ1dGUoXCJ4MlwiLCBcIjEwXCIpO1xuXHRcdGxpbmUzLnNldEF0dHJpYnV0ZShcInkyXCIsIGAkeygoaGVpZ2h0IC0gMykgLyAzKSAqIDN9YCk7XG5cdFx0bGluZTMuc2V0QXR0cmlidXRlKFwic3Ryb2tlLXdpZHRoXCIsIFwiMlwiKTsgLy8gU2V0IHRoZSBzdHJva2Ugd2VpZ2h0IHRvIDFcblx0XHRsaW5lMy5zZXRBdHRyaWJ1dGUoXCJzdHJva2VcIiwgXCJncmV5XCIpOyAvLyBTZXQgdGhlIHN0cm9rZSBjb2xvciB0byBibGFja1xuXG5cdFx0c3ZnLmFwcGVuZENoaWxkKGxpbmUzKTtcblxuXHRcdHNwYW4uYXBwZW5kQ2hpbGQoc3ZnKTtcblx0XHRyZXR1cm4geyBzcGFuOiBzcGFuLCBzdmcgfTtcblx0fVxuXG5cdGNvbnN0IHN2ZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyhcImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIsIFwic3ZnXCIpO1xuXHRzdmcuc2V0QXR0cmlidXRlKFwid2lkdGhcIiwgYCR7d2lkdGh9YCk7XG5cdHN2Zy5zZXRBdHRyaWJ1dGUoXCJoZWlnaHRcIiwgYCR7aGVpZ2h0fWApO1xuXHRzdmcuc2V0QXR0cmlidXRlKFwidmlld0JveFwiLCBgMCAwICR7d2lkdGh9ICR7aGVpZ2h0fWApO1xuXHRzdmcuc2V0QXR0cmlidXRlKFwiZmlsbFwiLCBcIndoaXRlXCIpO1xuXHRzdmcuc2V0QXR0cmlidXRlKFwieG1sbnNcIiwgXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiKTtcblx0Ly8gc3ZnLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwid2hpdGVcIjtcblx0c3ZnLmNsYXNzTGlzdC5hZGQoXCJwb3J0YWwtaWNvblwiKTtcblxuXHQvLyA8cGF0aCBkPVwiTTQgNkgxM000IDEwSDE0TTMuOTk2NDMgMS4wMDAzN0M3LjA4NTMgMC45OTk5MjMgMTEuMTYxOCAwLjk5OTg4MSAxNC4wMDQzIDEuMDAwMjVDMTUuNjYwMyAxLjAwMDQ2IDE3IDIuMzQzMTUgMTcgMy45OTkyM1YxMS4zNjAxQzE3IDEyLjk5NTEgMTUuNjkwOSAxNC4zMjc2IDE0LjA1NjMgMTQuMzU4Mkw3LjM0MzAxIDE0LjQ4NDJDNi43OTE2OCAxNC40OTQ1IDYuMjUzODcgMTQuNjU2NiA1Ljc4ODY2IDE0Ljk1MjdMMi41MzY4OCAxNy4wMjJDMS44NzExNSAxNy40NDU2IDEgMTYuOTY3NCAxIDE2LjE3ODNWMy45OTk5M0MxIDIuMzQzNTEgMi4zNDAwMSAxLjAwMDYgMy45OTY0MyAxLjAwMDM3WlwiIHN0cm9rZT1cImJsYWNrXCIgc3Ryb2tlLXdpZHRoPVwiMlwiLz5cblx0Y29uc3QgcGF0aCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyhcImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIsIFwicGF0aFwiKTtcblx0cGF0aC5zZXRBdHRyaWJ1dGUoXG5cdFx0XCJkXCIsXG5cdFx0XCJNNCA2SDEzTTQgMTBIMTRNMy45OTY0MyAxLjAwMDM3QzcuMDg1MyAwLjk5OTkyMyAxMS4xNjE4IDAuOTk5ODgxIDE0LjAwNDMgMS4wMDAyNUMxNS42NjAzIDEuMDAwNDYgMTcgMi4zNDMxNSAxNyAzLjk5OTIzVjExLjM2MDFDMTcgMTIuOTk1MSAxNS42OTA5IDE0LjMyNzYgMTQuMDU2MyAxNC4zNTgyTDcuMzQzMDEgMTQuNDg0MkM2Ljc5MTY4IDE0LjQ5NDUgNi4yNTM4NyAxNC42NTY2IDUuNzg4NjYgMTQuOTUyN0wyLjUzNjg4IDE3LjAyMkMxLjg3MTE1IDE3LjQ0NTYgMSAxNi45Njc0IDEgMTYuMTc4M1YzLjk5OTkzQzEgMi4zNDM1MSAyLjM0MDAxIDEuMDAwNiAzLjk5NjQzIDEuMDAwMzdaXCJcblx0KTtcblx0cGF0aC5zZXRBdHRyaWJ1dGUoXCJzdHJva2VcIiwgXCJncmF5XCIpO1xuXHRwYXRoLnNldEF0dHJpYnV0ZShcInN0cm9rZS13aWR0aFwiLCBcIjJcIik7XG5cblx0c3Bhbi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIlwiO1xuXG5cdHN2Zy5hcHBlbmRDaGlsZChwYXRoKTtcblxuXHRzcGFuLmFwcGVuZENoaWxkKHN2Zyk7XG5cblx0aWYgKHBvcnRhbFRleHQgIT0gXCJpbmxpbmUgcmVmZXJlbmNlIHdpZGdldCB8KnxcIikge1xuXHRcdGxldCBwb3J0YWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXHRcdHBvcnRhbC5zdHlsZS5jb2xvciA9IFwiYmxhY2tcIjtcblx0XHRwb3J0YWwuY2xhc3NMaXN0LmFkZChcInBvcnRhbFwiKTtcblx0XHRwb3J0YWwuaW5uZXJIVE1MID0gcG9ydGFsVGV4dDtcblx0XHQvLyBzcGFuLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwid2hpdGVcIjtcblx0XHRwb3J0YWwuc3R5bGUudXNlclNlbGVjdCA9IFwibm9uZVwiO1xuXHRcdHBvcnRhbC5zdHlsZS5wb2ludGVyRXZlbnRzID0gXCJub25lXCI7XG5cdFx0c3Bhbi5hcHBlbmRDaGlsZChwb3J0YWwpO1xuXHR9XG5cblx0cmV0dXJuIHsgc3Bhbjogc3Bhbiwgc3ZnIH07XG5cblx0Ly8gbGV0IG5ld1NwYW46IEhUTUxTcGFuRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO1xuXHQvLyBuZXdTcGFuLmlubmVySFRNTCA9IFwiXHVEODNEXHVEQ0M0XCI7XG5cdC8vIG5ld1NwYW4uc3R5bGUuY3Vyc29yID0gXCJwb2ludGVyXCI7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVIb3ZlcmVkQ3Vyc29yQ29sb3Ioc3BhbjogSFRNTFNwYW5FbGVtZW50LCB1c2VyOiBzdHJpbmcpIHtcblx0Ly8gcmVtb3ZlIGV4aXN0aW5nIGN1cnNvcnNcblx0Y29uc3Qgc3ZnID0gc3Bhbi5xdWVyeVNlbGVjdG9yKFwic3ZnXCIpO1xuXHRjb25zdCBwb3J0YWw6IEhUTUxFbGVtZW50IHwgbnVsbCA9IHNwYW4ucXVlcnlTZWxlY3RvcihcIi5wb3J0YWxcIik7XG5cblx0aWYgKHN2ZyAmJiAhcG9ydGFsKSB7XG5cdFx0aGFuZGxlUmVtb3ZlSG92ZXJlZEN1cnNvcih1c2VyKTsgLy8gcmVtb3ZlIGFueSBleGlzdGluZyBob3ZlcmVkIHJlZmVyZW5jZSBpY29uXG5cdFx0aWYgKHN2Zy5jbGFzc0xpc3QuY29udGFpbnMoXCJyZWZlcmVuY2UtaWNvblwiKSlcblx0XHRcdHN2Zy5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBTVkdfSE9WRVJfQ09MT1I7XG5cdFx0ZWxzZSBzdmcuc2V0QXR0cmlidXRlKFwiZmlsbFwiLCBTVkdfSE9WRVJfQ09MT1IpO1xuXG5cdFx0dXBkYXRlSG92ZXJlZEN1cnNvcihzdmcsIHVzZXIpOyAvLyBhZGQgdGhlIGN1cnJlbnRseSBob3ZlcmVkIHJlZmVyZW5jZSBpY29uXG5cdH1cbn1cblxuZnVuY3Rpb24gZ2V0Q29kZU1pcnJvckVkaXRvclZpZXcoZWRpdG9yOiBFZGl0b3IpOiBFZGl0b3JWaWV3IHtcblx0Ly8gQHRzLWlnbm9yZSB0aGlzIHR5cGUgaXMgbWlzc2luZy4uLiBidXQgdGhlIE9ic2lkaWFuIGRvY3MgdGVsbCB1cyB0byBkbyBpdCB0aGlzIHdheT8/XG5cdHJldHVybiBlZGl0b3IuY20gYXMgRWRpdG9yVmlldztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldENvbnRhaW5lckVsZW1lbnQoXG5cdGVkaXRvck9yTGVhZjogRWRpdG9yIHwgV29ya3NwYWNlTGVhZlxuKTogSFRNTEVsZW1lbnQge1xuXHQvLyBAdHMtaWdub3JlIFRPRE86IGZpbmQgYSBiZXR0ZXIgd2F5IHRvIGFjY2VzcyB0aGlzLi4uIEVYVFJFTUVMWSBTS0VUQ0hZXG5cdHJldHVybiBlZGl0b3JPckxlYWYuY29udGFpbmVyRWw7XG59XG5cbmZ1bmN0aW9uIGdldEJhY2tsaW5rSUQoYmFja2xpbms6IEJhY2tsaW5rKTogc3RyaW5nIHtcblx0Y29uc3QganNvblN0cmluZyA9IEpTT04uc3RyaW5naWZ5KGJhY2tsaW5rKTtcblx0Y29uc3QgaWQgPSB1dWlkdjUoanNvblN0cmluZywgXCJmYjgxM2ViYi0xYjUzLTQzMDYtYWE5Yy02NTU2Mjc0NDdmMGJcIik7XG5cdHJldHVybiBgYmFja2xpbmstJHtpZH1gO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0QmFja2xpbmtDb250YWluZXIoZWRpdG9yOiBFZGl0b3IpOiBIVE1MRWxlbWVudCB7XG5cdGNvbnN0IGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCA9IGdldENvbnRhaW5lckVsZW1lbnQoZWRpdG9yKTtcblx0Y29uc3QgcmVmZXJlbmNlTWFya0NvbnRhaW5lcklEID0gXCJyZWZlcmVuY2VNYXJrQ29udGFpbmVyXCI7XG5cdGNvbnN0IGNvbnRhaW5lciA9IGNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoYCMke3JlZmVyZW5jZU1hcmtDb250YWluZXJJRH1gKTtcblx0aWYgKGNvbnRhaW5lcikge1xuXHRcdHJldHVybiBjb250YWluZXIgYXMgSFRNTEVsZW1lbnQ7XG5cdH0gZWxzZSB7XG5cdFx0Y29uc3QgbmV3Q29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0XHRuZXdDb250YWluZXIuaWQgPSByZWZlcmVuY2VNYXJrQ29udGFpbmVySUQ7XG5cdFx0Y29udGFpbmVyRWwucXVlcnlTZWxlY3RvcihcIi5jbS1zY3JvbGxlclwiKSEuYXBwZW5kQ2hpbGQobmV3Q29udGFpbmVyKTtcblx0XHRyZXR1cm4gbmV3Q29udGFpbmVyO1xuXHR9XG59XG5cbmZ1bmN0aW9uIGdldFJlZmVyZW5jZU1hcmtzKGVkaXRvcjogRWRpdG9yKTogSFRNTEVsZW1lbnRbXSB7XG5cdGNvbnN0IGNvbnRhaW5lciA9IGdldEJhY2tsaW5rQ29udGFpbmVyKGVkaXRvcik7XG5cdGNvbnN0IGVsZW1lbnRzOiBIVE1MRWxlbWVudFtdID0gW107XG5cdGZvciAobGV0IGkgPSAwOyBpIDwgY29udGFpbmVyLmNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG5cdFx0ZWxlbWVudHMucHVzaChjb250YWluZXIuY2hpbGRyZW4uaXRlbShpKSBhcyBIVE1MRWxlbWVudCk7XG5cdH1cblx0cmV0dXJuIGVsZW1lbnRzO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0TGVhZkJCb3hFbGVtZW50cyhsZWFmOiBXb3Jrc3BhY2VMZWFmKSB7XG5cdGNvbnN0IHRpdGxlID0gZ2V0Q29udGFpbmVyRWxlbWVudChsZWFmKS5xdWVyeVNlbGVjdG9yKFwiLmlubGluZS10aXRsZVwiKTtcblx0aWYgKCF0aXRsZSkge1xuXHRcdHRocm93IG5ldyBFcnJvcihcIk1pc3NpbmcgdGl0bGVcIik7XG5cdH1cblx0Y29uc3QgdGl0bGVCYm94ID0gdGl0bGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cdGNvbnN0IGxpbmUgPSBnZXRDb250YWluZXJFbGVtZW50KGxlYWYpLnF1ZXJ5U2VsZWN0b3IoXCIuY20tbGluZVwiKTtcblx0aWYgKCFsaW5lKSB7XG5cdFx0dGhyb3cgbmV3IEVycm9yKFwiRG9jdW1lbnQgaGFzIG5vIGxpbmVzXCIpO1xuXHR9XG5cdGNvbnN0IGxpbmVCYm94ID0gbGluZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblxuXHRyZXR1cm4geyB0aXRsZUJib3gsIGxpbmVCYm94IH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVCYWNrbGlua01hcmtQb3NpdGlvbihcblx0bGVhZjogV29ya3NwYWNlTGVhZixcblx0YmFja2xpbmtzVG9MZWFmOiBCYWNrbGlua1tdLFxuXHRzaG93UG9ydGFsczogYm9vbGVhblxuKSB7XG5cdGNvbnN0IGVkaXRvciA9IGdldE1hcmtkb3duVmlldyhsZWFmKS5lZGl0b3I7XG5cdGNvbnN0IGJhY2tsaW5rQ29udGFpbmVyID0gZ2V0QmFja2xpbmtDb250YWluZXIoZWRpdG9yKTtcblxuXHRsZXQgYmFja2xpbmtzID0gW107XG5cdGZvciAobGV0IGkgPSAwOyBpIDwgYmFja2xpbmtDb250YWluZXIuY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcblx0XHRiYWNrbGlua3MucHVzaChiYWNrbGlua0NvbnRhaW5lci5jaGlsZHJlbi5pdGVtKGkpIGFzIEhUTUxFbGVtZW50KTtcblx0fVxuXHRsZXQgYmFja2xpbmtJZHM6IHN0cmluZ1tdID0gYmFja2xpbmtzVG9MZWFmLm1hcCgoeCkgPT4gZ2V0QmFja2xpbmtJRCh4KSk7XG5cblx0YmFja2xpbmtzXG5cdFx0Lm1hcCgoeDogSFRNTFNwYW5FbGVtZW50KSA9PiB4LmlkKVxuXHRcdC5mb3JFYWNoKChpZCkgPT4ge1xuXHRcdFx0aWYgKCFiYWNrbGlua0lkcy5pbmNsdWRlcyhpZCkpIHtcblx0XHRcdFx0bGV0IGVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7XG5cdFx0XHRcdGlmIChlbGVtZW50KSBlbGVtZW50LnJlbW92ZSgpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdGNvbnN0IHsgdGl0bGVCYm94LCBsaW5lQmJveCB9ID0gZ2V0TGVhZkJCb3hFbGVtZW50cyhsZWFmKTtcblxuXHRsZXQgcmVmZXJlbmNlTWFya2VycyA9IGJhY2tsaW5rc1RvTGVhZi5tYXAoKGJhY2tsaW5rKSA9PiB7XG5cdFx0Y29uc3QgeyBmcm9tIH0gPSBiYWNrbGluay5yZWZlcmVuY2VkTG9jYXRpb247XG5cblx0XHRjb25zdCBiYm94ID0gZ2V0Q29kZU1pcnJvckVkaXRvclZpZXcoZWRpdG9yKS5jb29yZHNBdFBvcyhmcm9tKTtcblx0XHRpZiAoIWJib3gpIHJldHVybjtcblxuXHRcdGxldCByZWZlcmVuY2VNYXJrZXIgPSBiYWNrbGlua0NvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFxuXHRcdFx0YCMke2dldEJhY2tsaW5rSUQoYmFja2xpbmspfWBcblx0XHQpIGFzIEhUTUxFbGVtZW50IHwgbnVsbDtcblxuXHRcdGlmIChyZWZlcmVuY2VNYXJrZXIgPT09IG51bGwpIHtcblx0XHRcdHJlZmVyZW5jZU1hcmtlciA9IGNyZWF0ZUJhY2tsaW5rTWFyayhiYWNrbGluayk7XG5cdFx0XHRiYWNrbGlua0NvbnRhaW5lci5hcHBlbmRDaGlsZChyZWZlcmVuY2VNYXJrZXIpO1xuXHRcdH1cblxuXHRcdGlmIChiYm94KSB7XG5cdFx0XHRyZWZlcmVuY2VNYXJrZXIuc3R5bGUucG9zaXRpb24gPSBcImFic29sdXRlXCI7XG5cblx0XHRcdHJlZmVyZW5jZU1hcmtlci5zZXRBdHRyaWJ1dGUoXCJ0b3BcIiwgYmJveC50b3AudG9TdHJpbmcoKSk7XG5cdFx0XHRyZWZlcmVuY2VNYXJrZXIuc3R5bGUudG9wID0gYmJveC50b3AgLSB0aXRsZUJib3gudG9wICsgMzIgKyBcInB4XCI7XG5cdFx0XHRyZWZlcmVuY2VNYXJrZXIuc3R5bGUubGVmdCA9IGxpbmVCYm94LndpZHRoICsgNDAgKyBcInB4XCI7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHJlZmVyZW5jZU1hcmtlcjtcblx0fSk7XG5cblx0bGV0IGxhc3RZQm90dG9tID0gLUluZmluaXR5OyAvLyBmb3IgbGFyZ2UgZG9jdW1lbnRzIFx1RDgzRFx1REUwMVxuXHRsZXQgbWFyZ2luID0gNDtcblx0cmVmZXJlbmNlTWFya2Vyc1xuXHRcdC5zb3J0KFxuXHRcdFx0KGEsIGIpID0+XG5cdFx0XHRcdHBhcnNlSW50KGEhLmdldEF0dHJpYnV0ZShcInRvcFwiKSEpIC0gcGFyc2VJbnQoYiEuZ2V0QXR0cmlidXRlKFwidG9wXCIpISlcblx0XHQpXG5cdFx0LmZvckVhY2goKG1hcmtlcikgPT4ge1xuXHRcdFx0aWYgKCFtYXJrZXIpIHJldHVybjtcblx0XHRcdC8vIHRvZ2dsZSBwb3J0YWxzXG5cdFx0XHRjb25zdCBwb3J0YWw6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG1hcmtlci5xdWVyeVNlbGVjdG9yKFwiLnBvcnRhbFwiKTtcblx0XHRcdGNvbnN0IHN2ZyA9IG1hcmtlci5xdWVyeVNlbGVjdG9yKFwic3ZnXCIpO1xuXHRcdFx0aWYgKHNob3dQb3J0YWxzKSB7XG5cdFx0XHRcdGlmIChzdmcgJiYgIXBvcnRhbCkgc3ZnLnN0eWxlLmRpc3BsYXkgPSBcImlubGluZVwiO1xuXHRcdFx0XHRlbHNlIGlmIChzdmcpIHN2Zy5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG5cblx0XHRcdFx0aWYgKHBvcnRhbCkge1xuXHRcdFx0XHRcdHBvcnRhbC5zdHlsZS5kaXNwbGF5ID0gXCJpbmxpbmVcIjtcblx0XHRcdFx0XHRtYXJrZXIuc3R5bGUuYm9yZGVyID0gXCIzcHggc29saWQgZ3JleVwiO1xuXHRcdFx0XHRcdG1hcmtlci5zdHlsZS5wYWRkaW5nID0gXCIzcHhcIjtcblx0XHRcdFx0XHRtYXJrZXIuc3R5bGUuYm9yZGVyUmFkaXVzID0gXCIzcHhcIjtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0aWYgKHN2Zykgc3ZnLnN0eWxlLmRpc3BsYXkgPSBcImlubGluZVwiO1xuXHRcdFx0XHRpZiAocG9ydGFsKSB7XG5cdFx0XHRcdFx0cG9ydGFsLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcblx0XHRcdFx0XHRtYXJrZXIuc3R5bGUuYm9yZGVyID0gXCJub25lXCI7XG5cdFx0XHRcdFx0bWFya2VyLnN0eWxlLnBhZGRpbmcgPSBcIjBweFwiO1xuXHRcdFx0XHRcdG1hcmtlci5zdHlsZS5ib3JkZXJSYWRpdXMgPSBcIjBweFwiO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHQvLyBnZXQgcG9zaXRpb25pbmdcblx0XHRcdGxldCB0b3AgPSBwYXJzZUludChtYXJrZXIhLmdldEF0dHJpYnV0ZShcInRvcFwiKSEpO1xuXHRcdFx0dG9wID0gTWF0aC5tYXgodG9wLCBsYXN0WUJvdHRvbSArIG1hcmdpbik7XG5cdFx0XHRsYXN0WUJvdHRvbSA9IHRvcCArIG1hcmtlci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHQgKyBtYXJnaW47XG5cdFx0XHRtYXJrZXIuc2V0QXR0cmlidXRlKFwidG9wXCIsIHRvcC50b1N0cmluZygpKTtcblx0XHRcdG1hcmtlci5zdHlsZS50b3AgPSB0b3AgLSB0aXRsZUJib3gudG9wICsgMzIgKyBcInB4XCI7XG5cdFx0XHRtYXJrZXIuc3R5bGUubGVmdCA9IGxpbmVCYm94LndpZHRoICsgNDAgKyBcInB4XCI7XG5cdFx0fSk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVCYWNrbGlua01hcmtQb3NpdGlvbnMoKSB7XG5cdGNvbnN0IGxlYXZlcyA9IGdldFRoYXQoKS53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFxuXHRcdFwibWFya2Rvd25cIlxuXHQpIGFzIFdvcmtzcGFjZUxlYWZbXTtcblxuXHRzZXRUaW1lb3V0KGFzeW5jICgpID0+IHtcblx0XHRjb25zdCBhbGxCYWNrbGlua3M6IEJhY2tsaW5rW10gPSBhd2FpdCByZWNvbXB1dGVSZWZlcmVuY2VzRm9yUGFnZSgpO1xuXG5cdFx0bGVhdmVzLmZvckVhY2goKGxlYWYpID0+IHtcblx0XHRcdGNvbnN0IGJhY2tsaW5rc1RvTGVhZiA9IGFsbEJhY2tsaW5rcy5maWx0ZXIoXG5cdFx0XHRcdC8vIEB0cy1pZ25vcmVcblx0XHRcdFx0KGIpID0+IGIucmVmZXJlbmNlZExvY2F0aW9uLmZpbGVuYW1lID09IGxlYWYudmlldy5maWxlLnBhdGhcblx0XHRcdCk7XG5cdFx0XHQvLyB3aWR0aCA5MDAsIHNob3cgdGhlIHJlZmVyZW5jZVxuXHRcdFx0Y29uc3Qgc2hvd1BvcnRhbHMgPSBnZXRDb250YWluZXJFbGVtZW50KGxlYWYpLmlubmVyV2lkdGggPiA5MDA7XG5cdFx0XHR1cGRhdGVCYWNrbGlua01hcmtQb3NpdGlvbihsZWFmLCBiYWNrbGlua3NUb0xlYWYsIHNob3dQb3J0YWxzKTtcblx0XHR9KTtcblx0fSwgNTAwKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUJhY2tsaW5rTWFyayhiYWNrbGluazogQmFja2xpbmspOiBIVE1MRWxlbWVudCB7XG5cdC8vIEFuZHkncyBub3RlcyBvbiBsYXlpbmcgb3V0IHRoZSByZWZlcmVuY2VzIHNvIHRoYXQgdGhleSBkb24ndCBjb2xsaWRlXG5cdC8vIDEuIGluIHRoaXMgZnVuY3Rpb24sIHN0b3JlIHRoZSBiYm94LnRvcCBpbiBhbiBhdHRyaWJ1dGUgc28gdGhhdCB5b3UgY2FuIHVzZSBpdCBsYXRlclxuXHQvLyAyLiBzZXBhcmF0ZWx5LCBkbyBhIGdsb2JhbCBsYXlvdXQgcGFzcyB3aGVuZXZlciB0aGUgZ2VvbWV0cnkgY2hhbmdlcyBvciBhbHNvIG9uIGVkaXRzIChXaXRoIGRlYm91bmNlKVxuXHQvLyAgICBpbiB0aGF0IGdsb2JhbCBsYXlvdXQgcGFzcywgc29ydCBhbGwgdGhlIHJlZmVyZW5jZXMgYnkgYmJveC50b3AgKHZpYSB0aGUgYXR0cmlidXRlKSwgdGhlbiBncmVlZGlseSBsYXlvdXRcblx0Ly9cdCAgbGV0IGxhc3RZQm90dG9tOyBmb3IgdGhlIGZpcnN0IG9uZSwgcGxhY2UgaXQgd2hlcmUgaXQgd2FudHMgdG8gYmUuIHRoZW4gc2V0IGxhc3RZQm90dG9tIHRvIHRoYXQgYmJveC50b3AgcGx1cyBpdHMgaGVpZ2h0XG5cdC8vXHQgIHRoZW4sIGZvciB0aGUgcmVzdCwgc2V0IHRoZWlyIHRvcCB0byBtYXgoYmJveC50b3AsIGxhc3RZQm90dG9tICsgbWFyZ2luKVxuXHQvLyB0aGluayBhYm91dCB0aGUgY2FzZSB3aGVyZSB0aGUgYmFja2xpbmsgaXMgdG8gYW4gaXNvbGF0ZWQgcXVvdGVcblxuXHRsZXQgeyBzcGFuLCBzdmcgfSA9IGNyZWF0ZVJlZmVyZW5jZUljb24oYmFja2xpbmsucG9ydGFsVGV4dCk7XG5cdGNvbnN0IHBvcnRhbDogSFRNTEVsZW1lbnQgfCBudWxsID0gc3Bhbi5xdWVyeVNlbGVjdG9yKFwiLnBvcnRhbFwiKTtcblxuXHRzcGFuLnN0eWxlLnBvc2l0aW9uID0gXCJhYnNvbHV0ZVwiO1xuXG5cdHNwYW4uaWQgPSBnZXRCYWNrbGlua0lEKGJhY2tsaW5rKTtcblx0c3Bhbi5zZXRBdHRyaWJ1dGUoXCJyZWZlcmVuY2VcIiwgSlNPTi5zdHJpbmdpZnkoYmFja2xpbmspKTtcblxuXHRzcGFuLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWVudGVyXCIsIGFzeW5jICgpID0+IHtcblx0XHRpZiAocG9ydGFsICYmIHBvcnRhbC5zdHlsZS5kaXNwbGF5ICE9IFwibm9uZVwiKSB7XG5cdFx0XHRzcGFuLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFNWR19IT1ZFUl9DT0xPUjtcblx0XHR9IGVsc2Uge1xuXHRcdFx0c3Bhbi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIlwiO1xuXHRcdFx0c3ZnLnNldEF0dHJpYnV0ZShcImZpbGxcIiwgU1ZHX0hPVkVSX0NPTE9SKTtcblx0XHR9XG5cblx0XHQvLyByZW1vdmUgZXhpc3RpbmcgY3Vyc29yc1xuXHRcdHVwZGF0ZUhvdmVyZWRDdXJzb3JDb2xvcihzcGFuLCBBQ1RJT05fVFlQRS5CQUNLTElOSyk7XG5cdH0pO1xuXG5cdHNwYW4uYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbGVhdmVcIiwgYXN5bmMgKCkgPT4ge1xuXHRcdGlmIChwb3J0YWwgJiYgcG9ydGFsLnN0eWxlLmRpc3BsYXkgIT0gXCJub25lXCIpIHtcblx0XHRcdHNwYW4uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCJ3aGl0ZVwiO1xuXHRcdFx0Ly8gc3ZnLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwid2hpdGVcIjtcblx0XHR9IGVsc2Uge1xuXHRcdFx0c3Bhbi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIlwiO1xuXHRcdFx0aWYgKHBvcnRhbCkge1xuXHRcdFx0XHRzdmcuc2V0QXR0cmlidXRlKFwiZmlsbFwiLCBcIndoaXRlXCIpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0c3ZnLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwid2hpdGVcIjtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRoYW5kbGVSZW1vdmVIb3ZlcmVkQ3Vyc29yKEFDVElPTl9UWVBFLkJBQ0tMSU5LKTtcblx0fSk7XG5cblx0Y29uc3QgcmVzaXplT2JzZXJ2ZXIgPSBuZXcgUmVzaXplT2JzZXJ2ZXIoKGVudHJpZXMpID0+IHtcblx0XHRpZiAocG9ydGFsICYmIHBvcnRhbC5zdHlsZS5kaXNwbGF5ICE9IFwibm9uZVwiKSB7XG5cdFx0XHRzcGFuLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwid2hpdGVcIjtcblx0XHR9IGVsc2Uge1xuXHRcdFx0c3Bhbi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIlwiO1xuXHRcdH1cblx0fSk7XG5cblx0Ly8gU3RhcnQgb2JzZXJ2aW5nIGFuIGVsZW1lbnRcblx0cmVzaXplT2JzZXJ2ZXIub2JzZXJ2ZShzcGFuKTtcblxuXHRzcGFuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBvcGVuQmFja2xpbmtSZWZlcmVuY2UpO1xuXG5cdHJldHVybiBzcGFuO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYWRkUmVmZXJlbmNlc1RvTGVhZihsZWFmOiBXb3Jrc3BhY2VMZWFmKSB7XG5cdGNvbnN0IG1hcmtkb3duVmlldyA9IGdldE1hcmtkb3duVmlldyhsZWFmKTtcblx0bGV0IHdvcmtzcGFjZVRhYnMgPSBtYXJrZG93blZpZXcuY29udGFpbmVyRWwuY2xvc2VzdChcIi53b3Jrc3BhY2UtdGFic1wiKTtcblx0aWYgKCF3b3Jrc3BhY2VUYWJzKSB7XG5cdFx0dGhyb3cgbmV3IEVycm9yKFwiTWlzc2luZyB3b3Jrc3BhY2UgdGFic1wiKTtcblx0fVxuXG5cdHVwZGF0ZUJhY2tsaW5rTWFya1Bvc2l0aW9ucygpO1xuXG5cdGdldENvbnRhaW5lckVsZW1lbnQobWFya2Rvd25WaWV3LmVkaXRvcilcblx0XHQucXVlcnlTZWxlY3RvcihcIi5jbS1zY3JvbGxlclwiKSFcblx0XHQuYWRkRXZlbnRMaXN0ZW5lcihcInNjcm9sbFwiLCAoKSA9PiB7XG5cdFx0XHR1cGRhdGVCYWNrbGlua01hcmtQb3NpdGlvbnMoKTtcblx0XHR9KTtcblxuXHRsZXQgcmVzaXplT2JzZXJ2ZXIgPSBuZXcgUmVzaXplT2JzZXJ2ZXIoKCkgPT4ge1xuXHRcdHVwZGF0ZUJhY2tsaW5rTWFya1Bvc2l0aW9ucygpO1xuXHR9KTtcblxuXHRyZXNpemVPYnNlcnZlci5vYnNlcnZlKHdvcmtzcGFjZVRhYnMpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0TWFya2Rvd25WaWV3KGxlYWY6IFdvcmtzcGFjZUxlYWYpOiBNYXJrZG93blZpZXcge1xuXHRpZiAoIShsZWFmLnZpZXcgaW5zdGFuY2VvZiBNYXJrZG93blZpZXcpKSB7XG5cdFx0dGhyb3cgbmV3IEVycm9yKFwiVW5leHBlY3RlZCBub24tbWFya2Rvd24gdmlld1wiKTtcblx0fVxuXHRyZXR1cm4gbGVhZi52aWV3IGFzIE1hcmtkb3duVmlldztcbn1cblxuZnVuY3Rpb24gZ2V0RmlsZW5hbWUobGVhZjogV29ya3NwYWNlTGVhZik6IHN0cmluZyB7XG5cdGNvbnN0IHsgZmlsZSB9ID0gZ2V0TWFya2Rvd25WaWV3KGxlYWYpO1xuXHRpZiAoIWZpbGUpIHtcblx0XHR0aHJvdyBuZXcgRXJyb3IoXCJVbmV4cGVjdGVkIG1pc3NpbmcgZmlsZVwiKTtcblx0fVxuXHRyZXR1cm4gZmlsZS5uYW1lO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVCYWNrbGlua0RhdGEoXG5cdHJlZmVyZW5jaW5nRmlsZURhdGE6IHN0cmluZyxcblx0cmVmZXJlbmNpbmdGaWxlOiBURmlsZVxuKTogQmFja2xpbmtbXSB7XG5cdGxldCBiYWNrbGlua3M6IEJhY2tsaW5rW10gPSBbXTtcblxuXHRsZXQgbWF0Y2hlcyA9IFsuLi5yZWZlcmVuY2luZ0ZpbGVEYXRhLm1hdGNoQWxsKFJFRkVSRU5DRV9SRUdFWCldO1xuXHRtYXRjaGVzLmZvckVhY2goKG1hdGNoKSA9PiB7XG5cdFx0bGV0IFtwcmVmaXgsIHRleHQsIHN1ZmZpeCwgZmlsZW5hbWUsIGZyb20sIHRvLCBwb3J0YWxdID0gcHJvY2Vzc1VSSShcblx0XHRcdG1hdGNoWzFdXG5cdFx0KTtcblx0XHRjb25zdCByZWZlcmVuY2VkTG9jYXRpb246IERvY3VtZW50TG9jYXRpb24gPSB7XG5cdFx0XHRwcmVmaXgsXG5cdFx0XHR0ZXh0LFxuXHRcdFx0c3VmZml4LFxuXHRcdFx0ZmlsZW5hbWUsXG5cdFx0XHRmcm9tLFxuXHRcdFx0dG8sXG5cdFx0fTtcblxuXHRcdC8vIDEuIGZpbmQgdGhlIGxpbmUgd2hpY2ggaW5jbHVkZXMgbWF0Y2guaW5kZXhcblx0XHQvLyAyLiBzdHJpcCBvdXQgYWxsIHRoZSBsaW5rcyBpbiB0aGF0IGxpbmVcblx0XHQvLyAzLiBleHRyYWN0IHRoZSBmaXJzdCBOIGNoYXJhY3RlcnMgb2YgdGhlIGxpbmVcblx0XHQvLyBjb25zdCBwb3J0YWxUZXh0ID0gcmVmZXJlbmNpbmdGaWxlRGF0YS5zbGljZShcblx0XHQvLyBcdG1hdGNoLmluZGV4ISAtIFBPUlRBTF9URVhUX1NMSUNFX1NJWkUsXG5cdFx0Ly8gXHRQT1JUQUxfVEVYVF9TTElDRV9TSVpFXG5cdFx0Ly8gKTtcblxuXHRcdGxldCBpbmRleCA9IHJlZmVyZW5jaW5nRmlsZURhdGEuaW5kZXhPZihtYXRjaFswXSk7XG5cblx0XHRjb25zdCByZWZlcmVuY2luZ1N1cnJvdW5kaW5nU3RyaW5ncyA9IGdldFByZWZpeEFuZFN1ZmZpeChcblx0XHRcdHJlZmVyZW5jaW5nRmlsZURhdGEsXG5cdFx0XHRpbmRleCxcblx0XHRcdGluZGV4ICsgbWF0Y2hbMF0ubGVuZ3RoXG5cdFx0KTtcblxuXHRcdGNvbnN0IHJlZmVyZW5jaW5nTG9jYXRpb246IERvY3VtZW50TG9jYXRpb24gPSB7XG5cdFx0XHQvLyBwcmVmaXg6IHJlZmVyZW5jaW5nRmlsZURhdGEuc2xpY2UoaW5kZXggLSAyNSwgaW5kZXgpLFxuXHRcdFx0cHJlZml4OiByZWZlcmVuY2luZ1N1cnJvdW5kaW5nU3RyaW5ncy5wcmVmaXgsXG5cdFx0XHR0ZXh0OiByZWZlcmVuY2luZ0ZpbGVEYXRhLnNsaWNlKGluZGV4LCBpbmRleCArIG1hdGNoWzBdLmxlbmd0aCksXG5cdFx0XHQvLyBzdWZmaXg6IHJlZmVyZW5jaW5nRmlsZURhdGEuc2xpY2UoXG5cdFx0XHQvLyBcdGluZGV4ICsgbWF0Y2hbMF0ubGVuZ3RoLFxuXHRcdFx0Ly8gXHRpbmRleCArIG1hdGNoWzBdLmxlbmd0aCArIDI1XG5cdFx0XHQvLyApLFxuXHRcdFx0c3VmZml4OiByZWZlcmVuY2luZ1N1cnJvdW5kaW5nU3RyaW5ncy5zdWZmaXgsXG5cdFx0XHRmaWxlbmFtZTogcmVmZXJlbmNpbmdGaWxlLnBhdGgsXG5cdFx0XHRmcm9tOiBtYXRjaC5pbmRleCEsIC8vIFRPRE8gZG8gd2VpcmQgc3RyaW5nIGZvcm1hdFxuXHRcdFx0dG86IG1hdGNoLmluZGV4ISArIG1hdGNoWzBdLmxlbmd0aCwgLy8gVE9ETyBkbyB3ZWlyZCBzdHJpbmcgZm9ybWF0XG5cdFx0fTtcblxuXHRcdGlmIChwb3J0YWwgPT0gXCJwb3J0YWxcIikge1xuXHRcdFx0Ly8gT1Igbm8tcG9ydGFsXG5cblx0XHRcdC8vIGdldCBhbGwgdGhlIHRleHQgZnJvbSB0aGUgc3RhcnQgb2YgdGhlIGxpbmUgdG8gdGhlIGVuZCBvZiB0aGUgbGluZVxuXHRcdFx0Y29uc3QgZ2V0TGluZVRleHQgPSAodGV4dDogc3RyaW5nLCBpbmRleDogbnVtYmVyKTogc3RyaW5nID0+IHtcblx0XHRcdFx0Y29uc3Qgc3RhcnRPZkxpbmUgPSB0ZXh0Lmxhc3RJbmRleE9mKFwiXFxuXCIsIGluZGV4IC0gMSkgKyAxO1xuXHRcdFx0XHRjb25zdCBlbmRPZkxpbmUgPSB0ZXh0LmluZGV4T2YoXCJcXG5cIiwgaW5kZXgpO1xuXHRcdFx0XHRyZXR1cm4gdGV4dC5zbGljZShcblx0XHRcdFx0XHRzdGFydE9mTGluZSxcblx0XHRcdFx0XHRlbmRPZkxpbmUgIT09IC0xID8gZW5kT2ZMaW5lIDogdW5kZWZpbmVkXG5cdFx0XHRcdCk7XG5cdFx0XHR9O1xuXG5cdFx0XHRsZXQgbGluZSA9IGdldExpbmVUZXh0KHJlZmVyZW5jaW5nRmlsZURhdGEsIGluZGV4KTtcblx0XHRcdGxldCBwb3J0YWxUZXh0ID0gbGluZS5yZXBsYWNlKG5ldyBSZWdFeHAoUkVGRVJFTkNFX1JFR0VYLCBcImdcIiksIFwiXCIpO1xuXHRcdFx0bGV0IHBvcnRhbFRleHRTbGljZSA9IHBvcnRhbFRleHQuc2xpY2UoMCwgUE9SVEFMX1RFWFRfU0xJQ0VfU0laRSk7XG5cblx0XHRcdGJhY2tsaW5rcy5wdXNoKHtcblx0XHRcdFx0cmVmZXJlbmNlZExvY2F0aW9uLFxuXHRcdFx0XHRyZWZlcmVuY2luZ0xvY2F0aW9uLFxuXHRcdFx0XHRkYXRhU3RyaW5nOiBtYXRjaFsxXSxcblx0XHRcdFx0cG9ydGFsVGV4dDogcG9ydGFsVGV4dFNsaWNlLFxuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGJhY2tsaW5rcy5wdXNoKHtcblx0XHRcdFx0cmVmZXJlbmNlZExvY2F0aW9uLFxuXHRcdFx0XHRyZWZlcmVuY2luZ0xvY2F0aW9uLFxuXHRcdFx0XHRkYXRhU3RyaW5nOiBtYXRjaFsxXSxcblx0XHRcdH0pO1xuXHRcdH1cblx0fSk7XG5cdHJldHVybiBiYWNrbGlua3M7XG59XG5cbi8vIGxldCBkZWJvdW5jZVRpbWVyOiBOb2RlSlMuVGltZW91dDtcbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZUJhY2tsaW5rcygpIHtcblx0Ly8gY2xlYXJUaW1lb3V0KGRlYm91bmNlVGltZXIpO1xuXHQvLyBkZWJvdW5jZVRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7XG5cdGNvbnNvbGUubG9nKFwiZ2VuZXJhdGluZyByZWZlcmVuY2VzXCIpO1xuXHRsZXQgYmFja2xpbmtzOiBCYWNrbGlua1tdID0gW107XG5cdGxldCBtYXJrZG93bkZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xuXG5cdFByb21pc2UuYWxsKFxuXHRcdG1hcmtkb3duRmlsZXMubWFwKChmaWxlOiBURmlsZSkgPT4gdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKSlcblx0KS50aGVuKChmaWxlcykgPT4ge1xuXHRcdGNvbnN0IHppcHBlZEFycmF5ID0gbWFya2Rvd25GaWxlcy5tYXAoKGZpbGU6IFRGaWxlLCBpbmRleDogbnVtYmVyKSA9PiAoe1xuXHRcdFx0bWFya2Rvd25GaWxlOiBmaWxlLFxuXHRcdFx0ZmlsZURhdGE6IGZpbGVzW2luZGV4XSxcblx0XHR9KSk7XG5cblx0XHR6aXBwZWRBcnJheS5mb3JFYWNoKChmaWxlOiB7IG1hcmtkb3duRmlsZTogVEZpbGU7IGZpbGVEYXRhOiBzdHJpbmcgfSkgPT4ge1xuXHRcdFx0bGV0IGZpbGVCYWNrbGlua3MgPSBjcmVhdGVCYWNrbGlua0RhdGEoZmlsZS5maWxlRGF0YSwgZmlsZS5tYXJrZG93bkZpbGUpO1xuXHRcdFx0dXBkYXRlQmFja2xpbmtzKGZpbGVCYWNrbGlua3MpO1xuXG5cdFx0XHRiYWNrbGlua3MucHVzaCguLi5maWxlQmFja2xpbmtzKTtcblx0XHR9KTtcblxuXHRcdGNvbnN0IGxlYXZlcyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoXCJtYXJrZG93blwiKTtcblxuXHRcdGxlYXZlcy5mb3JFYWNoKChsZWFmOiBXb3Jrc3BhY2VMZWFmKSA9PiB7XG5cdFx0XHRhZGRSZWZlcmVuY2VzVG9MZWFmKGxlYWYpO1xuXHRcdH0pO1xuXHR9KTtcblx0Ly8gfSwgMTAwKTtcbn1cblxuLy8gU2hvdWxkIG9ubHkgcmVjb21wdXRlIGZvciB0aGUgcGFydGljdWxhciBwYWdlIGJlaW5nIG9wZW5lZCBvciBpbnRlcmFjdGVkIHdpdGhcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZWNvbXB1dGVSZWZlcmVuY2VzRm9yUGFnZSgpOiBQcm9taXNlPEJhY2tsaW5rW10+IHtcblx0Y29uc3QgbGVhdmVzID0gZ2V0VGhhdCgpLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoXCJtYXJrZG93blwiKTtcblx0bGV0IHJlZmVyZW5jZXM6IEJhY2tsaW5rW10gPSBbXTtcblx0bGV0IG1hcmtkb3duRmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XG5cblx0bGV0IHByb21pc2VzID0gbWFya2Rvd25GaWxlcy5tYXAoKGZpbGU6IFRGaWxlKSA9PiB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpKTtcblx0Ly8gbGV0IHByb21pc2VzID0gbGVhdmVzLm1hcCgobGVhZjogV29ya3NwYWNlTGVhZikgPT4ge1xuXHQvLyBcdC8vIGNvbnN0IGFjdGl2ZUxlYWYgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuXHQvLyBcdC8vIGlmICghYWN0aXZlTGVhZikgcmV0dXJuO1xuXHQvLyBcdGNvbnN0IHZpZXcgPSBnZXRNYXJrZG93blZpZXcobGVhZik7XG5cdC8vIFx0Y29uc3QgZmlsZSA9IHZpZXcuZmlsZTtcblx0Ly8gXHRpZiAoIWZpbGUpIHRocm93IG5ldyBFcnJvcihcIk1pc3NpbmcgZmlsZVwiKTtcblx0Ly8gXHRyZXR1cm4gdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcblx0Ly8gfSk7XG5cdGxldCBmaWxlcyA9IGF3YWl0IFByb21pc2UuYWxsKHByb21pc2VzKTtcblx0Y29uc3QgemlwcGVkQXJyYXkgPSBtYXJrZG93bkZpbGVzLm1hcCgoZmlsZTogVEZpbGUsIGluZGV4OiBudW1iZXIpID0+ICh7XG5cdFx0bWFya2Rvd25GaWxlOiBmaWxlLFxuXHRcdGZpbGVEYXRhOiBmaWxlc1tpbmRleF0sXG5cdH0pKTtcblx0emlwcGVkQXJyYXkuZm9yRWFjaCgoZmlsZTogeyBtYXJrZG93bkZpbGU6IFRGaWxlOyBmaWxlRGF0YTogc3RyaW5nIH0pID0+IHtcblx0XHRsZXQgZmlsZUJhY2tsaW5rcyA9IGNyZWF0ZUJhY2tsaW5rRGF0YShmaWxlLmZpbGVEYXRhLCBmaWxlLm1hcmtkb3duRmlsZSk7XG5cdFx0dXBkYXRlQmFja2xpbmtzKGZpbGVCYWNrbGlua3MpO1xuXG5cdFx0cmVmZXJlbmNlcy5wdXNoKC4uLmZpbGVCYWNrbGlua3MpO1xuXHR9KTtcblx0Ly8gZmlsZXMuZm9yRWFjaCgoZmlsZSwgaSkgPT4ge1xuXHQvLyBcdGxldCBmaWxlQmFja2xpbmtzID0gY3JlYXRlQmFja2xpbmtEYXRhKGZpbGUsIGZpbGUpO1xuXHQvLyBcdHVwZGF0ZUJhY2tsaW5rcyhmaWxlQmFja2xpbmtzKTtcblxuXHQvLyBcdHJlZmVyZW5jZXMgPSBbLi4ucmVmZXJlbmNlcywgLi4uZmlsZUJhY2tsaW5rc107XG5cdC8vIH0pO1xuXHQvLyBsZWF2ZXMuZm9yRWFjaCgobGVhZjogV29ya3NwYWNlTGVhZiwgaSkgPT4ge1xuXHQvLyBcdGNvbnN0IHZpZXcgPSBnZXRNYXJrZG93blZpZXcobGVhZik7XG5cdC8vIFx0Y29uc3QgZmlsZSA9IHZpZXcuZmlsZTtcblx0Ly8gXHRpZiAoIWZpbGUpIHRocm93IG5ldyBFcnJvcihcIk1pc3NpbmcgZmlsZVwiKTtcblx0Ly8gXHRsZXQgZmlsZUJhY2tsaW5rcyA9IGNyZWF0ZUJhY2tsaW5rRGF0YShmaWxlc1tpXSwgZmlsZSk7XG5cdC8vIFx0dXBkYXRlQmFja2xpbmtzKGZpbGVCYWNrbGlua3MpO1xuXG5cdC8vIFx0cmVmZXJlbmNlcyA9IFsuLi5yZWZlcmVuY2VzLCAuLi5maWxlQmFja2xpbmtzXTtcblx0Ly8gfSk7XG5cblx0Ly8gY29uc29sZS5sb2cocmVmZXJlbmNlcyk7XG5cdC8vIHVwZGF0ZUJhY2tsaW5rcyhyZWZlcmVuY2VzKTtcblx0cmV0dXJuIHJlZmVyZW5jZXM7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBvcGVuQmFja2xpbmtSZWZlcmVuY2UoZXY6IE1vdXNlRXZlbnQpIHtcblx0bGV0IGN1cnNvciA9IGdldEN1cnNvcigpO1xuXHRsZXQgaG92ZXIgPSBnZXRCYWNrbGlua0hvdmVyKCk7XG5cdGxldCBsZWFmID0gZ2V0VGhhdCgpLndvcmtzcGFjZS5nZXRMZWFmQnlJZChob3Zlci5sZWFmSWQpO1xuXG5cdC8vIEB0cy1pZ25vcmVcblx0bGV0IGNvbnRhaW5lciA9IGxlYWYuY29udGFpbmVyRWw7XG5cdGlmICghY29udGFpbmVyKSB0aHJvdyBuZXcgRXJyb3IoXCJDb250YWluZXIgbm90IGZvdW5kXCIpO1xuXHRjb250YWluZXIucXVlcnlTZWxlY3RvcihcIi52aWV3LWNvbnRlbnRcIikuc3R5bGUuYm94U2hhZG93ID0gXCJub25lXCI7XG5cblx0aWYgKFxuXHRcdGN1cnNvciAmJlxuXHRcdGhvdmVyICYmXG5cdFx0Y3Vyc29yLmRhdGFTdHJpbmcgJiZcblx0XHRob3Zlci5kYXRhU3RyaW5nICYmXG5cdFx0Y3Vyc29yLmRhdGFTdHJpbmcgPT0gaG92ZXIuZGF0YVN0cmluZ1xuXHQpIHtcblx0XHR1cGRhdGVDdXJzb3Ioe1xuXHRcdFx0dGVtcDogZmFsc2UsXG5cdFx0XHRjdXJzb3JWaWV3cG9ydDogbnVsbCxcblx0XHRcdHBlZWs6IGZhbHNlLFxuXHRcdH0pO1xuXHR9XG5cdHVwZGF0ZUJhY2tsaW5rSG92ZXIoe1xuXHRcdHRlbXA6IGZhbHNlLFxuXHRcdGN1cnNvclZpZXdwb3J0OiBudWxsLFxuXHRcdHBlZWs6IGZhbHNlLFxuXHR9KTtcblxuXHRoYW5kbGVSZW1vdmVIb3ZlcmVkQ3Vyc29yKEFDVElPTl9UWVBFLkNVUlNPUik7XG5cblx0cmVzZXRDdXJzb3IoKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIG9wZW5SZWZlcmVuY2UoZXY6IE1vdXNlRXZlbnQpIHtcblx0bGV0IGN1cnNvciA9IGdldEN1cnNvcigpO1xuXHRsZXQgaG92ZXIgPSBnZXRIb3ZlcigpO1xuXHRsZXQgbGVhZiA9IGdldFRoYXQoKS53b3Jrc3BhY2UuZ2V0TGVhZkJ5SWQoaG92ZXIubGVhZklkKTtcblxuXHQvLyBAdHMtaWdub3JlXG5cdGxldCBjb250YWluZXIgPSBsZWFmLmNvbnRhaW5lckVsO1xuXHRpZiAoIWNvbnRhaW5lcikgdGhyb3cgbmV3IEVycm9yKFwiQ29udGFpbmVyIG5vdCBmb3VuZFwiKTtcblx0Y29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCIudmlldy1jb250ZW50XCIpLnN0eWxlLmJveFNoYWRvdyA9IFwibm9uZVwiO1xuXG5cdGlmIChcblx0XHRjdXJzb3IgJiZcblx0XHRob3ZlciAmJlxuXHRcdGN1cnNvci5kYXRhU3RyaW5nICYmXG5cdFx0aG92ZXIuZGF0YVN0cmluZyAmJlxuXHRcdGN1cnNvci5kYXRhU3RyaW5nID09IGhvdmVyLmRhdGFTdHJpbmdcblx0KSB7XG5cdFx0dXBkYXRlQ3Vyc29yKHtcblx0XHRcdHRlbXA6IGZhbHNlLFxuXHRcdFx0Y3Vyc29yVmlld3BvcnQ6IG51bGwsXG5cdFx0XHRwZWVrOiBmYWxzZSxcblx0XHR9KTtcblx0fVxuXHR1cGRhdGVIb3Zlcih7XG5cdFx0dGVtcDogZmFsc2UsXG5cdFx0Y3Vyc29yVmlld3BvcnQ6IG51bGwsXG5cdFx0cGVlazogZmFsc2UsXG5cdH0pO1xuXG5cdGhhbmRsZVJlbW92ZUhvdmVyZWRDdXJzb3IoQUNUSU9OX1RZUEUuQ1VSU09SKTtcblxuXHRyZXNldEN1cnNvcigpO1xufVxuIiwgImV4cG9ydCBkZWZhdWx0IC9eKD86WzAtOWEtZl17OH0tWzAtOWEtZl17NH0tWzEtNV1bMC05YS1mXXszfS1bODlhYl1bMC05YS1mXXszfS1bMC05YS1mXXsxMn18MDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwKSQvaTsiLCAiaW1wb3J0IFJFR0VYIGZyb20gJy4vcmVnZXguanMnO1xuXG5mdW5jdGlvbiB2YWxpZGF0ZSh1dWlkKSB7XG4gIHJldHVybiB0eXBlb2YgdXVpZCA9PT0gJ3N0cmluZycgJiYgUkVHRVgudGVzdCh1dWlkKTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgdmFsaWRhdGU7IiwgImltcG9ydCB2YWxpZGF0ZSBmcm9tICcuL3ZhbGlkYXRlLmpzJztcbi8qKlxuICogQ29udmVydCBhcnJheSBvZiAxNiBieXRlIHZhbHVlcyB0byBVVUlEIHN0cmluZyBmb3JtYXQgb2YgdGhlIGZvcm06XG4gKiBYWFhYWFhYWC1YWFhYLVhYWFgtWFhYWC1YWFhYWFhYWFhYWFhcbiAqL1xuXG5jb25zdCBieXRlVG9IZXggPSBbXTtcblxuZm9yIChsZXQgaSA9IDA7IGkgPCAyNTY7ICsraSkge1xuICBieXRlVG9IZXgucHVzaCgoaSArIDB4MTAwKS50b1N0cmluZygxNikuc2xpY2UoMSkpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdW5zYWZlU3RyaW5naWZ5KGFyciwgb2Zmc2V0ID0gMCkge1xuICAvLyBOb3RlOiBCZSBjYXJlZnVsIGVkaXRpbmcgdGhpcyBjb2RlISAgSXQncyBiZWVuIHR1bmVkIGZvciBwZXJmb3JtYW5jZVxuICAvLyBhbmQgd29ya3MgaW4gd2F5cyB5b3UgbWF5IG5vdCBleHBlY3QuIFNlZSBodHRwczovL2dpdGh1Yi5jb20vdXVpZGpzL3V1aWQvcHVsbC80MzRcbiAgcmV0dXJuIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMF1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxXV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDJdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgM11dICsgJy0nICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA0XV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDVdXSArICctJyArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgNl1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA3XV0gKyAnLScgKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDhdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgOV1dICsgJy0nICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxMF1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxMV1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxMl1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxM11dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxNF1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxNV1dO1xufVxuXG5mdW5jdGlvbiBzdHJpbmdpZnkoYXJyLCBvZmZzZXQgPSAwKSB7XG4gIGNvbnN0IHV1aWQgPSB1bnNhZmVTdHJpbmdpZnkoYXJyLCBvZmZzZXQpOyAvLyBDb25zaXN0ZW5jeSBjaGVjayBmb3IgdmFsaWQgVVVJRC4gIElmIHRoaXMgdGhyb3dzLCBpdCdzIGxpa2VseSBkdWUgdG8gb25lXG4gIC8vIG9mIHRoZSBmb2xsb3dpbmc6XG4gIC8vIC0gT25lIG9yIG1vcmUgaW5wdXQgYXJyYXkgdmFsdWVzIGRvbid0IG1hcCB0byBhIGhleCBvY3RldCAobGVhZGluZyB0b1xuICAvLyBcInVuZGVmaW5lZFwiIGluIHRoZSB1dWlkKVxuICAvLyAtIEludmFsaWQgaW5wdXQgdmFsdWVzIGZvciB0aGUgUkZDIGB2ZXJzaW9uYCBvciBgdmFyaWFudGAgZmllbGRzXG5cbiAgaWYgKCF2YWxpZGF0ZSh1dWlkKSkge1xuICAgIHRocm93IFR5cGVFcnJvcignU3RyaW5naWZpZWQgVVVJRCBpcyBpbnZhbGlkJyk7XG4gIH1cblxuICByZXR1cm4gdXVpZDtcbn1cblxuZXhwb3J0IGRlZmF1bHQgc3RyaW5naWZ5OyIsICJpbXBvcnQgdmFsaWRhdGUgZnJvbSAnLi92YWxpZGF0ZS5qcyc7XG5cbmZ1bmN0aW9uIHBhcnNlKHV1aWQpIHtcbiAgaWYgKCF2YWxpZGF0ZSh1dWlkKSkge1xuICAgIHRocm93IFR5cGVFcnJvcignSW52YWxpZCBVVUlEJyk7XG4gIH1cblxuICBsZXQgdjtcbiAgY29uc3QgYXJyID0gbmV3IFVpbnQ4QXJyYXkoMTYpOyAvLyBQYXJzZSAjIyMjIyMjIy0uLi4uLS4uLi4tLi4uLi0uLi4uLi4uLi4uLi5cblxuICBhcnJbMF0gPSAodiA9IHBhcnNlSW50KHV1aWQuc2xpY2UoMCwgOCksIDE2KSkgPj4+IDI0O1xuICBhcnJbMV0gPSB2ID4+PiAxNiAmIDB4ZmY7XG4gIGFyclsyXSA9IHYgPj4+IDggJiAweGZmO1xuICBhcnJbM10gPSB2ICYgMHhmZjsgLy8gUGFyc2UgLi4uLi4uLi4tIyMjIy0uLi4uLS4uLi4tLi4uLi4uLi4uLi4uXG5cbiAgYXJyWzRdID0gKHYgPSBwYXJzZUludCh1dWlkLnNsaWNlKDksIDEzKSwgMTYpKSA+Pj4gODtcbiAgYXJyWzVdID0gdiAmIDB4ZmY7IC8vIFBhcnNlIC4uLi4uLi4uLS4uLi4tIyMjIy0uLi4uLS4uLi4uLi4uLi4uLlxuXG4gIGFycls2XSA9ICh2ID0gcGFyc2VJbnQodXVpZC5zbGljZSgxNCwgMTgpLCAxNikpID4+PiA4O1xuICBhcnJbN10gPSB2ICYgMHhmZjsgLy8gUGFyc2UgLi4uLi4uLi4tLi4uLi0uLi4uLSMjIyMtLi4uLi4uLi4uLi4uXG5cbiAgYXJyWzhdID0gKHYgPSBwYXJzZUludCh1dWlkLnNsaWNlKDE5LCAyMyksIDE2KSkgPj4+IDg7XG4gIGFycls5XSA9IHYgJiAweGZmOyAvLyBQYXJzZSAuLi4uLi4uLi0uLi4uLS4uLi4tLi4uLi0jIyMjIyMjIyMjIyNcbiAgLy8gKFVzZSBcIi9cIiB0byBhdm9pZCAzMi1iaXQgdHJ1bmNhdGlvbiB3aGVuIGJpdC1zaGlmdGluZyBoaWdoLW9yZGVyIGJ5dGVzKVxuXG4gIGFyclsxMF0gPSAodiA9IHBhcnNlSW50KHV1aWQuc2xpY2UoMjQsIDM2KSwgMTYpKSAvIDB4MTAwMDAwMDAwMDAgJiAweGZmO1xuICBhcnJbMTFdID0gdiAvIDB4MTAwMDAwMDAwICYgMHhmZjtcbiAgYXJyWzEyXSA9IHYgPj4+IDI0ICYgMHhmZjtcbiAgYXJyWzEzXSA9IHYgPj4+IDE2ICYgMHhmZjtcbiAgYXJyWzE0XSA9IHYgPj4+IDggJiAweGZmO1xuICBhcnJbMTVdID0gdiAmIDB4ZmY7XG4gIHJldHVybiBhcnI7XG59XG5cbmV4cG9ydCBkZWZhdWx0IHBhcnNlOyIsICJpbXBvcnQgeyB1bnNhZmVTdHJpbmdpZnkgfSBmcm9tICcuL3N0cmluZ2lmeS5qcyc7XG5pbXBvcnQgcGFyc2UgZnJvbSAnLi9wYXJzZS5qcyc7XG5cbmZ1bmN0aW9uIHN0cmluZ1RvQnl0ZXMoc3RyKSB7XG4gIHN0ciA9IHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChzdHIpKTsgLy8gVVRGOCBlc2NhcGVcblxuICBjb25zdCBieXRlcyA9IFtdO1xuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgKytpKSB7XG4gICAgYnl0ZXMucHVzaChzdHIuY2hhckNvZGVBdChpKSk7XG4gIH1cblxuICByZXR1cm4gYnl0ZXM7XG59XG5cbmV4cG9ydCBjb25zdCBETlMgPSAnNmJhN2I4MTAtOWRhZC0xMWQxLTgwYjQtMDBjMDRmZDQzMGM4JztcbmV4cG9ydCBjb25zdCBVUkwgPSAnNmJhN2I4MTEtOWRhZC0xMWQxLTgwYjQtMDBjMDRmZDQzMGM4JztcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHYzNShuYW1lLCB2ZXJzaW9uLCBoYXNoZnVuYykge1xuICBmdW5jdGlvbiBnZW5lcmF0ZVVVSUQodmFsdWUsIG5hbWVzcGFjZSwgYnVmLCBvZmZzZXQpIHtcbiAgICB2YXIgX25hbWVzcGFjZTtcblxuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICB2YWx1ZSA9IHN0cmluZ1RvQnl0ZXModmFsdWUpO1xuICAgIH1cblxuICAgIGlmICh0eXBlb2YgbmFtZXNwYWNlID09PSAnc3RyaW5nJykge1xuICAgICAgbmFtZXNwYWNlID0gcGFyc2UobmFtZXNwYWNlKTtcbiAgICB9XG5cbiAgICBpZiAoKChfbmFtZXNwYWNlID0gbmFtZXNwYWNlKSA9PT0gbnVsbCB8fCBfbmFtZXNwYWNlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfbmFtZXNwYWNlLmxlbmd0aCkgIT09IDE2KSB7XG4gICAgICB0aHJvdyBUeXBlRXJyb3IoJ05hbWVzcGFjZSBtdXN0IGJlIGFycmF5LWxpa2UgKDE2IGl0ZXJhYmxlIGludGVnZXIgdmFsdWVzLCAwLTI1NSknKTtcbiAgICB9IC8vIENvbXB1dGUgaGFzaCBvZiBuYW1lc3BhY2UgYW5kIHZhbHVlLCBQZXIgNC4zXG4gICAgLy8gRnV0dXJlOiBVc2Ugc3ByZWFkIHN5bnRheCB3aGVuIHN1cHBvcnRlZCBvbiBhbGwgcGxhdGZvcm1zLCBlLmcuIGBieXRlcyA9XG4gICAgLy8gaGFzaGZ1bmMoWy4uLm5hbWVzcGFjZSwgLi4uIHZhbHVlXSlgXG5cblxuICAgIGxldCBieXRlcyA9IG5ldyBVaW50OEFycmF5KDE2ICsgdmFsdWUubGVuZ3RoKTtcbiAgICBieXRlcy5zZXQobmFtZXNwYWNlKTtcbiAgICBieXRlcy5zZXQodmFsdWUsIG5hbWVzcGFjZS5sZW5ndGgpO1xuICAgIGJ5dGVzID0gaGFzaGZ1bmMoYnl0ZXMpO1xuICAgIGJ5dGVzWzZdID0gYnl0ZXNbNl0gJiAweDBmIHwgdmVyc2lvbjtcbiAgICBieXRlc1s4XSA9IGJ5dGVzWzhdICYgMHgzZiB8IDB4ODA7XG5cbiAgICBpZiAoYnVmKSB7XG4gICAgICBvZmZzZXQgPSBvZmZzZXQgfHwgMDtcblxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxNjsgKytpKSB7XG4gICAgICAgIGJ1ZltvZmZzZXQgKyBpXSA9IGJ5dGVzW2ldO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gYnVmO1xuICAgIH1cblxuICAgIHJldHVybiB1bnNhZmVTdHJpbmdpZnkoYnl0ZXMpO1xuICB9IC8vIEZ1bmN0aW9uI25hbWUgaXMgbm90IHNldHRhYmxlIG9uIHNvbWUgcGxhdGZvcm1zICgjMjcwKVxuXG5cbiAgdHJ5IHtcbiAgICBnZW5lcmF0ZVVVSUQubmFtZSA9IG5hbWU7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1lbXB0eVxuICB9IGNhdGNoIChlcnIpIHt9IC8vIEZvciBDb21tb25KUyBkZWZhdWx0IGV4cG9ydCBzdXBwb3J0XG5cblxuICBnZW5lcmF0ZVVVSUQuRE5TID0gRE5TO1xuICBnZW5lcmF0ZVVVSUQuVVJMID0gVVJMO1xuICByZXR1cm4gZ2VuZXJhdGVVVUlEO1xufSIsICIvLyBBZGFwdGVkIGZyb20gQ2hyaXMgVmVuZXNzJyBTSEExIGNvZGUgYXRcbi8vIGh0dHA6Ly93d3cubW92YWJsZS10eXBlLmNvLnVrL3NjcmlwdHMvc2hhMS5odG1sXG5mdW5jdGlvbiBmKHMsIHgsIHksIHopIHtcbiAgc3dpdGNoIChzKSB7XG4gICAgY2FzZSAwOlxuICAgICAgcmV0dXJuIHggJiB5IF4gfnggJiB6O1xuXG4gICAgY2FzZSAxOlxuICAgICAgcmV0dXJuIHggXiB5IF4gejtcblxuICAgIGNhc2UgMjpcbiAgICAgIHJldHVybiB4ICYgeSBeIHggJiB6IF4geSAmIHo7XG5cbiAgICBjYXNlIDM6XG4gICAgICByZXR1cm4geCBeIHkgXiB6O1xuICB9XG59XG5cbmZ1bmN0aW9uIFJPVEwoeCwgbikge1xuICByZXR1cm4geCA8PCBuIHwgeCA+Pj4gMzIgLSBuO1xufVxuXG5mdW5jdGlvbiBzaGExKGJ5dGVzKSB7XG4gIGNvbnN0IEsgPSBbMHg1YTgyNzk5OSwgMHg2ZWQ5ZWJhMSwgMHg4ZjFiYmNkYywgMHhjYTYyYzFkNl07XG4gIGNvbnN0IEggPSBbMHg2NzQ1MjMwMSwgMHhlZmNkYWI4OSwgMHg5OGJhZGNmZSwgMHgxMDMyNTQ3NiwgMHhjM2QyZTFmMF07XG5cbiAgaWYgKHR5cGVvZiBieXRlcyA9PT0gJ3N0cmluZycpIHtcbiAgICBjb25zdCBtc2cgPSB1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoYnl0ZXMpKTsgLy8gVVRGOCBlc2NhcGVcblxuICAgIGJ5dGVzID0gW107XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG1zZy5sZW5ndGg7ICsraSkge1xuICAgICAgYnl0ZXMucHVzaChtc2cuY2hhckNvZGVBdChpKSk7XG4gICAgfVxuICB9IGVsc2UgaWYgKCFBcnJheS5pc0FycmF5KGJ5dGVzKSkge1xuICAgIC8vIENvbnZlcnQgQXJyYXktbGlrZSB0byBBcnJheVxuICAgIGJ5dGVzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYnl0ZXMpO1xuICB9XG5cbiAgYnl0ZXMucHVzaCgweDgwKTtcbiAgY29uc3QgbCA9IGJ5dGVzLmxlbmd0aCAvIDQgKyAyO1xuICBjb25zdCBOID0gTWF0aC5jZWlsKGwgLyAxNik7XG4gIGNvbnN0IE0gPSBuZXcgQXJyYXkoTik7XG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBOOyArK2kpIHtcbiAgICBjb25zdCBhcnIgPSBuZXcgVWludDMyQXJyYXkoMTYpO1xuXG4gICAgZm9yIChsZXQgaiA9IDA7IGogPCAxNjsgKytqKSB7XG4gICAgICBhcnJbal0gPSBieXRlc1tpICogNjQgKyBqICogNF0gPDwgMjQgfCBieXRlc1tpICogNjQgKyBqICogNCArIDFdIDw8IDE2IHwgYnl0ZXNbaSAqIDY0ICsgaiAqIDQgKyAyXSA8PCA4IHwgYnl0ZXNbaSAqIDY0ICsgaiAqIDQgKyAzXTtcbiAgICB9XG5cbiAgICBNW2ldID0gYXJyO1xuICB9XG5cbiAgTVtOIC0gMV1bMTRdID0gKGJ5dGVzLmxlbmd0aCAtIDEpICogOCAvIE1hdGgucG93KDIsIDMyKTtcbiAgTVtOIC0gMV1bMTRdID0gTWF0aC5mbG9vcihNW04gLSAxXVsxNF0pO1xuICBNW04gLSAxXVsxNV0gPSAoYnl0ZXMubGVuZ3RoIC0gMSkgKiA4ICYgMHhmZmZmZmZmZjtcblxuICBmb3IgKGxldCBpID0gMDsgaSA8IE47ICsraSkge1xuICAgIGNvbnN0IFcgPSBuZXcgVWludDMyQXJyYXkoODApO1xuXG4gICAgZm9yIChsZXQgdCA9IDA7IHQgPCAxNjsgKyt0KSB7XG4gICAgICBXW3RdID0gTVtpXVt0XTtcbiAgICB9XG5cbiAgICBmb3IgKGxldCB0ID0gMTY7IHQgPCA4MDsgKyt0KSB7XG4gICAgICBXW3RdID0gUk9UTChXW3QgLSAzXSBeIFdbdCAtIDhdIF4gV1t0IC0gMTRdIF4gV1t0IC0gMTZdLCAxKTtcbiAgICB9XG5cbiAgICBsZXQgYSA9IEhbMF07XG4gICAgbGV0IGIgPSBIWzFdO1xuICAgIGxldCBjID0gSFsyXTtcbiAgICBsZXQgZCA9IEhbM107XG4gICAgbGV0IGUgPSBIWzRdO1xuXG4gICAgZm9yIChsZXQgdCA9IDA7IHQgPCA4MDsgKyt0KSB7XG4gICAgICBjb25zdCBzID0gTWF0aC5mbG9vcih0IC8gMjApO1xuICAgICAgY29uc3QgVCA9IFJPVEwoYSwgNSkgKyBmKHMsIGIsIGMsIGQpICsgZSArIEtbc10gKyBXW3RdID4+PiAwO1xuICAgICAgZSA9IGQ7XG4gICAgICBkID0gYztcbiAgICAgIGMgPSBST1RMKGIsIDMwKSA+Pj4gMDtcbiAgICAgIGIgPSBhO1xuICAgICAgYSA9IFQ7XG4gICAgfVxuXG4gICAgSFswXSA9IEhbMF0gKyBhID4+PiAwO1xuICAgIEhbMV0gPSBIWzFdICsgYiA+Pj4gMDtcbiAgICBIWzJdID0gSFsyXSArIGMgPj4+IDA7XG4gICAgSFszXSA9IEhbM10gKyBkID4+PiAwO1xuICAgIEhbNF0gPSBIWzRdICsgZSA+Pj4gMDtcbiAgfVxuXG4gIHJldHVybiBbSFswXSA+PiAyNCAmIDB4ZmYsIEhbMF0gPj4gMTYgJiAweGZmLCBIWzBdID4+IDggJiAweGZmLCBIWzBdICYgMHhmZiwgSFsxXSA+PiAyNCAmIDB4ZmYsIEhbMV0gPj4gMTYgJiAweGZmLCBIWzFdID4+IDggJiAweGZmLCBIWzFdICYgMHhmZiwgSFsyXSA+PiAyNCAmIDB4ZmYsIEhbMl0gPj4gMTYgJiAweGZmLCBIWzJdID4+IDggJiAweGZmLCBIWzJdICYgMHhmZiwgSFszXSA+PiAyNCAmIDB4ZmYsIEhbM10gPj4gMTYgJiAweGZmLCBIWzNdID4+IDggJiAweGZmLCBIWzNdICYgMHhmZiwgSFs0XSA+PiAyNCAmIDB4ZmYsIEhbNF0gPj4gMTYgJiAweGZmLCBIWzRdID4+IDggJiAweGZmLCBIWzRdICYgMHhmZl07XG59XG5cbmV4cG9ydCBkZWZhdWx0IHNoYTE7IiwgImltcG9ydCB2MzUgZnJvbSAnLi92MzUuanMnO1xuaW1wb3J0IHNoYTEgZnJvbSAnLi9zaGExLmpzJztcbmNvbnN0IHY1ID0gdjM1KCd2NScsIDB4NTAsIHNoYTEpO1xuZXhwb3J0IGRlZmF1bHQgdjU7IiwgImltcG9ydCB7IE1hcmtkb3duVmlldywgVGV4dEZpbGVWaWV3LCBWaWV3IH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBSRUZFUkVOQ0VfUkVHRVgsIEFDVElPTl9UWVBFLCBTVkdfSE9WRVJfQ09MT1IgfSBmcm9tIFwiLi9jb25zdGFudHNcIjtcbmltcG9ydCB7IHN0YXJ0UmVmZXJlbmNlRWZmZWN0LCBlbmRSZWZlcmVuY2VDdXJzb3JFZmZlY3QgfSBmcm9tIFwiLi9lZmZlY3RzXCI7XG5pbXBvcnQge1xuXHRnZXRIb3ZlcmVkQ3Vyc29yLFxuXHR1cGRhdGVIb3ZlcmVkQ3Vyc29yLFxuXHRyZW1vdmVIb3ZlcmVkQ3Vyc29yLFxuXHRnZXRIb3Zlcixcbn0gZnJvbSBcIi4vc3RhdGVcIjtcbmltcG9ydCB7IHVwZGF0ZUhvdmVyZWRDdXJzb3JDb2xvciB9IGZyb20gXCIuL3JlZmVyZW5jZXNcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlRWRpdG9yUG9zaXRpb24ocG9zaXRpb25TdHJpbmc6IHN0cmluZykge1xuXHRsZXQgW2xpbmUsIGNoXSA9IHBvc2l0aW9uU3RyaW5nLnNwbGl0KFwiLFwiKTtcblx0cmV0dXJuIHsgbGluZTogcGFyc2VJbnQobGluZSksIGNoOiBwYXJzZUludChjaCkgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGVuY29kZVVSSUNvbXBvbmVudFN0cmluZyhzdHI6IHN0cmluZyk6IHN0cmluZyB7XG5cdHJldHVybiBlbmNvZGVVUklDb21wb25lbnQoc3RyKS5yZXBsYWNlKC9bOigpXS9nLCBmdW5jdGlvbiAoYykge1xuXHRcdHJldHVybiBcIiVcIiArIGMuY2hhckNvZGVBdCgwKS50b1N0cmluZygxNik7XG5cdH0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGVjb2RlVVJJQ29tcG9uZW50U3RyaW5nKHN0cjogc3RyaW5nKTogc3RyaW5nIHtcblx0cmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChcblx0XHRzdHIucmVwbGFjZSgvJTNBL2csIFwiOlwiKS5yZXBsYWNlKC8lMjgvZywgXCIoXCIpLnJlcGxhY2UoLyUyOS9nLCBcIilcIilcblx0KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHByb2Nlc3NVUkkoXG5cdGRhdGFTdHJpbmc6IHN0cmluZ1xuKTogW1xuXHRwcmVmaXg6IHN0cmluZyxcblx0dGV4dDogc3RyaW5nLFxuXHRzdWZmaXg6IHN0cmluZyxcblx0ZmlsZTogc3RyaW5nLFxuXHRmcm9tOiBudW1iZXIsXG5cdHRvOiBudW1iZXIsXG5cdHBvcnRhbD86IHN0cmluZ1xuXSB7XG5cdGxldCBbcHJlZml4LCB0ZXh0LCBzdWZmaXgsIGZpbGUsIGZyb20sIHRvLCBwb3J0YWxdID0gZGF0YVN0cmluZy5zcGxpdChcIjpcIik7XG5cdHByZWZpeCA9IGRlY29kZVVSSUNvbXBvbmVudFN0cmluZyhwcmVmaXgpO1xuXHR0ZXh0ID0gZGVjb2RlVVJJQ29tcG9uZW50U3RyaW5nKHRleHQpO1xuXHRzdWZmaXggPSBkZWNvZGVVUklDb21wb25lbnRTdHJpbmcoc3VmZml4KTtcblx0ZmlsZSA9IGRlY29kZVVSSUNvbXBvbmVudFN0cmluZyhmaWxlKTtcblx0ZnJvbSA9IGRlY29kZVVSSUNvbXBvbmVudFN0cmluZyhmcm9tKTtcblx0dG8gPSBkZWNvZGVVUklDb21wb25lbnRTdHJpbmcodG8pO1xuXHRpZiAocG9ydGFsKSBwb3J0YWwgPSBkZWNvZGVVUklDb21wb25lbnRTdHJpbmcocG9ydGFsKTtcblx0cmV0dXJuIFtwcmVmaXgsIHRleHQsIHN1ZmZpeCwgZmlsZSwgcGFyc2VJbnQoZnJvbSksIHBhcnNlSW50KHRvKSwgcG9ydGFsXTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFByZWZpeEFuZFN1ZmZpeChkb2N1bWVudDogc3RyaW5nLCBmcm9tOiBudW1iZXIsIHRvOiBudW1iZXIpIHtcblx0bGV0IHByZWZpeCA9IGRvY3VtZW50XG5cdFx0LnNsaWNlKGZyb20gLSAyNSwgZnJvbSlcblx0XHQuc3BsaXQoXCJcXG5cIilcblx0XHQuc2xpY2UoLTEpWzBdO1xuXHQvLyAuc2xpY2UoZnJvbSAtIDI1ID4gMCA/IGZyb20gLSAyNSA6IDAsIGZyb20pXG5cblx0bGV0IHN1ZmZpeCA9IGRvY3VtZW50LnNsaWNlKHRvLCB0byArIDI1KS5zcGxpdChcIlxcblwiKVswXTtcblx0cmV0dXJuIHsgcHJlZml4LCBzdWZmaXggfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGZpbmRUZXh0UG9zaXRpb25zKFxuXHR0ZXh0OiBzdHJpbmcsXG5cdHNlYXJjaFRlcm06IHN0cmluZyxcblx0cHJlZml4OiBzdHJpbmcgPSBcIlwiLFxuXHRzdWZmaXg6IHN0cmluZyA9IFwiXCJcbikge1xuXHRsZXQgcm9sbGluZ0luZGV4ID0gMDtcblxuXHRjb25zdCBsaW5lcyA9IHRleHQuc3BsaXQoXCJcXG5cIikubWFwKChsaW5lOiBzdHJpbmcsIGk6IG51bWJlcikgPT4ge1xuXHRcdGxldCBkYXRhID0geyBsaW5lLCBpbmRleDogcm9sbGluZ0luZGV4LCBsZW5ndGg6IGxpbmUubGVuZ3RoICsgMSwgaSB9O1xuXHRcdHJvbGxpbmdJbmRleCArPSBkYXRhLmxlbmd0aDtcblx0XHRyZXR1cm4gZGF0YTtcblx0fSk7XG5cblx0aWYgKHRleHQuaW5jbHVkZXMocHJlZml4ICsgc2VhcmNoVGVybSArIHN1ZmZpeCkpIHtcblx0XHRsZXQgbWF0Y2hJbmRleCA9IHRleHQuaW5kZXhPZihwcmVmaXggKyBzZWFyY2hUZXJtICsgc3VmZml4KTtcblx0XHRsZXQgc3RhcnRJbmRleCA9XG5cdFx0XHRsaW5lcy5maW5kSW5kZXgoKGxpbmU6IGFueSkgPT4gbGluZS5pbmRleCA+IG1hdGNoSW5kZXggKyBwcmVmaXgubGVuZ3RoKSAtXG5cdFx0XHQxO1xuXHRcdGxldCBlbmRJbmRleCA9XG5cdFx0XHRsaW5lcy5maW5kSW5kZXgoXG5cdFx0XHRcdChsaW5lOiBhbnkpID0+XG5cdFx0XHRcdFx0bGluZS5pbmRleCA+IG1hdGNoSW5kZXggKyBwcmVmaXgubGVuZ3RoICsgc2VhcmNoVGVybS5sZW5ndGhcblx0XHRcdCkgLSAxO1xuXG5cdFx0aWYgKHN0YXJ0SW5kZXggPT0gLTIpIHN0YXJ0SW5kZXggPSBsaW5lcy5sZW5ndGggLSAxO1xuXHRcdGlmIChlbmRJbmRleCA9PSAtMikgZW5kSW5kZXggPSBsaW5lcy5sZW5ndGggLSAxO1xuXG5cdFx0cmV0dXJuIHtcblx0XHRcdHJhbmdlU3RhcnQ6IHtcblx0XHRcdFx0bGluZTogc3RhcnRJbmRleCxcblx0XHRcdFx0Y2g6IG1hdGNoSW5kZXggKyBwcmVmaXgubGVuZ3RoIC0gbGluZXNbc3RhcnRJbmRleF0uaW5kZXgsXG5cdFx0XHR9LFxuXHRcdFx0cmFuZ2VFbmQ6IHtcblx0XHRcdFx0bGluZTogZW5kSW5kZXgsXG5cdFx0XHRcdGNoOlxuXHRcdFx0XHRcdG1hdGNoSW5kZXggK1xuXHRcdFx0XHRcdHByZWZpeC5sZW5ndGggK1xuXHRcdFx0XHRcdHNlYXJjaFRlcm0ubGVuZ3RoIC1cblx0XHRcdFx0XHRsaW5lc1tlbmRJbmRleF0uaW5kZXgsXG5cdFx0XHR9LFxuXHRcdFx0bGluZXMsXG5cdFx0fTtcblx0fVxuXHRyZXR1cm4gbnVsbDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGxpc3RJdGVtTGVuZ3RoKGxpbmU6IHN0cmluZykge1xuXHQvLyBNYXRjaGVzIGxpbmVzIHRoYXQgc3RhcnQgd2l0aCBhIGJ1bGxldCAoZWl0aGVyIC0sICosIG9yICsgZm9sbG93ZWQgYnkgYSBzcGFjZSlcblx0Y29uc3QgYnVsbGV0UmVnZXggPSAvXihcXHMqWy0qK11cXHMrKS87XG5cblx0Ly8gTWF0Y2hlcyBsaW5lcyB0aGF0IHN0YXJ0IHdpdGggYSBudW1iZXIgZm9sbG93ZWQgYnkgYSBkb3QgYW5kIGEgc3BhY2UgKGxpa2UgXCIxLiBcIilcblx0Y29uc3QgbnVtYmVyUmVnZXggPSAvXihcXHMqXFxkK1xcLlxccyspLztcblxuXHRsZXQgbWF0Y2ggPSBsaW5lLm1hdGNoKGJ1bGxldFJlZ2V4KSB8fCBsaW5lLm1hdGNoKG51bWJlclJlZ2V4KTtcblx0cmV0dXJuIG1hdGNoID8gbWF0Y2hbMF0ubGVuZ3RoIDogMDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNoZWNrQ3Vyc29yUG9zaXRpb25BdERhdGFzdHJpbmcoZXZ0OiBFdmVudCk6IHtcblx0bWF0Y2hlZDogYm9vbGVhbjtcblx0c3BhbjogSFRNTFNwYW5FbGVtZW50IHwgdW5kZWZpbmVkO1xufSB7XG5cdGNvbnN0IGFjdGl2ZVZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuXHRjb25zdCBjdXJzb3JGcm9tID0gYWN0aXZlVmlldz8uZWRpdG9yLmdldEN1cnNvcihcImZyb21cIik7XG5cdGNvbnN0IGN1cnNvclRvID0gYWN0aXZlVmlldz8uZWRpdG9yLmdldEN1cnNvcihcInRvXCIpO1xuXG5cdGxldCBtYXRjaGVkID0gZmFsc2U7XG5cdGxldCBtYXRjaFNwYW46IEhUTUxTcGFuRWxlbWVudCB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZDtcblx0aWYgKFxuXHRcdGN1cnNvckZyb20gJiZcblx0XHRjdXJzb3JUbyAmJlxuXHRcdGN1cnNvckZyb20uY2ggPT0gY3Vyc29yVG8uY2ggJiZcblx0XHRjdXJzb3JGcm9tLmxpbmUgPT0gY3Vyc29yVG8ubGluZVxuXHRcdC8vICYmY3Vyc29yRnJvbS5jaCAtIDEgPj0gLTFcblx0KSB7XG5cdFx0Y29uc3QgbGluZVRleHQgPSBhY3RpdmVWaWV3Py5lZGl0b3IuZ2V0TGluZShjdXJzb3JGcm9tLmxpbmUpO1xuXG5cdFx0Ly8gZnJvbSBwb3NzaWJsZSByZWdleCBtYXRjaGVzIGluIGxpbmVUZXh0XG5cdFx0aWYgKGxpbmVUZXh0KSB7XG5cdFx0XHRjb25zdCBtYXRjaGVzID0gWy4uLmxpbmVUZXh0Lm1hdGNoQWxsKFJFRkVSRU5DRV9SRUdFWCldO1xuXHRcdFx0bWF0Y2hlcy5mb3JFYWNoKChtYXRjaCkgPT4ge1xuXHRcdFx0XHRpZiAobWF0Y2guaW5kZXg/LnRvU3RyaW5nKCkpIHtcblx0XHRcdFx0XHRjb25zdCBzdGFydDogbnVtYmVyID0gbWF0Y2guaW5kZXg7XG5cdFx0XHRcdFx0Y29uc3QgZW5kOiBudW1iZXIgPSBzdGFydCArIG1hdGNoWzBdLmxlbmd0aDtcblx0XHRcdFx0XHRpZiAoZW5kID09IGN1cnNvclRvLmNoICYmIGV2dC50YXJnZXQpIHtcblx0XHRcdFx0XHRcdGNvbnN0IGRhdGFTdHJpbmcgPSBtYXRjaFsxXTtcblx0XHRcdFx0XHRcdC8vIGdldCB0aGUgaHRtbCBlbGVtZW50IGF0IHRoZSBtYXRjaCBsb2NhdGlvblxuXHRcdFx0XHRcdFx0bGV0IGNoZWNrQ29udGFpbmVyID0gZXZ0LnRhcmdldCBpbnN0YW5jZW9mIEVsZW1lbnQ7XG5cdFx0XHRcdFx0XHRpZiAoIWNoZWNrQ29udGFpbmVyKVxuXHRcdFx0XHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoXCJFbGVtZW50IG5vdCBpbnN0YW5jZSBvZiBFbGVtZW50XCIpO1xuXHRcdFx0XHRcdFx0bGV0IGNvbnRhaW5lciA9IGV2dC50YXJnZXQgYXMgRWxlbWVudDtcblxuXHRcdFx0XHRcdFx0bGV0IGFjdGl2ZUxpbmU7XG5cdFx0XHRcdFx0XHRpZiAoY29udGFpbmVyLmNsYXNzTGlzdC5jb250YWlucyhcImNtLWFjdGl2ZVwiKSkge1xuXHRcdFx0XHRcdFx0XHRhY3RpdmVMaW5lID0gY29udGFpbmVyO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0Ly8gZWxzZSBpZiAoY29udGFpbmVyLmNsb3Nlc3QoXCIuY20tYWN0aXZlXCIpKSB7XG5cdFx0XHRcdFx0XHQvLyBcdGFjdGl2ZUxpbmUgPSBjb250YWluZXIuY2xvc2VzdChcIi5jbS1hY3RpdmVcIik7XG5cdFx0XHRcdFx0XHQvLyB9XG5cdFx0XHRcdFx0XHRlbHNlIHtcblx0XHRcdFx0XHRcdFx0YWN0aXZlTGluZSA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiLmNtLWFjdGl2ZVwiKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdGlmICghYWN0aXZlTGluZSkgdGhyb3cgbmV3IEVycm9yKFwiRWxlbWVudCBub3QgaW5zdGFuY2Ugb2YgRWxlbWVudFwiKTtcblx0XHRcdFx0XHRcdC8vIGZpbmQgaHRtbCBzcGFuIGVsZW1lbnQgaW4gdGFyZ2V0IHRoYXQgaGFzIGEgZGF0YSBhdHRyaWJ1dGUgZXF1YWwgdG8gY29udGVudHNcblx0XHRcdFx0XHRcdGxldCBzcGFuID0gYWN0aXZlTGluZS5xdWVyeVNlbGVjdG9yKGBzcGFuW2RhdGE9XCIke2RhdGFTdHJpbmd9XCJdYCk7XG5cdFx0XHRcdFx0XHRpZiAoc3BhbiAmJiBzcGFuIGluc3RhbmNlb2YgSFRNTFNwYW5FbGVtZW50KSB7XG5cdFx0XHRcdFx0XHRcdC8vIGNvbnNvbGUubG9nKFwiRm91bmQgc3BhbiBlbGVtZW50OlwiLCBzcGFuKTtcblx0XHRcdFx0XHRcdFx0Ly8gRG8gc29tZXRoaW5nIHdpdGggdGhlIHNwYW4gZWxlbWVudFxuXHRcdFx0XHRcdFx0XHRtYXRjaGVkID0gdHJ1ZTtcblxuXHRcdFx0XHRcdFx0XHRtYXRjaFNwYW4gPSBzcGFuO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0Ly8gY29uc29sZS5sb2coXCJTcGFuIGVsZW1lbnQgbm90IGZvdW5kXCIpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0fVxuXHR9XG5cdHJldHVybiB7IG1hdGNoZWQsIHNwYW46IG1hdGNoU3BhbiB9O1xufVxuXG4vLyBSZW1vdmUgYW4gZXhpc3RpbmcgaGlnbGlnaHRlZCByZWZlcmVuY2VcbmV4cG9ydCBmdW5jdGlvbiBoYW5kbGVSZW1vdmVIb3ZlcmVkQ3Vyc29yKHVzZXI6IHN0cmluZykge1xuXHRpZiAoZ2V0SG92ZXJlZEN1cnNvcigpKSB7XG5cdFx0Ly8gY3Vyc29ycyBub3QgYXNzb2NpYXRlZCB3aXRoIHRoZSB1c2VyIGFjdGlvblxuXHRcdGxldCBub25DdXJzb3JzID0gZ2V0SG92ZXJlZEN1cnNvcigpXG5cdFx0XHQuZmlsdGVyKChlbGVtZW50OiBhbnkpID0+IHtcblx0XHRcdFx0cmV0dXJuIGVsZW1lbnQudXNlciAhPT0gdXNlcjtcblx0XHRcdH0pXG5cdFx0XHQubWFwKChlbGVtZW50OiBhbnkpID0+IGVsZW1lbnQuY3Vyc29yLmNsb3Nlc3QoXCJzcGFuXCIpKTtcblxuXHRcdC8vIHdoaXRlIGJhY2tncm91bmQgaWYgY3Vyc29ycyBhcmUgbm90IGFzc29jaWF0ZWQgd2l0aCB0aGUgdXNlciBhY3Rpb25cblx0XHRnZXRIb3ZlcmVkQ3Vyc29yKClcblx0XHRcdC5maWx0ZXIoKGVsZW1lbnQ6IGFueSkgPT4gZWxlbWVudC51c2VyID09PSB1c2VyKVxuXHRcdFx0LmZvckVhY2goKGVsZW1lbnQ6IGFueSkgPT4ge1xuXHRcdFx0XHRpZiAoIW5vbkN1cnNvcnMuaW5jbHVkZXMoZWxlbWVudC5jdXJzb3IuY2xvc2VzdChcInNwYW5cIikpKSB7XG5cdFx0XHRcdFx0bGV0IHN2ZyA9IGVsZW1lbnQuY3Vyc29yO1xuXHRcdFx0XHRcdGlmICghc3ZnKSB0aHJvdyBuZXcgRXJyb3IoXCJTVkcgbm90IGZvdW5kXCIpO1xuXHRcdFx0XHRcdGlmIChzdmcuY2xhc3NMaXN0LmNvbnRhaW5zKFwicmVmZXJlbmNlLWljb25cIikpXG5cdFx0XHRcdFx0XHRzdmcuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCJ3aGl0ZVwiO1xuXHRcdFx0XHRcdGVsc2Uge1xuXHRcdFx0XHRcdFx0c3ZnLnNldEF0dHJpYnV0ZShcImZpbGxcIiwgXCJ3aGl0ZVwiKTtcblx0XHRcdFx0XHRcdHN2Zy5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIlwiO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHQvLyBlbGVtZW50LmN1cnNvci5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIndoaXRlXCI7XG5cdFx0XHRcdFx0ZWxlbWVudC5jdXJzb3Iuc3R5bGUuYm94U2hhZG93ID0gXCJub25lXCI7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXG5cdFx0cmVtb3ZlSG92ZXJlZEN1cnNvcih1c2VyKTtcblx0fVxufVxuXG5leHBvcnQgZnVuY3Rpb24gY2hlY2tGb2N1c0N1cnNvcihldnQ6IEV2ZW50KSB7XG5cdGxldCB7IG1hdGNoZWQsIHNwYW4gfSA9IGNoZWNrQ3Vyc29yUG9zaXRpb25BdERhdGFzdHJpbmcoZXZ0KTtcblxuXHRpZiAobWF0Y2hlZCAmJiBzcGFuKSB7XG5cdFx0dXBkYXRlSG92ZXJlZEN1cnNvckNvbG9yKHNwYW4sIEFDVElPTl9UWVBFLkNVUlNPUik7XG5cdFx0ZW5kUmVmZXJlbmNlQ3Vyc29yRWZmZWN0KCk7IC8vIHRoaXMgdGFrZXMgMTAwbXMgdG8gY2xvc2UgZXhpc3RpbmcgcGVlayB0YWJcblx0XHRzdGFydFJlZmVyZW5jZUVmZmVjdChzcGFuLCBBQ1RJT05fVFlQRS5DVVJTT1IpO1xuXHR9IGVsc2Uge1xuXHRcdGVuZFJlZmVyZW5jZUN1cnNvckVmZmVjdCgpO1xuXHRcdGhhbmRsZVJlbW92ZUhvdmVyZWRDdXJzb3IoQUNUSU9OX1RZUEUuQ1VSU09SKTtcblx0fVxufVxuIiwgImV4cG9ydCBsZXQgUkVGRVJFTkNFX1JFR0VYID0gL1xcW1xcdTIxOTdcXF1cXCh1cm46KFteKV0qKVxcKS9nO1xuXG5leHBvcnQgbGV0IEFDVElPTl9UWVBFID0ge1xuXHRNT1VTRTogXCJtb3VzZVwiLFxuXHRDVVJTT1I6IFwiY3Vyc29yXCIsXG5cdEJBQ0tMSU5LOiBcImJhY2tsaW5rXCIsXG59O1xuXG5leHBvcnQgbGV0IFNWR19IT1ZFUl9DT0xPUiA9IFwicmdiKDE4NywgMjE1LCAyMzApXCI7XG5leHBvcnQgbGV0IFNWR19IT1ZFUl9DT0xPUl9MSUdIVCA9IFwicmdiKDE4NywgMjE1LCAyMzAsIDAuNSlcIjtcbmV4cG9ydCBsZXQgU1ZHX0NPTE9SID0gXCJyZ2IoMjE1LCAyMzUsIDApXCI7XG5cbmV4cG9ydCBjb25zdCBSRUZFUkVOQ0VfSUNPTl9IRUlHSFQgPSAyMDtcblxuZXhwb3J0IGNvbnN0IFBPUlRBTF9URVhUX1NMSUNFX1NJWkUgPSAxMDA7XG4iLCAiaW1wb3J0IHtcblx0VEFic3RyYWN0RmlsZSxcblx0VEZpbGUsXG5cdFdvcmtzcGFjZSxcblx0V29ya3NwYWNlTGVhZixcblx0V29ya3NwYWNlUm9vdCxcblx0V29ya3NwYWNlU3BsaXQsXG5cdFdvcmtzcGFjZVRhYnMsXG59IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgZ2V0VGhhdCB9IGZyb20gXCIuL3N0YXRlXCI7XG5cbmZ1bmN0aW9uIGNvbGxlY3RMZWF2ZXNCeVRhYihcblx0c3BsaXQ6IFdvcmtzcGFjZVNwbGl0LFxuXHRyZXN1bHQ6IFtXb3Jrc3BhY2VMZWFmW11dIHwgW10gPSBbXVxuKSB7XG5cdC8vIEB0cy1pZ25vcmVcblx0Y29uc3QgdHlwZSA9IHNwbGl0LnR5cGU7XG5cdGlmICghdHlwZSkgdGhyb3cgbmV3IEVycm9yKFwiU3BsaXQgdHlwZSBub3QgZm91bmRcIik7XG5cblx0aWYgKHR5cGUgPT0gXCJ0YWJzXCIgfHwgdHlwZSA9PSBcInNwbGl0XCIpIHtcblx0XHQvLyBAdHMtaWdub3JlXG5cdFx0Y29uc3QgY2hpbGRyZW4gPSBzcGxpdC5jaGlsZHJlbjtcblx0XHRpZiAoIWNoaWxkcmVuKSB0aHJvdyBuZXcgRXJyb3IoXCJTcGxpdCBjaGlsZHJlbiBub3QgZm91bmRcIik7XG5cblx0XHRpZiAoY2hpbGRyZW4pIHtcblx0XHRcdGZvciAoY29uc3QgY2hpbGQgb2YgY2hpbGRyZW4pIHtcblx0XHRcdFx0bGV0IGVtcHR5TGlzdDogV29ya3NwYWNlTGVhZltdID0gW107XG5cblx0XHRcdFx0Y29sbGVjdExlYXZlc0J5VGFiKGNoaWxkLCByZXN1bHQpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHQvLyByZXN1bHQucHVzaChbXSk7XG5cdFx0Ly8gY29sbGVjdExlYXZlc0J5VGFiKGNoaWxkcmVuLCByZXN1bHQpO1xuXHR9IGVsc2UgaWYgKHR5cGUgPT0gXCJsZWFmXCIpIHtcblx0XHQvLyBAdHMtaWdub3JlXG5cdFx0Y29uc3QgcGFyZW50U3BsaXRJZCA9IHNwbGl0LnBhcmVudC5pZDtcblx0XHRpZiAoIXBhcmVudFNwbGl0SWQpIHRocm93IG5ldyBFcnJvcihcIlNwbGl0IHBhcmVudCBpZCBub3QgZm91bmRcIik7XG5cblx0XHQvLyBmaW5kIGFycmF5IGluZGV4IGZvciBzcGxpdCB3aXRoIGlkIHBhcmVudFNwbGl0SWRcblx0XHRsZXQgaWR4ID0gcmVzdWx0LmZpbmRJbmRleCgodGFiOiBXb3Jrc3BhY2VMZWFmW10pID0+IHtcblx0XHRcdC8vIEB0cy1pZ25vcmVcblx0XHRcdGNvbnN0IHRhYklkID0gdGFiWzBdLnBhcmVudC5pZDtcblx0XHRcdHJldHVybiB0YWJJZCA9PSBwYXJlbnRTcGxpdElkO1xuXHRcdH0pO1xuXHRcdGlmIChpZHggPT0gLTEpIHtcblx0XHRcdC8vIEB0cy1pZ25vcmVcblx0XHRcdHJlc3VsdC5wdXNoKFtzcGxpdCBhcyBXb3Jrc3BhY2VMZWFmXSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJlc3VsdFtpZHhdLnB1c2goc3BsaXQgYXMgV29ya3NwYWNlTGVhZik7XG5cdFx0fVxuXHR9XG5cblx0Ly8gaWYgKGNoaWxkcmVuKSB7XG5cdC8vIFx0Zm9yIChjb25zdCBjaGlsZCBvZiBjaGlsZHJlbikge1xuXHQvLyBcdFx0Y29sbGVjdExlYXZlc0J5VGFiKGNoaWxkLCByZXN1bHQpO1xuXHQvLyBcdH1cblx0Ly8gfVxuXHRyZXR1cm4gcmVzdWx0O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY29sbGVjdExlYXZlc0J5VGFiSGVscGVyKCkge1xuXHRjb25zdCB7IHdvcmtzcGFjZSB9ID0gZ2V0VGhhdCgpO1xuXHRjb25zdCBjdXJyTGVhZjogV29ya3NwYWNlTGVhZiA9IHdvcmtzcGFjZS5nZXRMZWFmKCk7XG5cdC8vIGNvbnN0IHJvb3RTcGxpdCA9IGZpbmRSb290U3BsaXQoY3VyckxlYWYpO1xuXHRjb25zdCByb290U3BsaXQ6IFdvcmtzcGFjZVNwbGl0ID0gY3VyckxlYWYuZ2V0Um9vdCgpO1xuXHRyZXR1cm4gY29sbGVjdExlYXZlc0J5VGFiKHJvb3RTcGxpdCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDdXJyZW50VGFiSW5kZXgobGVhdmVzQnlUYWI6IGFueVtdLCBzcGFuOiBIVE1MU3BhbkVsZW1lbnQpIHtcblx0bGV0IHdvcmtzcGFjZVRhYiA9IHNwYW4uY2xvc2VzdChcIi53b3Jrc3BhY2UtdGFic1wiKTtcblx0bGV0IGN1cnJUYWJJZHggPSBsZWF2ZXNCeVRhYi5maW5kSW5kZXgoKHRhYjogV29ya3NwYWNlTGVhZltdKSA9PiB7XG5cdFx0Y29uc3QgbGVhZlRhYiA9IHRhYlswXS52aWV3LmNvbnRhaW5lckVsLmNsb3Nlc3QoXCIud29ya3NwYWNlLXRhYnNcIik7XG5cdFx0cmV0dXJuIGxlYWZUYWIgPT0gd29ya3NwYWNlVGFiO1xuXHR9KTtcblx0cmV0dXJuIGN1cnJUYWJJZHg7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRBZGphY2VudFRhYnMoXG5cdGxlYXZlc0J5VGFiOiBhbnlbXSxcblx0Y3VyclRhYklkeDogbnVtYmVyLFxuXHRmaWxlOiBzdHJpbmdcbikge1xuXHRsZXQgcmlnaHRBZGphY2VudFRhYjogYW55W10gPSBbXTtcblx0bGV0IGxlZnRBZGphY2VudFRhYjogYW55W10gPSBbXTtcblx0bGV0IGFkamFjZW50VGFiczogYW55W10gPSBbXTtcblxuXHRpZiAobGVhdmVzQnlUYWJbY3VyclRhYklkeCArIDFdKSB7XG5cdFx0cmlnaHRBZGphY2VudFRhYiA9IGxlYXZlc0J5VGFiW2N1cnJUYWJJZHggKyAxXTtcblx0XHRhZGphY2VudFRhYnMgPSBbLi4uYWRqYWNlbnRUYWJzLCAuLi5yaWdodEFkamFjZW50VGFiXTtcblx0fVxuXHRpZiAobGVhdmVzQnlUYWJbY3VyclRhYklkeCAtIDFdKSB7XG5cdFx0bGVmdEFkamFjZW50VGFiID0gbGVhdmVzQnlUYWJbY3VyclRhYklkeCAtIDFdO1xuXHRcdGFkamFjZW50VGFicyA9IFsuLi5hZGphY2VudFRhYnMsIC4uLmxlZnRBZGphY2VudFRhYl07XG5cdH1cblxuXHRsZXQgaW5kZXggPSBhZGphY2VudFRhYnMuZmluZEluZGV4KFxuXHRcdCh4OiBXb3Jrc3BhY2VMZWFmKSA9PiB4LmdldFZpZXdTdGF0ZSgpLnN0YXRlLmZpbGUgPT0gZmlsZVxuXHQpO1xuXHRyZXR1cm4geyBhZGphY2VudFRhYnMsIHJpZ2h0QWRqYWNlbnRUYWIsIGxlZnRBZGphY2VudFRhYiwgaW5kZXggfTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIG9wZW5GaWxlSW5BZGphY2VudFRhYihcblx0bGVhdmVzQnlUYWI6IGFueVtdLFxuXHRjdXJyVGFiSWR4OiBudW1iZXIsXG5cdGZpbGU6IHN0cmluZyxcblx0dHlwZT86IHN0cmluZ1xuKSB7XG5cdGxldCB7IGFkamFjZW50VGFicywgcmlnaHRBZGphY2VudFRhYiwgbGVmdEFkamFjZW50VGFiIH0gPSBnZXRBZGphY2VudFRhYnMoXG5cdFx0bGVhdmVzQnlUYWIsXG5cdFx0Y3VyclRhYklkeCxcblx0XHRmaWxlXG5cdCk7XG5cblx0bGV0IGFsbFRhYk5hbWVzID0gbGVhdmVzQnlUYWIubWFwKCh0YWI6IFdvcmtzcGFjZUxlYWZbXSkgPT5cblx0XHR0YWIubWFwKCh4OiBXb3Jrc3BhY2VMZWFmKSA9PiB4LmdldFZpZXdTdGF0ZSgpLnN0YXRlLmZpbGUpXG5cdCk7XG5cdGxldCByaWdodEFkamFjZW50VGFiTmFtZXMgPSByaWdodEFkamFjZW50VGFiLm1hcChcblx0XHQoeDogV29ya3NwYWNlTGVhZikgPT4geC5nZXRWaWV3U3RhdGUoKS5zdGF0ZS5maWxlXG5cdCk7XG5cdGxldCBsZWZ0QWRqYWNlbnRUYWJOYW1lcyA9IGxlZnRBZGphY2VudFRhYi5tYXAoXG5cdFx0KHg6IFdvcmtzcGFjZUxlYWYpID0+IHguZ2V0Vmlld1N0YXRlKCkuc3RhdGUuZmlsZVxuXHQpO1xuXHRjb25zdCB7IHdvcmtzcGFjZSB9ID0gZ2V0VGhhdCgpO1xuXHRpZiAoXG5cdFx0YWxsVGFiTmFtZXNcblx0XHRcdC5maWx0ZXIoKHYsIGkpID0+IGkgIT0gY3VyclRhYklkeClcblx0XHRcdC5mbGF0KClcblx0XHRcdC5pbmNsdWRlcyhmaWxlKSAmJlxuXHRcdCFyaWdodEFkamFjZW50VGFiTmFtZXMuaW5jbHVkZXMoZmlsZSkgJiZcblx0XHQhbGVmdEFkamFjZW50VGFiTmFtZXMuaW5jbHVkZXMoZmlsZSlcblx0KSB7XG5cdFx0Ly8gZmlsZSBleGlzdHMsIG5vdCBhZGphY2VudCBsZWZ0IG9yIHJpZ2h0IHRhYlxuXHRcdGxldCBjdXJyZW50VGFiTmFtZXM6IGFueVtdID0gW107XG5cdFx0bGV0IGN1cnJlbnRUYWI6IGFueVtdID0gW107XG5cdFx0YWxsVGFiTmFtZXMuZm9yRWFjaCgodGFiTmFtZXMsIGkpID0+IHtcblx0XHRcdGlmIChcblx0XHRcdFx0dGFiTmFtZXMgIT0gcmlnaHRBZGphY2VudFRhYk5hbWVzICYmXG5cdFx0XHRcdHRhYk5hbWVzICE9IGxlZnRBZGphY2VudFRhYk5hbWVzICYmXG5cdFx0XHRcdGN1cnJUYWJJZHggIT0gaVxuXHRcdFx0KSB7XG5cdFx0XHRcdGlmICh0YWJOYW1lcy5pbmNsdWRlcyhmaWxlKSkge1xuXHRcdFx0XHRcdGN1cnJlbnRUYWJOYW1lcyA9IHRhYk5hbWVzO1xuXHRcdFx0XHRcdGN1cnJlbnRUYWIgPSBsZWF2ZXNCeVRhYltpXTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0Y29uc3Qgb3JpZ2luYWxMZWFmID0gY3VycmVudFRhYi5maWx0ZXIoXG5cdFx0XHQodCkgPT4gdC5jb250YWluZXJFbC5zdHlsZS5kaXNwbGF5ICE9IFwibm9uZVwiXG5cdFx0KVswXTtcblx0XHRsZXQgbGVhZiA9IGN1cnJlbnRUYWJbY3VycmVudFRhYk5hbWVzLmluZGV4T2YoZmlsZSldO1xuXHRcdHdvcmtzcGFjZS5yZXZlYWxMZWFmKGxlYWYpO1xuXG5cdFx0cmV0dXJuIHsgbmV3TGVhZjogbGVhZiwgdGVtcDogZmFsc2UsIG9yaWdpbmFsTGVhZiB9O1xuXHR9IGVsc2UgaWYgKHJpZ2h0QWRqYWNlbnRUYWJOYW1lcy5pbmNsdWRlcyhmaWxlKSkge1xuXHRcdC8vIGZpbGUgZXhpc3RzIGluIHJpZ2h0IHRhYlxuXHRcdGNvbnN0IG9yaWdpbmFsTGVhZiA9IHJpZ2h0QWRqYWNlbnRUYWIuZmlsdGVyKFxuXHRcdFx0KHQpID0+IHQuY29udGFpbmVyRWwuc3R5bGUuZGlzcGxheSAhPSBcIm5vbmVcIlxuXHRcdClbMF07XG5cdFx0bGV0IGxlYWYgPSByaWdodEFkamFjZW50VGFiW3JpZ2h0QWRqYWNlbnRUYWJOYW1lcy5pbmRleE9mKGZpbGUpXTtcblx0XHR3b3Jrc3BhY2UucmV2ZWFsTGVhZihsZWFmKTtcblx0XHRyZXR1cm4geyBuZXdMZWFmOiBsZWFmLCB0ZW1wOiBmYWxzZSwgb3JpZ2luYWxMZWFmIH07XG5cdH0gZWxzZSBpZiAobGVmdEFkamFjZW50VGFiTmFtZXMuaW5jbHVkZXMoZmlsZSkpIHtcblx0XHQvLyBmaWxlIGV4aXN0cyBpbiBsZWZ0IHRhYlxuXHRcdGNvbnN0IG9yaWdpbmFsTGVhZiA9IGxlZnRBZGphY2VudFRhYi5maWx0ZXIoXG5cdFx0XHQodCkgPT4gdC5jb250YWluZXJFbC5zdHlsZS5kaXNwbGF5ICE9IFwibm9uZVwiXG5cdFx0KVswXTtcblxuXHRcdGxldCBsZWFmID0gbGVmdEFkamFjZW50VGFiW2xlZnRBZGphY2VudFRhYk5hbWVzLmluZGV4T2YoZmlsZSldO1xuXHRcdHdvcmtzcGFjZS5yZXZlYWxMZWFmKGxlYWYpO1xuXHRcdHJldHVybiB7IG5ld0xlYWY6IGxlYWYsIHRlbXA6IGZhbHNlLCBvcmlnaW5hbExlYWYgfTtcblx0fSBlbHNlIGlmIChyaWdodEFkamFjZW50VGFiLmxlbmd0aCA+IDApIHtcblx0XHQvLyB0aGVyZSBleGlzdHMgYSByaWdodCB0YWJcblx0XHRjb25zdCBvcmlnaW5hbExlYWYgPSByaWdodEFkamFjZW50VGFiLmZpbHRlcihcblx0XHRcdCh0KSA9PiB0LmNvbnRhaW5lckVsLnN0eWxlLmRpc3BsYXkgIT0gXCJub25lXCJcblx0XHQpWzBdO1xuXG5cdFx0bGV0IGN1cnJMZWFmID0gd29ya3NwYWNlLmdldExlYWYoKTtcblx0XHR3b3Jrc3BhY2Uuc2V0QWN0aXZlTGVhZihvcmlnaW5hbExlYWYpO1xuXHRcdGxldCBuZXdMZWFmID0gd29ya3NwYWNlLmdldExlYWYodHJ1ZSk7XG5cdFx0YXdhaXQgb3BlbkZpbGVJbkxlYWYobmV3TGVhZiwgZmlsZSk7XG5cdFx0d29ya3NwYWNlLnJldmVhbExlYWYobmV3TGVhZik7XG5cdFx0d29ya3NwYWNlLnNldEFjdGl2ZUxlYWYoY3VyckxlYWYpO1xuXHRcdHJldHVybiB7IG5ld0xlYWYsIHRlbXA6IHRydWUsIG9yaWdpbmFsTGVhZiB9O1xuXHR9IGVsc2UgaWYgKGxlZnRBZGphY2VudFRhYi5sZW5ndGggPiAwKSB7XG5cdFx0Ly8gdGhlcmUgZXhpc3RzIGEgbGVmdCB0YWJcblx0XHRjb25zdCBvcmlnaW5hbExlYWYgPSBsZWZ0QWRqYWNlbnRUYWIuZmlsdGVyKFxuXHRcdFx0KHQpID0+IHQuY29udGFpbmVyRWwuc3R5bGUuZGlzcGxheSAhPSBcIm5vbmVcIlxuXHRcdClbMF07XG5cblx0XHRsZXQgY3VyckxlYWYgPSB3b3Jrc3BhY2UuZ2V0TGVhZigpOyAvLyBnZXQgY3VycmVudCBhY3RpdmUgbGVhZlxuXHRcdHdvcmtzcGFjZS5zZXRBY3RpdmVMZWFmKG9yaWdpbmFsTGVhZik7IC8vIGdldCB0aGUgbGVhZiBpbiBhZGphY2VudCB0YWJcblx0XHRsZXQgbmV3TGVhZiA9IHdvcmtzcGFjZS5nZXRMZWFmKHRydWUpOyAvLyBjcmVhdGUgYSBuZXcgbGVhZlxuXHRcdGF3YWl0IG9wZW5GaWxlSW5MZWFmKG5ld0xlYWYsIGZpbGUpOyAvLyBsb2FkIGZpbGUgaW50byBuZXcgbGVhZlxuXHRcdHdvcmtzcGFjZS5yZXZlYWxMZWFmKG5ld0xlYWYpOyAvLyByZXZlYWwgbmV3IGxlYWZcblx0XHR3b3Jrc3BhY2Uuc2V0QWN0aXZlTGVhZihjdXJyTGVhZik7IC8vIHNldCBhY3RpdmUgbGVhZiBiYWNrIHRvIG9yaWdpbmFsXG5cdFx0cmV0dXJuIHsgbmV3TGVhZiwgdGVtcDogdHJ1ZSwgb3JpZ2luYWxMZWFmIH07XG5cdH0gZWxzZSB7XG5cdFx0Ly8gbm8gYWRqYWNlbnQgdGFic1xuXHRcdGNvbnN0IGN1cnJMZWFmID0gd29ya3NwYWNlLmdldExlYWYoKTtcblx0XHRsZXQgbmV3TGVhZiA9IHdvcmtzcGFjZS5jcmVhdGVMZWFmQnlTcGxpdChjdXJyTGVhZik7XG5cdFx0YXdhaXQgb3BlbkZpbGVJbkxlYWYobmV3TGVhZiwgZmlsZSk7XG5cdFx0cmV0dXJuIHsgbmV3TGVhZiwgdGVtcDogdHJ1ZSB9O1xuXHR9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBvcGVuRmlsZUluTGVhZihsZWFmOiBXb3Jrc3BhY2VMZWFmLCBmaWxlOiBzdHJpbmcpIHtcblx0bGV0IHRhcmdldEZpbGU6IFRBYnN0cmFjdEZpbGUgfCBudWxsID1cblx0XHRnZXRUaGF0KCkudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGUpO1xuXHRpZiAodGFyZ2V0RmlsZSAmJiB0YXJnZXRGaWxlIGluc3RhbmNlb2YgVEZpbGUpXG5cdFx0YXdhaXQgbGVhZi5vcGVuRmlsZSh0YXJnZXRGaWxlLCB7IGFjdGl2ZTogZmFsc2UgfSk7XG59XG4iLCAiaW1wb3J0IHtcblx0c3RhdGUsXG5cdHVwZGF0ZUN1cnNvcixcblx0dXBkYXRlSG92ZXIsXG5cdGdldEN1cnNvcixcblx0Z2V0SG92ZXIsXG5cdHJlc2V0SG92ZXIsXG5cdHJlc2V0Q3Vyc29yLFxuXHRnZXRUaGF0LFxuXHRnZXRCYWNrbGlua0hvdmVyLFxuXHR1cGRhdGVCYWNrbGlua0hvdmVyLFxuXHRyZXNldEJhY2tsaW5rSG92ZXIsXG5cdHVwZGF0ZUhvdmVyZWRDdXJzb3IsXG59IGZyb20gXCIuL3N0YXRlXCI7XG5pbXBvcnQgeyBBQ1RJT05fVFlQRSwgUkVGRVJFTkNFX1JFR0VYLCBTVkdfSE9WRVJfQ09MT1IgfSBmcm9tIFwiLi9jb25zdGFudHNcIjtcbmltcG9ydCB7XG5cdGNvbGxlY3RMZWF2ZXNCeVRhYkhlbHBlcixcblx0Z2V0Q3VycmVudFRhYkluZGV4LFxuXHRvcGVuRmlsZUluQWRqYWNlbnRUYWIsXG59IGZyb20gXCIuL3dvcmtzcGFjZVwiO1xuaW1wb3J0IHtcblx0cHJvY2Vzc1VSSSxcblx0ZGVjb2RlVVJJQ29tcG9uZW50U3RyaW5nLFxuXHRmaW5kVGV4dFBvc2l0aW9ucyxcblx0bGlzdEl0ZW1MZW5ndGgsXG5cdGhhbmRsZVJlbW92ZUhvdmVyZWRDdXJzb3IsXG59IGZyb20gXCIuL3V0aWxzXCI7XG5pbXBvcnQge1xuXHRFZGl0b3IsXG5cdE1hcmtkb3duRWRpdFZpZXcsXG5cdE1hcmtkb3duVmlldyxcblx0V29ya3NwYWNlSXRlbSxcblx0V29ya3NwYWNlTGVhZixcbn0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBoaWdobGlnaHRTZWxlY3Rpb24sIHJlbW92ZUhpZ2hsaWdodHMgfSBmcm9tIFwiLi9tYXJrXCI7XG5pbXBvcnQgeyBFZGl0b3JWaWV3IH0gZnJvbSBcIkBjb2RlbWlycm9yL3ZpZXdcIjtcbmltcG9ydCB7XG5cdGdldEJhY2tsaW5rQ29udGFpbmVyLFxuXHRnZXRDb250YWluZXJFbGVtZW50LFxuXHRnZXRMZWFmQkJveEVsZW1lbnRzLFxuXHRnZXRNYXJrZG93blZpZXcsXG5cdHVwZGF0ZUJhY2tsaW5rTWFya1Bvc2l0aW9uLFxuXHR1cGRhdGVCYWNrbGlua01hcmtQb3NpdGlvbnMsXG59IGZyb20gXCIuL3JlZmVyZW5jZXNcIjtcblxuZnVuY3Rpb24gZ2V0RWRpdG9yVmlldyhsZWFmOiBXb3Jrc3BhY2VMZWFmKSB7XG5cdGlmICghbGVhZikgcmV0dXJuIG51bGw7XG5cdGNvbnN0IHZpZXcgPSBsZWFmLnZpZXc7XG5cblx0Ly8gQHRzLWlnbm9yZVxuXHRjb25zdCBlZGl0b3IgPSB2aWV3LnNvdXJjZU1vZGU/LmNtRWRpdG9yO1xuXG5cdC8vICdlZGl0b3InIGhlcmUgaXMgYW4gaW5zdGFuY2Ugb2YgJ0VkaXRvcicsIGFuIGFic3RyYWN0aW9uIG92ZXIgQ001IGFuZCBDTTYuXG5cdC8vIENoZWNraW5nIGZvciAnQ29kZU1pcnJvcicgd291bGQgaW5kaWNhdGUgQ001LlxuXHRpZiAoIWVkaXRvci5Db2RlTWlycm9yICYmIGVkaXRvci5jbSBpbnN0YW5jZW9mIEVkaXRvclZpZXcpIHtcblx0XHQvLyBZb3Ugbm93IGhhdmUgYWNjZXNzIHRvIHRoZSBDb2RlTWlycm9yIDYgRWRpdG9yVmlldyBpbnN0YW5jZS5cblx0XHRjb25zdCBlZGl0b3JWaWV3ID0gZWRpdG9yLmNtO1xuXG5cdFx0cmV0dXJuIGVkaXRvclZpZXc7XG5cblx0XHQvLyBZb3UgY2FuIG5vdyB1c2UgdGhlIENvZGVNaXJyb3IgNiBBUEkgd2l0aCBgZWRpdG9yVmlld2AuXG5cdH1cblx0cmV0dXJuIG51bGw7XG59XG5cbmZ1bmN0aW9uIGNoZWNrU3BhbkVsZW1lbnRFeGlzdHMoXG5cdHNwYW46IEhUTUxTcGFuRWxlbWVudCxcblx0Y29udGFpbmVyRWw6IEhUTUxFbGVtZW50XG4pOiBib29sZWFuIHtcblx0Y29uc3Qgc3BhbkVsZW1lbnRzID0gY29udGFpbmVyRWwuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJzcGFuXCIpO1xuXHRmb3IgKGxldCBpID0gMDsgaSA8IHNwYW5FbGVtZW50cy5sZW5ndGg7IGkrKykge1xuXHRcdGlmIChzcGFuRWxlbWVudHNbaV0gPT09IHNwYW4pIHtcblx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblx0fVxuXHRyZXR1cm4gZmFsc2U7XG59XG5cbmZ1bmN0aW9uIHBhcnNlQ1NTU3RyaW5nKGNzczogc3RyaW5nKSB7XG5cdC8vIFVzZSBhIHJlZ3VsYXIgZXhwcmVzc2lvbiB0byBtYXRjaCBrZXktdmFsdWUgcGFpcnMgaW4gdGhlIENTUyBzdHJpbmdcblx0Y29uc3QgY3NzUHJvcGVydGllc1JlZ2V4ID0gLyhbXFx3LV0rKVxccyo6XFxzKihbXjtdKylcXHMqOz8vZztcblxuXHQvLyBJbml0aWFsaXplIGFuIGVtcHR5IG9iamVjdCB0byBzdG9yZSB0aGUgQ1NTIHByb3BlcnRpZXNcblx0bGV0IGNzc1Byb3BlcnRpZXNPYmplY3Q6IGFueSA9IHt9O1xuXG5cdC8vIEl0ZXJhdGUgb3ZlciBhbGwga2V5LXZhbHVlIHBhaXJzIGZvdW5kIGJ5IHRoZSByZWdleFxuXHRsZXQgbWF0Y2g7XG5cdHdoaWxlICgobWF0Y2ggPSBjc3NQcm9wZXJ0aWVzUmVnZXguZXhlYyhjc3MpKSAhPT0gbnVsbCkge1xuXHRcdC8vIG1hdGNoWzFdIGlzIHRoZSBrZXlcblx0XHQvLyBtYXRjaFsyXSBpcyB0aGUgdmFsdWVcblx0XHRjc3NQcm9wZXJ0aWVzT2JqZWN0W21hdGNoWzFdXSA9IG1hdGNoWzJdO1xuXHR9XG5cblx0cmV0dXJuIGNzc1Byb3BlcnRpZXNPYmplY3Q7XG59XG5cbmZ1bmN0aW9uIGRlbGF5KG1pbGxpc2Vjb25kczogYW55KSB7XG5cdHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuXHRcdHNldFRpbWVvdXQocmVzb2x2ZSwgbWlsbGlzZWNvbmRzKTtcblx0fSk7XG59XG5cbmZ1bmN0aW9uIHRlbXBEaXJlY3Rpb25JbmRpY2F0b3IoXG5cdGxlYWY6IGFueSxcblx0dGV4dDogc3RyaW5nLFxuXHRwcmVmaXg6IHN0cmluZyxcblx0c3VmZml4OiBzdHJpbmcsXG5cdGRhdGFTdHJpbmc6IHN0cmluZyxcblx0dXNlcj86IHN0cmluZyxcblx0aXNTYW1lPzogYm9vbGVhblxuKSB7XG5cdGxldCBwb3NpdGlvbnMgPSBmaW5kVGV4dFBvc2l0aW9ucyhcblx0XHRsZWFmLnZpZXcuZGF0YSxcblx0XHR0ZXh0LFxuXHRcdHByZWZpeC5zbGljZSgwLCBwcmVmaXgubGVuZ3RoIC0gMSksXG5cdFx0c3VmZml4LnNsaWNlKDEsIHN1ZmZpeC5sZW5ndGgpXG5cdCk7XG5cdGlmICghcG9zaXRpb25zKSB0aHJvdyBuZXcgRXJyb3IoXCJQb3NpdGlvbnMgbm90IGZvdW5kXCIpO1xuXHRsZXQgcmFuZ2VTdGFydCA9IHBvc2l0aW9ucy5yYW5nZVN0YXJ0O1xuXHRsZXQgcmFuZ2VFbmQgPSBwb3NpdGlvbnMucmFuZ2VFbmQ7XG5cblx0aWYgKHVzZXIgPT09IEFDVElPTl9UWVBFLkJBQ0tMSU5LKSB7XG5cdFx0bGV0IHN0YXJ0VG9wID0gbGVhZi52aWV3LmVkaXRvci5nZXRTY3JvbGxJbmZvKCkudG9wO1xuXG5cdFx0bGVhZi52aWV3LmVkaXRvci5zY3JvbGxJbnRvVmlldyhcblx0XHRcdHtcblx0XHRcdFx0ZnJvbTogT2JqZWN0LmFzc2lnbihyYW5nZVN0YXJ0LCB7IGNoOiAwIH0pLFxuXHRcdFx0XHR0bzogT2JqZWN0LmFzc2lnbihyYW5nZUVuZCwgeyBjaDogMCB9KSxcblx0XHRcdH0sXG5cdFx0XHR0cnVlXG5cdFx0KTtcblx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdC8vIGlmICh0ZW1wKSByZXR1cm47XG5cdFx0XHRsZXQgZW5kVG9wID0gbGVhZi52aWV3LmVkaXRvci5nZXRTY3JvbGxJbmZvKCkudG9wO1xuXHRcdFx0aWYgKHN0YXJ0VG9wID09PSBlbmRUb3AgJiYgaXNTYW1lKSB7XG5cdFx0XHRcdGxlYWYuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvcihcIi52aWV3LWNvbnRlbnRcIikuc3R5bGUuYm94U2hhZG93ID1cblx0XHRcdFx0XHRcIm5vbmVcIjtcblx0XHRcdH0gZWxzZSBpZiAoc3RhcnRUb3AgPT09IGVuZFRvcCB8fCAhaXNTYW1lKSB7XG5cdFx0XHRcdGxlYWYuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvcihcIi52aWV3LWNvbnRlbnRcIikuc3R5bGUuYm94U2hhZG93ID1cblx0XHRcdFx0XHRcImluc2V0IDBweCAwcHggMTBweCAxMHB4IHJnYmEoMjQ4LCAyNTUsIDI1NSlcIjtcblx0XHRcdH0gZWxzZSBpZiAoc3RhcnRUb3AgPCBlbmRUb3ApIHtcblx0XHRcdFx0Ly8gc2hvdyBtYXJrIGFib3ZlXG5cdFx0XHRcdC8vIG5ld0xlYWYuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvcihcIi52aWV3LWNvbnRlbnRcIikuc3R5bGUuYm94U2hhZG93ID1cblx0XHRcdFx0Ly8gXHRcImluc2V0IDBweCAwcHggMTBweCAxMHB4IHJnYmEoMjQ4LCAyNTUsIDI1NSlcIjtcblx0XHRcdFx0bGVhZi5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKFwiLnZpZXctY29udGVudFwiKS5zdHlsZS5ib3hTaGFkb3cgPVxuXHRcdFx0XHRcdFwiaW5zZXQgMHB4IDIwcHggMjBweCAwcHggcmdiYSgyNDgsIDI1NSwgMjU1KVwiO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gc2hvdyBtYXJrIGJlbG93XG5cdFx0XHRcdGxlYWYuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvcihcIi52aWV3LWNvbnRlbnRcIikuc3R5bGUuYm94U2hhZG93ID1cblx0XHRcdFx0XHRcImluc2V0IDBweCAtMzBweCAyMHB4IDBweCByZ2JhKDI0OCwgMjU1LCAyNTUpXCI7XG5cdFx0XHR9XG5cdFx0fSwgMTApO1xuXG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0Ly8gT2ghIElcdTIwMTlkIGNvbXBhcmUgdGhlIGJib3ggb2YgdGhlIHJhbmdlXG5cdC8vICh3aGljaCBJIGtub3cgeW91IGZpbmQgaW4gdGhlIG1hcmsgbGF5b3V0IHJvdXRpbmUpXG5cdC8vIHRvIHRoZSBzY3JvbGxUb3AgKyBpbm5lckhlaWdodFxuXHRjb25zdCBlZGl0b3IgPSBnZXRNYXJrZG93blZpZXcobGVhZikuZWRpdG9yO1xuXHRjb25zdCBiYWNrbGlua0NvbnRhaW5lciA9IGdldEJhY2tsaW5rQ29udGFpbmVyKGVkaXRvcik7XG5cblx0Y29uc3Qgd2luZG93SGVpZ2h0ID0gbGVhZi52aWV3LmNvbnRhaW5lckVsXG5cdFx0LnF1ZXJ5U2VsZWN0b3IoXCIuY20tc2Nyb2xsZXJcIilcblx0XHQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0O1xuXHRjb25zdCBzY3JvbGxUb3AgPVxuXHRcdGxlYWYudmlldy5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKFwiLmNtLXNjcm9sbGVyXCIpLnNjcm9sbFRvcDtcblx0Y29uc3Qgc2Nyb2xsQm90dG9tID0gc2Nyb2xsVG9wICsgd2luZG93SGVpZ2h0O1xuXG5cdGxldCB2aXNpYmxlRWxlbWVudHM6IHN0cmluZ1tdID0gW107XG5cdGZvciAobGV0IGkgPSAwOyBpIDwgYmFja2xpbmtDb250YWluZXIuY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcblx0XHRsZXQgc3R5bGUgPSBiYWNrbGlua0NvbnRhaW5lci5jaGlsZHJlbltpXS5nZXRBdHRyaWJ1dGUoXCJzdHlsZVwiKTtcblx0XHRpZiAoc3R5bGUgPT0gbnVsbCkgY29udGludWU7XG5cdFx0bGV0IGNzc1Byb3BlcnRpZXMgPSBwYXJzZUNTU1N0cmluZyhzdHlsZSk7XG5cdFx0bGV0IHRvcCA9IHBhcnNlRmxvYXQoY3NzUHJvcGVydGllc1tcInRvcFwiXS5yZXBsYWNlKFwicHhcIiwgXCJcIikpO1xuXHRcdGlmICh0b3AgPT0gbnVsbCkgY29udGludWU7XG5cblx0XHRpZiAoXG5cdFx0XHRzY3JvbGxUb3AgPD0gdG9wICYmXG5cdFx0XHR0b3AgPD0gc2Nyb2xsQm90dG9tICYmXG5cdFx0XHRiYWNrbGlua0NvbnRhaW5lci5jaGlsZHJlbltpXVxuXHRcdCkge1xuXHRcdFx0bGV0IHJlZmVyZW5jZSA9IGJhY2tsaW5rQ29udGFpbmVyLmNoaWxkcmVuW2ldLmdldEF0dHJpYnV0ZShcInJlZmVyZW5jZVwiKTtcblx0XHRcdGlmIChyZWZlcmVuY2UpIHtcblx0XHRcdFx0dmlzaWJsZUVsZW1lbnRzLnB1c2goSlNPTi5wYXJzZShyZWZlcmVuY2UpLmRhdGFTdHJpbmcpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdGlmICghdmlzaWJsZUVsZW1lbnRzLmluY2x1ZGVzKGRhdGFTdHJpbmcpKSB7XG5cdFx0bGV0IHN0YXJ0VG9wID0gbGVhZi52aWV3LmVkaXRvci5nZXRTY3JvbGxJbmZvKCkudG9wO1xuXHRcdC8vIGxldCBzdGFydFRvcDogbnVtYmVyO1xuXHRcdC8vIGlmIChvcmlnaW5hbFRvcCkge1xuXHRcdC8vIFx0c3RhcnRUb3AgPSBvcmlnaW5hbFRvcDtcblx0XHQvLyB9IGVsc2Uge1xuXHRcdC8vIFx0c3RhcnRUb3AgPSBsZWFmLnZpZXcuZWRpdG9yLmdldFNjcm9sbEluZm8oKS50b3A7XG5cdFx0Ly8gXHRpZiAodXNlciA9PSBBQ1RJT05fVFlQRS5DVVJTT1IpIHtcblx0XHQvLyBcdFx0dXBkYXRlQ3Vyc29yKHtcblx0XHQvLyBcdFx0XHRvcmlnaW5hbFRvcDogc3RhcnRUb3AsXG5cdFx0Ly8gXHRcdH0pO1xuXHRcdC8vIFx0fSBlbHNlIGlmICh1c2VyID09IEFDVElPTl9UWVBFLk1PVVNFKSB7XG5cdFx0Ly8gXHRcdHVwZGF0ZUhvdmVyKHtcblx0XHQvLyBcdFx0XHRvcmlnaW5hbFRvcDogc3RhcnRUb3AsXG5cdFx0Ly8gXHRcdH0pO1xuXHRcdC8vIFx0fVxuXHRcdC8vIH1cblxuXHRcdGxlYWYudmlldy5lZGl0b3Iuc2Nyb2xsSW50b1ZpZXcoXG5cdFx0XHR7XG5cdFx0XHRcdGZyb206IHJhbmdlU3RhcnQsXG5cdFx0XHRcdHRvOiByYW5nZUVuZCxcblx0XHRcdH0sXG5cdFx0XHR0cnVlXG5cdFx0KTtcblx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdC8vIGlmICh0ZW1wKSByZXR1cm47XG5cdFx0XHRsZXQgZW5kVG9wID0gbGVhZi52aWV3LmVkaXRvci5nZXRTY3JvbGxJbmZvKCkudG9wO1xuXHRcdFx0aWYgKHN0YXJ0VG9wIDwgZW5kVG9wKSB7XG5cdFx0XHRcdC8vIHNob3cgbWFyayBhYm92ZVxuXHRcdFx0XHQvLyBuZXdMZWFmLmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoXCIudmlldy1jb250ZW50XCIpLnN0eWxlLmJveFNoYWRvdyA9XG5cdFx0XHRcdC8vIFx0XCJpbnNldCAwcHggMHB4IDEwcHggMTBweCByZ2JhKDI0OCwgMjU1LCAyNTUpXCI7XG5cdFx0XHRcdGxlYWYuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvcihcIi52aWV3LWNvbnRlbnRcIikuc3R5bGUuYm94U2hhZG93ID1cblx0XHRcdFx0XHRcImluc2V0IDBweCAyMHB4IDIwcHggMHB4IHJnYmEoMjQ4LCAyNTUsIDI1NSlcIjtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIHNob3cgbWFyayBiZWxvd1xuXHRcdFx0XHRsZWFmLmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoXCIudmlldy1jb250ZW50XCIpLnN0eWxlLmJveFNoYWRvdyA9XG5cdFx0XHRcdFx0XCJpbnNldCAwcHggLTMwcHggMjBweCAwcHggcmdiYSgyNDgsIDI1NSwgMjU1KVwiO1xuXHRcdFx0fVxuXHRcdH0sIDEwKTtcblx0fVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc3RhcnRCYWNrbGlua0VmZmVjdChzcGFuOiBIVE1MU3BhbkVsZW1lbnQpIHtcblx0bGV0IHNvdXJjZSA9IGdldEJhY2tsaW5rSG92ZXIoKTtcblx0bGV0IGRlc3RpbmF0aW9uID0gZ2V0Q3Vyc29yKCk7XG5cdGxldCB1cGRhdGVTdGF0ZSA9IHVwZGF0ZUJhY2tsaW5rSG92ZXI7XG5cblx0Ly8gTXV0ZXgsIHByZXZlbnQgY29uY3VycmVudCBhY2Nlc3MgdG8gZm9sbG93aW5nIHNlY3Rpb24gb2YgY29kZVxuXHRpZiAoc291cmNlICE9IG51bGwpIHJldHVybjtcblx0dXBkYXRlU3RhdGUoe1xuXHRcdHR5cGU6IGAke0FDVElPTl9UWVBFLkJBQ0tMSU5LfS1zdGFydGAsXG5cdH0pO1xuXG5cdGNvbnN0IHJlZmVyZW5jZURhdGEgPSBzcGFuLmdldEF0dHJpYnV0ZShcInJlZmVyZW5jZVwiKTtcblx0aWYgKCFyZWZlcmVuY2VEYXRhKSB0aHJvdyBuZXcgRXJyb3IoXCJSZWZlcmVuY2UgZGF0YSBub3QgZm91bmRcIik7XG5cblx0Y29uc3QgYmFja2xpbmsgPSBKU09OLnBhcnNlKHJlZmVyZW5jZURhdGEpO1xuXHRjb25zdCBkYXRhU3RyaW5nID0gYmFja2xpbmsuZGF0YVN0cmluZztcblxuXHRpZiAoZGVzdGluYXRpb24gIT0gbnVsbCAmJiBkZXN0aW5hdGlvbi5kYXRhU3RyaW5nID09IGRhdGFTdHJpbmcpIHtcblx0XHR1cGRhdGVTdGF0ZShkZXN0aW5hdGlvbik7XG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0bGV0IFtwcmVmaXgsIHRleHQsIHN1ZmZpeCwgZmlsZSwgZnJvbSwgdG9dID0gcHJvY2Vzc1VSSShkYXRhU3RyaW5nKTtcblxuXHRsZXQgbGVhdmVzQnlUYWIgPSBjb2xsZWN0TGVhdmVzQnlUYWJIZWxwZXIoKTtcblxuXHRsZXQgY3VyclRhYklkeCA9IGdldEN1cnJlbnRUYWJJbmRleChsZWF2ZXNCeVRhYiwgc3Bhbik7XG5cblx0bGV0IGJhY2tsaW5rTGVhZiA9IGxlYXZlc0J5VGFiW2N1cnJUYWJJZHhdLmZpbHRlcigobGVhZjogV29ya3NwYWNlTGVhZikgPT4ge1xuXHRcdGxldCBjb250YWluZXJFbCA9IGdldENvbnRhaW5lckVsZW1lbnQobGVhZik7XG5cdFx0Y29uc3QgZXhpc3RzID0gY2hlY2tTcGFuRWxlbWVudEV4aXN0cyhzcGFuLCBjb250YWluZXJFbCk7XG5cdFx0cmV0dXJuIGV4aXN0cztcblx0fSlbMF07XG5cblx0Ly8gQHRzLWlnbm9yZVxuXHRsZXQgYmFja2xpbmtMZWFmSUQgPSBiYWNrbGlua0xlYWYuaWQ7XG5cdGlmICghYmFja2xpbmtMZWFmSUQpIHRocm93IG5ldyBFcnJvcihcIkxlYWYgaWQgbm90IGZvdW5kXCIpO1xuXG5cdGlmIChiYWNrbGlua0xlYWYgJiYgYmFja2xpbmtMZWFmLnZpZXcgaW5zdGFuY2VvZiBNYXJrZG93blZpZXcpIHtcblx0XHRjb25zdCBlZGl0b3JWaWV3OiBFZGl0b3JWaWV3ID0gZ2V0RWRpdG9yVmlldyhiYWNrbGlua0xlYWYpO1xuXHRcdGlmICghZWRpdG9yVmlldykgdGhyb3cgbmV3IEVycm9yKFwiRWRpdG9yIHZpZXcgbm90IGZvdW5kXCIpO1xuXHRcdGNvbnN0IHZpZXdwb3J0ID0gYmFja2xpbmtMZWFmLnZpZXcuZWRpdG9yLmdldFNjcm9sbEluZm8oKTtcblxuXHRcdGhpZ2hsaWdodFNlbGVjdGlvbihlZGl0b3JWaWV3LCBmcm9tLCB0byk7XG5cdFx0Ly8gbGV0IHBvc2l0aW9ucyA9IGZpbmRUZXh0UG9zaXRpb25zKFxuXHRcdC8vIFx0YmFja2xpbmtMZWFmLnZpZXcuZGF0YSxcblx0XHQvLyBcdHRleHQsXG5cdFx0Ly8gXHRwcmVmaXguc2xpY2UoMCwgcHJlZml4Lmxlbmd0aCAtIDEpLFxuXHRcdC8vIFx0c3VmZml4LnNsaWNlKDEsIHN1ZmZpeC5sZW5ndGgpXG5cdFx0Ly8gKTtcblx0XHQvLyBpZiAoIXBvc2l0aW9ucykgdGhyb3cgbmV3IEVycm9yKFwiUG9zaXRpb25zIG5vdCBmb3VuZFwiKTtcblxuXHRcdHVwZGF0ZVN0YXRlKHtcblx0XHRcdGRhdGFTdHJpbmcsXG5cdFx0XHRvcmlnaW5hbFRvcDogZWRpdG9yVmlldy5kb2N1bWVudFRvcCxcblx0XHRcdGJhY2tsaW5rTGVhZklkOiBiYWNrbGlua0xlYWZJRCxcblx0XHR9KTtcblx0fVxuXG5cdGxldCByZWZlcmVuY2luZ0ZpbGUgPSBiYWNrbGluay5yZWZlcmVuY2luZ0xvY2F0aW9uLmZpbGVuYW1lO1xuXG5cdC8vIGlmIChjdXJyVGFiSWR4ICE9IC0xKSB7XG5cdC8vICYmIGN1cnJUYWIgIT0gLTEpIHtcblx0Ly8gLy8gQ2hlY2sgYWRqYWNlbnQgdGFicyBmb3IgZmlsZSBhbmQgb3BlbiBmaWxlIGlmIG5lZWRlZFxuXHRjb25zdCB7IG5ld0xlYWYsIHRlbXAsIG9yaWdpbmFsTGVhZiB9ID0gYXdhaXQgb3BlbkZpbGVJbkFkamFjZW50VGFiKFxuXHRcdGxlYXZlc0J5VGFiLFxuXHRcdGN1cnJUYWJJZHgsXG5cdFx0cmVmZXJlbmNpbmdGaWxlXG5cdCk7XG5cblx0Ly8gQHRzLWlnbm9yZVxuXHRsZXQgaWQgPSBuZXdMZWFmLmlkO1xuXHRpZiAoIWlkKSB0aHJvdyBuZXcgRXJyb3IoXCJMZWFmIGlkIG5vdCBmb3VuZFwiKTtcblx0dXBkYXRlU3RhdGUoe1xuXHRcdGxlYWZJZDogaWQsXG5cdFx0dGVtcCxcblx0XHRwZWVrOiB0cnVlLFxuXHR9KTtcblxuXHRjb25zdCBvcmlnaW5hbExlYWZJZCA9IG9yaWdpbmFsTGVhZi5pZDtcblxuXHRjb25zdCBtYXRjaGVzID0gW1xuXHRcdC4uLmJhY2tsaW5rLnJlZmVyZW5jaW5nTG9jYXRpb24udGV4dC5tYXRjaEFsbChSRUZFUkVOQ0VfUkVHRVgpLFxuXHRdO1xuXHRpZiAobWF0Y2hlcy5sZW5ndGggPT0gMCkgdGhyb3cgbmV3IEVycm9yKFwiTWF0Y2hlcyBub3QgZm91bmRcIik7XG5cdC8vIFRoaXMgb25lIHN3aXRjaCwgdGhpcyBvbmUgZG9lcyB0aGUgY29ycmVjdCBzY3JvbGxcblx0Ly8gdGVtcERpcmVjdGlvbkluZGljYXRvcihuZXdMZWFmLCB0ZXh0LCBwcmVmaXgsIHN1ZmZpeCwgZGF0YVN0cmluZyk7XG5cblx0Ly8gVGhpcyBvbmUgZG9lcyB0aGUgY29ycmVjdCBncmFiYmluZyBvZiBzcGFuIGVsZW1lbnRzXG5cdHRlbXBEaXJlY3Rpb25JbmRpY2F0b3IoXG5cdFx0bmV3TGVhZixcblx0XHRiYWNrbGluay5yZWZlcmVuY2luZ0xvY2F0aW9uLnRleHQsXG5cdFx0YmFja2xpbmsucmVmZXJlbmNpbmdMb2NhdGlvbi5wcmVmaXggKyBcIi1cIixcblx0XHRcIi1cIiArIGJhY2tsaW5rLnJlZmVyZW5jaW5nTG9jYXRpb24uc3VmZml4LFxuXHRcdG1hdGNoZXNbMF1bMV0sXG5cdFx0QUNUSU9OX1RZUEUuQkFDS0xJTkssXG5cdFx0aWQgPT09IG9yaWdpbmFsTGVhZklkXG5cdCk7XG5cblx0Y29uc3QgY3Vyc29yVmlld3BvcnQgPSBuZXdMZWFmLnZpZXcuZWRpdG9yLmdldFNjcm9sbEluZm8oKTtcblxuXHR1cGRhdGVTdGF0ZSh7XG5cdFx0Y3Vyc29yVmlld3BvcnQsXG5cdH0pO1xuXG5cdGxldCBiYWNrbGlua1NwYW46IEhUTUxTcGFuRWxlbWVudCA9IG5ld0xlYWYuY29udGFpbmVyRWwucXVlcnlTZWxlY3Rvcihcblx0XHRgc3BhbltkYXRhPVwiJHtiYWNrbGluay5kYXRhU3RyaW5nfVwiXWBcblx0KTtcblxuXHQvLyBDYW4ndCBndWFyYW50ZWUgdGhhdCB0aGlzIHdpbGwgYmUgdmlzaWJsZS5cblx0aWYgKGJhY2tsaW5rU3Bhbikge1xuXHRcdGNvbnN0IHN2Z0VsZW1lbnQgPSBiYWNrbGlua1NwYW4ucXVlcnlTZWxlY3RvcihcInN2Z1wiKTtcblx0XHRpZiAoc3ZnRWxlbWVudCkge1xuXHRcdFx0c3ZnRWxlbWVudC5zdHlsZS5ib3JkZXJSYWRpdXMgPSBcIjVweFwiO1xuXHRcdFx0c3ZnRWxlbWVudC5zdHlsZS5ib3hTaGFkb3cgPSBgMHB4IDBweCAxMHB4IDEwcHggJHtTVkdfSE9WRVJfQ09MT1J9YDtcblx0XHRcdHVwZGF0ZUhvdmVyZWRDdXJzb3Ioc3ZnRWxlbWVudCwgQUNUSU9OX1RZUEUuQkFDS0xJTkspO1xuXHRcdH1cblx0fVxuXG5cdGlmIChcblx0XHRpZCA9PT0gb3JpZ2luYWxMZWFmSWRcblx0XHQvLyAmJlxuXHRcdC8vIChuZXdMZWFmLmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoXCIudmlldy1jb250ZW50XCIpLnN0eWxlLmJveFNoYWRvdyA9PVxuXHRcdC8vIFx0XCJub25lXCIgfHxcblx0XHQvLyBcdG5ld0xlYWYuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvcihcIi52aWV3LWNvbnRlbnRcIikuc3R5bGUuYm94U2hhZG93ID09IFwiXCIpXG5cdCkge1xuXHRcdG5ld0xlYWYuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvcihcIi52aWV3LWNvbnRlbnRcIikuc3R5bGUuYm94U2hhZG93ID0gXCJub25lXCI7XG5cdH1cblxuXHQvLyBAdHMtaWdub3JlXG5cdGlmIChvcmlnaW5hbExlYWZJZCkge1xuXHRcdHVwZGF0ZVN0YXRlKHtcblx0XHRcdG9yaWdpbmFsTGVhZklkLFxuXHRcdH0pO1xuXHR9XG5cblx0cmV0dXJuO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc3RhcnRSZWZlcmVuY2VFZmZlY3QoXG5cdHNwYW46IEhUTUxTcGFuRWxlbWVudCxcblx0dHlwZTogc3RyaW5nXG4pIHtcblx0bGV0IHNvdXJjZSA9IHR5cGUgPT0gQUNUSU9OX1RZUEUuTU9VU0UgPyBnZXRIb3ZlcigpIDogZ2V0Q3Vyc29yKCk7XG5cdGxldCBkZXN0aW5hdGlvbiA9IHR5cGUgPT0gQUNUSU9OX1RZUEUuTU9VU0UgPyBnZXRDdXJzb3IoKSA6IGdldEhvdmVyKCk7XG5cdGxldCB1cGRhdGVTdGF0ZSA9IHR5cGUgPT0gQUNUSU9OX1RZUEUuTU9VU0UgPyB1cGRhdGVIb3ZlciA6IHVwZGF0ZUN1cnNvcjtcblxuXHQvLyBNdXRleCwgcHJldmVudCBjb25jdXJyZW50IGFjY2VzcyB0byBmb2xsb3dpbmcgc2VjdGlvbiBvZiBjb2RlXG5cdGlmIChzb3VyY2UgIT0gbnVsbCkgcmV0dXJuO1xuXHR1cGRhdGVTdGF0ZSh7XG5cdFx0dHlwZTogYCR7dHlwZX0tc3RhcnRgLFxuXHR9KTtcblxuXHRjb25zdCBkYXRhU3RyaW5nID0gc3Bhbi5nZXRBdHRyaWJ1dGUoXCJkYXRhXCIpO1xuXHRpZiAoIWRhdGFTdHJpbmcpIHJldHVybjtcblxuXHRpZiAoZGVzdGluYXRpb24gIT0gbnVsbCAmJiBkZXN0aW5hdGlvbi5kYXRhU3RyaW5nID09IGRhdGFTdHJpbmcpIHtcblx0XHR1cGRhdGVIb3ZlcihkZXN0aW5hdGlvbik7XG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0bGV0IFtwcmVmaXgsIHRleHQsIHN1ZmZpeCwgZmlsZSwgZnJvbSwgdG9dID0gcHJvY2Vzc1VSSShkYXRhU3RyaW5nKTtcblxuXHRsZXQgbGVhdmVzQnlUYWIgPSBjb2xsZWN0TGVhdmVzQnlUYWJIZWxwZXIoKTtcblxuXHRsZXQgY3VyclRhYklkeCA9IGdldEN1cnJlbnRUYWJJbmRleChsZWF2ZXNCeVRhYiwgc3Bhbik7XG5cblx0bGV0IGN1cnJMZWFmID0gZ2V0VGhhdCgpLndvcmtzcGFjZS5nZXRMZWFmKCk7XG5cblx0Ly8gQHRzLWlnbm9yZVxuXHRsZXQgY3VyckxlYWZJRCA9IGN1cnJMZWFmLmlkO1xuXHRpZiAoIWN1cnJMZWFmSUQpIHRocm93IG5ldyBFcnJvcihcImN1cnJMZWFmSUQgaWQgbm90IGZvdW5kXCIpO1xuXG5cdGNvbnN0IHsgbmV3TGVhZiwgdGVtcCwgb3JpZ2luYWxMZWFmIH0gPSBhd2FpdCBvcGVuRmlsZUluQWRqYWNlbnRUYWIoXG5cdFx0bGVhdmVzQnlUYWIsXG5cdFx0Y3VyclRhYklkeCxcblx0XHRmaWxlLFxuXHRcdHR5cGVcblx0KTtcblx0Ly8gaWYgKCFuZXdMZWFmKSB7XG5cdC8vIFx0cmVzZXRTdGF0ZSgpO1xuXHQvLyBcdHJldHVybjtcblx0Ly8gfVxuXHRhd2FpdCBkZWxheSg1MCk7IC8vIGVuc3VyZSBuZXcgbGVhZiBoYXMgb3BlbmVkIGNvbXBsZXRlbHkgYmVmb3JlIGRvaW5nIGNoZWNrcyBiZWxvd1xuXG5cdC8vIEB0cy1pZ25vcmVcblx0bGV0IGlkID0gbmV3TGVhZi5pZDtcblx0aWYgKCFpZCkgdGhyb3cgbmV3IEVycm9yKFwiTGVhZiBpZCBub3QgZm91bmRcIik7XG5cdHVwZGF0ZVN0YXRlKHtcblx0XHRsZWFmSWQ6IGlkLFxuXHRcdHRlbXAsXG5cdFx0cGVlazogdHJ1ZSxcblx0fSk7XG5cblx0aWYgKG5ld0xlYWYgJiYgbmV3TGVhZi52aWV3IGluc3RhbmNlb2YgTWFya2Rvd25WaWV3KSB7XG5cdFx0Y29uc3QgZWRpdG9yVmlldzogRWRpdG9yVmlldyA9IGdldEVkaXRvclZpZXcobmV3TGVhZik7XG5cdFx0aWYgKCFlZGl0b3JWaWV3KSB0aHJvdyBuZXcgRXJyb3IoXCJFZGl0b3IgdmlldyBub3QgZm91bmRcIik7XG5cdFx0Y29uc3Qgdmlld3BvcnQgPSBuZXdMZWFmLnZpZXcuZWRpdG9yLmdldFNjcm9sbEluZm8oKTtcblxuXHRcdGhpZ2hsaWdodFNlbGVjdGlvbihlZGl0b3JWaWV3LCBmcm9tLCB0byk7XG5cblx0XHR0ZW1wRGlyZWN0aW9uSW5kaWNhdG9yKG5ld0xlYWYsIHRleHQsIHByZWZpeCwgc3VmZml4LCBkYXRhU3RyaW5nKTtcblxuXHRcdGNvbnN0IGN1cnNvclZpZXdwb3J0ID0gbmV3TGVhZi52aWV3LmVkaXRvci5nZXRTY3JvbGxJbmZvKCk7XG5cblx0XHR1cGRhdGVTdGF0ZSh7XG5cdFx0XHRkYXRhU3RyaW5nLFxuXHRcdFx0b3JpZ2luYWxUb3A6IGVkaXRvclZpZXcuZG9jdW1lbnRUb3AsXG5cdFx0XHQvLyBvcmlnaW5hbExlYWZJZDogY3VyckxlYWZJRCxcblx0XHRcdGN1cnNvclZpZXdwb3J0LFxuXHRcdH0pO1xuXHR9XG5cblx0Y29uc3Qgb3JpZ2luYWxMZWFmSWQgPSBvcmlnaW5hbExlYWYuaWQ7XG5cblx0aWYgKFxuXHRcdGlkICE9IG9yaWdpbmFsTGVhZklkICYmXG5cdFx0KG5ld0xlYWYuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvcihcIi52aWV3LWNvbnRlbnRcIikuc3R5bGUuYm94U2hhZG93ID09XG5cdFx0XHRcIm5vbmVcIiB8fFxuXHRcdFx0bmV3TGVhZi5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKFwiLnZpZXctY29udGVudFwiKS5zdHlsZS5ib3hTaGFkb3cgPT0gXCJcIilcblx0KSB7XG5cdFx0bmV3TGVhZi5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKFwiLnZpZXctY29udGVudFwiKS5zdHlsZS5ib3hTaGFkb3cgPVxuXHRcdFx0XCJpbnNldCAwcHggMHB4IDEwcHggMTBweCByZ2JhKDI0OCwgMjU1LCAyNTUpXCI7XG5cdH1cblxuXHRpZiAob3JpZ2luYWxMZWFmSWQpIHtcblx0XHR1cGRhdGVTdGF0ZSh7XG5cdFx0XHRvcmlnaW5hbExlYWZJZCxcblx0XHR9KTtcblx0fVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZW5kUmVmZXJlbmNlQ3Vyc29yRWZmZWN0KCkge1xuXHRpZiAoIWdldEN1cnNvcigpIHx8IE9iamVjdC5rZXlzKGdldEN1cnNvcigpKS5sZW5ndGggPT0gMCkge1xuXHRcdC8vIEVuZCBtdXRleCBsb2NrXG5cdFx0cmVzZXRDdXJzb3IoKTtcblx0XHRyZXR1cm47XG5cdH1cblxuXHRjb25zdCB7IGRhdGFTdHJpbmcsIGxlYWZJZCwgb3JpZ2luYWxMZWFmSWQsIHRlbXAsIGN1cnNvclZpZXdwb3J0LCBwZWVrIH0gPVxuXHRcdGdldEN1cnNvcigpO1xuXHRpZiAoZ2V0SG92ZXIoKSAhPSBudWxsICYmIGdldEhvdmVyKCkuZGF0YVN0cmluZyA9PSBkYXRhU3RyaW5nKSB7XG5cdFx0Ly8gRW5kIG11dGV4IGxvY2tcblx0XHRyZXNldEN1cnNvcigpO1xuXHRcdHJldHVybjtcblx0fVxuXG5cdGNvbnN0IHsgd29ya3NwYWNlIH0gPSBnZXRUaGF0KCk7XG5cdGxldCB0YXJnZXRMZWFmID0gd29ya3NwYWNlLmdldExlYWZCeUlkKGxlYWZJZCk7XG5cdGlmICghdGFyZ2V0TGVhZikge1xuXHRcdHJlc2V0SG92ZXIoKTtcblx0XHR0aHJvdyBuZXcgRXJyb3IoXCJUYXJnZXQgbGVhZiBub3QgZm91bmRcIik7XG5cdH1cblxuXHRjb25zdCBhY3RpdmVMZWFmID0gZ2V0VGhhdCgpLndvcmtzcGFjZS5nZXRMZWFmKCk7XG5cdC8vIEB0cy1pZ25vcmUgaWRcblx0Y29uc3QgYWN0aXZlTGVhZklkID0gYWN0aXZlTGVhZi5pZDtcblxuXHRsZXQgZWRpdG9yVmlldyA9IGdldEVkaXRvclZpZXcodGFyZ2V0TGVhZik7XG5cblx0cmVtb3ZlSGlnaGxpZ2h0cyhlZGl0b3JWaWV3KTtcblxuXHRpZiAoYWN0aXZlTGVhZklkID09PSBsZWFmSWQpIHtcblx0XHRyZXNldEN1cnNvcigpO1xuXHRcdGxldCBjb250YWluZXJFbDogSFRNTEVsZW1lbnQgPSBnZXRDb250YWluZXJFbGVtZW50KHRhcmdldExlYWYpO1xuXHRcdGlmIChjb250YWluZXJFbCAhPSBudWxsKSB7XG5cdFx0XHQvLyBAdHMtaWdub3JlXG5cdFx0XHRjb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKFwiLnZpZXctY29udGVudFwiKT8uc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJcIik7XG5cdFx0fVxuXHRcdHJldHVybjtcblx0fVxuXG5cdGlmIChjdXJzb3JWaWV3cG9ydCAmJiB0YXJnZXRMZWFmICYmIHRhcmdldExlYWYudmlldyBpbnN0YW5jZW9mIE1hcmtkb3duVmlldykge1xuXHRcdGNvbnN0IHZpZXc6IE1hcmtkb3duVmlldyA9IHRhcmdldExlYWYudmlldztcblx0XHR2aWV3LmVkaXRvci5zY3JvbGxUbygwLCBjdXJzb3JWaWV3cG9ydC50b3ApO1xuXG5cdFx0Ly8gY29uc3QgcmVzdWx0ID0gYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcblx0XHQvLyBcdGNvbnN0IHNjcm9sbGluZyA9IHNldEludGVydmFsKCgpID0+IHtcblx0XHQvLyBcdFx0Y29uc3Qgc2Nyb2xsQW1vdW50ID0gNDA7XG5cdFx0Ly8gXHRcdGNvbnN0IGN1cnJlbnRTY3JvbGwgPSB2aWV3LmVkaXRvci5nZXRTY3JvbGxJbmZvKCkudG9wO1xuXHRcdC8vIFx0XHRpZiAoY3VycmVudFNjcm9sbCA9PSBjdXJzb3JWaWV3cG9ydC50b3ApIHtcblx0XHQvLyBcdFx0XHRjbGVhckludGVydmFsKHNjcm9sbGluZyk7XG5cdFx0Ly8gXHRcdH0gZWxzZSBpZiAoY3VycmVudFNjcm9sbCA+IGN1cnNvclZpZXdwb3J0LnRvcCkge1xuXHRcdC8vIFx0XHRcdGlmIChjdXJyZW50U2Nyb2xsIC0gc2Nyb2xsQW1vdW50IDwgY3Vyc29yVmlld3BvcnQudG9wKSB7XG5cdFx0Ly8gXHRcdFx0XHR2aWV3LmVkaXRvci5zY3JvbGxUbygwLCBjdXJzb3JWaWV3cG9ydC50b3ApO1xuXHRcdC8vIFx0XHRcdFx0Y2xlYXJJbnRlcnZhbChzY3JvbGxpbmcpO1xuXHRcdC8vIFx0XHRcdFx0cmVzb2x2ZShcImRvbmVcIik7XG5cdFx0Ly8gXHRcdFx0fSBlbHNlIHtcblx0XHQvLyBcdFx0XHRcdHZpZXcuZWRpdG9yLnNjcm9sbFRvKDAsIGN1cnJlbnRTY3JvbGwgLSBzY3JvbGxBbW91bnQpO1xuXHRcdC8vIFx0XHRcdH1cblx0XHQvLyBcdFx0fSBlbHNlIGlmIChjdXJyZW50U2Nyb2xsIDwgY3Vyc29yVmlld3BvcnQudG9wKSB7XG5cdFx0Ly8gXHRcdFx0aWYgKGN1cnJlbnRTY3JvbGwgKyBzY3JvbGxBbW91bnQgPiBjdXJzb3JWaWV3cG9ydC50b3ApIHtcblx0XHQvLyBcdFx0XHRcdHZpZXcuZWRpdG9yLnNjcm9sbFRvKDAsIGN1cnNvclZpZXdwb3J0LnRvcCk7XG5cdFx0Ly8gXHRcdFx0XHRjbGVhckludGVydmFsKHNjcm9sbGluZyk7XG5cdFx0Ly8gXHRcdFx0XHRyZXNvbHZlKFwiZG9uZVwiKTtcblx0XHQvLyBcdFx0XHR9IGVsc2Uge1xuXHRcdC8vIFx0XHRcdFx0dmlldy5lZGl0b3Iuc2Nyb2xsVG8oMCwgY3VycmVudFNjcm9sbCArIHNjcm9sbEFtb3VudCk7XG5cdFx0Ly8gXHRcdFx0fVxuXHRcdC8vIFx0XHR9XG5cdFx0Ly8gXHR9LCAxMCk7XG5cdFx0Ly8gfSk7XG5cblx0XHQvLyB2aWV3LmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoXCIuY20tc2Nyb2xsZXJcIik/LnNjcm9sbFRvKHtcblx0XHQvLyBcdHRvcDogY3Vyc29yVmlld3BvcnQudG9wLFxuXHRcdC8vIFx0YmVoYXZpb3I6IFwic21vb3RoXCIsXG5cdFx0Ly8gfSk7XG5cblx0XHQvLyBpZiB0aGUgaG92ZXIgaXMgYWN0aXZlLCBoaWdobGlnaHQgdGhlIHNlbGVjdGlvblxuXHRcdGlmIChnZXRIb3ZlcigpICE9IG51bGwpIHtcblx0XHRcdGNvbnN0IHsgZGF0YVN0cmluZywgY3Vyc29yVmlld3BvcnQsIGxlYWZJZCwgb3JpZ2luYWxMZWFmSWQgfSA9IGdldEhvdmVyKCk7XG5cdFx0XHRsZXQgW3ByZWZpeCwgdGV4dCwgc3VmZml4LCBmaWxlLCBmcm9tLCB0b10gPSBwcm9jZXNzVVJJKGRhdGFTdHJpbmcpO1xuXHRcdFx0Y29uc3QgY3Vyc29yTGVhZiA9IHdvcmtzcGFjZS5nZXRMZWFmQnlJZChsZWFmSWQpO1xuXHRcdFx0d29ya3NwYWNlLnJldmVhbExlYWYoY3Vyc29yTGVhZik7XG5cdFx0XHRjb25zdCBlZGl0b3JWaWV3OiBFZGl0b3JWaWV3ID0gZ2V0RWRpdG9yVmlldyhjdXJzb3JMZWFmKTtcblx0XHRcdGhpZ2hsaWdodFNlbGVjdGlvbihlZGl0b3JWaWV3LCBmcm9tLCB0byk7XG5cdFx0XHQvLyB0ZW1wRGlyZWN0aW9uSW5kaWNhdG9yKFxuXHRcdFx0Ly8gXHRjdXJzb3JMZWFmLFxuXHRcdFx0Ly8gXHR0ZXh0LFxuXHRcdFx0Ly8gXHRwcmVmaXgsXG5cdFx0XHQvLyBcdHN1ZmZpeCxcblx0XHRcdC8vIFx0dGVtcCxcblx0XHRcdC8vIFx0ZGF0YVN0cmluZyxcblx0XHRcdC8vIFx0QUNUSU9OX1RZUEUuTU9VU0Vcblx0XHRcdC8vICk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGxldCBjb250YWluZXJFbDogSFRNTEVsZW1lbnQgPSBnZXRDb250YWluZXJFbGVtZW50KHRhcmdldExlYWYpO1xuXHRcdFx0aWYgKGNvbnRhaW5lckVsICE9IG51bGwpIHtcblx0XHRcdFx0Ly8gQHRzLWlnbm9yZVxuXHRcdFx0XHRjb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKFwiLnZpZXctY29udGVudFwiKT8uc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJcIik7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0aWYgKHRlbXAgJiYgdGFyZ2V0TGVhZikge1xuXHRcdHRhcmdldExlYWYuZGV0YWNoKCk7XG5cdH1cblxuXHRpZiAocGVlaykge1xuXHRcdGxldCBvcmlnaW5hbExlYWYgPSB3b3Jrc3BhY2UuZ2V0TGVhZkJ5SWQob3JpZ2luYWxMZWFmSWQpO1xuXHRcdGlmICghb3JpZ2luYWxMZWFmKSB0aHJvdyBuZXcgRXJyb3IoXCJPcmlnaW5hbCBsZWFmIG5vdCBmb3VuZFwiKTtcblxuXHRcdHdvcmtzcGFjZS5yZXZlYWxMZWFmKG9yaWdpbmFsTGVhZik7XG5cdH1cblxuXHQvLyBpZiAoIXRlbXApIHtcblx0Ly8gXHRsZXQgb3JpZ2luYWxMZWFmID0gd29ya3NwYWNlLmdldExlYWZCeUlkKG9yaWdpbmFsTGVhZklkKTtcblx0Ly8gXHRpZiAoIW9yaWdpbmFsTGVhZikgdGhyb3cgbmV3IEVycm9yKFwiT3JpZ2luYWwgbGVhZiBub3QgZm91bmRcIik7XG5cblx0Ly8gXHR3b3Jrc3BhY2UucmV2ZWFsTGVhZihvcmlnaW5hbExlYWYpO1xuXHQvLyB9XG5cdC8vIEVuZCBtdXRleCBsb2NrXG5cdHJlc2V0Q3Vyc29yKCk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBlbmRSZWZlcmVuY2VIb3ZlckVmZmVjdCgpIHtcblx0Ly8gY29uc29sZS5sb2coXCJlbmRSZWZlcmVuY2VIb3ZlckVmZmVjdFwiKTtcblx0aWYgKCFnZXRIb3ZlcigpIHx8IE9iamVjdC5rZXlzKGdldEhvdmVyKCkpLmxlbmd0aCA9PSAwKSB7XG5cdFx0Ly8gRW5kIG11dGV4IGxvY2tcblx0XHRyZXNldEhvdmVyKCk7XG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0Y29uc3QgeyBkYXRhU3RyaW5nLCBsZWFmSWQsIG9yaWdpbmFsTGVhZklkLCB0ZW1wLCBjdXJzb3JWaWV3cG9ydCwgcGVlayB9ID1cblx0XHRnZXRIb3ZlcigpO1xuXHRpZiAoZ2V0Q3Vyc29yKCkgIT0gbnVsbCAmJiBnZXRDdXJzb3IoKS5kYXRhU3RyaW5nID09IGRhdGFTdHJpbmcpIHtcblx0XHQvLyBjb25zb2xlLmxvZyhcImN1cnNvciByZXNldFwiKTtcblx0XHQvLyBFbmQgbXV0ZXggbG9ja1xuXHRcdHJlc2V0SG92ZXIoKTtcblx0XHRyZXR1cm47XG5cdH1cblxuXHRjb25zdCB7IHdvcmtzcGFjZSB9ID0gZ2V0VGhhdCgpO1xuXHRsZXQgdGFyZ2V0TGVhZiA9IHdvcmtzcGFjZS5nZXRMZWFmQnlJZChsZWFmSWQpO1xuXHRpZiAoIXRhcmdldExlYWYpIHtcblx0XHRyZXNldEhvdmVyKCk7XG5cdFx0dGhyb3cgbmV3IEVycm9yKFwiVGFyZ2V0IGxlYWYgbm90IGZvdW5kXCIpO1xuXHR9XG5cblx0bGV0IGVkaXRvclZpZXcgPSBnZXRFZGl0b3JWaWV3KHRhcmdldExlYWYpO1xuXG5cdHJlbW92ZUhpZ2hsaWdodHMoZWRpdG9yVmlldyk7XG5cblx0aWYgKGN1cnNvclZpZXdwb3J0ICYmIHRhcmdldExlYWYgJiYgdGFyZ2V0TGVhZi52aWV3IGluc3RhbmNlb2YgTWFya2Rvd25WaWV3KSB7XG5cdFx0Y29uc3QgdmlldzogTWFya2Rvd25WaWV3ID0gdGFyZ2V0TGVhZi52aWV3O1xuXHRcdHZpZXcuZWRpdG9yLnNjcm9sbFRvKDAsIGN1cnNvclZpZXdwb3J0LnRvcCk7XG5cblx0XHQvLyBjb25zdCBjdXJyZW50U2Nyb2xsID0gdmlldy5lZGl0b3IuZ2V0U2Nyb2xsSW5mbygpLnRvcDtcblx0XHQvLyBjb25zdCByZXN1bHQgPSBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuXHRcdC8vIFx0Y29uc3Qgc2Nyb2xsaW5nID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuXHRcdC8vIFx0XHRjb25zdCBzY3JvbGxBbW91bnQgPSA0MDtcblx0XHQvLyBcdFx0Y29uc3QgY3VycmVudFNjcm9sbCA9IHZpZXcuZWRpdG9yLmdldFNjcm9sbEluZm8oKS50b3A7XG5cdFx0Ly8gXHRcdGlmIChjdXJyZW50U2Nyb2xsID09IGN1cnNvclZpZXdwb3J0LnRvcCkge1xuXHRcdC8vIFx0XHRcdGNsZWFySW50ZXJ2YWwoc2Nyb2xsaW5nKTtcblx0XHQvLyBcdFx0fSBlbHNlIGlmIChjdXJyZW50U2Nyb2xsID4gY3Vyc29yVmlld3BvcnQudG9wKSB7XG5cdFx0Ly8gXHRcdFx0aWYgKGN1cnJlbnRTY3JvbGwgLSBzY3JvbGxBbW91bnQgPCBjdXJzb3JWaWV3cG9ydC50b3ApIHtcblx0XHQvLyBcdFx0XHRcdHZpZXcuZWRpdG9yLnNjcm9sbFRvKDAsIGN1cnNvclZpZXdwb3J0LnRvcCk7XG5cdFx0Ly8gXHRcdFx0XHRjbGVhckludGVydmFsKHNjcm9sbGluZyk7XG5cdFx0Ly8gXHRcdFx0XHRyZXNvbHZlKFwiZG9uZVwiKTtcblx0XHQvLyBcdFx0XHR9IGVsc2Uge1xuXHRcdC8vIFx0XHRcdFx0dmlldy5lZGl0b3Iuc2Nyb2xsVG8oMCwgY3VycmVudFNjcm9sbCAtIHNjcm9sbEFtb3VudCk7XG5cdFx0Ly8gXHRcdFx0fVxuXHRcdC8vIFx0XHR9IGVsc2UgaWYgKGN1cnJlbnRTY3JvbGwgPCBjdXJzb3JWaWV3cG9ydC50b3ApIHtcblx0XHQvLyBcdFx0XHRpZiAoY3VycmVudFNjcm9sbCArIHNjcm9sbEFtb3VudCA+IGN1cnNvclZpZXdwb3J0LnRvcCkge1xuXHRcdC8vIFx0XHRcdFx0dmlldy5lZGl0b3Iuc2Nyb2xsVG8oMCwgY3Vyc29yVmlld3BvcnQudG9wKTtcblx0XHQvLyBcdFx0XHRcdGNsZWFySW50ZXJ2YWwoc2Nyb2xsaW5nKTtcblx0XHQvLyBcdFx0XHRcdHJlc29sdmUoXCJkb25lXCIpO1xuXHRcdC8vIFx0XHRcdH0gZWxzZSB7XG5cdFx0Ly8gXHRcdFx0XHR2aWV3LmVkaXRvci5zY3JvbGxUbygwLCBjdXJyZW50U2Nyb2xsICsgc2Nyb2xsQW1vdW50KTtcblx0XHQvLyBcdFx0XHR9XG5cdFx0Ly8gXHRcdH1cblx0XHQvLyBcdH0sIDEwKTtcblx0XHQvLyB9KTtcblxuXHRcdC8vIHZpZXcuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvcihcIi5jbS1zY3JvbGxlclwiKT8uc2Nyb2xsVG8oe1xuXHRcdC8vIFx0dG9wOiBjdXJzb3JWaWV3cG9ydC50b3AsXG5cdFx0Ly8gXHRiZWhhdmlvcjogXCJzbW9vdGhcIixcblx0XHQvLyB9KTtcblxuXHRcdC8vIGlmIHRoZSBjdXJzb3IgaXMgYWN0aXZlLCBoaWdobGlnaHQgdGhlIHNlbGVjdGlvblxuXHRcdGlmIChnZXRDdXJzb3IoKSAhPSBudWxsKSB7XG5cdFx0XHRjb25zdCB7IGRhdGFTdHJpbmcsIGN1cnNvclZpZXdwb3J0LCBsZWFmSWQsIG9yaWdpbmFsTGVhZklkIH0gPVxuXHRcdFx0XHRnZXRDdXJzb3IoKTtcblx0XHRcdGxldCBbcHJlZml4LCB0ZXh0LCBzdWZmaXgsIGZpbGUsIGZyb20sIHRvXSA9IHByb2Nlc3NVUkkoZGF0YVN0cmluZyk7XG5cdFx0XHRjb25zdCBjdXJzb3JMZWFmID0gd29ya3NwYWNlLmdldExlYWZCeUlkKGxlYWZJZCk7XG5cdFx0XHR3b3Jrc3BhY2UucmV2ZWFsTGVhZihjdXJzb3JMZWFmKTtcblx0XHRcdGNvbnN0IGVkaXRvclZpZXc6IEVkaXRvclZpZXcgPSBnZXRFZGl0b3JWaWV3KGN1cnNvckxlYWYpO1xuXHRcdFx0aWYgKCFlZGl0b3JWaWV3KSB0aHJvdyBuZXcgRXJyb3IoXCJFZGl0b3IgdmlldyBub3QgZm91bmRcIik7XG5cblx0XHRcdGhpZ2hsaWdodFNlbGVjdGlvbihlZGl0b3JWaWV3LCBmcm9tLCB0byk7XG5cdFx0XHQvLyB0ZW1wRGlyZWN0aW9uSW5kaWNhdG9yKFxuXHRcdFx0Ly8gXHRjdXJzb3JMZWFmLFxuXHRcdFx0Ly8gXHR0ZXh0LFxuXHRcdFx0Ly8gXHRwcmVmaXgsXG5cdFx0XHQvLyBcdHN1ZmZpeCxcblx0XHRcdC8vIFx0dGVtcCxcblx0XHRcdC8vIFx0ZGF0YVN0cmluZ1xuXHRcdFx0Ly8gKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0bGV0IGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCA9IGdldENvbnRhaW5lckVsZW1lbnQodGFyZ2V0TGVhZik7XG5cdFx0XHRpZiAoY29udGFpbmVyRWwgIT0gbnVsbCkge1xuXHRcdFx0XHQvLyBAdHMtaWdub3JlXG5cdFx0XHRcdGNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoXCIudmlldy1jb250ZW50XCIpPy5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcIlwiKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRpZiAodGVtcCAmJiB0YXJnZXRMZWFmKSB7XG5cdFx0dGFyZ2V0TGVhZi5kZXRhY2goKTtcblxuXHRcdGxldCBvcmlnaW5hbExlYWYgPSB3b3Jrc3BhY2UuZ2V0TGVhZkJ5SWQob3JpZ2luYWxMZWFmSWQpO1xuXHRcdGlmICghb3JpZ2luYWxMZWFmKSB0aHJvdyBuZXcgRXJyb3IoXCJPcmlnaW5hbCBsZWFmIG5vdCBmb3VuZFwiKTtcblxuXHRcdHdvcmtzcGFjZS5yZXZlYWxMZWFmKG9yaWdpbmFsTGVhZik7XG5cdH1cblxuXHRpZiAocGVlaykge1xuXHRcdGxldCBvcmlnaW5hbExlYWYgPSB3b3Jrc3BhY2UuZ2V0TGVhZkJ5SWQob3JpZ2luYWxMZWFmSWQpO1xuXHRcdGlmICghb3JpZ2luYWxMZWFmKSB7XG5cdFx0XHRyZXNldEhvdmVyKCk7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoXCJPcmlnaW5hbCBsZWFmIG5vdCBmb3VuZFwiKTtcblx0XHR9XG5cblx0XHR3b3Jrc3BhY2UucmV2ZWFsTGVhZihvcmlnaW5hbExlYWYpO1xuXHR9XG5cdC8vIGlmICghdGVtcCkge1xuXHQvLyBcdGxldCBvcmlnaW5hbExlYWYgPSB3b3Jrc3BhY2UuZ2V0TGVhZkJ5SWQob3JpZ2luYWxMZWFmSWQpO1xuXHQvLyBcdGlmICghb3JpZ2luYWxMZWFmKSB0aHJvdyBuZXcgRXJyb3IoXCJPcmlnaW5hbCBsZWFmIG5vdCBmb3VuZFwiKTtcblxuXHQvLyBcdHdvcmtzcGFjZS5yZXZlYWxMZWFmKG9yaWdpbmFsTGVhZik7XG5cdC8vIH1cblxuXHQvLyBFbmQgbXV0ZXggbG9ja1xuXHRyZXNldEhvdmVyKCk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBlbmRCYWNrbGlua0hvdmVyRWZmZWN0KCkge1xuXHRpZiAoIWdldEJhY2tsaW5rSG92ZXIoKSB8fCBPYmplY3Qua2V5cyhnZXRCYWNrbGlua0hvdmVyKCkpLmxlbmd0aCA9PSAwKSB7XG5cdFx0Ly8gRW5kIG11dGV4IGxvY2tcblx0XHRyZXNldEJhY2tsaW5rSG92ZXIoKTtcblx0XHRyZXR1cm47XG5cdH1cblxuXHRjb25zdCB7XG5cdFx0ZGF0YVN0cmluZyxcblx0XHRsZWFmSWQsXG5cdFx0b3JpZ2luYWxMZWFmSWQsXG5cdFx0YmFja2xpbmtMZWFmSWQsXG5cdFx0dGVtcCxcblx0XHRjdXJzb3JWaWV3cG9ydCxcblx0XHRvcmlnaW5hbFRhYixcblx0XHRwZWVrLFxuXHR9ID0gZ2V0QmFja2xpbmtIb3ZlcigpO1xuXHRpZiAoZ2V0Q3Vyc29yKCkgIT0gbnVsbCAmJiBnZXRDdXJzb3IoKS5kYXRhU3RyaW5nID09IGRhdGFTdHJpbmcpIHtcblx0XHQvLyBFbmQgbXV0ZXggbG9ja1xuXHRcdHJlc2V0QmFja2xpbmtIb3ZlcigpO1xuXHRcdHJldHVybjtcblx0fVxuXG5cdGNvbnN0IHsgd29ya3NwYWNlIH0gPSBnZXRUaGF0KCk7XG5cdGxldCB0YXJnZXRMZWFmID0gd29ya3NwYWNlLmdldExlYWZCeUlkKGxlYWZJZCk7XG5cdGlmICghdGFyZ2V0TGVhZikge1xuXHRcdHJlc2V0QmFja2xpbmtIb3ZlcigpO1xuXHRcdHRocm93IG5ldyBFcnJvcihcIlRhcmdldCBsZWFmIG5vdCBmb3VuZFwiKTtcblx0fVxuXG5cdGlmIChjdXJzb3JWaWV3cG9ydCAmJiB0YXJnZXRMZWFmICYmIHRhcmdldExlYWYudmlldyBpbnN0YW5jZW9mIE1hcmtkb3duVmlldykge1xuXHRcdGNvbnN0IHZpZXc6IE1hcmtkb3duVmlldyA9IHRhcmdldExlYWYudmlldztcblx0XHR2aWV3LmVkaXRvci5zY3JvbGxUbygwLCBjdXJzb3JWaWV3cG9ydC50b3ApO1xuXHR9XG5cblx0bGV0IGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCA9IGdldENvbnRhaW5lckVsZW1lbnQodGFyZ2V0TGVhZik7XG5cdGlmIChjb250YWluZXJFbCAhPSBudWxsKSB7XG5cdFx0Ly8gQHRzLWlnbm9yZVxuXHRcdGNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoXCIudmlldy1jb250ZW50XCIpPy5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcIlwiKTtcblx0fVxuXG5cdGxldCBlZGl0b3JWaWV3OiBFZGl0b3JWaWV3ID0gZ2V0RWRpdG9yVmlldyh0YXJnZXRMZWFmKTtcblxuXHRyZW1vdmVIaWdobGlnaHRzKGVkaXRvclZpZXcpO1xuXG5cdC8vIGJhY2tsaW5rIGVmZmVjdFxuXHRjb25zdCBvcmlnaW5hbExlYWYgPSB3b3Jrc3BhY2UuZ2V0TGVhZkJ5SWQoYmFja2xpbmtMZWFmSWQpO1xuXHRpZiAoIW9yaWdpbmFsTGVhZikge1xuXHRcdHJlc2V0QmFja2xpbmtIb3ZlcigpO1xuXHRcdHRocm93IG5ldyBFcnJvcihcIk9yaWdpbmFsIGxlYWYgbm90IGZvdW5kXCIpO1xuXHR9XG5cdGxldCBvcmlnaW5hbEVkaXRvclZpZXc6IEVkaXRvclZpZXcgPSBnZXRFZGl0b3JWaWV3KG9yaWdpbmFsTGVhZik7XG5cblx0cmVtb3ZlSGlnaGxpZ2h0cyhvcmlnaW5hbEVkaXRvclZpZXcpO1xuXG5cdGlmIChnZXRDdXJzb3IoKSAhPSBudWxsKSB7XG5cdFx0Y29uc3QgeyBkYXRhU3RyaW5nLCBjdXJzb3JWaWV3cG9ydCwgbGVhZklkLCBvcmlnaW5hbExlYWZJZCB9ID0gZ2V0Q3Vyc29yKCk7XG5cdFx0bGV0IFtwcmVmaXgsIHRleHQsIHN1ZmZpeCwgZmlsZSwgZnJvbSwgdG9dID0gcHJvY2Vzc1VSSShkYXRhU3RyaW5nKTtcblx0XHRjb25zdCBjdXJzb3JMZWFmID0gd29ya3NwYWNlLmdldExlYWZCeUlkKGxlYWZJZCk7XG5cdFx0d29ya3NwYWNlLnJldmVhbExlYWYoY3Vyc29yTGVhZik7XG5cblx0XHRjb25zdCBlZGl0b3JWaWV3OiBFZGl0b3JWaWV3ID0gZ2V0RWRpdG9yVmlldyhjdXJzb3JMZWFmKTtcblx0XHRoaWdobGlnaHRTZWxlY3Rpb24oZWRpdG9yVmlldywgZnJvbSwgdG8pO1xuXHR9XG5cblx0aWYgKHRlbXAgJiYgdGFyZ2V0TGVhZikge1xuXHRcdHRhcmdldExlYWYuZGV0YWNoKCk7XG5cdH1cblxuXHRpZiAocGVlaykge1xuXHRcdGxldCBvcmlnaW5hbExlYWYgPSB3b3Jrc3BhY2UuZ2V0TGVhZkJ5SWQob3JpZ2luYWxMZWFmSWQpO1xuXHRcdGlmICghb3JpZ2luYWxMZWFmKSB7XG5cdFx0XHRyZXNldEJhY2tsaW5rSG92ZXIoKTtcblx0XHRcdHRocm93IG5ldyBFcnJvcihcIk9yaWdpbmFsIGxlYWYgbm90IGZvdW5kXCIpO1xuXHRcdH1cblxuXHRcdHdvcmtzcGFjZS5yZXZlYWxMZWFmKG9yaWdpbmFsTGVhZik7XG5cdH1cblxuXHQvLyBpZiAodGVtcCkge1xuXHQvLyBcdHRhcmdldExlYWYuZGV0YWNoKCk7XG5cdC8vIFx0Ly8gc2V0VGltZW91dCgoKSA9PiB7XG5cdC8vIFx0Ly8gXHR0YXJnZXRMZWFmLmRldGFjaCgpO1xuXHQvLyBcdC8vIH0sIDEwMCk7XG5cdC8vIH0gZWxzZSB7XG5cdC8vIFx0Ly8gaWYgdGhlIGN1cnNvciBpcyBhY3RpdmUsIGhpZ2hsaWdodCB0aGUgc2VsZWN0aW9uXG5cdC8vIH1cblxuXHQvLyBFbmQgbXV0ZXggbG9ja1xuXHRyZXNldEJhY2tsaW5rSG92ZXIoKTtcbn1cbiIsICJpbXBvcnQgeyBrZXltYXAgfSBmcm9tIFwiQGNvZGVtaXJyb3Ivdmlld1wiO1xuaW1wb3J0IHsgRWRpdG9yVmlldywgRGVjb3JhdGlvbiwgRGVjb3JhdGlvblNldCB9IGZyb20gXCJAY29kZW1pcnJvci92aWV3XCI7XG5pbXBvcnQge1xuXHRTdGF0ZUZpZWxkLFxuXHRTdGF0ZUVmZmVjdCxcblx0UmFuZ2VTZXQsXG5cdENoYW5nZURlc2MsXG59IGZyb20gXCJAY29kZW1pcnJvci9zdGF0ZVwiO1xuaW1wb3J0IHsgU1ZHX0hPVkVSX0NPTE9SIH0gZnJvbSBcIi4vY29uc3RhbnRzXCI7XG5cbmNvbnN0IGFkZEhpZ2hsaWdodCA9IFN0YXRlRWZmZWN0LmRlZmluZTx7IGZyb206IG51bWJlcjsgdG86IG51bWJlciB9Pih7XG5cdG1hcDogKHsgZnJvbSwgdG8gfSwgY2hhbmdlKSA9PiAoe1xuXHRcdGZyb206IGNoYW5nZS5tYXBQb3MoZnJvbSksXG5cdFx0dG86IGNoYW5nZS5tYXBQb3ModG8pLFxuXHR9KSxcbn0pO1xuXG5jb25zdCByZXNldEhpZ2hsaWdodCA9IFN0YXRlRWZmZWN0LmRlZmluZTx7IGZyb206IG51bWJlcjsgdG86IG51bWJlciB9Pih7XG5cdG1hcDogKHsgZnJvbSwgdG8gfSwgY2hhbmdlKSA9PiAoe1xuXHRcdGZyb206IGNoYW5nZS5tYXBQb3MoZnJvbSksXG5cdFx0dG86IGNoYW5nZS5tYXBQb3ModG8pLFxuXHR9KSxcbn0pO1xuXG5jb25zdCBoaWdobGlnaHRGaWVsZCA9IFN0YXRlRmllbGQuZGVmaW5lPERlY29yYXRpb25TZXQ+KHtcblx0Y3JlYXRlKCkge1xuXHRcdHJldHVybiBEZWNvcmF0aW9uLm5vbmU7XG5cdH0sXG5cdHVwZGF0ZShoaWdsaWdodHMsIHRyKSB7XG5cdFx0aGlnbGlnaHRzID0gaGlnbGlnaHRzLm1hcCh0ci5jaGFuZ2VzKTtcblx0XHRmb3IgKGxldCBlIG9mIHRyLmVmZmVjdHMpXG5cdFx0XHRpZiAoZS5pcyhhZGRIaWdobGlnaHQpKSB7XG5cdFx0XHRcdGhpZ2xpZ2h0cyA9IGhpZ2xpZ2h0cy51cGRhdGUoe1xuXHRcdFx0XHRcdGFkZDogW2hpZ2hsaWdodE1hcmsucmFuZ2UoZS52YWx1ZS5mcm9tLCBlLnZhbHVlLnRvKV0sXG5cdFx0XHRcdH0pO1xuXHRcdFx0fSBlbHNlIGlmIChlLmlzKHJlc2V0SGlnaGxpZ2h0KSkge1xuXHRcdFx0XHRoaWdsaWdodHMgPSBoaWdsaWdodHMudXBkYXRlKHsgZmlsdGVyOiAoZnJvbSwgdG8pID0+IGZhbHNlIH0pO1xuXHRcdFx0fVxuXHRcdHJldHVybiBoaWdsaWdodHM7XG5cdH0sXG5cdHByb3ZpZGU6IChmKSA9PiBFZGl0b3JWaWV3LmRlY29yYXRpb25zLmZyb20oZiksXG59KTtcblxuY29uc3QgaGlnaGxpZ2h0TWFyayA9IERlY29yYXRpb24ubWFyayh7IGNsYXNzOiBcImhpZ2hsaWdodFwiIH0pO1xuY29uc3QgaGlnaGxpZ2h0VGhlbWUgPSBFZGl0b3JWaWV3LmJhc2VUaGVtZSh7XG5cdFwiLmhpZ2hsaWdodFwiOiB7XG5cdFx0XCJiYWNrZ3JvdW5kLWNvbG9yXCI6IFwid2hpdGVcIixcblx0XHRjb2xvcjogXCJibGFja1wiLFxuXHR9LFxufSk7XG5jb25zdCBkZWZhdWx0SGlnaGxpZ2h0VGhlbWUgPSBFZGl0b3JWaWV3LmJhc2VUaGVtZSh7XG5cdFwiLmRlZmF1bHQtaGlnaGxpZ2h0XCI6IHtcblx0XHRcImJhY2tncm91bmQtY29sb3JcIjogU1ZHX0hPVkVSX0NPTE9SLFxuXHRcdGNvbG9yOiBcImJsYWNrXCIsXG5cdH0sXG59KTtcblxuZXhwb3J0IGZ1bmN0aW9uIGhpZ2hsaWdodFNlbGVjdGlvbih2aWV3OiBFZGl0b3JWaWV3LCBmcm9tOiBudW1iZXIsIHRvOiBudW1iZXIpIHtcblx0Y29uc29sZS5sb2coXCJoaWdobGlnaHRTZWxlY3Rpb25cIik7XG5cdGxldCBlZmZlY3RzOiBTdGF0ZUVmZmVjdDx1bmtub3duPltdID0gW2FkZEhpZ2hsaWdodC5vZih7IGZyb20sIHRvIH0pXTtcblxuXHRpZiAoIWVmZmVjdHMubGVuZ3RoKSByZXR1cm4gZmFsc2U7XG5cblx0aWYgKCF2aWV3LnN0YXRlLmZpZWxkKGhpZ2hsaWdodEZpZWxkLCBmYWxzZSkpXG5cdFx0ZWZmZWN0cy5wdXNoKFN0YXRlRWZmZWN0LmFwcGVuZENvbmZpZy5vZihbaGlnaGxpZ2h0RmllbGQsIGhpZ2hsaWdodFRoZW1lXSkpO1xuXG5cdHZpZXcuZGlzcGF0Y2goeyBlZmZlY3RzIH0pO1xuXHRyZXR1cm4gdHJ1ZTtcbn1cblxuLy8gaGF2ZSBhIGZ1bmN0aW9uIHRoYXQgYWRkcyBzdWJ0bGUgaGlnaGxpZ2h0cyB0byBzdGF0ZVxuZXhwb3J0IGZ1bmN0aW9uIGRlZmF1bHRIaWdobGlnaHRTZWxlY3Rpb24oXG5cdHZpZXc6IEVkaXRvclZpZXcsXG5cdGZyb206IG51bWJlcixcblx0dG86IG51bWJlclxuKSB7XG5cdGNvbnNvbGUubG9nKFwiZGVmYXVsdEhpZ2hsaWdodFNlbGVjdGlvblwiKTtcblx0bGV0IGVmZmVjdHM6IFN0YXRlRWZmZWN0PHVua25vd24+W10gPSBbYWRkSGlnaGxpZ2h0Lm9mKHsgZnJvbSwgdG8gfSldO1xuXG5cdGlmICghZWZmZWN0cy5sZW5ndGgpIHJldHVybiBmYWxzZTtcblxuXHRpZiAoIXZpZXcuc3RhdGUuZmllbGQoaGlnaGxpZ2h0RmllbGQsIGZhbHNlKSlcblx0XHRlZmZlY3RzLnB1c2goXG5cdFx0XHRTdGF0ZUVmZmVjdC5hcHBlbmRDb25maWcub2YoW2hpZ2hsaWdodEZpZWxkLCBkZWZhdWx0SGlnaGxpZ2h0VGhlbWVdKVxuXHRcdCk7XG5cblx0dmlldy5kaXNwYXRjaCh7IGVmZmVjdHMgfSk7XG5cdHJldHVybiB0cnVlO1xufVxuXG4vLyB1cGRhdGUgcmVtb3ZlIGhpZ2hsaWdodHMgc28gdGhhdFxuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZUhpZ2hsaWdodHModmlldzogRWRpdG9yVmlldykge1xuXHRpZiAoIXZpZXcpIHJldHVybjtcblxuXHRsZXQgZWZmZWN0czogU3RhdGVFZmZlY3Q8dW5rbm93bj5bXSA9IHZpZXcuc3RhdGUuc2VsZWN0aW9uLnJhbmdlcy5tYXAoXG5cdFx0KHsgZnJvbSwgdG8gfSkgPT4gcmVzZXRIaWdobGlnaHQub2YoeyBmcm9tLCB0byB9KVxuXHQpO1xuXHRpZiAoZWZmZWN0cy5sZW5ndGgpIHtcblx0XHR2aWV3LmRpc3BhdGNoKHsgZWZmZWN0cyB9KTtcblx0XHRyZXR1cm4gdHJ1ZTtcblx0fVxuXHRyZXR1cm4gZmFsc2U7XG59XG4iLCAiaW1wb3J0IHtcblx0RWRpdG9yVmlldyxcblx0V2lkZ2V0VHlwZSxcblx0RGVjb3JhdGlvbixcblx0RGVjb3JhdGlvblNldCxcblx0Vmlld1BsdWdpbixcblx0Vmlld1VwZGF0ZSxcblx0TWF0Y2hEZWNvcmF0b3IsXG5cdGd1dHRlcixcblx0R3V0dGVyTWFya2VyLFxufSBmcm9tIFwiQGNvZGVtaXJyb3Ivdmlld1wiO1xuaW1wb3J0IHsgU1ZHX0hPVkVSX0NPTE9SIH0gZnJvbSBcIi4uL2NvbnN0YW50c1wiO1xuXG4vKiBoaWdobGlnaHQgKi9cbmNsYXNzIEhpZ2hsaWdodGVyV2lkZ2V0IGV4dGVuZHMgV2lkZ2V0VHlwZSB7XG5cdGNvbnN0cnVjdG9yKHByaXZhdGUgbmFtZTogc3RyaW5nLCBwcml2YXRlIHZpZXc6IEVkaXRvclZpZXcpIHtcblx0XHRzdXBlcigpO1xuXHR9XG5cblx0ZXEob3RoZXI6IEhpZ2hsaWdodGVyV2lkZ2V0KSB7XG5cdFx0cmV0dXJuIHRoaXMubmFtZSA9PT0gb3RoZXIubmFtZTtcblx0fVxuXG5cdHRvRE9NKCkge1xuXHRcdGNvbnN0IHNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZnJhZ21lbnRcIik7XG5cdFx0c3Bhbi50ZXh0Q29udGVudCA9IHRoaXMubmFtZTtcblx0XHRzcGFuLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFNWR19IT1ZFUl9DT0xPUjtcblx0XHRzcGFuLnN0eWxlLmNvbG9yID0gXCJibGFja1wiO1xuXG5cdFx0cmV0dXJuIHNwYW47XG5cdH1cbn1cblxuY29uc3QgaGlnaGxpZ2h0ZXJEZWNvcmF0aW9uID0gKG1hdGNoOiBSZWdFeHBFeGVjQXJyYXksIHZpZXc6IEVkaXRvclZpZXcpID0+XG5cdERlY29yYXRpb24ucmVwbGFjZSh7XG5cdFx0d2lkZ2V0OiBuZXcgSGlnaGxpZ2h0ZXJXaWRnZXQobWF0Y2hbMV0sIHZpZXcpLFxuXHR9KTtcblxuY29uc3QgaGlnaGxpZ2h0TWF0Y2hlciA9IG5ldyBNYXRjaERlY29yYXRvcih7XG5cdHJlZ2V4cDogL1xcK1xcK1xcKyguKj8pXFwrXFwrXFwrL2csXG5cdGRlY29yYXRpb246IChtYXRjaCwgdmlldywgcG9zKSA9PiB7XG5cdFx0cmV0dXJuIGhpZ2hsaWdodGVyRGVjb3JhdGlvbihtYXRjaCwgdmlldyk7XG5cdH0sXG59KTtcblxuZXhwb3J0IGNvbnN0IGhpZ2hsaWdodHMgPSBWaWV3UGx1Z2luLmZyb21DbGFzcyhcblx0Y2xhc3Mge1xuXHRcdGhpZ2hsaWdodHM6IERlY29yYXRpb25TZXQ7XG5cdFx0Y29uc3RydWN0b3IodmlldzogRWRpdG9yVmlldykge1xuXHRcdFx0dGhpcy5oaWdobGlnaHRzID0gaGlnaGxpZ2h0TWF0Y2hlci5jcmVhdGVEZWNvKHZpZXcpO1xuXHRcdH1cblx0XHR1cGRhdGUodXBkYXRlOiBWaWV3VXBkYXRlKSB7XG5cdFx0XHR0aGlzLmhpZ2hsaWdodHMgPSBoaWdobGlnaHRNYXRjaGVyLnVwZGF0ZURlY28odXBkYXRlLCB0aGlzLmhpZ2hsaWdodHMpO1xuXHRcdH1cblx0XHRkZXN0cm95KCkge1xuXHRcdFx0dGhpcy5oaWdobGlnaHRzID0gRGVjb3JhdGlvbi5ub25lO1xuXHRcdH1cblx0fSxcblx0e1xuXHRcdGRlY29yYXRpb25zOiAoaW5zdGFuY2UpID0+IGluc3RhbmNlLmhpZ2hsaWdodHMsXG5cdFx0cHJvdmlkZTogKHBsdWdpbikgPT5cblx0XHRcdEVkaXRvclZpZXcuYXRvbWljUmFuZ2VzLm9mKCh2aWV3KSA9PiB7XG5cdFx0XHRcdHJldHVybiB2aWV3LnBsdWdpbihwbHVnaW4pPy5oaWdobGlnaHRzIHx8IERlY29yYXRpb24ubm9uZTtcblx0XHRcdH0pLFxuXHR9XG4pO1xuIiwgImltcG9ydCB7XG5cdEVkaXRvclZpZXcsXG5cdFdpZGdldFR5cGUsXG5cdERlY29yYXRpb24sXG5cdERlY29yYXRpb25TZXQsXG5cdFZpZXdQbHVnaW4sXG5cdFZpZXdVcGRhdGUsXG5cdE1hdGNoRGVjb3JhdG9yLFxuXHRndXR0ZXIsXG5cdEd1dHRlck1hcmtlcixcbn0gZnJvbSBcIkBjb2RlbWlycm9yL3ZpZXdcIjtcblxuaW1wb3J0IHtcblx0b3BlblJlZmVyZW5jZSxcblx0Y3JlYXRlUmVmZXJlbmNlSWNvbixcblx0Z2VuZXJhdGVCYWNrbGlua3MsXG5cdGNyZWF0ZUJhY2tsaW5rTWFyayxcblx0dXBkYXRlQmFja2xpbmtNYXJrUG9zaXRpb25zLFxufSBmcm9tIFwiLi4vcmVmZXJlbmNlc1wiO1xuaW1wb3J0IHsgZGVjb2RlVVJJQ29tcG9uZW50U3RyaW5nLCBlbmNvZGVVUklDb21wb25lbnRTdHJpbmcgfSBmcm9tIFwic3JjL3V0aWxzXCI7XG5pbXBvcnQgeyBnZXRCYWNrbGlua3MgfSBmcm9tIFwic3JjL3N0YXRlXCI7XG5cbi8qIG5ldyBwbGFjZWhvbGRlciAqL1xuY2xhc3MgUmVmZXJlbmNlV2lkZ2V0IGV4dGVuZHMgV2lkZ2V0VHlwZSB7XG5cdGNvbnN0cnVjdG9yKFxuXHRcdHByaXZhdGUgbmFtZTogc3RyaW5nLFxuXHRcdHByaXZhdGUgdmlldzogRWRpdG9yVmlldyxcblx0XHRwcml2YXRlIHBvczogbnVtYmVyXG5cdCkge1xuXHRcdHN1cGVyKCk7XG5cdH1cblxuXHRlcShvdGhlcjogUmVmZXJlbmNlV2lkZ2V0KSB7XG5cdFx0cmV0dXJuIHRoaXMubmFtZSA9PT0gb3RoZXIubmFtZTtcblx0fVxuXG5cdHVwZGF0ZU5hbWUobmFtZTogc3RyaW5nLCBwb3J0YWw6IHN0cmluZykge1xuXHRcdGNvbnN0IGZyb20gPSB0aGlzLnBvcztcblx0XHQvLyB0ZXh0IGxlbmd0aCBmb3IgdGhlc2UgdHdvIHN0YXRlcyBpcyBkaWZmZXJlbnRcblx0XHRjb25zdCB0byA9IHRoaXMucG9zICsgbmFtZS5sZW5ndGggKyAocG9ydGFsID09IFwicG9ydGFsXCIgPyAzIDogLTMpO1xuXHRcdGNvbnN0IHRyYW5zYWN0aW9uID0gdGhpcy52aWV3LnN0YXRlLnVwZGF0ZSh7XG5cdFx0XHRjaGFuZ2VzOiB7IGZyb20sIHRvLCBpbnNlcnQ6IG5hbWUgfSxcblx0XHR9KTtcblx0XHR0aGlzLnZpZXcuZGlzcGF0Y2godHJhbnNhY3Rpb24pO1xuXHRcdHVwZGF0ZUJhY2tsaW5rTWFya1Bvc2l0aW9ucygpO1xuXHRcdHRoaXMubmFtZSA9IG5hbWU7XG5cdH1cblxuXHRnZXRWaWV3KCkge1xuXHRcdHJldHVybiB0aGlzLnZpZXc7XG5cdH1cblxuXHR0b0RPTSgpIHtcblx0XHRjb25zdCByZWdleCA9IC9cXFtcdTIxOTdcXF1cXCh1cm46KFteKV0qKVxcKS9nO1xuXHRcdGxldCBjb250ZW50ID0gcmVnZXguZXhlYyh0aGlzLm5hbWUpO1xuXHRcdGlmICghY29udGVudCkgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCByZWZlcmVuY2VcIik7XG5cdFx0Y29uc3QgW3ByZWZpeCwgdGV4dCwgc3VmZml4LCBmaWxlLCBmcm9tLCB0bywgcG9ydGFsXSA9XG5cdFx0XHRjb250ZW50WzFdLnNwbGl0KFwiOlwiKTtcblxuXHRcdGNvbnN0IHsgc3Bhbiwgc3ZnIH0gPSBjcmVhdGVSZWZlcmVuY2VJY29uKFxuXHRcdFx0cG9ydGFsID09IFwicG9ydGFsXCIgPyBcImlubGluZSByZWZlcmVuY2Ugd2lkZ2V0IHwqfFwiIDogbnVsbFxuXHRcdCk7XG5cblx0XHRpZiAoY29udGVudCkgc3Bhbi5zZXRBdHRyaWJ1dGUoXCJkYXRhXCIsIGNvbnRlbnRbMV0pO1xuXG5cdFx0Y29uc3QgY29udGFpbmVyU3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO1xuXHRcdGNvbnN0IHJlZmVyZW5jZVNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTtcblxuXHRcdHJlZmVyZW5jZVNwYW4uaW5uZXJIVE1MID0gZGVjb2RlVVJJQ29tcG9uZW50U3RyaW5nKHRleHQpO1xuXHRcdHJlZmVyZW5jZVNwYW4uc3R5bGUuYm9yZGVyID0gXCIxcHggc29saWQgd2hpdGVcIjtcblx0XHRyZWZlcmVuY2VTcGFuLnN0eWxlLmJvcmRlclJhZGl1cyA9IFwiM3B4XCI7XG5cdFx0aWYgKHBvcnRhbCA9PSBcIm5vLXBvcnRhbFwiKSByZWZlcmVuY2VTcGFuLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcblxuXHRcdGNvbnRhaW5lclNwYW4uYXBwZW5kQ2hpbGQocmVmZXJlbmNlU3Bhbik7XG5cdFx0Y29udGFpbmVyU3Bhbi5hcHBlbmRDaGlsZChzcGFuKTtcblxuXHRcdHNwYW4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldikgPT4ge1xuXHRcdFx0aWYgKGV2Lm1ldGFLZXkgfHwgZXYuY3RybEtleSkge1xuXHRcdFx0XHRsZXQgbmV3UG9ydGFsID0gXCJcIjtcblx0XHRcdFx0aWYgKHJlZmVyZW5jZVNwYW4uc3R5bGUuZGlzcGxheSA9PT0gXCJub25lXCIpIHtcblx0XHRcdFx0XHRyZWZlcmVuY2VTcGFuLnN0eWxlLmRpc3BsYXkgPSBcImlubGluZVwiO1xuXHRcdFx0XHRcdG5ld1BvcnRhbCA9IFwicG9ydGFsXCI7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0cmVmZXJlbmNlU3Bhbi5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG5cdFx0XHRcdFx0bmV3UG9ydGFsID0gXCJuby1wb3J0YWxcIjtcblx0XHRcdFx0fVxuXHRcdFx0XHQvLyBsZXQgcmVmZXJlbmNlID0gYFtcdTIxOTddKHVybjoke2VuY29kZVVSSUNvbXBvbmVudFN0cmluZyhcblx0XHRcdFx0Ly8gXHRwcmVmaXguc2xpY2UoMCwgLTEpXG5cdFx0XHRcdC8vICl9LToke2VuY29kZVVSSUNvbXBvbmVudFN0cmluZyh0ZXh0KX06LSR7ZW5jb2RlVVJJQ29tcG9uZW50U3RyaW5nKFxuXHRcdFx0XHQvLyBcdHN1ZmZpeC5zbGljZSgxKVxuXHRcdFx0XHQvLyApfToke2ZpbGV9OiR7ZnJvbX06JHt0b306JHtlbmNvZGVVUklDb21wb25lbnRTdHJpbmcobmV3UG9ydGFsKX0pYDtcblx0XHRcdFx0bGV0IHJlZmVyZW5jZSA9IGBbXHUyMTk3XSh1cm46JHtwcmVmaXh9OiR7dGV4dH06JHtzdWZmaXh9OiR7ZmlsZX06JHtmcm9tfToke3RvfToke25ld1BvcnRhbH0pYDtcblxuXHRcdFx0XHR0aGlzLnVwZGF0ZU5hbWUocmVmZXJlbmNlLCBuZXdQb3J0YWwpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0b3BlblJlZmVyZW5jZShldik7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRyZXR1cm4gY29udGFpbmVyU3Bhbjtcblx0fVxufVxuXG5jb25zdCByZWZlcmVuY2VEZWNvcmF0aW9uID0gKFxuXHRtYXRjaDogUmVnRXhwRXhlY0FycmF5LFxuXHR2aWV3OiBFZGl0b3JWaWV3LFxuXHRwb3M6IG51bWJlclxuKSA9PiB7XG5cdGxldCBkZWNvcmF0aW9uID0gRGVjb3JhdGlvbi5yZXBsYWNlKHtcblx0XHR3aWRnZXQ6IG5ldyBSZWZlcmVuY2VXaWRnZXQobWF0Y2hbMF0sIHZpZXcsIHBvcyksXG5cdH0pO1xuXHRyZXR1cm4gZGVjb3JhdGlvbjtcbn07XG5cbmNvbnN0IHJlZmVyZW5jZU1hdGNoZXIgPSBuZXcgTWF0Y2hEZWNvcmF0b3Ioe1xuXHQvLyByZWdleHA6IC9cXFtcXHUyMTk3XFxdXFwodXJuOltcXHNcXFNeXFwpXSpcXCkvZyxcblx0Ly8gcmVnZXhwOiAvXFxbXFx1MjE5N1xcXVxcKHVybjooW146XSo6KXs1LDZ9W146XSpcXCkvZyxcblx0cmVnZXhwOiAvXFxbXFx1MjE5N1xcXVxcKHVybjooW146XSo6KXs2fVteOildKlxcKS9nLFxuXHRkZWNvcmF0aW9uOiAobWF0Y2gsIHZpZXcsIHBvcykgPT4ge1xuXHRcdHJldHVybiByZWZlcmVuY2VEZWNvcmF0aW9uKG1hdGNoLCB2aWV3LCBwb3MpO1xuXHR9LFxufSk7XG5cbmV4cG9ydCBjb25zdCByZWZlcmVuY2VSZXNvdXJjZXMgPSBWaWV3UGx1Z2luLmZyb21DbGFzcyhcblx0Y2xhc3Mge1xuXHRcdHJlZmVyZW5jZVJlc291cmNlczogRGVjb3JhdGlvblNldDtcblx0XHRjb25zdHJ1Y3Rvcih2aWV3OiBFZGl0b3JWaWV3KSB7XG5cdFx0XHR0aGlzLnJlZmVyZW5jZVJlc291cmNlcyA9IHJlZmVyZW5jZU1hdGNoZXIuY3JlYXRlRGVjbyh2aWV3KTtcblx0XHR9XG5cdFx0dXBkYXRlKHVwZGF0ZTogVmlld1VwZGF0ZSkge1xuXHRcdFx0dGhpcy5yZWZlcmVuY2VSZXNvdXJjZXMgPSByZWZlcmVuY2VNYXRjaGVyLnVwZGF0ZURlY28oXG5cdFx0XHRcdHVwZGF0ZSxcblx0XHRcdFx0dGhpcy5yZWZlcmVuY2VSZXNvdXJjZXNcblx0XHRcdCk7XG5cdFx0fVxuXHRcdGRlc3Ryb3koKSB7XG5cdFx0XHR0aGlzLnJlZmVyZW5jZVJlc291cmNlcyA9IERlY29yYXRpb24ubm9uZTtcblx0XHR9XG5cdH0sXG5cdHtcblx0XHRkZWNvcmF0aW9uczogKGluc3RhbmNlKSA9PiBpbnN0YW5jZS5yZWZlcmVuY2VSZXNvdXJjZXMsXG5cdFx0cHJvdmlkZTogKHBsdWdpbikgPT5cblx0XHRcdEVkaXRvclZpZXcuYXRvbWljUmFuZ2VzLm9mKCh2aWV3KSA9PiB7XG5cdFx0XHRcdHJldHVybiB2aWV3LnBsdWdpbihwbHVnaW4pPy5yZWZlcmVuY2VSZXNvdXJjZXMgfHwgRGVjb3JhdGlvbi5ub25lO1xuXHRcdFx0fSksXG5cdH1cbik7XG4iLCAiaW1wb3J0IHsgUGx1Z2luLCBNYXJrZG93blZpZXcsIEVkaXRvciB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHtcblx0cHJvY2Vzc1VSSSxcblx0cGFyc2VFZGl0b3JQb3NpdGlvbixcblx0ZW5jb2RlVVJJQ29tcG9uZW50U3RyaW5nLFxuXHRnZXRQcmVmaXhBbmRTdWZmaXgsXG59IGZyb20gXCIuL3V0aWxzXCI7XG5cbi8vIFtcdTIxOTddKHVybjpBbHNvLTogaG9wZWZ1bGx5IGZpeCB0aGUgbXVsdGktbGluZSByZWZlcmVuY2U6LSUwQS0gVVJOczoxMS0yMyBUb2RvLm1kKVxuLy8gW1x1MjE5N10odXJuOlBSRUZJWC06VEVYVDotU1VGRklYOkZJTEU6U1RBUlRJTkRFWDpFTkRJTkRFWClcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVDbGlwYm9hcmQob25seTogYm9vbGVhbiA9IGZhbHNlKSB7XG5cdGNvbnN0IHZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuXHQvLyBNYWtlIHN1cmUgdGhlIHVzZXIgaXMgZWRpdGluZyBhIE1hcmtkb3duIGZpbGUuXG5cdGlmICh2aWV3KSB7XG5cdFx0bGV0IHNlbGVjdGlvbiA9IHZpZXcuZWRpdG9yLmdldFNlbGVjdGlvbigpO1xuXHRcdGlmICh2aWV3LmZpbGUpIHtcblx0XHRcdGNvbnN0IHRleHQgPSB2aWV3LmRhdGE7XG5cdFx0XHRjb25zdCBmcm9tID0gdmlldy5lZGl0b3IucG9zVG9PZmZzZXQodmlldy5lZGl0b3IuZ2V0Q3Vyc29yKFwiZnJvbVwiKSk7XG5cdFx0XHRjb25zdCB0byA9IHZpZXcuZWRpdG9yLnBvc1RvT2Zmc2V0KHZpZXcuZWRpdG9yLmdldEN1cnNvcihcInRvXCIpKTtcblx0XHRcdGNvbnN0IHsgcHJlZml4LCBzdWZmaXggfSA9IGdldFByZWZpeEFuZFN1ZmZpeCh0ZXh0LCBmcm9tLCB0byk7XG5cdFx0XHRsZXQgcmVmZXJlbmNlID0gYFtcdTIxOTddKHVybjoke2VuY29kZVVSSUNvbXBvbmVudFN0cmluZyhcblx0XHRcdFx0cHJlZml4XG5cdFx0XHQpfS06JHtlbmNvZGVVUklDb21wb25lbnRTdHJpbmcoc2VsZWN0aW9uKX06LSR7ZW5jb2RlVVJJQ29tcG9uZW50U3RyaW5nKFxuXHRcdFx0XHRzdWZmaXhcblx0XHRcdCl9OiR7ZW5jb2RlVVJJQ29tcG9uZW50U3RyaW5nKHZpZXcuZmlsZS5wYXRoKX06JHtmcm9tfToke3RvfToke1xuXHRcdFx0XHRvbmx5ID8gXCJwb3J0YWxcIiA6IFwibm8tcG9ydGFsXCJcblx0XHRcdH0pYDtcblxuXHRcdFx0Ly8gaWYgKCFvbmx5KSB7XG5cdFx0XHQvLyBcdHJlZmVyZW5jZSA9ICdcIicgKyBzZWxlY3Rpb24gKyAnXCIgJyArIHJlZmVyZW5jZTtcblx0XHRcdC8vIH1cblxuXHRcdFx0Ly8gV3JpdGUgdGhlIHNlbGVjdGVkIHRleHQgdG8gdGhlIGNsaXBib2FyZFxuXHRcdFx0YXdhaXQgbmF2aWdhdG9yLmNsaXBib2FyZC53cml0ZVRleHQocmVmZXJlbmNlKTtcblx0XHR9XG5cdH1cbn1cbiJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxJQUFBQSxtQkFBNkM7OztBQ0E3QyxJQUFBQyxnQkFLTzs7O0FDTFAsSUFBQUMsbUJBQTJEOzs7QUNBM0QsSUFBTyxnQkFBUTs7O0FDRWYsU0FBUyxTQUFTLE1BQU07QUFDdEIsU0FBTyxPQUFPLFNBQVMsWUFBWSxjQUFNLEtBQUssSUFBSTtB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LE1BQU0sU0FBUyxLQUFLLElBQUksS0FBSyxJQUFJLEdBQUcsRUFBRTtBQUN0RCxJQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsSUFBSSxLQUFLLE1BQU0sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUM7QUFDdEMsSUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLEtBQUssTUFBTSxTQUFTLEtBQUssSUFBSTtBQUV4QyxXQUFTLElBQUksR0FBRyxJQUFJLEdBQUcsRUFBRSxHQUFHO0FBQzFCLFVBQU0sSUFBSSxJQUFJLFlBQVksRUFBRTtBQUU1QixhQUFTLElBQUksR0FBRyxJQUFJLElBQUksRUFBRSxHQUFHO0FBQzNCLFFBQUUsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxFQUFFLENBQUM7QUFBQSxJQUNmO0FBRUEsYUFBUyxJQUFJLElBQUksSUFBSSxJQUFJLEVBQUUsR0FBRztBQUM1QixRQUFFLENBQUMsSUFBSSxLQUFLLEVBQUUsSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLEdBQUcsQ0FBQztBQUFBLElBQzVEO0FBRUEsUUFBSSxJQUFJLEVBQUUsQ0FBQztBQUNYLFFBQUksSUFBSSxFQUFFLENBQUM7QUFDWCxRQUFJLElBQUksRUFBRSxDQUFDO0FBQ1gsUUFBSSxJQUFJLEVBQUUsQ0FBQztBQUNYLFFBQUksSUFBSSxFQUFFLENBQUM7QUFFWCxhQUFTLElBQUksR0FBRyxJQUFJLElBQUksRUFBRSxHQUFHO0FBQzNCLFlBQU0sSUFBSSxLQUFLLE1BQU0sSUFBSSxFQUFFO0FBQzNCLFlBQU0sSUFBSSxLQUFLLEdBQUcsQ0FBQyxJQUFJLEVBQUUsR0FBRyxHQUFHLEdBQUcsQ0FBQyxJQUFJLElBQUksRUFBRSxDQUFDLElBQUksRUFBRSxDQUFDLE1BQU07QUFDM0QsVUFBSTtBQUNKLFVBQUk7QUFDSixVQUFJLEtBQUssR0FBRyxFQUFFLE1BQU07QUFDcEIsVUFBSTtBQUNKLFVBQUk7QUFBQSxJQUNOO0FBRUEsTUFBRSxDQUFDLElB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O0FBSUQsU0FBSyxpQkFBaUIsVUFBVSxTQUFTLE9BQU8sUUFBUTtBQUN2RCxVQUFJLElBQUksV0FBVyxJQUFJO0FBQVM7QUFDaEMsdUJBQWlCLEdBQUc7QUFDcEIsTUFBQUYsNkJBQTRCO0FBQUEsSUFDN0IsQ0FBQztBQUVELFNBQUssaUJBQWlCLFVBQVUsU0FBUyxPQUFPLFFBQVE7QUFDdkQsVUFBSSxJQUFJLFdBQVcsSUFBSTtBQUFTO0FBR2hDLHVCQUFpQixHQUFHO0FBRXBCLE1BQUFBLDZCQUE0QjtBQUFBLElBQzdCLENBQUM7QUFFRCxTQUFLLGlCQUFpQixVQUFVLFdBQVcsT0FBTyxRQUFRO0FBR3pELFVBQUksSUFBSSxPQUFPLE9BQU8sSUFBSSxXQUFXLElBQUksVUFBVTtBQUVsRCx3QkFBZ0I7QUFDaEIsWUFBSSx3QkFBTyx3Q0FBd0M7QUFBQSxNQUNwRCxXQUFXLElBQUksT0FBTyxPQUFPLElBQUksV0FBVyxJQUFJLFVBQVU7QUFFekQsd0JBQWdCLElBQUk7QUFDcEIsWUFBSSx3QkFBTyxnQ0FBZ0M7QUFBQSxNQUM1QyxXQUFXLElBQUksT0FBTyxPQUFPLElBQUksV0FBVyxJQUFJLFVBQVU7QUFNekQsWUFBSSx3QkFBTyxnQkFBZ0I7QUFBQSxNQUM1QjtBQUFBLElBQ0QsQ0FBQztBQUFBLEVBa0RGO0FBQUEsRUFFQSxXQUFXO0FBQUEsRUFBQztBQUNiOyIsCiAgIm5hbWVzIjogWyJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X3N0YXRlIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9zdGF0ZSIsICJmIiwgImltcG9ydF92aWV3IiwgImRhdGFTdHJpbmciLCAiY3Vyc29yVmlld3BvcnQiLCAibGVhZklkIiwgIm9yaWdpbmFsTGVhZklkIiwgImVkaXRvclZpZXciLCAib3JpZ2luYWxMZWFmIiwgImRlY29kZVVSSUNvbXBvbmVudFN0cmluZyIsICJkb2N1bWVudCIsICJoYW5kbGVSZW1vdmVIb3ZlcmVkQ3Vyc29yIiwgInN2ZyIsICJoYW5kbGVSZW1vdmVIb3ZlcmVkQ3Vyc29yIiwgImdldExlYWZCQm94RWxlbWVudHMiLCAidXBkYXRlQmFja2xpbmtNYXJrUG9zaXRpb24iLCAiYmFja2xpbmtzIiwgInVwZGF0ZUJhY2tsaW5rTWFya1Bvc2l0aW9ucyIsICJoYW5kbGVSZW1vdmVIb3ZlcmVkQ3Vyc29yIiwgImJhY2tsaW5rcyIsICJ0ZXh0IiwgImluZGV4IiwgImhhbmRsZVJlbW92ZUhvdmVyZWRDdXJzb3IiLCAidXBkYXRlQmFja2xpbmtNYXJrUG9zaXRpb25zIiwgInN0YXRlIiwgInN0YXRlIiwgInRoYXQiLCAiZ2V0QmFja2xpbmtzIiwgImltcG9ydF92aWV3IiwgImltcG9ydF92aWV3IiwgInVwZGF0ZUJhY2tsaW5rTWFya1Bvc2l0aW9ucyIsICJkZWNvZGVVUklDb21wb25lbnRTdHJpbmciLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF92aWV3IiwgInVwZGF0ZUJhY2tsaW5rTWFya1Bvc2l0aW9ucyIsICJoYW5kbGVSZW1vdmVIb3ZlcmVkQ3Vyc29yIiwgImdldEJhY2tsaW5rcyJdCn0K
