/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => ReferencePlugin,
  handleMovementEffects: () => handleMovementEffects
});
module.exports = __toCommonJS(main_exports);
var import_obsidian6 = require("obsidian");

// src/state.ts
var import_state = require("@codemirror/state");
var that = import_state.StateField.define({
  create() {
    return null;
  },
  update(value, tr) {
    if (tr["annotations"].length == 2 && tr["annotations"][0].value.type == "that") {
      return tr["annotations"][0].value.that.app;
    }
    return value;
  }
});
var hoverElement = import_state.StateField.define({
  create() {
    return null;
  },
  update(value, tr) {
    if (tr.effects.length > 0) {
      try {
        let data = JSON.parse(tr.effects[0].value);
        if (data.type == "hover-start") {
          return Object.assign({}, data);
        } else if (data.type == "hover") {
          if (value)
            return Object.assign(value, data);
          return data;
        } else if (data.type == "hover-off") {
          return null;
        }
        return value;
      } catch (e) {
        console.log(e);
        return value;
      }
    }
    return value;
  }
});
var backlinkHoverElement = import_state.StateField.define({
  create() {
    return null;
  },
  update(value, tr) {
    if (tr.effects.length > 0) {
      try {
        let data = JSON.parse(tr.effects[0].value);
        if (data.type == "backlink-start") {
          return Object.assign({}, data);
        } else if (data.type == "backlink-update") {
          if (value)
            return Object.assign(value, data);
          return data;
        } else if (data.type == "backlink-off") {
          return null;
        }
        return value;
      } catch (e) {
        console.log(e);
        return value;
      }
    }
    return value;
  }
});
var backlinks = import_state.StateField.define({
  create() {
    return [];
  },
  update(value, tr) {
    if (tr.effects.length > 0) {
      try {
        let data = JSON.parse(
          tr.effects[0].value
        );
        if (data.type == "backlink") {
          console.log(data.backlinks);
          let referencingLocations = data.backlinks.map(
            (backlink) => backlink.referencingLocation
          );
          let referencedLocations = data.backlinks.map(
            (backlink) => backlink.referencedLocation
          );
          let filteredBacklinks = value.filter((backlink) => {
            return !(referencedLocations.includes(backlink.referencedLocation) && referencingLocations.includes(backlink.referencingLocation));
            console.log(backlink);
            return !data.backlinks.includes(backlink);
          });
          console.log(filteredBacklinks);
          return [...filteredBacklinks, ...data.backlinks];
        } else if (data.type == "remove-backlink") {
          let filteredBacklinks = value.filter((backlink) => {
          });
          return filteredBacklinks;
        }
        return value;
      } catch (e) {
        console.log(e);
        return value;
      }
    }
    return value;
  }
});
var thatAnnotation = import_state.Annotation.define();
var hoverEffect = import_state.StateEffect.define();
var backlinkHoverEffect = import_state.StateEffect.define();
var backlinkEffect = import_state.StateEffect.define();
var state = import_state.EditorState.create({
  extensions: [that, backlinks, hoverElement, backlinkHoverElement]
});
function getThat() {
  return state.field(that);
}
function updateThat(that2) {
  state = state.update({
    annotations: thatAnnotation.of({
      type: "that",
      that: that2
    })
  }).state;
}
function getHover() {
  return state.field(hoverElement);
}
function updateHover(value) {
  state = state.update({
    effects: hoverEffect.of(
      JSON.stringify(Object.assign(value, { type: "hover" }))
    )
  }).state;
}
function resetHover() {
  state = state.update({
    effects: hoverEffect.of(
      JSON.stringify({
        type: "hover-off"
      })
    )
  }).state;
}
function getBacklinkHover() {
  return state.field(backlinkHoverElement);
}
function updateBacklinkHover(value) {
  state = state.update({
    effects: backlinkHoverEffect.of(
      JSON.stringify(Object.assign(value, { type: "backlink-update" }))
    )
  }).state;
}
function resetBacklinkHover() {
  state = state.update({
    effects: backlinkHoverEffect.of(
      JSON.stringify({
        type: "backlink-off"
      })
    )
  }).state;
}
function getBacklinks() {
  return state.field(backlinks);
}
function updateBacklinks(value) {
  state = state.update({
    effects: backlinkEffect.of(
      JSON.stringify(Object.assign({ backlinks: value }, { type: "backlink" }))
    )
  }).state;
}

// src/widget/highlightWidget.ts
var import_view = require("@codemirror/view");

// src/constants.ts
var REFERENCE_REGEX = /\[\u2197\]\(urn:([^)]*)\)/g;
var ACTION_TYPE = {
  MOUSE: "mouse",
  CURSOR: "cursor",
  BACKLINK: "backlink"
};
var SVG_HOVER_COLOR = "rgb(187, 215, 230)";
var PORTAL_TEXT_SLICE_SIZE = 100;

// src/widget/highlightWidget.ts
var HighlighterWidget = class extends import_view.WidgetType {
  constructor(name, view) {
    super();
    this.name = name;
    this.view = view;
  }
  eq(other) {
    return this.name === other.name;
  }
  toDOM() {
    const span = document.createElement("fragment");
    span.textContent = this.name;
    span.style.backgroundColor = SVG_HOVER_COLOR;
    span.style.color = "black";
    return span;
  }
};
var highlighterDecoration = (match, view) => import_view.Decoration.replace({
  widget: new HighlighterWidget(match[1], view)
});
var highlightMatcher = new import_view.MatchDecorator({
  regexp: /\+\+\+(.*?)\+\+\+/g,
  decoration: (match, view, pos) => {
    return highlighterDecoration(match, view);
  }
});
var highlights = import_view.ViewPlugin.fromClass(
  class {
    constructor(view) {
      this.highlights = highlightMatcher.createDeco(view);
    }
    update(update) {
      this.highlights = highlightMatcher.updateDeco(update, this.highlights);
    }
    destroy() {
      this.highlights = import_view.Decoration.none;
    }
  },
  {
    decorations: (instance) => instance.highlights,
    provide: (plugin) => import_view.EditorView.atomicRanges.of((view) => {
      var _a;
      return ((_a = view.plugin(plugin)) == null ? void 0 : _a.highlights) || import_view.Decoration.none;
    })
  }
);

// src/widget/referenceWidget.ts
var import_view4 = require("@codemirror/view");

// src/references.ts
var import_obsidian4 = require("obsidian");

// node_modules/uuid/dist/esm-browser/rng.js
var getRandomValues;
var rnds8 = new Uint8Array(16);
function rng() {
  if (!getRandomValues) {
    getRandomValues = typeof crypto !== "undefined" && crypto.getRandomValues && crypto.getRandomValues.bind(crypto);
    if (!getRandomValues) {
      throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");
    }
  }
  return getRandomValues(rnds8);
}

// node_modules/uuid/dist/esm-browser/regex.js
var regex_default = /^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;

// node_modules/uuid/dist/esm-browser/validate.js
function validate(uuid) {
  return typeof uuid === "string" && regex_default.test(uuid);
}
var validate_default = validate;

// node_modules/uuid/dist/esm-browser/stringify.js
var byteToHex = [];
for (let i = 0; i < 256; ++i) {
  byteToHex.push((i + 256).toString(16).slice(1));
}
function unsafeStringify(arr, offset = 0) {
  return byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + "-" + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + "-" + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + "-" + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + "-" + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]];
}

// node_modules/uuid/dist/esm-browser/parse.js
function parse(uuid) {
  if (!validate_default(uuid)) {
    throw TypeError("Invalid UUID");
  }
  let v;
  const arr = new Uint8Array(16);
  arr[0] = (v = parseInt(uuid.slice(0, 8), 16)) >>> 24;
  arr[1] = v >>> 16 & 255;
  arr[2] = v >>> 8 & 255;
  arr[3] = v & 255;
  arr[4] = (v = parseInt(uuid.slice(9, 13), 16)) >>> 8;
  arr[5] = v & 255;
  arr[6] = (v = parseInt(uuid.slice(14, 18), 16)) >>> 8;
  arr[7] = v & 255;
  arr[8] = (v = parseInt(uuid.slice(19, 23), 16)) >>> 8;
  arr[9] = v & 255;
  arr[10] = (v = parseInt(uuid.slice(24, 36), 16)) / 1099511627776 & 255;
  arr[11] = v / 4294967296 & 255;
  arr[12] = v >>> 24 & 255;
  arr[13] = v >>> 16 & 255;
  arr[14] = v >>> 8 & 255;
  arr[15] = v & 255;
  return arr;
}
var parse_default = parse;

// node_modules/uuid/dist/esm-browser/v35.js
function stringToBytes(str) {
  str = unescape(encodeURIComponent(str));
  const bytes = [];
  for (let i = 0; i < str.length; ++i) {
    bytes.push(str.charCodeAt(i));
  }
  return bytes;
}
var DNS = "6ba7b810-9dad-11d1-80b4-00c04fd430c8";
var URL = "6ba7b811-9dad-11d1-80b4-00c04fd430c8";
function v35(name, version, hashfunc) {
  function generateUUID(value, namespace, buf, offset) {
    var _namespace;
    if (typeof value === "string") {
      value = stringToBytes(value);
    }
    if (typeof namespace === "string") {
      namespace = parse_default(namespace);
    }
    if (((_namespace = namespace) === null || _namespace === void 0 ? void 0 : _namespace.length) !== 16) {
      throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");
    }
    let bytes = new Uint8Array(16 + value.length);
    bytes.set(namespace);
    bytes.set(value, namespace.length);
    bytes = hashfunc(bytes);
    bytes[6] = bytes[6] & 15 | version;
    bytes[8] = bytes[8] & 63 | 128;
    if (buf) {
      offset = offset || 0;
      for (let i = 0; i < 16; ++i) {
        buf[offset + i] = bytes[i];
      }
      return buf;
    }
    return unsafeStringify(bytes);
  }
  try {
    generateUUID.name = name;
  } catch (err) {
  }
  generateUUID.DNS = DNS;
  generateUUID.URL = URL;
  return generateUUID;
}

// node_modules/uuid/dist/esm-browser/native.js
var randomUUID = typeof crypto !== "undefined" && crypto.randomUUID && crypto.randomUUID.bind(crypto);
var native_default = {
  randomUUID
};

// node_modules/uuid/dist/esm-browser/v4.js
function v4(options, buf, offset) {
  if (native_default.randomUUID && !buf && !options) {
    return native_default.randomUUID();
  }
  options = options || {};
  const rnds = options.random || (options.rng || rng)();
  rnds[6] = rnds[6] & 15 | 64;
  rnds[8] = rnds[8] & 63 | 128;
  if (buf) {
    offset = offset || 0;
    for (let i = 0; i < 16; ++i) {
      buf[offset + i] = rnds[i];
    }
    return buf;
  }
  return unsafeStringify(rnds);
}
var v4_default = v4;

// node_modules/uuid/dist/esm-browser/sha1.js
function f(s, x, y, z) {
  switch (s) {
    case 0:
      return x & y ^ ~x & z;
    case 1:
      return x ^ y ^ z;
    case 2:
      return x & y ^ x & z ^ y & z;
    case 3:
      return x ^ y ^ z;
  }
}
function ROTL(x, n) {
  return x << n | x >>> 32 - n;
}
function sha1(bytes) {
  const K = [1518500249, 1859775393, 2400959708, 3395469782];
  const H = [1732584193, 4023233417, 2562383102, 271733878, 3285377520];
  if (typeof bytes === "string") {
    const msg = unescape(encodeURIComponent(bytes));
    bytes = [];
    for (let i = 0; i < msg.length; ++i) {
      bytes.push(msg.charCodeAt(i));
    }
  } else if (!Array.isArray(bytes)) {
    bytes = Array.prototype.slice.call(bytes);
  }
  bytes.push(128);
  const l = bytes.length / 4 + 2;
  const N = Math.ceil(l / 16);
  const M = new Array(N);
  for (let i = 0; i < N; ++i) {
    const arr = new Uint32Array(16);
    for (let j = 0; j < 16; ++j) {
      arr[j] = bytes[i * 64 + j * 4] << 24 | bytes[i * 64 + j * 4 + 1] << 16 | bytes[i * 64 + j * 4 + 2] << 8 | bytes[i * 64 + j * 4 + 3];
    }
    M[i] = arr;
  }
  M[N - 1][14] = (bytes.length - 1) * 8 / Math.pow(2, 32);
  M[N - 1][14] = Math.floor(M[N - 1][14]);
  M[N - 1][15] = (bytes.length - 1) * 8 & 4294967295;
  for (let i = 0; i < N; ++i) {
    const W = new Uint32Array(80);
    for (let t = 0; t < 16; ++t) {
      W[t] = M[i][t];
    }
    for (let t = 16; t < 80; ++t) {
      W[t] = ROTL(W[t - 3] ^ W[t - 8] ^ W[t - 14] ^ W[t - 16], 1);
    }
    let a = H[0];
    let b = H[1];
    let c = H[2];
    let d = H[3];
    let e = H[4];
    for (let t = 0; t < 80; ++t) {
      const s = Math.floor(t / 20);
      const T = ROTL(a, 5) + f(s, b, c, d) + e + K[s] + W[t] >>> 0;
      e = d;
      d = c;
      c = ROTL(b, 30) >>> 0;
      b = a;
      a = T;
    }
    H[0] = H[0] + a >>> 0;
    H[1] = H[1] + b >>> 0;
    H[2] = H[2] + c >>> 0;
    H[3] = H[3] + d >>> 0;
    H[4] = H[4] + e >>> 0;
  }
  return [H[0] >> 24 & 255, H[0] >> 16 & 255, H[0] >> 8 & 255, H[0] & 255, H[1] >> 24 & 255, H[1] >> 16 & 255, H[1] >> 8 & 255, H[1] & 255, H[2] >> 24 & 255, H[2] >> 16 & 255, H[2] >> 8 & 255, H[2] & 255, H[3] >> 24 & 255, H[3] >> 16 & 255, H[3] >> 8 & 255, H[3] & 255, H[4] >> 24 & 255, H[4] >> 16 & 255, H[4] >> 8 & 255, H[4] & 255];
}
var sha1_default = sha1;

// node_modules/uuid/dist/esm-browser/v5.js
var v5 = v35("v5", 80, sha1_default);
var v5_default = v5;

// src/utils.ts
var import_obsidian = require("obsidian");
function encodeURIComponentString(str) {
  return encodeURIComponent(str).replace(/[:()]/g, function(c) {
    return "%" + c.charCodeAt(0).toString(16);
  });
}
function decodeURIComponentString(str) {
  return decodeURIComponent(
    str.replace(/%3A/g, ":").replace(/%28/g, "(").replace(/%29/g, ")")
  );
}
function processURI(dataString) {
  let [prefix, text, suffix, file, from, to, portal, toggle] = dataString.split(":");
  prefix = decodeURIComponentString(prefix);
  text = decodeURIComponentString(text);
  suffix = decodeURIComponentString(suffix);
  file = decodeURIComponentString(file);
  from = decodeURIComponentString(from);
  to = decodeURIComponentString(to);
  if (portal)
    portal = decodeURIComponentString(portal);
  toggle = decodeURIComponentString(toggle);
  return [
    prefix,
    text,
    suffix,
    file,
    parseInt(from),
    parseInt(to),
    portal,
    toggle
  ];
}
function getPrefixAndSuffix(document2, from, to) {
  let prefix = document2.slice(from - 25, from).split("\n").slice(-1)[0];
  let suffix = document2.slice(to, to + 25).split("\n")[0];
  return { prefix, suffix };
}
function findTextPositions(text, searchTerm, prefix = "", suffix = "") {
  let rollingIndex = 0;
  const lines = text.split("\n").map((line, i) => {
    let data = { line, index: rollingIndex, length: line.length + 1, i };
    rollingIndex += data.length;
    return data;
  });
  if (text.includes(prefix + searchTerm + suffix)) {
    let matchIndex = text.indexOf(prefix + searchTerm + suffix);
    let startIndex = lines.findIndex((line) => line.index > matchIndex + prefix.length) - 1;
    let endIndex = lines.findIndex(
      (line) => line.index > matchIndex + prefix.length + searchTerm.length
    ) - 1;
    if (startIndex == -2)
      startIndex = lines.length - 1;
    if (endIndex == -2)
      endIndex = lines.length - 1;
    return {
      rangeStart: {
        line: startIndex,
        ch: matchIndex + prefix.length - lines[startIndex].index
      },
      rangeEnd: {
        line: endIndex,
        ch: matchIndex + prefix.length + searchTerm.length - lines[endIndex].index
      },
      lines
    };
  }
  return null;
}

// src/workspace.ts
var import_obsidian2 = require("obsidian");
function collectLeavesByTab(split, result = []) {
  const type = split.type;
  if (!type)
    throw new Error("Split type not found");
  if (type == "tabs" || type == "split") {
    const children = split.children;
    if (!children)
      throw new Error("Split children not found");
    if (children) {
      for (const child of children) {
        let emptyList = [];
        collectLeavesByTab(child, result);
      }
    }
  } else if (type == "leaf") {
    const parentSplitId = split.parent.id;
    if (!parentSplitId)
      throw new Error("Split parent id not found");
    let idx = result.findIndex((tab) => {
      const tabId = tab[0].parent.id;
      return tabId == parentSplitId;
    });
    if (idx == -1) {
      result.push([split]);
    } else {
      result[idx].push(split);
    }
  }
  return result;
}
function collectLeavesByTabHelper() {
  const { workspace } = getThat();
  const currLeaf = workspace.getLeaf();
  const rootSplit = currLeaf.getRoot();
  return collectLeavesByTab(rootSplit);
}
function getCurrentTabIndex(leavesByTab, span) {
  let workspaceTab = span.closest(".workspace-tabs");
  let currTabIdx = leavesByTab.findIndex((tab) => {
    const leafTab = tab[0].view.containerEl.closest(".workspace-tabs");
    return leafTab == workspaceTab;
  });
  return currTabIdx;
}
function getAdjacentTabs(leavesByTab, currTabIdx, file) {
  let rightAdjacentTab = [];
  let leftAdjacentTab = [];
  let adjacentTabs = [];
  if (leavesByTab[currTabIdx + 1]) {
    rightAdjacentTab = leavesByTab[currTabIdx + 1];
    adjacentTabs = [...adjacentTabs, ...rightAdjacentTab];
  }
  if (leavesByTab[currTabIdx - 1]) {
    leftAdjacentTab = leavesByTab[currTabIdx - 1];
    adjacentTabs = [...adjacentTabs, ...leftAdjacentTab];
  }
  let index = adjacentTabs.findIndex(
    (x) => x.getViewState().state.file == file
  );
  return { adjacentTabs, rightAdjacentTab, leftAdjacentTab, index };
}
async function openFileInAdjacentTab(leavesByTab, currTabIdx, file, type) {
  let { adjacentTabs, rightAdjacentTab, leftAdjacentTab } = getAdjacentTabs(
    leavesByTab,
    currTabIdx,
    file
  );
  let allTabNames = leavesByTab.map(
    (tab) => tab.map((x) => x.getViewState().state.file)
  );
  let rightAdjacentTabNames = rightAdjacentTab.map(
    (x) => x.getViewState().state.file
  );
  let leftAdjacentTabNames = leftAdjacentTab.map(
    (x) => x.getViewState().state.file
  );
  const { workspace } = getThat();
  if (allTabNames.filter((v, i) => i != currTabIdx).flat().includes(file) && !rightAdjacentTabNames.includes(file) && !leftAdjacentTabNames.includes(file)) {
    let currentTabNames = [];
    let currentTab = [];
    allTabNames.forEach((tabNames, i) => {
      if (tabNames != rightAdjacentTabNames && tabNames != leftAdjacentTabNames && currTabIdx != i) {
        if (tabNames.includes(file)) {
          currentTabNames = tabNames;
          currentTab = leavesByTab[i];
        }
      }
    });
    const originalLeaf = currentTab.filter(
      (t) => t.containerEl.style.display != "none"
    )[0];
    let leaf = currentTab[currentTabNames.indexOf(file)];
    workspace.revealLeaf(leaf);
    console.log("open file new tab");
    return { newLeaf: leaf, temp: false, originalLeaf };
  } else if (rightAdjacentTabNames.includes(file)) {
    const originalLeaf = rightAdjacentTab.filter(
      (t) => t.containerEl.style.display != "none"
    )[0];
    let leaf = rightAdjacentTab[rightAdjacentTabNames.indexOf(file)];
    workspace.revealLeaf(leaf);
    console.log("open existing file right tab");
    return { newLeaf: leaf, temp: false, originalLeaf };
  } else if (leftAdjacentTabNames.includes(file)) {
    const originalLeaf = leftAdjacentTab.filter(
      (t) => t.containerEl.style.display != "none"
    )[0];
    let leaf = leftAdjacentTab[leftAdjacentTabNames.indexOf(file)];
    workspace.revealLeaf(leaf);
    console.log("open existing file left tab");
    return { newLeaf: leaf, temp: false, originalLeaf };
  } else if (rightAdjacentTab.length > 0) {
    const originalLeaf = rightAdjacentTab.filter(
      (t) => t.containerEl.style.display != "none"
    )[0];
    let currLeaf = workspace.getLeaf();
    workspace.setActiveLeaf(originalLeaf);
    let newLeaf = workspace.getLeaf(true);
    await openFileInLeaf(newLeaf, file);
    workspace.revealLeaf(newLeaf);
    workspace.setActiveLeaf(currLeaf);
    console.log("open new file right tab");
    return { newLeaf, temp: true, originalLeaf };
  } else if (leftAdjacentTab.length > 0) {
    const originalLeaf = leftAdjacentTab.filter(
      (t) => t.containerEl.style.display != "none"
    )[0];
    let currLeaf = workspace.getLeaf();
    workspace.setActiveLeaf(originalLeaf);
    let newLeaf = workspace.getLeaf(true);
    await openFileInLeaf(newLeaf, file);
    workspace.revealLeaf(newLeaf);
    workspace.setActiveLeaf(currLeaf);
    console.log("open new file left tab");
    return { newLeaf, temp: true, originalLeaf };
  } else {
    const currLeaf = workspace.getLeaf();
    let newLeaf = workspace.createLeafBySplit(currLeaf);
    await openFileInLeaf(newLeaf, file);
    console.log("open new file left tab");
    return { newLeaf, temp: true, originalLeaf: currLeaf };
  }
}
async function openFileInLeaf(leaf, file) {
  let targetFile = getThat().vault.getAbstractFileByPath(file);
  if (targetFile && targetFile instanceof import_obsidian2.TFile)
    await leaf.openFile(targetFile, { active: false });
}

// src/effects.ts
var import_obsidian3 = require("obsidian");

// src/mark.ts
var import_view2 = require("@codemirror/view");
var import_state3 = require("@codemirror/state");
var addHighlight = import_state3.StateEffect.define({
  map: ({ from, to }, change) => ({
    from: change.mapPos(from),
    to: change.mapPos(to)
  })
});
var addDefaultHighlight = import_state3.StateEffect.define({
  map: ({ from, to }, change) => ({
    from: change.mapPos(from),
    to: change.mapPos(to)
  })
});
var resetHighlight = import_state3.StateEffect.define({
  map: ({ from, to }, change) => ({
    from: change.mapPos(from),
    to: change.mapPos(to)
  })
});
var highlightField = import_state3.StateField.define({
  create() {
    return import_view2.Decoration.none;
  },
  update(higlights, tr) {
    higlights = higlights.map(tr.changes);
    for (let e of tr.effects)
      if (e.is(addDefaultHighlight)) {
        higlights = higlights.update({
          add: [defaultHighlightMark.range(e.value.from, e.value.to)]
        });
      } else if (e.is(addHighlight)) {
        higlights = higlights.update({
          add: [highlightMark.range(e.value.from, e.value.to)]
        });
      } else if (e.is(resetHighlight)) {
        higlights = higlights.update({
          filter: (from, to) => {
            return !(from === e.value.from && to === e.value.to);
          }
        });
      }
    return higlights;
  },
  provide: (f2) => import_view2.EditorView.decorations.from(f2)
});
var highlightMark = import_view2.Decoration.mark({ class: "highlight" });
var defaultHighlightMark = import_view2.Decoration.mark({ class: "default-highlight" });
var theme = import_view2.EditorView.baseTheme({});
function highlightSelection(view, from, to) {
  let effects = [addHighlight.of({ from, to })];
  if (!effects.length)
    return false;
  if (!view.state.field(highlightField, false))
    effects.push(import_state3.StateEffect.appendConfig.of([highlightField, theme]));
  view.dispatch({ effects });
  return true;
}
function defaultHighlightSelection(view, from, to) {
  let effects = [addDefaultHighlight.of({ from, to })];
  if (!effects.length)
    return false;
  if (!view.state.field(highlightField, false))
    effects.push(import_state3.StateEffect.appendConfig.of([highlightField, theme]));
  view.dispatch({ effects });
  return true;
}
function removeHighlight(view, from, to) {
  let effects = [resetHighlight.of({ from, to })];
  if (!effects.length)
    return false;
  view.dispatch({ effects });
  return true;
}

// src/effects.ts
var import_view3 = require("@codemirror/view");
function getEditorView(leaf) {
  var _a;
  if (!leaf)
    return null;
  const view = leaf.view;
  const editor = (_a = view.sourceMode) == null ? void 0 : _a.cmEditor;
  if (!editor.CodeMirror && editor.cm instanceof import_view3.EditorView) {
    const editorView = editor.cm;
    return editorView;
  }
  return null;
}
function checkSpanElementExists(span, containerEl) {
  const spanElements = containerEl.getElementsByTagName("span");
  for (let i = 0; i < spanElements.length; i++) {
    if (spanElements[i] === span) {
      return true;
    }
  }
  return false;
}
function parseCSSString(css) {
  const cssPropertiesRegex = /([\w-]+)\s*:\s*([^;]+)\s*;?/g;
  let cssPropertiesObject = {};
  let match;
  while ((match = cssPropertiesRegex.exec(css)) !== null) {
    cssPropertiesObject[match[1]] = match[2];
  }
  return cssPropertiesObject;
}
function delay(milliseconds) {
  return new Promise((resolve) => {
    setTimeout(resolve, milliseconds);
  });
}
function tempDirectionIndicator(leaf, text, prefix, suffix, dataString, isSame, user) {
  if (user === ACTION_TYPE.BACKLINK) {
    const editor2 = getMarkdownView(leaf).editor;
    const backlinkContainer2 = getBacklinkContainer(editor2);
    const windowHeight2 = leaf.view.containerEl.querySelector(".cm-scroller").getBoundingClientRect().height;
    const scrollTop2 = leaf.view.containerEl.querySelector(".cm-scroller").scrollTop;
    const scrollBottom2 = scrollTop2 + windowHeight2;
    let container = editor2.containerEl;
    let content = container.querySelector(".cm-content");
    let references = content.querySelectorAll(".reference-data-span");
    let visibleElements2 = [];
    for (let i = 0; i < references.length; i++) {
      let bbox = references[i].getBoundingClientRect();
      if (bbox.top >= scrollTop2 && bbox.bottom <= scrollBottom2) {
        visibleElements2.push(references[i]);
      }
    }
    let dataStrings = visibleElements2.map(
      (el) => el.getAttribute("data")
    );
    let startTop2 = leaf.view.editor.getScrollInfo().top;
    if (!dataStrings.includes(dataString)) {
      let positions2 = findTextPositions(
        leaf.view.data,
        text,
        prefix.slice(0, prefix.length - 1),
        suffix.slice(1, suffix.length)
      );
      if (!positions2)
        throw new Error("Positions not found");
      let rangeStart2 = positions2.rangeStart;
      let rangeEnd2 = positions2.rangeEnd;
      leaf.view.editor.scrollIntoView(
        {
          from: Object.assign(rangeStart2, { ch: 0 }),
          to: Object.assign(rangeEnd2, { ch: 0 })
        },
        true
      );
    }
    setTimeout(() => {
      let endTop = leaf.view.editor.getScrollInfo().top;
      console.log(endTop);
      let container2 = leaf.containerEl.querySelector(".view-content");
      container2.classList.remove("no-shadow");
      container2.classList.remove("new-shadow");
      container2.classList.remove("top-shadow");
      container2.classList.remove("bottom-shadow");
      if (startTop2 === endTop && isSame) {
        container2.classList.add("no-shadow");
      } else if (startTop2 === endTop && !isSame) {
        container2.classList.add("new-shadow");
      } else if (startTop2 < endTop) {
        container2.classList.add("top-shadow");
      } else {
        container2.classList.add("bottom-shadow");
      }
    }, 25);
    return;
  }
  const editor = getMarkdownView(leaf).editor;
  const backlinkContainer = getBacklinkContainer(editor);
  const windowHeight = leaf.view.containerEl.querySelector(".cm-scroller").getBoundingClientRect().height;
  const scrollTop = leaf.view.containerEl.querySelector(".cm-scroller").scrollTop;
  const scrollBottom = scrollTop + windowHeight;
  let visibleElements = [];
  for (let i = 0; i < backlinkContainer.children.length; i++) {
    let style = backlinkContainer.children[i].getAttribute("style");
    if (style == null)
      continue;
    let cssProperties = parseCSSString(style);
    let top = parseFloat(cssProperties["top"].replace("px", ""));
    if (top == null)
      continue;
    if (scrollTop <= top && top <= scrollBottom && backlinkContainer.children[i]) {
      let reference = backlinkContainer.children[i].getAttribute("reference");
      if (reference) {
        visibleElements.push(JSON.parse(reference).dataString);
      }
    }
  }
  console.log(!visibleElements.includes(dataString));
  let startTop = leaf.view.editor.getScrollInfo().top;
  let positions = findTextPositions(
    leaf.view.data,
    text,
    prefix.slice(0, prefix.length - 1),
    suffix.slice(1, suffix.length)
  );
  if (!positions)
    throw new Error("Positions not found");
  let rangeStart = positions.rangeStart;
  let rangeEnd = positions.rangeEnd;
  leaf.view.editor.scrollIntoView(
    {
      from: Object.assign(rangeStart, { ch: 0 }),
      to: Object.assign(rangeEnd, { ch: 0 })
    },
    true
  );
  console.log(startTop);
  setTimeout(() => {
    let endTop = leaf.view.editor.getScrollInfo().top;
    console.log(endTop);
    let container = leaf.containerEl.querySelector(".view-content");
    container.classList.remove("no-shadow");
    container.classList.remove("new-shadow");
    container.classList.remove("top-shadow");
    container.classList.remove("bottom-shadow");
    if (startTop === endTop && isSame) {
      container.classList.add("no-shadow");
    } else if (startTop === endTop && !isSame) {
      container.classList.add("new-shadow");
    } else if (startTop < endTop) {
      container.classList.add("top-shadow");
    } else {
      container.classList.add("bottom-shadow");
    }
  }, 25);
}
function endEffectRemoveHighlights(workspace, leafId, uuid, backlinkUUID) {
  var _a, _b, _c, _d, _e;
  const workspaceContainer = workspace.containerEl;
  const span = workspaceContainer.querySelector("." + uuid);
  (_b = (_a = span == null ? void 0 : span.parentElement) == null ? void 0 : _a.querySelector(".reference-span")) == null ? void 0 : _b.classList.remove("reference-span-selected");
  span == null ? void 0 : span.classList.remove("reference-data-span-selected");
  if (backlinkUUID) {
    const backlinkSpan = workspaceContainer.querySelector("." + backlinkUUID);
    (_d = (_c = backlinkSpan == null ? void 0 : backlinkSpan.parentElement) == null ? void 0 : _c.querySelector(".reference-span")) == null ? void 0 : _d.classList.remove("reference-span-selected");
    backlinkSpan == null ? void 0 : backlinkSpan.classList.remove("reference-data-span-selected");
  }
  let targetLeaf = workspace.getLeafById(leafId);
  if (!targetLeaf) {
    throw new Error("Target leaf not found");
  }
  let container = (_e = getContainerElement(targetLeaf)) == null ? void 0 : _e.querySelector(".view-content");
  if (container) {
    container.classList.remove("no-shadow");
    container.classList.remove("new-shadow");
    container.classList.remove("top-shadow");
    container.classList.remove("bottom-shadow");
  }
}
async function startBacklinkEffect(span) {
  var _a, _b, _c, _d;
  let source = getBacklinkHover();
  let updateState = updateBacklinkHover;
  if (source != null)
    return;
  updateState({
    type: `${ACTION_TYPE.BACKLINK}-start`
  });
  if (!span)
    return;
  let uuid = Array.from(span.classList).filter((el) => el.includes("uuid"))[0];
  (_b = (_a = span.parentElement) == null ? void 0 : _a.querySelector(".reference-span")) == null ? void 0 : _b.classList.add("reference-span-selected");
  span.classList.add("reference-data-span-selected");
  updateState({
    uuid
  });
  const referenceData = span.getAttribute("reference");
  if (!referenceData)
    throw new Error("Reference data not found");
  const backlink = JSON.parse(referenceData);
  const dataString = backlink.dataString;
  let [prefix, text, suffix, file, from, to] = processURI(dataString);
  let leavesByTab = collectLeavesByTabHelper();
  let currTabIdx = getCurrentTabIndex(leavesByTab, span);
  let backlinkLeaf = leavesByTab[currTabIdx].filter((leaf) => {
    let containerEl = getContainerElement(leaf);
    const exists = checkSpanElementExists(span, containerEl);
    return exists;
  })[0];
  let backlinkLeafID = backlinkLeaf.id;
  if (!backlinkLeafID)
    throw new Error("Leaf id not found");
  if (backlinkLeaf && backlinkLeaf.view instanceof import_obsidian3.MarkdownView) {
    const editorView = getEditorView(backlinkLeaf);
    if (!editorView)
      throw new Error("Editor view not found");
    const viewport = backlinkLeaf.view.editor.getScrollInfo();
    removeHighlight(editorView, from, to);
    highlightSelection(editorView, from, to);
    updateState({
      dataString,
      originalTop: editorView.documentTop,
      backlinkLeafId: backlinkLeafID
    });
  }
  let referencingFile = backlink.referencingLocation.filename;
  const { newLeaf, temp, originalLeaf } = await openFileInAdjacentTab(
    leavesByTab,
    currTabIdx,
    referencingFile
  );
  let id = newLeaf.id;
  if (!id)
    throw new Error("Leaf id not found");
  updateState({
    leafId: id,
    temp,
    peek: true
  });
  const originalLeafId = originalLeaf.id;
  const matches = [
    ...backlink.referencingLocation.text.matchAll(REFERENCE_REGEX)
  ];
  if (matches.length == 0)
    throw new Error("Matches not found");
  tempDirectionIndicator(
    newLeaf,
    backlink.referencingLocation.text,
    backlink.referencingLocation.prefix + "-",
    "-" + backlink.referencingLocation.suffix,
    matches[0][1],
    id === originalLeafId,
    ACTION_TYPE.BACKLINK
  );
  const cursorViewport = newLeaf.view.editor.getScrollInfo();
  updateState({
    cursorViewport
  });
  let backlinkSpan = newLeaf.containerEl.querySelector(
    `span[data="${backlink.dataString}"]`
  );
  if (backlinkSpan) {
    let backlinkUUID = Array.from(backlinkSpan.classList).filter(
      (el) => el.includes("uuid")
    )[0];
    (_d = (_c = backlinkSpan.parentElement) == null ? void 0 : _c.querySelector(".reference-span")) == null ? void 0 : _d.classList.add("reference-span-selected");
    backlinkSpan.classList.add("reference-data-span-selected");
    updateState({
      backlinkUUID
    });
  }
  if (originalLeafId) {
    updateState({
      originalLeafId
    });
  }
  return;
}
async function startReferenceEffect(span, type) {
  var _a, _b;
  let source = getHover();
  let updateState = updateHover;
  if (source != null)
    return;
  updateState({
    type: `${type}-start`
  });
  if (!span)
    return;
  let uuid = Array.from(span.classList).filter((el) => el.includes("uuid"))[0];
  (_b = (_a = span.parentElement) == null ? void 0 : _a.querySelector(".reference-span")) == null ? void 0 : _b.classList.add("reference-span-selected");
  span.classList.add("reference-data-span-selected");
  updateState({
    uuid
  });
  const dataString = span.getAttribute("data");
  if (!dataString)
    throw new Error("Data string not found");
  let [prefix, text, suffix, file, from, to] = processURI(dataString);
  let leavesByTab = collectLeavesByTabHelper();
  let currTabIdx = getCurrentTabIndex(leavesByTab, span);
  const { newLeaf, temp, originalLeaf } = await openFileInAdjacentTab(
    leavesByTab,
    currTabIdx,
    file,
    type
  );
  let id = newLeaf.id;
  if (!id)
    throw new Error("Leaf id not found");
  updateState({
    leafId: id,
    temp,
    peek: true
  });
  const originalLeafId = originalLeaf.id;
  if (newLeaf && newLeaf.view instanceof import_obsidian3.MarkdownView) {
    const editorView = getEditorView(newLeaf);
    if (!editorView)
      throw new Error("Editor view not found");
    const viewport = newLeaf.view.editor.getScrollInfo();
    removeHighlight(editorView, from, to);
    highlightSelection(editorView, from, to);
    tempDirectionIndicator(
      newLeaf,
      text,
      prefix,
      suffix,
      dataString,
      id === originalLeafId
    );
    const cursorViewport = newLeaf.view.editor.getScrollInfo();
    updateState({
      dataString,
      originalTop: editorView.documentTop,
      cursorViewport
    });
  }
  if (originalLeafId) {
    updateState({
      originalLeafId
    });
  }
}
async function endReferenceHoverEffect() {
  if (!getHover() || Object.keys(getHover()).length == 0) {
    resetHover();
    return;
  }
  let { dataString, leafId, originalLeafId, temp, cursorViewport, peek, uuid } = getHover();
  resetHover();
  const { workspace } = getThat();
  let targetLeaf = workspace.getLeafById(leafId);
  endEffectRemoveHighlights(workspace, leafId, uuid);
  let editorView = getEditorView(targetLeaf);
  let [prefix, text, suffix, file, from, to] = processURI(dataString);
  removeHighlight(editorView, from, to);
  defaultHighlightSelection(editorView, from, to);
  if (cursorViewport && targetLeaf && targetLeaf.view instanceof import_obsidian3.MarkdownView) {
    const view = targetLeaf.view;
    view.editor.scrollTo(0, cursorViewport.top);
    let containerEl = getContainerElement(targetLeaf);
    if (containerEl != null) {
      setTimeout(() => {
        var _a;
        (_a = containerEl.querySelector(".view-content")) == null ? void 0 : _a.setAttribute("style", "");
      }, 50);
    }
  }
  if (temp && targetLeaf) {
    targetLeaf.detach();
    let originalLeaf = workspace.getLeafById(originalLeafId);
    if (!originalLeaf)
      throw new Error("Original leaf not found");
    workspace.revealLeaf(originalLeaf);
  }
  if (peek) {
    let originalLeaf = workspace.getLeafById(originalLeafId);
    if (!originalLeaf) {
      resetHover();
      throw new Error("Original leaf not found");
    }
    workspace.revealLeaf(originalLeaf);
  }
  resetHover();
}
async function endBacklinkHoverEffect() {
  if (!getBacklinkHover() || Object.keys(getBacklinkHover()).length == 0) {
    resetBacklinkHover();
    return;
  }
  const {
    dataString,
    leafId,
    originalLeafId,
    backlinkLeafId,
    temp,
    cursorViewport,
    peek,
    uuid,
    backlinkUUID
  } = getBacklinkHover();
  resetBacklinkHover();
  const { workspace } = getThat();
  let targetLeaf = workspace.getLeafById(leafId);
  endEffectRemoveHighlights(workspace, leafId, uuid, backlinkUUID);
  if (cursorViewport && targetLeaf && targetLeaf.view instanceof import_obsidian3.MarkdownView) {
    const view = targetLeaf.view;
    view.editor.scrollTo(0, cursorViewport.top);
  }
  let containerEl = getContainerElement(targetLeaf);
  if (containerEl != null) {
    setTimeout(() => {
      var _a;
      (_a = containerEl.querySelector(".view-content")) == null ? void 0 : _a.setAttribute("style", "");
    }, 50);
  }
  let [prefix, text, suffix, file, from, to] = processURI(dataString);
  const originalLeaf = workspace.getLeafById(backlinkLeafId);
  if (!originalLeaf) {
    resetBacklinkHover();
    throw new Error("Original leaf not found");
  }
  let originalEditorView = getEditorView(originalLeaf);
  removeHighlight(originalEditorView, from, to);
  defaultHighlightSelection(originalEditorView, from, to);
  if (temp && targetLeaf) {
    targetLeaf.detach();
  }
  if (peek) {
    let originalLeaf2 = workspace.getLeafById(originalLeafId);
    if (!originalLeaf2) {
      resetBacklinkHover();
      throw new Error("Original leaf not found");
    }
    workspace.revealLeaf(originalLeaf2);
  }
  resetBacklinkHover();
}

// src/references.ts
function generateDefaultHighlights(leaf) {
  const editor = getMarkdownView(leaf).editor;
  const backlinkContainer = getBacklinkContainer(editor);
  let editorView = getCodeMirrorEditorView(editor);
  let backlinks2 = [];
  for (let i = 0; i < backlinkContainer.children.length; i++) {
    backlinks2.push(backlinkContainer.children.item(i));
  }
  for (let backlink of backlinks2) {
    let reference = backlink.getAttribute("reference") ? JSON.parse(backlink.getAttribute("reference")) : null;
    if (reference) {
      let referenceFrom = reference.referencedLocation.from;
      let referenceTo = reference.referencedLocation.to;
      defaultHighlightSelection(editorView, referenceFrom, referenceTo);
    }
  }
}
function createReferenceIcon(portalText = null) {
  const span = document.createElement("span");
  span.style.cursor = "pointer";
  span.classList.add("reference-data-span");
  span.classList.add("uuid-" + v4_default());
  if (portalText == null) {
    return span;
  }
  if (portalText != "inline reference widget |*|") {
    let portal = document.createElement("div");
    portal.classList.add("portal");
    portalText.split(":").forEach((text, index) => {
      if (index === 0 || index === 2)
        portal.innerHTML += decodeURIComponentString(text);
      else if (index === 1) {
        portal.innerHTML += `<span class="text-accent";>${text}</span>`;
      }
    });
    portal.style.userSelect = "none";
    portal.style.pointerEvents = "none";
    span.appendChild(portal);
  }
  return span;
}
function getCodeMirrorEditorView(editor) {
  return editor.cm;
}
function getContainerElement(editorOrLeaf) {
  return editorOrLeaf.containerEl;
}
function getBacklinkID(backlink) {
  const jsonString = JSON.stringify(backlink);
  const id = v5_default(jsonString, "fb813ebb-1b53-4306-aa9c-655627447f0b");
  return `backlink-${id}`;
}
function getBacklinkContainer(editor) {
  const containerEl = getContainerElement(editor);
  const referenceMarkContainerID = "referenceMarkContainer";
  const container = containerEl.querySelector(`#${referenceMarkContainerID}`);
  if (container) {
    return container;
  } else {
    const newContainer = document.createElement("div");
    newContainer.id = referenceMarkContainerID;
    containerEl.querySelector(".cm-scroller").appendChild(newContainer);
    return newContainer;
  }
}
function getLeafBBoxElements(leaf) {
  const title = getContainerElement(leaf).querySelector(".inline-title");
  if (!title) {
    throw new Error("Missing title");
  }
  const titleBbox = title.getBoundingClientRect();
  const line = getContainerElement(leaf).querySelector(".cm-line");
  if (!line) {
    throw new Error("Document has no lines");
  }
  const lineBbox = line.getBoundingClientRect();
  return { titleBbox, lineBbox };
}
function layoutBacklinks(leaf, backlinksToLeaf, showPortals) {
  const editor = getMarkdownView(leaf).editor;
  const backlinkContainer = getBacklinkContainer(editor);
  let backlinks2 = [];
  for (let i = 0; i < backlinkContainer.children.length; i++) {
    backlinks2.push(backlinkContainer.children.item(i));
  }
  let backlinkIds = backlinksToLeaf.map((x) => getBacklinkID(x));
  backlinks2.map((x) => x.id).forEach((id) => {
    if (!backlinkIds.includes(id)) {
      let element = document.getElementById(id);
      if (element)
        element.remove();
    }
  });
  const { titleBbox, lineBbox } = getLeafBBoxElements(leaf);
  let referenceMarkers = backlinksToLeaf.map((backlink) => {
    const { from } = backlink.referencedLocation;
    const bbox = getCodeMirrorEditorView(editor).coordsAtPos(from);
    if (!bbox)
      return;
    let referenceMarker = backlinkContainer.querySelector(
      `#${getBacklinkID(backlink)}`
    );
    if (referenceMarker === null) {
      referenceMarker = createBacklinkMark(backlink);
      backlinkContainer.appendChild(referenceMarker);
    }
    if (bbox) {
      referenceMarker.style.position = "absolute";
      referenceMarker.setAttribute("top", bbox.top.toString());
      referenceMarker.style.top = bbox.top - titleBbox.top + 32 + "px";
      referenceMarker.style.left = lineBbox.width + 40 + "px";
    }
    return referenceMarker;
  });
  let lastYBottom = -Infinity;
  let margin = 4;
  referenceMarkers.sort(
    (a, b) => parseInt(a.getAttribute("top")) - parseInt(b.getAttribute("top"))
  ).forEach((marker) => {
    if (!marker)
      return;
    const portal = marker.querySelector(".portal");
    if (showPortals) {
      if (portal) {
        portal.style.display = "inline";
        marker.classList.add("backlink-span");
      }
    } else {
      if (portal) {
        portal.style.display = "none";
      }
      marker.classList.remove("backlink-span");
    }
    let top = parseInt(marker.getAttribute("top"));
    top = Math.max(top, lastYBottom + margin);
    lastYBottom = top + marker.getBoundingClientRect().height + margin;
    marker.setAttribute("top", top.toString());
    marker.style.top = top - titleBbox.top + 32 + "px";
    marker.style.left = lineBbox.width + 40 + "px";
  });
}
var debounceTimer;
async function updateBacklinkMarkPositions() {
  clearTimeout(debounceTimer);
  debounceTimer = setTimeout(async () => {
    console.log("updatebacklinkmarkpositions");
    const leaves = getThat().workspace.getLeavesOfType(
      "markdown"
    );
    let allBacklinks = getBacklinks();
    leaves.map(async (leaf) => {
      var _a;
      let file = (_a = getMarkdownView(leaf)) == null ? void 0 : _a.file;
      if (file) {
        const backlinksToLeaf = allBacklinks.filter(
          // @ts-ignore
          (b) => b.referencedLocation.filename == file.path
        );
        const showPortals = getContainerElement(leaf).innerWidth > 900;
        layoutBacklinks(leaf, backlinksToLeaf, showPortals);
      }
    });
  }, 100);
}
function createBacklinkMark(backlink) {
  let span = createReferenceIcon(backlink.portalText);
  span.classList.add("backlink-data-span");
  const portal = span.querySelector(".portal");
  span.style.position = "absolute";
  span.id = getBacklinkID(backlink);
  span.setAttribute("reference", JSON.stringify(backlink));
  const resizeObserver = new ResizeObserver((entries) => {
    if (portal && portal.style.display != "none") {
      span.classList.add("backlink-portal-open");
    } else {
      span.classList.remove("backlink-portal-open");
    }
  });
  resizeObserver.observe(span);
  span.addEventListener("click", openBacklinkReference);
  return span;
}
var existingObserver = null;
async function addReferencesToLeaf(leaf) {
  console.log("add references to leaf");
  await updateBacklinkMarkPositions();
  await delay(1e3);
  console.log("initial load");
  generateDefaultHighlights(leaf);
  if (existingObserver) {
    existingObserver.disconnect();
  }
  const newObserver = new ResizeObserver(async () => {
    await updateBacklinkMarkPositions();
    await delay(1e3);
    console.log("resize load");
    generateDefaultHighlights(leaf);
  });
  const markdownView = getMarkdownView(leaf);
  let workspaceTabs = markdownView.containerEl.closest(".workspace-tabs");
  if (!workspaceTabs) {
    throw new Error("Missing workspace tabs");
  }
  newObserver.observe(workspaceTabs);
  existingObserver = newObserver;
  return leaf;
}
function getMarkdownView(leaf) {
  if (!(leaf.view instanceof import_obsidian4.MarkdownView)) {
    throw new Error("Unexpected non-markdown view");
  }
  return leaf.view;
}
function findMatchPositions(line, regex) {
  let match;
  const positions = [];
  while ((match = regex.exec(line)) !== null) {
    positions.push({
      match: match[0],
      start: match.index,
      end: match.index + match[0].length
    });
  }
  return positions;
}
function createBacklinkData(referencingFileData, referencingFile) {
  let backlinks2 = [];
  let matches = [...referencingFileData.matchAll(REFERENCE_REGEX)];
  matches.forEach((match) => {
    if (match[1].split(":").length != 8)
      return;
    let [prefix, text, suffix, filename, from, to, portal, toggle] = processURI(
      match[1]
    );
    const referencedLocation = {
      prefix,
      text,
      suffix,
      filename,
      from,
      to,
      portal,
      toggle
    };
    let index = referencingFileData.indexOf(match[0]);
    const referencingSurroundingStrings = getPrefixAndSuffix(
      referencingFileData,
      index,
      index + match[0].length
    );
    const referencingLocation = {
      prefix: referencingSurroundingStrings.prefix,
      text: referencingFileData.slice(index, index + match[0].length),
      suffix: referencingSurroundingStrings.suffix,
      filename: referencingFile.path,
      from: match.index,
      // TODO do weird string format
      to: match.index + match[0].length,
      // TODO do weird string format
      portal,
      toggle
    };
    if (portal == "portal") {
      const getLineText = (text2, index2) => {
        const startOfLine = text2.lastIndexOf("\n", index2 - 1) + 1;
        const endOfLine = text2.indexOf("\n", index2);
        return text2.slice(
          startOfLine,
          endOfLine !== -1 ? endOfLine : void 0
        );
      };
      let line = getLineText(referencingFileData, index);
      let matchPositions = findMatchPositions(
        line,
        new RegExp(REFERENCE_REGEX)
      );
      let matchIndex = 0;
      for (let i = 0; i < matchPositions.length; i++) {
        if (matchPositions[i].match == match[0]) {
          break;
        } else {
          matchIndex += matchPositions[i].end - matchPositions[i].start - 1;
        }
      }
      let portalText = line.replace(new RegExp(REFERENCE_REGEX, "g"), "\u2197");
      let portalTextSlice = portalText.slice(0, PORTAL_TEXT_SLICE_SIZE);
      let portalTextIndex = line.indexOf(match[0]) - matchIndex;
      portalTextSlice = "\u2197";
      let startPortalText = portalText.substring(
        Math.max(portalTextIndex - 25, 0),
        portalTextIndex
      );
      if (portalText.substring(Math.max(portalTextIndex - 25, 0), portalTextIndex).length > 0 && portalTextIndex - 25 > 0)
        startPortalText = "..." + startPortalText;
      let endPortalText = portalText.substring(
        portalTextIndex + 1,
        Math.max(portalTextIndex + 25, portalText.length)
      );
      if (portalText.substring(
        portalTextIndex + 1,
        Math.max(portalTextIndex + 25, portalText.length)
      ).length > 0 && portalTextIndex + 25 < portalText.length)
        endPortalText = endPortalText + "...";
      backlinks2.push({
        referencedLocation,
        referencingLocation,
        dataString: match[1],
        portalText: encodeURIComponentString(startPortalText) + ":" + portalTextSlice + ":" + encodeURIComponentString(endPortalText)
      });
    } else {
      backlinks2.push({
        referencedLocation,
        referencingLocation,
        dataString: match[1]
      });
    }
  });
  return backlinks2;
}
async function generateBacklinks() {
  console.log("generating references");
  let backlinks2 = [];
  let markdownFiles = await this.app.vault.getMarkdownFiles();
  await Promise.all(
    markdownFiles.map((file) => this.app.vault.read(file))
  ).then((files) => {
    const zippedArray = markdownFiles.map((file, index) => ({
      markdownFile: file,
      fileData: files[index]
    }));
    zippedArray.forEach((file) => {
      let fileBacklinks = createBacklinkData(file.fileData, file.markdownFile);
      updateBacklinks(fileBacklinks);
      backlinks2.push(...fileBacklinks);
    });
  });
  return backlinks2;
}
function updateReferenceColor(span, user) {
  const portal = span.querySelector(".portal");
  if (span && !portal) {
    span.style.backgroundColor = SVG_HOVER_COLOR;
  }
}
async function openBacklinkReference(ev) {
  let hover = getBacklinkHover();
  let leaf = getThat().workspace.getLeafById(hover.leafId);
  let container = leaf.containerEl;
  if (!container)
    throw new Error("Container not found");
  container.querySelector(".view-content").style.boxShadow = "none";
  updateBacklinkHover({
    temp: false,
    cursorViewport: null,
    peek: false
  });
}
async function openReference(ev) {
  let hover = getHover();
  let leaf = getThat().workspace.getLeafById(hover.leafId);
  let container = leaf.containerEl;
  if (!container)
    throw new Error("Container not found");
  container.querySelector(".view-content").style.boxShadow = "none";
  updateHover({
    temp: false,
    cursorViewport: null,
    peek: false
  });
}

// src/widget/referenceWidget.ts
function processLine(line) {
  let lineCopy = line == null ? void 0 : line.cloneNode(true);
  lineCopy == null ? void 0 : lineCopy.querySelectorAll(".reference-span").forEach((span) => {
    span.innerHTML = "\u2197";
  });
  return lineCopy;
}
function getReferencePosition(view, currLine, reference, content) {
  let lines = view.contentDOM.querySelectorAll(".cm-line");
  let activeLineIndex;
  let seenActive = false;
  lines.forEach((line, i) => {
    if (seenActive)
      return;
    if (line == currLine) {
      seenActive = true;
      activeLineIndex = i;
    }
  });
  if (activeLineIndex === void 0)
    return;
  let activeLine = lines[activeLineIndex];
  let activeLineCopy = processLine(activeLine);
  let parts = activeLineCopy.innerText.split("\u2197");
  let lineReferences = activeLine == null ? void 0 : activeLine.querySelectorAll(".reference-data-span");
  let lineReferencesData = Array.from(lineReferences || []).map(
    (span) => "[\u2197](urn:" + span.getAttribute("data") + ")"
  );
  if (!content)
    throw new Error("Reference not found");
  let index = null;
  lineReferencesData.forEach((reference2, i) => {
    if (!index) {
      if (reference2.includes(content)) {
        index = i;
      }
    }
  });
  if (!index && index != 0)
    throw new Error("Reference not found");
  let startText = [
    ...parts.slice(0, index + 1),
    ...lineReferencesData.slice(0, index)
  ].join("");
  startText = startText.replace(/\u{200B}/g, "");
  let prevLineCharCount = Array.from(lines).slice(0, activeLineIndex).reduce((acc, line) => {
    let processedLine = processLine(line);
    let parts2 = processedLine.innerText.split("\u2197");
    let lineReferences2 = line == null ? void 0 : line.querySelectorAll(".reference-data-span");
    let lineReferencesData2 = Array.from(lineReferences2 || []).map(
      (span) => "[\u2197](urn:" + span.getAttribute("data") + ")"
    );
    let allSerializedText = [...parts2, ...lineReferencesData2].join("") + "\n";
    allSerializedText = allSerializedText.replace(/\u{200B}/g, "");
    return allSerializedText.length + acc;
  }, 0);
  let from = prevLineCharCount + startText.length;
  let to = from + reference.length;
  return { from, to };
}
async function serializeReference(content, referenceSpan, view, toggleValue = null) {
  var _a;
  content = typeof content == "string" ? content : content[1];
  const [prefix, text, suffix, file, from, to, portal, toggle] = content.split(":");
  let newToggle = toggleValue ? toggleValue : toggle === "f" ? "t" : "f";
  let reference = `[\u2197](urn:${prefix}:${text}:${suffix}:${file}:${from}:${to}:${portal}:${newToggle})`;
  let currLine = (_a = referenceSpan == null ? void 0 : referenceSpan.parentElement) == null ? void 0 : _a.parentElement;
  const results = getReferencePosition(
    view,
    currLine,
    reference,
    text
  );
  if (results) {
    const transaction = view.state.update({
      changes: { from: results.from, to: results.to, insert: reference }
    });
    view.dispatch(transaction);
    console.log("updatebacklinkpositions");
    await updateBacklinkMarkPositions();
  }
  return;
}
var ReferenceWidget = class extends import_view4.WidgetType {
  constructor(name, view, pos, referenceSpan = null, parentElement = null, serialized = false) {
    super();
    this.name = name;
    this.view = view;
    this.pos = pos;
    this.referenceSpan = referenceSpan;
    this.parentElement = parentElement;
    this.serialized = serialized;
  }
  eq(other) {
    return this.name === other.name;
  }
  getView() {
    return this.view;
  }
  // this runs when re-serialized as well
  destroy() {
    console.log(this.serialized);
    if (this.serialized) {
      this.serialized = false;
      return;
    }
    setTimeout(() => {
      const regex = /\[\]\(urn:([^)]*)\)/g;
      let content = regex.exec(this.name);
      if (!content)
        throw new Error("Invalid reference");
      let reference = content[0];
      let dataString = content[1];
      const [prefix, text, suffix, file, from, to, portal, toggle = "f"] = dataString.split(":");
      let decodedFile = decodeURIComponentString(file);
      let leavesByTab = collectLeavesByTabHelper();
      let leaf = leavesByTab.flat().filter((leaf2) => {
        return leaf2.getViewState().state.file == decodedFile;
      })[0];
      let view = getEditorView(leaf);
      removeHighlight(view, parseInt(from), parseInt(to));
      const editor = getMarkdownView(leaf).editor;
      const backlinkContainer = getBacklinkContainer(editor);
      const backlinks2 = Array.from(
        backlinkContainer.querySelectorAll(".reference-data-span")
      );
      const backlinkData = backlinks2.map((backlink) => {
        let reference2 = backlink.getAttribute("reference");
        if (!reference2)
          return {};
        return JSON.parse(reference2);
      });
      const backlinkIndex = backlinkData.findIndex((backlink) => {
        return backlink.dataString === dataString && backlink.referencedLocation.filename === decodeURIComponentString(file);
      });
      backlinks2[backlinkIndex].remove();
    }, 10);
  }
  toDOM() {
    const regex = /\[\]\(urn:([^)]*)\)/g;
    let content = regex.exec(this.name);
    if (!content)
      throw new Error("Invalid reference");
    const [prefix, text, suffix, file, from, to, portal, toggle = "f"] = content[1].split(":");
    const span = createReferenceIcon(
      portal == "portal" ? "inline reference widget |*|" : null
    );
    if (content)
      span.setAttribute("data", content[1]);
    const containerSpan = document.createElement("span");
    containerSpan.classList.add("reference-container-span");
    const referenceSpan = document.createElement("span");
    referenceSpan.classList.add("reference-span");
    referenceSpan.innerHTML = decodeURIComponentString(text);
    referenceSpan.classList.toggle("reference-span-hidden", toggle === "f");
    containerSpan.appendChild(referenceSpan);
    containerSpan.appendChild(span);
    this.referenceSpan = referenceSpan;
    setTimeout(() => {
      this.parentElement = containerSpan.parentElement;
    }, 20);
    containerSpan.addEventListener("click", async (ev) => {
      var _a;
      if (ev.metaKey || ev.ctrlKey) {
        openReference(ev);
      } else {
        this.serialized = true;
        await serializeReference(content, referenceSpan, this.view);
        referenceSpan.classList.toggle("reference-span-hidden");
        if (content)
          this.name = content[0];
        if (referenceSpan) {
          this.referenceSpan = referenceSpan;
          this.parentElement = (_a = referenceSpan == null ? void 0 : referenceSpan.parentElement) == null ? void 0 : _a.parentElement;
        }
      }
    });
    return containerSpan;
  }
};
var referenceDecoration = (match, view, pos) => {
  let decoration = import_view4.Decoration.replace({
    widget: new ReferenceWidget(match[0], view, pos)
  });
  return decoration;
};
var referenceMatcher = new import_view4.MatchDecorator({
  // regexp: /\[\u2197\]\(urn:[\s\S^\)]*\)/g,
  // regexp: /\[\u2197\]\(urn:([^:]*:){5,6}[^:]*\)/g,
  // regexp: /\[\u2197\]\(urn:([^:]*:){6}[^:)]*\)/g,
  regexp: /\[\u2197\]\(urn:([^:]*:){7}[^:)]*\)/g,
  decoration: (match, view, pos) => {
    return referenceDecoration(match, view, pos);
  }
});
var referenceResources = import_view4.ViewPlugin.fromClass(
  class {
    constructor(view) {
      this.referenceResources = referenceMatcher.createDeco(view);
    }
    update(update) {
      this.referenceResources = referenceMatcher.updateDeco(
        update,
        this.referenceResources
      );
    }
    destroy() {
      this.referenceResources = import_view4.Decoration.none;
    }
  },
  {
    decorations: (instance) => instance.referenceResources,
    provide: (plugin) => import_view4.EditorView.atomicRanges.of((view) => {
      var _a;
      return ((_a = view.plugin(plugin)) == null ? void 0 : _a.referenceResources) || import_view4.Decoration.none;
    })
  }
);

// src/clipboard.ts
var import_obsidian5 = require("obsidian");
async function updateClipboard(toggle = false) {
  const view = this.app.workspace.getActiveViewOfType(import_obsidian5.MarkdownView);
  if (view) {
    let selection = view.editor.getSelection();
    if (view.file) {
      const text = view.data;
      const from = view.editor.posToOffset(view.editor.getCursor("from"));
      const to = view.editor.posToOffset(view.editor.getCursor("to"));
      const { prefix, suffix } = getPrefixAndSuffix(text, from, to);
      let reference = `[\u2197](urn:${encodeURIComponentString(
        prefix
      )}-:${encodeURIComponentString(selection)}:-${encodeURIComponentString(
        suffix
      )}:${encodeURIComponentString(
        view.file.path
      )}:${from}:${to}:${"portal"}:${toggle ? "t" : "f"})`;
      await navigator.clipboard.writeText(reference);
    }
  }
}

// src/main.ts
var import_view5 = require("@codemirror/view");
var lastMouse = null;
async function handleMovementEffects(evt) {
  let span;
  if (evt.target && (evt.target instanceof HTMLSpanElement || evt.target instanceof SVGElement || evt.target instanceof SVGPathElement)) {
    span = evt.target;
    while (!(span instanceof HTMLSpanElement) && span.parentElement != null) {
      span = span.parentElement;
    }
  } else if (lastMouse) {
    const mouseX = lastMouse.clientX;
    const mouseY = lastMouse.clientY;
    span = document.elementFromPoint(mouseX, mouseY);
  }
  if (!evt.metaKey && !evt.ctrlKey) {
    if (getHover() != null) {
      await endReferenceHoverEffect();
    } else if (getBacklinkHover() != null) {
      await endBacklinkHoverEffect();
    }
    return;
  } else {
    if (span && span instanceof HTMLSpanElement && (span == null ? void 0 : span.parentElement) && (span == null ? void 0 : span.parentElement.classList.contains("reference-container-span"))) {
      console.log("start hover reference effect");
      if (!span.getAttribute("data")) {
        span = span.parentElement;
        span = span.querySelector(".reference-data-span");
        if (!span)
          throw new Error("Span element not found");
      }
      updateReferenceColor(span, ACTION_TYPE.MOUSE);
      startReferenceEffect(span, ACTION_TYPE.MOUSE);
    } else if (span && span instanceof HTMLSpanElement && span.getAttribute("reference")) {
      console.log("start hover backlink effect");
      startBacklinkEffect(span);
    } else if (getHover() != null) {
      console.log("end hover reference effect");
      const requiredKeys = [
        "dataString",
        "leafId",
        "originalLeafId",
        "temp",
        "cursorViewport",
        "peek",
        "uuid"
      ];
      const allKeysPresent = () => requiredKeys.every((key) => key in getHover());
      if (!allKeysPresent()) {
        await new Promise((resolve) => setTimeout(resolve, 50));
      }
      await endReferenceHoverEffect();
    } else if (getBacklinkHover() != null) {
      console.log("end hover backlink effect");
      const requiredKeys = [
        "dataString",
        "leafId",
        "originalLeafId",
        "backlinkLeafId",
        "temp",
        "cursorViewport",
        "peek",
        "uuid",
        "backlinkUUID"
      ];
      const allKeysPresent = () => requiredKeys.every((key) => key in getBacklinkHover());
      if (!allKeysPresent()) {
        await new Promise((resolve) => setTimeout(resolve, 50));
      }
      await endBacklinkHoverEffect();
    }
  }
}
var ReferencePlugin = class extends import_obsidian6.Plugin {
  onload() {
    setTimeout(async () => {
      await generateBacklinks();
      const leaves = this.app.workspace.getLeavesOfType("markdown");
      let promises = leaves.map(
        (leaf) => {
          return addReferencesToLeaf(leaf);
        }
      );
      await Promise.all(promises);
      this.registerEvent(
        this.app.workspace.on("active-leaf-change", async (ev) => {
          try {
            const activeView = this.app.workspace.getActiveViewOfType(import_obsidian6.MarkdownView);
            if ((activeView == null ? void 0 : activeView.leaf) != null) {
              await addReferencesToLeaf(activeView.leaf);
            }
          } catch (e) {
            console.log(e);
          }
        })
      );
    }, 4e3);
    updateThat(this);
    this.registerEditorExtension([
      highlights,
      referenceResources,
      import_view5.EditorView.updateListener.of(async function(e) {
        if (Math.abs(e.changes.desc.newLength - e.changes.desc.length) > 1) {
          console.log("NEW PASTE EVENT");
          let inserted = e.changes.inserted;
          let referencedFile = null;
          inserted.forEach((change) => {
            change.text.forEach((text) => {
              const regex = /\[\]\(urn:([^)]*)\)/g;
              let content = regex.exec(text);
              if (content) {
                console.log(content);
                const [prefix, text2, suffix, file, from, to, portal, toggle] = content[1].split(":");
                referencedFile = decodeURIComponentString(file);
              }
            });
          });
          if (!referencedFile)
            return;
          await delay(2e3);
          let markdownFile = getThat().workspace.getActiveFile();
          console.log(markdownFile);
          if (markdownFile instanceof import_obsidian6.TFile) {
            let fileData = await getThat().vault.read(markdownFile);
            let fileBacklinks = createBacklinkData(fileData, markdownFile);
            console.log(fileBacklinks);
            updateBacklinks(fileBacklinks);
          }
        }
      })
    ]);
    let prevX = 0;
    let prevY = 0;
    this.registerDomEvent(document, "mousemove", async (evt) => {
      let difference = Math.abs(prevX - evt.clientX) + Math.abs(prevY - evt.clientY);
      prevX = evt.clientX;
      prevY = evt.clientY;
      lastMouse = evt;
      if (difference > 10) {
        return;
      }
      handleMovementEffects(evt);
    });
    this.registerDomEvent(document, "keyup", async (evt) => {
      if (evt.metaKey || evt.ctrlKey || evt.key === "Backspace")
        return;
      console.log(evt);
      console.log("keyup");
      handleMovementEffects(evt);
    });
    this.registerDomEvent(document, "keydown", async (evt) => {
      var _a, _b;
      if (evt.metaKey || evt.ctrlKey) {
        handleMovementEffects(evt);
      }
      if (evt.key == "v" && (evt.metaKey || evt.ctrlKey)) {
        console.log("hello");
        let currentLeaf = getThat().workspace.getLeaf();
        await addReferencesToLeaf(currentLeaf);
      } else if (evt.key == "\xC7" && (evt.metaKey || evt.ctrlKey) && evt.shiftKey && evt.altKey) {
        updateClipboard(false);
        new import_obsidian6.Notice("Copied reference to clipboard");
      } else if ((evt.key == "c" || evt.key == "C") && (evt.metaKey || evt.ctrlKey) && evt.shiftKey) {
        updateClipboard(true);
        new import_obsidian6.Notice("Copied reference to clipboard");
      } else if ((evt.key == "s" || evt.key == "S") && (evt.metaKey || evt.ctrlKey) && evt.shiftKey) {
        let target = evt.target;
        let children = Array.from(target.children);
        let currentLine = children.filter(
          (child) => child.classList.contains("cm-active")
        )[0];
        const spans = Array.from(
          currentLine.querySelectorAll(".reference-span")
        );
        let hasOneHidden = false;
        spans.forEach((span) => {
          if (span.classList.contains("reference-span-hidden")) {
            hasOneHidden = true;
          }
        });
        if (spans.every(
          (span) => span.classList.contains("reference-span-hidden")
        ) || hasOneHidden) {
          new import_obsidian6.Notice("Toggle annotations on");
          for (const span of spans) {
            let referenceSpan = (_a = span.parentElement) == null ? void 0 : _a.querySelector(
              ".reference-data-span"
            );
            let content = referenceSpan == null ? void 0 : referenceSpan.getAttribute("data");
            const activeView = this.app.workspace.getLeaf();
            const editor = getMarkdownView(activeView).editor;
            const editorView = getCodeMirrorEditorView(editor);
            await serializeReference(content, span, editorView, "f");
            if (!span.classList.contains("reference-span-hidden")) {
              span.classList.add("reference-span-hidden");
            }
            span.classList.remove("reference-span-hidden");
          }
        } else {
          new import_obsidian6.Notice("Toggle annotations off");
          for (const span of spans) {
            let referenceSpan = (_b = span.parentElement) == null ? void 0 : _b.querySelector(
              ".reference-data-span"
            );
            let content = referenceSpan == null ? void 0 : referenceSpan.getAttribute("data");
            const activeView = this.app.workspace.getLeaf();
            const editor = getMarkdownView(activeView).editor;
            const editorView = getCodeMirrorEditorView(editor);
            await serializeReference(content, span, editorView, "t");
            if (span.classList.contains("reference-span-hidden")) {
              span.classList.remove("reference-span-hidden");
            }
            span.classList.add("reference-span-hidden");
          }
        }
      }
    });
  }
  onunload() {
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL3N0YXRlLnRzIiwgInNyYy93aWRnZXQvaGlnaGxpZ2h0V2lkZ2V0LnRzIiwgInNyYy9jb25zdGFudHMudHMiLCAic3JjL3dpZGdldC9yZWZlcmVuY2VXaWRnZXQudHMiLCAic3JjL3JlZmVyZW5jZXMudHMiLCAibm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci9ybmcuanMiLCAibm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci9yZWdleC5qcyIsICJub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS1icm93c2VyL3ZhbGlkYXRlLmpzIiwgIm5vZGVfbW9kdWxlcy91dWlkL2Rpc3QvZXNtLWJyb3dzZXIvc3RyaW5naWZ5LmpzIiwgIm5vZGVfbW9kdWxlcy91dWlkL2Rpc3QvZXNtLWJyb3dzZXIvcGFyc2UuanMiLCAibm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci92MzUuanMiLCAibm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci9uYXRpdmUuanMiLCAibm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci92NC5qcyIsICJub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS1icm93c2VyL3NoYTEuanMiLCAibm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci92NS5qcyIsICJzcmMvdXRpbHMudHMiLCAic3JjL3dvcmtzcGFjZS50cyIsICJzcmMvZWZmZWN0cy50cyIsICJzcmMvbWFyay50cyIsICJzcmMvY2xpcGJvYXJkLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQge1xuXHRQbHVnaW4sXG5cdE1hcmtkb3duVmlldyxcblx0Tm90aWNlLFxuXHRXb3Jrc3BhY2VMZWFmLFxuXHRURmlsZSxcblx0VEFic3RyYWN0RmlsZSxcbn0gZnJvbSBcIm9ic2lkaWFuXCI7XG5cbmltcG9ydCB7XG5cdHVwZGF0ZVRoYXQsXG5cdGdldEhvdmVyLFxuXHRnZXRCYWNrbGlua0hvdmVyLFxuXHRnZXRUaGF0LFxuXHR1cGRhdGVCYWNrbGlua3MsXG59IGZyb20gXCIuL3N0YXRlXCI7XG5pbXBvcnQgeyBoaWdobGlnaHRzLCByZWZlcmVuY2VSZXNvdXJjZXMgfSBmcm9tIFwiLi93aWRnZXRcIjtcbmltcG9ydCB7IHVwZGF0ZUNsaXBib2FyZCB9IGZyb20gXCIuL2NsaXBib2FyZFwiO1xuaW1wb3J0IHtcblx0Z2VuZXJhdGVCYWNrbGlua3MsXG5cdGFkZFJlZmVyZW5jZXNUb0xlYWYsXG5cdGdldE1hcmtkb3duVmlldyxcblx0Z2V0Q29kZU1pcnJvckVkaXRvclZpZXcsXG5cdHVwZGF0ZVJlZmVyZW5jZUNvbG9yLFxuXHRjcmVhdGVCYWNrbGlua01hcmssXG5cdGNyZWF0ZUJhY2tsaW5rRGF0YSxcbn0gZnJvbSBcIi4vcmVmZXJlbmNlc1wiO1xuaW1wb3J0IHtcblx0c3RhcnRSZWZlcmVuY2VFZmZlY3QsXG5cdGVuZFJlZmVyZW5jZUhvdmVyRWZmZWN0LFxuXHRzdGFydEJhY2tsaW5rRWZmZWN0LFxuXHRlbmRCYWNrbGlua0hvdmVyRWZmZWN0LFxuXHRkZWxheSxcbn0gZnJvbSBcIi4vZWZmZWN0c1wiO1xuaW1wb3J0IHsgZGVjb2RlVVJJQ29tcG9uZW50U3RyaW5nIH0gZnJvbSBcIi4vdXRpbHNcIjtcbmltcG9ydCB7IEFDVElPTl9UWVBFIH0gZnJvbSBcIi4vY29uc3RhbnRzXCI7XG5pbXBvcnQgeyBFZGl0b3JWaWV3IH0gZnJvbSBcIkBjb2RlbWlycm9yL3ZpZXdcIjtcbmltcG9ydCB7IHNlcmlhbGl6ZVJlZmVyZW5jZSB9IGZyb20gXCIuL3dpZGdldC9yZWZlcmVuY2VXaWRnZXRcIjtcbmltcG9ydCB7IGNvbGxlY3RMZWF2ZXNCeVRhYkhlbHBlciB9IGZyb20gXCIuL3dvcmtzcGFjZVwiO1xuXG5sZXQgbGFzdE1vdXNlOiBNb3VzZUV2ZW50IHwgbnVsbCA9IG51bGw7XG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlTW92ZW1lbnRFZmZlY3RzKGV2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpIHtcblx0bGV0IHNwYW47XG5cblx0aWYgKFxuXHRcdGV2dC50YXJnZXQgJiZcblx0XHQoZXZ0LnRhcmdldCBpbnN0YW5jZW9mIEhUTUxTcGFuRWxlbWVudCB8fFxuXHRcdFx0ZXZ0LnRhcmdldCBpbnN0YW5jZW9mIFNWR0VsZW1lbnQgfHxcblx0XHRcdGV2dC50YXJnZXQgaW5zdGFuY2VvZiBTVkdQYXRoRWxlbWVudClcblx0KSB7XG5cdFx0Ly8gSWYgZWxlbWVudCBpcyBzdmcsIGZpbmQgdGhlIGNvbnRhaW5pbmcgcGFyZW50IHNwYW5cblx0XHRzcGFuID0gZXZ0LnRhcmdldDtcblx0XHR3aGlsZSAoIShzcGFuIGluc3RhbmNlb2YgSFRNTFNwYW5FbGVtZW50KSAmJiBzcGFuLnBhcmVudEVsZW1lbnQgIT0gbnVsbCkge1xuXHRcdFx0c3BhbiA9IHNwYW4ucGFyZW50RWxlbWVudDtcblx0XHR9XG5cdH0gZWxzZSBpZiAobGFzdE1vdXNlKSB7XG5cdFx0Y29uc3QgbW91c2VYID0gbGFzdE1vdXNlLmNsaWVudFg7XG5cdFx0Y29uc3QgbW91c2VZID0gbGFzdE1vdXNlLmNsaWVudFk7XG5cdFx0c3BhbiA9IGRvY3VtZW50LmVsZW1lbnRGcm9tUG9pbnQobW91c2VYLCBtb3VzZVkpO1xuXHR9XG5cblx0Ly8gaWYga2V5IG5vdCBwcmVzc2VkLCBtb3VzZSBtb3ZlbWVudCBzaG91bGQgZW5kIGhvdmVyIGVmZmVjdCBpbW1lZGlhdGVseVxuXHRpZiAoIWV2dC5tZXRhS2V5ICYmICFldnQuY3RybEtleSkge1xuXHRcdGlmIChnZXRIb3ZlcigpICE9IG51bGwpIHtcblx0XHRcdGF3YWl0IGVuZFJlZmVyZW5jZUhvdmVyRWZmZWN0KCk7XG5cdFx0fSBlbHNlIGlmIChnZXRCYWNrbGlua0hvdmVyKCkgIT0gbnVsbCkge1xuXHRcdFx0YXdhaXQgZW5kQmFja2xpbmtIb3ZlckVmZmVjdCgpO1xuXHRcdH1cblx0XHRyZXR1cm47XG5cdH0gZWxzZSB7XG5cdFx0aWYgKFxuXHRcdFx0c3BhbiAmJlxuXHRcdFx0c3BhbiBpbnN0YW5jZW9mIEhUTUxTcGFuRWxlbWVudCAmJlxuXHRcdFx0c3Bhbj8ucGFyZW50RWxlbWVudCAmJlxuXHRcdFx0c3Bhbj8ucGFyZW50RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoXCJyZWZlcmVuY2UtY29udGFpbmVyLXNwYW5cIilcblx0XHQpIHtcblx0XHRcdGNvbnNvbGUubG9nKFwic3RhcnQgaG92ZXIgcmVmZXJlbmNlIGVmZmVjdFwiKTtcblx0XHRcdC8vIGlmIChnZXRIb3ZlcigpICE9IG51bGwpIHJldHVybjtcblx0XHRcdGlmICghc3Bhbi5nZXRBdHRyaWJ1dGUoXCJkYXRhXCIpKSB7XG5cdFx0XHRcdHNwYW4gPSBzcGFuLnBhcmVudEVsZW1lbnQ7XG5cdFx0XHRcdHNwYW4gPSBzcGFuLnF1ZXJ5U2VsZWN0b3IoXCIucmVmZXJlbmNlLWRhdGEtc3BhblwiKSBhcyBIVE1MU3BhbkVsZW1lbnQ7XG5cdFx0XHRcdGlmICghc3BhbikgdGhyb3cgbmV3IEVycm9yKFwiU3BhbiBlbGVtZW50IG5vdCBmb3VuZFwiKTtcblx0XHRcdH1cblx0XHRcdHVwZGF0ZVJlZmVyZW5jZUNvbG9yKHNwYW4sIEFDVElPTl9UWVBFLk1PVVNFKTtcblx0XHRcdHN0YXJ0UmVmZXJlbmNlRWZmZWN0KHNwYW4sIEFDVElPTl9UWVBFLk1PVVNFKTtcblx0XHR9IGVsc2UgaWYgKFxuXHRcdFx0c3BhbiAmJlxuXHRcdFx0c3BhbiBpbnN0YW5jZW9mIEhUTUxTcGFuRWxlbWVudCAmJlxuXHRcdFx0c3Bhbi5nZXRBdHRyaWJ1dGUoXCJyZWZlcmVuY2VcIilcblx0XHQpIHtcblx0XHRcdGNvbnNvbGUubG9nKFwic3RhcnQgaG92ZXIgYmFja2xpbmsgZWZmZWN0XCIpO1xuXHRcdFx0Ly8gaWYgKGdldEJhY2tsaW5rSG92ZXIoKSAhPSBudWxsKSByZXR1cm47XG5cdFx0XHRzdGFydEJhY2tsaW5rRWZmZWN0KHNwYW4pO1xuXHRcdH0gZWxzZSBpZiAoZ2V0SG92ZXIoKSAhPSBudWxsKSB7XG5cdFx0XHRjb25zb2xlLmxvZyhcImVuZCBob3ZlciByZWZlcmVuY2UgZWZmZWN0XCIpO1xuXHRcdFx0Ly8gRGVmaW5lIHRoZSBrZXlzIHlvdSdyZSB3YWl0aW5nIGZvclxuXHRcdFx0Y29uc3QgcmVxdWlyZWRLZXlzID0gW1xuXHRcdFx0XHRcImRhdGFTdHJpbmdcIixcblx0XHRcdFx0XCJsZWFmSWRcIixcblx0XHRcdFx0XCJvcmlnaW5hbExlYWZJZFwiLFxuXHRcdFx0XHRcInRlbXBcIixcblx0XHRcdFx0XCJjdXJzb3JWaWV3cG9ydFwiLFxuXHRcdFx0XHRcInBlZWtcIixcblx0XHRcdFx0XCJ1dWlkXCIsXG5cdFx0XHRdO1xuXHRcdFx0Ly8gRnVuY3Rpb24gdG8gY2hlY2sgaWYgYWxsIHJlcXVpcmVkIGtleXMgYXJlIHByZXNlbnRcblxuXHRcdFx0Y29uc3QgYWxsS2V5c1ByZXNlbnQgPSAoKSA9PlxuXHRcdFx0XHRyZXF1aXJlZEtleXMuZXZlcnkoKGtleSkgPT4ga2V5IGluIGdldEhvdmVyKCkpO1xuXHRcdFx0Ly8gV2FpdCB1bnRpbCBhbGwga2V5cyBhcmUgcHJlc2VudFxuXHRcdFx0aWYgKCFhbGxLZXlzUHJlc2VudCgpKSB7XG5cdFx0XHRcdGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDUwKSk7XG5cdFx0XHR9XG5cdFx0XHRhd2FpdCBlbmRSZWZlcmVuY2VIb3ZlckVmZmVjdCgpO1xuXHRcdH0gZWxzZSBpZiAoZ2V0QmFja2xpbmtIb3ZlcigpICE9IG51bGwpIHtcblx0XHRcdGNvbnNvbGUubG9nKFwiZW5kIGhvdmVyIGJhY2tsaW5rIGVmZmVjdFwiKTtcblx0XHRcdC8vIERlZmluZSB0aGUga2V5cyB5b3UncmUgd2FpdGluZyBmb3Jcblx0XHRcdGNvbnN0IHJlcXVpcmVkS2V5cyA9IFtcblx0XHRcdFx0XCJkYXRhU3RyaW5nXCIsXG5cdFx0XHRcdFwibGVhZklkXCIsXG5cdFx0XHRcdFwib3JpZ2luYWxMZWFmSWRcIixcblx0XHRcdFx0XCJiYWNrbGlua0xlYWZJZFwiLFxuXHRcdFx0XHRcInRlbXBcIixcblx0XHRcdFx0XCJjdXJzb3JWaWV3cG9ydFwiLFxuXHRcdFx0XHRcInBlZWtcIixcblx0XHRcdFx0XCJ1dWlkXCIsXG5cdFx0XHRcdFwiYmFja2xpbmtVVUlEXCIsXG5cdFx0XHRdO1xuXHRcdFx0Ly8gRnVuY3Rpb24gdG8gY2hlY2sgaWYgYWxsIHJlcXVpcmVkIGtleXMgYXJlIHByZXNlbnRcblx0XHRcdGNvbnN0IGFsbEtleXNQcmVzZW50ID0gKCkgPT5cblx0XHRcdFx0cmVxdWlyZWRLZXlzLmV2ZXJ5KChrZXkpID0+IGtleSBpbiBnZXRCYWNrbGlua0hvdmVyKCkpO1xuXHRcdFx0Ly8gV2FpdCB1bnRpbCBhbGwga2V5cyBhcmUgcHJlc2VudFxuXHRcdFx0aWYgKCFhbGxLZXlzUHJlc2VudCgpKSB7XG5cdFx0XHRcdGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDUwKSk7XG5cdFx0XHR9XG5cdFx0XHRhd2FpdCBlbmRCYWNrbGlua0hvdmVyRWZmZWN0KCk7XG5cdFx0fVxuXHR9XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFJlZmVyZW5jZVBsdWdpbiBleHRlbmRzIFBsdWdpbiB7XG5cdG9ubG9hZCgpIHtcblx0XHQvL1xuXHRcdHNldFRpbWVvdXQoYXN5bmMgKCkgPT4ge1xuXHRcdFx0YXdhaXQgZ2VuZXJhdGVCYWNrbGlua3MoKTtcblx0XHRcdGNvbnN0IGxlYXZlcyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoXCJtYXJrZG93blwiKTtcblxuXHRcdFx0bGV0IHByb21pc2VzOiBQcm9taXNlPFdvcmtzcGFjZUxlYWY+W10gPSBsZWF2ZXMubWFwKFxuXHRcdFx0XHQobGVhZjogV29ya3NwYWNlTGVhZikgPT4ge1xuXHRcdFx0XHRcdHJldHVybiBhZGRSZWZlcmVuY2VzVG9MZWFmKGxlYWYpO1xuXHRcdFx0XHR9XG5cdFx0XHQpO1xuXG5cdFx0XHRhd2FpdCBQcm9taXNlLmFsbChwcm9taXNlcyk7XG5cblx0XHRcdHRoaXMucmVnaXN0ZXJFdmVudChcblx0XHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLm9uKFwiYWN0aXZlLWxlYWYtY2hhbmdlXCIsIGFzeW5jIChldikgPT4ge1xuXHRcdFx0XHRcdC8vIFRoaXMgc2hvdWxkIGNyZWF0ZSByZWZlcmVuY2VNYXJrZXJzIGlmIHRoZXkgZG9uJ3QgZXhpc3QgYW5kIHVwZGF0ZVxuXHRcdFx0XHRcdC8vIGVsc2UgdXBkYXRlIG9ubHlcblx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0Y29uc3QgYWN0aXZlVmlldyA9XG5cdFx0XHRcdFx0XHRcdHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG5cdFx0XHRcdFx0XHRpZiAoYWN0aXZlVmlldz8ubGVhZiAhPSBudWxsKSB7XG5cdFx0XHRcdFx0XHRcdGF3YWl0IGFkZFJlZmVyZW5jZXNUb0xlYWYoYWN0aXZlVmlldy5sZWFmKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZyhlKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pXG5cdFx0XHQpO1xuXHRcdH0sIDQwMDApO1xuXG5cdFx0dXBkYXRlVGhhdCh0aGlzKTtcblxuXHRcdHRoaXMucmVnaXN0ZXJFZGl0b3JFeHRlbnNpb24oW1xuXHRcdFx0aGlnaGxpZ2h0cyxcblx0XHRcdHJlZmVyZW5jZVJlc291cmNlcyxcblx0XHRcdEVkaXRvclZpZXcudXBkYXRlTGlzdGVuZXIub2YoYXN5bmMgZnVuY3Rpb24gKGUpIHtcblx0XHRcdFx0Ly8gdGhpcyByZWNvZ25pemVzIHdoZW4gYSBwYXN0ZSBldmVudCBvZiBtb3JlIHRoYW4gYSBjaGFyYWN0ZXIgaGFzIG9jY3VyZWRcblx0XHRcdFx0Ly8gaWYgdGhpcyBpcyBhIG5ldyByZWZlcmVuY2UsIHdhbnQgdG8gdXBkYXRlIHRoZSByZWZlcmVuY2VkIHBhZ2UgdG8gcmVmbGVjdCB0aGlzXG5cdFx0XHRcdGlmIChNYXRoLmFicyhlLmNoYW5nZXMuZGVzYy5uZXdMZW5ndGggLSBlLmNoYW5nZXMuZGVzYy5sZW5ndGgpID4gMSkge1xuXHRcdFx0XHRcdGNvbnNvbGUubG9nKFwiTkVXIFBBU1RFIEVWRU5UXCIpO1xuXG5cdFx0XHRcdFx0Ly8gQHRzLWlnbm9yZSAtIHRoaXMgaXMgYSBwcml2YXRlIGF0dHJpYnV0ZVxuXHRcdFx0XHRcdGxldCBpbnNlcnRlZCA9IGUuY2hhbmdlcy5pbnNlcnRlZDtcblxuXHRcdFx0XHRcdGxldCByZWZlcmVuY2VkRmlsZTogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG5cblx0XHRcdFx0XHRpbnNlcnRlZC5mb3JFYWNoKChjaGFuZ2U6IHsgbGVuZ3RoOiBudW1iZXI7IHRleHQ6IHN0cmluZ1tdIH0pID0+IHtcblx0XHRcdFx0XHRcdGNoYW5nZS50ZXh0LmZvckVhY2goKHRleHQpID0+IHtcblx0XHRcdFx0XHRcdFx0Y29uc3QgcmVnZXggPSAvXFxbXHUyMTk3XFxdXFwodXJuOihbXildKilcXCkvZztcblx0XHRcdFx0XHRcdFx0bGV0IGNvbnRlbnQgPSByZWdleC5leGVjKHRleHQpO1xuXHRcdFx0XHRcdFx0XHRpZiAoY29udGVudCkge1xuXHRcdFx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKGNvbnRlbnQpO1xuXHRcdFx0XHRcdFx0XHRcdGNvbnN0IFtwcmVmaXgsIHRleHQsIHN1ZmZpeCwgZmlsZSwgZnJvbSwgdG8sIHBvcnRhbCwgdG9nZ2xlXSA9XG5cdFx0XHRcdFx0XHRcdFx0XHRjb250ZW50WzFdLnNwbGl0KFwiOlwiKTtcblx0XHRcdFx0XHRcdFx0XHRyZWZlcmVuY2VkRmlsZSA9IGRlY29kZVVSSUNvbXBvbmVudFN0cmluZyhmaWxlKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0aWYgKCFyZWZlcmVuY2VkRmlsZSkgcmV0dXJuO1xuXHRcdFx0XHRcdC8qXG50IHtwYXJlbnQ6IHQsIGRlbGV0ZWQ6IGZhbHNlLCB2YXVsdDogdCwgcGF0aDogJ1Byb3RvdHlwaW5nLm1kJywgbmFtZTogJ1Byb3RvdHlwaW5nLm1kJywgXHUyMDI2fVxuYmFzZW5hbWVcbjogXG5cIlByb3RvdHlwaW5nXCJcbmRlbGV0ZWRcbjogXG5mYWxzZVxuZXh0ZW5zaW9uXG46IFxuXCJtZFwiXG5uYW1lXG46IFxuXCJQcm90b3R5cGluZy5tZFwiXG5wYXJlbnRcbjogXG50IHtwYXJlbnQ6IG51bGwsIGRlbGV0ZWQ6IGZhbHNlLCB2YXVsdDogdCwgcGF0aDogJy8nLCBuYW1lOiAnJywgXHUyMDI2fVxucGF0aFxuOiBcblwiUHJvdG90eXBpbmcubWRcIlxuc2F2aW5nXG46IFxuZmFsc2VcbnN0YXRcbjogXG57Y3RpbWU6IDE3MDAwNDY4NTEwMDEsIG10aW1lOiAxNzAyNjg1NTM0MjMyLCBzaXplOiA3Nzd9XG52YXVsdFxuOiBcbnQge186IHtcdTIwMjZ9LCBmaWxlTWFwOiB7XHUyMDI2fSwgY29uZmlnOiB7XHUyMDI2fSwgY29uZmlnVHM6IDE3MDYxNzQ2MTUyNDQsIGNvbmZpZ0RpcjogJy5vYnNpZGlhbicsIFx1MjAyNn1cbltbUHJvdG90eXBlXV1cbjogXG5lXG4qL1xuXHRcdFx0XHRcdC8vIGxldCBsZWFmOiBXb3Jrc3BhY2VMZWFmID0gZ2V0VGhhdCgpLndvcmtzcGFjZS5nZXRMZWFmKCk7XG5cblx0XHRcdFx0XHQvLyBjb25zb2xlLmxvZyhsZWFmKTtcblxuXHRcdFx0XHRcdC8vIGxldCBtYXJrZG93bkZpbGU6IFRBYnN0cmFjdEZpbGUgfCBURmlsZSB8IG51bGwgPVxuXHRcdFx0XHRcdC8vIFx0Z2V0VGhhdCgpLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChyZWZlcmVuY2VkRmlsZSk7XG5cblx0XHRcdFx0XHRhd2FpdCBkZWxheSgyMDAwKTtcblx0XHRcdFx0XHRsZXQgbWFya2Rvd25GaWxlOiBURmlsZSB8IG51bGwgPSBnZXRUaGF0KCkud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcblx0XHRcdFx0XHRjb25zb2xlLmxvZyhtYXJrZG93bkZpbGUpO1xuXHRcdFx0XHRcdC8vIGlmICghKG1hcmtkb3duRmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkgcmV0dXJuO1xuXHRcdFx0XHRcdGlmIChtYXJrZG93bkZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xuXHRcdFx0XHRcdFx0bGV0IGZpbGVEYXRhID0gYXdhaXQgZ2V0VGhhdCgpLnZhdWx0LnJlYWQobWFya2Rvd25GaWxlKTtcblxuXHRcdFx0XHRcdFx0bGV0IGZpbGVCYWNrbGlua3MgPSBjcmVhdGVCYWNrbGlua0RhdGEoZmlsZURhdGEsIG1hcmtkb3duRmlsZSk7XG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZyhmaWxlQmFja2xpbmtzKTtcblx0XHRcdFx0XHRcdHVwZGF0ZUJhY2tsaW5rcyhmaWxlQmFja2xpbmtzKTtcblxuXHRcdFx0XHRcdFx0Ly8gc2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdFx0XHQvLyBcdGxldCBsZWF2ZXNCeVRhYiA9IGNvbGxlY3RMZWF2ZXNCeVRhYkhlbHBlcigpO1xuXHRcdFx0XHRcdFx0Ly8gXHRsZXQgbGVhZiA9IGxlYXZlc0J5VGFiLmZsYXQoKS5maWx0ZXIoKGxlYWYpID0+IHtcblx0XHRcdFx0XHRcdC8vIFx0XHRyZXR1cm4gbGVhZi5nZXRWaWV3U3RhdGUoKS5zdGF0ZS5maWxlID09IHJlZmVyZW5jZWRGaWxlO1xuXHRcdFx0XHRcdFx0Ly8gXHR9KVswXTtcblx0XHRcdFx0XHRcdC8vIFx0aWYgKGxlYWYpIHtcblx0XHRcdFx0XHRcdC8vIFx0XHRhZGRSZWZlcmVuY2VzVG9MZWFmKGxlYWYpO1xuXHRcdFx0XHRcdFx0Ly8gXHR9XG5cdFx0XHRcdFx0XHQvLyB9LCAyMDAwKTsgLy8vIHRoaXMgdGltZW91dCBpcyB0byBtYWtlIHN1cmUgdGhlIGNoYW5nZXMgaGF2ZSBmaW5pc2hlZCB3cml0aW5nIHRvIGZpbGUuXG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9KSxcblx0XHRdKTtcblxuXHRcdGxldCBwcmV2WCA9IDA7XG5cdFx0bGV0IHByZXZZID0gMDtcblxuXHRcdHRoaXMucmVnaXN0ZXJEb21FdmVudChkb2N1bWVudCwgXCJtb3VzZW1vdmVcIiwgYXN5bmMgKGV2dCkgPT4ge1xuXHRcdFx0bGV0IGRpZmZlcmVuY2UgPVxuXHRcdFx0XHRNYXRoLmFicyhwcmV2WCAtIGV2dC5jbGllbnRYKSArIE1hdGguYWJzKHByZXZZIC0gZXZ0LmNsaWVudFkpO1xuXHRcdFx0cHJldlggPSBldnQuY2xpZW50WDtcblx0XHRcdHByZXZZID0gZXZ0LmNsaWVudFk7XG5cdFx0XHRsYXN0TW91c2UgPSBldnQ7XG5cdFx0XHRpZiAoZGlmZmVyZW5jZSA+IDEwKSB7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHRcdGhhbmRsZU1vdmVtZW50RWZmZWN0cyhldnQpO1xuXHRcdH0pO1xuXG5cdFx0Ly8gLy8gb24gc2VsZWN0aW9uIGNoYW5nZXMsIGV2ZW50IG92ZXIgY2xpY2sgYW5kIGtleWRvd25cblx0XHQvLyB0aGlzLnJlZ2lzdGVyRG9tRXZlbnQoZG9jdW1lbnQsIFwiY2xpY2tcIiwgYXN5bmMgKGV2dCkgPT4ge1xuXHRcdC8vIFx0Y29uc29sZS5sb2coXCJjbGlja1wiKTtcblx0XHQvLyBcdGhhbmRsZU1vdmVtZW50RWZmZWN0cyhldnQpO1xuXHRcdC8vIFx0Ly8gYXdhaXQgY2hlY2tGb2N1c0N1cnNvcihldnQpO1xuXHRcdC8vIFx0dXBkYXRlQmFja2xpbmtNYXJrUG9zaXRpb25zKCk7XG5cdFx0Ly8gfSk7XG5cblx0XHR0aGlzLnJlZ2lzdGVyRG9tRXZlbnQoZG9jdW1lbnQsIFwia2V5dXBcIiwgYXN5bmMgKGV2dCkgPT4ge1xuXHRcdFx0aWYgKGV2dC5tZXRhS2V5IHx8IGV2dC5jdHJsS2V5IHx8IGV2dC5rZXkgPT09IFwiQmFja3NwYWNlXCIpIHJldHVybjtcblx0XHRcdGNvbnNvbGUubG9nKGV2dCk7XG5cdFx0XHRjb25zb2xlLmxvZyhcImtleXVwXCIpO1xuXHRcdFx0aGFuZGxlTW92ZW1lbnRFZmZlY3RzKGV2dCk7XG5cdFx0XHQvLyBhd2FpdCBjaGVja0ZvY3VzQ3Vyc29yKGV2dCk7XG5cdFx0XHQvLyB1cGRhdGVCYWNrbGlua01hcmtQb3NpdGlvbnMoKTtcblx0XHR9KTtcblxuXHRcdHRoaXMucmVnaXN0ZXJEb21FdmVudChkb2N1bWVudCwgXCJrZXlkb3duXCIsIGFzeW5jIChldnQpID0+IHtcblx0XHRcdGlmIChldnQubWV0YUtleSB8fCBldnQuY3RybEtleSkge1xuXHRcdFx0XHQvLyBDaGFuZ2UgdGhlIGN1cnNvciBzdHlsZSBvZiB0aGUgYm9keVxuXHRcdFx0XHRoYW5kbGVNb3ZlbWVudEVmZmVjdHMoZXZ0KTtcblx0XHRcdH1cblx0XHRcdC8vIENvcHkgd2l0aCB0b2dnbGUgb2ZmXG5cdFx0XHRpZiAoZXZ0LmtleSA9PSBcInZcIiAmJiAoZXZ0Lm1ldGFLZXkgfHwgZXZ0LmN0cmxLZXkpKSB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKFwiaGVsbG9cIik7XG5cdFx0XHRcdGxldCBjdXJyZW50TGVhZiA9IGdldFRoYXQoKS53b3Jrc3BhY2UuZ2V0TGVhZigpO1xuXHRcdFx0XHRhd2FpdCBhZGRSZWZlcmVuY2VzVG9MZWFmKGN1cnJlbnRMZWFmKTtcblx0XHRcdH0gZWxzZSBpZiAoXG5cdFx0XHRcdGV2dC5rZXkgPT0gXCJcdTAwQzdcIiAmJlxuXHRcdFx0XHQoZXZ0Lm1ldGFLZXkgfHwgZXZ0LmN0cmxLZXkpICYmXG5cdFx0XHRcdGV2dC5zaGlmdEtleSAmJlxuXHRcdFx0XHRldnQuYWx0S2V5XG5cdFx0XHQpIHtcblx0XHRcdFx0dXBkYXRlQ2xpcGJvYXJkKGZhbHNlKTtcblx0XHRcdFx0bmV3IE5vdGljZShcIkNvcGllZCByZWZlcmVuY2UgdG8gY2xpcGJvYXJkXCIpO1xuXHRcdFx0fSBlbHNlIGlmIChcblx0XHRcdFx0KGV2dC5rZXkgPT0gXCJjXCIgfHwgZXZ0LmtleSA9PSBcIkNcIikgJiZcblx0XHRcdFx0KGV2dC5tZXRhS2V5IHx8IGV2dC5jdHJsS2V5KSAmJlxuXHRcdFx0XHRldnQuc2hpZnRLZXlcblx0XHRcdCkge1xuXHRcdFx0XHQvLyBDb3B5IHdpdGggdG9nZ2xlIG9uXG5cdFx0XHRcdHVwZGF0ZUNsaXBib2FyZCh0cnVlKTtcblx0XHRcdFx0bmV3IE5vdGljZShcIkNvcGllZCByZWZlcmVuY2UgdG8gY2xpcGJvYXJkXCIpO1xuXHRcdFx0fSBlbHNlIGlmIChcblx0XHRcdFx0KGV2dC5rZXkgPT0gXCJzXCIgfHwgZXZ0LmtleSA9PSBcIlNcIikgJiZcblx0XHRcdFx0KGV2dC5tZXRhS2V5IHx8IGV2dC5jdHJsS2V5KSAmJlxuXHRcdFx0XHRldnQuc2hpZnRLZXlcblx0XHRcdCkge1xuXHRcdFx0XHQvLyBDb3B5IHdpdGggUyBvblxuXHRcdFx0XHRsZXQgdGFyZ2V0ID0gZXZ0LnRhcmdldCBhcyBIVE1MRWxlbWVudDtcblx0XHRcdFx0bGV0IGNoaWxkcmVuID0gQXJyYXkuZnJvbSh0YXJnZXQuY2hpbGRyZW4pO1xuXHRcdFx0XHRsZXQgY3VycmVudExpbmUgPSBjaGlsZHJlbi5maWx0ZXIoKGNoaWxkKSA9PlxuXHRcdFx0XHRcdGNoaWxkLmNsYXNzTGlzdC5jb250YWlucyhcImNtLWFjdGl2ZVwiKVxuXHRcdFx0XHQpWzBdO1xuXG5cdFx0XHRcdGNvbnN0IHNwYW5zID0gQXJyYXkuZnJvbTxIVE1MU3BhbkVsZW1lbnQ+KFxuXHRcdFx0XHRcdGN1cnJlbnRMaW5lLnF1ZXJ5U2VsZWN0b3JBbGwoXCIucmVmZXJlbmNlLXNwYW5cIilcblx0XHRcdFx0KTtcblxuXHRcdFx0XHRsZXQgaGFzT25lSGlkZGVuID0gZmFsc2U7XG5cdFx0XHRcdHNwYW5zLmZvckVhY2goKHNwYW4pID0+IHtcblx0XHRcdFx0XHRpZiAoc3Bhbi5jbGFzc0xpc3QuY29udGFpbnMoXCJyZWZlcmVuY2Utc3Bhbi1oaWRkZW5cIikpIHtcblx0XHRcdFx0XHRcdGhhc09uZUhpZGRlbiA9IHRydWU7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHRpZiAoXG5cdFx0XHRcdFx0c3BhbnMuZXZlcnkoKHNwYW4pID0+XG5cdFx0XHRcdFx0XHRzcGFuLmNsYXNzTGlzdC5jb250YWlucyhcInJlZmVyZW5jZS1zcGFuLWhpZGRlblwiKVxuXHRcdFx0XHRcdCkgfHxcblx0XHRcdFx0XHRoYXNPbmVIaWRkZW5cblx0XHRcdFx0KSB7XG5cdFx0XHRcdFx0bmV3IE5vdGljZShcIlRvZ2dsZSBhbm5vdGF0aW9ucyBvblwiKTtcblxuXHRcdFx0XHRcdGZvciAoY29uc3Qgc3BhbiBvZiBzcGFucykge1xuXHRcdFx0XHRcdFx0Ly8gV2FudCB0byBzZXJpYWxpemUgcmVmZXJlbmNlcyBhdCBzb21lIHBvaW50XG5cdFx0XHRcdFx0XHRsZXQgcmVmZXJlbmNlU3BhbiA9IHNwYW4ucGFyZW50RWxlbWVudD8ucXVlcnlTZWxlY3Rvcihcblx0XHRcdFx0XHRcdFx0XCIucmVmZXJlbmNlLWRhdGEtc3BhblwiXG5cdFx0XHRcdFx0XHQpO1xuXHRcdFx0XHRcdFx0bGV0IGNvbnRlbnQgPSByZWZlcmVuY2VTcGFuPy5nZXRBdHRyaWJ1dGUoXCJkYXRhXCIpO1xuXHRcdFx0XHRcdFx0Y29uc3QgYWN0aXZlVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWFmKCk7XG5cdFx0XHRcdFx0XHRjb25zdCBlZGl0b3IgPSBnZXRNYXJrZG93blZpZXcoYWN0aXZlVmlldykuZWRpdG9yO1xuXHRcdFx0XHRcdFx0Y29uc3QgZWRpdG9yVmlldyA9IGdldENvZGVNaXJyb3JFZGl0b3JWaWV3KGVkaXRvcik7XG5cblx0XHRcdFx0XHRcdGF3YWl0IHNlcmlhbGl6ZVJlZmVyZW5jZShjb250ZW50LCBzcGFuLCBlZGl0b3JWaWV3LCBcImZcIik7XG5cblx0XHRcdFx0XHRcdGlmICghc3Bhbi5jbGFzc0xpc3QuY29udGFpbnMoXCJyZWZlcmVuY2Utc3Bhbi1oaWRkZW5cIikpIHtcblx0XHRcdFx0XHRcdFx0c3Bhbi5jbGFzc0xpc3QuYWRkKFwicmVmZXJlbmNlLXNwYW4taGlkZGVuXCIpO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRzcGFuLmNsYXNzTGlzdC5yZW1vdmUoXCJyZWZlcmVuY2Utc3Bhbi1oaWRkZW5cIik7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdG5ldyBOb3RpY2UoXCJUb2dnbGUgYW5ub3RhdGlvbnMgb2ZmXCIpO1xuXG5cdFx0XHRcdFx0Zm9yIChjb25zdCBzcGFuIG9mIHNwYW5zKSB7XG5cdFx0XHRcdFx0XHRsZXQgcmVmZXJlbmNlU3BhbiA9IHNwYW4ucGFyZW50RWxlbWVudD8ucXVlcnlTZWxlY3Rvcihcblx0XHRcdFx0XHRcdFx0XCIucmVmZXJlbmNlLWRhdGEtc3BhblwiXG5cdFx0XHRcdFx0XHQpO1xuXG5cdFx0XHRcdFx0XHRsZXQgY29udGVudCA9IHJlZmVyZW5jZVNwYW4/LmdldEF0dHJpYnV0ZShcImRhdGFcIik7XG5cdFx0XHRcdFx0XHRjb25zdCBhY3RpdmVWaWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYWYoKTtcblx0XHRcdFx0XHRcdGNvbnN0IGVkaXRvciA9IGdldE1hcmtkb3duVmlldyhhY3RpdmVWaWV3KS5lZGl0b3I7XG5cdFx0XHRcdFx0XHRjb25zdCBlZGl0b3JWaWV3ID0gZ2V0Q29kZU1pcnJvckVkaXRvclZpZXcoZWRpdG9yKTtcblxuXHRcdFx0XHRcdFx0YXdhaXQgc2VyaWFsaXplUmVmZXJlbmNlKGNvbnRlbnQsIHNwYW4sIGVkaXRvclZpZXcsIFwidFwiKTtcblxuXHRcdFx0XHRcdFx0Ly8gUmVtb3ZlIHRoZSBjbGFzcyBpZiBpdCBleGlzdHNcblx0XHRcdFx0XHRcdGlmIChzcGFuLmNsYXNzTGlzdC5jb250YWlucyhcInJlZmVyZW5jZS1zcGFuLWhpZGRlblwiKSkge1xuXHRcdFx0XHRcdFx0XHRzcGFuLmNsYXNzTGlzdC5yZW1vdmUoXCJyZWZlcmVuY2Utc3Bhbi1oaWRkZW5cIik7XG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdC8vIEFkZCB0aGUgY2xhc3Ncblx0XHRcdFx0XHRcdHNwYW4uY2xhc3NMaXN0LmFkZChcInJlZmVyZW5jZS1zcGFuLWhpZGRlblwiKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdG9udW5sb2FkKCkge31cbn1cbiIsICJpbXBvcnQge1xuXHRFZGl0b3JTdGF0ZSxcblx0U3RhdGVGaWVsZCxcblx0QW5ub3RhdGlvbixcblx0U3RhdGVFZmZlY3QsXG59IGZyb20gXCJAY29kZW1pcnJvci9zdGF0ZVwiO1xuaW1wb3J0IHsgQmFja2xpbmsgfSBmcm9tIFwiLi90eXBlc1wiO1xuaW1wb3J0IHsgQXBwIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5cbmV4cG9ydCBsZXQgdGhhdCA9IFN0YXRlRmllbGQuZGVmaW5lPEFwcCB8IG51bGw+KHtcblx0Y3JlYXRlKCkge1xuXHRcdHJldHVybiBudWxsO1xuXHR9LFxuXHR1cGRhdGUodmFsdWUsIHRyOiBhbnkpIHtcblx0XHRpZiAoXG5cdFx0XHR0cltcImFubm90YXRpb25zXCJdLmxlbmd0aCA9PSAyICYmXG5cdFx0XHR0cltcImFubm90YXRpb25zXCJdWzBdLnZhbHVlLnR5cGUgPT0gXCJ0aGF0XCJcblx0XHQpIHtcblx0XHRcdHJldHVybiB0cltcImFubm90YXRpb25zXCJdWzBdLnZhbHVlLnRoYXQuYXBwO1xuXHRcdH1cblx0XHRyZXR1cm4gdmFsdWU7XG5cdH0sXG59KTtcblxuZXhwb3J0IGxldCBob3ZlckVsZW1lbnQgPSBTdGF0ZUZpZWxkLmRlZmluZTxvYmplY3QgfCBudWxsPih7XG5cdGNyZWF0ZSgpIHtcblx0XHRyZXR1cm4gbnVsbDtcblx0fSxcblx0dXBkYXRlKHZhbHVlLCB0cikge1xuXHRcdGlmICh0ci5lZmZlY3RzLmxlbmd0aCA+IDApIHtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdGxldCBkYXRhID0gSlNPTi5wYXJzZSh0ci5lZmZlY3RzWzBdLnZhbHVlKTtcblx0XHRcdFx0aWYgKGRhdGEudHlwZSA9PSBcImhvdmVyLXN0YXJ0XCIpIHtcblx0XHRcdFx0XHRyZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgZGF0YSk7XG5cdFx0XHRcdH0gZWxzZSBpZiAoZGF0YS50eXBlID09IFwiaG92ZXJcIikge1xuXHRcdFx0XHRcdGlmICh2YWx1ZSkgcmV0dXJuIE9iamVjdC5hc3NpZ24odmFsdWUsIGRhdGEpO1xuXHRcdFx0XHRcdHJldHVybiBkYXRhO1xuXHRcdFx0XHR9IGVsc2UgaWYgKGRhdGEudHlwZSA9PSBcImhvdmVyLW9mZlwiKSB7XG5cdFx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIHZhbHVlO1xuXHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRjb25zb2xlLmxvZyhlKTtcblx0XHRcdFx0cmV0dXJuIHZhbHVlO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gdmFsdWU7XG5cdH0sXG59KTtcblxuZXhwb3J0IGxldCBiYWNrbGlua0hvdmVyRWxlbWVudCA9IFN0YXRlRmllbGQuZGVmaW5lPG9iamVjdCB8IG51bGw+KHtcblx0Y3JlYXRlKCkge1xuXHRcdHJldHVybiBudWxsO1xuXHR9LFxuXHR1cGRhdGUodmFsdWUsIHRyKSB7XG5cdFx0aWYgKHRyLmVmZmVjdHMubGVuZ3RoID4gMCkge1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0bGV0IGRhdGEgPSBKU09OLnBhcnNlKHRyLmVmZmVjdHNbMF0udmFsdWUpO1xuXHRcdFx0XHRpZiAoZGF0YS50eXBlID09IFwiYmFja2xpbmstc3RhcnRcIikge1xuXHRcdFx0XHRcdHJldHVybiBPYmplY3QuYXNzaWduKHt9LCBkYXRhKTtcblx0XHRcdFx0fSBlbHNlIGlmIChkYXRhLnR5cGUgPT0gXCJiYWNrbGluay11cGRhdGVcIikge1xuXHRcdFx0XHRcdGlmICh2YWx1ZSkgcmV0dXJuIE9iamVjdC5hc3NpZ24odmFsdWUsIGRhdGEpO1xuXHRcdFx0XHRcdHJldHVybiBkYXRhO1xuXHRcdFx0XHR9IGVsc2UgaWYgKGRhdGEudHlwZSA9PSBcImJhY2tsaW5rLW9mZlwiKSB7XG5cdFx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIHZhbHVlO1xuXHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRjb25zb2xlLmxvZyhlKTtcblx0XHRcdFx0cmV0dXJuIHZhbHVlO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gdmFsdWU7XG5cdH0sXG59KTtcblxuZXhwb3J0IGxldCBiYWNrbGlua3MgPSBTdGF0ZUZpZWxkLmRlZmluZTxCYWNrbGlua1tdPih7XG5cdGNyZWF0ZSgpIHtcblx0XHRyZXR1cm4gW107XG5cdH0sXG5cdHVwZGF0ZSh2YWx1ZSwgdHIpIHtcblx0XHRpZiAodHIuZWZmZWN0cy5sZW5ndGggPiAwKSB7XG5cdFx0XHR0cnkge1xuXHRcdFx0XHRsZXQgZGF0YTogeyB0eXBlOiBzdHJpbmc7IGJhY2tsaW5rczogQmFja2xpbmtbXSB9ID0gSlNPTi5wYXJzZShcblx0XHRcdFx0XHR0ci5lZmZlY3RzWzBdLnZhbHVlXG5cdFx0XHRcdCk7XG5cdFx0XHRcdGlmIChkYXRhLnR5cGUgPT0gXCJiYWNrbGlua1wiKSB7XG5cdFx0XHRcdFx0Y29uc29sZS5sb2coZGF0YS5iYWNrbGlua3MpO1xuXHRcdFx0XHRcdGxldCByZWZlcmVuY2luZ0xvY2F0aW9ucyA9IGRhdGEuYmFja2xpbmtzLm1hcChcblx0XHRcdFx0XHRcdChiYWNrbGluaykgPT4gYmFja2xpbmsucmVmZXJlbmNpbmdMb2NhdGlvblxuXHRcdFx0XHRcdCk7XG5cdFx0XHRcdFx0bGV0IHJlZmVyZW5jZWRMb2NhdGlvbnMgPSBkYXRhLmJhY2tsaW5rcy5tYXAoXG5cdFx0XHRcdFx0XHQoYmFja2xpbmspID0+IGJhY2tsaW5rLnJlZmVyZW5jZWRMb2NhdGlvblxuXHRcdFx0XHRcdCk7XG5cdFx0XHRcdFx0bGV0IGZpbHRlcmVkQmFja2xpbmtzID0gdmFsdWUuZmlsdGVyKChiYWNrbGluaykgPT4ge1xuXHRcdFx0XHRcdFx0cmV0dXJuICEoXG5cdFx0XHRcdFx0XHRcdHJlZmVyZW5jZWRMb2NhdGlvbnMuaW5jbHVkZXMoYmFja2xpbmsucmVmZXJlbmNlZExvY2F0aW9uKSAmJlxuXHRcdFx0XHRcdFx0XHRyZWZlcmVuY2luZ0xvY2F0aW9ucy5pbmNsdWRlcyhiYWNrbGluay5yZWZlcmVuY2luZ0xvY2F0aW9uKVxuXHRcdFx0XHRcdFx0KTtcblx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKGJhY2tsaW5rKTtcblx0XHRcdFx0XHRcdHJldHVybiAhZGF0YS5iYWNrbGlua3MuaW5jbHVkZXMoYmFja2xpbmspO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdGNvbnNvbGUubG9nKGZpbHRlcmVkQmFja2xpbmtzKTtcblx0XHRcdFx0XHRyZXR1cm4gWy4uLmZpbHRlcmVkQmFja2xpbmtzLCAuLi5kYXRhLmJhY2tsaW5rc107XG5cdFx0XHRcdH0gZWxzZSBpZiAoZGF0YS50eXBlID09IFwicmVtb3ZlLWJhY2tsaW5rXCIpIHtcblx0XHRcdFx0XHRsZXQgZmlsdGVyZWRCYWNrbGlua3MgPSB2YWx1ZS5maWx0ZXIoKGJhY2tsaW5rKSA9PiB7fSk7XG5cdFx0XHRcdFx0cmV0dXJuIGZpbHRlcmVkQmFja2xpbmtzO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiB2YWx1ZTtcblx0XHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdFx0Y29uc29sZS5sb2coZSk7XG5cdFx0XHRcdHJldHVybiB2YWx1ZTtcblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIHZhbHVlO1xuXHR9LFxufSk7XG5cbmV4cG9ydCBjb25zdCB0aGF0QW5ub3RhdGlvbiA9IEFubm90YXRpb24uZGVmaW5lPGFueT4oKTtcbmV4cG9ydCBjb25zdCBob3ZlckVmZmVjdCA9IFN0YXRlRWZmZWN0LmRlZmluZTxzdHJpbmc+KCk7XG5leHBvcnQgY29uc3QgYmFja2xpbmtIb3ZlckVmZmVjdCA9IFN0YXRlRWZmZWN0LmRlZmluZTxzdHJpbmc+KCk7XG5leHBvcnQgY29uc3QgYmFja2xpbmtFZmZlY3QgPSBTdGF0ZUVmZmVjdC5kZWZpbmU8c3RyaW5nPigpO1xuXG5leHBvcnQgbGV0IHN0YXRlOiBhbnkgPSBFZGl0b3JTdGF0ZS5jcmVhdGUoe1xuXHRleHRlbnNpb25zOiBbdGhhdCwgYmFja2xpbmtzLCBob3ZlckVsZW1lbnQsIGJhY2tsaW5rSG92ZXJFbGVtZW50XSxcbn0pO1xuXG4vLyBPQlNJRElBTiBUSEFUXG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRUaGF0KCk6IEFwcCB7XG5cdHJldHVybiBzdGF0ZS5maWVsZCh0aGF0KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZVRoYXQodGhhdDogYW55KSB7XG5cdHN0YXRlID0gc3RhdGUudXBkYXRlKHtcblx0XHRhbm5vdGF0aW9uczogdGhhdEFubm90YXRpb24ub2Yoe1xuXHRcdFx0dHlwZTogXCJ0aGF0XCIsXG5cdFx0XHR0aGF0LFxuXHRcdH0pLFxuXHR9KS5zdGF0ZTtcbn1cblxuLy8gTU9VU0UgSE9WRVJcbmV4cG9ydCBmdW5jdGlvbiBnZXRIb3ZlcigpIHtcblx0cmV0dXJuIHN0YXRlLmZpZWxkKGhvdmVyRWxlbWVudCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVIb3Zlcih2YWx1ZTogb2JqZWN0KSB7XG5cdHN0YXRlID0gc3RhdGUudXBkYXRlKHtcblx0XHRlZmZlY3RzOiBob3ZlckVmZmVjdC5vZihcblx0XHRcdEpTT04uc3RyaW5naWZ5KE9iamVjdC5hc3NpZ24odmFsdWUsIHsgdHlwZTogXCJob3ZlclwiIH0pKVxuXHRcdCksXG5cdH0pLnN0YXRlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVzZXRIb3ZlcigpIHtcblx0c3RhdGUgPSBzdGF0ZS51cGRhdGUoe1xuXHRcdGVmZmVjdHM6IGhvdmVyRWZmZWN0Lm9mKFxuXHRcdFx0SlNPTi5zdHJpbmdpZnkoe1xuXHRcdFx0XHR0eXBlOiBcImhvdmVyLW9mZlwiLFxuXHRcdFx0fSlcblx0XHQpLFxuXHR9KS5zdGF0ZTtcbn1cblxuLy8gQkFDS0xJTksgSE9WRVJcblxuZXhwb3J0IGZ1bmN0aW9uIGdldEJhY2tsaW5rSG92ZXIoKSB7XG5cdHJldHVybiBzdGF0ZS5maWVsZChiYWNrbGlua0hvdmVyRWxlbWVudCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVCYWNrbGlua0hvdmVyKHZhbHVlOiBvYmplY3QpIHtcblx0c3RhdGUgPSBzdGF0ZS51cGRhdGUoe1xuXHRcdGVmZmVjdHM6IGJhY2tsaW5rSG92ZXJFZmZlY3Qub2YoXG5cdFx0XHRKU09OLnN0cmluZ2lmeShPYmplY3QuYXNzaWduKHZhbHVlLCB7IHR5cGU6IFwiYmFja2xpbmstdXBkYXRlXCIgfSkpXG5cdFx0KSxcblx0fSkuc3RhdGU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZXNldEJhY2tsaW5rSG92ZXIoKSB7XG5cdHN0YXRlID0gc3RhdGUudXBkYXRlKHtcblx0XHRlZmZlY3RzOiBiYWNrbGlua0hvdmVyRWZmZWN0Lm9mKFxuXHRcdFx0SlNPTi5zdHJpbmdpZnkoe1xuXHRcdFx0XHR0eXBlOiBcImJhY2tsaW5rLW9mZlwiLFxuXHRcdFx0fSlcblx0XHQpLFxuXHR9KS5zdGF0ZTtcbn1cblxuLy8gQkFDS0xJTktTXG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRCYWNrbGlua3MoKTogQmFja2xpbmtbXSB7XG5cdHJldHVybiBzdGF0ZS5maWVsZChiYWNrbGlua3MpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlQmFja2xpbmtzKHZhbHVlOiBCYWNrbGlua1tdKSB7XG5cdHN0YXRlID0gc3RhdGUudXBkYXRlKHtcblx0XHRlZmZlY3RzOiBiYWNrbGlua0VmZmVjdC5vZihcblx0XHRcdEpTT04uc3RyaW5naWZ5KE9iamVjdC5hc3NpZ24oeyBiYWNrbGlua3M6IHZhbHVlIH0sIHsgdHlwZTogXCJiYWNrbGlua1wiIH0pKVxuXHRcdCksXG5cdH0pLnN0YXRlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlQmFja2xpbmtzKHZhbHVlOiBCYWNrbGlua1tdKSB7XG5cdHN0YXRlID0gc3RhdGUudXBkYXRlKHtcblx0XHRlZmZlY3RzOiBiYWNrbGlua0VmZmVjdC5vZihcblx0XHRcdEpTT04uc3RyaW5naWZ5KFxuXHRcdFx0XHRPYmplY3QuYXNzaWduKHsgYmFja2xpbmtzOiB2YWx1ZSB9LCB7IHR5cGU6IFwicmVtb3ZlLWJhY2tsaW5rXCIgfSlcblx0XHRcdClcblx0XHQpLFxuXHR9KS5zdGF0ZTtcbn1cbiIsICJpbXBvcnQge1xuXHRFZGl0b3JWaWV3LFxuXHRXaWRnZXRUeXBlLFxuXHREZWNvcmF0aW9uLFxuXHREZWNvcmF0aW9uU2V0LFxuXHRWaWV3UGx1Z2luLFxuXHRWaWV3VXBkYXRlLFxuXHRNYXRjaERlY29yYXRvcixcbn0gZnJvbSBcIkBjb2RlbWlycm9yL3ZpZXdcIjtcbmltcG9ydCB7IFNWR19IT1ZFUl9DT0xPUiB9IGZyb20gXCIuLi9jb25zdGFudHNcIjtcblxuLyogaGlnaGxpZ2h0ICovXG5jbGFzcyBIaWdobGlnaHRlcldpZGdldCBleHRlbmRzIFdpZGdldFR5cGUge1xuXHRjb25zdHJ1Y3Rvcihwcml2YXRlIG5hbWU6IHN0cmluZywgcHJpdmF0ZSB2aWV3OiBFZGl0b3JWaWV3KSB7XG5cdFx0c3VwZXIoKTtcblx0fVxuXG5cdGVxKG90aGVyOiBIaWdobGlnaHRlcldpZGdldCkge1xuXHRcdHJldHVybiB0aGlzLm5hbWUgPT09IG90aGVyLm5hbWU7XG5cdH1cblxuXHR0b0RPTSgpIHtcblx0XHRjb25zdCBzcGFuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImZyYWdtZW50XCIpO1xuXHRcdHNwYW4udGV4dENvbnRlbnQgPSB0aGlzLm5hbWU7XG5cdFx0c3Bhbi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBTVkdfSE9WRVJfQ09MT1I7XG5cdFx0c3Bhbi5zdHlsZS5jb2xvciA9IFwiYmxhY2tcIjtcblxuXHRcdHJldHVybiBzcGFuO1xuXHR9XG59XG5cbmNvbnN0IGhpZ2hsaWdodGVyRGVjb3JhdGlvbiA9IChtYXRjaDogUmVnRXhwRXhlY0FycmF5LCB2aWV3OiBFZGl0b3JWaWV3KSA9PlxuXHREZWNvcmF0aW9uLnJlcGxhY2Uoe1xuXHRcdHdpZGdldDogbmV3IEhpZ2hsaWdodGVyV2lkZ2V0KG1hdGNoWzFdLCB2aWV3KSxcblx0fSk7XG5cbmNvbnN0IGhpZ2hsaWdodE1hdGNoZXIgPSBuZXcgTWF0Y2hEZWNvcmF0b3Ioe1xuXHRyZWdleHA6IC9cXCtcXCtcXCsoLio/KVxcK1xcK1xcKy9nLFxuXHRkZWNvcmF0aW9uOiAobWF0Y2gsIHZpZXcsIHBvcykgPT4ge1xuXHRcdHJldHVybiBoaWdobGlnaHRlckRlY29yYXRpb24obWF0Y2gsIHZpZXcpO1xuXHR9LFxufSk7XG5cbmV4cG9ydCBjb25zdCBoaWdobGlnaHRzID0gVmlld1BsdWdpbi5mcm9tQ2xhc3MoXG5cdGNsYXNzIHtcblx0XHRoaWdobGlnaHRzOiBEZWNvcmF0aW9uU2V0O1xuXHRcdGNvbnN0cnVjdG9yKHZpZXc6IEVkaXRvclZpZXcpIHtcblx0XHRcdHRoaXMuaGlnaGxpZ2h0cyA9IGhpZ2hsaWdodE1hdGNoZXIuY3JlYXRlRGVjbyh2aWV3KTtcblx0XHR9XG5cdFx0dXBkYXRlKHVwZGF0ZTogVmlld1VwZGF0ZSkge1xuXHRcdFx0dGhpcy5oaWdobGlnaHRzID0gaGlnaGxpZ2h0TWF0Y2hlci51cGRhdGVEZWNvKHVwZGF0ZSwgdGhpcy5oaWdobGlnaHRzKTtcblx0XHR9XG5cdFx0ZGVzdHJveSgpIHtcblx0XHRcdHRoaXMuaGlnaGxpZ2h0cyA9IERlY29yYXRpb24ubm9uZTtcblx0XHR9XG5cdH0sXG5cdHtcblx0XHRkZWNvcmF0aW9uczogKGluc3RhbmNlKSA9PiBpbnN0YW5jZS5oaWdobGlnaHRzLFxuXHRcdHByb3ZpZGU6IChwbHVnaW4pID0+XG5cdFx0XHRFZGl0b3JWaWV3LmF0b21pY1Jhbmdlcy5vZigodmlldykgPT4ge1xuXHRcdFx0XHRyZXR1cm4gdmlldy5wbHVnaW4ocGx1Z2luKT8uaGlnaGxpZ2h0cyB8fCBEZWNvcmF0aW9uLm5vbmU7XG5cdFx0XHR9KSxcblx0fVxuKTtcbiIsICJleHBvcnQgbGV0IFJFRkVSRU5DRV9SRUdFWCA9IC9cXFtcXHUyMTk3XFxdXFwodXJuOihbXildKilcXCkvZztcblxuZXhwb3J0IGxldCBBQ1RJT05fVFlQRSA9IHtcblx0TU9VU0U6IFwibW91c2VcIixcblx0Q1VSU09SOiBcImN1cnNvclwiLFxuXHRCQUNLTElOSzogXCJiYWNrbGlua1wiLFxufTtcblxuZXhwb3J0IGxldCBTVkdfSE9WRVJfQ09MT1IgPSBcInJnYigxODcsIDIxNSwgMjMwKVwiO1xuZXhwb3J0IGxldCBTVkdfSE9WRVJfQ09MT1JfTElHSFQgPSBcInJnYigxODcsIDIxNSwgMjMwLCAwLjUpXCI7XG5leHBvcnQgbGV0IFNWR19DT0xPUiA9IFwicmdiKDIxNSwgMjM1LCAwKVwiO1xuXG5leHBvcnQgY29uc3QgUkVGRVJFTkNFX0lDT05fSEVJR0hUID0gMjA7XG5cbmV4cG9ydCBjb25zdCBQT1JUQUxfVEVYVF9TTElDRV9TSVpFID0gMTAwO1xuIiwgImltcG9ydCB7XG5cdEVkaXRvclZpZXcsXG5cdFdpZGdldFR5cGUsXG5cdERlY29yYXRpb24sXG5cdERlY29yYXRpb25TZXQsXG5cdFZpZXdQbHVnaW4sXG5cdFZpZXdVcGRhdGUsXG5cdE1hdGNoRGVjb3JhdG9yLFxufSBmcm9tIFwiQGNvZGVtaXJyb3Ivdmlld1wiO1xuXG5pbXBvcnQge1xuXHRvcGVuUmVmZXJlbmNlLFxuXHRjcmVhdGVSZWZlcmVuY2VJY29uLFxuXHR1cGRhdGVCYWNrbGlua01hcmtQb3NpdGlvbnMsXG5cdGdldE1hcmtkb3duVmlldyxcblx0Z2V0QmFja2xpbmtDb250YWluZXIsXG59IGZyb20gXCIuLi9yZWZlcmVuY2VzXCI7XG5pbXBvcnQgeyBkZWNvZGVVUklDb21wb25lbnRTdHJpbmcgfSBmcm9tIFwic3JjL3V0aWxzXCI7XG5pbXBvcnQgeyByZW1vdmVIaWdobGlnaHQgfSBmcm9tIFwic3JjL21hcmtcIjtcbmltcG9ydCB7IGNvbGxlY3RMZWF2ZXNCeVRhYkhlbHBlciB9IGZyb20gXCJzcmMvd29ya3NwYWNlXCI7XG5pbXBvcnQgeyBnZXRFZGl0b3JWaWV3IH0gZnJvbSBcInNyYy9lZmZlY3RzXCI7XG5pbXBvcnQgeyBCYWNrbGluayB9IGZyb20gXCJzcmMvdHlwZXNcIjtcblxuZnVuY3Rpb24gcHJvY2Vzc0xpbmUobGluZTogRWxlbWVudCkge1xuXHRsZXQgbGluZUNvcHkgPSBsaW5lPy5jbG9uZU5vZGUodHJ1ZSkgYXMgSFRNTEVsZW1lbnQ7XG5cdGxpbmVDb3B5Py5xdWVyeVNlbGVjdG9yQWxsKFwiLnJlZmVyZW5jZS1zcGFuXCIpLmZvckVhY2goKHNwYW4pID0+IHtcblx0XHRzcGFuLmlubmVySFRNTCA9IFwiXHUyMTk3XCI7XG5cdH0pO1xuXG5cdHJldHVybiBsaW5lQ29weTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFJlZmVyZW5jZVBvc2l0aW9uKFxuXHR2aWV3OiBFZGl0b3JWaWV3LFxuXHRjdXJyTGluZTogSFRNTFNwYW5FbGVtZW50LFxuXHRyZWZlcmVuY2U6IHN0cmluZyxcblx0Y29udGVudDogc3RyaW5nXG4pIHtcblx0bGV0IGxpbmVzID0gdmlldy5jb250ZW50RE9NLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY20tbGluZVwiKTtcblxuXHQvLyBnZXQgdGhlIGluZGV4IG9mIHRoZSBhY3RpdmVMaW5lXG5cdGxldCBhY3RpdmVMaW5lSW5kZXg7XG5cdGxldCBzZWVuQWN0aXZlID0gZmFsc2U7XG5cblx0bGluZXMuZm9yRWFjaCgobGluZSwgaSkgPT4ge1xuXHRcdGlmIChzZWVuQWN0aXZlKSByZXR1cm47XG5cdFx0aWYgKGxpbmUgPT0gY3VyckxpbmUpIHtcblx0XHRcdHNlZW5BY3RpdmUgPSB0cnVlO1xuXHRcdFx0YWN0aXZlTGluZUluZGV4ID0gaTtcblx0XHR9XG5cdH0pO1xuXG5cdGlmIChhY3RpdmVMaW5lSW5kZXggPT09IHVuZGVmaW5lZCkgcmV0dXJuO1xuXG5cdGxldCBhY3RpdmVMaW5lID0gbGluZXNbYWN0aXZlTGluZUluZGV4XTtcblx0Ly8gbWFrZSBjb3B5IG9mIGFjdGl2ZUxpbmUgZWxlbWVudFxuXHRsZXQgYWN0aXZlTGluZUNvcHkgPSBwcm9jZXNzTGluZShhY3RpdmVMaW5lKTtcblx0Ly8gbm9uLXJlZmVyZW5jZSBwYXJ0cyBvZiB0aGUgdGV4dFxuXHRsZXQgcGFydHMgPSBhY3RpdmVMaW5lQ29weS5pbm5lclRleHQuc3BsaXQoXCJcdTIxOTdcIik7XG5cblx0Ly8gZ2V0IGFsbCByZWZlcmVuY2VzXG5cdGxldCBsaW5lUmVmZXJlbmNlcyA9IGFjdGl2ZUxpbmU/LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucmVmZXJlbmNlLWRhdGEtc3BhblwiKTtcblxuXHQvLyBnZXQgdGhlIGZ1bGwgc2VyaWFsaXplZCB2ZXJzaW9uIGZvciB0aGVzZSByZWZlcmVuY2VzXG5cdGxldCBsaW5lUmVmZXJlbmNlc0RhdGEgPSBBcnJheS5mcm9tKGxpbmVSZWZlcmVuY2VzIHx8IFtdKS5tYXAoXG5cdFx0KHNwYW4pID0+IFwiW1x1MjE5N10odXJuOlwiICsgc3Bhbi5nZXRBdHRyaWJ1dGUoXCJkYXRhXCIpICsgXCIpXCJcblx0KTtcblxuXHRpZiAoIWNvbnRlbnQpIHRocm93IG5ldyBFcnJvcihcIlJlZmVyZW5jZSBub3QgZm91bmRcIik7XG5cdGxldCBpbmRleDogbnVtYmVyIHwgbnVsbCA9IG51bGw7XG5cdGxpbmVSZWZlcmVuY2VzRGF0YS5mb3JFYWNoKChyZWZlcmVuY2UsIGkpID0+IHtcblx0XHRpZiAoIWluZGV4KSB7XG5cdFx0XHRpZiAocmVmZXJlbmNlLmluY2x1ZGVzKGNvbnRlbnQpKSB7XG5cdFx0XHRcdGluZGV4ID0gaTtcblx0XHRcdH1cblx0XHR9XG5cdH0pO1xuXG5cdGlmICghaW5kZXggJiYgaW5kZXggIT0gMCkgdGhyb3cgbmV3IEVycm9yKFwiUmVmZXJlbmNlIG5vdCBmb3VuZFwiKTtcblxuXHQvLyBnZXQgdGhlIHRleHQgYmVmb3JlIHRoZSByZWZlcmVuY2Vcblx0bGV0IHN0YXJ0VGV4dCA9IFtcblx0XHQuLi5wYXJ0cy5zbGljZSgwLCBpbmRleCArIDEpLFxuXHRcdC4uLmxpbmVSZWZlcmVuY2VzRGF0YS5zbGljZSgwLCBpbmRleCksXG5cdF0uam9pbihcIlwiKTtcblx0c3RhcnRUZXh0ID0gc3RhcnRUZXh0LnJlcGxhY2UoL1xcdXsyMDBCfS9nLCBcIlwiKTtcblxuXHQvLyBnZXQgYWxsIHRoZSBwcmlvciBsaW5lcyB0byBhY3RpdmUgbGluZSBhbmQgdGhlIGxlbmd0aCBvZiB0aGUgdGV4dFxuXHRsZXQgcHJldkxpbmVDaGFyQ291bnQgPSBBcnJheS5mcm9tKGxpbmVzKVxuXHRcdC5zbGljZSgwLCBhY3RpdmVMaW5lSW5kZXgpXG5cdFx0LnJlZHVjZSgoYWNjLCBsaW5lKSA9PiB7XG5cdFx0XHRsZXQgcHJvY2Vzc2VkTGluZSA9IHByb2Nlc3NMaW5lKGxpbmUpOyAvLyBjb250ZW50cyBvZiBhIGxpbmUgaXMganVzdCBhIHNpbmdsZSBhcnJvdyBjaGFyYWN0ZXJcblx0XHRcdGxldCBwYXJ0cyA9IHByb2Nlc3NlZExpbmUuaW5uZXJUZXh0LnNwbGl0KFwiXHUyMTk3XCIpO1xuXG5cdFx0XHRsZXQgbGluZVJlZmVyZW5jZXMgPSBsaW5lPy5xdWVyeVNlbGVjdG9yQWxsKFwiLnJlZmVyZW5jZS1kYXRhLXNwYW5cIik7XG5cdFx0XHRsZXQgbGluZVJlZmVyZW5jZXNEYXRhID0gQXJyYXkuZnJvbShsaW5lUmVmZXJlbmNlcyB8fCBbXSkubWFwKFxuXHRcdFx0XHQoc3BhbikgPT4gXCJbXHUyMTk3XSh1cm46XCIgKyBzcGFuLmdldEF0dHJpYnV0ZShcImRhdGFcIikgKyBcIilcIlxuXHRcdFx0KTtcblx0XHRcdGxldCBhbGxTZXJpYWxpemVkVGV4dCA9IFsuLi5wYXJ0cywgLi4ubGluZVJlZmVyZW5jZXNEYXRhXS5qb2luKFwiXCIpICsgXCJcXG5cIjtcblx0XHRcdGFsbFNlcmlhbGl6ZWRUZXh0ID0gYWxsU2VyaWFsaXplZFRleHQucmVwbGFjZSgvXFx1ezIwMEJ9L2csIFwiXCIpO1xuXHRcdFx0Ly8gbGV0IGFsbFNlcmlhbGl6ZWRUZXh0ID0gWy4uLnBhcnRzLCAuLi5saW5lUmVmZXJlbmNlc0RhdGFdLmpvaW4oXCJcIik7XG5cdFx0XHRyZXR1cm4gYWxsU2VyaWFsaXplZFRleHQubGVuZ3RoICsgYWNjO1xuXHRcdH0sIDApOyAvLy0gMTsgLy8gc3Vic3RyYWN0IG9uZSBjYXVzZSBkb24ndCB3YW50IGEgbmV3IGxpbmUgZm9yIHRoZSBsYXN0IGxpbmVcblxuXHQvLyBzZXQgcmFuZ2UgdG8gcmVwbGFjZSB3aXRoIG5ldyByZWZlcmVuY2Ugc2VyaWFsaXphdGlvblxuXHRsZXQgZnJvbSA9IHByZXZMaW5lQ2hhckNvdW50ICsgc3RhcnRUZXh0Lmxlbmd0aDtcblx0bGV0IHRvID0gZnJvbSArIHJlZmVyZW5jZS5sZW5ndGg7XG5cdHJldHVybiB7IGZyb20sIHRvIH07XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzZXJpYWxpemVSZWZlcmVuY2UoXG5cdGNvbnRlbnQ6IGFueSxcblx0cmVmZXJlbmNlU3BhbjogSFRNTEVsZW1lbnQsXG5cdHZpZXc6IEVkaXRvclZpZXcsXG5cdHRvZ2dsZVZhbHVlOiBzdHJpbmcgfCBudWxsID0gbnVsbFxuKSB7XG5cdGNvbnRlbnQgPSB0eXBlb2YgY29udGVudCA9PSBcInN0cmluZ1wiID8gY29udGVudCA6IGNvbnRlbnRbMV07XG5cblx0Y29uc3QgW3ByZWZpeCwgdGV4dCwgc3VmZml4LCBmaWxlLCBmcm9tLCB0bywgcG9ydGFsLCB0b2dnbGVdID1cblx0XHRjb250ZW50LnNwbGl0KFwiOlwiKTtcblx0Ly8gU2VyaWFsaXplIHRoZSB0b2dnbGUgc3RhdGUgZm9yIHJlZmVyZW5jZSBpbnRvIGZpbGVcblx0Ly8gS05PV04gRVJST1IuIGNvbnRlbnRET00gb25seSByZXR1cm5zIHBhcnRpYWwgZmlsZSBmb3IgZWZmaWNpZW5jeSBvbiBsYXJnZSBkb2N1bWVudHMuIFNvIHdpbGwgbG9zZSBzZXJpYWxpemF0aW9uIGluIHRoaXMgY2FzZS5cblx0Ly8gcmVmZXJlbmNlU3Bhbi5jbGFzc0xpc3QudG9nZ2xlKFwicmVmZXJlbmNlLXNwYW4taGlkZGVuXCIpO1xuXG5cdGxldCBuZXdUb2dnbGUgPSB0b2dnbGVWYWx1ZSA/IHRvZ2dsZVZhbHVlIDogdG9nZ2xlID09PSBcImZcIiA/IFwidFwiIDogXCJmXCI7XG5cdGxldCByZWZlcmVuY2UgPSBgW1x1MjE5N10odXJuOiR7cHJlZml4fToke3RleHR9OiR7c3VmZml4fToke2ZpbGV9OiR7ZnJvbX06JHt0b306JHtwb3J0YWx9OiR7bmV3VG9nZ2xlfSlgO1xuXG5cdGxldCBjdXJyTGluZSA9IHJlZmVyZW5jZVNwYW4/LnBhcmVudEVsZW1lbnQ/LnBhcmVudEVsZW1lbnQ7XG5cblx0Y29uc3QgcmVzdWx0cyA9IGdldFJlZmVyZW5jZVBvc2l0aW9uKFxuXHRcdHZpZXcsXG5cdFx0Y3VyckxpbmUgYXMgSFRNTEVsZW1lbnQsXG5cdFx0cmVmZXJlbmNlLFxuXHRcdHRleHRcblx0KTtcblx0aWYgKHJlc3VsdHMpIHtcblx0XHRjb25zdCB0cmFuc2FjdGlvbiA9IHZpZXcuc3RhdGUudXBkYXRlKHtcblx0XHRcdGNoYW5nZXM6IHsgZnJvbTogcmVzdWx0cy5mcm9tLCB0bzogcmVzdWx0cy50bywgaW5zZXJ0OiByZWZlcmVuY2UgfSxcblx0XHR9KTtcblx0XHR2aWV3LmRpc3BhdGNoKHRyYW5zYWN0aW9uKTtcblx0XHRjb25zb2xlLmxvZyhcInVwZGF0ZWJhY2tsaW5rcG9zaXRpb25zXCIpO1xuXHRcdGF3YWl0IHVwZGF0ZUJhY2tsaW5rTWFya1Bvc2l0aW9ucygpO1xuXHR9XG5cblx0cmV0dXJuO1xufVxuXG4vKiBuZXcgcGxhY2Vob2xkZXIgKi9cbmNsYXNzIFJlZmVyZW5jZVdpZGdldCBleHRlbmRzIFdpZGdldFR5cGUge1xuXHRjb25zdHJ1Y3Rvcihcblx0XHRwcml2YXRlIG5hbWU6IHN0cmluZyxcblx0XHRwcml2YXRlIHZpZXc6IEVkaXRvclZpZXcsXG5cdFx0cHJpdmF0ZSBwb3M6IG51bWJlcixcblx0XHRwcml2YXRlIHJlZmVyZW5jZVNwYW46IEVsZW1lbnQgfCBudWxsID0gbnVsbCxcblx0XHRwcml2YXRlIHBhcmVudEVsZW1lbnQ6IEhUTUxFbGVtZW50IHwgbnVsbCB8IHVuZGVmaW5lZCA9IG51bGwsXG5cdFx0cHJpdmF0ZSBzZXJpYWxpemVkOiBib29sZWFuID0gZmFsc2Vcblx0KSB7XG5cdFx0c3VwZXIoKTtcblx0fVxuXG5cdGVxKG90aGVyOiBSZWZlcmVuY2VXaWRnZXQpIHtcblx0XHRyZXR1cm4gdGhpcy5uYW1lID09PSBvdGhlci5uYW1lO1xuXHR9XG5cblx0Z2V0VmlldygpIHtcblx0XHRyZXR1cm4gdGhpcy52aWV3O1xuXHR9XG5cblx0Ly8gdGhpcyBydW5zIHdoZW4gcmUtc2VyaWFsaXplZCBhcyB3ZWxsXG5cdGRlc3Ryb3koKSB7XG5cdFx0Y29uc29sZS5sb2codGhpcy5zZXJpYWxpemVkKTtcblx0XHRpZiAodGhpcy5zZXJpYWxpemVkKSB7XG5cdFx0XHR0aGlzLnNlcmlhbGl6ZWQgPSBmYWxzZTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRjb25zdCByZWdleCA9IC9cXFtcdTIxOTdcXF1cXCh1cm46KFteKV0qKVxcKS9nO1xuXHRcdFx0bGV0IGNvbnRlbnQgPSByZWdleC5leGVjKHRoaXMubmFtZSk7XG5cdFx0XHRpZiAoIWNvbnRlbnQpIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgcmVmZXJlbmNlXCIpO1xuXG5cdFx0XHRsZXQgcmVmZXJlbmNlID0gY29udGVudFswXTtcblx0XHRcdGxldCBkYXRhU3RyaW5nID0gY29udGVudFsxXTtcblx0XHRcdGNvbnN0IFtwcmVmaXgsIHRleHQsIHN1ZmZpeCwgZmlsZSwgZnJvbSwgdG8sIHBvcnRhbCwgdG9nZ2xlID0gXCJmXCJdID1cblx0XHRcdFx0ZGF0YVN0cmluZy5zcGxpdChcIjpcIik7XG5cblx0XHRcdGxldCBkZWNvZGVkRmlsZSA9IGRlY29kZVVSSUNvbXBvbmVudFN0cmluZyhmaWxlKTtcblx0XHRcdC8vIGNvbnN0IGxlYXZlcyA9IGdldFRoYXQoKS53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFwibWFya2Rvd25cIik7XG5cdFx0XHRsZXQgbGVhdmVzQnlUYWIgPSBjb2xsZWN0TGVhdmVzQnlUYWJIZWxwZXIoKTtcblx0XHRcdGxldCBsZWFmID0gbGVhdmVzQnlUYWIuZmxhdCgpLmZpbHRlcigobGVhZikgPT4ge1xuXHRcdFx0XHRyZXR1cm4gbGVhZi5nZXRWaWV3U3RhdGUoKS5zdGF0ZS5maWxlID09IGRlY29kZWRGaWxlO1xuXHRcdFx0fSlbMF07XG5cdFx0XHRsZXQgdmlldyA9IGdldEVkaXRvclZpZXcobGVhZik7XG5cblx0XHRcdHJlbW92ZUhpZ2hsaWdodCh2aWV3LCBwYXJzZUludChmcm9tKSwgcGFyc2VJbnQodG8pKTtcblx0XHRcdGNvbnN0IGVkaXRvciA9IGdldE1hcmtkb3duVmlldyhsZWFmKS5lZGl0b3I7XG5cdFx0XHRjb25zdCBiYWNrbGlua0NvbnRhaW5lciA9IGdldEJhY2tsaW5rQ29udGFpbmVyKGVkaXRvcik7XG5cdFx0XHRjb25zdCBiYWNrbGlua3MgPSBBcnJheS5mcm9tKFxuXHRcdFx0XHRiYWNrbGlua0NvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKFwiLnJlZmVyZW5jZS1kYXRhLXNwYW5cIilcblx0XHRcdCk7XG5cdFx0XHRjb25zdCBiYWNrbGlua0RhdGEgPSBiYWNrbGlua3MubWFwKChiYWNrbGluazogSFRNTEVsZW1lbnQpID0+IHtcblx0XHRcdFx0bGV0IHJlZmVyZW5jZSA9IGJhY2tsaW5rLmdldEF0dHJpYnV0ZShcInJlZmVyZW5jZVwiKTtcblx0XHRcdFx0aWYgKCFyZWZlcmVuY2UpIHJldHVybiB7fTtcblx0XHRcdFx0cmV0dXJuIEpTT04ucGFyc2UocmVmZXJlbmNlKTtcblx0XHRcdH0pO1xuXHRcdFx0Y29uc3QgYmFja2xpbmtJbmRleCA9IGJhY2tsaW5rRGF0YS5maW5kSW5kZXgoKGJhY2tsaW5rOiBCYWNrbGluaykgPT4ge1xuXHRcdFx0XHRyZXR1cm4gKFxuXHRcdFx0XHRcdGJhY2tsaW5rLmRhdGFTdHJpbmcgPT09IGRhdGFTdHJpbmcgJiZcblx0XHRcdFx0XHRiYWNrbGluay5yZWZlcmVuY2VkTG9jYXRpb24uZmlsZW5hbWUgPT09XG5cdFx0XHRcdFx0XHRkZWNvZGVVUklDb21wb25lbnRTdHJpbmcoZmlsZSlcblx0XHRcdFx0KTtcblx0XHRcdH0pO1xuXG5cdFx0XHRiYWNrbGlua3NbYmFja2xpbmtJbmRleF0ucmVtb3ZlKCk7XG5cdFx0fSwgMTApO1xuXHR9XG5cblx0dG9ET00oKSB7XG5cdFx0Y29uc3QgcmVnZXggPSAvXFxbXHUyMTk3XFxdXFwodXJuOihbXildKilcXCkvZztcblx0XHRsZXQgY29udGVudCA9IHJlZ2V4LmV4ZWModGhpcy5uYW1lKTtcblx0XHRpZiAoIWNvbnRlbnQpIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgcmVmZXJlbmNlXCIpO1xuXG5cdFx0Y29uc3QgW3ByZWZpeCwgdGV4dCwgc3VmZml4LCBmaWxlLCBmcm9tLCB0bywgcG9ydGFsLCB0b2dnbGUgPSBcImZcIl0gPVxuXHRcdFx0Y29udGVudFsxXS5zcGxpdChcIjpcIik7XG5cblx0XHRjb25zdCBzcGFuID0gY3JlYXRlUmVmZXJlbmNlSWNvbihcblx0XHRcdHBvcnRhbCA9PSBcInBvcnRhbFwiID8gXCJpbmxpbmUgcmVmZXJlbmNlIHdpZGdldCB8KnxcIiA6IG51bGxcblx0XHQpO1xuXG5cdFx0aWYgKGNvbnRlbnQpIHNwYW4uc2V0QXR0cmlidXRlKFwiZGF0YVwiLCBjb250ZW50WzFdKTtcblxuXHRcdGNvbnN0IGNvbnRhaW5lclNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTtcblx0XHRjb250YWluZXJTcGFuLmNsYXNzTGlzdC5hZGQoXCJyZWZlcmVuY2UtY29udGFpbmVyLXNwYW5cIik7XG5cdFx0Y29uc3QgcmVmZXJlbmNlU3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO1xuXHRcdC8vIGFkZCBjbGFzc1xuXHRcdHJlZmVyZW5jZVNwYW4uY2xhc3NMaXN0LmFkZChcInJlZmVyZW5jZS1zcGFuXCIpO1xuXG5cdFx0cmVmZXJlbmNlU3Bhbi5pbm5lckhUTUwgPSBkZWNvZGVVUklDb21wb25lbnRTdHJpbmcodGV4dCk7XG5cdFx0cmVmZXJlbmNlU3Bhbi5jbGFzc0xpc3QudG9nZ2xlKFwicmVmZXJlbmNlLXNwYW4taGlkZGVuXCIsIHRvZ2dsZSA9PT0gXCJmXCIpO1xuXG5cdFx0Y29udGFpbmVyU3Bhbi5hcHBlbmRDaGlsZChyZWZlcmVuY2VTcGFuKTtcblx0XHRjb250YWluZXJTcGFuLmFwcGVuZENoaWxkKHNwYW4pO1xuXG5cdFx0dGhpcy5yZWZlcmVuY2VTcGFuID0gcmVmZXJlbmNlU3Bhbjtcblx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdHRoaXMucGFyZW50RWxlbWVudCA9IGNvbnRhaW5lclNwYW4ucGFyZW50RWxlbWVudDtcblx0XHR9LCAyMCk7XG5cblx0XHRjb250YWluZXJTcGFuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBhc3luYyAoZXYpID0+IHtcblx0XHRcdGlmIChldi5tZXRhS2V5IHx8IGV2LmN0cmxLZXkpIHtcblx0XHRcdFx0b3BlblJlZmVyZW5jZShldik7XG5cblx0XHRcdFx0Ly8gLy8gU2VyaWFsaXplIHRoZSB0b2dnbGUgc3RhdGUgZm9yIHJlZmVyZW5jZSBpbnRvIGZpbGVcblx0XHRcdFx0Ly8gLy8gS05PV04gRVJST1IuIGNvbnRlbnRET00gb25seSByZXR1cm5zIHBhcnRpYWwgZmlsZSBmb3IgZWZmaWNpZW5jeSBvbiBsYXJnZSBkb2N1bWVudHMuIFNvIHdpbGwgbG9zZSBzZXJpYWxpemF0aW9uIGluIHRoaXMgY2FzZS5cblx0XHRcdFx0Ly8gcmVmZXJlbmNlU3Bhbi5jbGFzc0xpc3QudG9nZ2xlKFwicmVmZXJlbmNlLXNwYW4taGlkZGVuXCIpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5zZXJpYWxpemVkID0gdHJ1ZTtcblx0XHRcdFx0YXdhaXQgc2VyaWFsaXplUmVmZXJlbmNlKGNvbnRlbnQsIHJlZmVyZW5jZVNwYW4sIHRoaXMudmlldyk7XG5cdFx0XHRcdC8vIHJlZmVyZW5jZVNwYW4uXG5cdFx0XHRcdHJlZmVyZW5jZVNwYW4uY2xhc3NMaXN0LnRvZ2dsZShcInJlZmVyZW5jZS1zcGFuLWhpZGRlblwiKTtcblx0XHRcdFx0aWYgKGNvbnRlbnQpIHRoaXMubmFtZSA9IGNvbnRlbnRbMF07XG5cdFx0XHRcdGlmIChyZWZlcmVuY2VTcGFuKSB7XG5cdFx0XHRcdFx0dGhpcy5yZWZlcmVuY2VTcGFuID0gcmVmZXJlbmNlU3Bhbjtcblx0XHRcdFx0XHR0aGlzLnBhcmVudEVsZW1lbnQgPSByZWZlcmVuY2VTcGFuPy5wYXJlbnRFbGVtZW50Py5wYXJlbnRFbGVtZW50O1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRyZXR1cm4gY29udGFpbmVyU3Bhbjtcblx0fVxufVxuXG5jb25zdCByZWZlcmVuY2VEZWNvcmF0aW9uID0gKFxuXHRtYXRjaDogUmVnRXhwRXhlY0FycmF5LFxuXHR2aWV3OiBFZGl0b3JWaWV3LFxuXHRwb3M6IG51bWJlclxuKSA9PiB7XG5cdGxldCBkZWNvcmF0aW9uID0gRGVjb3JhdGlvbi5yZXBsYWNlKHtcblx0XHR3aWRnZXQ6IG5ldyBSZWZlcmVuY2VXaWRnZXQobWF0Y2hbMF0sIHZpZXcsIHBvcyksXG5cdH0pO1xuXHRyZXR1cm4gZGVjb3JhdGlvbjtcbn07XG5cbmNvbnN0IHJlZmVyZW5jZU1hdGNoZXIgPSBuZXcgTWF0Y2hEZWNvcmF0b3Ioe1xuXHQvLyByZWdleHA6IC9cXFtcXHUyMTk3XFxdXFwodXJuOltcXHNcXFNeXFwpXSpcXCkvZyxcblx0Ly8gcmVnZXhwOiAvXFxbXFx1MjE5N1xcXVxcKHVybjooW146XSo6KXs1LDZ9W146XSpcXCkvZyxcblx0Ly8gcmVnZXhwOiAvXFxbXFx1MjE5N1xcXVxcKHVybjooW146XSo6KXs2fVteOildKlxcKS9nLFxuXHRyZWdleHA6IC9cXFtcXHUyMTk3XFxdXFwodXJuOihbXjpdKjopezd9W146KV0qXFwpL2csXG5cdGRlY29yYXRpb246IChtYXRjaCwgdmlldywgcG9zKSA9PiB7XG5cdFx0cmV0dXJuIHJlZmVyZW5jZURlY29yYXRpb24obWF0Y2gsIHZpZXcsIHBvcyk7XG5cdH0sXG59KTtcblxuZXhwb3J0IGNvbnN0IHJlZmVyZW5jZVJlc291cmNlcyA9IFZpZXdQbHVnaW4uZnJvbUNsYXNzKFxuXHRjbGFzcyB7XG5cdFx0cmVmZXJlbmNlUmVzb3VyY2VzOiBEZWNvcmF0aW9uU2V0O1xuXHRcdGNvbnN0cnVjdG9yKHZpZXc6IEVkaXRvclZpZXcpIHtcblx0XHRcdHRoaXMucmVmZXJlbmNlUmVzb3VyY2VzID0gcmVmZXJlbmNlTWF0Y2hlci5jcmVhdGVEZWNvKHZpZXcpO1xuXHRcdH1cblx0XHR1cGRhdGUodXBkYXRlOiBWaWV3VXBkYXRlKSB7XG5cdFx0XHR0aGlzLnJlZmVyZW5jZVJlc291cmNlcyA9IHJlZmVyZW5jZU1hdGNoZXIudXBkYXRlRGVjbyhcblx0XHRcdFx0dXBkYXRlLFxuXHRcdFx0XHR0aGlzLnJlZmVyZW5jZVJlc291cmNlc1xuXHRcdFx0KTtcblx0XHR9XG5cdFx0ZGVzdHJveSgpIHtcblx0XHRcdHRoaXMucmVmZXJlbmNlUmVzb3VyY2VzID0gRGVjb3JhdGlvbi5ub25lO1xuXHRcdH1cblx0fSxcblx0e1xuXHRcdGRlY29yYXRpb25zOiAoaW5zdGFuY2UpID0+IGluc3RhbmNlLnJlZmVyZW5jZVJlc291cmNlcyxcblx0XHRwcm92aWRlOiAocGx1Z2luKSA9PlxuXHRcdFx0RWRpdG9yVmlldy5hdG9taWNSYW5nZXMub2YoKHZpZXcpID0+IHtcblx0XHRcdFx0cmV0dXJuIHZpZXcucGx1Z2luKHBsdWdpbik/LnJlZmVyZW5jZVJlc291cmNlcyB8fCBEZWNvcmF0aW9uLm5vbmU7XG5cdFx0XHR9KSxcblx0fVxuKTtcbiIsICJpbXBvcnQgeyBFZGl0b3IsIFRGaWxlLCBXb3Jrc3BhY2VMZWFmLCBNYXJrZG93blZpZXcgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IEVkaXRvclZpZXcgfSBmcm9tIFwiQGNvZGVtaXJyb3Ivdmlld1wiO1xuaW1wb3J0IHsgdjUgYXMgdXVpZHY1IH0gZnJvbSBcInV1aWRcIjtcblxuaW1wb3J0IHtcblx0dXBkYXRlSG92ZXIsXG5cdGdldFRoYXQsXG5cdGdldEJhY2tsaW5rcyxcblx0Z2V0SG92ZXIsXG5cdHVwZGF0ZUJhY2tsaW5rSG92ZXIsXG5cdGdldEJhY2tsaW5rSG92ZXIsXG5cdHVwZGF0ZUJhY2tsaW5rcyxcbn0gZnJvbSBcIi4vc3RhdGVcIjtcbmltcG9ydCB7XG5cdHByb2Nlc3NVUkksXG5cdGdldFByZWZpeEFuZFN1ZmZpeCxcblx0ZW5jb2RlVVJJQ29tcG9uZW50U3RyaW5nLFxuXHRkZWNvZGVVUklDb21wb25lbnRTdHJpbmcsXG59IGZyb20gXCIuL3V0aWxzXCI7XG5pbXBvcnQge1xuXHRQT1JUQUxfVEVYVF9TTElDRV9TSVpFLFxuXHRSRUZFUkVOQ0VfUkVHRVgsXG5cdFNWR19IT1ZFUl9DT0xPUixcbn0gZnJvbSBcIi4vY29uc3RhbnRzXCI7XG5pbXBvcnQgeyBEb2N1bWVudExvY2F0aW9uLCBCYWNrbGluayB9IGZyb20gXCIuL3R5cGVzXCI7XG5pbXBvcnQgeyB2NCBhcyB1dWlkdjQgfSBmcm9tIFwidXVpZFwiO1xuaW1wb3J0IHsgZGVsYXkgfSBmcm9tIFwiLi9lZmZlY3RzXCI7XG5pbXBvcnQgeyBkZWZhdWx0SGlnaGxpZ2h0U2VsZWN0aW9uIH0gZnJvbSBcIi4vbWFya1wiO1xuXG5leHBvcnQgZnVuY3Rpb24gZ2VuZXJhdGVEZWZhdWx0SGlnaGxpZ2h0cyhsZWFmOiBXb3Jrc3BhY2VMZWFmKSB7XG5cdGNvbnN0IGVkaXRvciA9IGdldE1hcmtkb3duVmlldyhsZWFmKS5lZGl0b3I7XG5cdGNvbnN0IGJhY2tsaW5rQ29udGFpbmVyID0gZ2V0QmFja2xpbmtDb250YWluZXIoZWRpdG9yKTtcblx0bGV0IGVkaXRvclZpZXcgPSBnZXRDb2RlTWlycm9yRWRpdG9yVmlldyhlZGl0b3IpO1xuXG5cdGxldCBiYWNrbGlua3MgPSBbXTtcblx0Zm9yIChsZXQgaSA9IDA7IGkgPCBiYWNrbGlua0NvbnRhaW5lci5jaGlsZHJlbi5sZW5ndGg7IGkrKykge1xuXHRcdGJhY2tsaW5rcy5wdXNoKGJhY2tsaW5rQ29udGFpbmVyLmNoaWxkcmVuLml0ZW0oaSkgYXMgSFRNTEVsZW1lbnQpO1xuXHR9XG5cblx0Zm9yIChsZXQgYmFja2xpbmsgb2YgYmFja2xpbmtzKSB7XG5cdFx0bGV0IHJlZmVyZW5jZSA9IGJhY2tsaW5rLmdldEF0dHJpYnV0ZShcInJlZmVyZW5jZVwiKVxuXHRcdFx0PyBKU09OLnBhcnNlKGJhY2tsaW5rLmdldEF0dHJpYnV0ZShcInJlZmVyZW5jZVwiKSEpXG5cdFx0XHQ6IG51bGw7XG5cdFx0aWYgKHJlZmVyZW5jZSkge1xuXHRcdFx0bGV0IHJlZmVyZW5jZUZyb20gPSByZWZlcmVuY2UucmVmZXJlbmNlZExvY2F0aW9uLmZyb207XG5cdFx0XHRsZXQgcmVmZXJlbmNlVG8gPSByZWZlcmVuY2UucmVmZXJlbmNlZExvY2F0aW9uLnRvO1xuXG5cdFx0XHRkZWZhdWx0SGlnaGxpZ2h0U2VsZWN0aW9uKGVkaXRvclZpZXcsIHJlZmVyZW5jZUZyb20sIHJlZmVyZW5jZVRvKTtcblx0XHR9XG5cdH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVJlZmVyZW5jZUljb24oXG5cdHBvcnRhbFRleHQ6IHN0cmluZyB8IG51bGwgPSBudWxsXG4pOiBIVE1MU3BhbkVsZW1lbnQge1xuXHRjb25zdCBzcGFuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XG5cdHNwYW4uc3R5bGUuY3Vyc29yID0gXCJwb2ludGVyXCI7XG5cdHNwYW4uY2xhc3NMaXN0LmFkZChcInJlZmVyZW5jZS1kYXRhLXNwYW5cIik7XG5cdHNwYW4uY2xhc3NMaXN0LmFkZChcInV1aWQtXCIgKyB1dWlkdjQoKSk7XG5cblx0aWYgKHBvcnRhbFRleHQgPT0gbnVsbCkge1xuXHRcdHJldHVybiBzcGFuO1xuXHR9XG5cblx0aWYgKHBvcnRhbFRleHQgIT0gXCJpbmxpbmUgcmVmZXJlbmNlIHdpZGdldCB8KnxcIikge1xuXHRcdGxldCBwb3J0YWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXHRcdHBvcnRhbC5jbGFzc0xpc3QuYWRkKFwicG9ydGFsXCIpO1xuXG5cdFx0cG9ydGFsVGV4dC5zcGxpdChcIjpcIikuZm9yRWFjaCgodGV4dCwgaW5kZXgpID0+IHtcblx0XHRcdGlmIChpbmRleCA9PT0gMCB8fCBpbmRleCA9PT0gMilcblx0XHRcdFx0cG9ydGFsLmlubmVySFRNTCArPSBkZWNvZGVVUklDb21wb25lbnRTdHJpbmcodGV4dCk7XG5cdFx0XHRlbHNlIGlmIChpbmRleCA9PT0gMSkge1xuXHRcdFx0XHRwb3J0YWwuaW5uZXJIVE1MICs9IGA8c3BhbiBjbGFzcz1cInRleHQtYWNjZW50XCI7PiR7dGV4dH08L3NwYW4+YDtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHBvcnRhbC5zdHlsZS51c2VyU2VsZWN0ID0gXCJub25lXCI7XG5cdFx0cG9ydGFsLnN0eWxlLnBvaW50ZXJFdmVudHMgPSBcIm5vbmVcIjtcblx0XHRzcGFuLmFwcGVuZENoaWxkKHBvcnRhbCk7XG5cdH1cblxuXHRyZXR1cm4gc3Bhbjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldENvZGVNaXJyb3JFZGl0b3JWaWV3KGVkaXRvcjogRWRpdG9yKTogRWRpdG9yVmlldyB7XG5cdC8vIEB0cy1pZ25vcmUgdGhpcyB0eXBlIGlzIG1pc3NpbmcuLi4gYnV0IHRoZSBPYnNpZGlhbiBkb2NzIHRlbGwgdXMgdG8gZG8gaXQgdGhpcyB3YXk/P1xuXHRyZXR1cm4gZWRpdG9yLmNtIGFzIEVkaXRvclZpZXc7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDb250YWluZXJFbGVtZW50KFxuXHRlZGl0b3JPckxlYWY6IEVkaXRvciB8IFdvcmtzcGFjZUxlYWZcbik6IEhUTUxFbGVtZW50IHtcblx0Ly8gQHRzLWlnbm9yZSBUT0RPOiBmaW5kIGEgYmV0dGVyIHdheSB0byBhY2Nlc3MgdGhpcy4uLiBFWFRSRU1FTFkgU0tFVENIWVxuXHRyZXR1cm4gZWRpdG9yT3JMZWFmLmNvbnRhaW5lckVsO1xufVxuXG5mdW5jdGlvbiBnZXRCYWNrbGlua0lEKGJhY2tsaW5rOiBCYWNrbGluayk6IHN0cmluZyB7XG5cdGNvbnN0IGpzb25TdHJpbmcgPSBKU09OLnN0cmluZ2lmeShiYWNrbGluayk7XG5cdGNvbnN0IGlkID0gdXVpZHY1KGpzb25TdHJpbmcsIFwiZmI4MTNlYmItMWI1My00MzA2LWFhOWMtNjU1NjI3NDQ3ZjBiXCIpO1xuXHRyZXR1cm4gYGJhY2tsaW5rLSR7aWR9YDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEJhY2tsaW5rQ29udGFpbmVyKGVkaXRvcjogRWRpdG9yKTogSFRNTEVsZW1lbnQge1xuXHRjb25zdCBjb250YWluZXJFbDogSFRNTEVsZW1lbnQgPSBnZXRDb250YWluZXJFbGVtZW50KGVkaXRvcik7XG5cdGNvbnN0IHJlZmVyZW5jZU1hcmtDb250YWluZXJJRCA9IFwicmVmZXJlbmNlTWFya0NvbnRhaW5lclwiO1xuXHRjb25zdCBjb250YWluZXIgPSBjb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKGAjJHtyZWZlcmVuY2VNYXJrQ29udGFpbmVySUR9YCk7XG5cdGlmIChjb250YWluZXIpIHtcblx0XHRyZXR1cm4gY29udGFpbmVyIGFzIEhUTUxFbGVtZW50O1xuXHR9IGVsc2Uge1xuXHRcdGNvbnN0IG5ld0NvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0bmV3Q29udGFpbmVyLmlkID0gcmVmZXJlbmNlTWFya0NvbnRhaW5lcklEO1xuXHRcdGNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoXCIuY20tc2Nyb2xsZXJcIikhLmFwcGVuZENoaWxkKG5ld0NvbnRhaW5lcik7XG5cdFx0cmV0dXJuIG5ld0NvbnRhaW5lcjtcblx0fVxufVxuXG5mdW5jdGlvbiBnZXRSZWZlcmVuY2VNYXJrcyhlZGl0b3I6IEVkaXRvcik6IEhUTUxFbGVtZW50W10ge1xuXHRjb25zdCBjb250YWluZXIgPSBnZXRCYWNrbGlua0NvbnRhaW5lcihlZGl0b3IpO1xuXHRjb25zdCBlbGVtZW50czogSFRNTEVsZW1lbnRbXSA9IFtdO1xuXHRmb3IgKGxldCBpID0gMDsgaSA8IGNvbnRhaW5lci5jaGlsZHJlbi5sZW5ndGg7IGkrKykge1xuXHRcdGVsZW1lbnRzLnB1c2goY29udGFpbmVyLmNoaWxkcmVuLml0ZW0oaSkgYXMgSFRNTEVsZW1lbnQpO1xuXHR9XG5cdHJldHVybiBlbGVtZW50cztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldExlYWZCQm94RWxlbWVudHMobGVhZjogV29ya3NwYWNlTGVhZikge1xuXHRjb25zdCB0aXRsZSA9IGdldENvbnRhaW5lckVsZW1lbnQobGVhZikucXVlcnlTZWxlY3RvcihcIi5pbmxpbmUtdGl0bGVcIik7XG5cdGlmICghdGl0bGUpIHtcblx0XHR0aHJvdyBuZXcgRXJyb3IoXCJNaXNzaW5nIHRpdGxlXCIpO1xuXHR9XG5cdGNvbnN0IHRpdGxlQmJveCA9IHRpdGxlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXHRjb25zdCBsaW5lID0gZ2V0Q29udGFpbmVyRWxlbWVudChsZWFmKS5xdWVyeVNlbGVjdG9yKFwiLmNtLWxpbmVcIik7XG5cdGlmICghbGluZSkge1xuXHRcdHRocm93IG5ldyBFcnJvcihcIkRvY3VtZW50IGhhcyBubyBsaW5lc1wiKTtcblx0fVxuXHRjb25zdCBsaW5lQmJveCA9IGxpbmUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cblx0cmV0dXJuIHsgdGl0bGVCYm94LCBsaW5lQmJveCB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbGF5b3V0QmFja2xpbmtzKFxuXHRsZWFmOiBXb3Jrc3BhY2VMZWFmLFxuXHRiYWNrbGlua3NUb0xlYWY6IEJhY2tsaW5rW10sXG5cdHNob3dQb3J0YWxzOiBib29sZWFuXG4pIHtcblx0Y29uc3QgZWRpdG9yID0gZ2V0TWFya2Rvd25WaWV3KGxlYWYpLmVkaXRvcjtcblx0Y29uc3QgYmFja2xpbmtDb250YWluZXIgPSBnZXRCYWNrbGlua0NvbnRhaW5lcihlZGl0b3IpO1xuXG5cdGxldCBiYWNrbGlua3MgPSBbXTtcblx0Zm9yIChsZXQgaSA9IDA7IGkgPCBiYWNrbGlua0NvbnRhaW5lci5jaGlsZHJlbi5sZW5ndGg7IGkrKykge1xuXHRcdGJhY2tsaW5rcy5wdXNoKGJhY2tsaW5rQ29udGFpbmVyLmNoaWxkcmVuLml0ZW0oaSkgYXMgSFRNTEVsZW1lbnQpO1xuXHR9XG5cdGxldCBiYWNrbGlua0lkczogc3RyaW5nW10gPSBiYWNrbGlua3NUb0xlYWYubWFwKCh4KSA9PiBnZXRCYWNrbGlua0lEKHgpKTtcblxuXHRiYWNrbGlua3Ncblx0XHQubWFwKCh4OiBIVE1MU3BhbkVsZW1lbnQpID0+IHguaWQpXG5cdFx0LmZvckVhY2goKGlkKSA9PiB7XG5cdFx0XHRpZiAoIWJhY2tsaW5rSWRzLmluY2x1ZGVzKGlkKSkge1xuXHRcdFx0XHRsZXQgZWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTtcblx0XHRcdFx0aWYgKGVsZW1lbnQpIGVsZW1lbnQucmVtb3ZlKCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0Y29uc3QgeyB0aXRsZUJib3gsIGxpbmVCYm94IH0gPSBnZXRMZWFmQkJveEVsZW1lbnRzKGxlYWYpO1xuXG5cdC8vIENyZWF0ZSB0aGUgaW5pdGlhbCBiYWNrbGluayBtYXJrIGlmIG5lY2Vzc2FyeSBhbmQgcG9zaXRpb24gaXQgaW4gdGhlIGNvcnJlY3QgdmVydGljYWwgcG9zaXRpb25cblx0bGV0IHJlZmVyZW5jZU1hcmtlcnMgPSBiYWNrbGlua3NUb0xlYWYubWFwKChiYWNrbGluaykgPT4ge1xuXHRcdGNvbnN0IHsgZnJvbSB9ID0gYmFja2xpbmsucmVmZXJlbmNlZExvY2F0aW9uO1xuXG5cdFx0Y29uc3QgYmJveCA9IGdldENvZGVNaXJyb3JFZGl0b3JWaWV3KGVkaXRvcikuY29vcmRzQXRQb3MoZnJvbSk7XG5cdFx0aWYgKCFiYm94KSByZXR1cm47XG5cblx0XHRsZXQgcmVmZXJlbmNlTWFya2VyID0gYmFja2xpbmtDb250YWluZXIucXVlcnlTZWxlY3Rvcihcblx0XHRcdGAjJHtnZXRCYWNrbGlua0lEKGJhY2tsaW5rKX1gXG5cdFx0KSBhcyBIVE1MRWxlbWVudCB8IG51bGw7XG5cblx0XHRpZiAocmVmZXJlbmNlTWFya2VyID09PSBudWxsKSB7XG5cdFx0XHRyZWZlcmVuY2VNYXJrZXIgPSBjcmVhdGVCYWNrbGlua01hcmsoYmFja2xpbmspO1xuXHRcdFx0YmFja2xpbmtDb250YWluZXIuYXBwZW5kQ2hpbGQocmVmZXJlbmNlTWFya2VyKTtcblx0XHR9XG5cblx0XHRpZiAoYmJveCkge1xuXHRcdFx0cmVmZXJlbmNlTWFya2VyLnN0eWxlLnBvc2l0aW9uID0gXCJhYnNvbHV0ZVwiO1xuXG5cdFx0XHRyZWZlcmVuY2VNYXJrZXIuc2V0QXR0cmlidXRlKFwidG9wXCIsIGJib3gudG9wLnRvU3RyaW5nKCkpO1xuXHRcdFx0cmVmZXJlbmNlTWFya2VyLnN0eWxlLnRvcCA9IGJib3gudG9wIC0gdGl0bGVCYm94LnRvcCArIDMyICsgXCJweFwiO1xuXHRcdFx0cmVmZXJlbmNlTWFya2VyLnN0eWxlLmxlZnQgPSBsaW5lQmJveC53aWR0aCArIDQwICsgXCJweFwiO1xuXHRcdH1cblxuXHRcdHJldHVybiByZWZlcmVuY2VNYXJrZXI7XG5cdH0pO1xuXG5cdC8vIE5vdyBhY2NvdW50IGZvciBwb3NzaWJsZSBwb3NpdGlvbiBvdmVybGFwcyBhbmQgc2hpZnQgZG93bndhcmRzXG5cdC8vIGFsc28gY29uc2lkZXIgd2hldGhlciB0aGUgcG9ydGFscyBzaG91bGQgYmUgc2hvd24gb3Igbm90LlxuXHRsZXQgbGFzdFlCb3R0b20gPSAtSW5maW5pdHk7IC8vIGZvciBsYXJnZSBkb2N1bWVudHMgXHVEODNEXHVERTAxXG5cdGxldCBtYXJnaW4gPSA0O1xuXHRyZWZlcmVuY2VNYXJrZXJzXG5cdFx0LnNvcnQoXG5cdFx0XHQoYSwgYikgPT5cblx0XHRcdFx0cGFyc2VJbnQoYSEuZ2V0QXR0cmlidXRlKFwidG9wXCIpISkgLSBwYXJzZUludChiIS5nZXRBdHRyaWJ1dGUoXCJ0b3BcIikhKVxuXHRcdClcblx0XHQuZm9yRWFjaCgobWFya2VyKSA9PiB7XG5cdFx0XHRpZiAoIW1hcmtlcikgcmV0dXJuO1xuXHRcdFx0Ly8gdG9nZ2xlIHBvcnRhbHNcblx0XHRcdGNvbnN0IHBvcnRhbDogSFRNTEVsZW1lbnQgfCBudWxsID0gbWFya2VyLnF1ZXJ5U2VsZWN0b3IoXCIucG9ydGFsXCIpO1xuXG5cdFx0XHRpZiAoc2hvd1BvcnRhbHMpIHtcblx0XHRcdFx0aWYgKHBvcnRhbCkge1xuXHRcdFx0XHRcdHBvcnRhbC5zdHlsZS5kaXNwbGF5ID0gXCJpbmxpbmVcIjtcblx0XHRcdFx0XHRtYXJrZXIuY2xhc3NMaXN0LmFkZChcImJhY2tsaW5rLXNwYW5cIik7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGlmIChwb3J0YWwpIHtcblx0XHRcdFx0XHRwb3J0YWwuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuXHRcdFx0XHR9XG5cdFx0XHRcdG1hcmtlci5jbGFzc0xpc3QucmVtb3ZlKFwiYmFja2xpbmstc3BhblwiKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gZ2V0IHBvc2l0aW9uaW5nXG5cdFx0XHRsZXQgdG9wID0gcGFyc2VJbnQobWFya2VyIS5nZXRBdHRyaWJ1dGUoXCJ0b3BcIikhKTtcblx0XHRcdHRvcCA9IE1hdGgubWF4KHRvcCwgbGFzdFlCb3R0b20gKyBtYXJnaW4pO1xuXHRcdFx0bGFzdFlCb3R0b20gPSB0b3AgKyBtYXJrZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0ICsgbWFyZ2luO1xuXHRcdFx0bWFya2VyLnNldEF0dHJpYnV0ZShcInRvcFwiLCB0b3AudG9TdHJpbmcoKSk7XG5cdFx0XHRtYXJrZXIuc3R5bGUudG9wID0gdG9wIC0gdGl0bGVCYm94LnRvcCArIDMyICsgXCJweFwiO1xuXHRcdFx0bWFya2VyLnN0eWxlLmxlZnQgPSBsaW5lQmJveC53aWR0aCArIDQwICsgXCJweFwiO1xuXHRcdH0pO1xufVxuXG5sZXQgZGVib3VuY2VUaW1lcjogTm9kZUpTLlRpbWVvdXQ7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVCYWNrbGlua01hcmtQb3NpdGlvbnMoKSB7XG5cdGNsZWFyVGltZW91dChkZWJvdW5jZVRpbWVyKTtcblx0ZGVib3VuY2VUaW1lciA9IHNldFRpbWVvdXQoYXN5bmMgKCkgPT4ge1xuXHRcdGNvbnNvbGUubG9nKFwidXBkYXRlYmFja2xpbmttYXJrcG9zaXRpb25zXCIpO1xuXHRcdGNvbnN0IGxlYXZlcyA9IGdldFRoYXQoKS53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFxuXHRcdFx0XCJtYXJrZG93blwiXG5cdFx0KSBhcyBXb3Jrc3BhY2VMZWFmW107XG5cblx0XHRsZXQgYWxsQmFja2xpbmtzOiBCYWNrbGlua1tdID0gZ2V0QmFja2xpbmtzKCk7XG5cblx0XHQvLyBjb25zb2xlLmxvZyhnZXRCYWNrbGlua3MoKSk7XG5cdFx0Ly8gaWYgKCFiYWNrbGlua3MpIGFsbEJhY2tsaW5rcyA9IGF3YWl0IGdlbmVyYXRlQmFja2xpbmtzKCk7XG5cdFx0Ly8gZWxzZSBhbGxCYWNrbGlua3MgPSBiYWNrbGlua3M7XG5cdFx0Ly8gY29uc29sZS5sb2coYWxsQmFja2xpbmtzKTtcblxuXHRcdC8vIGNvbnN0IGFsbEJhY2tsaW5rczogQmFja2xpbmtbXSA9IGF3YWl0IGdlbmVyYXRlQmFja2xpbmtzKCk7XG5cblx0XHQvLyBsZWF2ZXMubWFwKGFzeW5jIChsZWFmKSA9PiB7XG5cdFx0Ly8gXHRjb25zdCBiYWNrbGlua3NUb0xlYWYgPSBhbGxCYWNrbGlua3MuZmlsdGVyKFxuXHRcdC8vIFx0XHQvLyBAdHMtaWdub3JlXG5cdFx0Ly8gXHRcdChiKSA9PiBiLnJlZmVyZW5jZWRMb2NhdGlvbi5maWxlbmFtZSA9PSBsZWFmLnZpZXcuZmlsZS5wYXRoXG5cdFx0Ly8gXHQpO1xuXHRcdC8vIFx0Ly8gd2lkdGggOTAwLCBzaG93IHRoZSByZWZlcmVuY2Vcblx0XHQvLyBcdGNvbnN0IHNob3dQb3J0YWxzID0gZ2V0Q29udGFpbmVyRWxlbWVudChsZWFmKS5pbm5lcldpZHRoID4gOTAwO1xuXHRcdC8vIFx0bGF5b3V0QmFja2xpbmtzKGxlYWYsIGJhY2tsaW5rc1RvTGVhZiwgc2hvd1BvcnRhbHMpO1xuXHRcdC8vIH0pO1xuXHRcdGxlYXZlcy5tYXAoYXN5bmMgKGxlYWYpID0+IHtcblx0XHRcdGxldCBmaWxlID0gZ2V0TWFya2Rvd25WaWV3KGxlYWYpPy5maWxlO1xuXHRcdFx0aWYgKGZpbGUpIHtcblx0XHRcdFx0Y29uc3QgYmFja2xpbmtzVG9MZWFmID0gYWxsQmFja2xpbmtzLmZpbHRlcihcblx0XHRcdFx0XHQvLyBAdHMtaWdub3JlXG5cdFx0XHRcdFx0KGIpID0+IGIucmVmZXJlbmNlZExvY2F0aW9uLmZpbGVuYW1lID09IGZpbGUucGF0aFxuXHRcdFx0XHQpO1xuXHRcdFx0XHQvLyB3aWR0aCA5MDAsIHNob3cgdGhlIHJlZmVyZW5jZVxuXHRcdFx0XHRjb25zdCBzaG93UG9ydGFscyA9IGdldENvbnRhaW5lckVsZW1lbnQobGVhZikuaW5uZXJXaWR0aCA+IDkwMDtcblx0XHRcdFx0bGF5b3V0QmFja2xpbmtzKGxlYWYsIGJhY2tsaW5rc1RvTGVhZiwgc2hvd1BvcnRhbHMpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0Ly8gc2V0VGltZW91dChhc3luYyAoKSA9PiB7XG5cblx0XHQvLyBcdC8vIGF3YWl0IFByb21pc2UuYWxsKCk7XG5cdFx0Ly8gfSwgMTAwMCk7IC8vIHdhbnQgdG8gZW5zdXJlIGZpbGUgd3JpdGUgaGFzIGhhcHBlbmVkXG5cdH0sIDEwMCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVCYWNrbGlua01hcmsoYmFja2xpbms6IEJhY2tsaW5rKTogSFRNTEVsZW1lbnQge1xuXHRsZXQgc3BhbiA9IGNyZWF0ZVJlZmVyZW5jZUljb24oYmFja2xpbmsucG9ydGFsVGV4dCk7XG5cdHNwYW4uY2xhc3NMaXN0LmFkZChcImJhY2tsaW5rLWRhdGEtc3BhblwiKTtcblxuXHRjb25zdCBwb3J0YWw6IEhUTUxFbGVtZW50IHwgbnVsbCA9IHNwYW4ucXVlcnlTZWxlY3RvcihcIi5wb3J0YWxcIik7XG5cblx0c3Bhbi5zdHlsZS5wb3NpdGlvbiA9IFwiYWJzb2x1dGVcIjtcblxuXHRzcGFuLmlkID0gZ2V0QmFja2xpbmtJRChiYWNrbGluayk7XG5cdHNwYW4uc2V0QXR0cmlidXRlKFwicmVmZXJlbmNlXCIsIEpTT04uc3RyaW5naWZ5KGJhY2tsaW5rKSk7XG5cblx0Y29uc3QgcmVzaXplT2JzZXJ2ZXIgPSBuZXcgUmVzaXplT2JzZXJ2ZXIoKGVudHJpZXMpID0+IHtcblx0XHRpZiAocG9ydGFsICYmIHBvcnRhbC5zdHlsZS5kaXNwbGF5ICE9IFwibm9uZVwiKSB7XG5cdFx0XHQvLyBzcGFuLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwid2hpdGVcIjtcblx0XHRcdHNwYW4uY2xhc3NMaXN0LmFkZChcImJhY2tsaW5rLXBvcnRhbC1vcGVuXCIpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBzcGFuLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiXCI7XG5cdFx0XHRzcGFuLmNsYXNzTGlzdC5yZW1vdmUoXCJiYWNrbGluay1wb3J0YWwtb3BlblwiKTtcblx0XHR9XG5cdH0pO1xuXG5cdC8vIFN0YXJ0IG9ic2VydmluZyBhbiBlbGVtZW50XG5cdHJlc2l6ZU9ic2VydmVyLm9ic2VydmUoc3Bhbik7XG5cblx0c3Bhbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgb3BlbkJhY2tsaW5rUmVmZXJlbmNlKTtcblxuXHRyZXR1cm4gc3Bhbjtcbn1cblxuLy8gS2VlcCB0cmFjayBvZiB0aGUgZXhpc3Rpbmcgb2JzZXJ2ZXIgYW5kIGxpc3RlbmVyXG5sZXQgZXhpc3RpbmdPYnNlcnZlcjogUmVzaXplT2JzZXJ2ZXIgfCBudWxsID0gbnVsbDtcbmxldCBleGlzdGluZ0xpc3RlbmVyOiAoKGV2OiBFdmVudCkgPT4gYW55KSB8IG51bGwgPSBudWxsO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYWRkUmVmZXJlbmNlc1RvTGVhZihsZWFmOiBXb3Jrc3BhY2VMZWFmKSB7XG5cdGNvbnNvbGUubG9nKFwiYWRkIHJlZmVyZW5jZXMgdG8gbGVhZlwiKTtcblx0YXdhaXQgdXBkYXRlQmFja2xpbmtNYXJrUG9zaXRpb25zKCk7XG5cdGF3YWl0IGRlbGF5KDEwMDApO1xuXHRjb25zb2xlLmxvZyhcImluaXRpYWwgbG9hZFwiKTtcblx0Z2VuZXJhdGVEZWZhdWx0SGlnaGxpZ2h0cyhsZWFmKTtcblxuXHQvLyBjb25zdCBzY3JvbGxlciA9IGdldENvbnRhaW5lckVsZW1lbnQobWFya2Rvd25WaWV3LmVkaXRvcikucXVlcnlTZWxlY3Rvcihcblx0Ly8gXHRcIi5jbS1zY3JvbGxlclwiXG5cdC8vICkhO1xuXG5cdC8vIC8vIFJlbW92ZSB0aGUgZXhpc3RpbmcgbGlzdGVuZXIgYmVmb3JlIGFkZGluZyBhIG5ldyBvbmVcblx0Ly8gaWYgKGV4aXN0aW5nTGlzdGVuZXIpIHtcblx0Ly8gXHRzY3JvbGxlci5yZW1vdmVFdmVudExpc3RlbmVyKFwic2Nyb2xsXCIsIGV4aXN0aW5nTGlzdGVuZXIpO1xuXHQvLyB9XG5cblx0Ly8gY29uc3QgbmV3TGlzdGVuZXIgPSBhc3luYyAoZXY6IEV2ZW50KSA9PiB7XG5cdC8vIFx0YXdhaXQgdXBkYXRlQmFja2xpbmtNYXJrUG9zaXRpb25zKCk7XG5cdC8vIFx0YXdhaXQgZGVsYXkoMjAwMCk7XG5cdC8vIFx0Y29uc29sZS5sb2coXCJzY3JvbGwgbG9hZFwiKTtcblxuXHQvLyBcdGdlbmVyYXRlRGVmYXVsdEhpZ2hsaWdodHMobGVhZik7XG5cdC8vIH07XG5cblx0Ly8gc2Nyb2xsZXIuYWRkRXZlbnRMaXN0ZW5lcihcInNjcm9sbFwiLCBuZXdMaXN0ZW5lcik7XG5cblx0Ly8gLy8gVXBkYXRlIHRoZSBleGlzdGluZyBsaXN0ZW5lclxuXHQvLyBleGlzdGluZ0xpc3RlbmVyID0gbmV3TGlzdGVuZXI7XG5cblx0Ly8gUmVtb3ZlIHRoZSBleGlzdGluZyBvYnNlcnZlciBiZWZvcmUgY3JlYXRpbmcgYSBuZXcgb25lXG5cdGlmIChleGlzdGluZ09ic2VydmVyKSB7XG5cdFx0ZXhpc3RpbmdPYnNlcnZlci5kaXNjb25uZWN0KCk7XG5cdH1cblxuXHRjb25zdCBuZXdPYnNlcnZlciA9IG5ldyBSZXNpemVPYnNlcnZlcihhc3luYyAoKSA9PiB7XG5cdFx0YXdhaXQgdXBkYXRlQmFja2xpbmtNYXJrUG9zaXRpb25zKCk7XG5cdFx0YXdhaXQgZGVsYXkoMTAwMCk7XG5cdFx0Y29uc29sZS5sb2coXCJyZXNpemUgbG9hZFwiKTtcblx0XHRnZW5lcmF0ZURlZmF1bHRIaWdobGlnaHRzKGxlYWYpO1xuXHR9KTtcblxuXHRjb25zdCBtYXJrZG93blZpZXcgPSBnZXRNYXJrZG93blZpZXcobGVhZik7XG5cdGxldCB3b3Jrc3BhY2VUYWJzID0gbWFya2Rvd25WaWV3LmNvbnRhaW5lckVsLmNsb3Nlc3QoXCIud29ya3NwYWNlLXRhYnNcIik7XG5cdGlmICghd29ya3NwYWNlVGFicykge1xuXHRcdHRocm93IG5ldyBFcnJvcihcIk1pc3Npbmcgd29ya3NwYWNlIHRhYnNcIik7XG5cdH1cblxuXHRuZXdPYnNlcnZlci5vYnNlcnZlKHdvcmtzcGFjZVRhYnMpO1xuXG5cdC8vIFVwZGF0ZSB0aGUgZXhpc3Rpbmcgb2JzZXJ2ZXJcblx0ZXhpc3RpbmdPYnNlcnZlciA9IG5ld09ic2VydmVyO1xuXG5cdHJldHVybiBsZWFmO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0TWFya2Rvd25WaWV3KGxlYWY6IFdvcmtzcGFjZUxlYWYpOiBNYXJrZG93blZpZXcge1xuXHRpZiAoIShsZWFmLnZpZXcgaW5zdGFuY2VvZiBNYXJrZG93blZpZXcpKSB7XG5cdFx0dGhyb3cgbmV3IEVycm9yKFwiVW5leHBlY3RlZCBub24tbWFya2Rvd24gdmlld1wiKTtcblx0fVxuXHRyZXR1cm4gbGVhZi52aWV3IGFzIE1hcmtkb3duVmlldztcbn1cblxuZnVuY3Rpb24gZ2V0RmlsZW5hbWUobGVhZjogV29ya3NwYWNlTGVhZik6IHN0cmluZyB7XG5cdGNvbnN0IHsgZmlsZSB9ID0gZ2V0TWFya2Rvd25WaWV3KGxlYWYpO1xuXHRpZiAoIWZpbGUpIHtcblx0XHR0aHJvdyBuZXcgRXJyb3IoXCJVbmV4cGVjdGVkIG1pc3NpbmcgZmlsZVwiKTtcblx0fVxuXHRyZXR1cm4gZmlsZS5uYW1lO1xufVxuXG5mdW5jdGlvbiBmaW5kTWF0Y2hQb3NpdGlvbnMobGluZTogc3RyaW5nLCByZWdleDogUmVnRXhwKSB7XG5cdGxldCBtYXRjaDtcblx0Y29uc3QgcG9zaXRpb25zID0gW107XG5cdHdoaWxlICgobWF0Y2ggPSByZWdleC5leGVjKGxpbmUpKSAhPT0gbnVsbCkge1xuXHRcdHBvc2l0aW9ucy5wdXNoKHtcblx0XHRcdG1hdGNoOiBtYXRjaFswXSxcblx0XHRcdHN0YXJ0OiBtYXRjaC5pbmRleCxcblx0XHRcdGVuZDogbWF0Y2guaW5kZXggKyBtYXRjaFswXS5sZW5ndGgsXG5cdFx0fSk7XG5cdH1cblx0cmV0dXJuIHBvc2l0aW9ucztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUJhY2tsaW5rRGF0YShcblx0cmVmZXJlbmNpbmdGaWxlRGF0YTogc3RyaW5nLFxuXHRyZWZlcmVuY2luZ0ZpbGU6IFRGaWxlXG4pOiBCYWNrbGlua1tdIHtcblx0bGV0IGJhY2tsaW5rczogQmFja2xpbmtbXSA9IFtdO1xuXG5cdGxldCBtYXRjaGVzID0gWy4uLnJlZmVyZW5jaW5nRmlsZURhdGEubWF0Y2hBbGwoUkVGRVJFTkNFX1JFR0VYKV07XG5cdG1hdGNoZXMuZm9yRWFjaCgobWF0Y2gpID0+IHtcblx0XHRpZiAobWF0Y2hbMV0uc3BsaXQoXCI6XCIpLmxlbmd0aCAhPSA4KSByZXR1cm47XG5cdFx0bGV0IFtwcmVmaXgsIHRleHQsIHN1ZmZpeCwgZmlsZW5hbWUsIGZyb20sIHRvLCBwb3J0YWwsIHRvZ2dsZV0gPSBwcm9jZXNzVVJJKFxuXHRcdFx0bWF0Y2hbMV1cblx0XHQpO1xuXG5cdFx0Y29uc3QgcmVmZXJlbmNlZExvY2F0aW9uOiBEb2N1bWVudExvY2F0aW9uID0ge1xuXHRcdFx0cHJlZml4LFxuXHRcdFx0dGV4dCxcblx0XHRcdHN1ZmZpeCxcblx0XHRcdGZpbGVuYW1lLFxuXHRcdFx0ZnJvbSxcblx0XHRcdHRvLFxuXHRcdFx0cG9ydGFsLFxuXHRcdFx0dG9nZ2xlLFxuXHRcdH07XG5cblx0XHRsZXQgaW5kZXggPSByZWZlcmVuY2luZ0ZpbGVEYXRhLmluZGV4T2YobWF0Y2hbMF0pO1xuXG5cdFx0Y29uc3QgcmVmZXJlbmNpbmdTdXJyb3VuZGluZ1N0cmluZ3MgPSBnZXRQcmVmaXhBbmRTdWZmaXgoXG5cdFx0XHRyZWZlcmVuY2luZ0ZpbGVEYXRhLFxuXHRcdFx0aW5kZXgsXG5cdFx0XHRpbmRleCArIG1hdGNoWzBdLmxlbmd0aFxuXHRcdCk7XG5cblx0XHRjb25zdCByZWZlcmVuY2luZ0xvY2F0aW9uOiBEb2N1bWVudExvY2F0aW9uID0ge1xuXHRcdFx0cHJlZml4OiByZWZlcmVuY2luZ1N1cnJvdW5kaW5nU3RyaW5ncy5wcmVmaXgsXG5cdFx0XHR0ZXh0OiByZWZlcmVuY2luZ0ZpbGVEYXRhLnNsaWNlKGluZGV4LCBpbmRleCArIG1hdGNoWzBdLmxlbmd0aCksXG5cdFx0XHRzdWZmaXg6IHJlZmVyZW5jaW5nU3Vycm91bmRpbmdTdHJpbmdzLnN1ZmZpeCxcblx0XHRcdGZpbGVuYW1lOiByZWZlcmVuY2luZ0ZpbGUucGF0aCxcblx0XHRcdGZyb206IG1hdGNoLmluZGV4ISwgLy8gVE9ETyBkbyB3ZWlyZCBzdHJpbmcgZm9ybWF0XG5cdFx0XHR0bzogbWF0Y2guaW5kZXghICsgbWF0Y2hbMF0ubGVuZ3RoLCAvLyBUT0RPIGRvIHdlaXJkIHN0cmluZyBmb3JtYXRcblx0XHRcdHBvcnRhbCxcblx0XHRcdHRvZ2dsZSxcblx0XHR9O1xuXG5cdFx0aWYgKHBvcnRhbCA9PSBcInBvcnRhbFwiKSB7XG5cdFx0XHQvLyBPUiBuby1wb3J0YWxcblxuXHRcdFx0Ly8gZ2V0IGFsbCB0aGUgdGV4dCBmcm9tIHRoZSBzdGFydCBvZiB0aGUgbGluZSB0byB0aGUgZW5kIG9mIHRoZSBsaW5lXG5cdFx0XHRjb25zdCBnZXRMaW5lVGV4dCA9ICh0ZXh0OiBzdHJpbmcsIGluZGV4OiBudW1iZXIpOiBzdHJpbmcgPT4ge1xuXHRcdFx0XHRjb25zdCBzdGFydE9mTGluZSA9IHRleHQubGFzdEluZGV4T2YoXCJcXG5cIiwgaW5kZXggLSAxKSArIDE7XG5cdFx0XHRcdGNvbnN0IGVuZE9mTGluZSA9IHRleHQuaW5kZXhPZihcIlxcblwiLCBpbmRleCk7XG5cdFx0XHRcdHJldHVybiB0ZXh0LnNsaWNlKFxuXHRcdFx0XHRcdHN0YXJ0T2ZMaW5lLFxuXHRcdFx0XHRcdGVuZE9mTGluZSAhPT0gLTEgPyBlbmRPZkxpbmUgOiB1bmRlZmluZWRcblx0XHRcdFx0KTtcblx0XHRcdH07XG5cblx0XHRcdGxldCBsaW5lID0gZ2V0TGluZVRleHQocmVmZXJlbmNpbmdGaWxlRGF0YSwgaW5kZXgpO1xuXHRcdFx0bGV0IG1hdGNoUG9zaXRpb25zID0gZmluZE1hdGNoUG9zaXRpb25zKFxuXHRcdFx0XHRsaW5lLFxuXHRcdFx0XHRuZXcgUmVnRXhwKFJFRkVSRU5DRV9SRUdFWClcblx0XHRcdCk7XG5cblx0XHRcdGxldCBtYXRjaEluZGV4ID0gMDtcblx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgbWF0Y2hQb3NpdGlvbnMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0aWYgKG1hdGNoUG9zaXRpb25zW2ldLm1hdGNoID09IG1hdGNoWzBdKSB7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0bWF0Y2hJbmRleCArPSBtYXRjaFBvc2l0aW9uc1tpXS5lbmQgLSBtYXRjaFBvc2l0aW9uc1tpXS5zdGFydCAtIDE7IC8vIC0xIGJlY2F1c2UgdGhlIGxpbmUgaXMgcmVwbGFjZWQgYnkgYSBzaW5nbGUgY2hhcmFjdGVyXG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0bGV0IHBvcnRhbFRleHQgPSBsaW5lLnJlcGxhY2UobmV3IFJlZ0V4cChSRUZFUkVOQ0VfUkVHRVgsIFwiZ1wiKSwgXCJcdTIxOTdcIik7XG5cdFx0XHRsZXQgcG9ydGFsVGV4dFNsaWNlID0gcG9ydGFsVGV4dC5zbGljZSgwLCBQT1JUQUxfVEVYVF9TTElDRV9TSVpFKTtcblxuXHRcdFx0bGV0IHBvcnRhbFRleHRJbmRleCA9IGxpbmUuaW5kZXhPZihtYXRjaFswXSkgLSBtYXRjaEluZGV4O1xuXG5cdFx0XHQvLyBnZXR0aW5nIHRoZSBwb3J0YWwgdGV4dCBzZWxlY3Rpb24gYXJvdW5kIHRoZSByZWZlcmVuY2Vcblx0XHRcdHBvcnRhbFRleHRTbGljZSA9IFwiXHUyMTk3XCI7XG5cblx0XHRcdGxldCBzdGFydFBvcnRhbFRleHQgPSBwb3J0YWxUZXh0LnN1YnN0cmluZyhcblx0XHRcdFx0TWF0aC5tYXgocG9ydGFsVGV4dEluZGV4IC0gMjUsIDApLFxuXHRcdFx0XHRwb3J0YWxUZXh0SW5kZXhcblx0XHRcdCk7XG5cdFx0XHRpZiAoXG5cdFx0XHRcdHBvcnRhbFRleHQuc3Vic3RyaW5nKE1hdGgubWF4KHBvcnRhbFRleHRJbmRleCAtIDI1LCAwKSwgcG9ydGFsVGV4dEluZGV4KVxuXHRcdFx0XHRcdC5sZW5ndGggPiAwICYmXG5cdFx0XHRcdHBvcnRhbFRleHRJbmRleCAtIDI1ID4gMFxuXHRcdFx0KVxuXHRcdFx0XHRzdGFydFBvcnRhbFRleHQgPSBcIi4uLlwiICsgc3RhcnRQb3J0YWxUZXh0O1xuXG5cdFx0XHRsZXQgZW5kUG9ydGFsVGV4dCA9IHBvcnRhbFRleHQuc3Vic3RyaW5nKFxuXHRcdFx0XHRwb3J0YWxUZXh0SW5kZXggKyAxLFxuXHRcdFx0XHRNYXRoLm1heChwb3J0YWxUZXh0SW5kZXggKyAyNSwgcG9ydGFsVGV4dC5sZW5ndGgpXG5cdFx0XHQpO1xuXHRcdFx0aWYgKFxuXHRcdFx0XHRwb3J0YWxUZXh0LnN1YnN0cmluZyhcblx0XHRcdFx0XHRwb3J0YWxUZXh0SW5kZXggKyAxLFxuXHRcdFx0XHRcdE1hdGgubWF4KHBvcnRhbFRleHRJbmRleCArIDI1LCBwb3J0YWxUZXh0Lmxlbmd0aClcblx0XHRcdFx0KS5sZW5ndGggPiAwICYmXG5cdFx0XHRcdHBvcnRhbFRleHRJbmRleCArIDI1IDwgcG9ydGFsVGV4dC5sZW5ndGhcblx0XHRcdClcblx0XHRcdFx0ZW5kUG9ydGFsVGV4dCA9IGVuZFBvcnRhbFRleHQgKyBcIi4uLlwiO1xuXG5cdFx0XHRiYWNrbGlua3MucHVzaCh7XG5cdFx0XHRcdHJlZmVyZW5jZWRMb2NhdGlvbixcblx0XHRcdFx0cmVmZXJlbmNpbmdMb2NhdGlvbixcblx0XHRcdFx0ZGF0YVN0cmluZzogbWF0Y2hbMV0sXG5cdFx0XHRcdHBvcnRhbFRleHQ6XG5cdFx0XHRcdFx0ZW5jb2RlVVJJQ29tcG9uZW50U3RyaW5nKHN0YXJ0UG9ydGFsVGV4dCkgK1xuXHRcdFx0XHRcdFwiOlwiICtcblx0XHRcdFx0XHRwb3J0YWxUZXh0U2xpY2UgK1xuXHRcdFx0XHRcdFwiOlwiICtcblx0XHRcdFx0XHRlbmNvZGVVUklDb21wb25lbnRTdHJpbmcoZW5kUG9ydGFsVGV4dCksXG5cdFx0XHR9KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0YmFja2xpbmtzLnB1c2goe1xuXHRcdFx0XHRyZWZlcmVuY2VkTG9jYXRpb24sXG5cdFx0XHRcdHJlZmVyZW5jaW5nTG9jYXRpb24sXG5cdFx0XHRcdGRhdGFTdHJpbmc6IG1hdGNoWzFdLFxuXHRcdFx0fSk7XG5cdFx0fVxuXHR9KTtcblx0cmV0dXJuIGJhY2tsaW5rcztcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdlbmVyYXRlQmFja2xpbmtzKCk6IFByb21pc2U8QmFja2xpbmtbXT4ge1xuXHRjb25zb2xlLmxvZyhcImdlbmVyYXRpbmcgcmVmZXJlbmNlc1wiKTtcblx0Ly8gc2V0VGltZW91dChhc3luYyAoKSA9PiB7XG5cdGxldCBiYWNrbGlua3M6IEJhY2tsaW5rW10gPSBbXTtcblx0bGV0IG1hcmtkb3duRmlsZXMgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XG5cblx0YXdhaXQgUHJvbWlzZS5hbGwoXG5cdFx0bWFya2Rvd25GaWxlcy5tYXAoKGZpbGU6IFRGaWxlKSA9PiB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpKVxuXHQpLnRoZW4oKGZpbGVzKSA9PiB7XG5cdFx0Y29uc3QgemlwcGVkQXJyYXkgPSBtYXJrZG93bkZpbGVzLm1hcCgoZmlsZTogVEZpbGUsIGluZGV4OiBudW1iZXIpID0+ICh7XG5cdFx0XHRtYXJrZG93bkZpbGU6IGZpbGUsXG5cdFx0XHRmaWxlRGF0YTogZmlsZXNbaW5kZXhdLFxuXHRcdH0pKTtcblxuXHRcdHppcHBlZEFycmF5LmZvckVhY2goKGZpbGU6IHsgbWFya2Rvd25GaWxlOiBURmlsZTsgZmlsZURhdGE6IHN0cmluZyB9KSA9PiB7XG5cdFx0XHRsZXQgZmlsZUJhY2tsaW5rcyA9IGNyZWF0ZUJhY2tsaW5rRGF0YShmaWxlLmZpbGVEYXRhLCBmaWxlLm1hcmtkb3duRmlsZSk7XG5cdFx0XHR1cGRhdGVCYWNrbGlua3MoZmlsZUJhY2tsaW5rcyk7XG5cblx0XHRcdGJhY2tsaW5rcy5wdXNoKC4uLmZpbGVCYWNrbGlua3MpO1xuXHRcdH0pO1xuXHR9KTtcblx0cmV0dXJuIGJhY2tsaW5rcztcblx0Ly8gfSwgMCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVSZWZlcmVuY2VDb2xvcihzcGFuOiBIVE1MU3BhbkVsZW1lbnQsIHVzZXI6IHN0cmluZykge1xuXHQvLyByZW1vdmUgZXhpc3RpbmcgY3Vyc29yc1xuXHRjb25zdCBwb3J0YWw6IEhUTUxFbGVtZW50IHwgbnVsbCA9IHNwYW4ucXVlcnlTZWxlY3RvcihcIi5wb3J0YWxcIik7XG5cblx0aWYgKHNwYW4gJiYgIXBvcnRhbCkge1xuXHRcdHNwYW4uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gU1ZHX0hPVkVSX0NPTE9SO1xuXHR9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBvcGVuQmFja2xpbmtSZWZlcmVuY2UoZXY6IE1vdXNlRXZlbnQpIHtcblx0bGV0IGhvdmVyID0gZ2V0QmFja2xpbmtIb3ZlcigpO1xuXHRsZXQgbGVhZiA9IGdldFRoYXQoKS53b3Jrc3BhY2UuZ2V0TGVhZkJ5SWQoaG92ZXIubGVhZklkKTtcblxuXHQvLyBAdHMtaWdub3JlXG5cdGxldCBjb250YWluZXIgPSBsZWFmLmNvbnRhaW5lckVsO1xuXHRpZiAoIWNvbnRhaW5lcikgdGhyb3cgbmV3IEVycm9yKFwiQ29udGFpbmVyIG5vdCBmb3VuZFwiKTtcblx0Y29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCIudmlldy1jb250ZW50XCIpLnN0eWxlLmJveFNoYWRvdyA9IFwibm9uZVwiO1xuXG5cdHVwZGF0ZUJhY2tsaW5rSG92ZXIoe1xuXHRcdHRlbXA6IGZhbHNlLFxuXHRcdGN1cnNvclZpZXdwb3J0OiBudWxsLFxuXHRcdHBlZWs6IGZhbHNlLFxuXHR9KTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIG9wZW5SZWZlcmVuY2UoZXY6IE1vdXNlRXZlbnQpIHtcblx0bGV0IGhvdmVyID0gZ2V0SG92ZXIoKTtcblx0bGV0IGxlYWYgPSBnZXRUaGF0KCkud29ya3NwYWNlLmdldExlYWZCeUlkKGhvdmVyLmxlYWZJZCk7XG5cblx0Ly8gQHRzLWlnbm9yZVxuXHRsZXQgY29udGFpbmVyID0gbGVhZi5jb250YWluZXJFbDtcblx0aWYgKCFjb250YWluZXIpIHRocm93IG5ldyBFcnJvcihcIkNvbnRhaW5lciBub3QgZm91bmRcIik7XG5cdGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiLnZpZXctY29udGVudFwiKS5zdHlsZS5ib3hTaGFkb3cgPSBcIm5vbmVcIjtcblxuXHR1cGRhdGVIb3Zlcih7XG5cdFx0dGVtcDogZmFsc2UsXG5cdFx0Y3Vyc29yVmlld3BvcnQ6IG51bGwsXG5cdFx0cGVlazogZmFsc2UsXG5cdH0pO1xufVxuIiwgIi8vIFVuaXF1ZSBJRCBjcmVhdGlvbiByZXF1aXJlcyBhIGhpZ2ggcXVhbGl0eSByYW5kb20gIyBnZW5lcmF0b3IuIEluIHRoZSBicm93c2VyIHdlIHRoZXJlZm9yZVxuLy8gcmVxdWlyZSB0aGUgY3J5cHRvIEFQSSBhbmQgZG8gbm90IHN1cHBvcnQgYnVpbHQtaW4gZmFsbGJhY2sgdG8gbG93ZXIgcXVhbGl0eSByYW5kb20gbnVtYmVyXG4vLyBnZW5lcmF0b3JzIChsaWtlIE1hdGgucmFuZG9tKCkpLlxubGV0IGdldFJhbmRvbVZhbHVlcztcbmNvbnN0IHJuZHM4ID0gbmV3IFVpbnQ4QXJyYXkoMTYpO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gcm5nKCkge1xuICAvLyBsYXp5IGxvYWQgc28gdGhhdCBlbnZpcm9ubWVudHMgdGhhdCBuZWVkIHRvIHBvbHlmaWxsIGhhdmUgYSBjaGFuY2UgdG8gZG8gc29cbiAgaWYgKCFnZXRSYW5kb21WYWx1ZXMpIHtcbiAgICAvLyBnZXRSYW5kb21WYWx1ZXMgbmVlZHMgdG8gYmUgaW52b2tlZCBpbiBhIGNvbnRleHQgd2hlcmUgXCJ0aGlzXCIgaXMgYSBDcnlwdG8gaW1wbGVtZW50YXRpb24uXG4gICAgZ2V0UmFuZG9tVmFsdWVzID0gdHlwZW9mIGNyeXB0byAhPT0gJ3VuZGVmaW5lZCcgJiYgY3J5cHRvLmdldFJhbmRvbVZhbHVlcyAmJiBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzLmJpbmQoY3J5cHRvKTtcblxuICAgIGlmICghZ2V0UmFuZG9tVmFsdWVzKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ2NyeXB0by5nZXRSYW5kb21WYWx1ZXMoKSBub3Qgc3VwcG9ydGVkLiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3V1aWRqcy91dWlkI2dldHJhbmRvbXZhbHVlcy1ub3Qtc3VwcG9ydGVkJyk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGdldFJhbmRvbVZhbHVlcyhybmRzOCk7XG59IiwgImV4cG9ydCBkZWZhdWx0IC9eKD86WzAtOWEtZl17OH0tWzAtOWEtZl17NH0tWzEtNV1bMC05YS1mXXszfS1bODlhYl1bMC05YS1mXXszfS1bMC05YS1mXXsxMn18MDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwKSQvaTsiLCAiaW1wb3J0IFJFR0VYIGZyb20gJy4vcmVnZXguanMnO1xuXG5mdW5jdGlvbiB2YWxpZGF0ZSh1dWlkKSB7XG4gIHJldHVybiB0eXBlb2YgdXVpZCA9PT0gJ3N0cmluZycgJiYgUkVHRVgudGVzdCh1dWlkKTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgdmFsaWRhdGU7IiwgImltcG9ydCB2YWxpZGF0ZSBmcm9tICcuL3ZhbGlkYXRlLmpzJztcbi8qKlxuICogQ29udmVydCBhcnJheSBvZiAxNiBieXRlIHZhbHVlcyB0byBVVUlEIHN0cmluZyBmb3JtYXQgb2YgdGhlIGZvcm06XG4gKiBYWFhYWFhYWC1YWFhYLVhYWFgtWFhYWC1YWFhYWFhYWFhYWFhcbiAqL1xuXG5jb25zdCBieXRlVG9IZXggPSBbXTtcblxuZm9yIChsZXQgaSA9IDA7IGkgPCAyNTY7ICsraSkge1xuICBieXRlVG9IZXgucHVzaCgoaSArIDB4MTAwKS50b1N0cmluZygxNikuc2xpY2UoMSkpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdW5zYWZlU3RyaW5naWZ5KGFyciwgb2Zmc2V0ID0gMCkge1xuICAvLyBOb3RlOiBCZSBjYXJlZnVsIGVkaXRpbmcgdGhpcyBjb2RlISAgSXQncyBiZWVuIHR1bmVkIGZvciBwZXJmb3JtYW5jZVxuICAvLyBhbmQgd29ya3MgaW4gd2F5cyB5b3UgbWF5IG5vdCBleHBlY3QuIFNlZSBodHRwczovL2dpdGh1Yi5jb20vdXVpZGpzL3V1aWQvcHVsbC80MzRcbiAgcmV0dXJuIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMF1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxXV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDJdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgM11dICsgJy0nICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA0XV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDVdXSArICctJyArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgNl1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA3XV0gKyAnLScgKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDhdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgOV1dICsgJy0nICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxMF1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxMV1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxMl1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxM11dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxNF1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxNV1dO1xufVxuXG5mdW5jdGlvbiBzdHJpbmdpZnkoYXJyLCBvZmZzZXQgPSAwKSB7XG4gIGNvbnN0IHV1aWQgPSB1bnNhZmVTdHJpbmdpZnkoYXJyLCBvZmZzZXQpOyAvLyBDb25zaXN0ZW5jeSBjaGVjayBmb3IgdmFsaWQgVVVJRC4gIElmIHRoaXMgdGhyb3dzLCBpdCdzIGxpa2VseSBkdWUgdG8gb25lXG4gIC8vIG9mIHRoZSBmb2xsb3dpbmc6XG4gIC8vIC0gT25lIG9yIG1vcmUgaW5wdXQgYXJyYXkgdmFsdWVzIGRvbid0IG1hcCB0byBhIGhleCBvY3RldCAobGVhZGluZyB0b1xuICAvLyBcInVuZGVmaW5lZFwiIGluIHRoZSB1dWlkKVxuICAvLyAtIEludmFsaWQgaW5wdXQgdmFsdWVzIGZvciB0aGUgUkZDIGB2ZXJzaW9uYCBvciBgdmFyaWFudGAgZmllbGRzXG5cbiAgaWYgKCF2YWxpZGF0ZSh1dWlkKSkge1xuICAgIHRocm93IFR5cGVFcnJvcignU3RyaW5naWZpZWQgVVVJRCBpcyBpbnZhbGlkJyk7XG4gIH1cblxuICByZXR1cm4gdXVpZDtcbn1cblxuZXhwb3J0IGRlZmF1bHQgc3RyaW5naWZ5OyIsICJpbXBvcnQgdmFsaWRhdGUgZnJvbSAnLi92YWxpZGF0ZS5qcyc7XG5cbmZ1bmN0aW9uIHBhcnNlKHV1aWQpIHtcbiAgaWYgKCF2YWxpZGF0ZSh1dWlkKSkge1xuICAgIHRocm93IFR5cGVFcnJvcignSW52YWxpZCBVVUlEJyk7XG4gIH1cblxuICBsZXQgdjtcbiAgY29uc3QgYXJyID0gbmV3IFVpbnQ4QXJyYXkoMTYpOyAvLyBQYXJzZSAjIyMjIyMjIy0uLi4uLS4uLi4tLi4uLi0uLi4uLi4uLi4uLi5cblxuICBhcnJbMF0gPSAodiA9IHBhcnNlSW50KHV1aWQuc2xpY2UoMCwgOCksIDE2KSkgPj4+IDI0O1xuICBhcnJbMV0gPSB2ID4+PiAxNiAmIDB4ZmY7XG4gIGFyclsyXSA9IHYgPj4+IDggJiAweGZmO1xuICBhcnJbM10gPSB2ICYgMHhmZjsgLy8gUGFyc2UgLi4uLi4uLi4tIyMjIy0uLi4uLS4uLi4tLi4uLi4uLi4uLi4uXG5cbiAgYXJyWzRdID0gKHYgPSBwYXJzZUludCh1dWlkLnNsaWNlKDksIDEzKSwgMTYpKSA+Pj4gODtcbiAgYXJyWzVdID0gdiAmIDB4ZmY7IC8vIFBhcnNlIC4uLi4uLi4uLS4uLi4tIyMjIy0uLi4uLS4uLi4uLi4uLi4uLlxuXG4gIGFycls2XSA9ICh2ID0gcGFyc2VJbnQodXVpZC5zbGljZSgxNCwgMTgpLCAxNikpID4+PiA4O1xuICBhcnJbN10gPSB2ICYgMHhmZjsgLy8gUGFyc2UgLi4uLi4uLi4tLi4uLi0uLi4uLSMjIyMtLi4uLi4uLi4uLi4uXG5cbiAgYXJyWzhdID0gKHYgPSBwYXJzZUludCh1dWlkLnNsaWNlKDE5LCAyMyksIDE2KSkgPj4+IDg7XG4gIGFycls5XSA9IHYgJiAweGZmOyAvLyBQYXJzZSAuLi4uLi4uLi0uLi4uLS4uLi4tLi4uLi0jIyMjIyMjIyMjIyNcbiAgLy8gKFVzZSBcIi9cIiB0byBhdm9pZCAzMi1iaXQgdHJ1bmNhdGlvbiB3aGVuIGJpdC1zaGlmdGluZyBoaWdoLW9yZGVyIGJ5dGVzKVxuXG4gIGFyclsxMF0gPSAodiA9IHBhcnNlSW50KHV1aWQuc2xpY2UoMjQsIDM2KSwgMTYpKSAvIDB4MTAwMDAwMDAwMDAgJiAweGZmO1xuICBhcnJbMTFdID0gdiAvIDB4MTAwMDAwMDAwICYgMHhmZjtcbiAgYXJyWzEyXSA9IHYgPj4+IDI0ICYgMHhmZjtcbiAgYXJyWzEzXSA9IHYgPj4+IDE2ICYgMHhmZjtcbiAgYXJyWzE0XSA9IHYgPj4+IDggJiAweGZmO1xuICBhcnJbMTVdID0gdiAmIDB4ZmY7XG4gIHJldHVybiBhcnI7XG59XG5cbmV4cG9ydCBkZWZhdWx0IHBhcnNlOyIsICJpbXBvcnQgeyB1bnNhZmVTdHJpbmdpZnkgfSBmcm9tICcuL3N0cmluZ2lmeS5qcyc7XG5pbXBvcnQgcGFyc2UgZnJvbSAnLi9wYXJzZS5qcyc7XG5cbmZ1bmN0aW9uIHN0cmluZ1RvQnl0ZXMoc3RyKSB7XG4gIHN0ciA9IHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChzdHIpKTsgLy8gVVRGOCBlc2NhcGVcblxuICBjb25zdCBieXRlcyA9IFtdO1xuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgKytpKSB7XG4gICAgYnl0ZXMucHVzaChzdHIuY2hhckNvZGVBdChpKSk7XG4gIH1cblxuICByZXR1cm4gYnl0ZXM7XG59XG5cbmV4cG9ydCBjb25zdCBETlMgPSAnNmJhN2I4MTAtOWRhZC0xMWQxLTgwYjQtMDBjMDRmZDQzMGM4JztcbmV4cG9ydCBjb25zdCBVUkwgPSAnNmJhN2I4MTEtOWRhZC0xMWQxLTgwYjQtMDBjMDRmZDQzMGM4JztcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHYzNShuYW1lLCB2ZXJzaW9uLCBoYXNoZnVuYykge1xuICBmdW5jdGlvbiBnZW5lcmF0ZVVVSUQodmFsdWUsIG5hbWVzcGFjZSwgYnVmLCBvZmZzZXQpIHtcbiAgICB2YXIgX25hbWVzcGFjZTtcblxuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICB2YWx1ZSA9IHN0cmluZ1RvQnl0ZXModmFsdWUpO1xuICAgIH1cblxuICAgIGlmICh0eXBlb2YgbmFtZXNwYWNlID09PSAnc3RyaW5nJykge1xuICAgICAgbmFtZXNwYWNlID0gcGFyc2UobmFtZXNwYWNlKTtcbiAgICB9XG5cbiAgICBpZiAoKChfbmFtZXNwYWNlID0gbmFtZXNwYWNlKSA9PT0gbnVsbCB8fCBfbmFtZXNwYWNlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfbmFtZXNwYWNlLmxlbmd0aCkgIT09IDE2KSB7XG4gICAgICB0aHJvdyBUeXBlRXJyb3IoJ05hbWVzcGFjZSBtdXN0IGJlIGFycmF5LWxpa2UgKDE2IGl0ZXJhYmxlIGludGVnZXIgdmFsdWVzLCAwLTI1NSknKTtcbiAgICB9IC8vIENvbXB1dGUgaGFzaCBvZiBuYW1lc3BhY2UgYW5kIHZhbHVlLCBQZXIgNC4zXG4gICAgLy8gRnV0dXJlOiBVc2Ugc3ByZWFkIHN5bnRheCB3aGVuIHN1cHBvcnRlZCBvbiBhbGwgcGxhdGZvcm1zLCBlLmcuIGBieXRlcyA9XG4gICAgLy8gaGFzaGZ1bmMoWy4uLm5hbWVzcGFjZSwgLi4uIHZhbHVlXSlgXG5cblxuICAgIGxldCBieXRlcyA9IG5ldyBVaW50OEFycmF5KDE2ICsgdmFsdWUubGVuZ3RoKTtcbiAgICBieXRlcy5zZXQobmFtZXNwYWNlKTtcbiAgICBieXRlcy5zZXQodmFsdWUsIG5hbWVzcGFjZS5sZW5ndGgpO1xuICAgIGJ5dGVzID0gaGFzaGZ1bmMoYnl0ZXMpO1xuICAgIGJ5dGVzWzZdID0gYnl0ZXNbNl0gJiAweDBmIHwgdmVyc2lvbjtcbiAgICBieXRlc1s4XSA9IGJ5dGVzWzhdICYgMHgzZiB8IDB4ODA7XG5cbiAgICBpZiAoYnVmKSB7XG4gICAgICBvZmZzZXQgPSBvZmZzZXQgfHwgMDtcblxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxNjsgKytpKSB7XG4gICAgICAgIGJ1ZltvZmZzZXQgKyBpXSA9IGJ5dGVzW2ldO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gYnVmO1xuICAgIH1cblxuICAgIHJldHVybiB1bnNhZmVTdHJpbmdpZnkoYnl0ZXMpO1xuICB9IC8vIEZ1bmN0aW9uI25hbWUgaXMgbm90IHNldHRhYmxlIG9uIHNvbWUgcGxhdGZvcm1zICgjMjcwKVxuXG5cbiAgdHJ5IHtcbiAgICBnZW5lcmF0ZVVVSUQubmFtZSA9IG5hbWU7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1lbXB0eVxuICB9IGNhdGNoIChlcnIpIHt9IC8vIEZvciBDb21tb25KUyBkZWZhdWx0IGV4cG9ydCBzdXBwb3J0XG5cblxuICBnZW5lcmF0ZVVVSUQuRE5TID0gRE5TO1xuICBnZW5lcmF0ZVVVSUQuVVJMID0gVVJMO1xuICByZXR1cm4gZ2VuZXJhdGVVVUlEO1xufSIsICJjb25zdCByYW5kb21VVUlEID0gdHlwZW9mIGNyeXB0byAhPT0gJ3VuZGVmaW5lZCcgJiYgY3J5cHRvLnJhbmRvbVVVSUQgJiYgY3J5cHRvLnJhbmRvbVVVSUQuYmluZChjcnlwdG8pO1xuZXhwb3J0IGRlZmF1bHQge1xuICByYW5kb21VVUlEXG59OyIsICJpbXBvcnQgbmF0aXZlIGZyb20gJy4vbmF0aXZlLmpzJztcbmltcG9ydCBybmcgZnJvbSAnLi9ybmcuanMnO1xuaW1wb3J0IHsgdW5zYWZlU3RyaW5naWZ5IH0gZnJvbSAnLi9zdHJpbmdpZnkuanMnO1xuXG5mdW5jdGlvbiB2NChvcHRpb25zLCBidWYsIG9mZnNldCkge1xuICBpZiAobmF0aXZlLnJhbmRvbVVVSUQgJiYgIWJ1ZiAmJiAhb3B0aW9ucykge1xuICAgIHJldHVybiBuYXRpdmUucmFuZG9tVVVJRCgpO1xuICB9XG5cbiAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gIGNvbnN0IHJuZHMgPSBvcHRpb25zLnJhbmRvbSB8fCAob3B0aW9ucy5ybmcgfHwgcm5nKSgpOyAvLyBQZXIgNC40LCBzZXQgYml0cyBmb3IgdmVyc2lvbiBhbmQgYGNsb2NrX3NlcV9oaV9hbmRfcmVzZXJ2ZWRgXG5cbiAgcm5kc1s2XSA9IHJuZHNbNl0gJiAweDBmIHwgMHg0MDtcbiAgcm5kc1s4XSA9IHJuZHNbOF0gJiAweDNmIHwgMHg4MDsgLy8gQ29weSBieXRlcyB0byBidWZmZXIsIGlmIHByb3ZpZGVkXG5cbiAgaWYgKGJ1Zikge1xuICAgIG9mZnNldCA9IG9mZnNldCB8fCAwO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxNjsgKytpKSB7XG4gICAgICBidWZbb2Zmc2V0ICsgaV0gPSBybmRzW2ldO1xuICAgIH1cblxuICAgIHJldHVybiBidWY7XG4gIH1cblxuICByZXR1cm4gdW5zYWZlU3RyaW5naWZ5KHJuZHMpO1xufVxuXG5leHBvcnQgZGVmYXVsdCB2NDsiLCAiLy8gQWRhcHRlZCBmcm9tIENocmlzIFZlbmVzcycgU0hBMSBjb2RlIGF0XG4vLyBodHRwOi8vd3d3Lm1vdmFibGUtdHlwZS5jby51ay9zY3JpcHRzL3NoYTEuaHRtbFxuZnVuY3Rpb24gZihzLCB4LCB5LCB6KSB7XG4gIHN3aXRjaCAocykge1xuICAgIGNhc2UgMDpcbiAgICAgIHJldHVybiB4ICYgeSBeIH54ICYgejtcblxuICAgIGNhc2UgMTpcbiAgICAgIHJldHVybiB4IF4geSBeIHo7XG5cbiAgICBjYXNlIDI6XG4gICAgICByZXR1cm4geCAmIHkgXiB4ICYgeiBeIHkgJiB6O1xuXG4gICAgY2FzZSAzOlxuICAgICAgcmV0dXJuIHggXiB5IF4gejtcbiAgfVxufVxuXG5mdW5jdGlvbiBST1RMKHgsIG4pIHtcbiAgcmV0dXJuIHggPDwgbiB8IHggPj4+IDMyIC0gbjtcbn1cblxuZnVuY3Rpb24gc2hhMShieXRlcykge1xuICBjb25zdCBLID0gWzB4NWE4Mjc5OTksIDB4NmVkOWViYTEsIDB4OGYxYmJjZGMsIDB4Y2E2MmMxZDZdO1xuICBjb25zdCBIID0gWzB4Njc0NTIzMDEsIDB4ZWZjZGFiODksIDB4OThiYWRjZmUsIDB4MTAzMjU0NzYsIDB4YzNkMmUxZjBdO1xuXG4gIGlmICh0eXBlb2YgYnl0ZXMgPT09ICdzdHJpbmcnKSB7XG4gICAgY29uc3QgbXNnID0gdW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KGJ5dGVzKSk7IC8vIFVURjggZXNjYXBlXG5cbiAgICBieXRlcyA9IFtdO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtc2cubGVuZ3RoOyArK2kpIHtcbiAgICAgIGJ5dGVzLnB1c2gobXNnLmNoYXJDb2RlQXQoaSkpO1xuICAgIH1cbiAgfSBlbHNlIGlmICghQXJyYXkuaXNBcnJheShieXRlcykpIHtcbiAgICAvLyBDb252ZXJ0IEFycmF5LWxpa2UgdG8gQXJyYXlcbiAgICBieXRlcyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGJ5dGVzKTtcbiAgfVxuXG4gIGJ5dGVzLnB1c2goMHg4MCk7XG4gIGNvbnN0IGwgPSBieXRlcy5sZW5ndGggLyA0ICsgMjtcbiAgY29uc3QgTiA9IE1hdGguY2VpbChsIC8gMTYpO1xuICBjb25zdCBNID0gbmV3IEFycmF5KE4pO1xuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgTjsgKytpKSB7XG4gICAgY29uc3QgYXJyID0gbmV3IFVpbnQzMkFycmF5KDE2KTtcblxuICAgIGZvciAobGV0IGogPSAwOyBqIDwgMTY7ICsraikge1xuICAgICAgYXJyW2pdID0gYnl0ZXNbaSAqIDY0ICsgaiAqIDRdIDw8IDI0IHwgYnl0ZXNbaSAqIDY0ICsgaiAqIDQgKyAxXSA8PCAxNiB8IGJ5dGVzW2kgKiA2NCArIGogKiA0ICsgMl0gPDwgOCB8IGJ5dGVzW2kgKiA2NCArIGogKiA0ICsgM107XG4gICAgfVxuXG4gICAgTVtpXSA9IGFycjtcbiAgfVxuXG4gIE1bTiAtIDFdWzE0XSA9IChieXRlcy5sZW5ndGggLSAxKSAqIDggLyBNYXRoLnBvdygyLCAzMik7XG4gIE1bTiAtIDFdWzE0XSA9IE1hdGguZmxvb3IoTVtOIC0gMV1bMTRdKTtcbiAgTVtOIC0gMV1bMTVdID0gKGJ5dGVzLmxlbmd0aCAtIDEpICogOCAmIDB4ZmZmZmZmZmY7XG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBOOyArK2kpIHtcbiAgICBjb25zdCBXID0gbmV3IFVpbnQzMkFycmF5KDgwKTtcblxuICAgIGZvciAobGV0IHQgPSAwOyB0IDwgMTY7ICsrdCkge1xuICAgICAgV1t0XSA9IE1baV1bdF07XG4gICAgfVxuXG4gICAgZm9yIChsZXQgdCA9IDE2OyB0IDwgODA7ICsrdCkge1xuICAgICAgV1t0XSA9IFJPVEwoV1t0IC0gM10gXiBXW3QgLSA4XSBeIFdbdCAtIDE0XSBeIFdbdCAtIDE2XSwgMSk7XG4gICAgfVxuXG4gICAgbGV0IGEgPSBIWzBdO1xuICAgIGxldCBiID0gSFsxXTtcbiAgICBsZXQgYyA9IEhbMl07XG4gICAgbGV0IGQgPSBIWzNdO1xuICAgIGxldCBlID0gSFs0XTtcblxuICAgIGZvciAobGV0IHQgPSAwOyB0IDwgODA7ICsrdCkge1xuICAgICAgY29uc3QgcyA9IE1hdGguZmxvb3IodCAvIDIwKTtcbiAgICAgIGNvbnN0IFQgPSBST1RMKGEsIDUpICsgZihzLCBiLCBjLCBkKSArIGUgKyBLW3NdICsgV1t0XSA+Pj4gMDtcbiAgICAgIGUgPSBkO1xuICAgICAgZCA9IGM7XG4gICAgICBjID0gUk9UTChiLCAzMCkgPj4+IDA7XG4gICAgICBiID0gYTtcbiAgICAgIGEgPSBUO1xuICAgIH1cblxuICAgIEhbMF0gPSBIWzBdICsgYSA+Pj4gMDtcbiAgICBIWzFdID0gSFsxXSArIGIgPj4+IDA7XG4gICAgSFsyXSA9IEhbMl0gKyBjID4+PiAwO1xuICAgIEhbM10gPSBIWzNdICsgZCA+Pj4gMDtcbiAgICBIWzRdID0gSFs0XSArIGUgPj4+IDA7XG4gIH1cblxuICByZXR1cm4gW0hbMF0gPj4gMjQgJiAweGZmLCBIWzBdID4+IDE2ICYgMHhmZiwgSFswXSA+PiA4ICYgMHhmZiwgSFswXSAmIDB4ZmYsIEhbMV0gPj4gMjQgJiAweGZmLCBIWzFdID4+IDE2ICYgMHhmZiwgSFsxXSA+PiA4ICYgMHhmZiwgSFsxXSAmIDB4ZmYsIEhbMl0gPj4gMjQgJiAweGZmLCBIWzJdID4+IDE2ICYgMHhmZiwgSFsyXSA+PiA4ICYgMHhmZiwgSFsyXSAmIDB4ZmYsIEhbM10gPj4gMjQgJiAweGZmLCBIWzNdID4+IDE2ICYgMHhmZiwgSFszXSA+PiA4ICYgMHhmZiwgSFszXSAmIDB4ZmYsIEhbNF0gPj4gMjQgJiAweGZmLCBIWzRdID4+IDE2ICYgMHhmZiwgSFs0XSA+PiA4ICYgMHhmZiwgSFs0XSAmIDB4ZmZdO1xufVxuXG5leHBvcnQgZGVmYXVsdCBzaGExOyIsICJpbXBvcnQgdjM1IGZyb20gJy4vdjM1LmpzJztcbmltcG9ydCBzaGExIGZyb20gJy4vc2hhMS5qcyc7XG5jb25zdCB2NSA9IHYzNSgndjUnLCAweDUwLCBzaGExKTtcbmV4cG9ydCBkZWZhdWx0IHY1OyIsICJpbXBvcnQgeyBNYXJrZG93blZpZXcgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IFJFRkVSRU5DRV9SRUdFWCB9IGZyb20gXCIuL2NvbnN0YW50c1wiO1xuXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VFZGl0b3JQb3NpdGlvbihwb3NpdGlvblN0cmluZzogc3RyaW5nKSB7XG5cdGxldCBbbGluZSwgY2hdID0gcG9zaXRpb25TdHJpbmcuc3BsaXQoXCIsXCIpO1xuXHRyZXR1cm4geyBsaW5lOiBwYXJzZUludChsaW5lKSwgY2g6IHBhcnNlSW50KGNoKSB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZW5jb2RlVVJJQ29tcG9uZW50U3RyaW5nKHN0cjogc3RyaW5nKTogc3RyaW5nIHtcblx0cmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChzdHIpLnJlcGxhY2UoL1s6KCldL2csIGZ1bmN0aW9uIChjKSB7XG5cdFx0cmV0dXJuIFwiJVwiICsgYy5jaGFyQ29kZUF0KDApLnRvU3RyaW5nKDE2KTtcblx0fSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkZWNvZGVVUklDb21wb25lbnRTdHJpbmcoc3RyOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRyZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KFxuXHRcdHN0ci5yZXBsYWNlKC8lM0EvZywgXCI6XCIpLnJlcGxhY2UoLyUyOC9nLCBcIihcIikucmVwbGFjZSgvJTI5L2csIFwiKVwiKVxuXHQpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcHJvY2Vzc1VSSShcblx0ZGF0YVN0cmluZzogc3RyaW5nXG4pOiBbXG5cdHByZWZpeDogc3RyaW5nLFxuXHR0ZXh0OiBzdHJpbmcsXG5cdHN1ZmZpeDogc3RyaW5nLFxuXHRmaWxlOiBzdHJpbmcsXG5cdGZyb206IG51bWJlcixcblx0dG86IG51bWJlcixcblx0cG9ydGFsOiBzdHJpbmcsXG5cdHRvZ2dsZTogc3RyaW5nXG5dIHtcblx0bGV0IFtwcmVmaXgsIHRleHQsIHN1ZmZpeCwgZmlsZSwgZnJvbSwgdG8sIHBvcnRhbCwgdG9nZ2xlXSA9XG5cdFx0ZGF0YVN0cmluZy5zcGxpdChcIjpcIik7XG5cdHByZWZpeCA9IGRlY29kZVVSSUNvbXBvbmVudFN0cmluZyhwcmVmaXgpO1xuXHR0ZXh0ID0gZGVjb2RlVVJJQ29tcG9uZW50U3RyaW5nKHRleHQpO1xuXHRzdWZmaXggPSBkZWNvZGVVUklDb21wb25lbnRTdHJpbmcoc3VmZml4KTtcblx0ZmlsZSA9IGRlY29kZVVSSUNvbXBvbmVudFN0cmluZyhmaWxlKTtcblx0ZnJvbSA9IGRlY29kZVVSSUNvbXBvbmVudFN0cmluZyhmcm9tKTtcblx0dG8gPSBkZWNvZGVVUklDb21wb25lbnRTdHJpbmcodG8pO1xuXHRpZiAocG9ydGFsKSBwb3J0YWwgPSBkZWNvZGVVUklDb21wb25lbnRTdHJpbmcocG9ydGFsKTtcblx0dG9nZ2xlID0gZGVjb2RlVVJJQ29tcG9uZW50U3RyaW5nKHRvZ2dsZSk7XG5cblx0cmV0dXJuIFtcblx0XHRwcmVmaXgsXG5cdFx0dGV4dCxcblx0XHRzdWZmaXgsXG5cdFx0ZmlsZSxcblx0XHRwYXJzZUludChmcm9tKSxcblx0XHRwYXJzZUludCh0byksXG5cdFx0cG9ydGFsLFxuXHRcdHRvZ2dsZSxcblx0XTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFByZWZpeEFuZFN1ZmZpeChkb2N1bWVudDogc3RyaW5nLCBmcm9tOiBudW1iZXIsIHRvOiBudW1iZXIpIHtcblx0bGV0IHByZWZpeCA9IGRvY3VtZW50XG5cdFx0LnNsaWNlKGZyb20gLSAyNSwgZnJvbSlcblx0XHQuc3BsaXQoXCJcXG5cIilcblx0XHQuc2xpY2UoLTEpWzBdO1xuXHQvLyAuc2xpY2UoZnJvbSAtIDI1ID4gMCA/IGZyb20gLSAyNSA6IDAsIGZyb20pXG5cblx0bGV0IHN1ZmZpeCA9IGRvY3VtZW50LnNsaWNlKHRvLCB0byArIDI1KS5zcGxpdChcIlxcblwiKVswXTtcblx0cmV0dXJuIHsgcHJlZml4LCBzdWZmaXggfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGZpbmRUZXh0UG9zaXRpb25zKFxuXHR0ZXh0OiBzdHJpbmcsXG5cdHNlYXJjaFRlcm06IHN0cmluZyxcblx0cHJlZml4OiBzdHJpbmcgPSBcIlwiLFxuXHRzdWZmaXg6IHN0cmluZyA9IFwiXCJcbikge1xuXHRsZXQgcm9sbGluZ0luZGV4ID0gMDtcblxuXHRjb25zdCBsaW5lcyA9IHRleHQuc3BsaXQoXCJcXG5cIikubWFwKChsaW5lOiBzdHJpbmcsIGk6IG51bWJlcikgPT4ge1xuXHRcdGxldCBkYXRhID0geyBsaW5lLCBpbmRleDogcm9sbGluZ0luZGV4LCBsZW5ndGg6IGxpbmUubGVuZ3RoICsgMSwgaSB9O1xuXHRcdHJvbGxpbmdJbmRleCArPSBkYXRhLmxlbmd0aDtcblx0XHRyZXR1cm4gZGF0YTtcblx0fSk7XG5cblx0aWYgKHRleHQuaW5jbHVkZXMocHJlZml4ICsgc2VhcmNoVGVybSArIHN1ZmZpeCkpIHtcblx0XHRsZXQgbWF0Y2hJbmRleCA9IHRleHQuaW5kZXhPZihwcmVmaXggKyBzZWFyY2hUZXJtICsgc3VmZml4KTtcblx0XHRsZXQgc3RhcnRJbmRleCA9XG5cdFx0XHRsaW5lcy5maW5kSW5kZXgoKGxpbmU6IGFueSkgPT4gbGluZS5pbmRleCA+IG1hdGNoSW5kZXggKyBwcmVmaXgubGVuZ3RoKSAtXG5cdFx0XHQxO1xuXHRcdGxldCBlbmRJbmRleCA9XG5cdFx0XHRsaW5lcy5maW5kSW5kZXgoXG5cdFx0XHRcdChsaW5lOiBhbnkpID0+XG5cdFx0XHRcdFx0bGluZS5pbmRleCA+IG1hdGNoSW5kZXggKyBwcmVmaXgubGVuZ3RoICsgc2VhcmNoVGVybS5sZW5ndGhcblx0XHRcdCkgLSAxO1xuXG5cdFx0aWYgKHN0YXJ0SW5kZXggPT0gLTIpIHN0YXJ0SW5kZXggPSBsaW5lcy5sZW5ndGggLSAxO1xuXHRcdGlmIChlbmRJbmRleCA9PSAtMikgZW5kSW5kZXggPSBsaW5lcy5sZW5ndGggLSAxO1xuXG5cdFx0cmV0dXJuIHtcblx0XHRcdHJhbmdlU3RhcnQ6IHtcblx0XHRcdFx0bGluZTogc3RhcnRJbmRleCxcblx0XHRcdFx0Y2g6IG1hdGNoSW5kZXggKyBwcmVmaXgubGVuZ3RoIC0gbGluZXNbc3RhcnRJbmRleF0uaW5kZXgsXG5cdFx0XHR9LFxuXHRcdFx0cmFuZ2VFbmQ6IHtcblx0XHRcdFx0bGluZTogZW5kSW5kZXgsXG5cdFx0XHRcdGNoOlxuXHRcdFx0XHRcdG1hdGNoSW5kZXggK1xuXHRcdFx0XHRcdHByZWZpeC5sZW5ndGggK1xuXHRcdFx0XHRcdHNlYXJjaFRlcm0ubGVuZ3RoIC1cblx0XHRcdFx0XHRsaW5lc1tlbmRJbmRleF0uaW5kZXgsXG5cdFx0XHR9LFxuXHRcdFx0bGluZXMsXG5cdFx0fTtcblx0fVxuXHRyZXR1cm4gbnVsbDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGxpc3RJdGVtTGVuZ3RoKGxpbmU6IHN0cmluZykge1xuXHQvLyBNYXRjaGVzIGxpbmVzIHRoYXQgc3RhcnQgd2l0aCBhIGJ1bGxldCAoZWl0aGVyIC0sICosIG9yICsgZm9sbG93ZWQgYnkgYSBzcGFjZSlcblx0Y29uc3QgYnVsbGV0UmVnZXggPSAvXihcXHMqWy0qK11cXHMrKS87XG5cblx0Ly8gTWF0Y2hlcyBsaW5lcyB0aGF0IHN0YXJ0IHdpdGggYSBudW1iZXIgZm9sbG93ZWQgYnkgYSBkb3QgYW5kIGEgc3BhY2UgKGxpa2UgXCIxLiBcIilcblx0Y29uc3QgbnVtYmVyUmVnZXggPSAvXihcXHMqXFxkK1xcLlxccyspLztcblxuXHRsZXQgbWF0Y2ggPSBsaW5lLm1hdGNoKGJ1bGxldFJlZ2V4KSB8fCBsaW5lLm1hdGNoKG51bWJlclJlZ2V4KTtcblx0cmV0dXJuIG1hdGNoID8gbWF0Y2hbMF0ubGVuZ3RoIDogMDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNoZWNrQ3Vyc29yUG9zaXRpb25BdERhdGFzdHJpbmcoZXZ0OiBFdmVudCk6IHtcblx0bWF0Y2hlZDogYm9vbGVhbjtcblx0c3BhbjogSFRNTFNwYW5FbGVtZW50IHwgdW5kZWZpbmVkO1xufSB7XG5cdGNvbnN0IGFjdGl2ZVZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuXHRjb25zdCBjdXJzb3JGcm9tID0gYWN0aXZlVmlldz8uZWRpdG9yLmdldEN1cnNvcihcImZyb21cIik7XG5cdGNvbnN0IGN1cnNvclRvID0gYWN0aXZlVmlldz8uZWRpdG9yLmdldEN1cnNvcihcInRvXCIpO1xuXG5cdGxldCBtYXRjaGVkID0gZmFsc2U7XG5cdGxldCBtYXRjaFNwYW46IEhUTUxTcGFuRWxlbWVudCB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZDtcblx0aWYgKFxuXHRcdGN1cnNvckZyb20gJiZcblx0XHRjdXJzb3JUbyAmJlxuXHRcdGN1cnNvckZyb20uY2ggPT0gY3Vyc29yVG8uY2ggJiZcblx0XHRjdXJzb3JGcm9tLmxpbmUgPT0gY3Vyc29yVG8ubGluZVxuXHRcdC8vICYmY3Vyc29yRnJvbS5jaCAtIDEgPj0gLTFcblx0KSB7XG5cdFx0Y29uc3QgbGluZVRleHQgPSBhY3RpdmVWaWV3Py5lZGl0b3IuZ2V0TGluZShjdXJzb3JGcm9tLmxpbmUpO1xuXG5cdFx0Ly8gZnJvbSBwb3NzaWJsZSByZWdleCBtYXRjaGVzIGluIGxpbmVUZXh0XG5cdFx0aWYgKGxpbmVUZXh0KSB7XG5cdFx0XHRjb25zdCBtYXRjaGVzID0gWy4uLmxpbmVUZXh0Lm1hdGNoQWxsKFJFRkVSRU5DRV9SRUdFWCldO1xuXHRcdFx0bWF0Y2hlcy5mb3JFYWNoKChtYXRjaCkgPT4ge1xuXHRcdFx0XHRpZiAobWF0Y2guaW5kZXg/LnRvU3RyaW5nKCkpIHtcblx0XHRcdFx0XHRjb25zdCBzdGFydDogbnVtYmVyID0gbWF0Y2guaW5kZXg7XG5cdFx0XHRcdFx0Y29uc3QgZW5kOiBudW1iZXIgPSBzdGFydCArIG1hdGNoWzBdLmxlbmd0aDtcblx0XHRcdFx0XHRpZiAoZW5kID09IGN1cnNvclRvLmNoICYmIGV2dC50YXJnZXQpIHtcblx0XHRcdFx0XHRcdGNvbnN0IGRhdGFTdHJpbmcgPSBtYXRjaFsxXTtcblx0XHRcdFx0XHRcdC8vIGdldCB0aGUgaHRtbCBlbGVtZW50IGF0IHRoZSBtYXRjaCBsb2NhdGlvblxuXHRcdFx0XHRcdFx0bGV0IGNoZWNrQ29udGFpbmVyID0gZXZ0LnRhcmdldCBpbnN0YW5jZW9mIEVsZW1lbnQ7XG5cdFx0XHRcdFx0XHRpZiAoIWNoZWNrQ29udGFpbmVyKVxuXHRcdFx0XHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoXCJFbGVtZW50IG5vdCBpbnN0YW5jZSBvZiBFbGVtZW50XCIpO1xuXHRcdFx0XHRcdFx0bGV0IGNvbnRhaW5lciA9IGV2dC50YXJnZXQgYXMgRWxlbWVudDtcblxuXHRcdFx0XHRcdFx0Ly8gZmluZCBodG1sIHNwYW4gZWxlbWVudCBpbiB0YXJnZXQgdGhhdCBoYXMgYSBkYXRhIGF0dHJpYnV0ZSBlcXVhbCB0byBjb250ZW50c1xuXHRcdFx0XHRcdFx0bGV0IHNwYW4gPSBjb250YWluZXI7XG5cdFx0XHRcdFx0XHRpZiAoIXNwYW4uZ2V0QXR0cmlidXRlKFwiZGF0YVwiKSlcblx0XHRcdFx0XHRcdFx0c3BhbiA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFxuXHRcdFx0XHRcdFx0XHRcdGBzcGFuW2RhdGE9XCIke2RhdGFTdHJpbmd9XCJdYFxuXHRcdFx0XHRcdFx0XHQpIGFzIEhUTUxTcGFuRWxlbWVudDtcblxuXHRcdFx0XHRcdFx0aWYgKHNwYW4gJiYgc3BhbiBpbnN0YW5jZW9mIEhUTUxTcGFuRWxlbWVudCkge1xuXHRcdFx0XHRcdFx0XHQvLyBjb25zb2xlLmxvZyhcIkZvdW5kIHNwYW4gZWxlbWVudDpcIiwgc3Bhbik7XG5cdFx0XHRcdFx0XHRcdC8vIERvIHNvbWV0aGluZyB3aXRoIHRoZSBzcGFuIGVsZW1lbnRcblx0XHRcdFx0XHRcdFx0bWF0Y2hlZCA9IHRydWU7XG5cblx0XHRcdFx0XHRcdFx0bWF0Y2hTcGFuID0gc3Bhbjtcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdC8vIGNvbnNvbGUubG9nKFwiU3BhbiBlbGVtZW50IG5vdCBmb3VuZFwiKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH1cblx0fVxuXHRyZXR1cm4geyBtYXRjaGVkLCBzcGFuOiBtYXRjaFNwYW4gfTtcbn1cbiIsICJpbXBvcnQge1xuXHRUQWJzdHJhY3RGaWxlLFxuXHRURmlsZSxcblx0V29ya3NwYWNlLFxuXHRXb3Jrc3BhY2VMZWFmLFxuXHRXb3Jrc3BhY2VSb290LFxuXHRXb3Jrc3BhY2VTcGxpdCxcblx0V29ya3NwYWNlVGFicyxcbn0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBnZXRUaGF0IH0gZnJvbSBcIi4vc3RhdGVcIjtcbmltcG9ydCB7IGdldENvbnRhaW5lckVsZW1lbnQgfSBmcm9tIFwiLi9yZWZlcmVuY2VzXCI7XG5cbmZ1bmN0aW9uIGNvbGxlY3RMZWF2ZXNCeVRhYihcblx0c3BsaXQ6IFdvcmtzcGFjZVNwbGl0LFxuXHRyZXN1bHQ6IFtXb3Jrc3BhY2VMZWFmW11dIHwgW10gPSBbXVxuKSB7XG5cdC8vIEB0cy1pZ25vcmVcblx0Y29uc3QgdHlwZSA9IHNwbGl0LnR5cGU7XG5cdGlmICghdHlwZSkgdGhyb3cgbmV3IEVycm9yKFwiU3BsaXQgdHlwZSBub3QgZm91bmRcIik7XG5cblx0aWYgKHR5cGUgPT0gXCJ0YWJzXCIgfHwgdHlwZSA9PSBcInNwbGl0XCIpIHtcblx0XHQvLyBAdHMtaWdub3JlXG5cdFx0Y29uc3QgY2hpbGRyZW4gPSBzcGxpdC5jaGlsZHJlbjtcblx0XHRpZiAoIWNoaWxkcmVuKSB0aHJvdyBuZXcgRXJyb3IoXCJTcGxpdCBjaGlsZHJlbiBub3QgZm91bmRcIik7XG5cblx0XHRpZiAoY2hpbGRyZW4pIHtcblx0XHRcdGZvciAoY29uc3QgY2hpbGQgb2YgY2hpbGRyZW4pIHtcblx0XHRcdFx0bGV0IGVtcHR5TGlzdDogV29ya3NwYWNlTGVhZltdID0gW107XG5cblx0XHRcdFx0Y29sbGVjdExlYXZlc0J5VGFiKGNoaWxkLCByZXN1bHQpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHQvLyByZXN1bHQucHVzaChbXSk7XG5cdFx0Ly8gY29sbGVjdExlYXZlc0J5VGFiKGNoaWxkcmVuLCByZXN1bHQpO1xuXHR9IGVsc2UgaWYgKHR5cGUgPT0gXCJsZWFmXCIpIHtcblx0XHQvLyBAdHMtaWdub3JlXG5cdFx0Y29uc3QgcGFyZW50U3BsaXRJZCA9IHNwbGl0LnBhcmVudC5pZDtcblx0XHRpZiAoIXBhcmVudFNwbGl0SWQpIHRocm93IG5ldyBFcnJvcihcIlNwbGl0IHBhcmVudCBpZCBub3QgZm91bmRcIik7XG5cblx0XHQvLyBmaW5kIGFycmF5IGluZGV4IGZvciBzcGxpdCB3aXRoIGlkIHBhcmVudFNwbGl0SWRcblx0XHRsZXQgaWR4ID0gcmVzdWx0LmZpbmRJbmRleCgodGFiOiBXb3Jrc3BhY2VMZWFmW10pID0+IHtcblx0XHRcdC8vIEB0cy1pZ25vcmVcblx0XHRcdGNvbnN0IHRhYklkID0gdGFiWzBdLnBhcmVudC5pZDtcblx0XHRcdHJldHVybiB0YWJJZCA9PSBwYXJlbnRTcGxpdElkO1xuXHRcdH0pO1xuXHRcdGlmIChpZHggPT0gLTEpIHtcblx0XHRcdC8vIEB0cy1pZ25vcmVcblx0XHRcdHJlc3VsdC5wdXNoKFtzcGxpdCBhcyBXb3Jrc3BhY2VMZWFmXSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJlc3VsdFtpZHhdLnB1c2goc3BsaXQgYXMgV29ya3NwYWNlTGVhZik7XG5cdFx0fVxuXHR9XG5cblx0Ly8gaWYgKGNoaWxkcmVuKSB7XG5cdC8vIFx0Zm9yIChjb25zdCBjaGlsZCBvZiBjaGlsZHJlbikge1xuXHQvLyBcdFx0Y29sbGVjdExlYXZlc0J5VGFiKGNoaWxkLCByZXN1bHQpO1xuXHQvLyBcdH1cblx0Ly8gfVxuXHRyZXR1cm4gcmVzdWx0O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY29sbGVjdExlYXZlc0J5VGFiSGVscGVyKCkge1xuXHRjb25zdCB7IHdvcmtzcGFjZSB9ID0gZ2V0VGhhdCgpO1xuXHRjb25zdCBjdXJyTGVhZjogV29ya3NwYWNlTGVhZiA9IHdvcmtzcGFjZS5nZXRMZWFmKCk7XG5cdC8vIGNvbnN0IHJvb3RTcGxpdCA9IGZpbmRSb290U3BsaXQoY3VyckxlYWYpO1xuXHRjb25zdCByb290U3BsaXQ6IFdvcmtzcGFjZVNwbGl0ID0gY3VyckxlYWYuZ2V0Um9vdCgpO1xuXHRyZXR1cm4gY29sbGVjdExlYXZlc0J5VGFiKHJvb3RTcGxpdCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDdXJyZW50VGFiSW5kZXgobGVhdmVzQnlUYWI6IGFueVtdLCBzcGFuOiBIVE1MU3BhbkVsZW1lbnQpIHtcblx0bGV0IHdvcmtzcGFjZVRhYiA9IHNwYW4uY2xvc2VzdChcIi53b3Jrc3BhY2UtdGFic1wiKTtcblx0bGV0IGN1cnJUYWJJZHggPSBsZWF2ZXNCeVRhYi5maW5kSW5kZXgoKHRhYjogV29ya3NwYWNlTGVhZltdKSA9PiB7XG5cdFx0Y29uc3QgbGVhZlRhYiA9IHRhYlswXS52aWV3LmNvbnRhaW5lckVsLmNsb3Nlc3QoXCIud29ya3NwYWNlLXRhYnNcIik7XG5cdFx0cmV0dXJuIGxlYWZUYWIgPT0gd29ya3NwYWNlVGFiO1xuXHR9KTtcblx0cmV0dXJuIGN1cnJUYWJJZHg7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRBZGphY2VudFRhYnMoXG5cdGxlYXZlc0J5VGFiOiBhbnlbXSxcblx0Y3VyclRhYklkeDogbnVtYmVyLFxuXHRmaWxlOiBzdHJpbmdcbikge1xuXHRsZXQgcmlnaHRBZGphY2VudFRhYjogYW55W10gPSBbXTtcblx0bGV0IGxlZnRBZGphY2VudFRhYjogYW55W10gPSBbXTtcblx0bGV0IGFkamFjZW50VGFiczogYW55W10gPSBbXTtcblxuXHRpZiAobGVhdmVzQnlUYWJbY3VyclRhYklkeCArIDFdKSB7XG5cdFx0cmlnaHRBZGphY2VudFRhYiA9IGxlYXZlc0J5VGFiW2N1cnJUYWJJZHggKyAxXTtcblx0XHRhZGphY2VudFRhYnMgPSBbLi4uYWRqYWNlbnRUYWJzLCAuLi5yaWdodEFkamFjZW50VGFiXTtcblx0fVxuXHRpZiAobGVhdmVzQnlUYWJbY3VyclRhYklkeCAtIDFdKSB7XG5cdFx0bGVmdEFkamFjZW50VGFiID0gbGVhdmVzQnlUYWJbY3VyclRhYklkeCAtIDFdO1xuXHRcdGFkamFjZW50VGFicyA9IFsuLi5hZGphY2VudFRhYnMsIC4uLmxlZnRBZGphY2VudFRhYl07XG5cdH1cblxuXHRsZXQgaW5kZXggPSBhZGphY2VudFRhYnMuZmluZEluZGV4KFxuXHRcdCh4OiBXb3Jrc3BhY2VMZWFmKSA9PiB4LmdldFZpZXdTdGF0ZSgpLnN0YXRlLmZpbGUgPT0gZmlsZVxuXHQpO1xuXHRyZXR1cm4geyBhZGphY2VudFRhYnMsIHJpZ2h0QWRqYWNlbnRUYWIsIGxlZnRBZGphY2VudFRhYiwgaW5kZXggfTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIG9wZW5GaWxlSW5BZGphY2VudFRhYihcblx0bGVhdmVzQnlUYWI6IGFueVtdLFxuXHRjdXJyVGFiSWR4OiBudW1iZXIsXG5cdGZpbGU6IHN0cmluZyxcblx0dHlwZT86IHN0cmluZ1xuKSB7XG5cdGxldCB7IGFkamFjZW50VGFicywgcmlnaHRBZGphY2VudFRhYiwgbGVmdEFkamFjZW50VGFiIH0gPSBnZXRBZGphY2VudFRhYnMoXG5cdFx0bGVhdmVzQnlUYWIsXG5cdFx0Y3VyclRhYklkeCxcblx0XHRmaWxlXG5cdCk7XG5cblx0bGV0IGFsbFRhYk5hbWVzID0gbGVhdmVzQnlUYWIubWFwKCh0YWI6IFdvcmtzcGFjZUxlYWZbXSkgPT5cblx0XHR0YWIubWFwKCh4OiBXb3Jrc3BhY2VMZWFmKSA9PiB4LmdldFZpZXdTdGF0ZSgpLnN0YXRlLmZpbGUpXG5cdCk7XG5cdGxldCByaWdodEFkamFjZW50VGFiTmFtZXMgPSByaWdodEFkamFjZW50VGFiLm1hcChcblx0XHQoeDogV29ya3NwYWNlTGVhZikgPT4geC5nZXRWaWV3U3RhdGUoKS5zdGF0ZS5maWxlXG5cdCk7XG5cdGxldCBsZWZ0QWRqYWNlbnRUYWJOYW1lcyA9IGxlZnRBZGphY2VudFRhYi5tYXAoXG5cdFx0KHg6IFdvcmtzcGFjZUxlYWYpID0+IHguZ2V0Vmlld1N0YXRlKCkuc3RhdGUuZmlsZVxuXHQpO1xuXHRjb25zdCB7IHdvcmtzcGFjZSB9ID0gZ2V0VGhhdCgpO1xuXHRpZiAoXG5cdFx0YWxsVGFiTmFtZXNcblx0XHRcdC5maWx0ZXIoKHYsIGkpID0+IGkgIT0gY3VyclRhYklkeClcblx0XHRcdC5mbGF0KClcblx0XHRcdC5pbmNsdWRlcyhmaWxlKSAmJlxuXHRcdCFyaWdodEFkamFjZW50VGFiTmFtZXMuaW5jbHVkZXMoZmlsZSkgJiZcblx0XHQhbGVmdEFkamFjZW50VGFiTmFtZXMuaW5jbHVkZXMoZmlsZSlcblx0KSB7XG5cdFx0Ly8gZmlsZSBleGlzdHMsIG5vdCBhZGphY2VudCBsZWZ0IG9yIHJpZ2h0IHRhYlxuXHRcdGxldCBjdXJyZW50VGFiTmFtZXM6IGFueVtdID0gW107XG5cdFx0bGV0IGN1cnJlbnRUYWI6IGFueVtdID0gW107XG5cdFx0YWxsVGFiTmFtZXMuZm9yRWFjaCgodGFiTmFtZXMsIGkpID0+IHtcblx0XHRcdGlmIChcblx0XHRcdFx0dGFiTmFtZXMgIT0gcmlnaHRBZGphY2VudFRhYk5hbWVzICYmXG5cdFx0XHRcdHRhYk5hbWVzICE9IGxlZnRBZGphY2VudFRhYk5hbWVzICYmXG5cdFx0XHRcdGN1cnJUYWJJZHggIT0gaVxuXHRcdFx0KSB7XG5cdFx0XHRcdGlmICh0YWJOYW1lcy5pbmNsdWRlcyhmaWxlKSkge1xuXHRcdFx0XHRcdGN1cnJlbnRUYWJOYW1lcyA9IHRhYk5hbWVzO1xuXHRcdFx0XHRcdGN1cnJlbnRUYWIgPSBsZWF2ZXNCeVRhYltpXTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0Y29uc3Qgb3JpZ2luYWxMZWFmID0gY3VycmVudFRhYi5maWx0ZXIoXG5cdFx0XHQodCkgPT4gdC5jb250YWluZXJFbC5zdHlsZS5kaXNwbGF5ICE9IFwibm9uZVwiXG5cdFx0KVswXTtcblx0XHRsZXQgbGVhZiA9IGN1cnJlbnRUYWJbY3VycmVudFRhYk5hbWVzLmluZGV4T2YoZmlsZSldO1xuXHRcdHdvcmtzcGFjZS5yZXZlYWxMZWFmKGxlYWYpO1xuXG5cdFx0Y29uc29sZS5sb2coXCJvcGVuIGZpbGUgbmV3IHRhYlwiKTtcblxuXHRcdHJldHVybiB7IG5ld0xlYWY6IGxlYWYsIHRlbXA6IGZhbHNlLCBvcmlnaW5hbExlYWYgfTtcblx0fSBlbHNlIGlmIChyaWdodEFkamFjZW50VGFiTmFtZXMuaW5jbHVkZXMoZmlsZSkpIHtcblx0XHQvLyBmaWxlIGV4aXN0cyBpbiByaWdodCB0YWJcblx0XHRjb25zdCBvcmlnaW5hbExlYWYgPSByaWdodEFkamFjZW50VGFiLmZpbHRlcihcblx0XHRcdCh0KSA9PiB0LmNvbnRhaW5lckVsLnN0eWxlLmRpc3BsYXkgIT0gXCJub25lXCJcblx0XHQpWzBdO1xuXHRcdGxldCBsZWFmID0gcmlnaHRBZGphY2VudFRhYltyaWdodEFkamFjZW50VGFiTmFtZXMuaW5kZXhPZihmaWxlKV07XG5cdFx0d29ya3NwYWNlLnJldmVhbExlYWYobGVhZik7XG5cblx0XHRjb25zb2xlLmxvZyhcIm9wZW4gZXhpc3RpbmcgZmlsZSByaWdodCB0YWJcIik7XG5cblx0XHRyZXR1cm4geyBuZXdMZWFmOiBsZWFmLCB0ZW1wOiBmYWxzZSwgb3JpZ2luYWxMZWFmIH07XG5cdH0gZWxzZSBpZiAobGVmdEFkamFjZW50VGFiTmFtZXMuaW5jbHVkZXMoZmlsZSkpIHtcblx0XHQvLyBmaWxlIGV4aXN0cyBpbiBsZWZ0IHRhYlxuXHRcdGNvbnN0IG9yaWdpbmFsTGVhZiA9IGxlZnRBZGphY2VudFRhYi5maWx0ZXIoXG5cdFx0XHQodCkgPT4gdC5jb250YWluZXJFbC5zdHlsZS5kaXNwbGF5ICE9IFwibm9uZVwiXG5cdFx0KVswXTtcblxuXHRcdGxldCBsZWFmID0gbGVmdEFkamFjZW50VGFiW2xlZnRBZGphY2VudFRhYk5hbWVzLmluZGV4T2YoZmlsZSldO1xuXHRcdHdvcmtzcGFjZS5yZXZlYWxMZWFmKGxlYWYpO1xuXG5cdFx0Y29uc29sZS5sb2coXCJvcGVuIGV4aXN0aW5nIGZpbGUgbGVmdCB0YWJcIik7XG5cblx0XHRyZXR1cm4geyBuZXdMZWFmOiBsZWFmLCB0ZW1wOiBmYWxzZSwgb3JpZ2luYWxMZWFmIH07XG5cdH0gZWxzZSBpZiAocmlnaHRBZGphY2VudFRhYi5sZW5ndGggPiAwKSB7XG5cdFx0Ly8gdGhlcmUgZXhpc3RzIGEgcmlnaHQgdGFiXG5cdFx0Y29uc3Qgb3JpZ2luYWxMZWFmID0gcmlnaHRBZGphY2VudFRhYi5maWx0ZXIoXG5cdFx0XHQodCkgPT4gdC5jb250YWluZXJFbC5zdHlsZS5kaXNwbGF5ICE9IFwibm9uZVwiXG5cdFx0KVswXTtcblxuXHRcdGxldCBjdXJyTGVhZiA9IHdvcmtzcGFjZS5nZXRMZWFmKCk7XG5cdFx0d29ya3NwYWNlLnNldEFjdGl2ZUxlYWYob3JpZ2luYWxMZWFmKTtcblx0XHRsZXQgbmV3TGVhZiA9IHdvcmtzcGFjZS5nZXRMZWFmKHRydWUpO1xuXHRcdGF3YWl0IG9wZW5GaWxlSW5MZWFmKG5ld0xlYWYsIGZpbGUpO1xuXHRcdHdvcmtzcGFjZS5yZXZlYWxMZWFmKG5ld0xlYWYpO1xuXHRcdHdvcmtzcGFjZS5zZXRBY3RpdmVMZWFmKGN1cnJMZWFmKTtcblxuXHRcdGNvbnNvbGUubG9nKFwib3BlbiBuZXcgZmlsZSByaWdodCB0YWJcIik7XG5cblx0XHRyZXR1cm4geyBuZXdMZWFmLCB0ZW1wOiB0cnVlLCBvcmlnaW5hbExlYWYgfTtcblx0fSBlbHNlIGlmIChsZWZ0QWRqYWNlbnRUYWIubGVuZ3RoID4gMCkge1xuXHRcdC8vIHRoZXJlIGV4aXN0cyBhIGxlZnQgdGFiXG5cdFx0Y29uc3Qgb3JpZ2luYWxMZWFmID0gbGVmdEFkamFjZW50VGFiLmZpbHRlcihcblx0XHRcdCh0KSA9PiB0LmNvbnRhaW5lckVsLnN0eWxlLmRpc3BsYXkgIT0gXCJub25lXCJcblx0XHQpWzBdO1xuXG5cdFx0bGV0IGN1cnJMZWFmID0gd29ya3NwYWNlLmdldExlYWYoKTsgLy8gZ2V0IGN1cnJlbnQgYWN0aXZlIGxlYWZcblx0XHR3b3Jrc3BhY2Uuc2V0QWN0aXZlTGVhZihvcmlnaW5hbExlYWYpOyAvLyBnZXQgdGhlIGxlYWYgaW4gYWRqYWNlbnQgdGFiXG5cdFx0bGV0IG5ld0xlYWYgPSB3b3Jrc3BhY2UuZ2V0TGVhZih0cnVlKTsgLy8gY3JlYXRlIGEgbmV3IGxlYWZcblx0XHRhd2FpdCBvcGVuRmlsZUluTGVhZihuZXdMZWFmLCBmaWxlKTsgLy8gbG9hZCBmaWxlIGludG8gbmV3IGxlYWZcblx0XHR3b3Jrc3BhY2UucmV2ZWFsTGVhZihuZXdMZWFmKTsgLy8gcmV2ZWFsIG5ldyBsZWFmXG5cdFx0d29ya3NwYWNlLnNldEFjdGl2ZUxlYWYoY3VyckxlYWYpOyAvLyBzZXQgYWN0aXZlIGxlYWYgYmFjayB0byBvcmlnaW5hbFxuXG5cdFx0Y29uc29sZS5sb2coXCJvcGVuIG5ldyBmaWxlIGxlZnQgdGFiXCIpO1xuXG5cdFx0cmV0dXJuIHsgbmV3TGVhZiwgdGVtcDogdHJ1ZSwgb3JpZ2luYWxMZWFmIH07XG5cdH0gZWxzZSB7XG5cdFx0Ly8gbm8gYWRqYWNlbnQgdGFic1xuXHRcdGNvbnN0IGN1cnJMZWFmID0gd29ya3NwYWNlLmdldExlYWYoKTtcblx0XHRsZXQgbmV3TGVhZiA9IHdvcmtzcGFjZS5jcmVhdGVMZWFmQnlTcGxpdChjdXJyTGVhZik7XG5cdFx0YXdhaXQgb3BlbkZpbGVJbkxlYWYobmV3TGVhZiwgZmlsZSk7XG5cblx0XHRjb25zb2xlLmxvZyhcIm9wZW4gbmV3IGZpbGUgbGVmdCB0YWJcIik7XG5cblx0XHRyZXR1cm4geyBuZXdMZWFmLCB0ZW1wOiB0cnVlLCBvcmlnaW5hbExlYWY6IGN1cnJMZWFmIH07XG5cdH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIG9wZW5GaWxlSW5MZWFmKGxlYWY6IFdvcmtzcGFjZUxlYWYsIGZpbGU6IHN0cmluZykge1xuXHRsZXQgdGFyZ2V0RmlsZTogVEFic3RyYWN0RmlsZSB8IG51bGwgPVxuXHRcdGdldFRoYXQoKS52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZSk7XG5cdGlmICh0YXJnZXRGaWxlICYmIHRhcmdldEZpbGUgaW5zdGFuY2VvZiBURmlsZSlcblx0XHRhd2FpdCBsZWFmLm9wZW5GaWxlKHRhcmdldEZpbGUsIHsgYWN0aXZlOiBmYWxzZSB9KTtcbn1cbiIsICJpbXBvcnQge1xuXHR1cGRhdGVIb3Zlcixcblx0Z2V0SG92ZXIsXG5cdHJlc2V0SG92ZXIsXG5cdGdldFRoYXQsXG5cdGdldEJhY2tsaW5rSG92ZXIsXG5cdHVwZGF0ZUJhY2tsaW5rSG92ZXIsXG5cdHJlc2V0QmFja2xpbmtIb3Zlcixcbn0gZnJvbSBcIi4vc3RhdGVcIjtcbmltcG9ydCB7IEFDVElPTl9UWVBFLCBSRUZFUkVOQ0VfUkVHRVggfSBmcm9tIFwiLi9jb25zdGFudHNcIjtcbmltcG9ydCB7XG5cdGNvbGxlY3RMZWF2ZXNCeVRhYkhlbHBlcixcblx0Z2V0Q3VycmVudFRhYkluZGV4LFxuXHRvcGVuRmlsZUluQWRqYWNlbnRUYWIsXG59IGZyb20gXCIuL3dvcmtzcGFjZVwiO1xuaW1wb3J0IHsgcHJvY2Vzc1VSSSwgZmluZFRleHRQb3NpdGlvbnMgfSBmcm9tIFwiLi91dGlsc1wiO1xuaW1wb3J0IHsgTWFya2Rvd25WaWV3LCBXb3Jrc3BhY2UsIFdvcmtzcGFjZUxlYWYgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7XG5cdGRlZmF1bHRIaWdobGlnaHRTZWxlY3Rpb24sXG5cdGhpZ2hsaWdodFNlbGVjdGlvbixcblx0cmVtb3ZlSGlnaGxpZ2h0LFxufSBmcm9tIFwiLi9tYXJrXCI7XG5pbXBvcnQgeyBFZGl0b3JWaWV3IH0gZnJvbSBcIkBjb2RlbWlycm9yL3ZpZXdcIjtcbmltcG9ydCB7XG5cdGdldEJhY2tsaW5rQ29udGFpbmVyLFxuXHRnZXRDb250YWluZXJFbGVtZW50LFxuXHRnZXRNYXJrZG93blZpZXcsXG59IGZyb20gXCIuL3JlZmVyZW5jZXNcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIGdldEVkaXRvclZpZXcobGVhZjogV29ya3NwYWNlTGVhZikge1xuXHRpZiAoIWxlYWYpIHJldHVybiBudWxsO1xuXHRjb25zdCB2aWV3ID0gbGVhZi52aWV3O1xuXG5cdC8vIEB0cy1pZ25vcmVcblx0Y29uc3QgZWRpdG9yID0gdmlldy5zb3VyY2VNb2RlPy5jbUVkaXRvcjtcblxuXHQvLyAnZWRpdG9yJyBoZXJlIGlzIGFuIGluc3RhbmNlIG9mICdFZGl0b3InLCBhbiBhYnN0cmFjdGlvbiBvdmVyIENNNSBhbmQgQ002LlxuXHQvLyBDaGVja2luZyBmb3IgJ0NvZGVNaXJyb3InIHdvdWxkIGluZGljYXRlIENNNS5cblx0aWYgKCFlZGl0b3IuQ29kZU1pcnJvciAmJiBlZGl0b3IuY20gaW5zdGFuY2VvZiBFZGl0b3JWaWV3KSB7XG5cdFx0Ly8gWW91IG5vdyBoYXZlIGFjY2VzcyB0byB0aGUgQ29kZU1pcnJvciA2IEVkaXRvclZpZXcgaW5zdGFuY2UuXG5cdFx0Y29uc3QgZWRpdG9yVmlldyA9IGVkaXRvci5jbTtcblxuXHRcdHJldHVybiBlZGl0b3JWaWV3O1xuXG5cdFx0Ly8gWW91IGNhbiBub3cgdXNlIHRoZSBDb2RlTWlycm9yIDYgQVBJIHdpdGggYGVkaXRvclZpZXdgLlxuXHR9XG5cdHJldHVybiBudWxsO1xufVxuXG5mdW5jdGlvbiBjaGVja1NwYW5FbGVtZW50RXhpc3RzKFxuXHRzcGFuOiBIVE1MU3BhbkVsZW1lbnQsXG5cdGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudFxuKTogYm9vbGVhbiB7XG5cdGNvbnN0IHNwYW5FbGVtZW50cyA9IGNvbnRhaW5lckVsLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwic3BhblwiKTtcblx0Zm9yIChsZXQgaSA9IDA7IGkgPCBzcGFuRWxlbWVudHMubGVuZ3RoOyBpKyspIHtcblx0XHRpZiAoc3BhbkVsZW1lbnRzW2ldID09PSBzcGFuKSB7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cdH1cblx0cmV0dXJuIGZhbHNlO1xufVxuXG5mdW5jdGlvbiBwYXJzZUNTU1N0cmluZyhjc3M6IHN0cmluZykge1xuXHQvLyBVc2UgYSByZWd1bGFyIGV4cHJlc3Npb24gdG8gbWF0Y2gga2V5LXZhbHVlIHBhaXJzIGluIHRoZSBDU1Mgc3RyaW5nXG5cdGNvbnN0IGNzc1Byb3BlcnRpZXNSZWdleCA9IC8oW1xcdy1dKylcXHMqOlxccyooW147XSspXFxzKjs/L2c7XG5cblx0Ly8gSW5pdGlhbGl6ZSBhbiBlbXB0eSBvYmplY3QgdG8gc3RvcmUgdGhlIENTUyBwcm9wZXJ0aWVzXG5cdGxldCBjc3NQcm9wZXJ0aWVzT2JqZWN0OiBhbnkgPSB7fTtcblxuXHQvLyBJdGVyYXRlIG92ZXIgYWxsIGtleS12YWx1ZSBwYWlycyBmb3VuZCBieSB0aGUgcmVnZXhcblx0bGV0IG1hdGNoO1xuXHR3aGlsZSAoKG1hdGNoID0gY3NzUHJvcGVydGllc1JlZ2V4LmV4ZWMoY3NzKSkgIT09IG51bGwpIHtcblx0XHQvLyBtYXRjaFsxXSBpcyB0aGUga2V5XG5cdFx0Ly8gbWF0Y2hbMl0gaXMgdGhlIHZhbHVlXG5cdFx0Y3NzUHJvcGVydGllc09iamVjdFttYXRjaFsxXV0gPSBtYXRjaFsyXTtcblx0fVxuXG5cdHJldHVybiBjc3NQcm9wZXJ0aWVzT2JqZWN0O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGVsYXkobWlsbGlzZWNvbmRzOiBhbnkpIHtcblx0cmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG5cdFx0c2V0VGltZW91dChyZXNvbHZlLCBtaWxsaXNlY29uZHMpO1xuXHR9KTtcbn1cblxuZnVuY3Rpb24gdGVtcERpcmVjdGlvbkluZGljYXRvcihcblx0bGVhZjogYW55LFxuXHR0ZXh0OiBzdHJpbmcsXG5cdHByZWZpeDogc3RyaW5nLFxuXHRzdWZmaXg6IHN0cmluZyxcblx0ZGF0YVN0cmluZzogc3RyaW5nLFxuXHRpc1NhbWU6IGJvb2xlYW4sXG5cdHVzZXI/OiBzdHJpbmdcbikge1xuXHRpZiAodXNlciA9PT0gQUNUSU9OX1RZUEUuQkFDS0xJTkspIHtcblx0XHQvLyBPaCEgSVx1MjAxOWQgY29tcGFyZSB0aGUgYmJveCBvZiB0aGUgcmFuZ2Vcblx0XHQvLyAod2hpY2ggSSBrbm93IHlvdSBmaW5kIGluIHRoZSBtYXJrIGxheW91dCByb3V0aW5lKVxuXHRcdC8vIHRvIHRoZSBzY3JvbGxUb3AgKyBpbm5lckhlaWdodFxuXHRcdGNvbnN0IGVkaXRvciA9IGdldE1hcmtkb3duVmlldyhsZWFmKS5lZGl0b3I7XG5cdFx0Y29uc3QgYmFja2xpbmtDb250YWluZXIgPSBnZXRCYWNrbGlua0NvbnRhaW5lcihlZGl0b3IpO1xuXG5cdFx0Y29uc3Qgd2luZG93SGVpZ2h0ID0gbGVhZi52aWV3LmNvbnRhaW5lckVsXG5cdFx0XHQucXVlcnlTZWxlY3RvcihcIi5jbS1zY3JvbGxlclwiKVxuXHRcdFx0LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmhlaWdodDtcblx0XHRjb25zdCBzY3JvbGxUb3AgPVxuXHRcdFx0bGVhZi52aWV3LmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoXCIuY20tc2Nyb2xsZXJcIikuc2Nyb2xsVG9wO1xuXHRcdGNvbnN0IHNjcm9sbEJvdHRvbSA9IHNjcm9sbFRvcCArIHdpbmRvd0hlaWdodDtcblxuXHRcdC8vIEdldCB0aGUgZWxlbWVudHMgdGhhdCBhcmUgYmV0d2VlbiB0aGUgdG9wIGFuZCBib3R0b20gb2YgdGhlIHNjcmVlblxuXHRcdC8vIEB0cy1pZ25vcmVcblx0XHRsZXQgY29udGFpbmVyID0gZWRpdG9yLmNvbnRhaW5lckVsO1xuXHRcdGxldCBjb250ZW50ID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCIuY20tY29udGVudFwiKTtcblx0XHRsZXQgcmVmZXJlbmNlcyA9IGNvbnRlbnQucXVlcnlTZWxlY3RvckFsbChcIi5yZWZlcmVuY2UtZGF0YS1zcGFuXCIpO1xuXG5cdFx0bGV0IHZpc2libGVFbGVtZW50czogSFRNTEVsZW1lbnRbXSA9IFtdO1xuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgcmVmZXJlbmNlcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0bGV0IGJib3ggPSByZWZlcmVuY2VzW2ldLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXHRcdFx0aWYgKGJib3gudG9wID49IHNjcm9sbFRvcCAmJiBiYm94LmJvdHRvbSA8PSBzY3JvbGxCb3R0b20pIHtcblx0XHRcdFx0dmlzaWJsZUVsZW1lbnRzLnB1c2gocmVmZXJlbmNlc1tpXSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0bGV0IGRhdGFTdHJpbmdzID0gdmlzaWJsZUVsZW1lbnRzLm1hcCgoZWw6IEhUTUxFbGVtZW50KSA9PlxuXHRcdFx0ZWwuZ2V0QXR0cmlidXRlKFwiZGF0YVwiKVxuXHRcdCk7XG5cblx0XHRsZXQgc3RhcnRUb3AgPSBsZWFmLnZpZXcuZWRpdG9yLmdldFNjcm9sbEluZm8oKS50b3A7XG5cblx0XHRpZiAoIWRhdGFTdHJpbmdzLmluY2x1ZGVzKGRhdGFTdHJpbmcpKSB7XG5cdFx0XHRsZXQgcG9zaXRpb25zID0gZmluZFRleHRQb3NpdGlvbnMoXG5cdFx0XHRcdGxlYWYudmlldy5kYXRhLFxuXHRcdFx0XHR0ZXh0LFxuXHRcdFx0XHRwcmVmaXguc2xpY2UoMCwgcHJlZml4Lmxlbmd0aCAtIDEpLFxuXHRcdFx0XHRzdWZmaXguc2xpY2UoMSwgc3VmZml4Lmxlbmd0aClcblx0XHRcdCk7XG5cdFx0XHRpZiAoIXBvc2l0aW9ucykgdGhyb3cgbmV3IEVycm9yKFwiUG9zaXRpb25zIG5vdCBmb3VuZFwiKTtcblx0XHRcdGxldCByYW5nZVN0YXJ0ID0gcG9zaXRpb25zLnJhbmdlU3RhcnQ7XG5cdFx0XHRsZXQgcmFuZ2VFbmQgPSBwb3NpdGlvbnMucmFuZ2VFbmQ7XG5cblx0XHRcdGxlYWYudmlldy5lZGl0b3Iuc2Nyb2xsSW50b1ZpZXcoXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRmcm9tOiBPYmplY3QuYXNzaWduKHJhbmdlU3RhcnQsIHsgY2g6IDAgfSksXG5cdFx0XHRcdFx0dG86IE9iamVjdC5hc3NpZ24ocmFuZ2VFbmQsIHsgY2g6IDAgfSksXG5cdFx0XHRcdH0sXG5cdFx0XHRcdHRydWVcblx0XHRcdCk7XG5cdFx0fVxuXG5cdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHQvLyBpZiAodGVtcCkgcmV0dXJuO1xuXHRcdFx0bGV0IGVuZFRvcCA9IGxlYWYudmlldy5lZGl0b3IuZ2V0U2Nyb2xsSW5mbygpLnRvcDtcblx0XHRcdGNvbnNvbGUubG9nKGVuZFRvcCk7XG5cblx0XHRcdGxldCBjb250YWluZXIgPSBsZWFmLmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoXCIudmlldy1jb250ZW50XCIpO1xuXHRcdFx0Y29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoXCJuby1zaGFkb3dcIik7XG5cdFx0XHRjb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZShcIm5ldy1zaGFkb3dcIik7XG5cdFx0XHRjb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZShcInRvcC1zaGFkb3dcIik7XG5cdFx0XHRjb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZShcImJvdHRvbS1zaGFkb3dcIik7XG5cblx0XHRcdGlmIChzdGFydFRvcCA9PT0gZW5kVG9wICYmIGlzU2FtZSkge1xuXHRcdFx0XHRjb250YWluZXIuY2xhc3NMaXN0LmFkZChcIm5vLXNoYWRvd1wiKTtcblx0XHRcdH0gZWxzZSBpZiAoc3RhcnRUb3AgPT09IGVuZFRvcCAmJiAhaXNTYW1lKSB7XG5cdFx0XHRcdGNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwibmV3LXNoYWRvd1wiKTtcblx0XHRcdH0gZWxzZSBpZiAoc3RhcnRUb3AgPCBlbmRUb3ApIHtcblx0XHRcdFx0Ly8gc2hvdyBtYXJrIGFib3ZlXG5cdFx0XHRcdGNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwidG9wLXNoYWRvd1wiKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIHNob3cgbWFyayBiZWxvd1xuXHRcdFx0XHRjb250YWluZXIuY2xhc3NMaXN0LmFkZChcImJvdHRvbS1zaGFkb3dcIik7XG5cdFx0XHR9XG5cdFx0fSwgMjUpO1xuXG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0Ly8gT2ghIElcdTIwMTlkIGNvbXBhcmUgdGhlIGJib3ggb2YgdGhlIHJhbmdlXG5cdC8vICh3aGljaCBJIGtub3cgeW91IGZpbmQgaW4gdGhlIG1hcmsgbGF5b3V0IHJvdXRpbmUpXG5cdC8vIHRvIHRoZSBzY3JvbGxUb3AgKyBpbm5lckhlaWdodFxuXHRjb25zdCBlZGl0b3IgPSBnZXRNYXJrZG93blZpZXcobGVhZikuZWRpdG9yO1xuXHRjb25zdCBiYWNrbGlua0NvbnRhaW5lciA9IGdldEJhY2tsaW5rQ29udGFpbmVyKGVkaXRvcik7XG5cblx0Y29uc3Qgd2luZG93SGVpZ2h0ID0gbGVhZi52aWV3LmNvbnRhaW5lckVsXG5cdFx0LnF1ZXJ5U2VsZWN0b3IoXCIuY20tc2Nyb2xsZXJcIilcblx0XHQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0O1xuXHRjb25zdCBzY3JvbGxUb3AgPVxuXHRcdGxlYWYudmlldy5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKFwiLmNtLXNjcm9sbGVyXCIpLnNjcm9sbFRvcDtcblx0Y29uc3Qgc2Nyb2xsQm90dG9tID0gc2Nyb2xsVG9wICsgd2luZG93SGVpZ2h0O1xuXG5cdC8vIEdldCB0aGUgZWxlbWVudHMgdGhhdCBhcmUgYmV0d2VlbiB0aGUgdG9wIGFuZCBib3R0b20gb2YgdGhlIHNjcmVlblxuXHRsZXQgdmlzaWJsZUVsZW1lbnRzOiBzdHJpbmdbXSA9IFtdO1xuXHRmb3IgKGxldCBpID0gMDsgaSA8IGJhY2tsaW5rQ29udGFpbmVyLmNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG5cdFx0bGV0IHN0eWxlID0gYmFja2xpbmtDb250YWluZXIuY2hpbGRyZW5baV0uZ2V0QXR0cmlidXRlKFwic3R5bGVcIik7XG5cdFx0aWYgKHN0eWxlID09IG51bGwpIGNvbnRpbnVlO1xuXHRcdGxldCBjc3NQcm9wZXJ0aWVzID0gcGFyc2VDU1NTdHJpbmcoc3R5bGUpO1xuXHRcdGxldCB0b3AgPSBwYXJzZUZsb2F0KGNzc1Byb3BlcnRpZXNbXCJ0b3BcIl0ucmVwbGFjZShcInB4XCIsIFwiXCIpKTtcblx0XHRpZiAodG9wID09IG51bGwpIGNvbnRpbnVlO1xuXG5cdFx0aWYgKFxuXHRcdFx0c2Nyb2xsVG9wIDw9IHRvcCAmJlxuXHRcdFx0dG9wIDw9IHNjcm9sbEJvdHRvbSAmJlxuXHRcdFx0YmFja2xpbmtDb250YWluZXIuY2hpbGRyZW5baV1cblx0XHQpIHtcblx0XHRcdGxldCByZWZlcmVuY2UgPSBiYWNrbGlua0NvbnRhaW5lci5jaGlsZHJlbltpXS5nZXRBdHRyaWJ1dGUoXCJyZWZlcmVuY2VcIik7XG5cdFx0XHRpZiAocmVmZXJlbmNlKSB7XG5cdFx0XHRcdHZpc2libGVFbGVtZW50cy5wdXNoKEpTT04ucGFyc2UocmVmZXJlbmNlKS5kYXRhU3RyaW5nKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRjb25zb2xlLmxvZyghdmlzaWJsZUVsZW1lbnRzLmluY2x1ZGVzKGRhdGFTdHJpbmcpKTtcblx0Ly8gaWYgKCF2aXNpYmxlRWxlbWVudHMuaW5jbHVkZXMoZGF0YVN0cmluZykpIHtcblx0bGV0IHN0YXJ0VG9wID0gbGVhZi52aWV3LmVkaXRvci5nZXRTY3JvbGxJbmZvKCkudG9wO1xuXG5cdGxldCBwb3NpdGlvbnMgPSBmaW5kVGV4dFBvc2l0aW9ucyhcblx0XHRsZWFmLnZpZXcuZGF0YSxcblx0XHR0ZXh0LFxuXHRcdHByZWZpeC5zbGljZSgwLCBwcmVmaXgubGVuZ3RoIC0gMSksXG5cdFx0c3VmZml4LnNsaWNlKDEsIHN1ZmZpeC5sZW5ndGgpXG5cdCk7XG5cdGlmICghcG9zaXRpb25zKSB0aHJvdyBuZXcgRXJyb3IoXCJQb3NpdGlvbnMgbm90IGZvdW5kXCIpO1xuXHRsZXQgcmFuZ2VTdGFydCA9IHBvc2l0aW9ucy5yYW5nZVN0YXJ0O1xuXHRsZXQgcmFuZ2VFbmQgPSBwb3NpdGlvbnMucmFuZ2VFbmQ7XG5cblx0bGVhZi52aWV3LmVkaXRvci5zY3JvbGxJbnRvVmlldyhcblx0XHR7XG5cdFx0XHRmcm9tOiBPYmplY3QuYXNzaWduKHJhbmdlU3RhcnQsIHsgY2g6IDAgfSksXG5cdFx0XHR0bzogT2JqZWN0LmFzc2lnbihyYW5nZUVuZCwgeyBjaDogMCB9KSxcblx0XHR9LFxuXHRcdHRydWVcblx0KTtcblx0Y29uc29sZS5sb2coc3RhcnRUb3ApO1xuXHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHQvLyBpZiAodGVtcCkgcmV0dXJuO1xuXHRcdGxldCBlbmRUb3AgPSBsZWFmLnZpZXcuZWRpdG9yLmdldFNjcm9sbEluZm8oKS50b3A7XG5cdFx0Y29uc29sZS5sb2coZW5kVG9wKTtcblxuXHRcdGxldCBjb250YWluZXIgPSBsZWFmLmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoXCIudmlldy1jb250ZW50XCIpO1xuXHRcdGNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKFwibm8tc2hhZG93XCIpO1xuXHRcdGNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKFwibmV3LXNoYWRvd1wiKTtcblx0XHRjb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZShcInRvcC1zaGFkb3dcIik7XG5cdFx0Y29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoXCJib3R0b20tc2hhZG93XCIpO1xuXG5cdFx0aWYgKHN0YXJ0VG9wID09PSBlbmRUb3AgJiYgaXNTYW1lKSB7XG5cdFx0XHRjb250YWluZXIuY2xhc3NMaXN0LmFkZChcIm5vLXNoYWRvd1wiKTtcblx0XHR9IGVsc2UgaWYgKHN0YXJ0VG9wID09PSBlbmRUb3AgJiYgIWlzU2FtZSkge1xuXHRcdFx0Y29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJuZXctc2hhZG93XCIpO1xuXHRcdH0gZWxzZSBpZiAoc3RhcnRUb3AgPCBlbmRUb3ApIHtcblx0XHRcdC8vIHNob3cgbWFyayBhYm92ZVxuXHRcdFx0Y29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJ0b3Atc2hhZG93XCIpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBzaG93IG1hcmsgYmVsb3dcblx0XHRcdGNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwiYm90dG9tLXNoYWRvd1wiKTtcblx0XHR9XG5cdH0sIDI1KTtcblx0Ly8gfVxufVxuXG5mdW5jdGlvbiBlbmRFZmZlY3RSZW1vdmVIaWdobGlnaHRzKFxuXHR3b3Jrc3BhY2U6IFdvcmtzcGFjZSxcblx0bGVhZklkOiBzdHJpbmcsXG5cdHV1aWQ6IHN0cmluZyxcblx0YmFja2xpbmtVVUlEPzogc3RyaW5nXG4pIHtcblx0Y29uc3Qgd29ya3NwYWNlQ29udGFpbmVyID0gd29ya3NwYWNlLmNvbnRhaW5lckVsO1xuXHRjb25zdCBzcGFuID0gd29ya3NwYWNlQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCIuXCIgKyB1dWlkKTtcblxuXHRzcGFuPy5wYXJlbnRFbGVtZW50XG5cdFx0Py5xdWVyeVNlbGVjdG9yKFwiLnJlZmVyZW5jZS1zcGFuXCIpXG5cdFx0Py5jbGFzc0xpc3QucmVtb3ZlKFwicmVmZXJlbmNlLXNwYW4tc2VsZWN0ZWRcIik7XG5cdC8vIGZpcnN0U3BhblBhcnQ/LmNsYXNzTGlzdC5yZW1vdmUodXVpZCk7XG5cdHNwYW4/LmNsYXNzTGlzdC5yZW1vdmUoXCJyZWZlcmVuY2UtZGF0YS1zcGFuLXNlbGVjdGVkXCIpO1xuXG5cdGlmIChiYWNrbGlua1VVSUQpIHtcblx0XHRjb25zdCBiYWNrbGlua1NwYW4gPSB3b3Jrc3BhY2VDb250YWluZXIucXVlcnlTZWxlY3RvcihcIi5cIiArIGJhY2tsaW5rVVVJRCk7XG5cblx0XHRiYWNrbGlua1NwYW4/LnBhcmVudEVsZW1lbnRcblx0XHRcdD8ucXVlcnlTZWxlY3RvcihcIi5yZWZlcmVuY2Utc3BhblwiKVxuXHRcdFx0Py5jbGFzc0xpc3QucmVtb3ZlKFwicmVmZXJlbmNlLXNwYW4tc2VsZWN0ZWRcIik7XG5cdFx0YmFja2xpbmtTcGFuPy5jbGFzc0xpc3QucmVtb3ZlKFwicmVmZXJlbmNlLWRhdGEtc3Bhbi1zZWxlY3RlZFwiKTtcblx0fVxuXG5cdGxldCB0YXJnZXRMZWFmID0gd29ya3NwYWNlLmdldExlYWZCeUlkKGxlYWZJZCk7XG5cdGlmICghdGFyZ2V0TGVhZikge1xuXHRcdC8vIHJlc2V0Q3Vyc29yKCk7XG5cdFx0dGhyb3cgbmV3IEVycm9yKFwiVGFyZ2V0IGxlYWYgbm90IGZvdW5kXCIpO1xuXHR9XG5cblx0Ly8gcmVtb3ZlIGJveCBzaGFkb3dzIGlmIGFueVxuXHRsZXQgY29udGFpbmVyID1cblx0XHRnZXRDb250YWluZXJFbGVtZW50KHRhcmdldExlYWYpPy5xdWVyeVNlbGVjdG9yKFwiLnZpZXctY29udGVudFwiKTtcblxuXHRpZiAoY29udGFpbmVyKSB7XG5cdFx0Y29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoXCJuby1zaGFkb3dcIik7XG5cdFx0Y29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoXCJuZXctc2hhZG93XCIpO1xuXHRcdGNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKFwidG9wLXNoYWRvd1wiKTtcblx0XHRjb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZShcImJvdHRvbS1zaGFkb3dcIik7XG5cdH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHN0YXJ0QmFja2xpbmtFZmZlY3Qoc3BhbjogSFRNTFNwYW5FbGVtZW50KSB7XG5cdGxldCBzb3VyY2UgPSBnZXRCYWNrbGlua0hvdmVyKCk7XG5cdGxldCB1cGRhdGVTdGF0ZSA9IHVwZGF0ZUJhY2tsaW5rSG92ZXI7XG5cblx0Ly8gTXV0ZXgsIHByZXZlbnQgY29uY3VycmVudCBhY2Nlc3MgdG8gZm9sbG93aW5nIHNlY3Rpb24gb2YgY29kZVxuXHRpZiAoc291cmNlICE9IG51bGwpIHJldHVybjtcblx0dXBkYXRlU3RhdGUoe1xuXHRcdHR5cGU6IGAke0FDVElPTl9UWVBFLkJBQ0tMSU5LfS1zdGFydGAsXG5cdH0pO1xuXG5cdGlmICghc3BhbikgcmV0dXJuO1xuXG5cdC8vIFRvZ2dsZSBob3ZlciBzdGF0ZVxuXHRsZXQgdXVpZCA9IEFycmF5LmZyb20oc3Bhbi5jbGFzc0xpc3QpLmZpbHRlcigoZWwpID0+IGVsLmluY2x1ZGVzKFwidXVpZFwiKSlbMF07XG5cdHNwYW4ucGFyZW50RWxlbWVudFxuXHRcdD8ucXVlcnlTZWxlY3RvcihcIi5yZWZlcmVuY2Utc3BhblwiKVxuXHRcdD8uY2xhc3NMaXN0LmFkZChcInJlZmVyZW5jZS1zcGFuLXNlbGVjdGVkXCIpO1xuXG5cdHNwYW4uY2xhc3NMaXN0LmFkZChcInJlZmVyZW5jZS1kYXRhLXNwYW4tc2VsZWN0ZWRcIik7XG5cblx0dXBkYXRlU3RhdGUoe1xuXHRcdHV1aWQsXG5cdH0pO1xuXG5cdGNvbnN0IHJlZmVyZW5jZURhdGEgPSBzcGFuLmdldEF0dHJpYnV0ZShcInJlZmVyZW5jZVwiKTtcblx0aWYgKCFyZWZlcmVuY2VEYXRhKSB0aHJvdyBuZXcgRXJyb3IoXCJSZWZlcmVuY2UgZGF0YSBub3QgZm91bmRcIik7XG5cblx0Y29uc3QgYmFja2xpbmsgPSBKU09OLnBhcnNlKHJlZmVyZW5jZURhdGEpO1xuXHRjb25zdCBkYXRhU3RyaW5nID0gYmFja2xpbmsuZGF0YVN0cmluZztcblxuXHRsZXQgW3ByZWZpeCwgdGV4dCwgc3VmZml4LCBmaWxlLCBmcm9tLCB0b10gPSBwcm9jZXNzVVJJKGRhdGFTdHJpbmcpO1xuXG5cdC8vIGdldCBiYWNrbGluayBsZWFmXG5cdGxldCBsZWF2ZXNCeVRhYiA9IGNvbGxlY3RMZWF2ZXNCeVRhYkhlbHBlcigpO1xuXG5cdGxldCBjdXJyVGFiSWR4ID0gZ2V0Q3VycmVudFRhYkluZGV4KGxlYXZlc0J5VGFiLCBzcGFuKTtcblxuXHRsZXQgYmFja2xpbmtMZWFmID0gbGVhdmVzQnlUYWJbY3VyclRhYklkeF0uZmlsdGVyKChsZWFmOiBXb3Jrc3BhY2VMZWFmKSA9PiB7XG5cdFx0bGV0IGNvbnRhaW5lckVsID0gZ2V0Q29udGFpbmVyRWxlbWVudChsZWFmKTtcblx0XHRjb25zdCBleGlzdHMgPSBjaGVja1NwYW5FbGVtZW50RXhpc3RzKHNwYW4sIGNvbnRhaW5lckVsKTtcblx0XHRyZXR1cm4gZXhpc3RzO1xuXHR9KVswXTtcblxuXHQvLyBAdHMtaWdub3JlXG5cdGxldCBiYWNrbGlua0xlYWZJRCA9IGJhY2tsaW5rTGVhZi5pZDtcblx0aWYgKCFiYWNrbGlua0xlYWZJRCkgdGhyb3cgbmV3IEVycm9yKFwiTGVhZiBpZCBub3QgZm91bmRcIik7XG5cblx0aWYgKGJhY2tsaW5rTGVhZiAmJiBiYWNrbGlua0xlYWYudmlldyBpbnN0YW5jZW9mIE1hcmtkb3duVmlldykge1xuXHRcdGNvbnN0IGVkaXRvclZpZXc6IEVkaXRvclZpZXcgPSBnZXRFZGl0b3JWaWV3KGJhY2tsaW5rTGVhZik7XG5cdFx0aWYgKCFlZGl0b3JWaWV3KSB0aHJvdyBuZXcgRXJyb3IoXCJFZGl0b3IgdmlldyBub3QgZm91bmRcIik7XG5cdFx0Y29uc3Qgdmlld3BvcnQgPSBiYWNrbGlua0xlYWYudmlldy5lZGl0b3IuZ2V0U2Nyb2xsSW5mbygpO1xuXG5cdFx0cmVtb3ZlSGlnaGxpZ2h0KGVkaXRvclZpZXcsIGZyb20sIHRvKTtcblx0XHRoaWdobGlnaHRTZWxlY3Rpb24oZWRpdG9yVmlldywgZnJvbSwgdG8pO1xuXHRcdC8vIGxldCBwb3NpdGlvbnMgPSBmaW5kVGV4dFBvc2l0aW9ucyhcblx0XHQvLyBcdGJhY2tsaW5rTGVhZi52aWV3LmRhdGEsXG5cdFx0Ly8gXHR0ZXh0LFxuXHRcdC8vIFx0cHJlZml4LnNsaWNlKDAsIHByZWZpeC5sZW5ndGggLSAxKSxcblx0XHQvLyBcdHN1ZmZpeC5zbGljZSgxLCBzdWZmaXgubGVuZ3RoKVxuXHRcdC8vICk7XG5cdFx0Ly8gaWYgKCFwb3NpdGlvbnMpIHRocm93IG5ldyBFcnJvcihcIlBvc2l0aW9ucyBub3QgZm91bmRcIik7XG5cblx0XHR1cGRhdGVTdGF0ZSh7XG5cdFx0XHRkYXRhU3RyaW5nLFxuXHRcdFx0b3JpZ2luYWxUb3A6IGVkaXRvclZpZXcuZG9jdW1lbnRUb3AsXG5cdFx0XHRiYWNrbGlua0xlYWZJZDogYmFja2xpbmtMZWFmSUQsXG5cdFx0fSk7XG5cdH1cblxuXHRsZXQgcmVmZXJlbmNpbmdGaWxlID0gYmFja2xpbmsucmVmZXJlbmNpbmdMb2NhdGlvbi5maWxlbmFtZTtcblxuXHQvLyBpZiAoY3VyclRhYklkeCAhPSAtMSkge1xuXHQvLyAmJiBjdXJyVGFiICE9IC0xKSB7XG5cdC8vIC8vIENoZWNrIGFkamFjZW50IHRhYnMgZm9yIGZpbGUgYW5kIG9wZW4gZmlsZSBpZiBuZWVkZWRcblx0Y29uc3QgeyBuZXdMZWFmLCB0ZW1wLCBvcmlnaW5hbExlYWYgfSA9IGF3YWl0IG9wZW5GaWxlSW5BZGphY2VudFRhYihcblx0XHRsZWF2ZXNCeVRhYixcblx0XHRjdXJyVGFiSWR4LFxuXHRcdHJlZmVyZW5jaW5nRmlsZVxuXHQpO1xuXG5cdC8vIEB0cy1pZ25vcmVcblx0bGV0IGlkID0gbmV3TGVhZi5pZDtcblx0aWYgKCFpZCkgdGhyb3cgbmV3IEVycm9yKFwiTGVhZiBpZCBub3QgZm91bmRcIik7XG5cdHVwZGF0ZVN0YXRlKHtcblx0XHRsZWFmSWQ6IGlkLFxuXHRcdHRlbXAsXG5cdFx0cGVlazogdHJ1ZSxcblx0fSk7XG5cblx0Y29uc3Qgb3JpZ2luYWxMZWFmSWQgPSBvcmlnaW5hbExlYWYuaWQ7XG5cblx0Y29uc3QgbWF0Y2hlcyA9IFtcblx0XHQuLi5iYWNrbGluay5yZWZlcmVuY2luZ0xvY2F0aW9uLnRleHQubWF0Y2hBbGwoUkVGRVJFTkNFX1JFR0VYKSxcblx0XTtcblx0aWYgKG1hdGNoZXMubGVuZ3RoID09IDApIHRocm93IG5ldyBFcnJvcihcIk1hdGNoZXMgbm90IGZvdW5kXCIpO1xuXHQvLyBUaGlzIG9uZSBzd2l0Y2gsIHRoaXMgb25lIGRvZXMgdGhlIGNvcnJlY3Qgc2Nyb2xsXG5cdC8vIHRlbXBEaXJlY3Rpb25JbmRpY2F0b3IobmV3TGVhZiwgdGV4dCwgcHJlZml4LCBzdWZmaXgsIGRhdGFTdHJpbmcpO1xuXG5cdC8vIFRoaXMgb25lIGRvZXMgdGhlIGNvcnJlY3QgZ3JhYmJpbmcgb2Ygc3BhbiBlbGVtZW50c1xuXHR0ZW1wRGlyZWN0aW9uSW5kaWNhdG9yKFxuXHRcdG5ld0xlYWYsXG5cdFx0YmFja2xpbmsucmVmZXJlbmNpbmdMb2NhdGlvbi50ZXh0LFxuXHRcdGJhY2tsaW5rLnJlZmVyZW5jaW5nTG9jYXRpb24ucHJlZml4ICsgXCItXCIsXG5cdFx0XCItXCIgKyBiYWNrbGluay5yZWZlcmVuY2luZ0xvY2F0aW9uLnN1ZmZpeCxcblx0XHRtYXRjaGVzWzBdWzFdLFxuXHRcdGlkID09PSBvcmlnaW5hbExlYWZJZCxcblx0XHRBQ1RJT05fVFlQRS5CQUNLTElOS1xuXHQpO1xuXG5cdGNvbnN0IGN1cnNvclZpZXdwb3J0ID0gbmV3TGVhZi52aWV3LmVkaXRvci5nZXRTY3JvbGxJbmZvKCk7XG5cblx0dXBkYXRlU3RhdGUoe1xuXHRcdGN1cnNvclZpZXdwb3J0LFxuXHR9KTtcblxuXHRsZXQgYmFja2xpbmtTcGFuOiBIVE1MU3BhbkVsZW1lbnQgPSBuZXdMZWFmLmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoXG5cdFx0YHNwYW5bZGF0YT1cIiR7YmFja2xpbmsuZGF0YVN0cmluZ31cIl1gXG5cdCk7XG5cblx0Ly8gQ2FuJ3QgZ3VhcmFudGVlIHRoYXQgdGhpcyB3aWxsIGJlIHZpc2libGUuXG5cdGlmIChiYWNrbGlua1NwYW4pIHtcblx0XHRsZXQgYmFja2xpbmtVVUlEID0gQXJyYXkuZnJvbShiYWNrbGlua1NwYW4uY2xhc3NMaXN0KS5maWx0ZXIoKGVsKSA9PlxuXHRcdFx0ZWwuaW5jbHVkZXMoXCJ1dWlkXCIpXG5cdFx0KVswXTtcblx0XHRiYWNrbGlua1NwYW4ucGFyZW50RWxlbWVudFxuXHRcdFx0Py5xdWVyeVNlbGVjdG9yKFwiLnJlZmVyZW5jZS1zcGFuXCIpXG5cdFx0XHQ/LmNsYXNzTGlzdC5hZGQoXCJyZWZlcmVuY2Utc3Bhbi1zZWxlY3RlZFwiKTtcblxuXHRcdGJhY2tsaW5rU3Bhbi5jbGFzc0xpc3QuYWRkKFwicmVmZXJlbmNlLWRhdGEtc3Bhbi1zZWxlY3RlZFwiKTtcblxuXHRcdHVwZGF0ZVN0YXRlKHtcblx0XHRcdGJhY2tsaW5rVVVJRCxcblx0XHR9KTtcblx0fVxuXG5cdC8vIEB0cy1pZ25vcmVcblx0aWYgKG9yaWdpbmFsTGVhZklkKSB7XG5cdFx0dXBkYXRlU3RhdGUoe1xuXHRcdFx0b3JpZ2luYWxMZWFmSWQsXG5cdFx0fSk7XG5cdH1cblxuXHRyZXR1cm47XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzdGFydFJlZmVyZW5jZUVmZmVjdChcblx0c3BhbjogSFRNTFNwYW5FbGVtZW50IHwgbnVsbCB8IHVuZGVmaW5lZCxcblx0dHlwZTogc3RyaW5nXG4pIHtcblx0bGV0IHNvdXJjZSA9IGdldEhvdmVyKCk7XG5cdGxldCB1cGRhdGVTdGF0ZSA9IHVwZGF0ZUhvdmVyO1xuXG5cdC8vIE11dGV4LCBwcmV2ZW50IGNvbmN1cnJlbnQgYWNjZXNzIHRvIGZvbGxvd2luZyBzZWN0aW9uIG9mIGNvZGVcblx0aWYgKHNvdXJjZSAhPSBudWxsKSByZXR1cm47XG5cblx0dXBkYXRlU3RhdGUoe1xuXHRcdHR5cGU6IGAke3R5cGV9LXN0YXJ0YCxcblx0fSk7XG5cblx0aWYgKCFzcGFuKSByZXR1cm47XG5cblx0Ly8gY29sb3IgdGhlIHNwYW5cblx0bGV0IHV1aWQgPSBBcnJheS5mcm9tKHNwYW4uY2xhc3NMaXN0KS5maWx0ZXIoKGVsKSA9PiBlbC5pbmNsdWRlcyhcInV1aWRcIikpWzBdO1xuXHRzcGFuLnBhcmVudEVsZW1lbnRcblx0XHQ/LnF1ZXJ5U2VsZWN0b3IoXCIucmVmZXJlbmNlLXNwYW5cIilcblx0XHQ/LmNsYXNzTGlzdC5hZGQoXCJyZWZlcmVuY2Utc3Bhbi1zZWxlY3RlZFwiKTtcblxuXHRzcGFuLmNsYXNzTGlzdC5hZGQoXCJyZWZlcmVuY2UtZGF0YS1zcGFuLXNlbGVjdGVkXCIpO1xuXG5cdHVwZGF0ZVN0YXRlKHtcblx0XHR1dWlkLFxuXHR9KTtcblxuXHRjb25zdCBkYXRhU3RyaW5nID0gc3Bhbi5nZXRBdHRyaWJ1dGUoXCJkYXRhXCIpO1xuXHRpZiAoIWRhdGFTdHJpbmcpIHRocm93IG5ldyBFcnJvcihcIkRhdGEgc3RyaW5nIG5vdCBmb3VuZFwiKTtcblxuXHRsZXQgW3ByZWZpeCwgdGV4dCwgc3VmZml4LCBmaWxlLCBmcm9tLCB0b10gPSBwcm9jZXNzVVJJKGRhdGFTdHJpbmcpO1xuXG5cdGxldCBsZWF2ZXNCeVRhYiA9IGNvbGxlY3RMZWF2ZXNCeVRhYkhlbHBlcigpO1xuXG5cdGxldCBjdXJyVGFiSWR4ID0gZ2V0Q3VycmVudFRhYkluZGV4KGxlYXZlc0J5VGFiLCBzcGFuKTtcblxuXHRjb25zdCB7IG5ld0xlYWYsIHRlbXAsIG9yaWdpbmFsTGVhZiB9ID0gYXdhaXQgb3BlbkZpbGVJbkFkamFjZW50VGFiKFxuXHRcdGxlYXZlc0J5VGFiLFxuXHRcdGN1cnJUYWJJZHgsXG5cdFx0ZmlsZSxcblx0XHR0eXBlXG5cdCk7XG5cblx0Ly8gQHRzLWlnbm9yZVxuXHRsZXQgaWQgPSBuZXdMZWFmLmlkO1xuXHRpZiAoIWlkKSB0aHJvdyBuZXcgRXJyb3IoXCJMZWFmIGlkIG5vdCBmb3VuZFwiKTtcblx0dXBkYXRlU3RhdGUoe1xuXHRcdGxlYWZJZDogaWQsXG5cdFx0dGVtcCxcblx0XHRwZWVrOiB0cnVlLFxuXHR9KTtcblxuXHQvLyBAdHMtaWdub3JlXG5cdGNvbnN0IG9yaWdpbmFsTGVhZklkID0gb3JpZ2luYWxMZWFmLmlkO1xuXG5cdGlmIChuZXdMZWFmICYmIG5ld0xlYWYudmlldyBpbnN0YW5jZW9mIE1hcmtkb3duVmlldykge1xuXHRcdGNvbnN0IGVkaXRvclZpZXc6IEVkaXRvclZpZXcgPSBnZXRFZGl0b3JWaWV3KG5ld0xlYWYpO1xuXHRcdGlmICghZWRpdG9yVmlldykgdGhyb3cgbmV3IEVycm9yKFwiRWRpdG9yIHZpZXcgbm90IGZvdW5kXCIpO1xuXHRcdGNvbnN0IHZpZXdwb3J0ID0gbmV3TGVhZi52aWV3LmVkaXRvci5nZXRTY3JvbGxJbmZvKCk7XG5cblx0XHRyZW1vdmVIaWdobGlnaHQoZWRpdG9yVmlldywgZnJvbSwgdG8pO1xuXHRcdGhpZ2hsaWdodFNlbGVjdGlvbihlZGl0b3JWaWV3LCBmcm9tLCB0byk7XG5cblx0XHR0ZW1wRGlyZWN0aW9uSW5kaWNhdG9yKFxuXHRcdFx0bmV3TGVhZixcblx0XHRcdHRleHQsXG5cdFx0XHRwcmVmaXgsXG5cdFx0XHRzdWZmaXgsXG5cdFx0XHRkYXRhU3RyaW5nLFxuXHRcdFx0aWQgPT09IG9yaWdpbmFsTGVhZklkXG5cdFx0KTtcblxuXHRcdGNvbnN0IGN1cnNvclZpZXdwb3J0ID0gbmV3TGVhZi52aWV3LmVkaXRvci5nZXRTY3JvbGxJbmZvKCk7XG5cblx0XHR1cGRhdGVTdGF0ZSh7XG5cdFx0XHRkYXRhU3RyaW5nLFxuXHRcdFx0b3JpZ2luYWxUb3A6IGVkaXRvclZpZXcuZG9jdW1lbnRUb3AsXG5cdFx0XHRjdXJzb3JWaWV3cG9ydCxcblx0XHR9KTtcblx0fVxuXG5cdGlmIChvcmlnaW5hbExlYWZJZCkge1xuXHRcdHVwZGF0ZVN0YXRlKHtcblx0XHRcdG9yaWdpbmFsTGVhZklkLFxuXHRcdH0pO1xuXHR9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBlbmRSZWZlcmVuY2VIb3ZlckVmZmVjdCgpIHtcblx0aWYgKCFnZXRIb3ZlcigpIHx8IE9iamVjdC5rZXlzKGdldEhvdmVyKCkpLmxlbmd0aCA9PSAwKSB7XG5cdFx0Ly8gRW5kIG11dGV4IGxvY2tcblx0XHRyZXNldEhvdmVyKCk7XG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0bGV0IHsgZGF0YVN0cmluZywgbGVhZklkLCBvcmlnaW5hbExlYWZJZCwgdGVtcCwgY3Vyc29yVmlld3BvcnQsIHBlZWssIHV1aWQgfSA9XG5cdFx0Z2V0SG92ZXIoKTtcblx0cmVzZXRIb3ZlcigpO1xuXG5cdGNvbnN0IHsgd29ya3NwYWNlIH0gPSBnZXRUaGF0KCk7XG5cdGxldCB0YXJnZXRMZWFmID0gd29ya3NwYWNlLmdldExlYWZCeUlkKGxlYWZJZCk7XG5cdGVuZEVmZmVjdFJlbW92ZUhpZ2hsaWdodHMod29ya3NwYWNlLCBsZWFmSWQsIHV1aWQpO1xuXG5cdGxldCBlZGl0b3JWaWV3ID0gZ2V0RWRpdG9yVmlldyh0YXJnZXRMZWFmKTtcblxuXHRsZXQgW3ByZWZpeCwgdGV4dCwgc3VmZml4LCBmaWxlLCBmcm9tLCB0b10gPSBwcm9jZXNzVVJJKGRhdGFTdHJpbmcpO1xuXHRyZW1vdmVIaWdobGlnaHQoZWRpdG9yVmlldywgZnJvbSwgdG8pO1xuXHRkZWZhdWx0SGlnaGxpZ2h0U2VsZWN0aW9uKGVkaXRvclZpZXcsIGZyb20sIHRvKTtcblxuXHQvLyByZW1vdmVIaWdobGlnaHRzKGVkaXRvclZpZXcpO1xuXG5cdGlmIChjdXJzb3JWaWV3cG9ydCAmJiB0YXJnZXRMZWFmICYmIHRhcmdldExlYWYudmlldyBpbnN0YW5jZW9mIE1hcmtkb3duVmlldykge1xuXHRcdGNvbnN0IHZpZXc6IE1hcmtkb3duVmlldyA9IHRhcmdldExlYWYudmlldztcblx0XHR2aWV3LmVkaXRvci5zY3JvbGxUbygwLCBjdXJzb3JWaWV3cG9ydC50b3ApO1xuXG5cdFx0bGV0IGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCA9IGdldENvbnRhaW5lckVsZW1lbnQodGFyZ2V0TGVhZik7XG5cdFx0aWYgKGNvbnRhaW5lckVsICE9IG51bGwpIHtcblx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHQvLyBAdHMtaWdub3JlXG5cdFx0XHRcdGNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoXCIudmlldy1jb250ZW50XCIpPy5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcIlwiKTtcblx0XHRcdH0sIDUwKTtcblx0XHR9XG5cdH1cblxuXHRpZiAodGVtcCAmJiB0YXJnZXRMZWFmKSB7XG5cdFx0dGFyZ2V0TGVhZi5kZXRhY2goKTtcblxuXHRcdGxldCBvcmlnaW5hbExlYWYgPSB3b3Jrc3BhY2UuZ2V0TGVhZkJ5SWQob3JpZ2luYWxMZWFmSWQpO1xuXHRcdGlmICghb3JpZ2luYWxMZWFmKSB0aHJvdyBuZXcgRXJyb3IoXCJPcmlnaW5hbCBsZWFmIG5vdCBmb3VuZFwiKTtcblxuXHRcdHdvcmtzcGFjZS5yZXZlYWxMZWFmKG9yaWdpbmFsTGVhZik7XG5cdH1cblxuXHRpZiAocGVlaykge1xuXHRcdGxldCBvcmlnaW5hbExlYWYgPSB3b3Jrc3BhY2UuZ2V0TGVhZkJ5SWQob3JpZ2luYWxMZWFmSWQpO1xuXHRcdGlmICghb3JpZ2luYWxMZWFmKSB7XG5cdFx0XHRyZXNldEhvdmVyKCk7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoXCJPcmlnaW5hbCBsZWFmIG5vdCBmb3VuZFwiKTtcblx0XHR9XG5cblx0XHR3b3Jrc3BhY2UucmV2ZWFsTGVhZihvcmlnaW5hbExlYWYpO1xuXHR9XG5cblx0Ly8gRW5kIG11dGV4IGxvY2tcblx0cmVzZXRIb3ZlcigpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZW5kQmFja2xpbmtIb3ZlckVmZmVjdCgpIHtcblx0aWYgKCFnZXRCYWNrbGlua0hvdmVyKCkgfHwgT2JqZWN0LmtleXMoZ2V0QmFja2xpbmtIb3ZlcigpKS5sZW5ndGggPT0gMCkge1xuXHRcdC8vIEVuZCBtdXRleCBsb2NrXG5cdFx0cmVzZXRCYWNrbGlua0hvdmVyKCk7XG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0Y29uc3Qge1xuXHRcdGRhdGFTdHJpbmcsXG5cdFx0bGVhZklkLFxuXHRcdG9yaWdpbmFsTGVhZklkLFxuXHRcdGJhY2tsaW5rTGVhZklkLFxuXHRcdHRlbXAsXG5cdFx0Y3Vyc29yVmlld3BvcnQsXG5cdFx0cGVlayxcblx0XHR1dWlkLFxuXHRcdGJhY2tsaW5rVVVJRCxcblx0fSA9IGdldEJhY2tsaW5rSG92ZXIoKTtcblx0cmVzZXRCYWNrbGlua0hvdmVyKCk7XG5cblx0Y29uc3QgeyB3b3Jrc3BhY2UgfSA9IGdldFRoYXQoKTtcblx0bGV0IHRhcmdldExlYWYgPSB3b3Jrc3BhY2UuZ2V0TGVhZkJ5SWQobGVhZklkKTtcblx0ZW5kRWZmZWN0UmVtb3ZlSGlnaGxpZ2h0cyh3b3Jrc3BhY2UsIGxlYWZJZCwgdXVpZCwgYmFja2xpbmtVVUlEKTtcblxuXHRpZiAoY3Vyc29yVmlld3BvcnQgJiYgdGFyZ2V0TGVhZiAmJiB0YXJnZXRMZWFmLnZpZXcgaW5zdGFuY2VvZiBNYXJrZG93blZpZXcpIHtcblx0XHRjb25zdCB2aWV3OiBNYXJrZG93blZpZXcgPSB0YXJnZXRMZWFmLnZpZXc7XG5cdFx0dmlldy5lZGl0b3Iuc2Nyb2xsVG8oMCwgY3Vyc29yVmlld3BvcnQudG9wKTtcblx0fVxuXG5cdGxldCBjb250YWluZXJFbDogSFRNTEVsZW1lbnQgPSBnZXRDb250YWluZXJFbGVtZW50KHRhcmdldExlYWYpO1xuXHRpZiAoY29udGFpbmVyRWwgIT0gbnVsbCkge1xuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0Ly8gQHRzLWlnbm9yZVxuXHRcdFx0Y29udGFpbmVyRWwucXVlcnlTZWxlY3RvcihcIi52aWV3LWNvbnRlbnRcIik/LnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiXCIpO1xuXHRcdH0sIDUwKTtcblx0fVxuXG5cdGxldCBbcHJlZml4LCB0ZXh0LCBzdWZmaXgsIGZpbGUsIGZyb20sIHRvXSA9IHByb2Nlc3NVUkkoZGF0YVN0cmluZyk7XG5cdC8vIGJhY2tsaW5rIGVmZmVjdFxuXHRjb25zdCBvcmlnaW5hbExlYWYgPSB3b3Jrc3BhY2UuZ2V0TGVhZkJ5SWQoYmFja2xpbmtMZWFmSWQpO1xuXHRpZiAoIW9yaWdpbmFsTGVhZikge1xuXHRcdHJlc2V0QmFja2xpbmtIb3ZlcigpO1xuXHRcdHRocm93IG5ldyBFcnJvcihcIk9yaWdpbmFsIGxlYWYgbm90IGZvdW5kXCIpO1xuXHR9XG5cdGxldCBvcmlnaW5hbEVkaXRvclZpZXc6IEVkaXRvclZpZXcgPSBnZXRFZGl0b3JWaWV3KG9yaWdpbmFsTGVhZik7XG5cblx0cmVtb3ZlSGlnaGxpZ2h0KG9yaWdpbmFsRWRpdG9yVmlldywgZnJvbSwgdG8pO1xuXHRkZWZhdWx0SGlnaGxpZ2h0U2VsZWN0aW9uKG9yaWdpbmFsRWRpdG9yVmlldywgZnJvbSwgdG8pO1xuXG5cdC8vIHJlbW92ZUhpZ2hsaWdodHMob3JpZ2luYWxFZGl0b3JWaWV3KTtcblxuXHRpZiAodGVtcCAmJiB0YXJnZXRMZWFmKSB7XG5cdFx0dGFyZ2V0TGVhZi5kZXRhY2goKTtcblx0fVxuXG5cdGlmIChwZWVrKSB7XG5cdFx0bGV0IG9yaWdpbmFsTGVhZiA9IHdvcmtzcGFjZS5nZXRMZWFmQnlJZChvcmlnaW5hbExlYWZJZCk7XG5cdFx0aWYgKCFvcmlnaW5hbExlYWYpIHtcblx0XHRcdHJlc2V0QmFja2xpbmtIb3ZlcigpO1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKFwiT3JpZ2luYWwgbGVhZiBub3QgZm91bmRcIik7XG5cdFx0fVxuXG5cdFx0d29ya3NwYWNlLnJldmVhbExlYWYob3JpZ2luYWxMZWFmKTtcblx0fVxuXG5cdC8vIEVuZCBtdXRleCBsb2NrXG5cdHJlc2V0QmFja2xpbmtIb3ZlcigpO1xufVxuIiwgImltcG9ydCB7IEVkaXRvclZpZXcsIERlY29yYXRpb24sIERlY29yYXRpb25TZXQgfSBmcm9tIFwiQGNvZGVtaXJyb3Ivdmlld1wiO1xuaW1wb3J0IHsgU3RhdGVGaWVsZCwgU3RhdGVFZmZlY3QgfSBmcm9tIFwiQGNvZGVtaXJyb3Ivc3RhdGVcIjtcbmltcG9ydCB7IFNWR19IT1ZFUl9DT0xPUiB9IGZyb20gXCIuL2NvbnN0YW50c1wiO1xuXG5jb25zdCBhZGRIaWdobGlnaHQgPSBTdGF0ZUVmZmVjdC5kZWZpbmU8eyBmcm9tOiBudW1iZXI7IHRvOiBudW1iZXIgfT4oe1xuXHRtYXA6ICh7IGZyb20sIHRvIH0sIGNoYW5nZSkgPT4gKHtcblx0XHRmcm9tOiBjaGFuZ2UubWFwUG9zKGZyb20pLFxuXHRcdHRvOiBjaGFuZ2UubWFwUG9zKHRvKSxcblx0fSksXG59KTtcblxuY29uc3QgYWRkRGVmYXVsdEhpZ2hsaWdodCA9IFN0YXRlRWZmZWN0LmRlZmluZTx7IGZyb206IG51bWJlcjsgdG86IG51bWJlciB9Pih7XG5cdG1hcDogKHsgZnJvbSwgdG8gfSwgY2hhbmdlKSA9PiAoe1xuXHRcdGZyb206IGNoYW5nZS5tYXBQb3MoZnJvbSksXG5cdFx0dG86IGNoYW5nZS5tYXBQb3ModG8pLFxuXHR9KSxcbn0pO1xuXG5jb25zdCByZXNldEhpZ2hsaWdodCA9IFN0YXRlRWZmZWN0LmRlZmluZTx7IGZyb206IG51bWJlcjsgdG86IG51bWJlciB9Pih7XG5cdG1hcDogKHsgZnJvbSwgdG8gfSwgY2hhbmdlKSA9PiAoe1xuXHRcdGZyb206IGNoYW5nZS5tYXBQb3MoZnJvbSksXG5cdFx0dG86IGNoYW5nZS5tYXBQb3ModG8pLFxuXHR9KSxcbn0pO1xuXG5jb25zdCBoaWdobGlnaHRGaWVsZCA9IFN0YXRlRmllbGQuZGVmaW5lPERlY29yYXRpb25TZXQ+KHtcblx0Y3JlYXRlKCkge1xuXHRcdHJldHVybiBEZWNvcmF0aW9uLm5vbmU7XG5cdH0sXG5cdHVwZGF0ZShoaWdsaWdodHMsIHRyKSB7XG5cdFx0aGlnbGlnaHRzID0gaGlnbGlnaHRzLm1hcCh0ci5jaGFuZ2VzKTtcblx0XHRmb3IgKGxldCBlIG9mIHRyLmVmZmVjdHMpXG5cdFx0XHRpZiAoZS5pcyhhZGREZWZhdWx0SGlnaGxpZ2h0KSkge1xuXHRcdFx0XHRoaWdsaWdodHMgPSBoaWdsaWdodHMudXBkYXRlKHtcblx0XHRcdFx0XHRhZGQ6IFtkZWZhdWx0SGlnaGxpZ2h0TWFyay5yYW5nZShlLnZhbHVlLmZyb20sIGUudmFsdWUudG8pXSxcblx0XHRcdFx0fSk7XG5cdFx0XHR9IGVsc2UgaWYgKGUuaXMoYWRkSGlnaGxpZ2h0KSkge1xuXHRcdFx0XHRoaWdsaWdodHMgPSBoaWdsaWdodHMudXBkYXRlKHtcblx0XHRcdFx0XHRhZGQ6IFtoaWdobGlnaHRNYXJrLnJhbmdlKGUudmFsdWUuZnJvbSwgZS52YWx1ZS50byldLFxuXHRcdFx0XHR9KTtcblx0XHRcdH0gZWxzZSBpZiAoZS5pcyhyZXNldEhpZ2hsaWdodCkpIHtcblx0XHRcdFx0aGlnbGlnaHRzID0gaGlnbGlnaHRzLnVwZGF0ZSh7XG5cdFx0XHRcdFx0ZmlsdGVyOiAoZnJvbSwgdG8pID0+IHtcblx0XHRcdFx0XHRcdHJldHVybiAhKGZyb20gPT09IGUudmFsdWUuZnJvbSAmJiB0byA9PT0gZS52YWx1ZS50byk7XG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0cmV0dXJuIGhpZ2xpZ2h0cztcblx0fSxcblx0cHJvdmlkZTogKGYpID0+IEVkaXRvclZpZXcuZGVjb3JhdGlvbnMuZnJvbShmKSxcbn0pO1xuXG5jb25zdCBoaWdobGlnaHRNYXJrID0gRGVjb3JhdGlvbi5tYXJrKHsgY2xhc3M6IFwiaGlnaGxpZ2h0XCIgfSk7XG5jb25zdCBkZWZhdWx0SGlnaGxpZ2h0TWFyayA9IERlY29yYXRpb24ubWFyayh7IGNsYXNzOiBcImRlZmF1bHQtaGlnaGxpZ2h0XCIgfSk7XG5jb25zdCB0aGVtZSA9IEVkaXRvclZpZXcuYmFzZVRoZW1lKHt9KTtcblxuZXhwb3J0IGZ1bmN0aW9uIGhpZ2hsaWdodFNlbGVjdGlvbih2aWV3OiBFZGl0b3JWaWV3LCBmcm9tOiBudW1iZXIsIHRvOiBudW1iZXIpIHtcblx0bGV0IGVmZmVjdHM6IFN0YXRlRWZmZWN0PHVua25vd24+W10gPSBbYWRkSGlnaGxpZ2h0Lm9mKHsgZnJvbSwgdG8gfSldO1xuXG5cdGlmICghZWZmZWN0cy5sZW5ndGgpIHJldHVybiBmYWxzZTtcblxuXHRpZiAoIXZpZXcuc3RhdGUuZmllbGQoaGlnaGxpZ2h0RmllbGQsIGZhbHNlKSlcblx0XHRlZmZlY3RzLnB1c2goU3RhdGVFZmZlY3QuYXBwZW5kQ29uZmlnLm9mKFtoaWdobGlnaHRGaWVsZCwgdGhlbWVdKSk7XG5cblx0dmlldy5kaXNwYXRjaCh7IGVmZmVjdHMgfSk7XG5cdHJldHVybiB0cnVlO1xufVxuXG4vLyBoYXZlIGEgZnVuY3Rpb24gdGhhdCBhZGRzIHN1YnRsZSBoaWdobGlnaHRzIHRvIHN0YXRlXG5leHBvcnQgZnVuY3Rpb24gZGVmYXVsdEhpZ2hsaWdodFNlbGVjdGlvbihcblx0dmlldzogRWRpdG9yVmlldyxcblx0ZnJvbTogbnVtYmVyLFxuXHR0bzogbnVtYmVyXG4pIHtcblx0bGV0IGVmZmVjdHM6IFN0YXRlRWZmZWN0PHVua25vd24+W10gPSBbYWRkRGVmYXVsdEhpZ2hsaWdodC5vZih7IGZyb20sIHRvIH0pXTtcblxuXHRpZiAoIWVmZmVjdHMubGVuZ3RoKSByZXR1cm4gZmFsc2U7XG5cblx0aWYgKCF2aWV3LnN0YXRlLmZpZWxkKGhpZ2hsaWdodEZpZWxkLCBmYWxzZSkpXG5cdFx0ZWZmZWN0cy5wdXNoKFN0YXRlRWZmZWN0LmFwcGVuZENvbmZpZy5vZihbaGlnaGxpZ2h0RmllbGQsIHRoZW1lXSkpO1xuXG5cdHZpZXcuZGlzcGF0Y2goeyBlZmZlY3RzIH0pO1xuXG5cdHJldHVybiB0cnVlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlSGlnaGxpZ2h0KHZpZXc6IEVkaXRvclZpZXcsIGZyb206IG51bWJlciwgdG86IG51bWJlcikge1xuXHRsZXQgZWZmZWN0czogU3RhdGVFZmZlY3Q8dW5rbm93bj5bXSA9IFtyZXNldEhpZ2hsaWdodC5vZih7IGZyb20sIHRvIH0pXTtcblxuXHRpZiAoIWVmZmVjdHMubGVuZ3RoKSByZXR1cm4gZmFsc2U7XG5cblx0dmlldy5kaXNwYXRjaCh7IGVmZmVjdHMgfSk7XG5cdHJldHVybiB0cnVlO1xufVxuXG4vLyB1cGRhdGUgcmVtb3ZlIGhpZ2hsaWdodHMgc28gdGhhdFxuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZUhpZ2hsaWdodHModmlldzogRWRpdG9yVmlldykge1xuXHRpZiAoIXZpZXcpIHJldHVybjtcblxuXHRsZXQgZWZmZWN0czogU3RhdGVFZmZlY3Q8dW5rbm93bj5bXSA9IHZpZXcuc3RhdGUuc2VsZWN0aW9uLnJhbmdlcy5tYXAoXG5cdFx0KHsgZnJvbSwgdG8gfSkgPT4gcmVzZXRIaWdobGlnaHQub2YoeyBmcm9tLCB0byB9KVxuXHQpO1xuXHRpZiAoZWZmZWN0cy5sZW5ndGgpIHtcblx0XHR2aWV3LmRpc3BhdGNoKHsgZWZmZWN0cyB9KTtcblx0XHRyZXR1cm4gdHJ1ZTtcblx0fVxuXHRyZXR1cm4gZmFsc2U7XG59XG5cbi8vIEkgd2FudCB0byBhZGQgYSBidW5jaCBvZiBoaWdobGlnaHRzIHRvIHRoZSBzdGF0ZSB0aGF0IHVzZSBzb21lIGxpZ2h0ZXIgaGlnaGxpZ2h0IHRoZW1lXG4vLyBBbmQgdGhlbiByZW1vdmUgdGhlbSBhbmQgdXBkYXRlIHRoZSBoaWdobGlnaHRzIG9uIGVhY2ggZ2VuZXJhdGlvbiBvZiBiYWNrbGlua01hcmtQb3NpdGlvbnNcbiIsICJpbXBvcnQgeyBNYXJrZG93blZpZXcgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IGVuY29kZVVSSUNvbXBvbmVudFN0cmluZywgZ2V0UHJlZml4QW5kU3VmZml4IH0gZnJvbSBcIi4vdXRpbHNcIjtcblxuLy8gW1x1MjE5N10odXJuOkFsc28tOiBob3BlZnVsbHkgZml4IHRoZSBtdWx0aS1saW5lIHJlZmVyZW5jZTotJTBBLSBVUk5zOjExLTIzIFRvZG8ubWQpXG4vLyBbXHUyMTk3XSh1cm46UFJFRklYLTpURVhUOi1TVUZGSVg6RklMRTpTVEFSVElOREVYOkVORElOREVYKVxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUNsaXBib2FyZCh0b2dnbGU6IGJvb2xlYW4gPSBmYWxzZSkge1xuXHRjb25zdCB2aWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcblx0Ly8gTWFrZSBzdXJlIHRoZSB1c2VyIGlzIGVkaXRpbmcgYSBNYXJrZG93biBmaWxlLlxuXHRpZiAodmlldykge1xuXHRcdGxldCBzZWxlY3Rpb24gPSB2aWV3LmVkaXRvci5nZXRTZWxlY3Rpb24oKTtcblx0XHRpZiAodmlldy5maWxlKSB7XG5cdFx0XHRjb25zdCB0ZXh0ID0gdmlldy5kYXRhO1xuXHRcdFx0Y29uc3QgZnJvbSA9IHZpZXcuZWRpdG9yLnBvc1RvT2Zmc2V0KHZpZXcuZWRpdG9yLmdldEN1cnNvcihcImZyb21cIikpO1xuXHRcdFx0Y29uc3QgdG8gPSB2aWV3LmVkaXRvci5wb3NUb09mZnNldCh2aWV3LmVkaXRvci5nZXRDdXJzb3IoXCJ0b1wiKSk7XG5cdFx0XHRjb25zdCB7IHByZWZpeCwgc3VmZml4IH0gPSBnZXRQcmVmaXhBbmRTdWZmaXgodGV4dCwgZnJvbSwgdG8pO1xuXHRcdFx0bGV0IHJlZmVyZW5jZSA9IGBbXHUyMTk3XSh1cm46JHtlbmNvZGVVUklDb21wb25lbnRTdHJpbmcoXG5cdFx0XHRcdHByZWZpeFxuXHRcdFx0KX0tOiR7ZW5jb2RlVVJJQ29tcG9uZW50U3RyaW5nKHNlbGVjdGlvbil9Oi0ke2VuY29kZVVSSUNvbXBvbmVudFN0cmluZyhcblx0XHRcdFx0c3VmZml4XG5cdFx0XHQpfToke2VuY29kZVVSSUNvbXBvbmVudFN0cmluZyhcblx0XHRcdFx0dmlldy5maWxlLnBhdGhcblx0XHRcdCl9OiR7ZnJvbX06JHt0b306JHtcInBvcnRhbFwifToke3RvZ2dsZSA/IFwidFwiIDogXCJmXCJ9KWA7XG5cblx0XHRcdC8vIFdyaXRlIHRoZSBzZWxlY3RlZCB0ZXh0IHRvIHRoZSBjbGlwYm9hcmRcblx0XHRcdGF3YWl0IG5hdmlnYXRvci5jbGlwYm9hcmQud3JpdGVUZXh0KHJlZmVyZW5jZSk7XG5cdFx0fVxuXHR9XG59XG4iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxJQUFBQSxtQkFPTzs7O0FDUFAsbUJBS087QUFJQSxJQUFJLE9BQU8sd0JBQVcsT0FBbUI7QUFBQSxFQUMvQyxTQUFTO0FBQ1IsV0FBTztBQUFBLEVBQ1I7QUFBQSxFQUNBLE9BQU8sT0FBTyxJQUFTO0FBQ3RCLFFBQ0MsR0FBRyxhQUFhLEVBQUUsVUFBVSxLQUM1QixHQUFHLGFBQWEsRUFBRSxDQUFDLEVBQUUsTUFBTSxRQUFRLFFBQ2xDO0FBQ0QsYUFBTyxHQUFHLGFBQWEsRUFBRSxDQUFDLEVBQUUsTUFBTSxLQUFLO0FBQUEsSUFDeEM7QUFDQSxXQUFPO0FBQUEsRUFDUjtBQUNELENBQUM7QUFFTSxJQUFJLGVBQWUsd0JBQVcsT0FBc0I7QUFBQSxFQUMxRCxTQUFTO0FBQ1IsV0FBTztBQUFBLEVBQ1I7QUFBQSxFQUNBLE9BQU8sT0FBTyxJQUFJO0FBQ2pCLFFBQUksR0FBRyxRQUFR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TUFBTSxVQUFVLE1BQU0sS0FBSyxLQUFLO0FBQUEsRUFDMUM7QUFFQSxRQUFNLEtBQUssR0FBSTtBQUNmLFFBQU0sSUFBSSxNQUFNLFNBQVMsSUFBSTtBQUM3QixRQUFNLElBQUksS0FBSyxLQUFLLElBQUksRUFBRTtBQUMxQixRQUFNLElBQUksSUFBSSxNQUFNLENBQUM7QUFFckIsV0FBUyxJQUFJLEdBQUcsSUFBSSxHQUFHLEVBQUUsR0FBRztBQUMxQixVQUFNLE1BQU0sSUFBSSxZQUFZLEVBQUU7QUFFOUIsYUFBUyxJQUFJLEdBQUcsSUFBSSxJQUFJLEVBQUUsR0FBRztBQUMzQixVQUFJLENBQUMsSUFBSSxNQUFNLElBQUksS0FBSyxJQUFJLENBQUMsS0FBSyxLQUFLLE1BQU0sSUFBSSxLQUFLLElBQUksSUFBSSxDQUFDLEtBQUssS0FBSyxNQUFNLElBQUksS0FBSyxJQUFJLElBQUksQ0FBQyxLQUFLLElBQUksTUFBTSxJQUFJLEtBQUssSUFBSSxJQUFJLENBQUM7QUFBQSxJQUNwSTtBQUVBLE1BQUUsQ0FBQyxJQUFJO0FBQUEsRUFDVDtBQUVBLElBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRSxLQUFLLE1BQU0sU0FBUyxLQUFLLElBQUksS0FBSyxJQUFJLEdBQUcsRUFBRTtBQUN0RCxJQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsSUFBSSxLQUFLLE1BQU0sRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUM7QUFDdEMsSUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLEtBQUssTUFBTSxTQUFTLEtBQUssSUFBSTtBQUV4QyxXQUFTLElBQUksR0FBRyxJQUFJLEdBQUcsRUFBRSxHQUFHO0FBQzFCLFVBQU0sSUFBSSxJQUFJLFlBQVksRUFBRTtBQUU1QixhQUFTLElBQUksR0FBRyxJQUFJLElBQUksRUFBRSxHQUFHO0FBQzNCLFFBQUUsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxFQUFFLENBQUM7QUFBQSxJQUNmO0FBRUEsYUFBUyxJQUFJLElBQUksSUFBSSxJQUFJLEVBQUUsR0FBRztBQUM1QixRQUFFLENBQUMsSUFBSSxLQUFLLEVBQUUsSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLEdBQUcsQ0FBQztBQUFBLElBQzVEO0FBRUEsUUFBSSxJQUFJLEVBQUUsQ0FBQztBQUNYLFFBQUksSUFBSSxFQUFFLENBQUM7QUFDWCxRQUFJLElBQUksRUFBRSxDQUFDO0FBQ1gsUUFBSSxJQUFJLEVBQUUsQ0FBQztBQUNYLFFBQUksSUFBSSxFQUFFLENBQUM7QUFFWCxhQUFTLElBQUksR0FBRyxJQUFJLElBQUksRUFBRSxHQUFHO0FBQzNCLFlBQU0sSUFBSSxLQUFLLE1BQU0sSUFBSSxFQUFFO0FBQzNCLFlBQU0sSUFBSSxLQUFLLEdBQUcsQ0FBQyxJQUFJLEVBQUUsR0FBRyxHQUFHLEdBQUcsQ0FBQyxJQUFJLElBQUksRUFBRSxDQUFDLElBQUksRUFBRSxDQUFDLE1BQU07QUFDM0QsVUFBSTtBQUNKLFVBQUk7QUFDSixVQUFJLEtBQUssR0FBRyxFQUFFLE1BQU07QUFDcEIsVUFBSTtBQUNKLFVBQUk7QUFBQSxJQUNOO0FBRUEsTUFBRSxDQUFDLElBQUksRUFBRSxDQUFDLElBQUksTUFBTTtBQUNwQixNQUFFLENBQUMsSUFBSSxFQUFFLENBQUMsSUFBSSxNQUFNO0FBQ3BCLE1BQUUsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxJQUFJLE1BQU07QUFDcEIsTUFBRSxDQUFDLElBQUksRUFBRSxDQUFDLElBQUksTUFBTTtBQUNwQixNQUFFLENBQUMsSUFBSSxFQUFFLENBQUMsSUFBSSxNQUFNO0FBQUEsRUFDdEI7QUFFQSxTQUFPLENBQUMsRUFBRSxDQUFDLEtBQUssS0FBSyxLQUFNLEVBQUUsQ0FBQyxLQUFLLEtBQUssS0FBTSxFQUFFLENBQUMsS0FBSyxJQUFJLEtBQU0sRUFBRSxDQUFDLElBQUksS0FBTSxFQUFFLENBQUMsS0FBSyxLQUFLLEtBQU0sRUFBRSxDQUFDLEtBQUssS0FBSyxLQUFNLEVBQUUsQ0FBQyxLQUFLLElBQUksS0FBTSxFQUFFLENBQUMs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QUFBQSxFQUVBLFdBQVc7QUFBQSxFQUFDO0FBQ2I7IiwKICAibmFtZXMiOiBbImltcG9ydF9vYnNpZGlhbiIsICJ0aGF0IiwgImltcG9ydF92aWV3IiwgImltcG9ydF9vYnNpZGlhbiIsICJkb2N1bWVudCIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF92aWV3IiwgImltcG9ydF9zdGF0ZSIsICJmIiwgImltcG9ydF92aWV3IiwgImVkaXRvciIsICJiYWNrbGlua0NvbnRhaW5lciIsICJ3aW5kb3dIZWlnaHQiLCAic2Nyb2xsVG9wIiwgInNjcm9sbEJvdHRvbSIsICJ2aXNpYmxlRWxlbWVudHMiLCAic3RhcnRUb3AiLCAicG9zaXRpb25zIiwgInJhbmdlU3RhcnQiLCAicmFuZ2VFbmQiLCAiY29udGFpbmVyIiwgIm9yaWdpbmFsTGVhZiIsICJiYWNrbGlua3MiLCAiYmFja2xpbmtzIiwgImJhY2tsaW5rcyIsICJ0ZXh0IiwgImluZGV4IiwgInJlZmVyZW5jZSIsICJwYXJ0cyIsICJsaW5lUmVmZXJlbmNlcyIsICJsaW5lUmVmZXJlbmNlc0RhdGEiLCAibGVhZiIsICJiYWNrbGlua3MiLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF92aWV3IiwgInRleHQiXQp9Cg==
